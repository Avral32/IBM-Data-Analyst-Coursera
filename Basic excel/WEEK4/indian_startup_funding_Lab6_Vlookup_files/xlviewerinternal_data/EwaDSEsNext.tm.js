'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{1282:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(97),e=a(78),f=a(11),d=a(222);class h extends d.a{constructor(t){super();this.$=t;this.Fb()}create(){const {RenderingFidelityTracker:t}=a(1282);let z=this.$.da.za(462);z||(z=this.$.da.Ga(462,new t));this.ob(z)}}Object(u.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var m=a(39),l=a(1);a.d(D,"RenderingFidelityTracker",function(){return v});class v extends e.a{constructor(){super();
this.DIi=3E4;this.Yfb={};this.H2d={};this.dye={};b.Health.instance.addQosPillar("Fidelity")}static ka(t){t.da.Ga(463,new h(t))}eRg(t,z,r,n){if(!(m.PageLoadTrackingInfo.instance.twa(new Date)<this.DIi)){var w=f.HelperMethods.y6(()=>{var B=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(z),A=Object.keys(B),y=this.dye[t];for(var x=0;x<A.length;x++){var F=A[x];this.H2d[F]||(null===y||void 0===y?0:y[F])&&this.Yfb[F]&&(this.Yfb[F]-=y[F])}this.dye[t]=B;x=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7190709_ThickAndMediumBorder");
for(F=0;F<A.length;F++){y=A[F];if(this.H2d[y])continue;let I=B[y];this.Yfb[y]&&(I+=this.Yfb[y]);if(gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,I)){this.H2d[y]=!0;B=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);A=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);x=x?!("ThickBorder"===y||"MediumBorder"===y):!0;B&&A&&x&&b.Health.instance.recordQosError(B,[A],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+
y+", isHC:"+r+", scaleFactor:"+n+"}");break}else this.Yfb[y]=I}});1<w&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${w}`)}}}Object(u.a)(v,"RenderingFidelityTracker",e.a,[466,2])},1427:function(u,D,a){function c(Aa){var Ca=Aa.replace(/-.*/g,()=>"");Ca=wc.get(Ca);return null!==Ca&&void 0!==Ca?Ca:Aa.startsWith("ooux")?"ooux":"other"}a.r(D);var b=a(0),e=a(15);class f{constructor(){this.WinOrientation=
this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=
this.NavUserAgent=this.NavPlugins=null}}Object(b.a)(f,"BrowserInfo",null,[]);class d{constructor(){this.Version=this.Name=null}}Object(b.a)(d,"PluginInfo",null,[]);var h=a(4),m=a(27);class l{static MCi(){if(h.AFrameworkApplication.fa.qa("LogBrowserInfoIsEnabled")){var Aa=l.eMh();try{const Ca=JSON.stringify(Aa);e.ULS.sendTraceTag(6903563,102,50,Ca)}catch(Ca){e.ULS.sendTraceTag(6903564,102,15,Ca.message)}}else e.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static J0h(){const Aa=
window.navigator.plugins;if(!Aa||!Aa.length)return null;const Ca=[];for(let sc=0;sc<Aa.length;sc++){const vd=Aa[sc].name,Td=Aa[sc].version;Array.add(Ca,Object.assign(new d,{Name:vd,Version:Td}))}return Ca}static eMh(){const Aa=new f,Ca=new Sys.StringBuilder;l.Ft(sc=>{Aa.DocElemClientHeight=sc},()=>document.documentElement.clientHeight,Ca);l.Ft(sc=>{Aa.DocElemClientWidth=sc},()=>document.documentElement.clientWidth,Ca);l.Ft(sc=>{Aa.DocElemOffsetHeight=sc},()=>document.documentElement.offsetHeight,
Ca);l.Ft(sc=>{Aa.DocElemOffsetWidth=sc},()=>document.documentElement.offsetWidth,Ca);l.Ft(sc=>{Aa.ScreenAvailHeight=sc},()=>window.screen.availHeight,Ca);l.Ft(sc=>{Aa.ScreenAvailWidth=sc},()=>window.screen.availWidth,Ca);l.Ft(sc=>{Aa.ScreenWidth=sc},()=>window.screen.width,Ca);l.Ft(sc=>{Aa.ScreenHeight=sc},()=>window.screen.height,Ca);l.Ft(sc=>{Aa.ScreenLogicalXdpi=sc},()=>window.screen.logicalXDPI,Ca);l.Ft(sc=>{Aa.ScreenLogicalYdpi=sc},()=>window.screen.logicalYDPI,Ca);l.Ft(sc=>{Aa.ScreenDeviceXdpi=
sc},()=>window.screen.deviceXDPI,Ca);l.Ft(sc=>{Aa.ScreenDeviceYdpi=sc},()=>window.screen.deviceYDPI,Ca);l.Ft(sc=>{Aa.WinInnerHeight=sc},()=>window.self.innerHeight,Ca);l.Ft(sc=>{Aa.WinInnerWidth=sc},()=>window.self.innerWidth,Ca);l.Ft(sc=>{Aa.WinOuterHeight=sc},()=>window.self.outerHeight,Ca);l.Ft(sc=>{Aa.WinOuterWidth=sc},()=>window.self.outerWidth,Ca);l.Ft(sc=>{Aa.WinOrientation=sc},()=>window.self.orientation,Ca);l.Ft(sc=>{Aa.WinDevicePixelRatio=sc},()=>window.self.devicePixelRatio,Ca);l.Ft(sc=>
{Aa.SupportsTouch=sc},()=>m.a.wBc,Ca);l.Ft(sc=>{Aa.NavAppName=sc},()=>window.navigator.appName,Ca);l.Ft(sc=>{Aa.NavAppVersion=sc},()=>window.navigator.appVersion,Ca);l.Ft(sc=>{Aa.NavLanguage=sc},()=>window.navigator.browserLanguage||window.navigator.language,Ca);l.Ft(sc=>{Aa.NavUserAgent=sc},()=>window.navigator.userAgent,Ca);l.Ft(sc=>{Aa.NavPlatform=sc},()=>window.navigator.platform,Ca);l.Ft(sc=>{Aa.NavPlugins=sc},l.J0h,Ca);l.Ft(sc=>{Aa.CalculatedDevicePixelRatio=sc},()=>l.devicePixelRatio,Ca);Aa.Error=
Ca.toString();return Aa}static get devicePixelRatio(){const Aa=window.devicePixelRatio;return isNaN(Aa)?window.screen.deviceXDPI/window.screen.logicalXDPI:Aa}static Ft(Aa,Ca,sc){try{const vd=Ca();Aa(vd)}catch(vd){sc.isEmpty()||sc.append(" | "),sc.append(vd.message||"null")}}}Object(b.a)(l,"BrowserInfoLogger",null,[]);var v=a(248);class t{get name(){return"Common.App.BrowserInfoLogger"}Vh(){}init(){l.MCi()}dispose(){}static main(){v.a.instance.Ei(new t)}}Object(b.a)(t,"BrowserInfoLoggerPackage",null,
[4,5]);var z=a(80);class r{constructor(Aa){this.XGc=Aa}Qhf(Aa){if(!this.XGc)return!0;Aa=z.a.bhd(Aa);if(!Aa)return!1;Aa=Aa.toLowerCase();for(let Ca=0;Ca<this.XGc.length;Ca++)if(Aa.endsWith(this.XGc[Ca]))return!0;return!1}}Object(b.a)(r,"DomainAllowListManager",null,[]);class n{constructor(Aa,Ca){this.raa=null;this.zUc=Aa;this.url=Ca}get R1d(){return z.a.Mda(this.url)}get $t(){return this.zUc}HZd(){const Aa={},Ca=this.$t;Aa.a=this.R1d;Aa.b=this.round(Ca.navigationStart);Aa.c=this.round(Ca.unloadEventStart);
Aa.d=this.round(Ca.unloadEventEnd);Aa.e=this.round(Ca.redirectStart);Aa.f=this.round(Ca.redirectEnd);Aa.g=this.round(Ca.fetchStart);Aa.h=this.round(Ca.domainLookupStart);Aa.i=this.round(Ca.domainLookupEnd);Aa.j=this.round(Ca.connectStart);Aa.k=this.round(Ca.connectEnd);Aa.l=void 0!==Ca.secureConnectionStart&&null!==Ca.secureConnectionStart?this.round(Ca.secureConnectionStart):0;Aa.m=this.round(Ca.requestStart);Aa.n=this.round(Ca.responseStart);Aa.o=this.round(Ca.responseEnd);Aa.q=this.round(Ca.domInteractive);
Aa.r=this.round(Ca.domContentLoadedEventStart);Aa.s=this.round(Ca.domContentLoadedEventEnd);Aa.t=this.round(Ca.domComplete);Aa.u=this.round(Ca.loadEventStart);Aa.v=this.round(Ca.loadEventEnd);Aa.w=this.raa;return Aa}round(Aa){return Math.round(1E3*Aa)/1E3}}Object(b.a)(n,"PerformanceTimingEntry",null,[]);const w=(Aa,Ca)=>{const sc={};let vd=null;switch(Aa){case 0:vd="ResourceTiming";Aa=Ca.a;null!=Aa&&(sc.Url=Aa);Aa=Ca.b;null!=Aa&&(sc.InitiatorType=Aa);Aa=null==Ca.c?null:Ca.c.toString();null!=Aa&&(sc.RedirectStart=
Aa);Aa=null==Ca.d?null:Ca.d.toString();null!=Aa&&(sc.RedirectEnd=Aa);Aa=null==Ca.e?null:Ca.e.toString();null!=Aa&&(sc.FetchStart=Aa);Aa=null==Ca.f?null:Ca.f.toString();null!=Aa&&(sc.DomainLookupStart=Aa);Aa=null==Ca.g?null:Ca.g.toString();null!=Aa&&(sc.DomainLookupEnd=Aa);Aa=null==Ca.h?null:Ca.h.toString();null!=Aa&&(sc.ConnectStart=Aa);Aa=null==Ca.i?null:Ca.i.toString();null!=Aa&&(sc.ConnectEnd=Aa);Aa=null==Ca.j?null:Ca.j.toString();null!=Aa&&(sc.SecureConnectionStart=Aa);Aa=null==Ca.k?null:Ca.k.toString();
null!=Aa&&(sc.RequestStart=Aa);Aa=null==Ca.l?null:Ca.l.toString();null!=Aa&&(sc.ResponseStart=Aa);Aa=null==Ca.m?null:Ca.m.toString();null!=Aa&&(sc.ResponseEnd=Aa);Aa=Ca.n;null!=Aa&&(sc.CustomText=Aa);Aa=null==Ca.o?null:Ca.o.toString();null!=Aa&&(sc.DecodedBodySize=Aa);Aa=null==Ca.p?null:Ca.p.toString();null!=Aa&&(sc.EncodedBodySize=Aa);Ca=null==Ca.q?null:Ca.q.toString();null!=Ca&&(sc.TransferSize=Ca);break;case 1:vd="PerformanceTiming",Aa=Ca.a,null!=Aa&&(sc.Url=Aa),Aa=null==Ca.b?null:Ca.b.toString(),
null!=Aa&&(sc.NavigationStart=Aa),Aa=null==Ca.c?null:Ca.c.toString(),null!=Aa&&(sc.UnloadEventStart=Aa),Aa=null==Ca.d?null:Ca.d.toString(),null!=Aa&&(sc.UnloadEventEnd=Aa),Aa=null==Ca.e?null:Ca.e.toString(),null!=Aa&&(sc.RedirectStart=Aa),Aa=null==Ca.f?null:Ca.f.toString(),null!=Aa&&(sc.RedirectEnd=Aa),Aa=null==Ca.g?null:Ca.g.toString(),null!=Aa&&(sc.FetchStart=Aa),Aa=null==Ca.h?null:Ca.h.toString(),null!=Aa&&(sc.DomainLookupStart=Aa),Aa=null==Ca.i?null:Ca.i.toString(),null!=Aa&&(sc.DomainLookupEnd=
Aa),Aa=null==Ca.j?null:Ca.j.toString(),null!=Aa&&(sc.ConnectStart=Aa),Aa=null==Ca.k?null:Ca.k.toString(),null!=Aa&&(sc.ConnectEnd=Aa),Aa=null==Ca.l?null:Ca.l.toString(),null!=Aa&&(sc.SecureConnectionStart=Aa),Aa=null==Ca.m?null:Ca.m.toString(),null!=Aa&&(sc.RequestStart=Aa),Aa=null==Ca.n?null:Ca.n.toString(),null!=Aa&&(sc.ResponseStart=Aa),Aa=null==Ca.o?null:Ca.o.toString(),null!=Aa&&(sc.ResponseEnd=Aa),Aa=null==Ca.p?null:Ca.p.toString(),null!=Aa&&(sc.DomLoading=Aa),Aa=null==Ca.q?null:Ca.q.toString(),
null!=Aa&&(sc.DomInteractive=Aa),Aa=null==Ca.r?null:Ca.r.toString(),null!=Aa&&(sc.DomContentLoadedEventStart=Aa),Aa=null==Ca.s?null:Ca.s.toString(),null!=Aa&&(sc.DomContentLoadedEventEnd=Aa),Aa=null==Ca.t?null:Ca.t.toString(),null!=Aa&&(sc.DomComplete=Aa),Aa=null==Ca.u?null:Ca.u.toString(),null!=Aa&&(sc.LoadEventStart=Aa),Aa=null==Ca.v?null:Ca.v.toString(),null!=Aa&&(sc.LoadEventEnd=Aa),Ca=Ca.w,null!=Ca&&(sc.CustomText=Ca)}sc.Table=vd;return Sys.Serialization.JavaScriptSerializer.serialize(sc)};var B=
a(52),A=a(218),y=a(321);class x{constructor(Aa,Ca=null,sc=null){this.Pg=Aa;this.Q1d=this;this.mxg=Ca||(()=>window.location.href);this.XJc=new r(sc)}run(){if(x.ZP(window.performance))try{const Td=this.mxg();if(x.LFg.exec(Td)&&this.XJc.Qhf(Td)){var Aa=new n(window.performance.timing,Td);y.a.instance.Gdj(Aa.$t.fetchStart);y.a.instance.Hdj(Aa.$t.navigationStart);y.a.instance.rEb(B.a.$Kh,"connectStart","requestStart");y.a.instance.rEb(B.a.hLh,"requestStart","responseStart");y.a.instance.rEb(B.a.kLh,"responseStart",
"responseEnd");this.Q1d.Pe(1,Aa.HZd());this.Pg.tn(B.a.Gva,Aa.$t.fetchStart);this.Pg.tn(B.a.eLh,Aa.$t.domainLookupStart);this.Pg.tn(B.a.dLh,Aa.$t.domainLookupEnd);this.Pg.tn(B.a.bLh,Aa.$t.connectStart);this.Pg.tn(B.a.lLh,Aa.$t.secureConnectionStart);this.Pg.tn(B.a.aLh,Aa.$t.connectEnd);this.Pg.tn(B.a.iLh,Aa.$t.requestStart);this.Pg.tn(B.a.ded,Aa.$t.responseStart);this.Pg.tn(B.a.fLh,Aa.$t.responseEnd-Aa.$t.responseStart);this.Pg.tn(B.a.jLh,Aa.$t.responseStart-Aa.$t.requestStart);var Ca=0,sc=0,vd=0;
({transferSize:Ca,m$c:sc,T7c:vd}=this.cWj(Td)).returnValue&&(this.Pg.tn(B.a.nLh,Ca),this.Pg.tn(B.a.cLh,vd),this.Pg.tn(B.a.gLh,sc));this.Pg.tn(B.a.ced,Aa.$t.navigationStart)}}catch(Td){e.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Td)}}cWj(Aa){let Ca,sc,vd;vd=sc=Ca=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Ca,m$c:sc,T7c:vd};Aa=window.performance.getEntriesByName(Aa,"navigation");
if(void 0===Aa||null===Aa||1!==Aa.length)return{returnValue:!1,transferSize:Ca,m$c:sc,T7c:vd};Aa=Aa[0];var Td=Aa.transferSize;void 0!==Ca&&null!==Ca&&(Ca=Td);Td=Aa.decodedBodySize;void 0!==Td&&null!==Td&&(vd=Td);Aa=Aa.encodedBodySize;void 0!==Aa&&null!==Aa&&(sc=Aa);return{returnValue:!0,transferSize:Ca,m$c:sc,T7c:vd}}Pe(Aa,Ca){e.ULS.sendTraceTag(4551815,306,50,w(Aa,Ca))}static get instance(){return x.Ma||(x.Ma=new x(A.a.instance,null,h.AFrameworkApplication.fa.qa("PerfTimingLoggerFilterDomainsIsEnabled")?
h.AFrameworkApplication.fa.Fw("ResourceLoggerDomainAllowList"):null))}static ZP(Aa){return!(void 0===Aa||null===Aa)&&!(void 0===Aa.timing||null===Aa.timing)}}x.Ma=null;x.LFg=RegExp("^https?://.*","i");Object(b.a)(x,"PerformanceTimingLogger",null,[422]);var F=a(96),I=a(82);class L{constructor(Aa,Ca){this.raa=null;this.zUc=Aa;this.behavior=Ca;this.url=this.$t.name}get R1d(){return 2===this.behavior?this.url:z.a.Mda(this.url)}get $t(){return this.zUc}HZd(){const Aa={},Ca=this.$t;Aa.a=this.R1d;Aa.b=Ca.initiatorType;
Aa.c=this.round(Ca.redirectStart);Aa.d=this.round(Ca.redirectEnd);Aa.e=this.round(Ca.fetchStart);Aa.f=this.round(Ca.domainLookupStart);Aa.g=this.round(Ca.domainLookupEnd);Aa.h=this.round(Ca.connectStart);Aa.i=this.round(Ca.connectEnd);Aa.j=void 0!==Ca.secureConnectionStart&&null!==Ca.secureConnectionStart?this.round(Ca.secureConnectionStart):0;Aa.k=this.round(Ca.requestStart);Aa.l=this.round(Ca.responseStart);Aa.m=this.round(Ca.responseEnd);Aa.o=this.round(L.x5a(Ca,"decodedBodySize"));Aa.p=this.round(L.x5a(Ca,
"encodedBodySize"));Aa.q=this.round(L.x5a(Ca,"transferSize"));Aa.n=this.raa;return Aa}round(Aa){return Math.round(1E3*Aa)/1E3}static x5a(Aa,Ca){return Aa[Ca]}}Object(b.a)(L,"ResourceTimingEntry",null,[433]);var X=a(97),P=a(135),G=a(41),C=a(111),H=a(189);class J{constructor(Aa,Ca=null,sc=100){this.R5d=Aa;this.GYb=Ca;this.zhb={};this.Ztg=sc}sVj(Aa){var Ca=Aa.name.toLowerCase();const sc=z.a.qwa(Ca);this.wpj(sc,Ca)&&(sc in this.zhb?e.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
sc):(Ca={},Ca.fetchstart=Aa.fetchStart,Ca.responseend=Aa.responseEnd,Ca.iscached=this.Lvi(Aa),Ca.encodedsize=L.x5a(Aa,"encodedBodySize"),Ca.decodedsize=L.x5a(Aa,"decodedBodySize"),this.zhb[sc]=Ca))}wpj(Aa,Ca){if(this.R5d)return Array.contains(this.R5d,Aa);if(this.GYb)for(Aa=z.a.kN(Ca),Ca=0;Ca<this.GYb.length;Ca++)if(this.GYb[Ca]&&Aa.endsWith(this.GYb[Ca]))return!0;return!1}Lvi(Aa){try{const Ca=L.x5a(Aa,"transferSize");if(void 0!==Ca&&null!==Ca)return!Ca;e.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return Aa.responseEnd-Aa.fetchStart<this.Ztg}catch(Ca){e.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Ca.message)}return!1}dej(){if(C.a.ph(this.zhb))e.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Aa=h.AFrameworkApplication.wF?h.AFrameworkApplication.wF.split(";"):[],Ca=Object.assign(new H.a,{extendedProperties:P.a.hs()});Ca.extendedProperties.set("Flights",G.c(Aa));
this.UCi(Ca,this.zhb,X.Health.instance)}}UCi(Aa,Ca,sc){if(Ca){var vd=0,Td=0,ye=0,df=0,Kf=0,Tf=0,Mf=0,pg=0,Zf=0,wg=0,fg=0;for(let sg in Ca){var Lg=Ca[sg];try{const gg=Object(I.a)(Object,Lg);if(!gg)continue;const lh=gg.iscached?Boolean.parse(gg.iscached.toString()):!1,Hf=gg.fetchstart?this.parseFloat(gg.fetchstart.toString()):0,Mg=(gg.responseend?this.parseFloat(gg.responseend.toString()):0)-Hf,Rg=gg.encodedsize?this.parseFloat(gg.encodedsize.toString()):0,Ng=gg.decodedsize?this.parseFloat(gg.decodedsize.toString()):
0;vd+=Mg;df+=Rg;Mf+=Ng;wg++;lh?(ye+=Mg,Tf+=Rg,Zf+=Ng,fg++):(Td+=Mg,Kf+=Rg,pg+=Ng)}catch(gg){e.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",gg.message)}}Aa.extendedProperties.set("StaticResources",G.c(Ca));Aa.extendedProperties.set("TotalResourceDownloadLatency",vd.toString());Aa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Td.toString());Aa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ye.toString());
Aa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",df.toString());Aa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Kf.toString());Aa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Tf.toString());Aa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Mf.toString());Aa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",pg.toString());Aa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Zf.toString());
Aa.extendedProperties.set("TotalNumberOfResourcesDownloaded",wg.toString());Aa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",fg.toString());sc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);sc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Aa)}}parseFloat(Aa){if(!Aa)return 0;Aa=parseFloat(Aa);return isNaN(Aa)?0:Aa}}Object(b.a)(J,"AppStaticResourceManager",null,[]);class M extends Sys.EventArgs{constructor(Aa){super();
this.entries=Aa}}Object(b.a)(M,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var S=a(106);class W{constructor(Aa,Ca,sc=null,vd=null,Td=100){this.VNc=!1;this.Wi=null;this.Aib=0;this.fb=new F.a;this.Ehb=null;this.jT=!1;this.yme=0;this.fe=Aa;this.J8d=0;this.Q1d=this;this.XJc=new r(sc);this.gv=Ca;vd&&(this.Ehb=new J(null,vd,Td))}get Kye(){try{return!(void 0===this.gv||null===this.gv)&&!(void 0===this.gv.getEntriesByType||null===this.gv.getEntriesByType)}catch(Aa){return e.ULS.sendTraceTag(50873240,306,
10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Aa),!1}}get ckh(){return this.J8d}get isActive(){return this.jT}get wZd(){return this.yme}CMg(Aa){this.fb.addHandler(W.R$c,Aa)}xjj(Aa){this.fb.removeHandler(W.R$c,Aa)}Vh(Aa,Ca){const sc=this.wZd!==Aa;this.yme=Aa;this.isActive&&this.fe&&sc&&(this.np(),this.Cg());this.J8d=Ca}activate(){!this.isActive&&this.Kye&&(this.Cg(),this.jT=!0)}deactivate(Aa){this.isActive&&(this.np(),Aa&&this.flush(),this.jT=!1)}flush(){if(this.isActive&&
this.Kye)try{var Aa=window.performance.getEntriesByType("resource");0<Aa.length-this.Aib&&e.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Aa.length-this.Aib);const Ca=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Ca&&(window.performance.clearResourceTimings(),this.Aib=0);const sc=[];for(let vd=this.Aib;vd<Aa.length;vd++)this.XJc.Qhf(Aa[vd].name)&&(this.Ehb&&this.Ehb.sVj(Aa[vd]),
sc.push(new L(Aa[vd],this.ckh)));Ca||(this.Aib=Aa.length);this.fb.raiseEvent(W.R$c,new M(sc));for(Aa=0;Aa<sc.length;Aa++)0!==sc[Aa].behavior&&2!==sc[Aa].behavior||this.Q1d.Pe(0,sc[Aa].HZd());0<sc.length&&e.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",sc.length)}catch(Ca){e.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Ca)}}Pe(Aa,Ca){e.ULS.sendTraceTag(4310804,306,50,w(Aa,Ca))}Fdj(){this.Ehb.dej()}Cg(){this.fe&&
0<this.wZd&&(this.Wi=new S.a(3,2,1E3*this.wZd,()=>{this.flush()},5),this.fe.Cg(this.Wi),this.VNc=!0)}np(){this.VNc&&(this.fe.np(this.Wi),this.Wi=null,this.VNc=!1)}}W.R$c="EntriesAvailable";Object(b.a)(W,"ResourceTimingLogger",null,[404,422]);var O=a(119);class T{constructor(){this.gb=null}get name(){return"Common.ResourceTiming"}init(){this.gb.resolve("Common.NetworkTiming.IResourceTimingLogger");x.instance.run()}dispose(){}Vh(Aa){this.gb=Aa;let Ca=null;if(h.AFrameworkApplication.fa.qa("ResourceLoggerFilterDomainsIsEnabled"))try{Ca=
h.AFrameworkApplication.fa.Fw("ResourceLoggerDomainAllowList")}catch(Td){e.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const sc=[];sc.push(z.a.kN(O.a.ML).toLowerCase());sc.push(z.a.kN(O.a.oeb).toLowerCase());const vd=h.AFrameworkApplication.fa.ud("AppStaticResourceMonitorCacheThresholdInMs",100);Aa.register(404,"Common.NetworkTiming.IResourceTimingLogger").xc().Fc(()=>new W(h.AFrameworkApplication.Fi,window.performance,Ca,sc,vd))}static main(){v.a.instance.Ei(new T)}}
Object(b.a)(T,"ResourceTimingPackage",null,[4,5]);var Y=a(84);class va extends Sys.EventArgs{constructor(Aa,Ca){super();this.tRj=Aa;this.actualValue=Ca}}Object(b.a)(va,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var ca=a(165);class V{constructor(){this.qWa=[];this.h8d=this.lJc=0;this.Cfa=null;this.fb=new F.a}init(Aa,Ca,sc){this.Cfa=Aa;this.lJc=Ca;this.h8d=sc;this.Cfa.$re(Object(Y.a)(this,this.mQi,"onCpuMeterFrameAvailable"));this.PNg(Object(Y.a)(this,this.Kah,"cpuPercentThresholdExceeded"))}mQi(Aa,
Ca){Ca.Xwf&&(Array.enqueue(this.qWa,Ca.Xwf.CP),this.qWa.length>this.h8d&&(Array.dequeue(this.qWa),this.w3g()))}w3g(){var Aa=this.qWa.length;let Ca=0;for(let sc=0;sc<Aa;sc++){const vd=Array.dequeue(this.qWa);Ca+=vd;Array.enqueue(this.qWa,vd)}Aa=Ca/Aa;Aa>this.lJc&&this.fb.raiseEvent("CPTTE",new va(this.lJc,Aa))}Kah(Aa,Ca){ca.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.Mch(Ca.tRj,Ca.actualValue))}PNg(Aa){this.fb.addHandler("CPTTE",Aa)}Mch(Aa,Ca){const sc={};sc.ThresholdValue=
Aa;sc.ActualValue=Ca;return sc}}Object(b.a)(V,"CpuMeterMonitor",null,[441]);var ra=a(157);class N{constructor(){this.S=this.T=this.M=this.C=0}}Object(b.a)(N,"ProfileInformation",null,[]);var ea=a(14),Ba=a(45),ka=a(264);class Ka{constructor(Aa=0,Ca=0){this.vMc=!1;this.wEa={};this.YVb=Aa;this.gWb=Ca;this.MUc=0;Ba.a.addHandler(window.self,ea.a.tQg,()=>{this.vMc=!0});Ba.a.addHandler(window.self,ea.a.uQg,()=>{this.vMc=!1})}ute(Aa,Ca,sc){const vd=Ka.generateKey(Ca,sc);vd in this.wEa?Ca=this.wEa[vd]:(Ca=
new N,Ca.S=sc?1:0,this.wEa[vd]=Ca,this.MUc++);Ca.C++;Ca.M=Aa>Ca.M?Aa:Ca.M;Ca.T+=Aa}mH(Aa,Ca){this.ute(Aa,Ca,!1);this.vMc&&this.ute(Aa,Ca,!0)}getData(){if(0<this.gWb&&this.MUc>this.gWb)return this.dTh();const Aa=0<this.YVb,Ca={},sc=this.wEa;for(let Td in sc){var vd=Td;const ye=sc[Td];this.RZf(ye);Aa&&ye.T>=this.YVb&&(Ca[vd]=ye)}return Aa?C.a.ph(Ca)?null:Ca:this.wEa}dTh(){var Aa=0<this.YVb,Ca=[];const sc=this.wEa;for(let vd in sc){const Td={key:vd,value:sc[vd]};let ye=Td.value;(!Aa||ye.T>=this.YVb)&&
Array.add(Ca,Td)}if(Ca.length>this.gWb)Ca.sort((vd,Td)=>Td.value.T-vd.value.T),Ca=Ca.slice(0,this.gWb);else if(!Ca.length)return null;Aa={};for(const vd of Ca)Ca=vd.value,this.RZf(Ca),Aa[vd.key]=Ca;return Aa}RZf(Aa){Aa.M=ka.a.J7(Aa.M,0);Aa.T=ka.a.J7(Aa.T,0)}reset(){this.wEa={};this.MUc=0}static generateKey(Aa,Ca){return Ca?Aa+" [it]":Aa}}Object(b.a)(Ka,"FunctionCallAggregator",null,[176]);class Oa{}Oa.wVg="BatchedOperation";Oa.replication="Replication";Oa.HWj="25";Oa.Emj="9_"+Oa.wVg+"_"+Oa.replication;
Object(b.a)(Oa,"CpuMeterConstants",null,[]);class wa{}Object(b.a)(wa,"CpuMeterFrame",null,[]);class qa extends Sys.EventArgs{constructor(Aa){super();this.Xwf=Aa}}Object(b.a)(qa,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class aa{}Object(b.a)(aa,"MiniTaskItemInfo",null,[]);class ia{}Object(b.a)(ia,"TaskItemInfo",null,[]);var Ha=a(552),Z=a(98);class la{static H7h(){if(!la.pSb&&(la.pSb=new Z.a,h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.$p("AggregatorIdDisabledList"))){const Aa=h.AFrameworkApplication.fa.Fw("AggregatorIdDisabledList");
for(let Ca=0;Ca<Aa.length;Ca++)la.pSb.ia(Aa[Ca],!0)}return la.pSb}}la.pSb=null;Object(b.a)(la,"DisabledAggregatorListStore",null,[]);var Xa=a(267);class Za{constructor(Aa,Ca,sc,vd,Td,ye=!0,df=null){this.XX=this.Nle=this.gde=!1;this.fe=null;if(!Aa)throw Xa.a.argument("taskManagerLazy");if(!Td)throw Xa.a.argument("dataAggregator");this.aFg=Aa;this.pQc=Ca;this._id=sc;this.Abe=6E4*vd;this.ATb=Td;this.bje=ye;this.tmb=df;la.H7h().lb(this._id.toString())&&(this.XX=!0)}get taskManager(){return this.fe||(this.fe=
this.aFg.value)}track(Aa,Ca=null){this.XX||(this.yth(),this.Zsj(),this.ATb.mH(Aa,Ca))}Zsj(){!this.gde&&0<this.Abe&&(this.gde=!0,this.C0f())}C0f(){const Aa=new S.a(5,1,this.Abe,()=>{this.Tuj()},19,this._id.toString());this.taskManager.Cg(Aa)}Tuj(){!this.tmb||this.tmb.qEj()?this.K1f():this.bje&&this.ATb.reset();this.C0f()}K1f(){const Aa=this.ATb.getData();if(Aa){const Ca=parseInt(String(Aa.length));if(isNaN(Ca)||0<Ca)this.Cxc(Aa),this.bje&&this.ATb.reset()}}Cxc(Aa){e.ULS.sendTraceTag(7079840,335,50,
"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Aa})}yth(){this.Nle||(this.pQc(()=>{this.K1f()}),this.Nle=!0)}static hN(Aa,Ca,sc,vd,Td){return new Za(new Ha.a(()=>h.AFrameworkApplication.Fi),h.AFrameworkApplication.BOb,Aa,Ca,sc,vd,Td)}static E4a(Aa,Ca,sc){return Za.hN(Aa,Ca,sc,!0,null)}}Object(b.a)(Za,"Aggregator",null,[179]);class xa{constructor(Aa=null){this.nn=null;this.reset();this.tmb=Aa}mH(Aa,Ca){if(!this.tmb||this.tmb.qEj())Ca in this.nn||(this.nn[Ca]=[]),this.nn[Ca].push(Aa)}getData(){return C.a.count(this.nn)?
this.nn:null}reset(){this.nn={}}}Object(b.a)(xa,"NamedValuesAggregator",null,[176]);var fa=a(263);class ua{constructor(Aa,Ca,sc,vd,Td){this.WFa=0;this.CE=null;this.QXb=this.yle=0;this.Mje=!1;this.PWa=0;this.nkb=!1;this.wra=null;this.eVb=0;this.Hge=new F.a;this.UYb=[];this.fM=Aa;this.lPc=Ca;this.mLc=sc;this.Uee=vd;h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.qa("WrapSetTimeoutForTelemetryIsEnabled")&&this.Mud();this.twg=Td;this.nLc=new Ka(100);this.oAg=Za.E4a(1,5,new xa)}$re(Aa){this.Hge.addHandler("OnCpuMeterFrameAvailable",
Aa)}Ebb(Aa,Ca,sc,vd=null){sc=vd?vd.priority:7;const Td=this.fM();this.start(Ca,sc);try{Aa()}finally{this.stop(Ca,vd),Aa=this.fM()-Td,this.Uee.track(Aa,Ca)}}yW(Aa,Ca){const sc=this.fM();try{Aa()}finally{Aa=this.fM()-sc,this.mLc.mH(Aa,Ca),0<this.WFa&&this.nLc.mH(Aa,Ca),this.Uee.track(Aa,Ca)}}TEd(Aa){const Ca=new ia;Ca.TN=Aa.nmc;Ca.TP=Aa.priority;this.AQf(1,Ca)}T9a(Aa){this.eVb|=Aa}start(Aa,Ca){if(!this.WFa){this.nLc.reset();const sc=this.jnf(Aa);sc&&this.Kyd(1);this.CE=new ia;this.CE.TN=Aa;this.CE.TP=
Ca;this.CE.ST=(new Date).toISOString();this.CE.STS=ka.a.J7(this.fM(),2);sc?this.CE.UI=1:this.sri(Aa)?this.CE.UI=2:this.CE.UI=0}this.WFa++}Kyd(Aa){this.PWa|=Aa}B2c(Aa=!0,Ca=0){this.PWa=Aa?0:this.PWa&~Ca}stop(Aa,Ca=null){let sc;this.WFa--;0>=this.WFa&&this.CE&&(sc=this.fM()-this.CE.STS,this.QXb+=sc,this.lPc.mH(sc,Aa),this.jnf(Aa)&&this.B2c(!1,1),this.CE.TRT=ka.a.J7(sc,2),Ca&&(this.CE.TQT=ka.a.J7(Ca.laj,2),this.CE.TDT=ka.a.J7(Ca.Cof,2)),this.twg&&(this.AQf(0,this.CE),this.lnj()),this.WFa=0);0<=Aa.indexOf(Oa.HWj)&&
this.T9a(2);0<=Aa.indexOf(Oa.Emj)&&this.T9a(4);1===(this.PWa&1)&&this.T9a(1);2===(this.PWa&2)&&this.T9a(8)}lnj(){var Aa=this.CE.TRT;if(750<Aa){let sc=this.nLc.getData();if(sc){const vd={};for(let Td in sc){var Ca=sc[Td];const ye=Td;ye.startsWith("SiOp_")||ye.endsWith("[it]")||(vd[ye]=Math.round(100*Ca.T/Aa))}sc=vd}Aa=Object.assign(new aa,{B:this.CE.STS,T:Aa,S:sc});this.oAg.track(Aa,this.CE.TN)}}MLj(){var Aa=this.fM()-this.yle,Ca=ka.a.J7(this.QXb/Aa*100,2);Aa=new wa;Aa.CP=Ca;Aa.II=this.eVb;Ca=this.lPc.getData();
C.a.count(Ca)&&(Aa.LRT=Ca);Ca=this.mLc.getData();C.a.count(Ca)&&(Aa.FP=Ca);this.Hge.raiseEvent("OnCpuMeterFrameAvailable",new qa(Aa));this.bag()}bag(){this.lPc.reset();this.mLc.reset();this.QXb=this.WFa=0;this.yle=this.fM();this.eVb=0;this.CE=null}run(){this.Mje?this.MLj():(this.bag(),this.Mje=!0);this.wra?this.wra(Object(Y.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Y.a)(this,this.run,"run"),1E3)}yWc(Aa,Ca,sc){const vd=Array(2);vd[0]=Ca;vd[1]=sc;this.UYb[Aa]||(this.UYb[Aa]=[]);this.UYb[Aa].push(vd)}AQf(Aa,
Ca){Aa=this.UYb[Aa];if(!fa.a.ph(Aa))for(let vd=0;vd<Aa.length;vd++){var sc=Aa[vd];const Td=sc[0];sc=sc[1];Td&&!Td(Ca)||sc(Ca)}}Mud(){if(!this.nkb){const Aa=window.setTimeout;this.wra=(Ca,sc)=>Aa(Ca,sc);this.nkb=!0}}jnf(Aa){return Aa.startsWith("key")||Aa.startsWith("input")}sri(Aa){return Aa.startsWith("click")||Aa.startsWith("mouse")||Aa.startsWith("pointer")}}Object(b.a)(ua,"CpuMeter",null,[102]);class sa{constructor(Aa){this.zib=null;this.vk=new ra.a;this.fM=Aa}initialize(Aa,Ca,sc,vd=!1){this.zib||
(this.zib=new ua(this.fM,Aa,Ca,sc,vd),this.vk.setResult(this.zib));return this.zib}}Object(b.a)(sa,"CpuMeterProvider",null,[440]);class sb{constructor(Aa=1){this.Fx=[];this.ITb=[];this._count=Aa}$Hh(){let Aa=0;for(let Ca=0;Ca<this.Fx.length;Ca++)this.Fx[Ca]<this.Fx[Aa]&&(Aa=Ca);return Aa}mH(Aa,Ca){Aa=ka.a.J7(Aa,2);if(this.Fx.length<this._count)Array.add(this.Fx,Aa),Array.add(this.ITb,Ca);else{var sc=this.$Hh();Aa>this.Fx[sc]&&(this.Fx[sc]=Aa,this.ITb[sc]=Ca)}}getData(){return this.Fx.length?{["Vals"]:this.Fx,
["Desc"]:this.ITb}:null}reset(){this.Fx=[];this.ITb=[]}}Object(b.a)(sb,"MaxDataAggregator",null,[176]);var hb=a(40),bb=a(83);class lb{get name(){return"Common.App.CpuMeter"}Vh(Aa){Aa.register(sa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").xc().Fc(()=>new sa(hb.a.Ud));Aa.register(V,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").xc().Fc(()=>new V)}init(){const Aa=h.AFrameworkApplication.fa;if(Aa.qa("CpuMeterIsEnabled")){const Ca=bb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
y.a.instance.xue.continueWith(()=>{lb.ihi(Aa,Ca)})}}dispose(){}static ihi(Aa,Ca){const sc=Za.E4a(10,5,new Ka(Aa.ud("TaskManagerLoggingThreshold",0),Aa.ud("CpuMeterMaximumEntriesToLog",0)));Ca=Ca.initialize(new sb(5),new Ka,sc,Aa.qa("CPUMeterExposeTaskDetailsIsEnabled"));Ca.run();Aa.qa("CpuMeterMonitorIsEnabled")&&bb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ca,Aa.Yva("CpuMeterAverageCpuPercentThreshold",80),Aa.ud("CpuMeterRollingAverageFramesCount",15));ca.a(16827671,306,50,
"Initializing CpuMeter")}static main(){v.a.instance.Ei(new lb)}}Object(b.a)(lb,"CpuMeterPackage",null,[4,5]);var Fa=a(940);class Na{get name(){return"Common.App.EventsCachePackage"}Vh(){}init(){Fa.a.instance.init()}dispose(){}static main(){v.a.instance.Ei(new Na)}}Object(b.a)(Na,"EventsCachePackage",null,[4,5]);var Mb=a(9),dc=a(222),Cb=a(1239),Tb=a(164),Jb=a(373),eb=a(203),za=a(148),ha=a(59),fb=a(91),rb=a(1),pa=a(22),Ma=a(159),Ja=a(760);class Ga extends Cb.a{constructor(Aa,Ca,sc){super(Ca,sc);this.Sa=
new F.a;this.Idi=vd=>{if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Td=vd.Values.m_Origin;h.AFrameworkApplication.wopiHostOriginFromPostMessage||(h.AFrameworkApplication.wopiHostOriginFromPostMessage=Td)}switch(vd.MessageId){case Tb.a.Emd:Ma.a(this.$).D$e(vd);break;case Tb.a.swd:za.a.ltas(null);break;case Tb.a.Zfc:this.MUi();break;case Tb.a.Imd:this.LUi(vd)}};this.$=Aa;sc!==Ja.a.v$&&this.CGa(sc);this.tii();this.Ehi();Aa=this.Idi;this.em(Tb.a.Emd,Aa);this.em(Tb.a.swd,
Aa);this.em(Tb.a.Zfc,Aa);this.em(Tb.a.Imd,Aa)}dispose(){this.$=null;super.dispose()}tii(){this.uo(Tb.a.uAe);this.uo(Tb.a.Emd);this.uo(Tb.a.Zfc);this.uo(Tb.a.Imd);this.qWc(Tb.a.swd);this.uo(Tb.a.Hmd)}Ehi(){this.fha(Tb.a.ynb);this.fha(Tb.a.Eua);this.fha("App_CloseTab");this.fha(Tb.a.tVa);this.fha(Tb.a.uVa);this.fha(Tb.a.Hcf);this.fha(Tb.a.Wfc)}MUi(){const Aa={};Aa.hostMessageReceived=(new Date).getTime();e.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");h.AFrameworkApplication.jtd=
!0;Aa.appUnloadStart=(new Date).getTime();Aa.sendBeaconFlight=h.AFrameworkApplication.fa.qa("SendBeaconOnShuttingDownRequestsEnabled");Aa.sendBeaconSupported=ha.a.hea();ha.a.Hue();Aa.appUnloadEnd=(new Date).getTime();Aa.appMessageSent=(new Date).getTime();this.Oj(Tb.a.IRg,Aa)}LUi(Aa){e.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Aa.Values&&Jb.a.NAd in Aa.Values&&pa.a.equals(Aa.Values[Jb.a.NAd],eb.a.edit,!0)&&!this.$.isEditMode&&(e.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Aa.Values[Jb.a.NAd]}`),
Aa=new fb.a(-8805455,0,1,0,null),this.$.Ka.Lb(Aa))}}Object(b.a)(Ga,"EwaHostMessenger",Cb.a,[413,324,2]);class La extends dc.a{constructor(Aa){super();this.JFe=!1;this.$=Aa;this.Fb()}create(){const Aa=this.$.da,Ca=bb.a.instance;if(!this.JFe){this.JFe=!0;let sc;sc=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.va.DocumentHostInfo.PostMessageOrigin||Ja.a.v$:h.AFrameworkApplication.hHd||Ja.a.v$;Ca.register(Ga,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").xc().Fc(()=>
new Ga(this.$,window.parent,sc,h.AFrameworkApplication.fa.qa("HostSendReadyToAcceptPostMessage")))}this.ob(Aa.za(21)||Aa.Ga(21,Ca.resolve("Postmessage.IHostPostmessenger")))}}Object(b.a)(La,"HostMessengerFactory",dc.a,[]);var nb=a(120),Lb=a(147),ac=a(682),ib=a(553),Ra=a(78),ya=a(132),Va=a(460),oa=a(46),kb=a(318),Sa=a(351),U=a(354),ta=a(494),ub=a(5),hc=a(51),Bc=a(76);class Qa{constructor(Aa,Ca,sc){this.correlations=this.properties=this.operation=null;this.operation=Aa;this.properties=Ca;this.correlations=
sc}static yFh(Aa,Ca,sc){const vd={},Td=hc.b();switch(Aa.command){case -1537138325:vd.Action=Ca.LabelText;break;case -1104934572:vd.PrevTab=Td.uj(parseInt(Ca.OldContextCommand,10));vd.NextTab=Td.uj(parseInt(Ca.NewContextCommand,10));break;case 802602464:vd.Origin=Ca[ub.a.GQ];break;case -1027730316:case -1059615499:vd.MenuType=Ca.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Ca&&(vd.SqmControlId=Ca.SqmControlId);break;
case 1371713064:case 875133075:Bc.a.Ic in Ca&&(vd.SampleTableId=Ca[Bc.a.Ic])}vd.InputMethod=Sa.a[Aa.method];vd.Location=U.a[Aa.$e];vd.Mode=ta.a[Aa.mode];vd.ParentName=Aa.tabName;vd.IsSystemInitiated="IsSystemInitiated"in Ca?Ca.IsSystemInitiated:!1;vd.NoReporting="NoReporting"in Ca?Ca.NoReporting:!1;"ControlIdToLog"in Ca&&(vd.ControlId=Ca.ControlIdToLog);"TerminalParentControlIdToLog"in Ca&&(vd.TerminalParentControlId=Ca.TerminalParentControlIdToLog);for(const ye of Object.keys(sc))vd[ye]=sc[ye];return vd}}
Object(b.a)(Qa,"InteractivityRecord",null,[]);class na extends Qa{constructor(Aa,Ca,sc){super(Aa.operation,Aa.properties,Aa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Ca;this.timeFromNavigationStart=sc}}Object(b.a)(na,"FirstUserInteractivityRecord",Qa,[]);var ab=a(639);class Gb{constructor(){this.commandSurface=this.triggerMethod=nb.a.sgb}static whi(){Gb.W3a||(Gb.W3a=new ab.a(ib.a.cl()),Gb.W3a.add("InputMethod"),Gb.W3a.add("Location"),Gb.W3a.add("Mode"))}}
Gb.W3a=null;Object(b.a)(Gb,"ExcelUserAction",null,[]);var fc=a(201),pb=a(39),Ea=a(429),xb=a(190);class bc extends Ra.a{constructor(Aa){super();this.Dff=0;this.wYe=!1;this.evd=Array(bc.W9a);this.a7b=0;this.$=Aa;this.UAb=rb.EwaSettings.ma(78);this.Jmf=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");this.asi=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");nb.a.b0h();this.Oba={};bc.SZb||(bc.SZb=new ac.a(ib.a.cl()),bc.Hgi(bc.SZb));
Gb.whi();if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Aa=0;Aa<bc.W9a;Aa++)this.evd[Aa]="NA"}dispose(){this.$=this.Oba=null;super.dispose()}bXf(Aa,Ca,sc){if(this.UAb){var vd=hc.b().uj(Aa.command),Td=JSON.stringify(Aa);vd||e.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${vd}, command: ${Aa.command}, commandInfo: ${Td}`);Ca=Qa.yFh(Aa,Ca,sc);sc=!!Ca&&(!("IsSystemInitiated"in Ca)||!Ca.IsSystemInitiated);
this.$&&this.$.ea.qg&&sc&&Fa.a.instance.aSf("OtelUserAction",new Ea.a(vd,Aa.tabName,Date.now()));this.pXf(vd,Ca,null,!0,!0)}}Gd(Aa,Ca,sc=null,vd=!1){this.UAb&&this.pXf(Aa,Ca,sc,!1,vd)}eXd(Aa){if(this.UAb)if(this.Oba){++this.Dff;this.Oba[Aa]||(this.Oba[Aa]=[]);var Ca=this.Dff.toString();this.Oba[Aa].push(Ca);e.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Aa}', correlation=${Ca}`)}else e.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Aa}] == null`)}wXd(Aa){if(this.UAb)if(this.Oba&&
this.Oba[Aa]){var Ca=this.Oba[Aa],sc=Ca.pop().toString();Ca.length||delete this.Oba[Aa];e.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Aa}', correlation=${sc}`)}else e.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Aa}] == null`)}qQ(Aa,Ca,sc=!1){return this.UAb?kb.a(vd=>{this.Gd(Aa,vd(),void 0,sc)},bc.vRj,this.la,oa.a.oki,!1,!Ca):null}uNd(){let Aa="";for(let Ca=0;Ca<bc.W9a;Ca++)Aa+=this.evd[(this.a7b+
bc.W9a-Ca-1)%bc.W9a]+",";e.ULS.sendTraceTag(557188890,0,15,`Last operations ${Aa}`)}L_j(Aa){Aa&&(this.evd[this.a7b]=Aa,this.a7b=(this.a7b+1)%bc.W9a)}RCi(Aa,Ca,sc){h.AFrameworkApplication.K9b();const vd=Aa.operation,Td=Aa.properties;void 0!==sc?Va.a(this.$,432,433,0,ye=>{ye.eej(vd,Td,sc)}):this.OWj(Aa);this.PWj(Aa);this.F2i(Ca,Td,vd)}OWj(Aa){this.QKj(Aa)||(this.wYe=!0,Aa=new na(Aa,pb.PageLoadTrackingInfo.instance.twa(new Date),pb.PageLoadTrackingInfo.ys()),Aa=Sys.Serialization.JavaScriptSerializer.serialize(Aa),
e.ULS.sendTraceTag(458261331,0,50,`${Aa}`))}QKj(Aa){const Ca=Aa.properties;Aa=Aa.operation;return this.wYe||void 0===Aa||null===Aa||Aa===ya.a.WVc||Aa===ya.a.DQd||Aa===ya.a.EHd||ha.a.rsd(Aa)||!!Ca&&"IsSystemInitiated"in Ca&&Ca.IsSystemInitiated}PWj(Aa){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.L_j(Aa.operation);Aa=Sys.Serialization.JavaScriptSerializer.serialize(Aa);e.ULS.sendTraceTag(21542793,0,50,`${Aa}`)}F2i(Aa,Ca,sc){nb.a.Fla()&&(Ca?"NoReporting"in
Ca&&Ca.NoReporting||"IsSystemInitiated"in Ca&&Ca.IsSystemInitiated||!Aa&&!this.Jmf||((Aa=nb.a.Vj(Ca,bc.SZb,Gb.W3a))?(Ca=bc.GFh(Ca))?Lb.a.sendUserActionEvent(nb.a.E6b(sc,null,Ca.triggerMethod,Ca.commandSurface,Aa)):e.ULS.sendTraceTag(537155550,0,50,"user action was null"):e.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):e.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${sc}`))}pXf(Aa,Ca,sc,vd,Td){const ye=
fc.a(this.$);if(this.Jmf){let Kf=null;pa.a.equals(Aa,ya.a.rxc,!0)&&Ca&&"InputMethod"in Ca&&(Kf=ya.a.rZe(Aa,Ca.InputMethod));ye.EKb(Kf||Aa,sc)}else pa.a.equals(Aa,ya.a.rxc,!0)&&Ca&&"InputMethod"in Ca&&(Aa=ya.a.rZe(Aa,Ca.InputMethod)),ye.EKb(Aa,sc);Ca&&(Ca.IsCommand=vd);let df=void 0;this.asi&&(df="ActionRelativeTime"in Ca?Ca.ActionRelativeTime:pb.PageLoadTrackingInfo.ys());Object(xb.c)(()=>{const Kf=new Qa(Aa,Ca,this.Oba);this.RCi(Kf,Td,df)},this.$.la,50)}static GFh(Aa){if(!Aa)return null;const Ca=
new Gb;"InputMethod"in Aa&&(Ca.triggerMethod=Aa.InputMethod);"Location"in Aa&&(Ca.commandSurface=Aa.Location);return Ca}static Hgi(Aa){Aa?(Aa.add("Origin",2),Aa.add("InputMethod",2),Aa.add("ButtonType",2),Aa.add("selectedRange",2),Aa.add("SelectedRanges",2),Aa.add("editRange",2),Aa.add("Location",2),Aa.add("Mode",2),Aa.add("CurrentSelectionMode",2),Aa.add("Action",2),Aa.add("type",2),Aa.add("floatingObjectType",2),Aa.add("PrevTab",2),Aa.add("NextTab",2),Aa.add("DialogName",2),Aa.add("dx",3),Aa.add("dy",
3),Aa.add("NumberOfSelectedRanges",3),Aa.add("IsCommand",1),Aa.add("IsInFormulaBarEdit",1),Aa.add("isLink",1),Aa.add("isSheetRef",1),Aa.add("isEmptyText",1),Aa.add("isFormula",1),Aa.add("IsResizingHiddenHeader",1)):e.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}bc.vRj=1E3;bc.W9a=40;bc.SZb=null;Object(b.a)(bc,"InteractivityLogger",Ra.a,[13]);var zb=a(7);class Ub{constructor(){this.appInfoProperties=this.appState=null}}Object(b.a)(Ub,"CurrentAppInfo",null,[]);
const wc=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(Aa=>{Aa.actions.forEach(Ca=>{wc.set(Ca,Aa.name)})});class mb{constructor(){this.value=this.key=null}}Object(b.a)(mb,"AppInfoProperty",null,[]);class Db{constructor(Aa){this.$=Aa}getAppState(){const Aa=pb.PageLoadTrackingInfo.instance.twa(new Date);
return-1===Aa?"boot":3E4>Aa?"postboot":"steady"}isChangeGateEnabled(Aa){return rb.EwaSettings.isChangeGateEnabled(Aa)}getBooleanFeatureGate(Aa,Ca){return rb.EwaSettings.getBooleanFeatureGate(Aa,Ca)}getCurrentAppInfo(){return Object(zb.a)(new Ub,{appState:this.getAppState(),appInfoProperties:[Object(zb.a)(new mb,{key:"coauthCount",value:this.$.ea.Ym.length.toString()})]})}sendBeaconTraceTag(Aa,Ca,sc,vd){this.$.sendBeaconTraceTag(Aa,Ca,sc,vd)}getActionBucket(Aa){return c(Aa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.DHi}`}}
Object(b.a)(Db,"InteractivityTrackerCallbacks",null,[427]);class Ic{constructor(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}}Object(b.a)(Ic,"InteractivityTrackerOptions",null,[]);class Hc{constructor(Aa){this.Pba=null;Hc.vjf?e.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(Aa),Hc.vjf=!0)}initialize(Aa){e.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");
if(this.Pba=interactivity.InteractivityTrackerFactoryGlobal.create()){const Ca=new Ic;rb.EwaSettings.Rtd()&&Hc.Ubg.push(ea.a.I$);Ca.events=Hc.Ubg;Ca.durationThresholdInMs=Hc.durationThresholdInMs;Ca.callbacks=new Db(Aa);Ca.patchTaskScheduling=rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);Aa=this.Pba.start(Ca);Aa.started?e.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):e.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+
Aa.failureReason)}else e.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}tCa(Aa,Ca,sc){this.Pba?this.Pba.track(Aa,Ca,sc):e.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Ca}`)}FJe(){return this.Pba?this.Pba.createActionsRetriever():(e.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),
null)}dispose(){this.Pba&&(this.Pba.stop(),this.Pba=null)}}Hc.durationThresholdInMs=100;Hc.Ubg="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Hc.vjf=!1;Object(b.a)(Hc,"InteractivityTrackerService",null,[417]);var Ab=a(50),db=a(37),Pb=a(184),td=a(695);class Vb extends dc.a{constructor(Aa){super();this.$=Aa;this.Fb()}create(){if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){const Aa=Ab.GetServiceTaskFactory.Oa(this.$.da,
283,284,this.Ya);db.TaskExtensions.Aa(Aa,()=>{db.TaskExtensions.Aa(Pb.c(Aa.result.pn.loadScript("interactivity")),()=>{this.ob(Object(td.a)(this.$.da,443,()=>new Hc(this.$)))},this.$.la,3)},this.$.la,3)}else this.ob(Object(td.a)(this.$.da,443,()=>new Hc(this.$)))}static ka(Aa){Aa.da.Ga(444,new Vb(Aa))}}Object(b.a)(Vb,"InteractivityTrackerServiceFactory",dc.a,[]);var Ac=a(87),Kc=a(383),dd=a(8),Vd=a(47),Jd=a(58);class oe{constructor(Aa){this.vLj=Aa}getCustomProperties(Aa){const Ca=new Map;if(Aa.hasOwnProperty("startTimeInMs")&&
Aa.hasOwnProperty("totalExecutionTimeInMs")){const sc=Aa.startTimeInMs;Aa=this.vLj.retrieveSlowActionsBetweenTimeRange(sc,sc+Aa.totalExecutionTimeInMs);Ca.set("actions",Jd.a.hc(Aa))}return Ca}}Object(b.a)(oe,"CallTreeCustomPropertiesRetriever",null,[435]);class De{constructor(){this.customProperties=new Map}addCustomProperty(Aa,Ca){this.customProperties.set(Aa,Ca)}getCustomProperties(){return this.customProperties}}Object(b.a)(De,"CustomPropertiesRetriever",null,[434]);class Ke{isFeatureEnabled(Aa,
Ca){return rb.EwaSettings.getBooleanFeatureGate(Aa,Ca)}}Object(b.a)(Ke,"ExcelFeatureChecker",null,[431]);class rd{isProfilingEnabled(){return!0}}Object(b.a)(rd,"ExcelProfilingFeatureChecker",null,[430]);class bf{constructor(Aa,Ca){this.v_i=Aa;this.x_i=Ca}onProfilerEvent(Aa){switch(Aa.eventId){case 1:this.v_i(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.x_i();break;default:e.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${Aa.eventId}`)}}}
Object(b.a)(bf,"JSCPUProfilerObserver",null,[429]);class cc{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(b.a)(cc,"JSCPUProfilerInitOptions",null,[]);class Wc{constructor(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=
this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=
this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(b.a)(Wc,"JSCPUProfilingPackageInitOptions",null,[]);class id{constructor(Aa,Ca){this.interactivityTrackerService=this.iag=this.JId=this.Fbb=this.KId=this.bPf=this.cPf=null;this.X9i=new Set([1,0]);e.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");
this.$=Aa;this.interactivityTrackerService=Ca;this.qii();this.pii();this.Fxi=this.$.va.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=rb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.zGe=rb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.$2i=rb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.zNj()}dispose(){e.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");
Ac.a.Ia(this.iag);this.JId=this.$=null;this.KId.clear();this.Fbb.clear()}QMj(){const Aa=Math.random()*this.zGe;e.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${Aa}`);this.iag=Vd.a.instance.create(()=>{this.Whd("ExcelOnlineContinuousSessionProfiler",2).start()},Aa,oa.a.HDj,!0)}bNj(){e.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Whd("ExcelOnlineFullSessionProfiler",3).start()}iNj(Aa){e.ULS.sendTraceTag(537155524,
0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Wkf(Aa)?this.Whd(Aa,0,1E4).start():e.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")}iOj(Aa){this.Wkf(Aa)?(Aa=this.f6e(Aa))&&Aa.stop():e.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")}IId(Aa){return this.Fbb.has(Aa)}zNj(){rb.EwaSettings.K6e()||(rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",
!1)?this.bNj():this.QMj())}createProfiler(Aa,Ca,sc,vd,Td,ye){e.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const df=new cc;df.samplingIntervalInMs=Ca;df.maximumNumberOfSamplesToTake=sc;df.idleIntervalInMs=vd;df.profilingIntervalInMs=Td;return this.Rfh(Aa,ye,df)}pii(){const Aa=new rd,Ca=new Wc;Ca.ulsInstance=new Kc.a;Ca.deObfuscationEndpoint="ProfilerReporting.ashx";Ca.shouldCompressSerializedCallTrees=!1;Ca.shouldKeepSamplesOutsideOfProfilingInterval=
!1;Ca.shouldSendAllCallTreesFromProfileInASingleRequest=!rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);Ca.shouldUseSendBeaconForSendingCallTrees=rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);Ca.callTreeFilteringThresholdInMs=rb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);Ca.deObfuscationRequestQueryParamsRetriever=this.Dch();
Ca.deObfuscationRequestBodyPropertiesRetriever=this.Cch();Ca.featureEnabledChecker=new Ke;Ca.useMainEventLoopForProfilerTraceProcessing=!1;Ca.profilerTraceProcessingWebWorkerSourceURL=this.$.va.JSProfilerProcessingWebWorkerJsScriptUrl;Ca.shouldProcessProfileCapturedWhileUserIsIdle=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");this.JId=this.cPf.retrievePackage(Aa,Ca).retrieveProfilerFactory()}Dch(){const Aa=new De;Aa.addCustomProperty(dd.a.EPf,
h.AFrameworkApplication.userType);Aa.addCustomProperty(h.AFrameworkApplication.Ugb,h.AFrameworkApplication.userSessionId);Aa.addCustomProperty(dd.a.XAd,this.$.va.SkipAuthentication?dd.a.mxf:null);Aa.addCustomProperty(dd.a.cJd,this.$.va.MachineCluster);return Aa}Cch(){const Aa=new De;Aa.addCustomProperty("appName","Excel");Aa.addCustomProperty("buildVersion",h.AFrameworkApplication.buildVersion);Aa.addCustomProperty("shouldUseSourceMaps","true");Aa.addCustomProperty("shouldFilterSensitiveResources",
"true");Aa.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.iHj().toString());return Aa}Rfh(Aa,Ca,sc){const vd=new De;vd.addCustomProperty("ProfilerName",Aa);this.bPf.set(Aa,vd);Ca=this.JId.createProfiler(Ca,sc,vd);this.Fbb.set(Aa,Ca);Aa=this.ceh(Aa);Ca.subscribeProfilerObserver(Aa,this.X9i);return Ca}f6e(Aa){return this.IId(Aa)?this.Fbb.get(Aa):(e.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${Aa}) does not exist`),null)}Whd(Aa,
Ca,sc=null){Aa=this.$2i||Aa;if(this.IId(Aa))return this.f6e(Aa);const vd=this.Fxi;return this.createProfiler(Aa,vd,null!=sc&&0<vd?sc/vd:2E6,2===Ca?this.zGe:null,0===Ca?null:this.profilingIntervalInMs,Ca)}ceh(Aa){var Ca=this.interactivityTrackerService;if(Ca){const sc=Ca.FJe();if(sc){Ca=this.Fbb.get(Aa);const vd=new oe(sc);Ca.subscribeCallTreeCustomPropertiesRetriever(vd);Ca=new bf(Td=>{sc.startCollectingSlowActions(Td)},Object(Y.a)(sc,sc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.KId.set(Aa,
Ca);return Ca}e.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}e.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}qii(){this.cPf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.bPf=new Map;this.KId=new Map;this.Fbb=new Map}Wkf(Aa){return!!Aa}iHj(){return!rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6967854_ESNextEnabled")}}
Object(b.a)(id,"JsSelfProfilerManager",null,[415,2]);class Tc extends dc.a{constructor(Aa){super();this.$=Aa;this.Fb()}create(){e.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");const Aa=Ab.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);db.TaskExtensions.Aa(Aa,()=>{this.$.da.$a(443,Ca=>{this.eeh(Aa.result,Ca)})},this.$.la,3)}eeh(Aa,Ca){db.TaskExtensions.Aa(Pb.c(Aa.pn.loadScript("officeOnlineCpuProfiling")),()=>{const sc=Object(td.a)(this.$.da,
437,()=>new id(this.$,Ca));this.ob(sc)},this.$.la,3)}static ka(Aa){Aa.da.Ga(438,new Tc(Aa))}}Object(b.a)(Tc,"JsSelfProfilerManagerFactory",dc.a,[]);class Gd{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(b.a)(Gd,"ActionData",null,[]);class Wd{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(b.a)(Wd,"BlockedEngagementInfo",null,[]);class Dd extends Gd{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(b.a)(Dd,
"SuccessfulActionData",Gd,[]);class Kd{constructor(){this.successfulActions=[]}}Object(b.a)(Kd,"SuccessfulEngagementInfo",null,[]);var we=a(44);class We{constructor(Aa){this.xKa=new Set;this.DOb=null;this.vYe=this.Mbg=!1;this.rg=()=>{this.IBi();this.DOb=Vd.a.instance.create(()=>{this.GDb()},We.$Oj,oa.a.GDb)};this.Bc=()=>{this.GDb()};this.fHb=(Ca,sc)=>{Ca=this.hqb.blockedActions.length;const vd=sc.details?sc.actionName+"_"+sc.details:sc.actionName;sc=Object(zb.a)(new Gd,{order:Ca+1,name:vd,componentName:sc.componentName,
timeFromNavigationStart:sc.timeFromNavigationStart});this.hqb.blockedActions.push(sc)};this.sJd=()=>{this.$.Xc(2009315810,-1,0,null);this.wUd=!1};this.hqb=new Wd;this.hqb.hasBlockedActions=!1;this.rfb=new Kd;this.ZGh();this.$=Aa;this.$.ea.Kk(this.rg);this.$.dk(this.Bc);this.cPj=0;this.wUd=!1;rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.XGe=new Promise(Ca=>{this.kah=Ca}))}dispose(){this.$.ea&&this.$.ea.lo(this.rg);this.$.Jl(this.Bc);Ac.a.Ia(this.DOb);
this.$=this.DOb=null}eej(Aa,Ca,sc){if(void 0!==Aa&&null!==Aa&&Ca){var vd=this.rfb.successfulActions.length+1,Td="InputMethod"in Ca?Ca.InputMethod:"",ye="IsCommand"in Ca&&Ca.IsCommand;if(this.cwi(Aa,Ca,Td,ye)){rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerformanceSurveys",!1)&&this.cPj++===We.i2j?(this.wUd=!0,this.c5i=Vd.a.instance.create(this.sJd,5E3,oa.a.sJd)):this.wUd&&this.c5i.tq();if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const df=
!ye&&Aa;this.vYe||df===ya.a.Clg||df===ya.a.Dlg||df===ya.a.zlg||df===ya.a.Alg||(this.vYe=!0,this.kah(void 0))}vd>We.Fuf||(Aa=Object(zb.a)(new Dd,{order:vd,name:Aa,componentName:"Location"in Ca?Ca.Location:"",timeFromNavigationStart:sc,inputMethod:Td,isCommand:ye}),this.rfb.successfulActions.push(Aa),1===vd?this.zCi():vd===We.Fuf&&this.GDb())}}}Pdj(Aa){we.a(this.$).s0b(this.fHb);this.hqb.hasBlockedActions=!0;this.fHb(null,Aa)}IBi(){e.ULS.sendTraceTag(254546634,0,50,`${G.c(this.hqb)}`)}zCi(){pb.PageLoadTrackingInfo.instance.twa(new Date)>
We.lHh?e.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${G.c(this.rfb.successfulActions[0])}`):e.ULS.sendTraceTag(254563592,0,50,`${G.c(this.rfb.successfulActions[0])}`)}GDb(){!this.Mbg&&this.rfb.successfulActions.length&&(this.Mbg=!0,Ac.a.Ia(this.DOb),this.DOb=null,this.$.sendBeaconTraceTag(254559496,50,!1,G.c(this.rfb)))}ZGh(){this.xKa.add(ya.a.WVc);this.xKa.add(ya.a.DQd);this.xKa.add(ya.a.EHd);this.xKa.add(ya.a.GNf);this.xKa.add(ya.a.INf);this.xKa.add(ya.a.KNf)}cwi(Aa,Ca,
sc,vd){sc=!sc||"unknown"===sc;const Td="IsSystemInitiated"in Ca&&Ca.IsSystemInitiated;Ca="NoReporting"in Ca&&Ca.NoReporting;const ye=this.xKa.has(Aa);Aa=pa.a.equals(Aa,ya.a.rxc,!0)&&sc;return!Td&&!Ca&&!ye&&!Aa&&!(vd&&sc)}}We.Fuf=10;We.lHh=6E4;We.$Oj=12E4;We.i2j=25;Object(b.a)(We,"PageLoadEngagementInfo",null,[416]);class Od extends dc.a{constructor(Aa){super();this.$=Aa;this.Fb()}create(){this.ob(this.$.da.za(432)||this.$.da.Ga(432,new We(this.$)))}static ka(Aa){Aa.da.Ga(433,new Od(Aa))}}Object(b.a)(Od,
"PageLoadEngagementInfoFactory",dc.a,[]);var le=a(54),de=a(137),Re=a(515),Ee=a(38),Te=a(74),Ae=a(420),kf=a(35),Oe=a(236);class $a extends Sys.EventArgs{constructor(Aa){super();this.TU=Aa}}Object(b.a)($a,"ErrorDataArgs",Sys.EventArgs,[]);var Zb=a(644),Da=a(110),Pa=a(28);class tb{constructor(Aa,Ca){this.$Sb=null;this.y7b=this.zmd=!1;this.Xje=this.Yje=null;this.p6a=this.o6a=0;this.I0f=Aa;this.khe=Ca}get RKf(){return this.khe}get GLb(){return this.Yje}get H0f(){return this.Xje}get Dxi(){return this.hAe(this.I0f.getTime())}get s3i(){return this.hAe(this.H0f.getTime())}get n7f(){return!(this.y7b||
void 0===window.bsqmXLSPageLoadStartTime)}get Z2c(){try{return this.$Sb||(this.$Sb=Da.toUtc(window.bsqmXLSPageLoadStartTime)),this.$Sb}catch(Aa){return null}}set Z2c(Aa){this.$Sb=Aa}eBj(Aa){this.y7b||(this.Yje=Aa,this.Xje=Da.toUtc(this.GLb))}Odi(Aa){if(Aa.Values&&(!this.o6a||!this.p6a))try{Jb.a.Lcf in Aa.Values&&(this.o6a=parseInt(Aa.Values[Jb.a.Lcf].toString(),10));Jb.a.Mcf in Aa.Values&&(this.p6a=parseInt(Aa.Values[Jb.a.Mcf].toString(),10));const Ca=y.a.instance;0<this.o6a&&(this.urf(this.o6a,"PageLoadFromHostClick"),
Ca.iej(this.o6a));0<this.p6a&&(this.urf(this.p6a,"PageLoadFromHostFrameCreation"),Ca.jej(this.p6a));const sc=Aa.Values[Jb.a.Rdi]||0,vd=Aa.Values[Jb.a.Pdi]||Aa.Values[Jb.a.Qdi]||0;0<vd&&Ca.Rdj(vd);Ca.Sdj(sc)}catch(Ca){}}Ooj(){this.I0f=this.Z2c=Pa.a.Qa.zb;this.khe=0;this.zmd=this.y7b=!1}hAe(Aa){const Ca=this.Z2c.getTime();return Ca>=Aa?0:Aa-Ca+this.RKf}urf(Aa,Ca){if(Aa){const sc=hc.b();sc.pOb("UserAction",Ca,Ca,Pa.a.jEb(Aa),Zb.EcmaDateClock.instance.appStart);sc.vub(Ca,Da.toTimestamp(this.GLb))}}}Object(b.a)(tb,
"PageLoadPerfInfo",null,[]);var Ib=a(71);class Yb{constructor(Aa,Ca,sc){this.GTc=Aa.keyCode;this.qMb(Aa.ctrlKey,1);this.qMb(Aa.shiftKey,2);this.qMb(Aa.altKey,4);this.qMb(Ib.b(Aa),8);this.qMb(sc,16);this.GTc=this.gfb|Ca<<24}get gfb(){return this.GTc}get keyCode(){return this.gfb&65535}qMb(Aa,Ca){Aa&&(this.GTc=this.gfb|Ca<<16)}}Object(b.a)(Yb,"ShortcutSqmData",null,[]);class vc{constructor(){this.wxd=null;this.$6g={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.xYf()}S1g(Aa,Ca,sc){0===
sc&&(sc=this.$6g[Ca.toString()]);return vc.m7f(Aa,sc)&&(Aa=new Yb(Aa,sc,m.a.isMac),!kf.a.wg(this.wxd,Aa.gfb.toString()))?(this.wxd[Aa.gfb.toString()]=!0,Aa):null}xYf(){this.wxd={}}static Mpi(Aa){return 112<=Aa&&123>=Aa||61440<=Aa&&61451>=Aa}static Zqi(Aa){return 17!==Aa&&18!==Aa&&16!==Aa&&91!==Aa&&93!==Aa}static m7f(Aa,Ca){let sc=Aa.ctrlKey||Aa.altKey||Ib.b(Aa);Aa=Aa.keyCode;sc=vc.Mpi(Aa)||sc;sc=vc.Zqi(Aa)&&sc;return 0!==Ca&&sc}}Object(b.a)(vc,"UnhandledShortcutLogger",null,[]);class Zc{constructor(Aa){this.U4b=
[];this.HRg=null;this.sqmManager=Aa}A_b(Aa){this.U4b.push(Aa)}o6(Aa,Ca,sc){try{if(Ca)Ca.endTime=sc,this.sqmManager.ope(Ca);else for(let vd=0,Td=this.U4b.length;vd<Td;vd++){const ye=this.U4b[vd];Aa?(ye.endTime=ye.startTime,ye.$Ee=0):ye.endTime=sc;this.sqmManager.ope(ye)}}catch(vd){}finally{this.U4b.length=0}}}Object(b.a)(Zc,"UserInteractionPerfInfo",null,[]);var nd=a(36),hd=a(69),Ud=a(233);class ee extends Ra.a{constructor(Aa,Ca){super();this.old=this.IKb=!1;this.p7f=!0;this.Sa=new Ee.a;this.oJc=!1;
this.Bc=()=>{const sc=hd.a(this.$).fd.activityState,vd=kf.a.wg(sc,nd.a.Woe);kf.a.wg(sc,nd.a.Rnb)||vd||this.upload()};this.$=Aa;this.Qwb=Ca;this.ea=Aa.ea;this.$.dk(this.Bc);this.Dgg=new vc;this.mQa=new tb(ha.a.TPd,Aa.va.PageGenerationMetrics.TimeToCompleteFirstFlush);this.LEc=new Zc(this)}pXc(Aa){this.Sa.addHandler("EREK",Aa)}mMd(Aa){this.Sa.removeHandler("EREK",Aa)}get Eih(){return this.oJc}get Vji(){return this.$.frame.mR?dd.a.Xji:dd.a.Wji}get workbookContext(){return this.$.workbookContext}get cU(){ee.Nhb||
(ee.Nhb=this.kQe());ee.$_c||(ee.$_c=!0,this.Def());return ee.Nhb}set cU(Aa){ee.Nhb=Aa;ee.Nhb||(ee.$_c=!1)}get r3(){return Te.a(this.$.va,3)}dispose(){this.Eih&&h.AFrameworkApplication.Un&&h.AFrameworkApplication.Un.disable();this.$&&this.$.Jl(this.Bc);this.$=this.LEc=this.mQa=this.cU=null;super.dispose()}D$e(Aa){this.mQa.Odi(Aa);this.GCi()}pRd(Aa){this.setDw(9415,Aa)}A_b(Aa){this.LEc.A_b(Aa)}o6(Aa,Ca,sc){this.LEc.o6(Aa,Ca,sc)}Vwd(Aa){if(this.r3){const Ca=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;
Aa=this.$.isEditMode||Aa&&this.ea.workbookContext.Options&512?2:Ca?9:this.ea.dc.inEmbedView?14:1;this.setDw(8721,Aa);this.aJh(Aa);this.oJc=!1}}Irf(){const Aa=this.mQa;this.r3&&Aa.n7f&&(this.setDw(9450,Aa.RKf),this.setDw(9085,Aa.Dxi))}Jrf(Aa){if(!this.IKb){this.IKb=!0;const Ca=this.mQa;let sc=0;this.r3&&Ca.n7f?(Ca.eBj(Aa),this.LEc.HRg=Ca.H0f,this.setDw(9086,Ca.s3i),Ca.y7b=!0,sc=this.mQa.GLb.getTime()):sc=Aa.getTime();db.TaskExtensions.Aa(this.Qwb.value,vd=>{vd.result.Oj(Tb.a.ARg,{[Jb.a.BRg]:sc})},
this.la,3)}}ope(Aa){this.r3&&Aa&&1!==Aa.Aea&&this.kha(8327,Oe.b(Aa),Oe.l(Aa),Oe.a(Aa),2,Aa.$Ee,Oe.m(Aa),Oe.d(Aa),Oe.e(Aa))}qNd(Aa,Ca){Aa&&Aa.MessageIdHash&&this.pNd(Aa.MessageIdHash,Aa.MessageIdName,Aa.MessageId,Aa.ErrorCause?Aa.ErrorCause:le.a.fDc,!1,Ca,Aa,null)}pNd(Aa,Ca,sc,vd,Td,ye,df,Kf){ee.appEncounteredFirstError||(ee.appEncounteredFirstError=!0,de.a.get_instance().isCompleted(13)||(de.a.get_instance().Xt(13),e.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));
Aa=this.Eub(Aa);const Tf=!!df,Mf={};Mf.ErrorName=Ca;Mf.ErrorHashCode=Aa.toString();Mf.ErrorId=sc.toString();Mf.ErrorCause=vd.toString();Mf.ErrorType=0===ye?"ErrorDialog":"BusinessBar";Mf.BusinessBarEntryName=Kf||"null";Mf.ServerCorrelationId=Tf?df.CorrelationId:"null";Mf.WebMethodName=Tf?df.WebMethodName:"null";Mf.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Mf.WfeServerId=Tf?df.WfeServerId:"null";Ca=Jd.a.hc(Mf);this.Sa.raiseEvent("EREK",new $a(Mf));e.ULS.sendTraceTag(1881314,
0,15,Ca);this.r3&&(P.a.dSf(Aa.toString()),this.kha(9134,Aa,vd,le.a.t0d),this.ea.Gv||Td||(this.setDw(10459,Aa),this.Vwd(!0),this.old=!0,this.upload(),this.Def()))}Eub(Aa){return 5439488|(Aa>>>16^Aa&65535)&65535}pxd(Aa,Ca,sc){Aa=this.Dgg.S1g(Aa,Ca,sc);this.r3&&Aa&&this.kha(11007,Aa.gfb)}upload(){!this.r3||!this.IKb&&!this.old||m.a.fg&&h.AFrameworkApplication.Lg?m.a.fg&&h.AFrameworkApplication.Lg&&e.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.cU.IQb(),this.oJc=!0);
h.AFrameworkApplication.Un=this.cU=null;this.mQa.Ooj();this.IKb=!1;h.AFrameworkApplication.Un=this.cU=this.kQe();this.Dgg.xYf()}GCi(){const Aa=this.mQa;if(this.r3&&!Aa.zmd){var Ca=Aa.o6a,sc=Aa.p6a,vd=Aa.GLb.getTime();h.AFrameworkApplication.XM=Aa.GLb;Ca&&this.setDw(10324,Ca>vd?0:vd-Ca);sc&&this.setDw(10325,sc>vd?0:vd-sc);Aa.zmd=!0}}kha(Aa,...Ca){this.r3&&this.cU.kha(Aa,...Ca)}setDw(Aa,Ca){this.r3&&this.cU.setDw(Aa,Ca)}kQe(){Ae.a.IQe(this.$.va);return h.AFrameworkApplication.Un}aJh(Aa){let Ca;try{Ca=
Object(I.a)(Object,Jd.a.li(h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(sc){e.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${sc.message}`);return}if(Ca){let sc=Object(I.a)(String,Ca.ApplicationModeExtended),vd=Object(I.a)(String,Ca.ApplicationMode);sc&&vd&&(sc=sc.toUpperCase(),2!==Aa&&16!==Aa||"VIEW"!==sc&&"UNIFIED"!==sc?1!==Aa||"EDIT"!==sc&&"UNIFIED"!==sc||(sc="VIEW",vd="View"):(sc="EDIT",vd="Edit"),Ca.ApplicationModeExtended=sc,Ca.ApplicationMode=
vd,h.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=Jd.a.hc(Ca))}}Def(){const Aa=this.$.va;this.cU.nR=!0;this.cU.xQb(Aa.BWsaStartTime);this.setDw(59,83);this.IKb=!1;if(this.r3){const Ca=Aa.DocumentHostInfo;this.ghh();this.setDw(8491,this.$.JG);this.setDw(9236,Aa.RequestedUILcid);this.setDw(8473,Aa.WacHostId);this.setDw(9902,Oe.c(Ca.ClusterId));rb.EwaSettings.ma(449)?this.cU.J3f(""):this.cU.J3f(Aa.FlightHolder?Aa.FlightHolder.FlightId:"");this.pRd(this.ea.dc.inEmbedView?1:0);this.old=!1;
this.setDw(9104,Oe.c(Ca.FileSourceId));this.setDw(10309,this.Vji);this.aDj();h.AFrameworkApplication.ub.pTf(Re.a.getInstance(!1))}}aDj(){y.a.instance.Mgi(this.cU);if(this.p7f){const Aa=y.a.instance;Aa.Ldj();Aa.cej();Aa.bej();Aa.aej();Aa.Xdj();this.p7f=!1}}ghh(){this.createStream(8327,1,Ud.a.Akh,Ud.a.t2a);this.createStream(9134,1,3,Ud.a.t2a);this.createStream(11007,1,1,Ud.a.t2a)}createStream(Aa,Ca,sc,vd){this.cU.createStream(Aa,Ca,sc,vd)}}ee.Nhb=null;ee.$_c=!1;ee.appEncounteredFirstError=!1;Object(b.a)(ee,
"SqmManager",Ra.a,[144,393]);var ec=a(737);class Vc{constructor(Aa,Ca=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=Aa;this.buffered=Ca}}Object(b.a)(Vc,"PerformanceObserverInit",null,[]);class ud extends Sys.EventArgs{constructor(Aa){super();this.LQe=Aa}}Object(b.a)(ud,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class ke extends Sys.EventArgs{constructor(Aa){super();this.Ngc=Aa}}Object(b.a)(ke,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class te{constructor(Aa){this.Sa=
new Ee.a;this.IMc=!1;this.rg=()=>{if(m.a.Dp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.KEi)).observe(new Vc([dd.a.zxd])),this.IMc=!0)}catch(Ca){this.IMc=!1,e.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Ca}`)}this.Sa.raiseEvent("ltpoiek",new ke(this.Ngc))}};this.KEi=Ca=>{this.Sa.raiseEvent("ltoek",new ud(Ca))};this.$=Aa;this.$.ea.qg?this.rg(this,Sys.EventArgs.Empty):this.$.ea.Kk(this.rg)}get Ngc(){return this.IMc}Pre(Aa){this.Sa.addHandler("ltoek",
Aa)}lkj(Aa){this.Sa.removeHandler("ltoek",Aa)}ANg(Aa){this.Sa.addHandler("ltpoiek",Aa)}mkj(Aa){this.Sa.removeHandler("ltpoiek",Aa)}dispose(){this.$.ea.lo(this.rg);Ac.a.Ia(this.Sa);this.$=this.Sa=null}}Object(b.a)(te,"LongTaskPerformanceObserver",null,[2]);var pe=a(171);class rf{constructor(Aa=0,Ca=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=Aa;this.longTaskDuration=Ca}get Cxd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:
0}ywi(Aa){return 100*this.Cxd>Aa}gLg(Aa){this.Hqe(Aa.longTaskDuration);this.$Wc(Aa.activeSessionDuration)}Hqe(Aa){this.longTaskDuration+=Aa}$Wc(Aa){this.activeSessionDuration+=Aa}}Object(b.a)(rf,"LongTaskPerformanceData",null,[]);class cf{constructor(Aa,Ca,sc,vd,Td){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Aa;this.entireSessionData=Ca;this.worstWindowData=sc;this.postBootWindowData=vd;this.maxUsersCount=
Td}get reportName(){return"LongTaskPerformance"}static get $rh(){return new cf(!1,new rf,new rf,new rf,0)}}Object(b.a)(cf,"LongTaskPerformanceDataStatistics",null,[225]);class wf extends Sys.EventArgs{constructor(Aa){super();this.Axd=Aa}}Object(b.a)(wf,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ge=a(461),Ue=a(377);class gb{constructor(Aa,Ca){this.Sa=new Ee.a;this.nOa=this.r6=this.PS=this.Ce=null;this.qof=this.PUd=this.qkc=!1;this.ROa=null;this.maxUsersCount=0;this.Opc=(sc,vd)=>{sc=vd.LQe.getEntriesByType(dd.a.zxd);
for(const Td of sc)this.Ce.CD(Td.duration)||h.AFrameworkApplication.WNa||(this.PS.Hqe(Td.duration),this.Sa.raiseEvent("lttek",new wf(Td)),sc={},sc.LongTaskDuration=Td.duration,sc.LongTaskStartTime=Td.startTime,e.ULS.sendTraceTag(187982418,0,50,JSON.stringify(sc)))};this.rg=()=>{this.PUd=!0;this.TAc()};this.PB=(sc,vd)=>{vd&&(this.maxUsersCount=Math.max(this.maxUsersCount,vd.j2d));this.r6.maxUsersCount=this.maxUsersCount};this.ed=()=>{this.TAc()};this.Bc=()=>{this.Zag()};this.LEf=(sc,vd)=>{vd.Ngc&&
this.TAc()};this.msf=()=>{this.PS.$Wc(Da.getElapsedMilliseconds(this.nOa,Pa.a.Qa.zb));this.SWd(!0);var sc=!1;this.r6.postBootWindowData.activeSessionDuration?(!this.qof&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.wkg&&hc.b().sXf(2),X.Health.instance.recordKpiUsage(Ue.a.longJsTask,0,Ge.a.Exi,null),this.qof=!0),!this.r6.isVetoSession&&this.PS.ywi(this.nlg)&&(this.r6.isVetoSession=!0,rb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.wkg&&hc.b().tXf(2,this.IEi),X.Health.instance.recordKpiFailure(Ue.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.r6.worstWindowData.Cxd<=this.PS.Cxd&&(this.r6.worstWindowData=this.PS),this.r6.entireSessionData.gLg(this.PS)):(this.r6.postBootWindowData=new rf(this.PS.activeSessionDuration,this.PS.longTaskDuration),sc=!0);const vd={};vd.LastWindowScore=this.PS;vd.postBootWindow=sc;vd.CoauthersNumber=this.$.ea.Ym.length;sc=JSON.stringify(vd);e.ULS.sendTraceTag(20779346,0,50,sc);this.PS=
new rf};this.Goc=()=>{this.Ce.si||h.AFrameworkApplication.WNa||this.SWd(!1)};this.Foc=()=>{this.PS.$Wc(Da.getElapsedMilliseconds(this.nOa,Pa.a.Qa.zb));this.nOa=null;this.ROa.cancel()};this.$=Aa;this.nlg=Aa.va.LongTaskPerformanceVetoThreshold;this.IEi="PercentageOver_"+this.nlg.toString();this.Bxd=Aa.va.LongTaskPerformanceWindowDurationInMs;this.PN=Ca;this.wkg=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.$a(291,sc=>{this.Ce=sc;this.TAc()});this.$.ea.qg?this.rg(this,
Sys.EventArgs.Empty):this.$.ea.Kk(this.rg);this.PN.ANg(this.LEf);this.$.nl(this.ed);this.$.dk(this.Bc)}BNg(Aa){this.Sa.addHandler("lttek",Aa)}nkj(Aa){this.Sa.removeHandler("lttek",Aa)}dispose(){this.PUd=!1;this.Zag();this.$.Kl(this.ed);this.$.Jl(this.Bc);this.PN.mkj(this.LEf);Ac.a.Ia(this.ROa);this.PN=this.$=this.ROa=null;void 0!==this.Ce&&null!==this.Ce&&Ac.a.Ia(this.Ce)}TAc(){void 0===this.Ce||null===this.Ce?e.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.PN.Ngc?this.qkc?e.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.PUd?(this.qkc=!0,this.r6=cf.$rh,this.PS=new rf,this.$.ea.l$(this.PB),this.maxUsersCount=this.$.ea.Ym.length,this.PN.Pre(this.Opc),this.Ce.KGa(this.Foc),this.Ce.LGa(this.Goc),h.AFrameworkApplication.fXc(this.Foc),h.AFrameworkApplication.gXc(this.Goc),this.ROa=Vd.a.instance.create(this.msf,this.Bxd,oa.a.yrf,!1),fc.a(this.$).EY(this.r6),
this.Ce.si||h.AFrameworkApplication.WNa||this.SWd(!0),e.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):e.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):e.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}Zag(){this.qkc&&
(this.qkc=!1,this.$.ea.lo(this.rg),this.PN.lkj(this.Opc),this.$.ea.B7(this.PB),void 0!==this.Ce&&null!==this.Ce&&(this.Ce.Bcb(this.Foc),this.Ce.xRa(this.Goc)),h.AFrameworkApplication.ZUf(this.Foc),h.AFrameworkApplication.$Uf(this.Goc),this.ROa.cancel(),this.nOa=this.PS=this.r6=null,this.maxUsersCount=0)}SWd(Aa){Aa||void 0===this.nOa||null===this.nOa?(this.nOa=Pa.a.Qa.zb,this.ROa=pe.AsyncMethodContext.ifh(this.msf,Aa?this.Bxd:this.Bxd-this.PS.activeSessionDuration,oa.a.yrf,this.ROa)):e.ULS.sendTraceTag(589875356,
0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(b.a)(gb,"LongTaskPerformanceTracker",null,[2]);class Ob extends Ee.a{constructor(Aa,Ca){super();this.statusBarManager=this.Ce=null;this.MEf=(sc,vd)=>{vd.Axd&&vd.Axd.duration>=this.LEi&&(this.zsf++,this.Oof=vd.Axd.duration)};this.$=Aa;this.$.da.$a(29,sc=>{this.statusBarManager=sc;sc.JJ(this)});this.$.da.$a(291,sc=>{this.Ce=
sc});this.Oof=this.zsf=0;this.LEi=Aa.va.LongTaskThresholdMs;this.E9a=Ca;this.E9a.BNg(this.MEf)}Mq(Aa){this.addHandler("LTSCEK",Aa)}hr(Aa){this.removeHandler("LTSCEK",Aa)}Sz(){this.Hn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}rs(Aa,Ca){if("QueryLongTasksCount"!==Aa)return!1;this.$$h(Ca);return!0}Hn(){return rb.EwaSettings.ma(576)}dispose(){this.statusBarManager&&(this.statusBarManager.lG(this),this.statusBarManager=null);this.E9a.nkj(this.MEf);super.dispose()}$$h(Aa){Aa.Value=`Long Tasks: ${this.zsf} | Last Task Duration: ${Math.round(this.Oof)}ms`}}
Object(b.a)(Ob,"LongTasksStatusBarManager",Ee.a,[2,161,162]);var rc=a(11);class Oc{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(b.a)(Oc,"NetworkInfoData",null,[]);class ld extends Ee.a{constructor(Aa){super();this.statusBarManager=null;this.NWc=!1;this.Hxf=()=>{this.raiseEvent("NetworkInformation")};this.$=Aa;rb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.c0=this.W_d("connection")||
this.W_d("mozConnection")||this.W_d("webkitConnection"))&&rb.EwaSettings.ma(465)&&Aa.da.$a(29,Ca=>{this.statusBarManager=Ca;Ca.JJ(this);this.c0.addEventListener("change",this.Hxf);this.NWc=!0})}Mq(Aa){this.addHandler("NetworkInformation",Aa)}hr(Aa){this.removeHandler("NetworkInformation",Aa)}m5a(){return this.c0?Object(zb.a)(new Oc,{bandwidthMps:this.c0.downlink,rttMs:this.c0.rtt,connectionType:this.c0.type,effectiveConnection:this.c0.effectiveType,downlinkMaxMps:this.c0.downlinkMax}):null}rs(Aa,
Ca){if("QueryNetworkInformation"!==Aa)return!1;this.aai(Ca);return!0}Hn(){return this.NWc}dispose(){this.NWc&&(this.statusBarManager&&(this.statusBarManager.lG(this),this.statusBarManager=null),this.c0&&this.c0.removeEventListener("change",this.Hxf));this.$=null;super.dispose()}W_d(Aa){return rc.HelperMethods.Gn(window.navigator,Aa)?window.navigator[Aa]:null}aai(Aa){Aa.Value="Network: "+this.c0.downlink.toString()+" Mbps, "+this.c0.rtt.toString()+" ms"}}Object(b.a)(ld,"NetworkInformationManager",
Ee.a,[161,162]);var Cd=a(187),Qd=a(21);class re{constructor(Aa="",Ca=-1,sc=-1,vd=-1,Td=!1,ye=!0,df=!0,Kf=!1,Tf="",Mf=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=Aa;this.startTime=Ca;this.startToNextFrame=sc;this.startToResponseRenderEnd=vd;this.wasHidden=Td;this.isUserOperation=ye;this.isGroupBreaking=
df;this.operationThatLedToLogging=Tf;this.startToOperationThatLedToLogging=Mf;this.isPartOfGroup=Kf}}Object(b.a)(re,"OperationStatisticsData",null,[]);var Ie=a(79);class qf{constructor(){this.operationsGroups=null;this.fgi()}isGroup(Aa,Ca,sc){const vd=new Cd.a;vd.addRange(Aa);vd.addRange(Ca);for(let Td=0;Td<this.operationsGroups.count;Td++)if(this.vsi(this.operationsGroups.oa(Td),vd,sc))return e.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${sc}' is part of a group ( operationsList: ${this.wKf(Aa)} , frameOperationsList: ${this.wKf(Ca)})`),
!0;e.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${sc}' is NOT part of a group.`);return!1}vsi(Aa,Ca,sc){let vd=0;for(let Td=0;Td<Ca.count;Td++)if(Ca.oa(Td).isGroupBreaking){if(Aa.count<=vd||!pa.a.equals(Ca.oa(Td).name,Aa.oa(vd),!0))return!1;vd++}return Aa.count>vd&&pa.a.equals(sc,Aa.oa(vd),!0)}wKf(Aa){Aa=Ie.select(Aa,Ca=>Ca.name);return`[${Ie.toArray(Aa).join(", ")}]`}fgi(){this.operationsGroups=new Cd.a;let Aa;this.zZa((Aa=new Cd.a,Aa.add("Paste"),Aa.add("SelectingRange_unknown"),
Aa));let Ca;this.zZa((Ca=new Cd.a,Ca.add("AutoSum"),Ca.add("SelectingRange_unknown"),Ca));let sc;this.zZa((sc=new Cd.a,sc.add("ChangeSheetDirection"),sc.add("ActiveItemChanged"),sc));let vd;this.zZa((vd=new Cd.a,vd.add("InsertSheet"),vd.add("ActiveItemChanged"),vd.add("SelectingRange_unknown"),vd));let Td;this.zZa((Td=new Cd.a,Td.add("DeleteSheet"),Td.add("DialogButtonClick"),Td.add("ActiveItemChanged"),Td.add("SelectingRange_unknown"),Td));let ye;this.zZa((ye=new Cd.a,ye.add("EditBoxEndEdit"),ye.add("SetCell"),
ye.add("SelectingRange_keyboard"),ye.add("MoveDownWithinSelectionOrCommitEdit"),ye))}zZa(Aa){this.operationsGroups.add(Aa)}}Object(b.a)(qf,"OperationsGroupDetector",null,[]);var Pe=a(25);class of{constructor(Aa,Ca,sc,vd){this.framePerformanceTracker=this.vKb=this.p0=this.g1=null;this.$mj=()=>{this.EYc=-1;const Td=rc.HelperMethods.Tb();this.g1j(Td);rb.EwaSettings.ma(365)&&(this.OLb&&(e.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.yQb(this.lF,Td),this.OLb=!1),this.Lic&&(this.yQb(this.QD,Td),this.OLb||this.yQb(this.lF,Td)));window.setTimeout(this.ECi,0)};this.ECi=()=>{var Td=[];const ye=this.$.va.OperationToPrevOperationThreshold;for(var df=0;df<this.lF.count;df++){var Kf=this.lF.oa(df);df<ye&&Td.push(Kf);this.QD.add(Kf)}Qd.h(this.$)&&Qd.h(this.$).Ea?((df=this.sessionStatisticsManager.Wfd(0))?(Kf=JSON.stringify(this.ODb),Td=JSON.stringify(Td),e.ULS.sendTraceTag(237798547,1,50,`DOM count: (${df.wIi}, ${df.gVg}, ${df.hHi}), long tasks: ${Kf}, operations count: ${this.lF.count}, operations: ${Td}`)):
e.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.lF.count>ye&&e.ULS.sendTraceTag(537153875,1,50,`More than ${ye} operations are in the operationsList. count: ${this.lF.count}`),this.lF.clear(),this.ODb.clear()):e.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Opc=(Td,ye)=>{this.JEi(ye.LQe)};this.$=Aa;this.TI=Ca;this.Mh=this.Mh||Pa.a.Qa;this.QD=new Cd.a;this.lF=new Cd.a;this.EYc=this.X8a=-1;this.ODb=new Cd.a;this.operationsGroupDetector=
new qf;this.OLb=this.Lic=!1;this.Cgi();this.hgi();this.ggi();this.sessionStatisticsManager=sc;this.PN=vd;this.PN.Pre(this.Opc);this.$.da.$a(263,Td=>{this.framePerformanceTracker=Td})}EKb(Aa,Ca){var sc=rc.HelperMethods.Tb();const vd=rb.EwaSettings.ma(365)?this.operationsGroupDetector.isGroup(this.QD,this.lF,Aa):!1;this.Lic=this.Akf(Aa);rb.EwaSettings.ma(365)?this.Lic&&0<this.QD.count&&!vd&&(this.l0j(),this.Vig(Aa,sc),this.PYe()):0<this.QD.count&&this.Akf(Aa)&&(this.Vig(Aa,sc),this.PYe());this.X8a=
-1;if(Qd.h(this.$)&&Qd.h(this.$).Ea){var Td=!this.g1.contains(Aa);sc=new re(Aa,sc,void 0,void 0,void 0,Td,this.Lic,vd);this.lF.add(sc);this.framePerformanceTracker&&this.framePerformanceTracker.qNj(sc.name,Ca);rb.EwaSettings.ma(365)&&!this.OLb&&this.vKb.contains(Aa)&&(this.OLb=!0);-1===this.EYc&&(this.EYc=window.requestAnimationFrame(this.$mj))}else e.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}Bvc(){this.X8a=rc.HelperMethods.Tb()}Hvc(){this.QD.count||this.lF.count?(this.yQb(this.lF,
this.X8a),this.yQb(this.QD,this.X8a)):e.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.X8a}`);this.X8a=-1}Akf(Aa){return!this.p0.contains(Aa)&&!Aa.includes("Menu")&&!Aa.includes("TellMe")}PYe(){for(let Aa=0;Aa<this.QD.count;Aa++){const Ca=this.QD.oa(Aa);this.TI.$Gg(Ca);this.kDi(Ca)}this.QD.clear()}g1j(Aa){for(let Ca=0;Ca<this.lF.count;Ca++)this.lF.oa(Ca).startToNextFrame=this.Qhd(this.lF.oa(Ca).startTime,Aa),this.lF.oa(Ca).wasHidden=
ec.a.CD(this.lF.oa(Ca).startToNextFrame)}Vig(Aa,Ca){for(let sc=0;sc<this.QD.count;sc++)-1===this.QD.oa(sc).startToResponseRenderEnd&&(this.QD.oa(sc).operationThatLedToLogging=Aa,this.QD.oa(sc).startToOperationThatLedToLogging=this.Qhd(this.QD.oa(sc).startTime,Ca))}l0j(){var Aa=!1;for(let Ca of this.QD)if(Ca.isPartOfGroup){Aa=!0;break}if(Aa)for(Aa=0;Aa<this.QD.count;Aa++)this.QD.oa(Aa).isPartOfGroup=this.QD.oa(Aa).isGroupBreaking}yQb(Aa,Ca){for(let sc=0;sc<Aa.count;sc++)Aa.oa(sc).startToResponseRenderEnd=
this.Qhd(Aa.oa(sc).startTime,Ca),Aa.oa(sc).wasHidden=ec.a.CD(Aa.oa(sc).startToResponseRenderEnd)}kDi(Aa){Aa=JSON.stringify(Aa);e.ULS.sendTraceTag(2020372336,1,50,`${Aa}`)}Qhd(Aa,Ca){return-1===Aa?-1:-1===Ca?-2:Ca-Aa}JEi(Aa){Aa=Aa.getEntriesByType(dd.a.zxd);for(let Ca=0;Ca<Aa.length;Ca++)if(30>this.ODb.count)if(this.lF.count)this.ODb.add(this.a5i(Aa[Ca]));else{const sc=Aa[Ca];if(null===sc||void 0===sc?0:sc.attribution)void 0!==sc.attribution.containerSrc&&null!==sc.attribution.containerSrc&&(sc.attribution.containerSrc=
""),void 0!==sc.attribution.containerId&&null!==sc.attribution.containerId&&(sc.attribution.containerId=""),void 0!==sc.attribution.containerName&&null!==sc.attribution.containerName&&(sc.attribution.containerName="");e.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{e.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Aa.length} First long task: ${this.ODb.oa(0)}`);break}}a5i(Aa){return`name:${Aa.name}, startTime:${Aa.startTime}, duration:${Aa.duration}`}Cgi(){this.g1||
(this.g1=new ab.a(ib.a.cl()),this.g1.add("ActiveItemChanged"),this.g1.add(hc.b().uj(-1398645260)),this.g1.add(hc.b().uj(722290388)),this.g1.add(hc.b().uj(974713501)),this.g1.add(Pe.a.RQ(Pe.a.J4b)),this.g1.add(Pe.a.RQ(Pe.a.I4b)),this.g1.add(Pe.a.RQ(Pe.a.Erb)),this.g1.add(Pe.a.RQ(Pe.a.tPf)),this.g1.add(Pe.a.RQ(Pe.a.Mna)))}hgi(){this.p0||(this.p0=new ab.a(ib.a.cl()),this.p0.add("PromptEditInBrowser"),this.p0.add(hc.b().uj(-1398645260)),this.p0.add(hc.b().uj(722290388)),this.p0.add(hc.b().uj(974713501)),
this.p0.add(Pe.a.RQ(Pe.a.J4b)),this.p0.add(Pe.a.RQ(Pe.a.I4b)),this.p0.add(Pe.a.RQ(Pe.a.Erb)),this.p0.add(Pe.a.RQ(Pe.a.tPf)),this.p0.add(Pe.a.RQ(Pe.a.Mna)))}ggi(){this.vKb||(this.vKb=new ab.a(ib.a.cl()),this.vKb.add("SelectingRange_keyboard"),this.vKb.add("SelectingRange_mouse"))}}Object(b.a)(of,"OperationStatistics",null,[]);var Hb=a(580);class mc{constructor(Aa,Ca){this.messageIdName=null;this.errorCause=0;this.messageIdName=Aa;this.errorCause=Ca}}Object(b.a)(mc,"RequestError",null,[]);class Mc{constructor(Aa,
Ca,sc,vd,Td,ye,df,Kf,Tf,Mf,pg,Zf,wg,fg,Lg,sg,gg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Aa;this.isUserTriggeredRequest=Mc.hYh(Aa);this.isFullyLoggedKPIRequest=Mc.cYh(Aa);this.isPromotedUTRRequest=Mc.dYh(Aa);this.requestDuration=Ca;this.totalOperationDuration=sc;this.requestTimeInQueue=vd;this.requestInvokedTime=Td;this.ecsOperationDuration=ye.EcsOperationDuration;this.EcsRequestDuration=ye.EcsRequestDuration;this.WfeRequestDuration=
ye.WfeRequestDuration;this.TimeFromLastEcsFreeze=ye.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=ye.DuringLoadOnDemand;this.correlationID=df;this.errors=Mc.t9g(Kf);this.httpStatus=Tf;this.requestResourceTiming=Mf;this.communicationErrorRetryCount=pg;this.successfulCall=Zf;this.isDocumentHidden=wg;this.coauthorsCount=fg;this.responseSize=Lg;this.networkInfoData=sg;this.responseToCallbackTime=gg}static t9g(Aa){if(!Aa)return[];const Ca=[];for(const sc of Aa)Ca.push(new mc(sc.MessageIdName,sc.ErrorCause));
return Ca}static hYh(Aa){return!Mc.nLi.contains(Aa)}static w_h(){const Aa=new ab.a(ib.a.cl());Aa.add("CheckPersistedContentUpdate");Aa.add("GetContentBundle");Aa.add("GetSessionStatus");Aa.add("GetStatusBarAggregates");Aa.add("PollSessionStatus");Aa.add("UpdatePresenceUsers");Aa.add("UploadLatencyTelemetry");return Aa}static cYh(Aa){return Mc.DLh.contains(Aa)}static dYh(Aa){return Mc.b$i.contains(Aa)}static KWh(){const Aa=new ab.a(ib.a.cl());Aa.add("SetRichTextCell");Aa.add("Copy");Aa.add("FormatCells");
Aa.add("PasteRange");Aa.add("FindCell");Aa.add("ApplyToRangesV2");Aa.add("ResizeRowsColumns");Aa.add("InsertDeleteCells");Aa.add("FillRange");Aa.add("PasteHtmlContent");Aa.add("ApplyFilter");Aa.add("PasteString");Aa.add("Undo");Aa.add("LineageUpdateView");Aa.add("FindAll");Aa.add("ApplyHyperlink");Aa.add("AutoFit");Aa.add("GetPrintSettings");Aa.add("GetEdgeCell");Aa.add("Paste");Aa.add("MoveAndResizeFloatingObject");Aa.add("FindRange");Aa.add("SetCustomFilter");Aa.add("RenameSheet");Aa.add("ApplyThreadedComment");
Aa.add("SortFilterColumn");Aa.add("InsertCopiedCutCells");Aa.add("InsertSheet");Aa.add("ToggleAutoFilter");Aa.add("ReorderSheets");Aa.add("SetOutlineLevel");Aa.add("RefreshAll");Aa.add("LineageOpenPaneOrChangeFilter");Aa.add("ApplySlicerSelection");Aa.add("GetCardViewCardByCell");Aa.add("AutoSum");Aa.add("LineageClosePane");Aa.add("Sort");Aa.add("ClearAutoFilter");Aa.add("DeleteSheet");Aa.add("Redo");rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Aa.add("RemovePageBreak"),
Aa.add("InsertPageBreak"),Aa.add("SetPrintArea"),Aa.add("ClearPrintArea"));return Aa}static eYh(){const Aa=new ab.a(ib.a.cl());Aa.add("DeleteConditionalFormattingRules");Aa.add("GetConditionalFormattingRules");Aa.add("AddConditionalFormattingRule");Aa.add("QuickEditConditionalFormattingRule");Aa.add("GetPrintSettings");Aa.add("UpdatePresenceUsers");Aa.add("GetThemeInfo");Aa.add("InsertCopiedCutCells");Aa.add("PasteRange");rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(Aa.add("LineageOpenPaneOrChangeFilter"),Aa.add("LineageUpdateView"),Aa.add("LineageRefreshView"),Aa.add("LineageLoadMore"));return Aa}}Mc.nLi=Mc.w_h();Mc.DLh=Mc.KWh();Mc.b$i=Mc.eYh();Object(b.a)(Mc,"RequestStatisticsData",null,[]);class Rb{constructor(Aa,Ca,sc){this.$=Aa;this.TI=Ca;this.nma=sc}Lvc(Aa,Ca,sc,vd,Td,ye,df,Kf,Tf,Mf,pg,Zf,wg,fg){Zf=Hb.a(Zf);Aa=new Mc(Aa,Ca,sc,vd,Td,ye,df,Kf,Tf,Zf,Mf,pg,ec.a.CD(Ca),this.rhd(null),wg,this.nma.m5a(),fg);this.HNd(Aa)}fh(Aa,Ca){Aa="UnknownMethodName";let sc=
-1;void 0!==Ca.context&&null!==Ca.context&&(Aa=Ca.context.methodName,sc=Ca.context.communicationErrorRetryCount);let vd,Td={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Ca.od?(vd=Ca.od.Errors||[],this.TI.Smj(Ca.od.EditSessionIsDirty),void 0!==Ca.od.RequestTelemetryData&&null!==Ca.od.RequestTelemetryData&&(Td=Ca.od.RequestTelemetryData)):vd=[];const ye=Ca.duration,df=Hb.a(Ca.url);Ca=new Mc(Aa,ye,Ca.totalOperationDuration,Ca.jZd,
Ca.PF,Td,Ca.$Qd,vd,Ca.httpStatus,df,sc,!0,ec.a.CD(ye),this.rhd(Ca.od),Ca.responseSize,this.nma.m5a(),Ca.responseToCallbackTime);this.HNd(Ca)}Bm(Aa,Ca){Aa="UnknownMethodName";let sc=-1;void 0!==Ca.context&&null!==Ca.context&&(Aa=Ca.context.methodName,sc=Ca.context.communicationErrorRetryCount);const vd=Ca.duration,Td=Hb.a(Ca.url);Ca=new Mc(Aa,vd,Ca.totalOperationDuration,Ca.jZd,Ca.PF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},
Ca.$Qd,Ca.errors||[],Ca.httpStatus,Td,sc,!1,ec.a.CD(vd),this.rhd(null),-1,this.nma.m5a(),Ca.responseToCallbackTime);this.HNd(Ca)}HNd(Aa){this.TI.yQg(Aa);if(rb.EwaSettings.ma(227)){var Ca=Aa.requestName;if(Ca!==dd.a.swa&&"SetCell"!==Ca&&"FindRange"!==Ca&&"FindAll"!==Ca&&"FindCell"!==Ca)return}Ca=rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Aa.requestName||null===Aa.requestName)&&Aa.isPromotedUTRRequest;Rb.eqh(Aa,Ca);this.TI.aHg(Aa)}rhd(Aa){var Ca;if(null===
(Ca=null===Aa||void 0===Aa?void 0:Aa.CollaborationResult)||void 0===Ca?0:Ca.Users)return Aa.CollaborationResult.Users.length;Aa=this.$.ea.Ym.length;return 0<Aa?Aa:1}static eqh(Aa,Ca){Ca?hc.b().Dxc(388829456,0,15,Aa):(Ca=Sys.Serialization.JavaScriptSerializer.serialize(Aa),e.ULS.sendTraceTag(388829456,0,50,Ca));if(rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Aa.requestName&&null!==Aa.requestName&&Aa.isFullyLoggedKPIRequest){Ca=new Map;Ca.set("isUserTriggeredRequest",
Aa.isUserTriggeredRequest.toString());Ca.set("requestDuration",Aa.requestDuration.toString());Ca.set("totalOperationDuration",Aa.totalOperationDuration.toString());Ca.set("requestTimeInQueue",Aa.requestTimeInQueue.toString());Ca.set("requestInvokedTime",Aa.requestInvokedTime.toString());Ca.set("ecsOperationDuration",Aa.ecsOperationDuration.toString());Ca.set("ecsRequestDuration",Aa.EcsRequestDuration.toString());Ca.set("wfeRequestDuration",Aa.WfeRequestDuration.toString());Ca.set("timeFromLastEcsFreeze",
Aa.TimeFromLastEcsFreeze.toString());Ca.set("duringLoadOnDemand",Aa.DuringLoadOnDemand.toString());Ca.set("correlationID",Aa.correlationID);Ca.set("errors",Aa.errors.toString());Ca.set("httpStatus",Aa.httpStatus.toString());if(Aa.networkInfoData){var sc=Aa.networkInfoData;Ca.set("networkInfoData_bandwidthMps",void 0===sc.bandwidthMps||null===sc.bandwidthMps?"NA":sc.bandwidthMps.toString());Ca.set("networkInfoData_rttMs",void 0===sc.rttMs||null===sc.rttMs?"NA":sc.rttMs.toString());Ca.set("networkInfoData_effectiveConnection",
void 0===sc.effectiveConnection||null===sc.effectiveConnection?"NA":sc.effectiveConnection)}Aa.requestResourceTiming&&(sc=Aa.requestResourceTiming,Ca.set("requestResourceTiming_fetchStart",void 0===sc.downloadDuration||null===sc.downloadDuration?"NA":sc.downloadDuration.toString()));Ca.set("communicationErrorRetryCount",Aa.communicationErrorRetryCount.toString());Ca.set("successfulCall",Aa.successfulCall.toString());Ca.set("isDocumentHidden",Aa.isDocumentHidden.toString());Ca.set("coauthorsCount",
Aa.coauthorsCount.toString());Ca.set("responseSize",Aa.responseSize.toString());Ca.set("responseToCallbackTime",Aa.responseToCallbackTime.toString());hc.b().Ivc(Aa.requestName,Aa.successfulCall,Ca)}}}Object(b.a)(Rb,"RequestStatistics",null,[]);var xc=a(206),ed=a(60),xd=a(314);class yd{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(b.a)(yd,
"OperationTypeStatisticsData",null,[]);class Zd{constructor(Aa,Ca){this.data=new yd;this.data.operationName=Aa;this.data.isUserOperation=Ca;this.data.totalCount=0;this.rag=[];this.sag=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Gd(Aa){this.data.totalCount<Zd.B9c&&(this.rag.push(Aa.startToNextFrame),this.sag.push(Aa.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<
Aa.startToNextFrame&&(this.data.longestStartToNextFrame=Aa.startToNextFrame);this.data.longestStartToResponse<Aa.startToResponseRenderEnd&&(this.data.longestStartToResponse=Aa.startToResponseRenderEnd)}Ccd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.L5e(this.rag),this.data.startToResponsePercentiles=this.L5e(this.sag))}L5e(Aa){Aa.sort(rc.HelperMethods.LB);let Ca;Ca="("+ec.a.Zva(Aa,25).toString();Ca=Ca+", "+ec.a.Zva(Aa,50).toString();Ca=Ca+", "+ec.a.Zva(Aa,75).toString();
Ca=Ca+", "+ec.a.Zva(Aa,95).toString();return Ca+")"}}Zd.B9c=1E3;Object(b.a)(Zd,"OperationTypeStatistics",null,[]);class me{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=
this.requestDurationPercentile25=0}}Object(b.a)(me,"RequestTypeStatisticsData",null,[]);class wb{constructor(Aa){this.data=new me;this.data.requestName=Aa;this.data.totalCount=0;this.Wcb=[];this.p_d=this.h_d=this.i_d=this.m_d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}wnj(Aa){this.data.totalCount<wb.B9c&&this.Wcb.push(Aa.requestDuration);this.data.totalCount++;this.m_d+=Aa.requestDuration;this.i_d+=wb.Zed(Aa.ecsOperationDuration);this.h_d+=wb.Zed(Aa.EcsRequestDuration);this.p_d+=wb.Zed(Aa.WfeRequestDuration);0<Aa.TimeFromLastEcsFreeze&&Aa.TimeFromLastEcsFreeze<wb.rLh&&this.data.callsDuringEcsFreeze++;Aa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Aa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||
null===this.data.longestRequest||this.data.longestRequest.requestDuration<Aa.requestDuration)this.data.longestRequest=Aa}Ccd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.m_d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.i_d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.h_d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.p_d/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=
0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Wcb.sort(rc.HelperMethods.LB),this.data.requestDurationPercentile25=ec.a.Zva(this.Wcb,25),this.data.requestDurationPercentile50=ec.a.Zva(this.Wcb,50),this.data.requestDurationPercentile75=ec.a.Zva(this.Wcb,75),this.data.requestDurationPercentile95=ec.a.Zva(this.Wcb,95))}static Zed(Aa){return 0>Aa?0:Aa}}wb.rLh=3E3;wb.B9c=1E3;Object(b.a)(wb,"RequestTypeStatistics",null,[]);class $b{constructor(Aa,Ca,sc,vd,Td,ye,df,Kf){this.mode=null;
this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Aa;this.ocsCapable=Ca;this.endedBySplashScreen=sc;this.dirtySessionOnLastRecordedRequest=vd;this.loadOnDemandCount=Td;this.maxCoauthorsCount=ye;this.everConnectedToOcs=df;Aa=[];for(let Tf in Kf)Ca=Kf[Tf],Ca.Ccd(),Aa.push(Ca.data);this.requests=Aa}}Object(b.a)($b,"SessionStatisticsData",null,[]);class uc{constructor(Aa){this.dirtySessionOnLastRecordedRequest=
this.NWd=!1;this.qqf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Aa;this.Anb={};this.znb={};this.u7c={}}Bc(){var Aa=this.gih();if(ha.a.hea()){var Ca={};Ca.xlendJson=Aa;this.$.$na(xc.a.P5j,Ca,!1)}else ed.N(this.$.pa.ya,Aa,null,null,null,null,null);Aa=this.hih();ha.a.hea()?(Ca={},Ca.xlenoJson=Aa,this.$.$na(xc.a.Q5j,Ca,!1)):e.ULS.sendTraceTag(388776782,0,50,Aa);rb.EwaSettings.ma(69)&&(Aa=this.zch(),ha.a.hea()?(Ca={},Ca.xlencJson=Aa,this.$.$na(xc.a.O5j,Ca,!1)):e.ULS.sendTraceTag(388776770,
0,50,Aa));this.coj()}rkc(){this.everConnectedToOcs=this.$.ea.E8a||this.everConnectedToOcs;X.Health.instance&&X.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}rg(){const Aa=new xd.a;let Ca="";const sc=!this.$.isAnonymousUser(),vd=Aa.re();if(vd){if(sc){Aa.vyc("UMI_Linkable","true");return}Ca=Aa.h5a("UMI_Linkable")}sc||e.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${vd}, UMIIsLinkable:${!!Ca}`)}Ucb(){this.NWd=
!0}Smj(Aa){this.dirtySessionOnLastRecordedRequest=Aa}yQg(Aa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Aa.coauthorsCount);X.Health.instance&&X.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}aHg(Aa){if(!(Aa.requestName in this.Anb)){const Ca=new wb(Aa.requestName);this.Anb[Aa.requestName]=Ca}this.Anb[Aa.requestName].wnj(Aa)}$Gg(Aa){if(!(Aa.name in this.znb)){const Ca=new Zd(Aa.name,Aa.isUserOperation);this.znb[Aa.name]=Ca}this.znb[Aa.name].Gd(Aa)}EY(Aa){this.u7c[Aa.reportName]=
Aa}coj(){this.dirtySessionOnLastRecordedRequest=this.NWd=!1;this.qqf=this.$.ea.mwd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.Anb={};this.znb={};this.u7c={}}gih(){const Aa=new $b(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.NWd,this.dirtySessionOnLastRecordedRequest,this.$.ea.mwd-this.qqf,this.maxCoauthorsCount,this.everConnectedToOcs,this.Anb);return Sys.Serialization.JavaScriptSerializer.serialize(Aa)}hih(){var Aa=new Cd.a;const Ca=this.znb;for(let sc in Ca){const vd=
Ca[sc];vd.Ccd();Aa.add(vd.data)}Aa=Aa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Aa)}zch(){return Sys.Serialization.JavaScriptSerializer.serialize(this.u7c)}}Object(b.a)(uc,"SessionStatistics",null,[]);class Pc extends Ra.a{constructor(Aa){super();this.Jna=this.Wma=null;this.AKe=Array(1);this.kPc=this.Dxd=null;this.fh=(Ca,sc)=>{rb.EwaSettings.ma(40)&&(this.Jna=this.Jna||new Rb(this.$,this.TI,this.nma),this.Jna.fh(Ca,sc))};this.Bm=(Ca,sc)=>{rb.EwaSettings.ma(40)&&(this.Jna=this.Jna||
new Rb(this.$,this.TI,this.nma),this.Jna.Bm(Ca,sc))};this.Bc=(Ca,sc)=>{rb.EwaSettings.ma(40)&&this.TI.Bc(Ca,sc)};this.rg=(Ca,sc)=>{rb.EwaSettings.ma(40)&&this.TI.rg(Ca,sc)};this.rkc=(Ca,sc)=>{rb.EwaSettings.ma(40)&&this.TI.rkc(Ca,sc)};this.$=Aa;rb.EwaSettings.ma(40)&&(ec.a.ygi(this.$),this.PN=new te(this.$),this.teh(),rb.EwaSettings.ma(576)&&this.E9a&&(this.Dxd=new Ob(this.$,this.E9a)),this.TI=new uc(this.$),this.nma=new ld(this.$),this.$.dk(this.Bc),this.$.pa.Nq(this.fh),this.$.pa.kw(this.Bm),this.$.ea.Fre(this.rkc),
rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Kk(this.rg))}get E9a(){return this.kPc}dispose(){this.$&&rb.EwaSettings.ma(40)&&(this.$.Jl(this.Bc),this.$.pa.Nr(this.fh),this.$.pa.jx(this.Bm),this.$.ea.HVf(this.rkc),rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.lo(this.rg));Ac.a.Ia(this.nma);Ac.a.Ia(this.E9a);this.kPc=null;Ac.a.Ia(this.PN);this.PN=null;Ac.a.Ia(this.Dxd);this.$=this.Dxd=null;super.dispose()}Ucb(){rb.EwaSettings.ma(40)&&
this.TI.Ucb()}Lvc(Aa,Ca,sc,vd,Td,ye,df,Kf,Tf,Mf,pg,Zf,wg,fg){rb.EwaSettings.ma(40)&&(this.Jna=this.Jna||new Rb(this.$,this.TI,this.nma),this.Jna.Lvc(Aa,Ca,sc,vd,Td,ye,df,Kf,Tf,Mf,pg,Zf,wg,fg))}EKb(Aa,Ca){rb.EwaSettings.ma(40)&&(this.Wma=this.Wma||new of(this.$,this.TI,this,this.PN),this.Wma.EKb(Aa,Ca))}Bvc(){rb.EwaSettings.ma(40)&&(this.Wma=this.Wma||new of(this.$,this.TI,this,this.PN),this.Wma.Bvc())}Hvc(){rb.EwaSettings.ma(40)&&(this.Wma=this.Wma||new of(this.$,this.TI,this,this.PN),this.Wma.Hvc())}EY(Aa){rb.EwaSettings.ma(40)&&
this.TI.EY(Aa)}Wfd(Aa){return rb.EwaSettings.ma(40)?this.AKe[Aa]:null}t3f(Aa){Aa&&(this.AKe[Aa.type]=Aa)}m5a(){return this.nma.m5a()}teh(){m.a.Dp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.kPc=new gb(this.$,this.PN))}}Object(b.a)(Pc,"SessionStatisticsManager",Ra.a,[11]);var Ad=a(100),ba=a(1116),cb=a(118),Kb=a(127);class lc{constructor(Aa,Ca){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Aa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=Ca}DZd(){return Jd.a.hc(this)}}Object(b.a)(lc,"AppUnloadInfo",null,[]);var Qc=a(691),Rc=a(121),zd=a(562);class ae{constructor(Aa){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Aa.sEe+Aa.vgg;this.dataLossReason=Aa.qAe;this.Z_g(Aa.h2d)}Z_g(Aa){const Ca=new Qc.a(zd.a.zK());let sc=0,vd=0;for(const Td of Aa)Ca.lb(Td)||Ca.ia(Td,0),Aa=Ca.ia(Td,Ca.oa(Td)+1),Aa>
sc&&(sc=Aa,vd=Td);sc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Rc.a(vd),this.mostCommonOperationCount=sc)}}Object(b.a)(ae,"DataLossInfo",null,[]);var ze=a(57);class Be{constructor(Aa){this.MYc="AppUnloadInfo";this.Im=this.$=this.workbookHashedId=this.lz=null;this.K5d=this.c9d=!1;this.Re=null;this.Qdf=0;this.dda=(Ca,sc)=>{this.Qdf=sc.kCc};this.yJf=(Ca,sc)=>{sc.h2d.length&&this.$.BD&&(this.lz.dataLossInfo=new ae(sc),this.lz.wasDataLostDuringUnload=!0,this.xdb())};this.rg=()=>{this.Q1f();
this.$.ea.lo(this.rg)};this.CPa=()=>{this.lz.wasUpdatedOnBeforeUnload=!0;this.lz.inactivityDurationBeforeUnloadSeconds=this.Re.Nfb<Be.xHi?this.Qdf:this.Re.Nfb;this.Rig()};this.WGb=()=>{this.lz.wasUpdatedOnUnload=!0;this.Rig();Sys.Application.remove_unload(this.WGb)};this.i_i=()=>{this.lz.lastSilentReopenStartTime=Pa.a.Qa.zb;this.lz.lastSilentReopenEndTime=null;this.xdb();this.$.nl(this.xIf)};this.xIf=()=>{this.lz.lastSilentReopenEndTime=Pa.a.Qa.zb;this.xdb();this.$.Kl(this.xIf)};this.localStorage=
new xd.a;this.localStorage.re()&&(this.$=Aa,this.workbookHashedId=ze.a(this.$),this.lz=new lc(this.workbookHashedId,this.$.va.UserSessionId),this.Im=Kb.a.instance.wH(),this.Im.ka("beforeunload",this.CPa),this.$.userOperationManager.qPg(this.yJf),Aa.ea.qg?this.Q1f():this.$.ea.Kk(this.rg),this.Re=this.$.ea.Re,this.Re.pha(this.dda),Sys.Application.add_unload(this.WGb),this.$.ea.RXc(this.i_i))}get dialogPromptedOnUnload(){return this.c9d}set dialogPromptedOnUnload(Aa){this.c9d=Aa;this.lz?(this.lz.dialogPromptedOnUnload=
Aa,this.xdb()):this.localStorage.re()&&e.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.re()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.K5d}set apiBeforeCloseNotificationEnabledOnUnload(Aa){this.K5d=Aa;this.lz?(this.lz.apiBeforeCloseNotificationEnabledOnUnload=Aa,this.xdb()):this.localStorage.re()&&e.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.re()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.Ilj(this.yJf);this.Re&&(this.Re.KAa(this.dda),this.Re=null);this.Im.iD();this.$=this.Im=null}Rig(){this.WBj();this.xdb()}WBj(){this.lz.wasOfflineDuringUnload=this.$.Te.H5;this.lz.timeFromLastConnectivity=cb.a(Pa.a.Qa,this.$.Te.lpf);this.lz.timeFromLastDisconnectionStart=cb.a(Pa.a.Qa,this.$.Te.pyi);this.lz.disconnectionSource=Enum.toString(ba.a,this.$.Te.disconnectionSource);this.lz.hadConnectivityIssuesDuringUnload=this.$.Te.lla;this.lz.timeFromLastStatusCode0=
cb.a(Pa.a.Qa,this.$.Te.kpf)}xdb(){this.lz.timestamp=Date.now();this.localStorage.vyc(this.MYc,this.lz.DZd())}Q1f(){const Aa=this.localStorage.h5a(this.MYc);if(Aa)try{const Ca=Jd.a.li(Aa);this.localStorage.LJb(this.MYc);const sc=this.SFi(Ca);e.ULS.sendTraceTag(574677456,0,50,sc)}catch(Ca){e.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Ca.message}`)}else e.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}SFi(Aa){const Ca=
{};Ca.WACSessionID=Aa.wacSessionId;Ca.wasRefreshed=this.N3g(Aa,this.$.va.MaxAppReloadDurationIndicatingRefresh);Ca.closedWithDialogConfirmation=Aa.dialogPromptedOnUnload;Ca.wasOfflineDuringUnload=Aa.wasOfflineDuringUnload;Ca.TimeFromLastConnectivityMs=Aa.timeFromLastConnectivity;Ca.TimeFromLastDisconnectionStart=Aa.timeFromLastDisconnectionStart;Ca.wasDataLostDuringUnload=Aa.wasDataLostDuringUnload;Ca.DataLossInfo=Aa.dataLossInfo;Ca.flushedOnUnload=Aa.wasUpdatedOnUnload;Ca.flushedOnBeforeUnload=Aa.wasUpdatedOnBeforeUnload;
Ca.InactivityDurationBeforeUnload=Aa.inactivityDurationBeforeUnloadSeconds;Ca.DisconnectionSource=Aa.disconnectionSource;Ca.hadConnectivityIssuesDuringUnload=Aa.hadConnectivityIssuesDuringUnload;Ca.TimeFromLastStatusCode0=Aa.timeFromLastStatusCode0;Ca.LastSilentReopenStartTime=Aa.lastSilentReopenStartTime;Ca.LastSilentReopenEndTime=Aa.lastSilentReopenEndTime;rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Ca.ApiBeforeCloseNotificationEnabledOnUnload=
Aa.apiBeforeCloseNotificationEnabledOnUnload);return G.c(Ca)}N3g(Aa,Ca){const sc=window.performance.timing.navigationStart-Aa.timestamp;(Aa=this.workbookHashedId===Aa.workbookHashedId&&sc<Ca)&&e.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Aa}static ka(Aa){Aa.ea.dc.inWebPart||Aa.da.Ga(410,new Be(Aa))}}Be.xHi=10;Object(b.a)(Be,"AppUnloadTelemetryManager",null,[472,2]);var xe=a(170),Ce=a(109);class ef{constructor(Aa,Ca){this.stopped=!1;this.chainedCallsTracer=
Aa;this.bug=Ca}get call(){return this.bug}Sag(){e.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.jOj(this))}dispose(){this.Sag()}}Object(b.a)(ef,"CallMeasureContext",null,[476,2]);class Jf{constructor(Aa,Ca){this.Cbd=0;this.OVe=this.startTime=rc.HelperMethods.Tb();this._name=Aa;this.BC=Ca}get name(){return this._name}get type(){return this.BC}g$g(){this.OVe=
rc.HelperMethods.Tb()}Pag(){this.Cbd+=rc.HelperMethods.Tb()-this.OVe}LXh(){return rc.HelperMethods.Tb()-this.startTime}cOj(){this.Pag();return this.Cbd}}Object(b.a)(Jf,"MeasuredCall",null,[]);class Ia{constructor(Aa){this.ita=[];this.P1c=null;this.rIi=100;this.documentVisibilityObserver=null;this.qIi=Aa}fag(Aa,Ca){this.Oeh();this.fOj();Aa=new Jf(Aa,Ca);this.ita.push(Aa);return new ef(this,Aa)}Oeh(){0<this.ita.length?e.ULS.shipAssertTag(537151054,1,!!this.P1c,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.P1c=xe.a.create().toString()}jOj(Aa){const Ca=this.ita.pop();if(Aa.call!==Ca)e.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",Aa.call.name,Ca?Ca.name:"null"),this.ita=[];else{Aa=Ca.LXh();var sc=Ca.cOj();e.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var vd=
this.documentVisibilityObserver?this.documentVisibilityObserver.CD(Aa+this.rIi):null;this.rCi(Ca,Aa,sc,vd);this.h$g()}}fOj(){const Aa=this.e4e();Aa&&Aa.Pag()}h$g(){const Aa=this.e4e();Aa&&Aa.g$g()}e4e(){return this.ita.length?this.ita[this.ita.length-1]:null}rCi(Aa,Ca,sc,vd){if(!(Ca<this.qIi)){var Td=Ce.f(this.ita,ye=>ye.name).join();e.ULS.sendTraceTag(537151051,0,50,`ChainedCallsTracer: Inclusive duration: ${Ca.toFixed(2)} Exclusive duration: ${sc.toFixed(2)} Chain ID: ${this.P1c} Call ID: ${Aa.name} Type: ${Aa.type} Document hidden: ${vd} Call chain: ${Td}`)}}static ka(Aa){if(rb.EwaSettings.ma(670)){var Ca=
new Ia(Aa.va.ChainedCallsTracerMinThresholdToLogInMs);Aa.da.$a(291,sc=>{Ca.documentVisibilityObserver=sc});Aa.da.Ga(425,Ca);Ee.a.pxj(Ca)}}}Object(b.a)(Ia,"ChainedCallsTracer",null,[468]);var Bb=a(518);class zc{constructor(Aa){this.Ce=null;this.HTj=Ca=>{const sc={["TaskName"]:Ca.TN,["TotalRunInMs"]:Ca.TRT,["TotalDelayInMs"]:Ca.TDT,["TotalQueueInMs"]:Ca.TQT,["TaskPriority"]:Ca.TP,["CoauthorsCount"]:this.ea.Ym.length};Ca.TDT>this.sZd||Ca.TRT>this.qZd?e.ULS.sendTraceTag(321938518,0,15,C.a.toJSON(sc)):
(Ca.TDT>this.rZd||Ca.TRT>this.pZd)&&e.ULS.sendTraceTag(321938508,0,50,C.a.toJSON(sc))};this.pHh=Ca=>this.Ce.CD(Ca.TRT+Ca.TQT+3E3)?!1:Ca.TDT>Math.min(this.rZd,this.sZd)||Ca.TRT>Math.min(this.pZd,this.qZd);this.sZd=Aa.va.TimeToReportOnLongWaitingTaskInMsAsWarning;this.rZd=Aa.va.TimeToReportOnLongWaitingTaskInMsAsMedium;this.qZd=Aa.va.TimeToReportOnLongRunningTaskInMsAsWarning;this.pZd=Aa.va.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=Aa.ea;Aa.da.$a(291,Ca=>{this.Ce=Ca});e.ULS.sendTraceTag(537151046,
0,50,`TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = ${this.rZd}, TimeToReportOnLongWaitingTaskInMsAsWarning = ${this.sZd}, TimeToReportOnLongRunningTaskInMsAsMedium = ${this.pZd}, TimeToReportOnLongRunningTaskInMsAsWarning = ${this.qZd}`)}}Object(b.a)(zc,"TaskEventProcessor",null,[]);const ad=Aa=>{e.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");db.TaskExtensions.Aa(Bb.a.mr(bb.a.instance.Ub("Common.ICpuMeterProvider")),
Ca=>{e.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");db.TaskExtensions.Aa(Ca.result.vk.task,sc=>{e.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");const vd=new zc(Aa);sc.result.yWc(0,vd.pHh,vd.HTj)},Aa.la,3)},Aa.la,3)};var sd=a(13);class Sd{constructor(Aa){this.lLe=!1;this.nLe=null;this.Pc=()=>{this.Arj();Qd.h(this.$).ha&&Qd.h(this.$).ha.JI(this.Pc)};
this.Eh=(Ca,sc)=>{sc.na&&!this.YYd.has(sc.na.name)&&(this.YYd.add(sc.na.name),Qd.h(this.$).ha&&(Qd.h(this.$).ha.JI(this.Pc),Qd.h(this.$).ha.QE(this.Pc)))};this.$=Aa;this.gdg=new Set;this.YYd=new Set;this.$.xa&&this.$.xa.na&&this.YYd.add(this.$.xa.na.name);Qd.h(this.$).ha.QE(this.Pc);this.$.xa.Uf(this.Eh)}dispose(){this.$=null}Arj(){this.nLe||this.h0g();const Aa=Qd.d(Qd.h(this.$));if(!this.lLe){const Ca=sd.a.instance.Ua(281).split(",");Aa.push(...Ca);this.lLe=!0}for(const Ca of Aa)Ca&&!this.gdg.has(Ca)&&
(this.BCi(Ca),this.gdg.add(Ca))}BCi(Aa){this.f1g(Aa)}h0g(){this.nLe=Sd.c5a("monospace");Sd.c5a("sans-serif");Sd.c5a("serif")}f1g(Aa){Sd.c5a(`${Aa},${"monospace"}`);Sd.c5a(`${Aa},${"sans-serif"}`);Sd.c5a(`${Aa},${"serif"}`)}static ka(Aa){if(rb.EwaSettings.ma(62)){const Ca=new Sd(Aa);Aa.da.Ga(210,Ca)}}static c5a(Aa){const Ca=document.createElement("div"),sc=document.createElement("div");Ca.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Sd.HBj(sc,Aa);document.body.appendChild(Ca);
Ca.appendChild(sc);rb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&rb.EwaSettings.isChangeGateEnabled("OfficeVSO:7190190_ReduceInnerHTMLUsageForFontTelemetryManager")?sc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+":sc.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Aa=sc.offsetWidth+"x"+sc.offsetHeight;document.body.removeChild(sc.parentNode);return Aa}static HBj(Aa,Ca){Aa.style.cssText=
"display: inline; visibility: hidden;";Aa.style.fontSize="100px";Aa.style.fontWeight="normal";Aa.style.fontStyle="normal";Aa.style.letterSpacing="normal";Aa.style.lineHeight="normal";Aa.style.whiteSpace="nowrap";Aa.style.fontFamily=Ca}}Object(b.a)(Sd,"FontTelemetryManager",null,[2]);var fe=a(235),qe=a(161),mf;(function(Aa){Aa[Aa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Aa[Aa.reactSingleLineRibbon=1]="reactSingleLineRibbon";Aa[Aa.reactMultiLineRibbon=2]="reactMultiLineRibbon";Aa[Aa.invalid=
3]="invalid"})(mf||(mf={}));Object(b.b)("RibbonMode",mf);var Me=a(104);class Af extends Ee.a{constructor(){super();this.mM=!1;this.Ede=this.Dde=null;this.cDd=()=>{this.Iig()};this.uXi=()=>{Ac.a.Ia(this.wZ);Ac.a.Ia(this.Im)};this.wZ=Kb.a.instance.OIa();this.Im=Kb.a.instance.wH();this.wZ.ka("visibilitychange",this.cDd);this.Im.ka("pagehide",this.uXi);this.Iig()}get si(){return this.mM}get Dof(){return this.Dde}get Wkc(){return this.Ede}KGa(Aa){this.addHandler("ekdh",Aa)}Bcb(Aa){this.removeHandler("ekdh",
Aa)}LGa(Aa){this.addHandler("ekduh",Aa)}xRa(Aa){this.removeHandler("ekduh",Aa)}CD(Aa){return this.si?!0:this.Wkc?Da.getElapsedMilliseconds(this.Wkc,Pa.a.Qa.zb)<Aa:!1}dispose(){Ac.a.Ia(this.wZ);Ac.a.Ia(this.Im);super.dispose()}Iig(){this.mM="hidden"===window.document.visibilityState;this.si?(this.raiseEvent("ekdh"),this.Dde=Pa.a.Qa.zb):(this.raiseEvent("ekduh"),this.Ede=Pa.a.Qa.zb)}}Object(b.a)(Af,"DocumentVisibilityObserver",Ee.a,[420,2]);class Bf{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(b.a)(Bf,"FramePerformanceData",null,[]);class He{constructor(Aa){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new Bf;this.l2FramePerformanceData=new Bf;this.l3FramePerformanceData=new Bf;this.name=Aa}}Object(b.a)(He,"FramePerformanceDataGroup",null,[]);class Cf{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(b.a)(Cf,"FramePerformanceSessionEndsReport",null,[225]);class Qf{constructor(Aa){this.uFd={};this.tha=null;this.Fgb=(Ca,sc)=>{Ca.longFramesOverThresholdOps++;Ca.maxLongFrameDuration=Math.max(Ca.maxLongFrameDuration,sc)};this.kf=new Cf;this.efh();Aa.da.$a(276,()=>{fc.a(Aa).EY(this.kf)})}efh(){this.tha=new He("AllGridOperationsData");this.kf.operationsGroups.push(this.tha);this.Csb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Csb("DragScroll",["DragScroll"]);this.Csb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Csb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Csb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}pnj(Aa,Ca,sc,vd){const Td=this.GWh(Aa);Td&&(Ce.b(this.kf.operationsGroups,ye=>pa.a.equals(ye.name,Td.name,!1))||this.kf.operationsGroups.push(Td),Td.count++,this.fEc(Ca,Td),this.bEc(sc,Td),this.tha.count++,
this.fEc(Ca,this.tha),this.bEc(sc,this.tha),0<vd&&this.T_j(vd,Td),0<=Ca&&this.k_j(Ca,Td))}v0j(){for(const Aa of this.kf.operationsGroups)Qf.o_j(Aa)}Csb(Aa,Ca){Aa=new He(Aa);for(const sc of Ca)this.uFd[sc]=Aa}GWh(Aa){return Aa in this.uFd?this.uFd[Aa]:null}k_j(Aa,Ca){30>Aa&&this.O0d(sc=>{sc.l1FramePerformanceData.fpsUnderThresholdOps++},Ca);15>Aa&&this.O0d(sc=>{sc.l2FramePerformanceData.fpsUnderThresholdOps++},Ca);5>Aa&&this.O0d(sc=>{sc.l3FramePerformanceData.fpsUnderThresholdOps++},Ca)}T_j(Aa,Ca){100<=
Aa&&(this.Ggb(Ca.l1FramePerformanceData,Aa,this.Fgb),this.Ggb(this.tha.l1FramePerformanceData,Aa,this.Fgb));300<=Aa&&(this.Ggb(Ca.l2FramePerformanceData,Aa,this.Fgb),this.Ggb(this.tha.l2FramePerformanceData,Aa,this.Fgb));600<=Aa&&(this.Ggb(Ca.l3FramePerformanceData,Aa,this.Fgb),this.Ggb(this.tha.l3FramePerformanceData,Aa,this.Fgb))}O0d(Aa,Ca){Ca&&(Aa(Ca),Aa(this.tha))}Ggb(Aa,Ca,sc){Aa&&sc(Aa,Ca)}fEc(Aa,Ca){Ca.minFPS=-1===Ca.minFPS?Aa:Math.min(Ca.minFPS,Aa)}bEc(Aa,Ca){Ca.maxFPS=Math.max(Ca.maxFPS,
Aa)}static o_j(Aa){Qf.o1d(Aa.l1FramePerformanceData,Aa.count);Qf.o1d(Aa.l2FramePerformanceData,Aa.count);Qf.o1d(Aa.l3FramePerformanceData,Aa.count)}static o1d(Aa,Ca){Aa.fpsUnderThresholdOpsPercentage=100*Aa.fpsUnderThresholdOps/Ca;Aa.longFramesOverThresholdOpsPercentage=100*Aa.longFramesOverThresholdOps/Ca}}Object(b.a)(Qf,"FramePerformanceSessionEndsReportManager",null,[]);class Qg{constructor(){this.f=null}}Object(b.a)(Qg,"FpsDataWrapper",null,[]);class ah{constructor(Aa=-1,Ca=-1){this.duration=
this.startSecond=0;this.startSecond=Aa;this.duration=Ca}}Object(b.a)(ah,"LongFrameData",null,[]);var ng=a(346);class Ya{constructor(Aa=null,Ca=0,sc=-1,vd=-1,Td=0,ye=-1,df=0,Kf=-1,Tf=-1,Mf=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=Aa;this.count=Ca;this.start=sc;this.end=vd;this.Avg=Td;this.Max=ye;this.Min=ng.a.Jog;this.longFrameCount=df;this.coauth=Kf||1;this.tfAppInt=Tf;this.Props=
Mf;this.LFrame=null}}Object(b.a)(Ya,"OperationFPSData",null,[]);var yb=a(34),Wb=a(790);class Cc extends Ra.a{constructor(Aa){super();this.Wob=-1;this.dvd=0;this.pya=new Date(0);this.SY=null;this.Iia={};this.Xua=new Cd.a;this.LOd=this.b9a=!1;this.m4a=null;this.bCc=this.x$a=0;this.isSynthetic=!1;this.HZe=()=>{const Ca=new Date;var sc=Ca.getMinutes();const vd=Ca.getSeconds();this.RCb&&Ca.getTime()-this.RCb.getTime()>this.sRj?(this.stop(),this.pdd(Ca)):(sc!==this.dvd&&(this.pdd(Ca),this.dvd=sc),this.b9a&&
(this.Ce.si?this.SY[vd]=Cc.t8b:(this.KMe(vd),this.b9a=!1,this.Xua.clear(),this.Iia={})),this.SY[vd]!==Cc.t8b&&(this.SY[vd]++,sc=Ca.getTime()-this.pya.getTime(),sc>this.wsf&&this.ZCi(this.pya,sc)),this.Wob=window.requestAnimationFrame(this.HZe),this.pya=Ca)};this.dW=()=>{this.b9a=!0};this.hzf=()=>{this.pause()};this.jzf=()=>{this.LOd&&this.resume()};this.Gj=()=>{this.Ea.l5()&&this.b0j()};this.RCb=new Date;this.Ce=new Af;this.Ce.KGa(this.dW);h.AFrameworkApplication.fXc(this.hzf);h.AFrameworkApplication.gXc(this.jzf);
this.$=Aa;this.wsf=Aa.va.LongFrameThresholdMs;this.HEi="MoreThan_"+this.wsf.toString()+"_Ms";this.rRj=Aa.va.ThresholdToEndOperationTrackingSeconds;this.sRj=Aa.va.ThresholdToStopFPSTrackingMS;this.Ea=Qd.h(this.$).Ea;h.AFrameworkApplication.Pb&&h.AFrameworkApplication.Pb.IsSynthetic&&(this.isSynthetic=pa.a.compare(h.AFrameworkApplication.Pb[dd.a.isSynthetic],"True",!0)?!1:!0);this.Ea.jw(this.Gj);this.dOd();this.$Ci=this.$.ula&&rb.EwaSettings.ma(575)}start(){this.LOd=!0;this.resume()}stop(){this.LOd=
!1;this.pause()}dispose(){this.stop();this.Ce.Bcb(this.dW);h.AFrameworkApplication.ZUf(this.hzf);h.AFrameworkApplication.$Uf(this.jzf);Ac.a.Ia(this.Ce);this.Ea.ix(this.Gj);super.dispose()}qNj(Aa,Ca){const sc=Aa in this.Iia?this.Iia[Aa]:null;this.RCb=new Date;this.start();const vd=this.RCb.getSeconds(),Td=vd+this.rRj;sc&&vd<=sc.end?(sc.count++,sc.end=Td):(sc&&vd>sc.end&&this.Xua.add(sc),this.Iia[Aa]=new Ya(Aa,1,vd,Td,void 0,void 0,void 0,this.$.ea.Ym.length,pb.PageLoadTrackingInfo.instance.twa(this.RCb),
Ca))}udh(){this.m4a||(this.pdd(new Date),this.m4a=new Qf(this.$))}resume(){this.qif()||!this.Ea.tL||this.isSynthetic||(this.b9a=this.Ce.si,this.pya=new Date,this.dvd=this.pya.getMinutes(),this.dOd(),this.KMe(this.pya.getSeconds()),this.Wob=window.requestAnimationFrame(this.HZe))}qif(){return 0<=this.Wob}pause(){this.qif()&&(this.b9a||(this.LMe((new Date).getSeconds()),e.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.SY.toString()}`)),window.cancelAnimationFrame(this.Wob),this.Wob=-1)}pdd(Aa){if(Aa.getTime()-
this.pya.getTime()<Cc.oIi&&(this.b9a&&this.LMe(this.pya.getSeconds()),this.tsh(),0<this.Xua.count&&(Aa={},Aa.NonEmptyCellsCount=this.x$a,Aa.TextCellsCount=this.bCc,Aa.xlfpsJson=Object(zb.a)(new Qg,{f:this.Xua.toArray()}),Aa.memoryInfo=this.MHi(),Aa.zoom=yb.a(this.$)?yb.a(this.$).zoom:1,Aa.RibbonMode=qe.a(this.$)?mf[qe.a(this.$).AO]:Cc.invalid,Aa.deviceMemory=navigator.deviceMemory||0,Aa.hardwareConcurrency=navigator.hardwareConcurrency||0,Aa=JSON.stringify(Aa),e.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.SY.toString()}`),
!this.isSynthetic))){if(ha.a.hea()){var Ca={};Ca.xlfpsJson=Aa;this.$.$na(xc.a.R5j,Ca,!1)}else e.ULS.sendTraceTag(388781010,0,50,`${Aa}`);if(this.$Ci)for(let sc of this.Xua){Ca=1E3>=this.x$a?"0_1000":3E3>=this.x$a?"1000_3000":"3000_inf";const vd=new Map;vd.set("Operation",sc.Op);vd.set("BucketOfRenderedCells",Ca);X.Health.instance.recordKpiUsage(Ue.a.longFrame,0,Ge.a.canvas,vd);0<sc.longFrameCount&&X.Health.instance.recordKpiFailure(Ue.a.longFrame,"LongFrame",!1,!0,Object(zb.a)(new H.a,{extendedProperties:vd}));
3E4<sc.tfAppInt&&(0<sc.longFrameCount?hc.b().qXf(0,this.HEi,vd):hc.b().rXf(0,vd))}e.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Aa.length}`)}this.reset()}MHi(){const Aa={};if(window.performance){const Ca=window.performance.memory;Ca&&(Aa.jsHeapSizeLimit=Ca.jsHeapSizeLimit,Aa.usedJSHeapSize=Ca.usedJSHeapSize,Aa.totalJSHeapSize=Ca.totalJSHeapSize)}return Aa}reset(){this.Xua.clear();this.Iia={};this.dOd()}tsh(){if(this.SY){for(const Aa of Wb.a(this.Iia)){const Ca=this.Iia[Aa];Ca.end=
Math.min(this.SY.length-1,Ca.end);this.Xua.add(Ca)}this.t0g(this.Xua,this.SY)}}t0g(Aa,Ca){for(let sc of Aa){let vd=Aa=0;if(sc.end<Ca.length){for(let Td=sc.start;Td<=sc.end;Td++){const ye=Ca[Td];0<=ye&&(sc.Max=Math.round(Math.max(sc.Max,ye)),sc.Min=Math.round(Math.min(sc.Min,ye)),Aa+=ye,vd++)}0<vd&&(sc.Avg=Math.round(Aa/vd));this.m4a&&this.m4a.pnj(sc.Op,sc.Min,sc.Max,sc.LFrame?sc.LFrame.duration:-1);sc.Props&&(this.aWj(sc),sc.Props=null)}}this.m4a&&this.m4a.v0j()}dOd(){this.SY=[0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}KMe(Aa){Aa++;for(let Ca=0;Ca<Aa;Ca++)this.SY[Ca]=Cc.t8b}LMe(Aa){for(;60>Aa;Aa++)this.SY[Aa]=Cc.t8b}ZCi(Aa,Ca){Aa=Aa.getSeconds();var sc=Wb.a(this.Iia);if(0<sc.length)for(const vd of sc)if(sc=this.Iia[vd],Aa>=sc.start&&Aa<sc.end)sc.LFrame?sc.LFrame.duration<Ca&&(sc.LFrame.startSecond=Aa,sc.LFrame.duration=Ca,sc.longFrameCount++):(sc.LFrame=new ah(Aa,Ca),sc.longFrameCount++)}b0j(){this.bCc=this.x$a=
0;for(const Aa of Qd.h(this.$).Nn){const Ca=Aa.XCa;for(let sc in Ca){const vd=this.Ea.Dl(Ca[sc].hashCode);if(null===vd||void 0===vd?0:vd.Pk)this.x$a+=vd.je.NonEmptyCellsCount,this.bCc+=vd.je.TextValueCellsCount}}}aWj(Aa){const Ca=Aa.Props;if(ub.a.tNb in Ca&&Ca[ub.a.tNb]&&ub.a.hPb in Ca){let sc;(sc=Object(I.a)(fe.a,Ca[ub.a.hPb]))&&sc.continueWith(vd=>{Me.TextEditorTelemetry.instance.pJg(Aa.Op,Aa.Min,!!Aa.LFrame,Aa.LFrame?Aa.LFrame.duration:0,vd.result)})}}}Cc.t8b=-1;Cc.oIi=6E4;Cc.invalid="Invalid";
Object(b.a)(Cc,"FramePerformanceTracker",Ra.a,[474,2]);class Uc extends dc.a{constructor(Aa){super();this.$=Aa;this.Fb()}create(){let Aa=this.$.da.za(263);Aa||(Aa=this.$.da.Ga(263,new Cc(this.$)));this.ob(Aa)}static ka(Aa){Aa.da.Ga(264,new Uc(Aa))}}Object(b.a)(Uc,"FramePerformanceTrackerFactory",dc.a,[]);var jd=a(1282),Bd=a(937);class he{Ng(Aa,Ca){return new Bd.a(Aa,Ca)}Ac(Aa,Ca){Aa=this.Ng(Aa,Ca);Aa.start();return Aa}}Object(b.a)(he,"DefaultStopwatchBuilder",null,[146]);class be{constructor(){this.Fqa=
new he}Ng(Aa,Ca){return this.Fqa.Ng(Aa,Ca)}Ac(Aa,Ca){return this.Fqa.Ac(Aa,Ca)}}Object(b.a)(be,"StopwatchBuilder",null,[146]);var pd=a(416),Ze=a(1030),hf=a(923),k;(function(Aa){Aa[Aa.actions=0]="actions";Aa[Aa.correlationStart=1]="correlationStart";Aa[Aa.reorderSheetOp=2]="reorderSheetOp";Aa[Aa.formatCellOp=3]="formatCellOp";Aa[Aa.copyOp=4]="copyOp";Aa[Aa.pasteOp=5]="pasteOp";Aa[Aa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Aa[Aa.instantaneousSetData=7]="instantaneousSetData";Aa[Aa.immediateSetData=
8]="immediateSetData";Aa[Aa.dependentCellsCalc=9]="dependentCellsCalc";Aa[Aa.dependentCellsGraphStat=10]="dependentCellsGraphStat";Aa[Aa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Aa[Aa.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Aa[Aa.gridBlockUpdates=13]="gridBlockUpdates";Aa[Aa.browserAppStart=14]="browserAppStart";Aa[Aa.linkedObjects=15]="linkedObjects";Aa[Aa.longFrames=16]="longFrames";Aa[Aa.task=17]="task";Aa[Aa.conflictInEditing=18]="conflictInEditing";
Aa[Aa.incomingPresenceData=19]="incomingPresenceData";Aa[Aa.editorTableDelay=20]="editorTableDelay";Aa[Aa.presenceStartup=21]="presenceStartup";Aa[Aa.presenceDelete=22]="presenceDelete";Aa[Aa.editorEvent=23]="editorEvent";Aa[Aa.editorTime=24]="editorTime";Aa[Aa.gridScreenReaderOps=25]="gridScreenReaderOps";Aa[Aa.sendPresenceToService=26]="sendPresenceToService";Aa[Aa.IME=27]="IME";Aa[Aa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Aa[Aa.customizeStatusBar=29]="customizeStatusBar";Aa[Aa.clientWebRequests=
30]="clientWebRequests";Aa[Aa.showCommentTaskPane=31]="showCommentTaskPane";Aa[Aa.applyThreadedCommentChange=32]="applyThreadedCommentChange";Aa[Aa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Aa[Aa.findNextOrPreviousComment=34]="findNextOrPreviousComment";Aa[Aa.goto=35]="goto";Aa[Aa.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";Aa[Aa.richApiInvocation=37]="richApiInvocation";Aa[Aa.fxLibrary=38]="fxLibrary";Aa[Aa.embeddedApiSession=39]="embeddedApiSession";Aa[Aa.numberFormattingCalculator=
40]="numberFormattingCalculator";Aa[Aa.requestDataAfterSend=41]="requestDataAfterSend";Aa[Aa.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Aa[Aa.copy=43]="copy";Aa[Aa.paste=44]="paste";Aa[Aa.dragDrop=45]="dragDrop";Aa[Aa.clearCopyState=46]="clearCopyState";Aa[Aa.webWorkerRecalcStats=47]="webWorkerRecalcStats";Aa[Aa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Aa[Aa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Aa[Aa.customSort=50]="customSort";
Aa[Aa.namedSheetViewUserAction=51]="namedSheetViewUserAction";Aa[Aa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Aa[Aa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Aa[Aa.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Aa[Aa.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Aa[Aa.namedSheetViewTempViewSaveDialog=56]="namedSheetViewTempViewSaveDialog";Aa[Aa.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";
Aa[Aa.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Aa[Aa.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Aa[Aa.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(k||(k={}));Object(b.b)("UsageTable",k);var Qb=a(423),tc=a(475),Jc=a(598),od=a(645),Hd=a(268);class Md extends Sys.EventArgs{constructor(){super();this.HKi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(b.a)(Md,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class ce{constructor(Aa,
Ca=1){this.zPd=Ca;this.total=Aa}get average(){return this.total/this.zPd}S6g(Aa){return new ce(this.total+Aa.total,this.zPd+Aa.zPd)}static AYg(Aa,Ca){return`${Aa}_${Ca}`}}Object(b.a)(ce,"StopwatchAverage",null,[]);var ne;(function(Aa){Aa[Aa.longFrame=0]="longFrame";Aa[Aa.longGetRange=1]="longGetRange";Aa[Aa.longJsTask=2]="longJsTask";Aa[Aa.viewportCalculationLoops=3]="viewportCalculationLoops"})(ne||(ne={}));Object(b.b)("UtrKpiVeto",ne);class Qe{static I5a(Aa){return Enum.toString(ne,Aa)}}Qe.lVa=
"UTR";Object(b.a)(Qe,"KpiConstants",null,[]);class Le{}Le.Dkg="UTRVetoName";Le.vkg="UTRErrorName";Le.F2j="UTROperationName";Le.m2d="UTRDuration";Le.G2j="UTREndedInPhase";Le.Akg="UTRMessage";Le.Ckg="UtrUnavailabilityType";Le.operationName="OperationName";Le.duration="Duration";Le.message="Message";Object(b.a)(Le,"UtrAdditionalData",null,[]);class Ff{}Ff.S3j="VetoLike";Ff.tqh="E2EOperationPerf";Ff.Tnj="RequestPerf";Ff.UWj="UnavailabilityDurations";Object(b.a)(Ff,"UtrTypes",null,[]);class Sf{DKb(Aa,
Ca,sc=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(sc=sc?Object(zb.a)(new H.a,{extendedProperties:sc}):null,Aa=Qe.I5a(Aa),X.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Aa,Ca,!1,!0,"",sc))}iMb(Aa,Ca,sc,vd,Td,ye){ye[Qe.lVa]=Ff.S3j;ye[Le.Dkg]=Qe.I5a(vd);ye[Le.vkg]=Td;e.ULS.sendTraceTag(Aa,Ca,sc,Jd.a.hc(ye));delete ye[Qe.lVa];delete ye[Le.Dkg];delete ye[Le.vkg]}}Object(b.a)(Sf,"UtrKpiVetoReporter",null,[]);class jg{HKb(Aa,Ca=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
X.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Qe.I5a(Aa),0,"",Ca)}DKb(Aa,Ca,sc=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Aa=Qe.I5a(Aa),X.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Aa,Ca,!1,!0,this.v5c(sc)))}enj(Aa,Ca=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||X.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Qe.I5a(Aa),"",this.v5c(Ca))}dnj(Aa,Ca,sc=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Aa=Qe.I5a(Aa),X.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Aa,Ca,!1,!0,"",this.v5c(sc)))}v5c(Aa){return Aa?Object(zb.a)(new H.a,{extendedProperties:Aa}):null}}Object(b.a)(jg,"UtrKpiVetoUsageReporter",null,[]);class Xf{Cvc(Aa,Ca,sc=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||X.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Aa,"",Object(zb.a)(new H.a,{extendedProperties:sc,durationMs:Ca}))}Ivc(Aa,Ca,sc=null){rb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ca?X.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Aa,"",Object(zb.a)(new H.a,{extendedProperties:sc})):X.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Aa,"",!1,!1,"",Object(zb.a)(new H.a,{extendedProperties:sc})))}fMb(Aa,Ca,sc,vd,Td,ye,df,...Kf){df=String.format(df,...Kf);Kf={};Kf[Qe.lVa]=Ff.tqh;Kf[Le.F2j]=vd;Kf[Le.G2j]=Td;Kf[Le.m2d]=ye;Kf[Le.Akg]=df;e.ULS.sendTraceTag(Aa,Ca,sc,Jd.a.hc(Kf))}hMb(Aa,Ca,sc,vd,Td,ye){this.E5f(ye,vd,Td);e.ULS.sendTraceTag(Aa,Ca,sc,Jd.a.hc(ye));
this.ulh(ye)}gMb(Aa,Ca,sc,vd,Td,ye,...df){ye=String.format(ye,...df);df={};this.E5f(df,vd,Td,ye);e.ULS.sendTraceTag(Aa,Ca,sc,Jd.a.hc(df))}Dxc(Aa,Ca,sc,vd){vd[Qe.lVa]=Ff.Tnj;e.ULS.sendTraceTag(Aa,Ca,sc,Jd.a.hc(vd));delete vd[Qe.lVa]}E5f(Aa,Ca,sc,vd=null){Aa[Qe.lVa]=Ff.UWj;Aa[Le.Ckg]=Ca;Aa[Le.m2d]=sc;vd&&(Aa[Le.Akg]=vd)}ulh(Aa){delete Aa[Qe.lVa];delete Aa[Le.Ckg];delete Aa[Le.m2d]}}Object(b.a)(Xf,"UtrOperationPerfReporter",null,[]);class ff extends Ee.a{constructor(Aa,Ca=null,sc=null,vd=null,Td=null,
ye=!1){super();this.wEh=[ub.a.qye,ub.a.pRe,ub.a.qRe,ub.a.Cgc,ub.a.Ulc,ub.a.Dqf,ub.a.renderCachedContent,ub.a.renderServerContent,ub.a.G6b,ub.a.ysj,ub.a.h0f,ub.a.i0f,ub.a.Yvj];this.mmb=this.XDa=this.LQb=this.Qgb=this.Kee=this.yxe=this.cYa=this.Hle=null;this.PLf=this.oye=!1;this.zkg=this.ykg=this.Bkg=this.QNd=this.Mlg=null;this.RGf=(df,Kf)=>{for(df=0;df<Kf.entries.length;df++){const Zf=Kf.entries[df];Zf.url=z.a.removeParameter(Zf.url,h.AFrameworkApplication.KP);var Tf=z.a.Mda(Zf.url);!rb.EwaSettings.ma(485)&&
this.oti(Zf.url,Tf)&&(Zf.behavior=1);if("img"===Zf.$t.initiatorType&&Tf.endsWith(Ze.a.COe)){var Mf=z.a.ZZ(Zf.url,Ze.a.BOe),pg=z.a.ZZ(Zf.url,Ze.a.DOe);Zf.raa=`${Zf.raa}imageID=${Mf}, imgStateID=${pg}`}Mf=Zf.$t.transferSize;let wg;pg=Zf.$t.decodedBodySize;void 0!==Mf&&null!==Mf&&void 0!==pg&&null!==pg?wg=0===Mf&&0<pg:void 0!==Mf&&null!==Mf&&(wg=0===Mf);pb.PageLoadTrackingInfo.instance.sKg(Tf,Math.round(Zf.$t.fetchStart),Math.round(Zf.$t.responseEnd),wg,this.Rui);pa.a.contains(Tf,ub.a.richTextEditor,
!0)&&(Tf=Me.TextEditorTelemetry.instance,Tf.OE(ub.a.tpj,Math.round(Zf.$t.fetchStart)),Tf.OE(ub.a.vpj,Math.round(Zf.$t.responseEnd)))}};this.dW=()=>{const df=this.j8;for(let Kf in df)df[Kf].h=!0};this.userSessionId=Aa;this.M1a=Ca=Ca||new Jc.a;this.Mh=sc||Pa.a.Qa;this.pOj=vd||this;this.Ce=Td;this.Rui=ye;this.gLe=Ca.Q9a();this.Ce&&this.Ce.KGa(this.dW)}get j8(){return this.Hle||(this.Hle={})}get mKe(){return this.Qgb||this.gLe}get wKe(){return this.XDa||ff.lxf}get DXd(){return this.yxe=this.yxe||{}}get Trc(){return this.cYa||
"undefined"===typeof Stw?this.cYa:this.cYa=Stw.swpc}get tsf(){return this.Kee=this.Kee||{}}get ORa(){return this.mmb||(this.mmb=bb.a.instance.Ub("Common.NetworkTiming.IResourceTimingLogger"))}get xkg(){return this.ykg||(this.ykg=new Sf)}get Vgb(){return this.Bkg||(this.Bkg=new Xf)}get OEc(){return this.zkg||(this.zkg=new jg)}gXd(Aa,Ca,sc){this.pOb(Aa,Ca,sc,Pa.a.jEb(Pa.a.Qa.zb.getTime()))}pOb(Aa,Ca,sc,vd,Td=null){if(this.j8[sc])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.j8[sc]=this.IJe(Aa,Ca,sc,vd,Td)}w$c(Aa){this.vub(Aa,Pa.a.jEb(Pa.a.Qa.zb.getTime()))}vub(Aa,Ca){const sc=this.j8[Aa];sc&&(this.GFe(sc,Ca),this.OYj(sc),delete this.j8[Aa])}NUf(Aa){delete this.j8[Aa]}uag(Aa,Ca){this.Qgb||this.hag(Aa,Ca)}cag(){this.uag(ff.tkd,this.Mh.ue)}bQe(Aa,Ca=!1){if(this.Qgb){if(this.XDa===ff.PFd||this.XDa===ff.tkd){const sc=y.a.instance;sc.userSessionId=this.userSessionId;if(this.XDa===ff.PFd){this.oye||(this.Wla(Aa.m,Object(Y.a)(sc,sc.Kdj,"recordContentFetchEnd")),this.oye=
!0);if(Ca){this.PLf||(this.Wla(Aa.m,Object(Y.a)(sc,sc.Ydj,"recordPerceivedContentDisplayed")),this.PLf=!0);return}this.Wla(Aa.m,Object(Y.a)(sc,sc.Jdj,"recordContentDisplayed"))}else this.XDa===ff.tkd&&(Ca=this.j8[this.LQb])&&this.Wla(Hd.a(Aa,Ca.s),Object(Y.a)(sc,sc.Vdj,"recordInteractivityContentDisplayed"),!1)}this.vub(this.LQb,Aa);this.LQb=this.XDa=this.Qgb=null}}Wla(Aa,Ca,sc=!0){y.a.ZP&&Object(pd.a)(od.PerformanceClock,Pa.a.Qa)&&sc&&(Aa+=window.performance.timing.navigationStart);Ca(Aa)}uj(Aa){return Qb.a(Aa)}Pe(Aa,
Ca,sc=!1){try{if(this.tsf[k[Aa]]=!0,sc){var vd=e.ULS,Td=vd.sendTraceTag;const Nc={};let Pf=null;switch(Aa){case 0:Pf="Actions";var ye=Ca.a;null!=ye&&(Nc.Id=ye);var df=null==Ca.b?null:Ca.b;null!=df&&(Nc.Operation=df);var Kf=Ca.c;null!=Kf&&(Nc.Target=Kf);var Tf=null==Ca.d?null:Ca.d.toString();null!=Tf&&(Nc.StartTime=Tf);var Mf=null==Ca.e?null:Ca.e.toString();null!=Mf&&(Nc.Duration=Mf);var pg=Ca.f;null!=pg&&(Nc.CorrelationId=pg);var Zf=Ca.g;null!=Zf&&(Nc.ParentAction=Zf);var wg=null==Ca.h?null:Ca.h.toString();
null!=wg&&(Nc.DocumentHidden=wg);break;case 1:Pf="CorrelationStart";var fg=Ca.a;null!=fg&&(Nc.CorrelationId=fg);var Lg=Ca.b;null!=Lg&&(Nc.UserSessionId=Lg);var sg=Ca.c;null!=sg&&(Nc.UserAction=sg);break;case 2:Pf="ReorderSheetOp";var gg=Ca.a;null!=gg&&(Nc.UserSessionId=gg);var lh=null==Ca.b?null:Ca.b.toString();null!=lh&&(Nc.IsDragReorder=lh);var Hf=null==Ca.c?null:Ca.c.toString();null!=Hf&&(Nc.DocumentUp=Hf);var Mg=null==Ca.d?null:Ca.d.toString();null!=Mg&&(Nc.OldIndex=Mg);var Rg=null==Ca.e?null:
Ca.e.toString();null!=Rg&&(Nc.NewIndex=Rg);var Ng=null==Ca.f?null:Ca.f.toString();null!=Ng&&(Nc.TotalSheets=Ng);break;case 3:Pf="FormatCellOp";var Og=Ca.a;null!=Og&&(Nc.UserSessionId=Og);var Sg=null==Ca.b?null:Ca.b.toString();null!=Sg&&(Nc.TaskId=Sg);var Wg=null==Ca.c?null:Ca.c.toString();null!=Wg&&(Nc.NumberOfRanges=Wg);var mh=Ca.d;null!=mh&&(Nc.Ranges=mh);var nh=Ca.e;null!=nh&&(Nc.ActiveCell=nh);var wh=null==Ca.f?null:Ca.f.toString();null!=wh&&(Nc.ActionId=wh);var qh=Ca.g;null!=qh&&(Nc.CommandParameters=
qh);var rh=Ca.h;null!=rh&&(Nc.UserActionStopwatchId=rh);break;case 4:Pf="CopyOp";var Tg=Ca.a;null!=Tg&&(Nc.UserSessionId=Tg);var gh=null==Ca.b?null:Ca.b.toString();null!=gh&&(Nc.IsChrome=gh);var sf=null==Ca.c?null:Ca.c.toString();null!=sf&&(Nc.IsIE=sf);var ma=null==Ca.d?null:Ca.d.toString();null!=ma&&(Nc.IsFromUI=ma);var vb=null==Ca.e?null:Ca.e.toString();null!=vb&&(Nc.IsCopyInLoadedRange=vb);var oc=null==Ca.f?null:Ca.f.toString();null!=oc&&(Nc.IsRepeatedCopy=oc);var Fc=null==Ca.g?null:Ca.g.toString();
null!=Fc&&(Nc.IsClipboarAccessSupported=Fc);var wd=null==Ca.h?null:Ca.h.toString();null!=wd&&(Nc.IsClipboarAccessInstallationSupported=wd);var Pd=null==Ca.i?null:Ca.i.toString();null!=Pd&&(Nc.RibbonCommand=Pd);var ie=null==Ca.j?null:Ca.j.toString();null!=ie&&(Nc.CutCopyPasteFlags=ie);var da=null==Ca.k?null:Ca.k.toString();null!=da&&(Nc.IsDrag=da);var jb=null==Ca.l?null:Ca.l.toString();null!=jb&&(Nc.IsIeBeforeAlowDenyPopUp=jb);var Nb=Ca.m;null!=Nb&&(Nc.IsPasteMatchCopy=Nb);var E=Ca.n;null!=E&&(Nc.WaitMessageInClipboard=
E);var ja=null==Ca.o?null:Ca.o.toString();null!=ja&&(Nc.CallCount=ja);break;case 5:Pf="PasteOp";var Ta=Ca.a;null!=Ta&&(Nc.UserSessionId=Ta);var Eb=null==Ca.b?null:Ca.b.toString();null!=Eb&&(Nc.IsChrome=Eb);var jc=null==Ca.c?null:Ca.c.toString();null!=jc&&(Nc.IsIE=jc);var ic=null==Ca.d?null:Ca.d.toString();null!=ic&&(Nc.IsCopyActive=ic);var gc=null==Ca.e?null:Ca.e.toString();null!=gc&&(Nc.IsFromUI=gc);var $c=null==Ca.f?null:Ca.f.toString();null!=$c&&(Nc.IsClipboarAccessSupported=$c);var gd=null==Ca.g?
null:Ca.g.toString();null!=gd&&(Nc.IsClipboarAccessInstallationSupported=gd);var md=null==Ca.h?null:Ca.h.toString();null!=md&&(Nc.RibbonCommand=md);var Xd=null==Ca.i?null:Ca.i.toString();null!=Xd&&(Nc.CutCopyPasteFlags=Xd);var ge=Ca.j;null!=ge&&(Nc.WaitMessageInClipboard=ge);var ve=Ca.k;null!=ve&&(Nc.PopupDialog=ve);var Fe=Ca.l;null!=Fe&&(Nc.SimplePopupMessage=Fe);var Ve=Ca.m;null!=Ve&&(Nc.DialogCloseButton=Ve);var jf=Ca.n;null!=jf&&(Nc.UserPressedInstallLink=jf);var gf=null==Ca.o?null:Ca.o.toString();
null!=gf&&(Nc.CallCount=gf);break;case 6:Pf="GetNumberViewModelDataOp";var xf=Ca.a;null!=xf&&(Nc.UserSessionId=xf);var Ye=Ca.b;null!=Ye&&(Nc.NumberFormatOptionsPreviousOutputJson=Ye);var Lf=Ca.c;null!=Lf&&(Nc.NumberFormatOptionsNewInputJson=Lf);break;case 7:Pf="InstantaneousSetData";var Nf=Ca.a;null!=Nf&&(Nc.Id=Nf);var Ef=null==Ca.b?null:Ca.b.toString();null!=Ef&&(Nc.WasEmpty=Ef);var uf=null==Ca.c?null:Ca.c.toString();null!=uf&&(Nc.ValueNotChanged=uf);var Bg=Ca.d;null!=Bg&&(Nc.Source=Bg);var vg=null==
Ca.e?null:Ca.e.toString();null!=vg&&(Nc.ProcessingCompleted=vg);break;case 8:Pf="ImmediateSetData";var Eg=Ca.a;null!=Eg&&(Nc.ClientStopwatchId=Eg);var Ih=Ca.b;null!=Ih&&(Nc.Operation=Ih);var Qh=Ca.c;null!=Qh&&(Nc.Parameters=Qh);var dg=null==Ca.d?null:Ca.d.toString();null!=dg&&(Nc.WasUpdatedByImmediate=dg);var Ug=null==Ca.e?null:Ca.e.toString();null!=Ug&&(Nc.areHtmlElementsEqualClientComparison=Ug);var Cg=null==Ca.f?null:Ca.f.toString();null!=Cg&&(Nc.WasDecisionMadeByHtmlComparison=Cg);var Yg=null==
Ca.g?null:Ca.g.toString();null!=Yg&&(Nc.IsNumeric=Yg);var Sh=null==Ca.h?null:Ca.h.toString();null!=Sh&&(Nc.IsDateTime=Sh);var Ni=null==Ca.i?null:Ca.i.toString();null!=Ni&&(Nc.HasCurrencySymbol=Ni);var di=null==Ca.j?null:Ca.j.toString();null!=di&&(Nc.HasPercentSymbol=di);var ei=null==Ca.k?null:Ca.k.toString();null!=ei&&(Nc.IsFunc=ei);var fi=null==Ca.l?null:Ca.l.toString();null!=fi&&(Nc.DiffInWrappingWhitespace=fi);var Fg=Ca.m;null!=Fg&&(Nc.ImmediatePattern=Fg);var xh=null==Ca.n?null:Ca.n.toString();
null!=xh&&(Nc.TextAlignmentMatch=xh);var gi=null==Ca.o?null:Ca.o.toString();null!=gi&&(Nc.FontColorMatch=gi);var ti=null==Ca.p?null:Ca.p.toString();null!=ti&&(Nc.FormulaTextMatch=ti);var ui=null==Ca.q?null:Ca.q.toString();null!=ui&&(Nc.isFormula=ui);var Oi=Ca.r;null!=Oi&&(Nc.FormulaText=Oi);var Pi=Ca.s;null!=Pi&&(Nc.InstantaneousPattern=Pi);var Mh=null==Ca.t?null:Ca.t.toString();null!=Mh&&(Nc.AreHtmlInnerTextElementsEqualClientComparison=Mh);var oh=Ca.u;null!=oh&&(Nc.HtmlComparisonDecision=oh);break;
case 9:Pf="DependentCellsCalc";var vi=Ca.a;null!=vi&&(Nc.CalcStatus=vi);var Xh=null==Ca.b?null:Ca.b.toString();null!=Xh&&(Nc.SuccessfullyCalculatedRanges=Xh);var Bh=null==Ca.c?null:Ca.c.toString();null!=Bh&&(Nc.RangesSkipped=Bh);var hi=null==Ca.d?null:Ca.d.toString();null!=hi&&(Nc.TotalErrors=hi);var Ch=null==Ca.e?null:Ca.e.toString();null!=Ch&&(Nc.Partial=Ch);var Di=null==Ca.f?null:Ca.f.toString();null!=Di&&(Nc.Canceled=Di);var ii=null==Ca.g?null:Ca.g.toString();null!=ii&&(Nc.Aggregate=ii);var Xc=
null==Ca.h?null:Ca.h.toString();null!=Xc&&(Nc.Unknown=Xc);var Ed=null==Ca.i?null:Ca.i.toString();null!=Ed&&(Nc.UnavailableData=Ed);var bh=null==Ca.j?null:Ca.j.toString();null!=bh&&(Nc.Cycle=bh);var Ei=null==Ca.k?null:Ca.k.toString();null!=Ei&&(Nc.NotImplemented=Ei);var wi=null==Ca.l?null:Ca.l.toString();null!=wi&&(Nc.InvalidInput=wi);var ji=null==Ca.m?null:Ca.m.toString();null!=ji&&(Nc.AreDepCells=ji);break;case 10:Pf="DependentCellsGraphStat";var Fi=null==Ca.a?null:Ca.a.toString();null!=Fi&&(Nc.ParsedFormulas=
Fi);var ph=null==Ca.b?null:Ca.b.toString();null!=ph&&(Nc.GraphNodes=ph);var xg=null==Ca.c?null:Ca.c.toString();null!=xg&&(Nc.GraphArcs=xg);var Gi=null==Ca.d?null:Ca.d.toString();null!=Gi&&(Nc.AnalyzedBlocks=Gi);var Dh=null==Ca.e?null:Ca.e.toString();null!=Dh&&(Nc.IterationId=Dh);var ki=Ca.f;null!=ki&&(Nc.UniqueId=ki);var li=null==Ca.g?null:Ca.g.toString();null!=li&&(Nc.Aborted=li);break;case 11:Pf="DependentCellsGraphSectionStat";var Hi=null==Ca.a?null:Ca.a.toString();null!=Hi&&(Nc.IterationId=Hi);
var Th=Ca.b;null!=Th&&(Nc.BlockHash=Th);var mi=Ca.c;null!=mi&&(Nc.Functions=mi);var Uh=Ca.d;null!=Uh&&(Nc.Operators=Uh);var tg=null==Ca.e?null:Ca.e.toString();null!=tg&&(Nc.CrossDocRefs=tg);var Dg=null==Ca.f?null:Ca.f.toString();null!=Dg&&(Nc.CrossSheetRefs=Dg);var xi=null==Ca.g?null:Ca.g.toString();null!=xi&&(Nc.ErrRefs=xi);var Jh=null==Ca.h?null:Ca.h.toString();null!=Jh&&(Nc.LargeRanges=Jh);var Ii=null==Ca.i?null:Ca.i.toString();null!=Ii&&(Nc.NameRefs=Ii);var ni=null==Ca.j?null:Ca.j.toString();
null!=ni&&(Nc.ParserErrors=ni);var Kh=null==Ca.k?null:Ca.k.toString();null!=Kh&&(Nc.RowRefs=Kh);var oi=null==Ca.l?null:Ca.l.toString();null!=oi&&(Nc.ColumnRefs=oi);var pf=null==Ca.m?null:Ca.m.toString();null!=pf&&(Nc.TableRefs=pf);var Nh=Ca.n;null!=Nh&&(Nc.UniqueId=Nh);var ch=null==Ca.o?null:Ca.o.toString();null!=ch&&(Nc.UnreachableReferences=ch);break;case 12:Pf="GetRangeContentPrefetchFailures";var Gg=Ca.a;null!=Gg&&(Nc.UserSessionId=Gg);var Hg=Ca.b;null!=Hg&&(Nc.ClientStopwatchId=Hg);var Yh=null==
Ca.c?null:Ca.c.toString();null!=Yh&&(Nc.StateId=Yh);break;case 13:Pf="GridBlockUpdates";var Zh=Ca.a;null!=Zh&&(Nc.UserSessionId=Zh);var Eh=Ca.b;null!=Eh&&(Nc.CorrelationId=Eh);var sh=Ca.c;null!=sh&&(Nc.Operation=sh);var dh=null==Ca.d?null:Ca.d.toString();null!=dh&&(Nc.PerformanceType=dh);var pi=Ca.e;null!=pi&&(Nc.BlockHash=pi);var $h=null==Ca.f?null:Ca.f.toString();null!=$h&&(Nc.DurationInMs=$h);break;case 14:Pf="BrowserAppStart";var ai=null==Ca.a?null:hf.a.Nta(Ca.a.getTime());null!=ai&&(Nc.ScriptExecutionStart=
ai);var Qi=Ca.b;null!=Qi&&(Nc.UserSessionId=Qi);var Ri=Ca.c;null!=Ri&&(Nc.ClockMechanism=Ri);var Vg=null==Ca.d?null:Ca.d.toString();null!=Vg&&(Nc.ScreenDPI=Vg);var Ji=null==Ca.e?null:Ca.e.toString();null!=Ji&&(Nc.NavigationToScriptExecutionDelta=Ji);break;case 15:Pf="LinkedObjects";var yi=Ca.a;null!=yi&&(Nc.ChildId=yi);var qi=Ca.b;null!=qi&&(Nc.ParentId=qi);var zi=Ca.c;null!=zi&&(Nc.ChildTable=zi);var Fh=Ca.d;null!=Fh&&(Nc.ParentTable=Fh);break;case 16:Pf="LongFrames";var ri=null==Ca.a?null:hf.a.Nta(Ca.a.getTime());
null!=ri&&(Nc.StartTime=ri);var Ai=null==Ca.b?null:Ca.b.toString();null!=Ai&&(Nc.DurationInMs=Ai);break;case 17:Pf="Task";var Pg=Ca.a;null!=Pg&&(Nc.StopwatchId=Pg);var bi=null==Ca.b?null:Ca.b.toString();null!=bi&&(Nc.Status=bi);var eh=null==Ca.c?null:Ca.c.toString();null!=eh&&(Nc.CreateTime=eh);var Rh=null==Ca.d?null:Ca.d.toString();null!=Rh&&(Nc.TaskId=Rh);break;case 18:Pf="ConflictInEditing";var Bi=Ca.a;null!=Bi&&(Nc.OtherUserState=Bi);var Oh=Ca.b;null!=Oh&&(Nc.UserSessionId=Oh);var ug=null==Ca.c?
null:hf.a.Nta(Ca.c.getTime());null!=ug&&(Nc.ConflictTime=ug);break;case 19:Pf="IncomingPresenceData";var Vh=Ca.a;null!=Vh&&(Nc.UserSessionId=Vh);var Ci=Ca.b;null!=Ci&&(Nc.UserId=Ci);var Si=null==Ca.c?null:Ca.c.toString();null!=Si&&(Nc.Disconnected=Si);var $f=null==Ca.d?null:hf.a.Nta(Ca.d.getTime());null!=$f&&(Nc.ReceivedTime=$f);break;case 20:Pf="EditorTableDelay";var Gh=Ca.a;null!=Gh&&(Nc.UserSessionId=Gh);var Ki=Ca.b;null!=Ki&&(Nc.UserId=Ki);var ci=null==Ca.c?null:Ca.c.toString();null!=ci&&(Nc.Received=
ci);var th=null==Ca.d?null:Ca.d.toString();null!=th&&(Nc.DurationInMs=th);var K=null==Ca.e?null:Ca.e.toString();null!=K&&(Nc.NotAloneAtLogTime=K);var ob=null==Ca.f?null:hf.a.Nta(Ca.f.getTime());null!=ob&&(Nc.Time=ob);break;case 21:Pf="PresenceStartup";var Sb=Ca.a;null!=Sb&&(Nc.UserSessionId=Sb);var kc=null==Ca.b?null:Ca.b.toString();null!=kc&&(Nc.EverReceived=kc);var yc=null==Ca.c?null:Ca.c.toString();null!=yc&&(Nc.NotAloneOnOpen=yc);var bd=null==Ca.d?null:Ca.d.toString();null!=bd&&(Nc.NotAloneAtLogTime=
bd);var Fd=null==Ca.e?null:Ca.e.toString();null!=Fd&&(Nc.EditorCount=Fd);var Nd=null==Ca.f?null:Ca.f.toString();null!=Nd&&(Nc.WorkbookOpenToFirstReceivedInMs=Nd);break;case 22:Pf="PresenceDelete";var Rd=Ca.a;null!=Rd&&(Nc.UserSessionId=Rd);var je=Ca.b;null!=je&&(Nc.UserId=je);var $e=Ca.c;null!=$e&&(Nc.Context=$e);var Xe=Ca.d;null!=Xe&&(Nc.Reason=Xe);var ig=null==Ca.e?null:hf.a.Nta(Ca.e.getTime());null!=ig&&(Nc.Time=ig);break;case 23:Pf="EditorEvent";var Zg=Ca.a;null!=Zg&&(Nc.UserSessionId=Zg);var Uf=
Ca.b;null!=Uf&&(Nc.UserId=Uf);var uh=Ca.c;null!=uh&&(Nc.Context=uh);var hh=null==Ca.d?null:hf.a.Nta(Ca.d.getTime());null!=hh&&(Nc.Time=hh);break;case 24:Pf="EditorTime";var Lh=Ca.a;null!=Lh&&(Nc.UserSessionId=Lh);var R=Ca.b;null!=R&&(Nc.UserId=R);var Wa=null==Ca.c?null:Ca.c.toString();null!=Wa&&(Nc.DurationInMs=Wa);break;case 25:Pf="GridScreenReaderOps";var qb=Ca.a;null!=qb&&(Nc.UserSessionId=qb);var Xb=Ca.b;null!=Xb&&(Nc.CommandTaskId=Xb);var pc=null==Ca.c?null:Ca.c.toString();null!=pc&&(Nc.CommandId=
pc);var Lc=null==Ca.d?null:Ca.d.toString();null!=Lc&&(Nc.ClientSideOnly=Lc);var Ec=null==Ca.e?null:Ca.e.toString();null!=Ec&&(Nc.DurationInMS=Ec);var Gc=null==Ca.f?null:Ca.f.toString();null!=Gc&&(Nc.ReachedMaxReadoutCells=Gc);var qc=null==Ca.g?null:Ca.g.toString();null!=qc&&(Nc.RequstedCellCount=qc);var Sc=null==Ca.h?null:Ca.h.toString();null!=Sc&&(Nc.NonEmptyCellCount=Sc);var fd=null==Ca.i?null:Ca.i.toString();null!=fd&&(Nc.Succeeded=fd);var Yc=null==Ca.j?null:Ca.j.toString();null!=Yc&&(Nc.Canceled=
Yc);var Ld=Ca.k;null!=Ld&&(Nc.ErrorType=Ld);break;case 26:Pf="SendPresenceToService";var $d=Ca.a;null!=$d&&(Nc.UserSessionId=$d);var se=null==Ca.b?null:Ca.b.toString();null!=se&&(Nc.TotalCount=se);var Ne=null==Ca.c?null:Ca.c.toString();null!=Ne&&(Nc.SendCount=Ne);break;case 27:Pf="IME";var tf=Ca.a;null!=tf&&(Nc.UserSessionId=tf);break;case 28:Pf="FreezePaneFloatingObjects";var Df=Ca.a;null!=Df&&(Nc.UserSessionId=Df);var Yf=null==Ca.b?null:Ca.b.toString();null!=Yf&&(Nc.ObjectType=Yf);var lf=Ca.c;null!=
lf&&(Nc.ObjectID=lf);var Gf=null==Ca.d?null:Ca.d.toString();null!=Gf&&(Nc.SpannedPanesCount=Gf);break;case 29:Pf="CustomizeStatusBar";var nf=Ca.a;null!=nf&&(Nc.UserSessionId=nf);var hg=Ca.b;null!=hg&&(Nc.UIControlName=hg);var qg=null==Ca.c?null:Ca.c.toString();null!=qg&&(Nc.IsControlVisible=qg);break;case 30:Pf="ClientWebRequests";var Ig=Ca.a;null!=Ig&&(Nc.Path=Ig);var Jg=Ca.b;null!=Jg&&(Nc.ProxyStopwatchId=Jg);var $g=Ca.c;null!=$g&&(Nc.RequestStatus=$g);var yh=null==Ca.d?null:Ca.d.toString();null!=
yh&&(Nc.ResponseSizeInBytes=yh);var zf=Ca.e;null!=zf&&(Nc.ClientRequestId=zf);var af=null==Ca.f?null:Ca.f.toString();null!=af&&(Nc.StateId=af);break;case 31:Pf="ShowCommentTaskPane";var yf=Ca.a;null!=yf&&(Nc.UserSessionId=yf);var ag=null==Ca.b?null:Ca.b.toString();null!=ag&&(Nc.IsFromKeyboardShortcut=ag);var eg=null==Ca.c?null:Ca.c.toString();null!=eg&&(Nc.IsShowPane=eg);var Rf=null==Ca.d?null:Ca.d.toString();null!=Rf&&(Nc.ShowForDeepLink=Rf);var Vf=null==Ca.e?null:Ca.e.toString();null!=Vf&&(Nc.DeepLinkFound=
Vf);break;case 32:Pf="ApplyThreadedCommentChange";var bg=Ca.a;null!=bg&&(Nc.UserSessionId=bg);var cg=null==Ca.b?null:Ca.b.toString();null!=cg&&(Nc.Operation=cg);var yg=Ca.c;null!=yg&&(Nc.CommentId=yg);var vh=null==Ca.d?null:Ca.d.toString();null!=vh&&(Nc.CommentsCount=vh);break;case 33:Pf="UpgradeLegacyCommentsChange";var Of=Ca.a;null!=Of&&(Nc.UserSessionId=Of);var Ti=null==Ca.b?null:Ca.b.toString();null!=Ti&&(Nc.OperationSuccessful=Ti);break;case 34:Pf="FindNextOrPreviousComment";var Ui=Ca.a;null!=
Ui&&(Nc.UserSessionId=Ui);var Wi=null==Ca.b?null:Ca.b.toString();null!=Wi&&(Nc.Succeeded=Wi);break;case 35:Pf="Goto";var Vi=Ca.a;null!=Vi&&(Nc.UserSessionId=Vi);var og=null==Ca.b?null:Ca.b.toString();null!=og&&(Nc.IsSucceeded=og);var ih=null==Ca.c?null:Ca.c.toString();null!=ih&&(Nc.IsNOVMode=ih);break;case 36:Pf="LaunchOfficeAddInDialog";var zh=Ca.a;null!=zh&&(Nc.UserSessionId=zh);var kg=Ca.b;null!=kg&&(Nc.SourceId=kg);var zg=Ca.c;null!=zg&&(Nc.SourceLabel=zg);var Hh=Ca.d;null!=Hh&&(Nc.Flight=Hh);
var Ph=Ca.e;null!=Ph&&(Nc.Experiment=Ph);var Wh=Ca.f;null!=Wh&&(Nc.UICultureTag=Wh);var Li=null==Ca.g?null:Ca.g.toString();null!=Li&&(Nc.UICultureTagLcid=Li);var $i=null==Ca.h?null:Ca.h.toString();null!=$i&&(Nc.WacHostId=$i);break;case 37:Pf="RichApiInvocation";var aj=Ca.a;null!=aj&&(Nc.UserSessionId=aj);var bj=null==Ca.b?null:Ca.b.toString();null!=bj&&(Nc.Succeeded=bj);var cj=Ca.c;null!=cj&&(Nc.ErrorType=cj);var dj=Ca.d;null!=dj&&(Nc.ResultInfo=dj);var jj=Ca.e;null!=jj&&(Nc.Source=jj);break;case 38:Pf=
"FxLibrary";var kj=Ca.a;null!=kj&&(Nc.EntityName=kj);var Xi=null==Ca.b?null:Ca.b.toString();null!=Xi&&(Nc.EntryPoint=Xi);var ej=null==Ca.c?null:Ca.c.toString();null!=ej&&(Nc.Action=ej);var fj=null==Ca.d?null:Ca.d.toString();null!=fj&&(Nc.InsertLocation=fj);break;case 39:Pf="EmbeddedApiSession";var gj=Ca.a;null!=gj&&(Nc.UserSessionId=gj);break;case 40:Pf="NumberFormattingCalculator";var hj=Ca.a;null!=hj&&(Nc.Id=hj);var lj=Ca.b;null!=lj&&(Nc.CounterName=lj);var ij=Ca.c;null!=ij&&(Nc.Values=ij);break;
case 41:Pf="RequestDataAfterSend";var mj=Ca.a;null!=mj&&(Nc.ClientStopwatchId=mj);var Yi=Ca.b;null!=Yi&&(Nc.RequestStatus=Yi);var nj=null==Ca.c?null:Ca.c.toString();null!=nj&&(Nc.SendDuration=nj);var oj=null==Ca.d?null:Ca.d.toString();null!=oj&&(Nc.RequestId=oj);break;case 42:Pf="FloatingObjectsStopwatchData";var pj=Ca.a;null!=pj&&(Nc.StopMessage=pj);var qj=null==Ca.b?null:Ca.b.toString();null!=qj&&(Nc.Type=qj);var rj=Ca.c;null!=rj&&(Nc.GUID=rj);var sj=null==Ca.d?null:Ca.d.toString();null!=sj&&(Nc.Pane=
sj);var tj=null==Ca.e?null:Ca.e.toString();null!=tj&&(Nc.IsAboveGrid=tj);var If=Ca.f;null!=If&&(Nc.StartCorrelation=If);var Zi=Ca.g;null!=Zi&&(Nc.LoadImageCorrelation=Zi);var Q=null==Ca.h?null:Ca.h.toString();null!=Q&&(Nc.SkippedGetEffectsExtents=Q);var Ua=null==Ca.i?null:Ca.i.toString();null!=Ua&&(Nc.Version=Ua);break;case 43:Pf="Copy";var Fb=Ca.a;null!=Fb&&(Nc.UserSessionId=Fb);var nc=Ca.b;null!=nc&&(Nc.Trigger=nc);var Dc=Ca.c;null!=Dc&&(Nc.RibbonCommandName=Dc);var cd=Ca.d;null!=cd&&(Nc.SourceItem=
cd);var kd=null==Ca.e?null:Ca.e.toString();null!=kd&&(Nc.SourceRangeCellCount=kd);var qd=Ca.f;null!=qd&&(Nc.ClientSideStopwatchId=qd);var Id=Ca.g;null!=Id&&(Nc.CopyOperationId=Id);var Yd=null==Ca.h?null:Ca.h.toString();null!=Yd&&(Nc.IsAsync=Yd);var Je=null==Ca.i?null:Ca.i.toString();null!=Je&&(Nc.IsFromCache=Je);var Se=null==Ca.j?null:Ca.j.toString();null!=Se&&(Nc.IsSuccessiveCopy=Se);var vf=null==Ca.k?null:Ca.k.toString();null!=vf&&(Nc.IsSelectionAllowed=vf);var Kg=null==Ca.l?null:Ca.l.toString();
null!=Kg&&(Nc.IsSuccess=Kg);var rg=null==Ca.m?null:Ca.m.toString();null!=rg&&(Nc.IsExpectedError=rg);var lg=Ca.n;null!=lg&&(Nc.ExpectedErrorReason=lg);var mg=Ca.o;null!=mg&&(Nc.ErrorMessage=mg);var Ag=null==Ca.p?null:Ca.p.toString();null!=Ag&&(Nc.ClientSideCopyTimeInMs=Ag);var jh=null==Ca.q?null:Ca.q.toString();null!=jh&&(Nc.TotalTimeInMs=jh);var fh=null==Ca.r?null:Ca.r.toString();null!=fh&&(Nc.PlainTextPayloadSize=fh);var kh=Ca.s;null!=kh&&(Nc.CopyPasteTargetType=kh);var si=null==Ca.t?null:Ca.t.toString();
null!=si&&(Nc.ShadowWorkbookPayloadSize=si);var Mi=null==Ca.u?null:Ca.u.toString();null!=Mi&&(Nc.HtmlPayloadSize=Mi);var kk=null==Ca.v?null:Ca.v.toString();null!=kk&&(Nc.HtmlSizeExceedsLimit=kk);var lk=null==Ca.w?null:Ca.w.toString();null!=lk&&(Nc.CopyTotalSizeExceedsLimit=lk);var mk=null==Ca.x?null:Ca.x.toString();null!=mk&&(Nc.ErrorReason=mk);var nk=Ca.y;null!=nk&&(Nc.ErrorName=nk);var ok=null==Ca.z?null:Ca.z.toString();null!=ok&&(Nc.IsSucceededWithAlert=ok);var pk=null==Ca.ba?null:Ca.ba.toString();
null!=pk&&(Nc.EncounteredDeploymentErrors=pk);var qk=null==Ca.bb?null:Ca.bb.toString();null!=qk&&(Nc.ShadowWorkbookSizeExceedsLimit=qk);var rk=Ca.bc;null!=rk&&(Nc.CopyPasteTargetName=rk);var sk=Ca.bd;null!=sk&&(Nc.CCPSliceName=sk);var tk=Ca.be;null!=tk&&(Nc.SyncClipboardItemsKeys=tk);var uk=Ca.bf;null!=uk&&(Nc.AsyncClipboardItemsKeys=uk);var vk=Ca.bg;null!=vk&&(Nc.CopyPasteHandlerName=vk);var wk=Ca.bh;null!=wk&&(Nc.SucceededPopulatingSystemClipboardSync=wk);var xk=Ca.bi;null!=xk&&(Nc.SucceededPopulatingSystemClipboardAsync=
xk);var yk=Ca.bj;null!=yk&&(Nc.Location=yk);var zk=Ca.bk;null!=zk&&(Nc.CopyContextId=zk);var Ak=null==Ca.bl?null:Ca.bl.toString();null!=Ak&&(Nc.ServerRequestTimeInMs=Ak);var Bk=null==Ca.bm?null:Ca.bm.toString();null!=Bk&&(Nc.EcsOperationDuration=Bk);var Ck=null==Ca.bn?null:Ca.bn.toString();null!=Ck&&(Nc.EcsRequestDuration=Ck);var Dk=null==Ca.bo?null:Ca.bo.toString();null!=Dk&&(Nc.WfeRequestDuration=Dk);var Ek=null==Ca.bp?null:Ca.bp.toString();null!=Ek&&(Nc.OriginalSourceRangesCountExceedsLimit=Ek);
var Fk=null==Ca.bq?null:Ca.bq.toString();null!=Fk&&(Nc.UploadToClipServiceAttempted=Fk);var Gk=null==Ca.br?null:Ca.br.toString();null!=Gk&&(Nc.FloatingObjectType=Gk);break;case 44:Pf="Paste";var Hk=Ca.a;null!=Hk&&(Nc.UserSessionId=Hk);var Ik=Ca.b;null!=Ik&&(Nc.Trigger=Ik);var Jk=Ca.c;null!=Jk&&(Nc.RibbonCommandName=Jk);var Kk=null==Ca.d?null:Ca.d.toString();null!=Kk&&(Nc.PasteTypeFlagValue=Kk);var Lk=Ca.e;null!=Lk&&(Nc.PasteOperationId=Lk);var Mk=Ca.f;null!=Mk&&(Nc.CopyOperationId=Mk);var Nk=Ca.g;
null!=Nk&&(Nc.ClientSideStopwatchId=Nk);var Ok=Ca.h;null!=Ok&&(Nc.OriginalDestinationRange=Ok);var Pk=Ca.i;null!=Pk&&(Nc.ExpandDestinationRange=Pk);var Qk=Ca.j;null!=Qk&&(Nc.SourceItem=Qk);var Rk=null==Ca.k?null:Ca.k.toString();null!=Rk&&(Nc.SourceRangeCellCount=Rk);var Sk=null==Ca.l?null:Ca.l.toString();null!=Sk&&(Nc.IsSuccess=Sk);var Tk=null==Ca.m?null:Ca.m.toString();null!=Tk&&(Nc.IsExpectedError=Tk);var Uk=Ca.n;null!=Uk&&(Nc.ClipboardFormatReadTimeInMs=Uk);var Vk=Ca.o;null!=Vk&&(Nc.ClipboardFormatReadStatus=
Vk);var Wk=null==Ca.p?null:Ca.p.toString();null!=Wk&&(Nc.ClipboardReadPermissionPromptShown=Wk);var Xk=null==Ca.q?null:Ca.q.toString();null!=Xk&&(Nc.AsyncApiReadTimedOut=Xk);var Yk=Ca.r;null!=Yk&&(Nc.ExpectedErrorReason=Yk);var Zk=Ca.s;null!=Zk&&(Nc.ErrorMessage=Zk);var $k=null==Ca.t?null:Ca.t.toString();null!=$k&&(Nc.TotalTimeInMs=$k);var al=null==Ca.u?null:Ca.u.toString();null!=al&&(Nc.PlainTextPayloadSize=al);var bl=null==Ca.v?null:Ca.v.toString();null!=bl&&(Nc.ShadowWorkbookPayloadSize=bl);var cl=
null==Ca.w?null:Ca.w.toString();null!=cl&&(Nc.HtmlPayloadSize=cl);var dl=Ca.x;null!=dl&&(Nc.CopyPasteTargetType=dl);var el=null==Ca.y?null:Ca.y.toString();null!=el&&(Nc.IsLastCopyWasExternal=el);var fl=null==Ca.z?null:Ca.z.toString();null!=fl&&(Nc.IsClipboardDataContainShadowWorkbook=fl);var gl=null==Ca.ba?null:Ca.ba.toString();null!=gl&&(Nc.IsShadowWorkbookParsedSuccessfully=gl);var hl=Ca.bb;null!=hl&&(Nc.ActiveSelectionType=hl);var il=Ca.bc;null!=il&&(Nc.PasteResult=il);var jl=null==Ca.bd?null:
Ca.bd.toString();null!=jl&&(Nc.ErrorReason=jl);var kl=Ca.be;null!=kl&&(Nc.ErrorName=kl);var ll=null==Ca.bf?null:Ca.bf.toString();null!=ll&&(Nc.IsSucceededWithAlert=ll);var ml=null==Ca.bg?null:Ca.bg.toString();null!=ml&&(Nc.IsAfterCut=ml);var nl=null==Ca.bh?null:Ca.bh.toString();null!=nl&&(Nc.EncounteredDeploymentErrors=nl);var ol=null==Ca.bi?null:Ca.bi.toString();null!=ol&&(Nc.IsCrossSession=ol);var pl=null==Ca.bj?null:Ca.bj.toString();null!=pl&&(Nc.ShadowWorkbookSizeExceedsLimit=pl);var Qj=null==
Ca.bk?null:Ca.bk.toString();null!=Qj&&(Nc.ClipboardContainXLOPayload=Qj);var ql=Ca.bl;null!=ql&&(Nc.CopyPasteTargetName=ql);var rl=Ca.bm;null!=rl&&(Nc.ChromeExtensionId=rl);var sl=Ca.bn;null!=sl&&(Nc.PayloadOrigin=sl);var tl=Ca.bo;null!=tl&&(Nc.PayloadType=tl);var ul=Ca.bp;null!=ul&&(Nc.CCPSliceName=ul);var vl=Ca.bq;null!=vl&&(Nc.ClipboardItemsKeys=vl);var wl=Ca.br;null!=wl&&(Nc.CopyPasteHandlerName=wl);var xl=null==Ca.bs?null:Ca.bs.toString();null!=xl&&(Nc.IsSourceItemOriginSameSession=xl);var yl=
Ca.bt;null!=yl&&(Nc.Location=yl);var zl=Ca.bu;null!=zl&&(Nc.ExternalAppSource=zl);var Al=Ca.bv;null!=Al&&(Nc.PasteContextId=Al);var sm=null==Ca.bw?null:Ca.bw.toString();null!=sm&&(Nc.ServerRequestTimeInMs=sm);var uj=null==Ca.bx?null:Ca.bx.toString();null!=uj&&(Nc.IndicationDisplayScheduled=uj);var vj=Ca.by;null!=vj&&(Nc.PasteIndicationDisplayStatus=vj);var wj=null==Ca.bz?null:Ca.bz.toString();null!=wj&&(Nc.PasteRecoveryUIDisplayed=wj);var xj=null==Ca.ca?null:Ca.ca.toString();null!=xj&&(Nc.IsFromPasteRecoveryUI=
xj);var yj=null==Ca.cb?null:Ca.cb.toString();null!=yj&&(Nc.EcsOperationDuration=yj);var zj=null==Ca.cc?null:Ca.cc.toString();null!=zj&&(Nc.EcsRequestDuration=zj);var Aj=null==Ca.cd?null:Ca.cd.toString();null!=Aj&&(Nc.WfeRequestDuration=Aj);var Bl=null==Ca.ce?null:Ca.ce.toString();null!=Bl&&(Nc.OriginalSourceRangesCountExceedsLimit=Bl);var Cl=Ca.cf;null!=Cl&&(Nc.PasteRecoveryUndoStopwatchId=Cl);var Rj=null==Ca.cg?null:Ca.cg.toString();null!=Rj&&(Nc.PasteRecoveryUndoTimeInMs=Rj);var Sj=null==Ca.ch?
null:Ca.ch.toString();null!=Sj&&(Nc.PasteCSEPerformed=Sj);var Tj=null==Ca.ci?null:Ca.ci.toString();null!=Tj&&(Nc.CSEStatus=Tj);var Uj=null==Ca.cj?null:Ca.cj.toString();null!=Uj&&(Nc.IsFromEnterShortcut=Uj);var Dl=null==Ca.ck?null:Ca.ck.toString();null!=Dl&&(Nc.pasteDestinationHasMergedCells=Dl);break;case 45:Pf="DragDrop";var Bj=Ca.a;null!=Bj&&(Nc.UserSessionId=Bj);var Cj=Ca.b;null!=Cj&&(Nc.Trigger=Cj);var Dj=Ca.c;null!=Dj&&(Nc.RibbonCommandName=Dj);var Ej=Ca.d;null!=Ej&&(Nc.OperationId=Ej);var Fj=
Ca.e;null!=Fj&&(Nc.ClientSideStopwatchId=Fj);var Gj=Ca.f;null!=Gj&&(Nc.SourceRange=Gj);var Hj=Ca.g;null!=Hj&&(Nc.DestinationRange=Hj);var Ij=Ca.h;null!=Ij&&(Nc.CutCopyType=Ij);var Jj=null==Ca.i?null:Ca.i.toString();null!=Jj&&(Nc.IsShiftKeyDown=Jj);var Kj=null==Ca.j?null:Ca.j.toString();null!=Kj&&(Nc.IsDragInsert=Kj);var Lj=null==Ca.k?null:Ca.k.toString();null!=Lj&&(Nc.IsSuccess=Lj);var Mj=null==Ca.l?null:Ca.l.toString();null!=Mj&&(Nc.IsExpectedError=Mj);var Nj=Ca.m;null!=Nj&&(Nc.ExpectedErrorReason=
Nj);var Oj=Ca.n;null!=Oj&&(Nc.ErrorMessage=Oj);var Pj=null==Ca.o?null:Ca.o.toString();null!=Pj&&(Nc.TotalTimeInMs=Pj);var El=Ca.p;null!=El&&(Nc.ErrorName=El);var Fl=null==Ca.q?null:Ca.q.toString();null!=Fl&&(Nc.IsSucceededWithAlert=Fl);var Gl=Ca.r;null!=Gl&&(Nc.CopyPasteTargetType=Gl);var Hl=null==Ca.s?null:Ca.s.toString();null!=Hl&&(Nc.EncounteredDeploymentErrors=Hl);break;case 46:Pf="ClearCopyState";var Il=Ca.a;null!=Il&&(Nc.UserSessionId=Il);var Jl=Ca.b;null!=Jl&&(Nc.ClientSideStopwatchId=Jl);
var Kl=Ca.c;null!=Kl&&(Nc.Trigger=Kl);var Ll=null==Ca.d?null:Ca.d.toString();null!=Ll&&(Nc.IsClearClipboard=Ll);var Ml=null==Ca.e?null:Ca.e.toString();null!=Ml&&(Nc.IsExplicit=Ml);var Nl=null==Ca.f?null:Ca.f.toString();null!=Nl&&(Nc.IsSuccess=Nl);var Ol=Ca.g;null!=Ol&&(Nc.ErrorMessage=Ol);var Pl=Ca.h;null!=Pl&&(Nc.ErrorName=Pl);var Ql=null==Ca.i?null:Ca.i.toString();null!=Ql&&(Nc.TotalTimeInMs=Ql);var Rl=Ca.j;null!=Rl&&(Nc.CopyPasteTargetType=Rl);break;case 47:Pf="WebWorkerRecalcStats";var Sl=null==
Ca.a?null:Ca.a.toString();null!=Sl&&(Nc.SuccessCount=Sl);var Tl=null==Ca.b?null:Ca.b.toString();null!=Tl&&(Nc.FailureCount=Tl);var Ul=null==Ca.c?null:Ca.c.toString();null!=Ul&&(Nc.ValueTypeMismatchCount=Ul);var Vl=null==Ca.d?null:Ca.d.toString();null!=Vl&&(Nc.CellValueMismatchCount=Vl);var Wl=null==Ca.e?null:Ca.e.toString();null!=Wl&&(Nc.IfmtMismatchCount=Wl);var Xl=null==Ca.f?null:Ca.f.toString();null!=Xl&&(Nc.FormattedTextMismatchCount=Xl);var Yl=null==Ca.g?null:Ca.g.toString();null!=Yl&&(Nc.CellValueStringMismatchCount=
Yl);var Zl=null==Ca.h?null:Ca.h.toString();null!=Zl&&(Nc.CellValueNumberMismatchCount=Zl);var $l=null==Ca.i?null:Ca.i.toString();null!=$l&&(Nc.CellValueBooleanMismatchCount=$l);var am=null==Ca.j?null:Ca.j.toString();null!=am&&(Nc.CellValueBlankMismatchCount=am);var bm=null==Ca.k?null:Ca.k.toString();null!=bm&&(Nc.CellValueErrorMismatchCount=bm);var cm=null==Ca.l?null:Ca.l.toString();null!=cm&&(Nc.FormattedTextStringMismatchCount=cm);var dm=null==Ca.m?null:Ca.m.toString();null!=dm&&(Nc.FormattedTextNumberMismatchCount=
dm);var em=null==Ca.n?null:Ca.n.toString();null!=em&&(Nc.FormattedTextBooleanMismatchCount=em);var fm=null==Ca.o?null:Ca.o.toString();null!=fm&&(Nc.FormattedTextBlankMismatchCount=fm);var gm=null==Ca.p?null:Ca.p.toString();null!=gm&&(Nc.FormattedTextErrorMismatchCount=gm);var hm=null==Ca.q?null:Ca.q.toString();null!=hm&&(Nc.StringMismatchCount=hm);var im=null==Ca.r?null:Ca.r.toString();null!=im&&(Nc.NumericMismatchCount=im);var jm=null==Ca.s?null:Ca.s.toString();null!=jm&&(Nc.ErrorMismatchCount=jm);
var km=null==Ca.t?null:Ca.t.toString();null!=km&&(Nc.StringValuesCount=km);var lm=null==Ca.u?null:Ca.u.toString();null!=lm&&(Nc.NumericValuesCount=lm);var mm=null==Ca.v?null:Ca.v.toString();null!=mm&&(Nc.BooleanValuesCount=mm);var nm=null==Ca.w?null:Ca.w.toString();null!=nm&&(Nc.BlankValuesCount=nm);var om=null==Ca.x?null:Ca.x.toString();null!=om&&(Nc.ErrorValuesCount=om);var pm=null==Ca.y?null:Ca.y.toString();null!=pm&&(Nc.NumericValuesDiffAverage=pm);var qm=Ca.z;null!=qm&&(Nc.NumericEvaluatedValuesMismatchSamples=
qm);var Vj=Ca.ba;null!=Vj&&(Nc.NumericFormattedTextMismatchSamples=Vj);var Wj=Ca.bb;null!=Wj&&(Nc.NumericMismatchSamples=Wj);var Xj=Ca.bc;null!=Xj&&(Nc.CellValueTypeMismatchSamples=Xj);var Yj=Ca.bd;null!=Yj&&(Nc.IfmtMismatchSamples=Yj);var Zj=Ca.be;null!=Zj&&(Nc.BlockHashCode=Zj);break;case 48:Pf="DataValidationEditOpenDialog";var ak=Ca.a;null!=ak&&(Nc.ServerCommand=ak);var tm=null==Ca.b?null:Ca.b.toString();null!=tm&&(Nc.SubDialogOpened=tm);var rm=Ca.c;null!=rm&&(Nc.SubDialogButtonClicked=rm);var bk=
null==Ca.d?null:Ca.d.toString();null!=bk&&(Nc.DialogOpened=bk);var ck=Ca.e;null!=ck&&(Nc.RuleType=ck);var dk=Ca.f;null!=dk&&(Nc.ConditionType=dk);var ek=null==Ca.g?null:Ca.g.toString();null!=ek&&(Nc.LowerBoundaryFilled=ek);var fk=null==Ca.h?null:Ca.h.toString();null!=fk&&(Nc.UpperBoundaryFilled=fk);var gk=null==Ca.i?null:Ca.i.toString();null!=gk&&(Nc.IgnoreBlank=gk);var hk=null==Ca.j?null:Ca.j.toString();null!=hk&&(Nc.InCellDropdown=hk);var ik=null==Ca.k?null:Ca.k.toString();null!=ik&&(Nc.ShowInputMessage=
ik);var jk=null==Ca.l?null:Ca.l.toString();null!=jk&&(Nc.InputTitleFilled=jk);var zm=null==Ca.m?null:Ca.m.toString();null!=zm&&(Nc.InputMessageFilled=zm);var Am=null==Ca.n?null:Ca.n.toString();null!=Am&&(Nc.ShowErrorAlert=Am);var Bm=null==Ca.o?null:Ca.o.toString();null!=Bm&&(Nc.AlertBlocking=Bm);var Cm=null==Ca.p?null:Ca.p.toString();null!=Cm&&(Nc.AlertTitleFilled=Cm);var Dm=null==Ca.q?null:Ca.q.toString();null!=Dm&&(Nc.AlertMessageFilled=Dm);var Em=Ca.r;null!=Em&&(Nc.StopWatchId=Em);break;case 49:Pf=
"DataValidationEditSubmitRule";var Fm=Ca.a;null!=Fm&&(Nc.RuleType=Fm);var Gm=Ca.b;null!=Gm&&(Nc.ConditionType=Gm);var Hm=null==Ca.c?null:Ca.c.toString();null!=Hm&&(Nc.LowerBoundaryFilled=Hm);var Im=null==Ca.d?null:Ca.d.toString();null!=Im&&(Nc.UpperBoundaryFilled=Im);var Jm=null==Ca.e?null:Ca.e.toString();null!=Jm&&(Nc.IgnoreBlank=Jm);var Km=null==Ca.f?null:Ca.f.toString();null!=Km&&(Nc.InCellDropdown=Km);var Lm=null==Ca.g?null:Ca.g.toString();null!=Lm&&(Nc.ShowInputMessage=Lm);var Mm=null==Ca.h?
null:Ca.h.toString();null!=Mm&&(Nc.InputTitleFilled=Mm);var Nm=null==Ca.i?null:Ca.i.toString();null!=Nm&&(Nc.InputMessageFilled=Nm);var Om=null==Ca.j?null:Ca.j.toString();null!=Om&&(Nc.ShowErrorAlert=Om);var Pm=null==Ca.k?null:Ca.k.toString();null!=Pm&&(Nc.AlertBlocking=Pm);var Qm=null==Ca.l?null:Ca.l.toString();null!=Qm&&(Nc.AlertTitleFilled=Qm);var Rm=null==Ca.m?null:Ca.m.toString();null!=Rm&&(Nc.AlertMessageFilled=Rm);var Sm=null==Ca.n?null:Ca.n.toString();null!=Sm&&(Nc.ClearAllPressed=Sm);var Tm=
Ca.o;null!=Tm&&(Nc.ActionStatus=Tm);var Um=Ca.p;null!=Um&&(Nc.Error=Um);var Vm=Ca.q;null!=Vm&&(Nc.StopWatchId=Vm);break;case 50:Pf="CustomSort";var Wm=Ca.a;null!=Wm&&(Nc.RangeType=Wm);var Xm=null==Ca.b?null:Ca.b.toString();null!=Xm&&(Nc.HasHeaders=Xm);var Ym=null==Ca.c?null:Ca.c.toString();null!=Ym&&(Nc.SortTopToBottom=Ym);var Zm=null==Ca.d?null:Ca.d.toString();null!=Zm&&(Nc.ColumnCount=Zm);var $m=null==Ca.e?null:Ca.e.toString();null!=$m&&(Nc.RowCount=$m);var an=null==Ca.f?null:Ca.f.toString();null!=
an&&(Nc.RangeLimitExceeded=an);var bn=null==Ca.g?null:Ca.g.toString();null!=bn&&(Nc.CaseSensitive=bn);var cn=null==Ca.h?null:Ca.h.toString();null!=cn&&(Nc.GetSortInfoDuration=cn);var dn=null==Ca.i?null:Ca.i.toString();null!=dn&&(Nc.LevelCount=dn);var en=null==Ca.j?null:Ca.j.toString();null!=en&&(Nc.SortOnValuesCount=en);var fn=null==Ca.k?null:Ca.k.toString();null!=fn&&(Nc.SortOnCellColorCount=fn);var gn=null==Ca.l?null:Ca.l.toString();null!=gn&&(Nc.SortOnFontColorCount=gn);var hn=null==Ca.m?null:
Ca.m.toString();null!=hn&&(Nc.SortOnIconCount=hn);var jn=null==Ca.n?null:Ca.n.toString();null!=jn&&(Nc.CustomOrderCount=jn);var kn=null==Ca.o?null:Ca.o.toString();null!=kn&&(Nc.AvgCellColorCount=kn);var ln=null==Ca.p?null:Ca.p.toString();null!=ln&&(Nc.MaxCellColorCount=ln);var mn=null==Ca.q?null:Ca.q.toString();null!=mn&&(Nc.AvgFontColorCount=mn);var nn=null==Ca.r?null:Ca.r.toString();null!=nn&&(Nc.MaxFontColorCount=nn);var on=null==Ca.s?null:Ca.s.toString();null!=on&&(Nc.AvgIconsCount=on);var pn=
null==Ca.t?null:Ca.t.toString();null!=pn&&(Nc.MaxIconsCount=pn);var qn=null==Ca.u?null:Ca.u.toString();null!=qn&&(Nc.Executed=qn);break;case 51:Pf="NamedSheetViewUserAction";var rn=Ca.a;null!=rn&&(Nc.UserSessionId=rn);var sn=Ca.b;null!=sn&&(Nc.UserActionName=sn);var tn=null==Ca.c?null:Ca.c.toString();null!=tn&&(Nc.UserActionSource=tn);var un=Ca.d;null!=un&&(Nc.UserActionData=un);var vn=Ca.e;null!=vn&&(Nc.OtherData=vn);break;case 52:Pf="NamedSheetViewTeachingCallout";var wn=Ca.a;null!=wn&&(Nc.UserSessionId=
wn);var xn=null==Ca.b?null:Ca.b.toString();null!=xn&&(Nc.TeachingCalloutSequence=xn);var yn=null==Ca.c?null:Ca.c.toString();null!=yn&&(Nc.TeachingCalloutIndex=yn);var zn=null==Ca.d?null:Ca.d.toString();null!=zn&&(Nc.UserActionName=zn);var An=Ca.e;null!=An&&(Nc.UserActionData=An);var Bn=null==Ca.f?null:Ca.f.toString();null!=Bn&&(Nc.DurationInMs=Bn);break;case 53:Pf="NamedSheetViewTeachingDialog";var Cn=Ca.a;null!=Cn&&(Nc.UserSessionId=Cn);var Dn=Ca.b;null!=Dn&&(Nc.UserActionName=Dn);var En=Ca.c;null!=
En&&(Nc.ButtonClicked=En);var Fn=null==Ca.d?null:Ca.d.toString();null!=Fn&&(Nc.DurationInMs=Fn);var Gn=null==Ca.e?null:Ca.e.toString();null!=Gn&&(Nc.IsNewTeachingDialog=Gn);break;case 54:Pf="NamedSheetViewOptionsDialog";var Hn=Ca.a;null!=Hn&&(Nc.UserSessionId=Hn);var In=null==Ca.b?null:Ca.b.toString();null!=In&&(Nc.OptionsAction=In);var Jn=Ca.c;null!=Jn&&(Nc.OptionsActionData=Jn);var Kn=Ca.d;null!=Kn&&(Nc.OptionsOtherData=Kn);var Ln=null==Ca.e?null:Ca.e.toString();null!=Ln&&(Nc.DurationInMs=Ln);break;
case 55:Pf="NamedSheetViewTempViewApplyDialog";var Mn=Ca.a;null!=Mn&&(Nc.UserSessionId=Mn);var Nn=Ca.b;null!=Nn&&(Nc.TriggeredFrom=Nn);var On=Ca.c;null!=On&&(Nc.ButtonClicked=On);var Pn=null==Ca.d?null:Ca.d.toString();null!=Pn&&(Nc.DurationInMs=Pn);break;case 56:Pf="NamedSheetViewTempViewSaveDialog";var Qn=Ca.a;null!=Qn&&(Nc.UserSessionId=Qn);var Rn=Ca.b;null!=Rn&&(Nc.TriggeredFrom=Rn);var Sn=Ca.c;null!=Sn&&(Nc.ButtonClicked=Sn);var Tn=null==Ca.d?null:Ca.d.toString();null!=Tn&&(Nc.NameUpdated=Tn);
var Un=null==Ca.e?null:Ca.e.toString();null!=Un&&(Nc.DurationInMs=Un);break;case 57:Pf="TemporaryViewStartedDataRestore";var Vn=Ca.a;null!=Vn&&(Nc.UserSessionId=Vn);var Wn=null==Ca.b?null:Ca.b.toString();null!=Wn&&(Nc.CountOfTempViews=Wn);break;case 58:Pf="TemporaryViewFetchedVersion";var Xn=Ca.a;null!=Xn&&(Nc.UserSessionId=Xn);var Yn=null==Ca.b?null:Ca.b.toString();null!=Yn&&(Nc.NumberOfBytes=Yn);break;case 59:Pf="RaiseEventsAndGenerateBlockRequests";var Zn=null==Ca.a?null:Ca.a.toString();null!=
Zn&&(Nc.ReturnContentStatus=Zn);var $n=null==Ca.b?null:Ca.b.toString();null!=$n&&(Nc.CacheState=$n);var ao=null==Ca.c?null:Ca.c.toString();null!=ao&&(Nc.FromXhrCallback=ao);var bo=null==Ca.d?null:Ca.d.toString();null!=bo&&(Nc.AreGeneralErrorsPresent=bo);var co=Ca.e;null!=co&&(Nc.BlockCacheItemHash=co);var eo=Ca.f;null!=eo&&(Nc.StopwatchId=eo);var fo=Ca.g;null!=fo&&(Nc.BlockCacheItemProcessingStopwatchId=fo);var go=null==Ca.h?null:Ca.h.toString();null!=go&&(Nc.StateId=go);var ho=null==Ca.i?null:Ca.i.toString();
null!=ho&&(Nc.IsHighPriority=ho);var io=null==Ca.j?null:Ca.j.toString();null!=io&&(Nc.CalcComplete=io);var jo=null==Ca.k?null:Ca.k.toString();null!=jo&&(Nc.EditedCellsUpdatedByCse=jo);var ko=null==Ca.l?null:Ca.l.toString();null!=ko&&(Nc.DependentCellsUpdatedByCse=ko);var lo=null==Ca.m?null:Ca.m.toString();null!=lo&&(Nc.Revision=lo);var mo=null==Ca.n?null:Ca.n.toString();null!=mo&&(Nc.SheetProcessedDataVersion=mo);var no=null==Ca.o?null:Ca.o.toString();null!=no&&(Nc.RefCount=no);var oo=null==Ca.p?
null:Ca.p.toString();null!=oo&&(Nc.ExistsInView=oo);var po=null==Ca.q?null:Ca.q.toString();null!=po&&(Nc.ContentSource=po);break;case 60:Pf="LaunchMakerCodeEditor";var qo=Ca.a;null!=qo&&(Nc.SessionId=qo);var ro=Ca.b;null!=ro&&(Nc.Command=ro);var so=null==Ca.c?null:Ca.c.toString();null!=so&&(Nc.IsPreviewGallery=so);var to=Ca.d;null!=to&&(Nc.MenuItemId=to);var uo=Ca.e;null!=uo&&(Nc.ScriptId=uo);var vo=Ca.f;null!=vo&&(Nc.ShareId=vo);var wo=null==Ca.g?null:Ca.g.toString();null!=wo&&(Nc.IsOwner=wo);var xo=
null==Ca.h?null:Ca.h.toString();null!=xo&&(Nc.PublishedScriptCount=xo);var yo=null==Ca.i?null:Ca.i.toString();null!=yo&&(Nc.RecentScriptCount=yo);var zo=null==Ca.j?null:Ca.j.toString();null!=zo&&(Nc.WorkbookScriptCount=zo)}Nc.Table=Pf;var Eo=Sys.Serialization.JavaScriptSerializer.serialize(Nc);Td.call(vd,3704927,0,50,Eo)}}catch(Nc){e.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Aa} exception: ${Nc}`)}}t$c(Aa,Ca,sc){if(this.Trc){const vd=this.cYa[Aa+Ca];vd&&(vd.e=sc,this.Dcd(vd));
delete this.cYa[Aa+Ca]}}Ewd(Aa,Ca){k[Aa]in this.tsf||this.Pe(Aa,Ca)}k5i(){this.Mh.appStart&&this.hag(ff.PFd,this.Mh.appStart)}iEi(Aa){const Ca={};Ca.a=Aa.i;Ca.b=Aa.o;Ca.c=Aa.t;Ca.d=Hd.a(Aa.s,Aa.p||this.Mh.appStart);Ca.e=Hd.a(Aa.e,Aa.s);Ca.f=Aa.c;Ca.g=Aa.a;Ca.h=Aa.h;this.Pe(0,Ca,this.Xri(Ca.b,Ca.c))}Xri(Aa,Ca){return["CommandTask","QueuedTask","Task"].includes(Aa)&&!this.wEh.includes(Ca)?!1:!0}UA(Aa,Ca,sc,vd,Td=!0){if(Aa&&Ca){const ye={};ye.a=Aa;ye.b=Ca;ye.c=sc.toString();ye.d=vd.toString();this.Pe(15,
ye,Td)}}dsf(Aa,Ca,sc,vd){const Td={};Aa&&(Td.c=Hd.a(Aa,this.Mh.appStart));Td.b=Ca;Td.a=sc;Td.d=vd;this.Pe(17,Td)}dispose(){this.ORa.execute(Aa=>{Aa.deactivate(!0);Aa.xjj(this.RGf)});this.Ce&&this.Ce.Bcb(this.dW);super.dispose()}T8e(){return this.Mlg=this.Mlg||new be}IJe(Aa,Ca,sc=null,vd=null,Td=null){const ye={};ye.o=Aa;ye.t=Ca;ye.p=Td;ye.s=vd||this.Mh.ue;this.lod(ye,sc);return ye}GFe(Aa,Ca=null){Aa&&(Aa.e=Ca||this.Mh.ue,Aa.i=Aa.i||this.M1a.Q9a(),Aa.c=Aa.c||this.mKe,Aa.a=Aa.a||this.wKe,Aa.h=void 0!==
Aa.h&&null!==Aa.h?Aa.h:this.Ce?this.Ce.si:!1,this.Dcd(Aa))}lsf(Aa){const Ca=Aa.context;Aa.duration>ff.lqh&&(Ca.methodName===dd.a.Bxb||Ca.methodName===dd.a.swa)&&this.Fvc(1,ff.M1h);if("GetSessionStatus"!==Ca.methodName){const sc={};sc.a=Ca.methodName;sc.b=Ca.stopwatch.id;sc.c=Aa.Qvc;sc.d=Aa.responseSize;sc.e=Ca.hIa;sc.f=Aa.od?Aa.od.StateId:dd.a.o0d;this.Pe(30,sc,!0);this.UA(sc.b,Aa.od.ServerCorrelationId,"clientWebRequests","ServerActions")}}abg(){if(this.Trc){const Aa=this.cYa.LoadingUIShownSplashScreen;
Aa&&pb.PageLoadTrackingInfo.instance.Hzj(Aa.s)}}Fvc(Aa,Ca){this.xkg.DKb(Aa,Ca,null)}rXf(Aa,Ca=null){this.OEc.enj(Aa,Ca)}qXf(Aa,Ca,sc=null){this.OEc.dnj(Aa,Ca,sc)}sXf(Aa){this.OEc.HKb(Aa,null)}tXf(Aa,Ca){this.OEc.DKb(Aa,Ca,null)}Cvc(Aa,Ca,sc=null){this.Vgb.Cvc(Aa,Ca,sc)}Ivc(Aa,Ca,sc=null){this.Vgb.Ivc(Aa,Ca,sc)}sendDNMTraceTag(Aa,Ca,sc,vd,...Td){rb.EwaSettings.ma(216)&&e.ULS.sendTraceTag.apply(null,[Aa,Ca,sc,vd].concat(Td))}fMb(Aa,Ca,sc,vd,Td,ye,df,...Kf){this.Vgb.fMb(Aa,Ca,sc,vd,Td,ye,df,...Kf)}hMb(Aa,
Ca,sc,vd,Td,ye){this.Vgb.hMb(Aa,Ca,sc,vd,Td,ye)}gMb(Aa,Ca,sc,vd,Td,ye,...df){this.Vgb.gMb(Aa,Ca,sc,vd,Td,ye,...df)}iMb(Aa,Ca,sc,vd,Td,ye){this.xkg.iMb(Aa,Ca,sc,vd,Td,ye)}Dxc(Aa,Ca,sc,vd){this.Vgb.Dxc(Aa,Ca,sc,vd)}Dcd(Aa){this.pOj.iEi(Aa)}l5i(){if(this.Trc){Stw.swpc=null;const Aa=this.Trc;for(let Ca in Aa)this.lod(Aa[Ca])}}xHh(){const Aa=window[tc.a.namespace];if(Aa){const Ca=Aa[tc.a.NEe];Ca&&(delete Aa[tc.a.NEe],Ca.forEach(sc=>{this.lod(sc);this.Dcd(sc)}))}}oti(Aa,Ca){if("about:blank"===Aa||"renamehandler.ashx"===
Ca&&"2"===z.a.ly(Aa,"u"))return!0;for(Aa=0;Aa<this.QNd.length;Aa++)if(Ca.endsWith(this.QNd[Aa]))return!0;return!1}JBi(){this.ORa.execute(Aa=>{Aa.Vh(ff.UUg,0);Aa.CMg(this.RGf);Aa.activate()})}CBi(){const Aa={};Aa.a=new Date(Zb.EcmaDateClock.instance.appStart.m);Aa.b=this.userSessionId;Aa.c=this.Mh.Tdg;Aa.d=ff.ekh*l.devicePixelRatio;Aa.e=Pa.a.Qa.appStart.m;this.Pe(14,Aa,!0);this.Wla(Pa.a.Qa.appStart.m,Object(Y.a)(y.a.instance,y.a.instance.Bdj,"recordAppInitStart"))}hag(Aa,Ca){this.Qgb=this.M1a.Q9a();
this.LQb=this.M1a.Q9a();this.XDa=Aa;this.pOb("UserAction",Aa,this.LQb,Ca);this.frf(Aa,this.Qgb)}sQj(){const Aa=window[tc.a.namespace];Aa&&!ff.WHe&&(Aa[tc.a.kNj]=(Ca,sc)=>this.IJe(Ca,sc),Aa[tc.a.vsh]=Ca=>{this.GFe(Ca)},ff.WHe=!0)}OYj(Aa){const Ca=ce.AYg(Aa.o,Aa.t),sc=new ce(Hd.a(Aa.e,Aa.s)),vd=Ca in this.DXd?this.DXd[Ca].S6g(sc):sc;this.DXd[Ca]=vd;if(sc===vd||sc.average!==vd.average)Aa=Object(zb.a)(new Md,{operation:Aa.o,target:Aa.t,HKi:vd.average,sender:this}),this.raiseEvent(Ca,Aa)}frf(Aa,Ca){const sc=
{};sc.a=Ca;sc.b=this.userSessionId;sc.c=Aa;this.Pe(1,sc,!0)}shi(){this.QNd=[dd.a.fhj,dd.a.getSessionStatus,dd.a.swa,dd.a.G6g,dd.a.t3g,dd.a.Jgb,dd.a.qdc,dd.a.getObjectMetadata,dd.a.setRichTextCell,dd.a.ywa,dd.a.T1j,dd.a.pollSessionStatus,dd.a.F4h,dd.a.S2h,dd.a.XXh]}lod(Aa,Ca=null){Aa.i=Ca||this.M1a.Q9a();Aa.a=this.wKe;Aa.c=this.mKe;Aa.h=this.Ce?this.Ce.si:!1}static ka(Aa){var Ca=new Af;Aa.da.Ga(291,Ca);Ca=new ff(Aa.va.UserSessionId,void 0,void 0,void 0,Ca,!0);Ca.frf(ff.lxf,Ca.gLe);e.ULS.sendTraceTag(524166239,
0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Ca.JBi();Ca.sQj();Ca.k5i();Ca.CBi();Ca.xHh();Ca.l5i();Ca.shi();ff.xxj(Aa);Ad.a.Ul.Ga(41,Ca)}static xxj(Aa){const Ca=l.devicePixelRatio;1<Ca&&Aa.dc.mx(!0,2<=Ca?8388608:4194304)}}ff.lxf="UnassignedUserAction";ff.PFd="PageLoad";ff.tkd="GridUpdateOperation";ff.lqh=5E3;ff.M1h="MoreThan_5000_Ms";ff.ekh=96;ff.UUg=30;ff.WHe=!1;Object(b.a)(ff,"TelemetryManager",Ee.a,[395,396,397,398]);var Xg=a(199),Ah=a(103);class ue{constructor(Aa,
Ca,sc){this.v3j=Aa;this.YU=Ca;this.name=sc}}Object(b.a)(ue,"Validation",null,[]);class Wf{constructor(Aa){this.Tca=()=>{this.ULf(this.EYe)};this.Gj=()=>{this.ULf(this.bWg)};this.$=Aa;this.bWg=new Cd.a;this.EYe=new Cd.a;Qd.h(this.$).Ea.jw(this.Gj);Qd.h(this.$).Ea.eXc(this.Tca)}IWc(Aa,Ca,sc,vd,Td){if(Aa&&vd){const ye=Xg.a.Az(Ca,sc);this.D_b(()=>!!Ah.a(Aa).Tq(ye),vd.StateId,Td)}}D_b(Aa,Ca,sc){this.rLg(this.EYe,Aa,Ca,sc)}rLg(Aa,Ca,sc,vd){Aa&&Ca&&sc!==dd.a.pe&&Aa.add(new ue(Ca,sc,vd))}ULf(Aa){if(Aa){var Ca=
new Cd.a;for(let sc of Aa){if(sc.YU===this.$.ea.ye)try{sc.v3j()||e.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${sc.name}]`)}catch(vd){e.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${sc.name}]. Exception: [${vd}]`)}Ca.add(sc)}for(let sc of Ca)Aa.remove(sc)}else e.ULS.shipAssertTag(537151011,0,!!Aa,
"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Qd.h(this.$)&&Qd.h(this.$).Ea&&(Qd.h(this.$).Ea.ix(this.Gj),Qd.h(this.$).Ea.WJb(this.Tca));this.$=null}static ka(Aa){const Ca=new Wf(Aa);Aa.da.Ga(277,Ca)}}Object(b.a)(Wf,"ValidationTelemetryManager",null,[392,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");t.main();Type.registerNamespace("CNT");T.main();Type.registerNamespace("CACPU");lb.main();Type.registerNamespace("Common.App.EventsCacheManager");
Na.main();(()=>{Mb.a.Fa(Aa=>{Aa.da.Ga(137,new La(Aa))})})();(()=>{Mb.a.Fa(Aa=>{Aa.da.Ga(37,new bc(Aa))})})();(()=>{Mb.a.Fa(Aa=>{Vb.ka(Aa)})})();(()=>{Mb.a.Fa(Aa=>{Tc.ka(Aa)})})();(()=>{Mb.a.Fa(Aa=>{Od.ka(Aa)})})();(()=>{Mb.a.Fa(Aa=>{Aa.da.Ga(40,new ee(Aa,new Ha.a(()=>Ab.GetServiceTaskFactory.create(Aa.da,137,Aa.la,1))))})})();(()=>{Mb.a.Fa(Aa=>{Aa.da.Ga(276,new Pc(Aa))})})();(()=>{Mb.a.Fa(Aa=>{Ad.a.Ul.$a(135,()=>{ff.ka(Aa);Sd.ka(Aa);Wf.ka(Aa);Uc.ka(Aa);rb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",
!1)||ad(Aa);Be.ka(Aa);Ia.ka(Aa);jd.RenderingFidelityTracker.ka(Aa)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tm.js.map/f41696492e0f066984d153fbd6ac4bed/EwaDSEsNext.tm.js.map