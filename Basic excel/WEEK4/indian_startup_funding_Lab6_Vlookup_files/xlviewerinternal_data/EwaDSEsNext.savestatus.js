'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1198:function(u,D,a){u=a(0);var c=a(84),b=a(15),e=a(136),f=a(40);class d{constructor(y){this.Bga=this.vga=this.Fga=this.Ega=null;this.tae=this.Lde=this.vx=this.mM=!1;this.QRc=this.aee=null;this.Tde=0;this.mb=this.Zde=null;this.Z1=y;this.yA=3;this.fkb=!0}initialize(y,x,F){this.Ega=this.Lid(y,x);this.Fga=CommonUIStrings.l_SavingStatus;this.vga=CommonUIStrings.l_ReadOnlyStatus;this.Bga=CommonUIStrings.l_ReviewModeStatus;
this.Z1&&this.Z1.execute(I=>{I.zXc(Object(c.a)(this,this.DQb,"updateToSavingStatus"))});this.vx=!0;this.mb=F;return!0}bfa(y,x){this.mM=y;this.yA=x;this.IS(this.fkb)}IS(y){!this.fkb&&y&&(this.Zde=new Date);this.fkb=y;y=null;3===this.yA&&(y=this.fkb?this.Ega:this.Fga);this.Tnh(y)}Lid(y,x){return y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}DQb(){this.IS(!1)}GZh(){switch(this.yA){case 1:return this.vga;
case 2:return this.Bga;default:return null}}joi(y){return this.Lde===this.mM&&this.Tde===this.yA&&this.aee===y}R8c(y){appChrome.getHeaderApi().then(x=>{x.updateDocumentTitleStatus(this.mM,y,this.GZh(),this.Zde,this.fkb);this.tae=!0;return null});this.QRc=null}Tnh(y){this.vx&&e.c()&&!this.joi(y)&&(!this.tae&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.R8c(y):f.a.XXf()?(this.QRc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.QRc=window.requestIdleCallback(()=>{this.R8c(y)})):window.requestAnimationFrame(()=>{this.R8c(y)}),this.Lde=this.mM,this.aee=y,this.Tde=this.yA)}}Object(u.a)(d,"ReactSaveStatusUIHandler",null,[282]);var h=a(164);class m{constructor(y,x){this.Bs=null;this.Ega=CommonUIStrings.l_SavedStatus;this.Fga=CommonUIStrings.l_SavingStatus;this.vga=CommonUIStrings.l_ReadOnlyStatus;this.Bga=CommonUIStrings.l_ReviewModeStatus;this.RUb=x;this.Z1=y;this.yA=3;this.Nra=!0}Ps(){this.Z1&&this.Z1.execute(y=>{y.zXc(Object(c.a)(this,
this.DQb,"updateToSavingStatus"))});this.RUb.execute(y=>{this.Bs=y})}bfa(y,x){this.yA=x;3===x?this.IS(this.Nra):2===x?this.i0d(this.Bga):this.i0d(this.vga)}DQb(){this.IS(!1)}IS(y){this.Nra=y;this.i0d(this.Nra?this.Ega:this.Fga)}i0d(y){this.Bs&&this.Bs.Oj(h.a.IWj,this.s9g(y))}s9g(y){const x={};x.StatusText=y;return x}}Object(u.a)(m,"SaveStatusPostMessageHandler",null,[282]);var l=a(93),v=a(123),t=a(56);class z{constructor(y,x,F,I){this.Bga=this.vga=this.Fga=this.Ega=null;this.bFa=0;this.EE=this.CSc=
this.rDa=this.jHc=this.$Fa=null;this.Md=y;this.p9=x;this.Z1=F;this.pj=I;this.hce=!0;this.mM=!1;this.yA=3;this.Nra=!0}initialize(y,x){if(!this.Md)return!1;this.Ega=this.Lid(y,x);this.Fga=CommonUIStrings.l_SavingStatus;this.vga=CommonUIStrings.l_ReadOnlyStatus;this.Bga=CommonUIStrings.l_ReviewModeStatus;this.Ps();return!0}Lid(y,x){return y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}Ps(){this.p9&&
this.p9.execute(y=>{y.hOg(Object(c.a)(this,this.HJe,"createStatusAndModeElements"));y.ZNg(Object(c.a)(this,this.HIj,"showHideSaveStatusElement"));y.wTj&&this.HJe(null,null)});this.Z1&&this.Z1.execute(y=>{y.zXc(Object(c.a)(this,this.DQb,"updateToSavingStatus"))})}Wv(){this.EE&&this.Md&&this.Md.KG(this.EE)}HIj(y,x){this.bfa("true"===x,this.yA)}bfa(y,x){this.mM=y;this.yA=x;this.jHc&&(this.jHc.style.display=this.mM||3===this.yA||!this.$Fa?"none":"");this.rDa&&(this.rDa.style.display=this.mM||3===this.yA?
"none":"",this.rDa.innerText=1===this.yA?this.vga:this.Bga,this.rDa.title=1===this.yA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.CSc&&(this.CSc.style.display=this.mM||1===this.yA||!this.$Fa&&!this.rDa?"none":"");this.EE&&(this.EE.style.display=this.mM||1===this.yA?"none":"",this.IS(this.Nra),this.EE.title=CommonUIStrings.l_SaveStatusTooltip)}HJe(y,x){y=document.getElementById(l.CuiHelper.vbf);x&&x.Z4j||!y||""===this.Ega||""===this.Fga||""===this.vga||""===
this.Bga||(this.$Fa=document.getElementById(l.CuiHelper.E2b),this.jHc=l.CuiHelper.Rta(y,"BreadcrumbAppModeDash","-",null,!1),this.rDa=l.CuiHelper.Rta(y,"BreadcrumbAppModeStatus",1===this.yA?this.vga:this.Bga,null,!1),this.lig(this.rDa),this.CSc=l.CuiHelper.Rta(y,"BreadcrumbSaveStatusDash","-",null,!1),this.EE=l.CuiHelper.Rta(y,"BreadcrumbSaveStatus",this.Ega,null,!1),this.lig(this.EE),this.bfa(this.mM,this.yA))}DQb(){this.IS(!1)}IS(y){this.Nra=y;this.N0j(this.Nra?this.Ega:this.Fga)}N0j(y){!this.EE||
3!==this.yA&&2!==this.yA||(this.hce&&!this.Nra?(this.bFa=this.EE.offsetWidth<this.bFa?this.bFa:this.EE.offsetWidth,this.JYj(this.Fga),this.hce=!1):this.EE.innerText=y)}lig(y){y.style.direction=this.pj?"rtl":"ltr";y.style.width="auto";y.style.textAlign=this.pj?"right":"left";y.style.display=this.mM?"none":"";y.setAttribute("Unselectable","on")}JYj(y){this.EE&&(this.EE.style.width="",this.EE.innerText=y,this.bFa=this.EE.offsetWidth<this.bFa?this.bFa:this.EE.offsetWidth,y=v.a.rB(this.EE),this.EE.style.width=
this.bFa-t.a.SD(y.paddingLeft)-t.a.SD(y.paddingRight)+1+"px")}}Object(u.a)(z,"SaveStatusUIHandler",null,[282]);var r=a(4),n=a(92);class w{constructor(){this.DSc=this.ERc=this.wmb=this.gb=null}get name(){return"Common.App.SaveStatus"}Vh(y){this.gb=y;r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.gb.register(m,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new m(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),
this.gb.Ub("Postmessage.IHostPostmessenger"))):r.AFrameworkApplication.sa.Pa.Amf||(r.AFrameworkApplication.sa.Pa.Fs?this.gb.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new d(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"))):this.gb.register(z,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").xc().Fc(()=>new z(n.EventHandlerManager.instance,this.gb.Ub("Common.App.Header.HeaderEventSource"),
this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)))}init(){r.AFrameworkApplication.fa.Fv(Object(c.a)(this,this.NB,"onFullAppSettingsReady"))}NB(){const y=r.AFrameworkApplication.fa,x=!!r.AFrameworkApplication.sa.Pa&&4===r.AFrameworkApplication.sa.Pa.Fj;if(y.qa("WordEditorAutoSaveImprovementIsEnabled")||y.qa("PptEditorSaveStatusInHeaderEnabled")||x&&y.qa("SimplifiedReactRibbonUxIsEnabled")||y.qa("ExcelSaveStatusInHeaderEnabled")||y.qa("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
r.AFrameworkApplication.hideHeaderEmbedded?(this.DSc=this.gb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.DSc.Ps():r.AFrameworkApplication.sa.Pa.Amf||(r.AFrameworkApplication.sa.Pa.Fs?(this.ERc=this.gb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.ERc.initialize(y.qa("IsSkyDrive"),y.Xa("HostNameToIncludeInSavedStatus"),r.AFrameworkApplication.fa):(this.wmb=this.gb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.wmb.initialize(y.qa("IsSkyDrive"),
y.Xa("HostNameToIncludeInSavedStatus")))}dispose(){this.wmb&&this.wmb.Wv()}}Object(u.a)(w,"PackageManager",null,[4,5]);var B=a(248);a.d(D,"a",function(){return A});const A=()=>{Type.registerNamespace("Common.App.SaveStatus");B.a.instance.Ei(new w)}},1255:function(u,D,a){var c=a(9);u=a(0);var b=a(83),e=a(222),f=a(226),d=a(29),h=a(21);class m{constructor(z,r){this.Qje=this.UMc=!1;this.Jza=(n,w)=>{(null===w||void 0===w?0:w.DH)&&d.a.bTg([w.DH])&&(this.zLb=!0)};this.Oo=()=>{this.zLb=!1};this.Tc=(n,w)=>
{f.b(w)&&this.bfa(!0);this.zLb=!1};this.ed=()=>{this.zN=this.$.zN;this.bfa()};this.jHf=()=>{this.IS()};this.mGf=()=>{this.zN=this.$.zN};this.wCd=()=>{h.h(this.$).Ea.ix(this.wCd);this.zN=this.$.zN};this.e0f=r;this.$=z;this.$.userOperationManager.xr(this.mGf);this.$.nl(this.ed);this.$.ea.IOg(this.jHf);this.$.ea.Tj(this.Tc);this.$.q0b(this.Jza);this.$.ea.zM(this.Oo);this.bfa()}get xyi(){return this.$.ea?this.$.ea.fpf:!1}get zN(){return this.UMc}set zN(z){z?this.UMc=!0:h.h(this.$)&&h.h(this.$).Ea&&(h.h(this.$).Ea.l5()?
this.UMc=!1:h.h(this.$).Ea.jw(this.wCd));this.IS()}get zLb(){return this.Qje}set zLb(z){this.Qje=z;this.IS()}dispose(){this.$&&(this.$.Kl(this.ed),this.$.dvc(this.Jza),this.$.userOperationManager&&this.$.userOperationManager.mo(this.mGf),this.$.ea&&(this.$.ea.glj(this.jHf),this.$.ea.qk(this.Tc),this.$.ea.ZR(this.Oo)),h.h(this.$)&&h.h(this.$).Ea&&h.h(this.$).Ea.ix(this.wCd))}bfa(z=!1){z=!this.$.isEditMode||z;this.e0f.bfa(z,this.$.isEditMode?3:1);this.IS()}IS(){this.$.isEditMode&&this.e0f.IS(!this.zN&&
!this.xyi&&!this.zLb)}}Object(u.a)(m,"SaveStatusManager",null,[2]);var l=a(695);class v extends e.a{constructor(z){super();this.Lc=z;this.Fb()}create(){const z=b.a.instance;z.Ub("Common.App.SaveStatus.ISaveStatusUIHandler").execute(r=>{const n=new m(this.Lc,r);z.register(m,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").xc().Fc(()=>n);r=Object(l.a)(this.Lc.da,300,()=>z.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.ob(r)})}static ka(z){z.da.Ga(299,
new v(z))}}Object(u.a)(v,"SaveStatusFactory",e.a,[]);a.d(D,"a",function(){return t});const t=()=>{c.a.Fa(v.ka)}},1401:function(u,D,a){a.r(D);u=a(1198);a=a(1255);Type.registerNamespace("_Ewa");Object(u.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/323ca0391b8940e2cc508a6a4f753a0d/EwaDSEsNext.savestatus.js.map