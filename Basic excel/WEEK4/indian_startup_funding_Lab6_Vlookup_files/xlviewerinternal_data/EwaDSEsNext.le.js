'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1235:function(u,D,a){u=a(0);var c=a(7),b=a(15),e=a(27),f=a(87),d=a(14),h=a(82),m=a(416),l=a(78),v=a(8),t=a(70),z=a(460);class r{constructor(ca,V){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=V;this.parentElement=ca}Ebh(){const ca=this.Fbh();z.a(this.$,243,242,0,V=>{this.cardViewManager=V;V.w8f(this.parentElement,2,ca)})}Qbf(){this.cardViewManager&&
this.cardViewManager.sMa(-1,-1,this.parentElement)}Fbh(){const ca={layoutId:"AutoDetectTooltip"};ca.description=this.longDescription;ca.convertToDomainName=this.convertToDomainName;ca.longDescription=this.longDescription;ca.urlValue=this.urlValue;ca.imageAltText=this.imageAltText;ca.helpText=this.helpText;ca.helpId=this.helpId;return ca}}Object(u.a)(r,"AutoDetectCardManager",null,[]);var n=a(31),w=a(209),B=a(30),A=a(224),y=a(19),x=a(53),F=a(1);class I extends l.a{constructor(ca,V,ra){super();this.hd=
N=>{if(N.Gb.id===this.Fua.firstChild.id){N=this.lxe;const ea={};ea.Id=N.Qpb;this.convertToLinkedEntityManager.X4c(ea,!0,N);this.Fua.removeChild(this.Fua.firstChild);return!0}return!1};this.lxe=ca;this.convertToLinkedEntityManager=V;this.Fua=document.createElement("div");this.Fua.className="clip16x16";this.Wka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',B.a.Eg("autodetectid"+this.lxe.left),y.a.Zad,x.a.Ge(11));F.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
F.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?ra.sk(this.Fua,this.Wka):this.Fua.innerHTML=this.Wka;ca=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");A.a.instance.ta(d.a.click,ca,this.hd)}get domElement(){return this.Fua}dispose(){if(this.Fua){const ca=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");A.a.instance.Ba(d.a.click,ca,this.hd)}super.dispose()}static get f_g(){return"clip16x16"}}Object(u.a)(I,
"AutoDetectColumnHeaderButton",l.a,[]);var L=a(1088),X=a(11),P=a(21),G=a(176);class C extends l.a{constructor(ca,V,ra){super();this.htmlSanitizationHelper=null;this.$=ca;this.gridView=P.h(ca);this.convertToLinkedEntityManager=V;this.htmlSanitizationHelper=ra;this.H3c=new G.a}dispose(){super.dispose()}Xnh(ca){for(let V of this.gridView.pia)for(let ra of V){const N=ra,ea=N.Kt,Ba=L.a(N.b5);this.wIg(ca,Ba,ea);N.aSd(Ba)}}wIg(ca,V,ra){if(V.length){var N=ra.length;ra[N-1]<ca.left||(ra=X.HelperMethods.lw(new w.a(ra),
0,N,ca.left,X.HelperMethods.LB),0>ra||!(V=V[ra]))||(this.gridView.rtl?V.classList.add(n.a.TBh):V.classList.add(n.a.SBh),this.H3c.lb(ca.left)||this.H3c.add(ca.left,new I(ca,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),ca=this.H3c.oa(ca.left).domElement,!V.getElementsByClassName(I.f_g).length&&this.dMj(V)&&V.appendChild(ca))}}dMj(ca){const V=parseInt(ca.style.width,10);var ra=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ra=C.qdh(ra);ca=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.k3h(ca.firstChild.innerHTML),
ra,!0,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<V-(V/2+ca/2)?!0:!1}static qdh(ca){return`${"normal"} ${"normal"} ${ca} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(u.a)(C,"AutoDetectColumnHeaderManager",l.a,[]);var H=a(425),J=a(24),M=a(64),S=a(142),W=a(12),O=a(13),T=a(145),Y=a(72);a.d(D,"a",function(){return va});class va extends l.a{constructor(ca,V,ra,N,ea){super();this.isMac=e.a.isMac;this.rZa=
-1;this.Q6b=null;this.$ta=-1;this.NN=this.Kkc=this.SVd=this.O_=this.mxe=!1;this.ZT=null;this.Ag=()=>{this.oxa&&this.gridView&&this.mX()};this.Bc=()=>{this.qy()};this.hd=()=>{this.IIa();P.h(this.$).gg(!0,!1)};this.xza=(ka,Ka)=>{Ka?(this.Fhg(this.Q6b),this.Teb()):(ka=[29],this.gridView.qb.Wg(ka),this.gridView.qb.Qi(null,ka),this.ZT&&this.ZT.Qbf())};this.ij=()=>{this.R7a()&&this.Dh.hide();1===this.gridView.ha.Ne&&this.mX()};this.ER=()=>{const ka=this.gridView.ha.Ne;this.gridView.ha.ra.activeCell&&1===
ka&&this.mX()};this.onKeyUp=ka=>this.dDb?this.O_?!1:17===ka.Ca.keyCode&&this.SVd?(this.NN?(this.Teb(),this.Xda()):this.IMb(),!0):!1:this.O_=!1;this.onKeyDown=ka=>{if(!this.dDb)return this.O_=!1;this.SVd=!1;this.O_=ka.ctrlKey;switch(ka.Ca.keyCode){case 27:return this.NN?(this.xza(null,!1),this.Xda()):this.ZT&&(this.ZT.Qbf(),this.IMb()),!0;case 13:if(this.NN)return this.NN=!1,this.IIa(),!0;break;case 17:return this.SVd=!0}return!1};const {AutoDetectActionButton:Ba}=a(1345);this.$=ca;this.Rpb=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",
!1);V||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=N;N.aIb();this.Dh=new Ba(ca,V,this.hd,ra,"");this.HUg=new C(this.$,N,ea);this.gridView=P.h(this.$);this.gridView.ha.RT(this.Ag);this.gridView.Vb.IZa(this.Ag);this.gridView.mv(this.ER);ca.dk(this.Bc);ca.VA(this.ij);this.gridBlockManager=Object(h.a)(407,this.gridView.Ea);this.Go=ca.frame.Zt;this.mX()}get mc(){return this.Dh.domElement(1)}get dDb(){const ca=
this.Dh.domElement(va.dfa);return ca?W.DOMElementExtensions.isVisible(ca):!1}get oxa(){return this.$.isEditMode&&F.EwaSettings.ma(135)&&F.EwaSettings.ma(138)&&(new S.a(this.$.xa)).ki?!1:-1!==this.$ta}dispose(){this.gridView&&this.gridView.ha.aS(this.Ag);if(this.$){const ca=this.$;ca.Jl(this.Bc);ca.bE(this.ij);P.h(ca).Oy(this.ER)}f.a.Ia(this.Dh);this.Go=this.$=this.gridView=this.Dh=null;super.dispose()}qy(){this.xza(null,!1);this.rZa=-1;this.Dh.hide();this.fXj();this.NN=!1}Xda(){this.Dh.getButton(va.dfa).$cb();
this.NN=!1}IMb(){this.Dh.getButton(va.dfa).WHb();this.Fhg(this.Q6b);this.NN=!0;this.$.da.$a(211,ca=>{ca.WQa(O.a.instance.ga(1740))})}onAutoDetectUIShown(){if(this.oxa&&-1!==this.rZa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}IUg(ca){var V=new J.Range(1===ca.top?1:ca.top-1,ca.left,ca.bottom,ca.right,!0,!1);V=this.gridView.getRangeInformation(V);for(const ra of V)if(Object(m.a)(H.AutoDetectRange,ra)&&this.Dhc(ca,!1,ra))return!0;return!1}IIa(){if(this.oxa&&-1!==this.rZa){this.Dh.getButton(va.dfa).WHb();
var ca={};ca.Id=this.$ta;ca.StringId=null;this.convertToLinkedEntityManager.X4c(ca,!0,this.Q6b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ca=[Object(c.a)(new Y.a,{name:"Domain",int64:this.$ta})];T.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,ca);this.$ta=-1}}HQh(){let ca=O.a.instance.ga(1736);if(-1!==this.$ta){ca+=" ";try{ca+=this.convertToLinkedEntityManager.zCb(this.$ta.toString())}catch(V){b.ULS.sendTraceTag(537166982,0,10,
`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.$ta}`)}}ca+=" ";return ca=this.Rpb?ca+O.a.instance.ga(1739):ca+O.a.instance.ga(this.isMac?1738:1737)}Teb(){this.Rpb&&(this.ZT||(this.ZT=new r(this.mc,this.$),this.ZT.convertToDomainName=O.a.instance.ga(1741),this.ZT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.ZT.imageAltText=O.a.instance.ga(1743),this.ZT.helpId="HID_DataTypes_Wolfram",this.ZT.helpText=
O.a.instance.ga(1742)),this.ZT.longDescription=this.convertToLinkedEntityManager.ZZd(this.rZa.toString()),this.ZT.Ebh())}Dhc(ca,V,ra){if((new J.Range(ra.top,ra.left,ra.bottom===v.a.eh?ra.bottom:ra.bottom+1,ra.right,!0,!1)).Ad(ca)){if(V){if(ra&&ra.Qpb!==this.rZa){this.rZa=ra.Qpb;ca=ra.Qpb.toString();V=this.Rpb?"":this.convertToLinkedEntityManager.ZZd(ca);const N=this.convertToLinkedEntityManager.jei(ca);this.Dh.Ngb(this.convertToLinkedEntityManager.zCb(ca),V,N,va.dfa)}this.$ta=ra.Qpb;this.Q6b=ra}return!0}return!1}mX(){if(this.convertToLinkedEntityManager){var ca=
this.gridView.ha.Ne;if(this.gridBlockManager&&this.gridBlockManager.nld){var V=this.gridView.ha.ra.activeCell,ra=!this.gridBlockManager.us(V),N=this.gridView.getRangeInformation(this.gridView.ui);for(const ea of N)if(Object(m.a)(H.AutoDetectRange,ea))switch(N=ea,N.q4g){case 3:if(this.Dhc(V,!0,N)){if(1!==ca||ra){this.qy();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.bLd();this.Dh.HBa(V,this.xza);this.mxe||(this.mxe=!0,this.onAutoDetectUIShown());
return}break;case 2:case 1:(F.EwaSettings.ma(467)||F.EwaSettings.ma(468))&&this.HUg.Xnh(N);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.qy()}}Fhg(ca){const V=[29];this.gridView.qb.Qi(ca,V);this.gridView.qb.Tn(V)}R7a(){return this.$.ea.isNamedObjectViewMode&&M.f(this.$.na)}bLd(){this.Rpb&&!this.Kkc&&this.Go&&(this.Go.Ns(d.a.Ob,this.$.domElement,this.onKeyDown,!0),this.Go.Ns(d.a.Dd,this.$.domElement,this.onKeyUp,
!0),this.Kkc=!0)}fXj(){this.Rpb&&this.Kkc&&this.Go&&(this.Go.Ws(d.a.Ob,this.$.domElement,this.onKeyDown,!0),this.Go.Ws(d.a.Dd,this.$.domElement,this.onKeyUp,!0),this.Kkc=!1)}static get dfa(){return 1}static QSh(ca){return O.a.instance.ga(1797)+t.a.space+ca}}Object(u.a)(va,"AutoDetectManager",l.a,[])},1345:function(u,D,a){a.r(D);a.d(D,"AutoDetectActionButton",function(){return d});u=a(0);D=a(78);var c=a(1235),b=a(53),e=a(13),f=a(21);class d extends D.a{constructor(h,m,l,v,t){super();this.$=h;this.yo=
v.w6b(h,m,l,"",b.a.Ge(11),t,"AutoDetectPointerDown",e.a.instance.ga(1797)+"...")}get Dz(){return this.yo.Dz}dispose(){this.yo.dispose();this.$=null;super.dispose()}domElement(h){return this.yo.domElement(h)}getButton(h){return this.yo.getButton(h,!1)}Ngb(h,m,l,v){this.yo.cVa(c.a.QSh(h),m,v);this.yo.Big(l,m,v)}HBa(h,m){const l=f.h(this.$),v=l.ib.Li(h);h=l.ag(h,v);const t=l.Af(v).Cm;if(h&&0<=h.x&&0<=h.y&&t.width>h.width+160){let z=h.bottomRight.x+this.Dz,r=h.topLeft.y+this.Dz,n=!1;z+160>t.bottomRight.x&&
(z=h.topLeft.x-this.Dz,n=!0);if(r<t.topLeft.y+this.Dz){if(l.ib.pCa){this.hide();return}r=t.topLeft.y+this.Dz}this.yo.z9b(m,v);this.Rp(z,r,l.rtl,v,n)}else this.hide()}Rp(h,m,l,v,t){this.yo.Rp(h,m,l,v,!1,t)}hide(){this.yo.hide()}}Object(u.a)(d,"AutoDetectActionButton",D.a,[])},1453:function(u,D,a){a.r(D);u=a(0);var c=a(692),b=a(15),e=a(5),f=a(76),d=a(37),h=a(1),m=a(183),l=a(21),v=a(145);class t{constructor(S,W){this.$=W;this.convertToLinkedEntityManager=S}nc(S,W){switch(W){case -1203788282:case 48568533:case -1662108744:return S=
l.h(this.$),W=this.convertToLinkedEntityManager.IHi||7E3,(null===S||void 0===S?0:S.ha)&&S.ha.ra.$c.sH>W?!0:!1;default:return!1}}executeCommand(S,W,O){S=d.TaskExtensions.Rj();W=W.command;switch(W){case -1203788282:this.convertToLinkedEntityManager.Z$g(O[f.a.Ic].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();
break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(O[f.a.Ic].toString());break;case 1266950951:this.convertToLinkedEntityManager.Ryi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:h.EwaSettings.ma(644)&&this.convertToLinkedEntityManager.LPe();break;case 1702917262:h.EwaSettings.ma(644)&&this.convertToLinkedEntityManager.showHelpArticle(e.a.yYj);break;case -90814711:h.EwaSettings.ma(644)&&
this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===W||O[f.a.Fpf]&&"ConvertToLinkedEntityGallery"===O[f.a.Fpf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),v.a("ExpandDataTypeGallery");break;default:S=m.a(W)}return S}wc(S,W){switch(W.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.ma(130);
case -1081442996:case 1702917262:case -90814711:return h.EwaSettings.ma(644);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Jc(S,W,O){return"PopulateConvertToLinkedEntityMenu"===W&&h.EwaSettings.ma(130)?this.convertToLinkedEntityManager.Jc(S,W,O):!1}}Object(u.a)(t,"ConvertToLinkedEntityCommandHandler",null,[165]);var z=a(460);class r extends c.a{constructor(S){super(S)}nd(){z.a(this.$,271,272,this.Ya,S=>{this.Yc([new t(S,this.$)])})}static ka(S){c.a.Nd(273,
new r(S))}}Object(u.a)(r,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var n=a(55);D=a(222);var w=a(758),B=a(50),A=a(417),y=a(695);class x extends D.a{constructor(S){super();this.$=S;this.Fb()}create(){const S=B.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.Ya),W=B.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya),O=B.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya),T=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?
B.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):n.Task.Ta(null),Y=B.GetServiceTaskFactory.Oa(this.$.da,257,258,this.Ya),va=A.a(this.$);d.TaskExtensions.Aa(d.TaskExtensions.Fd([S,Y,va,W,O,T],this.la),()=>{this.ob(Object(y.a)(this.$.da,271,()=>new w.ConvertToLinkedEntityManager(this.$,S.result,O.result,Y.result,va.result,W.result,T.result)))},this.$.la,3)}static ka(S){S.da.Ga(272,new x(S))}}Object(u.a)(x,"ConvertToLinkedEntityManagerFactory",D.a,[]);var F=a(238),I=a(259),L=a(33),X=a(247),P=a(12),
G=a(701);const C=a(19).a.ABh;class H extends F.a{constructor(S,W,O){super(S);this.wq=0;this.Tp=!1;this.Bc=()=>{this.vg(!1)};this.$=W;this.taskPaneManager=O;I.a(W).ai(this);this.$.dk(this.Bc);L.a.gd(this.$)&&(this.isVisible=!1)}MP(S){this.get_events().addHandler("EnrichmentTaskPaneRemoved",S)}$R(S){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",S)}RE(S){this.addHandler("EnrichmentTaskPaneVilibilityChanged",S)}nG(S){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",S)}RNg(S){this.addHandler("EnrichmentTaskPaneOnFocus",
S)}ykj(S){this.removeHandler("EnrichmentTaskPaneOnFocus",S)}get isVisible(){return super.isVisible}set isVisible(S){super.isVisible=S;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Ff(){return this.isVisible}get de(){return X.a.Nsh}get ih(){return 10}get dl(){return C}get vN(){return this.titleText}get titleText(){return"Enrichment"}get Lp(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.YO.offsetHeight}get eC(){return this.taskPaneManager.Kva(this.mc,
this.titleText,this.Lp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Lp)}nq(){return this.Tp}Es(){return this.Tp}JR(){}dispose(){this.$&&this.$.Jl(this.Bc);this.taskPaneManager=this.$=null;super.dispose()}gg(S,W){W||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!W}lh(S){return P.DOMElementExtensions.xf(this.mc,S)}sj(){}Wj(){}vg(S){this.Tp=S;const W=this.taskPaneManager;this.isVisible=S;L.a.gd(this.$)?S?this.taskPaneManager.e7("EnrichmentTaskPane",
this.eC):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(S&&0<W.dC.length&&(!W.nh||10!==W.nh.taskPane.ih||W.isCollapsed)&&W.qG(this,!0),W.pA());S||(l.h(this.$).gg(!0,!1),this.$.af())}WQ(){return!1}static ka(S,W){var O=S.Eb;let T=document.getElementById(O+e.a.iQe);T||(T=G.a("div",S.Eb+e.a.iQe,"cui-taskpane"),L.a.gd(S)||(O=document.getElementById(O+e.a.BR),void 0!==O&&null!==O?O.appendChild(T):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${S.BD}`)));
O=S.da;return O.za(257)||O.Ga(257,new H(T,S,W))}}Object(u.a)(H,"EnrichmentTaskPane",F.a,[374,2,263,39]);class J extends D.a{constructor(S){super();this.gh=this.xi=null;this.$=S;this.Fb()}get RD(){this.xi||(this.xi=d.TaskExtensions.Aa(A.a(this.$),S=>{this.gh=H.ka(this.$,S.result)},this.la,3));return this.xi}create(){const S=B.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),W=B.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);d.TaskExtensions.Aa(d.TaskExtensions.ts(d.TaskExtensions.Fd([S,
W],this.la),()=>this.RD,this.la),()=>{this.ob(this.gh)},this.la,3)}dispose(){this.gh=this.xi=this.$=null;super.dispose()}static ka(S){S.da.Ga(258,new J(S))}}Object(u.a)(J,"EnrichmentTaskPaneFactory",D.a,[]);var M=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{M.a.Fa(S=>{J.ka(S);x.ka(S);r.ka(S)})})()},758:function(u,D,a){a.r(D);var c=a(0),b=a(15),e=a(87),f=a(263),d=a(4),h=a(30),m=a(815),l=a(137),v=a(83),t=a(38),z=a(19),r=a(5),n=a(161),w=a(1235),B=a(1238),
A=a(170),y=a(556),x=a(346),F=a(60);const I=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"GetRichDataClassificationLabels",Ub,Ea,xb,bc,zb,4)},L=(pb,Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=pb.Na(1,Db);Db.selectedRanges=Ea;Db.domainId=xb;Db.autodetect=bc;return F.g(pb,"ConvertToLinkedEntity",Db,zb,Ub,wc,mb,4)},X=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"OnAutoDetectUIShown",Ub,Ea,xb,bc,zb,4)},P=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"GetLinkedEntityMetadata",Ub,
Ea,xb,bc,zb,4)},G=(pb,Ea,xb,bc,zb,Ub,wc=null)=>{wc=pb.Na(1,wc);wc.selectedRanges=Ea;return F.g(pb,"ConvertLinkedEntityToText",wc,xb,bc,zb,Ub,4)},C=(pb,Ea,xb,bc,zb,Ub,wc=null)=>{wc=pb.Na(1,wc);wc.selectedRanges=Ea;return F.g(pb,"RefreshLinkedEntitiesInRange",wc,xb,bc,zb,Ub,4)},H=(pb,Ea,xb,bc,zb,Ub,wc,mb,Db,Ic,Hc=null)=>{Hc=pb.Na(1,Hc);Hc.selectedRanges=Ea;Hc.isChangeObject=xb;Hc.isFloodgateEnabled=bc;Hc.isStarterData=zb;Hc.starterDataDomainId=Ub;return F.g(pb,"GetDataSelectorPaneData",Hc,wc,mb,Db,
Ic,4)},J=(pb,Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=pb.Na(9,mb);mb.activeCell=Ea;mb.selectionIndex=xb;return F.g(pb,"SelectLinkedEntityForDisambiguation",mb,bc,zb,Ub,wc,4)},M=(pb,Ea,xb,bc,zb,Ub,wc,mb,Db,Ic,Hc,Ab=null)=>{Ab=pb.Na(1,Ab);Ab.searchCell=Ea;Ab.searchQuery=xb;Ab.isFloodgateEnabled=bc;Ab.isStarterData=zb;Ab.starterDataDomainId=Ub;Ab.starterDataDomainIdString=wc;return F.g(pb,"LinkedEntitySearch",Ab,mb,Db,Ic,Hc,4)},S=(pb,Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=pb.Na(1,Db);Db.cell=Ea;Db.starterDataDomainId=
xb;Db.starterDataDomainIdString=bc;return F.g(pb,"InsertStarterDataTable",Db,zb,Ub,wc,mb,4)},W=(pb,Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=pb.Na(1,mb);mb.activeCell=Ea;mb.isBackward=xb;return F.g(pb,"MoveToNextAmbiguousLinkedEntity",mb,bc,zb,Ub,wc,4)},O=(pb,Ea,xb,bc,zb,Ub,wc=null)=>{wc=pb.Na(9,wc);wc.activeCell=Ea;return F.g(pb,"CancelSearchLinkedEntity",wc,xb,bc,zb,Ub,4)},T=(pb,Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=pb.Na(1,mb);mb.selectedRanges=Ea;mb.letyDomainId=xb;return F.g(pb,"GetDataTypeSelectorData",mb,
bc,zb,Ub,wc,4)},Y=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"GetErrorMessageForLinkedDataTypeRefresh",Ub,Ea,xb,bc,zb,4)},va=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"GetHasUntrustedImageUrls",Ub,Ea,xb,bc,zb,4)},ca=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"LinkedEntitiesEnableUntrustedImages",Ub,Ea,xb,bc,zb,0)},V=(pb,Ea,xb,bc,zb,Ub=null)=>{Ub=pb.Na(1,Ub);return F.g(pb,"LinkedEntityTryAutoRefresh",Ub,Ea,xb,bc,zb,0)};var ra=a(84),N=a(701),ea=a(788);class Ba{}
Ba.dei="EnrichmentContentFrame";Ba.width=320;Object(c.a)(Ba,"EnrichmentConstants",null,[]);class ka{constructor(pb){this.messageType=0;this.messageType=pb}}Object(c.a)(ka,"EnrichmentResponseMessage",null,[]);class Ka extends ka{constructor(pb,Ea){super(pb);this.messageContent=null;this.messageContent=Ea}}Object(c.a)(Ka,"EnrichmentResponseMessageWithContent",ka,[]);class Oa extends Ka{constructor(pb,Ea,xb){super(pb,Ea);this.telemetryJson=null;this.telemetryJson=xb}}Object(c.a)(Oa,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ka,[]);var wa=a(260),qa=a(14),aa=a(95),ia=a(45),Ha=a(85),Z=a(107),la=a(41),Xa=a(80),Za=a(27),xa=a(105),fa=a(693),ua=a(25);class sa{constructor(pb,Ea,xb,bc,zb){this.pr=this.uk=this.nbe=this.lbe=this.dw=this.dv=null;this.vx=!1;this.Gi=pb;this.Yd=Ea;this.wP=xb;this.Yb=bc;this.La=zb;this.Bqa=Z.KeyInputManager.El(Ha.a.RCa,0)}get mNb(){return!0}get yub(){return d.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.mNb&&this.pr&&(this.Gi.Ba(qa.a.click,this.pr,Object(ra.a)(this,this.mk,"onClosePaneClick")),
this.Yd.Ba(qa.a.Dd,this.pr,Object(ra.a)(this,this.hEf,"onKeyHide")));this.pr=null;this.dw&&(this.MXj(),this.dw.parentNode.removeChild(this.dw),this.dw=null);this.Yb.Bi("EnrichmentPaneId").Gk(this.Bqa)}show(pb,Ea,xb){this.dv=pb;this.vx||(this.uk=this.R1a(),this.Qna.appendChild(this.uk),this.Jfj(),this.La.Mb(ua.a.ZDe,xa.a.frame,Object(ra.a)(this,this.J9h,"handleEscapeKeyAction")),this.dTa(),this.vx=!0);this.dw.src=this.yub&&this.yub.length?this.yub+"?culture="+Ea.market+"&appName="+Ea.applicationName+
"&themeId="+Ea.themeId+"&featuresBitMask="+Ea.featuresBitMask:sa.Sxf;this.lbe=Ea;this.nbe=xb;this.Neb()}TDc(pb,Ea){pb=new Oa(2,pb,Ea);this.usc(pb)}dTa(){const pb=this.Yb.Bi("EnrichmentPaneId");pb.parent=wa.AFrame.$Oa;this.Gi.gob("EnrichmentPaneId",this.uk);pb.bindAction(this.Bqa,ua.a.ZDe)}R3f(){if(this.dw){aa.FocusManager.hpa(this.dw.contentWindow);const pb=new Oa(4,null,null);this.usc(pb)}}mk(){this.F4b();return!0}hEf(pb){pb=pb.Ca.keyCode;return pb===Sys.UI.Key.enter||pb===Sys.UI.Key.space?(this.F4b(),
!0):!1}F4b(){this.hide();if(this.dv)this.dv.onPaneClosed()}R1a(){const pb=N.a("div","EnrichmentPaneId","EnrichmentPane");this.mNb&&pb.appendChild(this.Y5c());this.Ohi(pb);return pb}Y5c(){const pb=N.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Ea=N.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Ea.innerText=CommonUIStrings.l_EnrichmentPaneTitle;Ea.title=CommonUIStrings.l_EnrichmentPaneTitle;const xb=ea.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Gi.ta(qa.a.click,xb,Object(ra.a)(this,this.mk,"onClosePaneClick"));this.Yd.ta(qa.a.Dd,xb,Object(ra.a)(this,this.hEf,"onKeyHide"));pb.appendChild(Ea);pb.appendChild(xb);this.pr=xb;return pb}Ohi(pb){this.dw=N.b("iframe","","EnrichmentFrame");pb.appendChild(this.dw);this.dw.id=Ba.dei;this.dw.setAttribute("role","presentation")}Jfj(){ia.a.addHandler(this.dw,"load",Object(ra.a)(this,this.LDf,"onIFrameLoad"));ia.a.addHandler(this.dw,"error",Object(ra.a)(this,this.Apc,
"onIFrameError"));$addHandler(window,"message",Object(ra.a)(this,this.MDf,"onIFrameMessage"))}MXj(){ia.a.removeHandler(this.dw,"load",Object(ra.a)(this,this.LDf,"onIFrameLoad"));ia.a.removeHandler(this.dw,"error",Object(ra.a)(this,this.Apc,"onIFrameError"));$removeHandler(window,"message",Object(ra.a)(this,this.MDf,"onIFrameMessage"))}Ojh(){this.dw.src=sa.Sxf}hide(){this.Hfc();this.Ojh()}J9h(pb,Ea,xb){if(1!==xb&&(this.hide(),this.dv))this.dv.onPaneClosed();return 32}LDf(){}Apc(){}MDf(pb){pb=pb.rawEvent;
if(!this.dw||-1!==this.dw.src.indexOf(pb.origin)){try{var Ea=la.a(pb.data)}catch(xb){return}if(!fa.c(Ea.messageType)){pb=window.g_badCastCallback;window.g_badCastCallback=null;switch(Ea.messageType){case 2:this.usc(new Oa(1,la.c(this.lbe),this.nbe));break;case 1:this.usc(new Ka(0,this.fPh()));break;case 3:this.dv&&this.dv.selectEntity(Ea.messageContent);break;case 5:this.dv&&this.dv.LEb(Ea.messageContent);break;case 8:this.dv&&(Ea=la.a(Ea.messageContent),0<Ea.DomainId?this.dv.gQd(Ea.Query,Ea.TelemetryJson,
Ea.DomainId,Ea.DomainIdString):this.dv.searchEntity(Ea.Query,Ea.TelemetryJson));break;case 6:this.dv&&this.dv.cancelSearch();break;case 11:Ea=la.a(Ea.messageContent);Ea=sa.s6b("keydown","f6",Ha.a.kGc,!0,!1,Ea,!0,!1);this.dw&&this.dw.dispatchEvent(Ea);break;case 12:if(la.a(Ea.messageContent).keyCode===Ha.a.kJ&&(Ea=sa.s6b("keydown","esc",Ha.a.kJ,!0,!1,!1,!1,!1),this.dw&&(this.dw.dispatchEvent(Ea),this.hide(),this.dv)))this.dv.onPaneClosed();break;case 13:this.dv&&this.dv.selectDataType(Ea.messageContent);
break;case 14:this.dv&&this.dv.showHelpArticle(Ea.messageContent);break;case 15:this.dv&&this.dv.showSurveyDialog(Ea.messageContent);break;case 16:this.dv&&(Ea=la.a(Ea.messageContent),this.dv.insertTable(Ea.DomainId,Ea.DomainIdString))}window.g_badCastCallback=pb}}}fPh(){return la.c([2,1,3,5,8,6])}usc(pb){pb=la.c(pb);this.dw.contentWindow.postMessage(pb,Xa.a.oba(this.yub))}static s6b(pb,Ea,xb,bc,zb,Ub,wc,mb){Za.a.vy?(Ub=String.format("{0} {1} {2}",Ub?"Shift":"",wc?"Control":"",mb?"Alt":""),Ub.trim(),
xb=document.createEvent("KeyboardEvent"),xb.initKeyboardEvent(pb,bc,zb,window.self,Ea,0,Ub,!1,"en-US")):(Ea={},Ea.keyCode=xb,Ea.ctrlKey=wc,Ea.shiftKey=Ub,Ea.altKey=mb,Ea.bubbles=bc,Ea.cancelable=zb,xb=new KeyboardEvent(pb,Ea));return xb}}sa.Sxf="about:blank";Object(c.a)(sa,"EnrichmentPane",null,[438,2]);class sb extends sa{constructor(pb){super(d.AFrameworkApplication.sa.Yy,d.AFrameworkApplication.sa.Zt,d.AFrameworkApplication.sa.Lea,d.AFrameworkApplication.sa.Le,d.AFrameworkApplication.ub);this.taskPane=
pb;this.taskPane.RNg(this.R3f)}get Qna(){return this.taskPane.mc}Neb(){this.taskPane.isVisible||this.taskPane.vg(!0)}Hfc(){this.taskPane.vg(!1)}dispose(){this.taskPane&&(this.taskPane.ykj(this.R3f),this.taskPane=null);super.dispose()}}Object(c.a)(sb,"EnrichmentTaskPaneWrapper",sa,[]);class hb{constructor(pb){this.fz=null;this.Pfa=pb}Uyi(pb,Ea){this.fz=pb;this.Pfa&&this.Pfa.show(this,Ea,null)}TDc(pb,Ea){this.Pfa&&this.Pfa.TDc(pb,Ea)}Uyb(){this.Pfa&&this.Pfa.hide()}dispose(){this.Pfa&&(this.Pfa.dispose(),
this.Pfa=null)}selectEntity(pb){return this.fz?this.fz.selectEntity(pb):!1}searchEntity(pb,Ea){this.fz&&this.fz.searchEntity(pb,Ea)}gQd(pb,Ea,xb,bc){this.fz&&this.fz.gQd(pb,Ea,xb,bc)}LEb(pb){return this.fz?this.fz.LEb(pb):!1}onPaneClosed(){if(this.fz)this.fz.onPaneClosed()}cancelSearch(){this.fz&&this.fz.cancelSearch()}selectDataType(pb){this.fz&&this.fz.selectDataType(pb)}showHelpArticle(pb){this.fz&&this.fz.showHelpArticle(pb)}showSurveyDialog(pb){this.fz&&this.fz.showSurveyDialog(pb)}insertTable(pb,
Ea){this.fz&&this.fz.insertTable(pb,Ea)}}Object(c.a)(hb,"EnrichmentManager",null,[439,2]);class bb extends hb{constructor(pb){super(pb)}dispose(){super.dispose()}}Object(c.a)(bb,"ExcelEnrichmentManager",hb,[]);var lb=a(13);class Fa{constructor(pb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=pb;this.commentQuestion=
lb.a.instance.nb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=lb.a.instance.nb(195);this.ratingValuesAscending=[lb.a.instance.nb(196),lb.a.instance.nb(197),lb.a.instance.nb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=lb.a.instance.nb(194)}}Object(c.a)(Fa,"FloodgateSurvey",null,[]);var Na=a(24),Mb=a(76),dc=a(419),Cb=a(42),Tb=a(371),Jb=a(188),eb=a(33),za=a(91),ha=a(29),fb=a(1),rb=a(281),pa=a(21);class Ma{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(Ma,"EnrichmentMessageContentAppProperties",null,[]);class Ja{constructor(pb,Ea,xb,bc,zb){this.yua=this.UMe=!1;this.Hdb=this.Fxa=!0;this.eHb=this.wNb=!1;this.Yeb=null;this.xrc=0;this.ER=()=>{(this.Hdb||this.yua)&&2!==this.xrc&&(this.eHb||this.Fvd(!1))};this.Tc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.hQi=Ub=>{ha.a.Zf(Ub.Errors)?(Ub=ha.a.sc(Ub.Errors),Ub.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Ub}`)):Ub.Result&&(this.$.ea.qk(this.Tc),this.$.ea.Tj(this.Tc),Ub=Ub.Result,this.Yeb=Ub.SkydanceFeatureBitmask,this.Uzd(Ub),this.wNb=!0)};this.Ag=()=>{(this.Hdb||this.yua)&&this.Fvd(!1)};this.upc=(Ub,wc)=>{ha.a.Zf(Ub.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${ha.a.sc(Ub.Errors)}`):Ub.Result&&(Ub=Ub.Result,Ub.DisambiguationJson?(this.wNb=!1,this.Q4f(wc),this.Yeb=Ub.SkydanceFeatureBitmask,wc=Ub.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.eHb=!1,this.Cpf(wc)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.VSi=(Ub,wc)=>{ha.a.Zf(Ub.Errors)?(wc=ha.a.sc(Ub.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${wc}`)):Ub.Result&&(Ub=Ub.Result,Ub.DisambiguationJson?(this.Q4f(wc),this.Yeb=Ub.SkydanceFeatureBitmask,wc=Ub.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.eHb=!0,this.Cpf(wc)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.BWi=Ub=>{ha.a.Zf(Ub.Errors)?(Ub=ha.a.sc(Ub.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Ub}`),this.Hdb=!0):Ub.Result&&(Ub=Ub.Result,this.Yeb=Ub.SkydanceFeatureBitmask,this.Uzd(Ub),this.wNb=!0)};this.xZi=Ub=>{if(ha.a.Zf(Ub.Errors)){const wc=ha.a.sc(Ub.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${wc}`)}Ub.Result?
(this.Uzd(Ub.Result),this.wNb=!0):this.yta()};this.CHf=Ub=>{ha.a.Zf(Ub.Errors)?(Ub=ha.a.sc(Ub.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Ub}`)):Ub.Result?this.I9b.TDc(Ub.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.yta())};this.jVi=Ub=>{ha.a.Zf(Ub.Errors)?(Ub=ha.a.sc(Ub.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${Ub}`)):this.yta()};this.$=pb;this.gridView=pa.h(this.$);this.gridView.ha.RT(this.Ag);this.gridView.mv(this.ER);this.KQe=bc;this.convertToLinkedEntityManager=zb;eb.a.gd(this.$)||xb.yN(Ea);pb=new sb(Ea);this.I9b=new bb(pb);v.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ub=>{Ub.isFeatureEnabled("mso_sendASmile",!0).then(wc=>{this.Fxa=wc;return null})})}dispose(){this.$&&(this.gridView.ha.aS(this.Ag),
this.gridView.Oy(this.ER))}selectEntity(pb){const Ea=Cb.o(this.gridView.ha.ra.activeCell,this.$),xb=()=>new dc.a;Tb.a(this.$.userOperationManager,(bc,zb,Ub)=>J(this.$.pa.ya,Ea,pb,rb.b(bc,this.xZi),zb,Ub,null),bc=>new Jb.a(109,0,bc,void 0,xb),null);return!0}searchEntity(pb,Ea,xb=!1,bc=0,zb=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Ea}`);const Ub=Cb.o(this.gridView.ha.ra.activeCell,this.$);Tb.a(this.$.userOperationManager,
(wc,mb,Db)=>M(this.$.pa.ya,Ub,pb,this.Fxa,xb,bc,zb,rb.b(wc,this.CHf),mb,Db,null),wc=>new Jb.a(110,0,wc,16),null)}LEb(pb){const Ea=Cb.o(this.gridView.ha.ra.activeCell,this.$);this.Hdb=!1;Tb.a(this.$.userOperationManager,(xb,bc,zb)=>W(this.$.pa.ya,Ea,pb,rb.b(xb,this.BWi),bc,zb,null),xb=>new Jb.a(111,0,xb,16),null);return!0}onPaneClosed(){this.yua=!1;this.UMe=!0;this.xrc=0;this.eHb=!1}cancelSearch(){const pb=this.yQd();pb&&Tb.a(this.$.userOperationManager,(Ea,xb,bc)=>O(this.$.pa.ya,pb,rb.b(Ea,this.CHf),
xb,bc,null),Ea=>new Jb.a(112,0,Ea,16),null)}selectDataType(pb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.yta();if(pb&&pb.length)if(pb=JSON.parse(pb))if(null==pb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Ea={};Ea.Id=pb.domainId;Ea.StringId=pb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(Ea)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(pb){const Ea=new za.a(-859308420,Mb.a.Db,this.$.Hc,9,null);this.$.Ka.Lb(Ea,{[Mb.a.lg]:"HelpID="+pb,["InputMethod"]:Mb.a.Db,["ShouldCanvasTakeFocus"]:!0,[Mb.a.Ic]:r.a.tV})}showSurveyDialog(pb){B.a.WNb(new Fa(pb))}insertTable(pb,Ea){const xb=this.yQd();xb&&Tb.a(this.$.userOperationManager,(bc,zb,Ub)=>
S(this.$.pa.ya,xb,pb,Ea,rb.b(bc,this.jVi),zb,Ub,null),bc=>new Jb.a(259,0,bc,1),null)}Fvd(pb){this.launchOrCloseDisambiguationPane(pb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const pb=this.suj();pb&&Tb.a(this.$.userOperationManager,(Ea,xb,bc)=>H(this.$.pa.ya,pb,!0,this.Fxa,!1,null,rb.b(Ea,this.VSi),xb,bc,1),Ea=>new Jb.a(114,0,Ea,16),null)}launchLinkedEntityDataTypeSelectorPane(pb,
Ea){Tb.a(this.$.userOperationManager,(xb,bc,zb)=>T(this.$.pa.ya,pb,Ea,rb.b(xb,this.upc),bc,zb,2),xb=>new Jb.a(233,0,xb,16),null)}Oyi(pb,Ea){pb&&Tb.a(this.$.userOperationManager,(xb,bc,zb)=>H(this.$.pa.ya,pb,!1,!1,!0,Ea,rb.b(xb,this.upc),bc,zb,2),xb=>new Jb.a(257,0,xb,16),null)}Q4f(pb){pb&&(this.xrc=pb)}Cpf(pb){if(fb.EwaSettings.ma(644)){var Ea=new za.a(-90814711,Mb.a.Db,0,10,null);this.$.Ka.Lb(Ea,null)}this.yua?this.I9b.TDc(pb,null):(Ea=3,null!=this.Yeb?Ea=this.Yeb:b.ULS.shipAssertTag(537166937,0,
!1,"SkydanceFeatureBitmask was not set"),(pb=this.YUh(pb,Ea))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.KQe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.I9b.Uyi(this.KQe,pb),this.yua=!0)}yta(){this.yua&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.I9b.Uyb(),this.yua=!1,this.xrc=0,this.eHb=!1)}Uzd(pb){var Ea=pb.Row+1;pb=pb.Column+1;
0>Ea||0>pb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.yta(),this.$.ea.qk(this.Tc)):(Ea=new Na.Range(Ea,pb,Ea,pb,!0,!1),this.gridView.ha.updateSelection(Ea,Ea,60),this.Hdb=!0)}YUh(pb,Ea){const xb=new Ma;xb.applicationVersion=d.AFrameworkApplication.buildVersion;xb.applicationName="ExcelWac";xb.anid="00000000-0000-0000-0000-000000000000";xb.sessionId=d.AFrameworkApplication.userSessionId;xb.appCorrelationId=
A.a.create().toString();var bc=y.a.uK(d.AFrameworkApplication.lcid);bc=bc?bc.name:null;xb.uiLanguage=bc;xb.market=this.ucc(bc);xb.themeId=0;xb.disambiguationJson=pb;Ea<=x.a.QS?xb.featuresBitMask=Ea:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return xb}ucc(pb){pb=pb.split("-");return pb[pb.length-1]}launchOrCloseDisambiguationPane(pb){const Ea=this.gridView.ha.ra.activeCell;if(this.yQd()&&Ea)if(this.gridView.Bb.Xzb(Ea)){if((!this.UMe||
pb||this.wNb)&&!this.gridView.eb){pb&&(this.Hdb=!0);var xb=Cb.q(Ea,this.$);Tb.a(this.$.userOperationManager,(bc,zb,Ub)=>H(this.$.pa.ya,xb,!1,this.Fxa,!1,null,rb.b(bc,this.upc),zb,Ub,1),bc=>new Jb.a(114,0,bc,16),null)}}else this.yta();else this.yta()}yej(){if(this.yua){var pb=this.gridView.ha.ra.activeCell;if(pb){var Ea=Cb.q(pb,this.$);Tb.a(this.$.userOperationManager,(xb,bc,zb)=>H(this.$.pa.ya,Ea,!1,this.Fxa,!1,null,rb.b(xb,this.upc),bc,zb,1),xb=>new Jb.a(114,0,xb,16),null)}else this.yta()}}yQd(){const pb=
this.gridView.ha.ra;return pb.gca()?Cb.o(pb.activeCell,this.$):null}suj(){const pb=this.gridView.ha.ra;return pb.gca()?Cb.q(pb.activeCell,this.$):null}}Object(c.a)(Ja,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Ga=a(7),La=a(375),nb=a(1393),Lb=a(53),ac=a(708);class ib{constructor(pb,Ea,xb){this.$pf=2;this.Zpf="Size64by48";this.$=pb;this.Va=Ea;this.convertToLinkedEntityManager=xb}eNh(pb,Ea){var {ConvertToLinkedEntityManager:xb}=a(758);this.m_j();Ea=this.Va.cq(Ea).QC();let bc=0,zb=0,Ub=!1;
for(var wc of pb.Categories){const mb=this.LNh(wc,bc);mb&&(zb===xb.t9a&&(Ub=!0),Ea.MenuSectionList.push(mb),++bc);++zb}Ub&&bc<=xb.aqf&&Ea.MenuSectionList.splice(xb.t9a,1);xb=this.Va.Ec().M2b();wc=Lb.a.Ge(11);for(const mb of pb.LongButtons)this.convertToLinkedEntityManager.AGj(mb)&&this.uKg(xb,mb,wc);0<xb.ControlList.length&&Ea.MenuSectionList.push(xb);return Ea}uKg(pb,Ea,xb){if(Ea){var bc="Data.ConvertToLinkedEntityMenuItem_"+Ea.Name,zb=this.convertToLinkedEntityManager.IU(Ea.DomainId);zb&&(Ea=Object(Ga.a)(new La.a,
{Id:bc,ExternalId:bc,Command:"-1662108744",LabelText:Ea.Name,Alt:Ea.SuperTip,Visible:!0,MenuItemId:a(758).ConvertToLinkedEntityManager.N2a(Ea.DomainId),Image16by16:xb,Image16by16Class:this.Kei(zb.FontLocator)}),pb.ControlList.push(Ea))}}GNh(pb,Ea){return Object(Ga.a)(new nb.a,{Id:a(758).ConvertToLinkedEntityManager.FOe+pb.toString(),ExternalId:a(758).ConvertToLinkedEntityManager.FOe+pb.toString(),MenuItemId:a(758).ConvertToLinkedEntityManager.F9c+pb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.jdf(Ea.FontLocator),LabelText:Ea.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.$fd(Ea)})}JUg(pb){switch(pb){case "Animal":return ac.a.gRg;case "Apple":return ac.a.jSg;case "Atom":return ac.a.DTg;case "Beaker":return ac.a.zVg;case "Bridge":return ac.a.$Wg;case "Cat":return ac.a.b2g;case "City":return ac.a.n4g;case "Constellation":return ac.a.l9g;case "Dog":return ac.a.zph;case "Finance":return ac.a.sVg;case "GradCap":return ac.a.x8h;case "HumanAnatomy":return ac.a.aei;
case "LocationPointer":return ac.a.nBi;case "Map":return ac.a.m2i;case "MedicineNeedle":return ac.a.NHi;case "Mountain":return ac.a.fJi;case "Movie":return ac.a.yJi;case "Music":return ac.a.KJi;case "OuterSpace":return ac.a.O2i;case "Planet":return ac.a.Q5i;case "Satellite":return ac.a.Rrj;case "WolframGeneric":return ac.a.Nqj;default:return ac.a.Y$g}}Kei(pb){if("PowerBIRibbon"!==pb)return z.a.Zad;switch(pb){case "AnimalRibbon":return z.a.QAh;case "AppleRibbon":return z.a.RAh;case "AtomRibbon":return z.a.SAh;
case "BeakerRibbon":return z.a.TAh;case "BridgeRibbon":return z.a.UAh;case "CenterMapRibbon":return z.a.VAh;case "CityRibbon":return z.a.WAh;case "CurrencyRibbon":return z.a.XAh;case "ExerciseRibbon":return z.a.YAh;case "FinanceRibbon":return z.a.HUe;case "FirstAidRibbon":return z.a.ZAh;case "GlobeLightningRibbon":return z.a.$Ah;case "GradCapRibbon":return z.a.aBh;case "HumanAnatomyRibbon":return z.a.bBh;case "LeafRibbon":return z.a.cBh;case "LocationPointerRibbon":return z.a.eBh;case "MapRibbon":return z.a.FUe;
case "MountainRibbon":return z.a.fBh;case "MovieRibbon":return z.a.gBh;case "MusicRibbon":return z.a.hBh;case "NotablePeopleRibbon":return z.a.iBh;case "OuterSpaceRibbon":return z.a.jBh;case "PartlySunnyWeatherRibbon":return z.a.kBh;case "PowerBIRibbon":return z.a.GUe;case "SatelliteRibbon":return z.a.lBh;case "WolframGenericRibbon":return z.a.dBh;case "YogaRibbon":return z.a.nBh;default:return z.a.EUe}}jdf(pb){switch(pb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}LNh(pb,Ea){Ea=this.Va.gB("ConvertToLinkedEntitySection_"+Ea,this.$pf,this.Zpf);var xb=!1;for(var bc of pb.DomainIds){const zb=this.convertToLinkedEntityManager.IU(bc);if(!zb||
zb.DomainBlocked||!zb.ShowInRibbon)continue;xb=zb.Name;const Ub=a(758).ConvertToLinkedEntityManager.N2a(bc);Ea.ku("Data.ConvertToLinkedEntityMenuItem_"+Ub,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Ub,this.jdf(zb.FontLocator),void 0,void 0,this.$fd(zb),xb);xb=!0}if(!xb)return null;bc=Ea.rqb(!0);Ea=this.Va.Ec();Ea.title=pb.Name;pb=Ea.M2b();pb.ControlList.push(bc);return pb}m_j(){this.$pf=5;this.Zpf="Size112by64"}$fd(pb){return pb.RibbonTooltipHeader?pb.RibbonTooltipHeader+"\n\n"+pb.RibbonTooltip:
pb.RibbonTooltip}}Object(c.a)(ib,"ConvertToLinkedEntityMenuRenderer",null,[406]);var Ra=a(58),ya=a(283),Va=a(116),oa=a(145),kb=a(72);class Sa{constructor(pb,Ea){this.Gld=this.Hld=!1;this.hYi=xb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Hld=!0;if(ha.a.Zf(xb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${ha.a.sc(xb.Errors)}`);else{var bc=0,zb=[],Ub=!1;try{if(!xb.Result)return;const wc=xb.Result;if(!wc){b.ULS.sendTraceTag(537166678,
0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}zb=this.e4i(wc);if(!zb||!zb.length)return;bc=zb.length;this.bIi(zb);this.WAa.oYf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.WAa.ecb.length}`);if(fb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const mb of this.WAa.ecb)if(1===(mb.Id&1048320)>>8){Ub=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Ub}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${bc} data types.`),xb=[],xb.push(Object(Ga.a)(new kb.a,{name:"MruCount",int64:bc})),xb.push(Object(Ga.a)(new kb.a,{name:"MruWolframAvailable",bool:Ub})),oa.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,xb)}this.Gld&&(this.Amg(this.WAa.ecb),this.Gld=!1)}};this.K1i=xb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");ha.a.Zf(xb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${ha.a.sc(xb.Errors)}`):
xb.Result&&(xb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.gHf=(xb,bc,zb)=>{xb=Va.a.Oe(xb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${zb}. Errors: ${ha.a.sc(xb)}.`)};this.$=pb;this.WAa=Ea}$1h(){this.Hld||fb.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.Zb||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
ya.w(this.$.pa.ya,0,this.hYi,this.gHf,null,null))}Amg(pb){pb&&pb.length?this.Hld?(pb=this.awj(pb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),ya.C(this.$.pa.ya,0,pb,this.K1i,this.gHf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Gld=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}awj(pb){if(!pb||
!pb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Ea=[];for(const xb of pb)pb={},pb.Id=xb.Id,xb.StringId&&(pb.StringId=xb.StringId),Ea.push(pb);Ea="<DataTypes>"+Ra.a.hc(Ea)+"</DataTypes>";return 1906<Ea.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Ea}e4i(pb){if(!pb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!pb.startsWith("<DataTypes>")||!pb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;pb=pb.substring(11,pb.length-12);if(!pb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Ea=[];try{Ea=Ra.a.li(pb)}catch(xb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${xb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Ea.length} data types.`);return Ea}bIi(pb){const Ea=this.WAa.ecb,xb=this.WAa.wdj;if(Ea.length!==xb){for(let bc=0;bc<pb.length&&Ea.length<xb;++bc){const zb=pb[bc];this.WAa.IU(zb)&&!Ea.includes(zb)&&Ea.push(zb)}this.WAa.ecb=Ea}}}Object(c.a)(Sa,"LinkedDataTypeRoamingHandler",null,[]);var U=a(59),ta=a(50),ub=a(190),hc=a(37),Bc=a(47),Qa=a(28),na=a(282),ab=a(22),Gb=a(98);a.d(D,"ConvertToLinkedEntityManager",function(){return fc});
class fc extends t.a{constructor(pb,Ea,xb,bc,zb,Ub,wc){super();this.tmf=this.rtd=this.oud=this.jsd=this.isd=this.b8a=this.kpd=null;this.mFb=this.ild=0;this.Sla=null;this.wpd=!1;this.ked=this.fo=this.cPd=null;this.Gs=0;this.RY=null;this.fMa=8;this.b1c=this.Ypf=this.xif=this.Kab=!1;this.Wza=this.K_e=this.DXe=null;this.ZZc=0;this.VUg=5;this.c2b=3E4;this.Teg=!1;this.h3=null;this.Oua=Array(5);this.vhg=this.N0d=!1;this.EZf=this.cwd=0;this.htmlSanitizationHelper=this.dfe=null;this.N9f=!0;this.Tc=(mb,Db)=>
{Db.Zb&&!Db.KBb&&this.showUntrustedImageBusinessBarIfNecessary()};this.UTi=mb=>{if(mb.Result){var Db=mb.Result;if(Db&&Db.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Db.length} labels`);var Ic=ta.GetServiceTaskFactory.Oa(this.$.da,274,275,0);hc.TaskExtensions.Aa(Ic,()=>{Ic.result.PZc(Db,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.yf=()=>{this.WAb&&(this.yVj(),this.r$h(this.$.ea.Ho.LinkedEntityAsyncRefreshStateId));this.j8a?this.xai(this.$.ea.Ho.RichDataClassificationLabelStateId):this.s7a&&this.$_d(!0)};this.pRi=()=>{this.N0d=!0;this.fo&&this.fo.yej()};this.nTi=mb=>{if(mb&&!na.a(mb))try{mb.Result.HasUntrustedImageUrl&&(this.businessBar.kg(59,null),this.vhg=!0)}catch(Db){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Db}.`)}};
this.zpf=()=>{if(!this.Ypf&&this.oAb()&&!this.kqd())if(oa.a("DataTabActive"),U.a.yg.iR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var mb=this.f6b();if(mb){var Db={};Db.InputMethod=Mb.a.Db;Db.CalloutName=8;Db.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Lb(mb,Db);this.Ypf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.iQi=mb=>{ha.a.Zf(mb.Errors)||(this.j8a||this.$_d(!1),this.raiseEvent("LinkedEntityConverted"))};this.C_i=()=>{this.$.da.$a(211,mb=>{mb.readText(lb.a.instance.ga(1802))})};this.ed=(mb,Db)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Db.NV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.sCe():this.soj(),fb.EwaSettings.ma(644)&&this.N0d&&this.LPe())};this.vTi=mb=>{this.n4b();if(mb.Result){var Db=mb.Result;mb=Db.DomainDataArray;if(this.Sla=Db.Ribbon){var Ic={};Ic.Name=lb.a.instance.ga(1792);Ic.DomainIds=this.SK;this.Sla.Categories.splice(fc.t9a,0,Ic)}0<Db.MaximumCellsToConvert&&(this.dfe=Db.MaximumCellsToConvert);this.Gs=2;Db=!1;if(mb){b.ULS.sendTraceTag(39949271,0,50,
`OnGetLinkedEntityServiceDomainsSuccess: Received ${mb.length} domains`);this.COa||(this.COa=[]);Ic=lb.a.instance.ga(1789);const Hc=lb.a.instance.ga(1791);for(const Ab of mb)Ab.DomainId?(this.COa.push(Ab),Ab.DomainBlocked?(mb=!!Ab.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${mb?Ab.DomainId.Id.toString():Ab.Name} is telemetry only, do not show in menu (Has String ID: ${mb})`)):(this.HU.ia(fc.N2a(Ab.DomainId),Ab),Ab.Name===Ic||268435456===Ab.DomainId.Id?this.DXe=Ab.DomainId.Id.toString():
Ab.Name===Hc||536870912===Ab.DomainId.Id?this.K_e=Ab.DomainId.Id.toString():268435712===Ab.DomainId.Id&&Ab.ShowInRibbon&&(this.b1c=!0),Db=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Db||(this.COa=null);this.jig();this.cPd.$1h();this.Teg||(this.uVj(),this.Teg=!0)}else this.COa=null,this.Gs=3,-1<this.fMa&&window.setTimeout(()=>{this.aIb()},100*(8-this.fMa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.MKd();this.GIe();this.b1c&&this.Njf&&ub.c(this.zpf,this.$.la,500);this.s7a&&!this.j8a&&this.$_d(!0)};this.uTi=mb=>{mb=Va.a.Oe(mb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${ha.a.sc(mb)}].`);this.COa=null;this.Gs=3;this.Kab=!0;this.MKd()};this.onContentReady=()=>{this.ggg()&&this.gridView.Oy(this.onContentReady);this.N9f&&this.$.workbookContext.Options&1048576&&(this.businessBar.sKj(),this.N9f=!1)};this.ij=()=>{this.n4b()};this.aWi=mb=>{if(na.a(mb)){const Db=
ta.GetServiceTaskFactory.Oa(this.$.da,5,4,0);hc.TaskExtensions.Aa(Db,()=>{let Hc=null;if(null===mb||void 0===mb?0:mb.Errors)Hc=mb.Errors[0];Db.result.s9f(Hc,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ha.a.sc(mb.Errors)}].`);const Ic=ha.a.VB(mb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Qo(Ic)}};
this.S0c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.c2b} millisecond interval`);this.agf("Periodic auto-refresh check",this.zOi,this.yOi)};this.zOi=mb=>{na.a(mb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ha.a.sc(mb.Errors)}].`),++this.ZZc):this.ZZc=0;e.a.Ia(this.Wza);this.ZZc>=this.VUg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Wza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Wza=Bc.a.instance.create(this.S0c,this.c2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.yOi=mb=>{mb=Va.a.Oe(mb.data);f.a.ph(mb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${ha.a.sc(mb)}].`);e.a.Ia(this.Wza);this.Wza=Bc.a.instance.create(this.S0c,this.c2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.dXi=mb=>{mb=!!mb.Result&&mb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${mb.toString()}`);mb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Qa.a.Qa.ue.m-
this.ild} ms, retry count = ${this.mFb}`),this.aIb()):this.PAc()};this.cXi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.PAc()};this.ZSi=mb=>{mb.Result?(mb=mb.Result)?(this.WLd(),this.businessBar.s9f(null,mb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=pb;this.businessBar=Ub;this.svgIconProvider=
xb;this.htmlSanitizationHelper=wc;this.COa=[];this.SK=[];this.gridView=pa.h(this.$);this.cfc=-1;this.$qi=fb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.s7a=this.$.ma(436)&&this.$.ma(287);this.j8a=this.$.ma(664);this.WAb=fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.Njf=fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.HU=new Gb.a;
this.a$a=new ib(pb,Ea,this);bc&&(this.fo=new Ja(pb,bc,zb,this,this));this.$.nl(this.ed);n.a(this.$)&&n.a(this.$).Exj(this);this.sCe();(this.WAb||this.s7a||this.j8a)&&this.$.ea.mu(this.yf);fb.EwaSettings.ma(130)&&fb.EwaSettings.ma(138)&&(this.ggg()||this.gridView.mv(this.onContentReady));this.$.VA(this.ij);fb.EwaSettings.ma(644)&&(this.$.ea.Tj(this.Tc),this.showUntrustedImageBusinessBarIfNecessary());this.cPd=new Sa(this.$,this)}dispose(){(this.WAb||this.s7a||this.j8a)&&this.$.ea.Ov(this.yf);fb.EwaSettings.ma(644)&&
this.$.ea.qk(this.Tc);!this.h3&&fb.EwaSettings.ma(130)&&fb.EwaSettings.ma(138)&&this.gridView.Oy(this.onContentReady);this.fo&&this.fo.dispose();this.$.bE(this.ij);this.$.Kl(this.ed);this.s7a&&(this.kpd=null);e.a.Ia(this.Wza)}xNg(pb){this.addHandler("LinkedEntityConverted",pb)}ikj(pb){this.removeHandler("LinkedEntityConverted",pb)}get wdj(){return 5}get ecb(){return this.SK}set ecb(pb){this.SK=pb}selectEntity(pb){return this.fo?this.fo.selectEntity(pb):!1}searchEntity(pb,Ea){this.fo&&this.fo.searchEntity(pb,
Ea)}gQd(pb,Ea,xb,bc){this.fo&&this.fo.searchEntity(pb,Ea,!0,xb,bc)}LEb(pb){return this.fo?this.fo.LEb(pb):!1}onPaneClosed(){if(this.fo)this.fo.onPaneClosed()}cancelSearch(){this.fo&&this.fo.cancelSearch()}selectDataType(pb){this.fo&&this.fo.selectDataType(pb)}showHelpArticle(pb){this.fo&&this.fo.showHelpArticle(pb)}showSurveyDialog(pb){this.fo&&this.fo.showSurveyDialog(pb)}insertTable(pb,Ea){this.fo&&this.fo.insertTable(pb,Ea)}xai(pb){this.$.isEditMode&&this.EZf!==pb&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&
(this.EZf=pb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),I(this.$.pa.ya,this.UTi,null,null,null))}LPe(){this.$.userOperationManager.Kc(new Jb.a(589,0,(pb,Ea,xb)=>ca(this.$.pa.ya,rb.b(pb,this.pRi),Ea,xb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.N0d||this.vhg||!this.$.ea.Zb||this.fvj()}fvj(){this.$.userOperationManager.Kc(new Jb.a(588,0,(pb,Ea,xb)=>va(this.$.pa.ya,rb.b(pb,this.nTi),Ea,xb,null),80),
null)}$_d(pb){if(this.s7a&&null==this.kpd&&!this.j8a&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.b8a&&this.b8a&&(!pb||this.$.workbookContext.Options&262144)){var Ea=ta.GetServiceTaskFactory.Oa(this.$.da,274,275,0);hc.TaskExtensions.Aa(Ea,()=>{this.kpd=Ea.result.ZSf(2)},this.$.la,3)}}get mEb(){return this.Oua.length}get IHi(){return this.dfe}Z$g(pb){(pb=this.Dph(pb))?this.convertToLinkedEntity(pb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(pb){b.ULS.sendTraceTag(34415004,
0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${pb.Id}].`);if(this.gridView){var Ea=this.gridView.ha.ra.$c,xb=Ea.Ke(this.gridView.KH);this.wpd&&this.hLg(pb);if(xb){xb=this.gridView.Bb.Sxa(xb);if(!this.Aaf(pb)&&this.Pkf(pb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(U.a.yg.iR){Ea=this.rfd();if(!Ea){b.ULS.sendTraceTag(537166917,
0,50,"CalloutAnchorElement is null for blankCellConvert");return}xb=this.f6b();if(!xb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var bc={["InputMethod"]:Mb.a.Db,CalloutName:3};bc.Target=Ea;bc.RibbonButtonLabel=fb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.qZf(pb):this.zCb(pb.Id.toString());bc.ExampleEntities=this.FVe(pb);this.$.Ka.Lb(xb,bc);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Pkf(pb.Id)&&
!pb.StringId)this.launchLinkedEntityDataTypeSelectorPane(fc.N2a(pb));else{if(xb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.sPj(pb)){Ea=Cb.r(this.gridView.ha.ra.selectedRanges,this.$);this.fo.Oyi(Ea,pb);return}if(U.a.yg.iR){Ea=this.rfd();if(!Ea){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}xb=this.f6b();if(!xb){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}bc={["InputMethod"]:Mb.a.Db,CalloutName:2};bc.Target=Ea;bc.RibbonButtonLabel=this.qZf(pb);bc.ExampleEntities=this.FVe(pb);bc.BlankCellResourceId=this.$Vg(pb);bc.HasBlankCellWalkthrough=this.lbi(pb);bc.ServiceDomain=pb.Id;this.$.Ka.Lb(xb,bc);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.X4c(pb,
!1,Ea)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.h3&&this.h3.IIa()}onAutoDetectUIShown(){Tb.a(this.$.userOperationManager,(pb,Ea,xb)=>X(this.$.pa.ya,pb,Ea,xb,null),pb=>new Jb.a(230,0,pb,80),null)}X4c(pb,Ea,xb){const bc=Cb.q(xb,this.$),zb=()=>new dc.a;Tb.a(this.$.userOperationManager,(Ub,wc,mb)=>L(this.$.pa.ya,bc,pb,Ea,rb.b(Ub,this.iQi,this.C_i,this.fo.hQi),wc,mb,null),Ub=>new Jb.a(115,0,Ub,void 0,zb),null)}hLg(pb){if(this.wpd){var Ea=
{};Ea.Id=pb.Id;pb.StringId&&(Ea.StringId=pb.StringId);if(!(0<this.SK.length&&this.SK[0].Id===Ea.Id&&this.SK[0].StringId===Ea.StringId)){pb=!1;this.SK.splice(0,0,Ea);for(let xb=1;xb<this.SK.length;++xb)if(this.SK[xb].Id===Ea.Id&&this.SK[xb].StringId===Ea.StringId){this.SK.splice(xb,1);pb=!0;break}for(;5<this.SK.length;)this.SK.splice(this.SK.length-1,1);this.Sla.Categories[fc.t9a].DomainIds=this.SK;this.oYf();pb||this.cPd.Amg(this.SK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var pb=Cb.q(this.gridView.ha.ra.$c,this.$);Tb.a(this.$.userOperationManager,(Ea,xb,bc)=>G(this.$.pa.ya,pb,Ea,xb,bc,null),Ea=>new Jb.a(116,0,Ea),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(pa.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.WLd();var pb=Cb.r(this.gridView.ha.ra.selectedRanges,this.$);Tb.a(this.$.userOperationManager,(Ea,xb,bc)=>C(this.$.pa.ya,pb,Ea,xb,bc,null),Ea=>new Jb.a(248,0,Ea),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}AGj(pb){pb=this.IU(pb.DomainId);if(!pb||pb.DomainBlocked||fb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!pb.HasCuratedData)return!1;if(this.$qi){for(let Ea of this.HU)if(Ea.value.DomainId.Id===pb.DomainId.Id&&Ea.value.ShowInRibbon)return!0;return!1}return pb.ShowInRibbon}nFj(pb){return 2!==this.Gs||!this.Oua[pb]}launchDisambiguationPaneForSearch(){this.fo&&this.fo.launchDisambiguationPaneForSearch()}Jc(pb,Ea,xb){if("PopulateConvertToLinkedEntityMenu"!==Ea)return!1;this.ked=xb.MenuId;if(0===this.Gs||3===this.Gs)return this.q6i(),!0;if(!this.Sla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.HU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.RY=this.RY||this.a$a.eNh(this.Sla,xb.MenuId);xb.MenuItems=this.RY;return this.wpd=!0}q6i(){-1===this.cfc&&(this.aIb(),this.cfc=window.setInterval(()=>{this.aIb()},2E3))}aIb(){this.$.ea.Zb&&2!==this.Gs&&(this.fMa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Gs=1,P(this.$.pa.ya,this.vTi,this.uTi,null,null))}kqd(){return this.$.isEditMode&&
2!==this.Gs&&(0<=this.fMa||!this.Kab)}y1d(pb){d.AFrameworkApplication.Lg?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):n.a(this.$)?(this.O_j(),pb&&this.$.af()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}soj(){this.mFb=0;this.fMa=8;this.Kab=!1;this.Gs=this.cfc=0;this.COa=this.Sla=null;this.n4b();for(let pb=0;pb<this.mEb;++pb)this.Oua[pb]=null;this.oAb()&&this.y1d(!0)}n4b(){this.RY=null}oAb(){const pb=
r.a.TIb,Ea=n.a(this.$);return!!Ea&&Ea.Gm.gA===pb}jig(){if(this.Sla){let xb=0;var pb=-1,Ea=-1;let bc=0,zb=0,Ub=0,wc=0;const mb=[null,null,null,null,null];for(const Db of this.Sla.Categories){let Ic=!1;for(const Hc of Db.DomainIds){let Ab=this.IU(Hc);Ab&&!Ab.DomainBlocked&&Ab.ShowInRibbon&&(xb<this.mEb?(this.Oua[xb]=Hc,zb===fc.t9a&&(-1===pb&&(pb=xb),Ea=xb,wc=Ea-pb+1),++xb):xb===this.mEb&&bc<wc&&zb!==fc.t9a&&(mb[bc]=Hc,++bc),Ic=!0)}Ic&&++Ub;++zb}if(-1<pb&&Ub<=fc.aqf){for(;Ea>=pb;--Ea)this.Oua.splice(Ea,
1);for(pb=0;pb<wc;++pb)this.Oua.splice(xb+pb,0,mb[pb])}for(;xb<this.mEb;)this.Oua[xb]=null,++xb}}ggg(){const pb=pa.h(this.$).Ea,Ea=this.gridView.ha.Ne;if(pb&&pb.nld&&1===Ea&&this.gridView.ha.ra.activeCell){const xb=ta.GetServiceTaskFactory.Oa(this.$.da,12,477,1);fb.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?hc.TaskExtensions.Aa(xb,()=>{this.h3=new w.a(this.$,this.svgIconProvider,xb.result,this,this.htmlSanitizationHelper)},this.$.la,3):this.h3=
new w.a(this.$,this.svgIconProvider,xb.result,this,this.htmlSanitizationHelper);return!0}return!1}Ryi(){this.fo&&this.fo.Fvd(!0)}launchLinkedEntityDataTypeSelectorPane(pb){if(this.fo)if(pb=this.l9c(pb))if(pb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Ea=Cb.r(this.gridView.ha.ra.selectedRanges,this.$);this.fo.launchLinkedEntityDataTypeSelectorPane(Ea,pb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}p9g(pb){const Ea=
this.Jei(pb),xb=h.a.Eg(this.zCb(pb));pb=h.a.Eg(this.ZZd(pb));return fc.HMh(Ea,Lb.a.Ge(11),xb,pb)}ZZd(pb){try{return this.SNe(parseInt(pb,10)).Description}catch(Ea){}return lb.a.instance.ga(1786)}zCb(pb){try{return this.SNe(parseInt(pb,10)).Name}catch(Ea){}return lb.a.instance.ga(1772)}qZf(pb){try{return this.IU(pb).Name}catch(Ea){}return this.zCb(pb.Id.toString())}$Vg(pb){try{return this.IU(pb).BlankCellResourceId}catch(Ea){}return null}lbi(pb){try{return this.IU(pb).HasBlankCellWalkthrough}catch(Ea){}return!1}Aaf(pb){try{const Ea=
fc.N2a(pb);if(this.HU.lb(Ea))return this.HU.oa(Ea).HasCuratedData}catch(Ea){}return!1}sPj(pb){try{return this.IU(pb).SupportsStarterData}catch(Ea){}return!1}Pkf(pb){return 268435968===pb}rfd(){return 2===n.a(this.$).AO?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}f6b(){return new za.a(-847286761,Mb.a.Db,this.$.Hc,0,r.a.v0)}GIe(){if(this.oAb()&&!this.kqd()&&!this.xif&&fb.EwaSettings.ma(436)&&this.Aaf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
U.a.yg.iR){const xb=this.rfd();if(xb){var pb=this.f6b();if(pb){var Ea={["InputMethod"]:Mb.a.Db,CalloutName:6};Ea.Target=xb;Ea.ShouldCanvasTakeFocus=!0;this.$.Ka.Lb(pb,Ea);this.xif=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}jei(pb){pb=
this.l9c(pb);return pb?this.a$a.JUg(pb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Dhc(pb){return this.h3?this.h3.IUg(pb):!1}LPh(){return this.h3?this.h3.HQh():""}imi(){return this.h3?this.h3.dDb:!1}HUh(pb,Ea){const xb=this.Ydf(pb);if(0>xb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${pb}`);else if(pb=(pb=this.TNe(pb))?this.IU(pb):
null)Ea[m.a.GalleryButtonProps]=this.a$a.GNh(xb,pb),Ea[m.a.Alt]=this.a$a.$fd(pb)}oYf(){this.jig();this.oAb()&&this.y1d(!0);this.n4b()}Jei(pb){return pb===this.DXe?z.a.HUe:pb===this.K_e?z.a.FUe:z.a.EUe}FVe(pb){try{return this.IU(pb).ExampleEntities}catch(Ea){}return lb.a.instance.ga(1794)}MKd(){(0>this.fMa||this.Kab)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Gs||0>this.fMa||this.Kab)&&window.clearInterval(this.cfc);this.kqd()?
this.ked&&this.$.frame.rx(this.ked):this.y1d(this.oAb())}Hb(pb){return this.$.Eb+pb}O_j(){var pb=!0;const Ea=Array(this.mEb),xb=n.a(this.$)?n.a(this.$).Gm:null;if(xb){for(let bc=0;bc<Ea.length;++bc)this.nFj(bc)?Ea[bc]=!0:pb=Ea[bc]=!1;xb.zSd(["ConvertToLinkedEntityGallery"],pb);if(!pb)for(pb=0;pb<Ea.length;++pb)Ea[pb]&&xb.zSd([this.GUh(pb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}IU(pb){const Ea=fc.N2a(pb);if(this.HU.lb(Ea))return this.HU.oa(Ea);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${pb.Id} (Has String ID: ${!!pb.StringId})`);return null}GUh(pb){return"ConvertToLinkedEntityPreview"+pb.toString()}p1d(){l.a.get_instance().Ck(10,()=>{this.GIe();this.b1c&&this.Njf&&ub.c(this.zpf,this.$.la,500)})}Rec(pb,Ea){switch(pb){case "QueryLinkedEntityGalleryButtons":if(!Ea[m.a.InnerHTML]){pb=Ea[Mb.a.Ic].toString();const xb=ab.a.equals(pb,lb.a.instance.ga(1789),!0)||ab.a.equals(pb,lb.a.instance.ga(1790),!0),bc=ab.a.equals(pb,lb.a.instance.ga(1791),
!0);xb||bc||this.HUh(pb,Ea)}break;case "QueryLinkedEntityMenuGalleryButtons":Ea[m.a.InnerHTML]||(Ea[m.a.InnerHTML]=this.p9g(Ea[Mb.a.Ic]))}return Ea}Dph(pb){var Ea=this.TNe(pb);if(Ea)return Ea;if(Ea=this.l9c(pb))return Ea.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${pb}`);return null}SNe(pb){const Ea={};Ea.Id=pb;return this.IU(Ea)}l9c(pb){return this.HU.lb(pb)?this.HU.oa(pb):null}Ydf(pb){if(!pb.startsWith(fc.F9c))return-1;const Ea=parseInt(pb.substr(fc.F9c.length),
10);return isNaN(Ea)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${pb}`),-1):Ea}TNe(pb){pb=this.Ydf(pb);return 0>pb?null:this.Oua[pb]}agf(pb,Ea,xb){this.WAb&&this.HU&&this.HU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${pb})`),pb=this.$.pa.ya.Wb(),this.$.ea.Zb&&V(this.$.pa.ya,rb.b(this.aWi,Ea),xb,null,null,pb))}uVj(){this.agf("Auto-refresh on load",null,null)}yVj(){this.WAb&&this.HU&&this.HU.count&&
(this.Wza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Ho.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Wza=Bc.a.instance.create(this.S0c,this.c2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}PAc(){if(this.$.ea.Zb&&null!=this.b8a&&null!=this.isd&&null!=this.jsd&&null!=this.oud&&null!=this.rtd)if(++this.mFb,12>=this.mFb){1===this.mFb&&(this.ild=Qa.a.Qa.ue.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const pb=this.$.pa.ya.Wb();
ya.u(this.$.pa.ya,this.Uzi,this.Vzi(),this.dXi,this.cXi,null,pb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Qa.a.Qa.ue.m-this.ild} ms`),this.Kab=!0,this.MKd()}sCe(){if(this.$.isEditMode)if(null!=this.b8a)this.PAc();else{var pb=Qa.a.Qa.ue.m,Ea=[];v.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xb=>{xb.isFeatureEnabled("ExcelPowerBiPro",!1).then(bc=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${bc}]`);return this.b8a=bc}).then(()=>{Ea.push(xb.isFeatureEnabled("ExcelWolframAlpha",!1).then(bc=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${bc}]`);return this.oud=bc}))}).then(()=>{Ea.push(xb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(bc=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${bc}]`);
let zb;const Ub=[(zb=new kb.a,zb.name="IsRestrictedByLicense",zb.bool=bc,zb)];oa.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Ub);this.tmf=bc&&fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return bc}))}).then(()=>{Ea.push(xb.isFeatureEnabled("StockHistory",!1).then(bc=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${bc}]`);return this.rtd=bc}))}).then(()=>{Ea.push(xb.isFeatureEnabled("ExcelPowerBiFree",!1).then(bc=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${bc}]`);return this.isd=bc}))}).then(()=>
{Ea.push(xb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(bc=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Qa.a.Qa.ue.m-pb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${bc}]`);return this.jsd=bc}))}).then(()=>{Promise.all(Ea).then(()=>{this.PAc()})})})}}get Uzi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}Vzi(){return[this.b8a,
this.oud,this.rtd,this.isd,this.jsd,this.tmf]}WLd(){this.businessBar&&this.businessBar.pla(58)&&this.businessBar.removeEntry(58)}r$h(pb){this.cwd!==pb&&this.businessBar&&((this.cwd=pb)?Y(this.$.pa.ya,this.ZSi,null,null,null):this.WLd())}static HMh(pb,Ea,xb,bc){pb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',pb,Ea,bc);xb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
xb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',pb,xb)}static N2a(pb){return pb.StringId?pb.Id.toString()+"."+pb.StringId:pb.Id.toString()}}fc.FOe="ConvertToLinkedEntityPreview";fc.F9c="PreviewGalleryButtonIndex.";fc.t9a=0;fc.aqf=2;Object(c.a)(fc,"ConvertToLinkedEntityManager",t.a,[370,371,2,372])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/923d6de14bab29208292d1fd545e4e2a/EwaDSEsNext.le.js.map