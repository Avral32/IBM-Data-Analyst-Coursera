'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1122:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1123:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1124:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-svg-icon{height:100%;width:100%}")}},1125:function(u,D,a){function c(l,v){this.ID=l;this.type=v}function b(l,v){this.value=l;this.contextId=v}function e(l,v,t,z,r,n,w,B){this.type=l;this.startTime=null==t||void 0==t.value?new b(t,null):t;this.endTime=null==z||void 0==z.value?new b(z,null):z;null!=r&&void 0!=r.value||new b(r,null);null!=n&&void 0!=n.value||new b(n,null);this.operationType=B}function f(l){this.ID=
l}function d(){this.Pe=[];this.Xob=[];this.FYc=0;this.duration=this.startTime=null;this.t9b={};this.Wyd=this.Azd=this.c_c=-1}function h(l){var v;return(null!=document.body.style.msTransform?v=l.style.msTransform:null!=document.body.style.webkitTransform?v=l.style.webkitTransform:null!=document.body.style.mozTransform?v=l.style.Ijk:null!=document.body.style.oTransform?v=l.style.Njk:null!=document.body.style.transform&&(v=l.style.transform),v)?(v=v.replace("rotate(",""),v=v.replace("deg)",""),parseFloat(v)):
0}a.d(D,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),fkk:new b(0,null),Tik:new b(0,null),operationType:0};u=Array(1);u[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,u[0],null,0,1,1),new e(7,2,0,u[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(l,16)}}();d.prototype={Pe:null,qRg:5,Xob:null,FYc:0,startTime:null,
duration:null,t9b:null,c_c:-1,Azd:-1,Wyd:-1};d.prototype.Start=function(){this.startTime=new Date;this.t9b={}};d.prototype.GetRecentAnimationStats=function(){var l,v=[],t=0;for(l=m.FYc;l<m.qRg;l++)null!=m.Xob[l]&&(v[t]=m.Xob[l],t++);for(l=0;l<m.FYc;l++)null!=m.Xob[l]&&(v[t]=m.Xob[l],t++);return v};d.prototype.GetAnimationSqmStats=function(){var l=[];return l[0]=0>m.c_c?0:m.c_c,l[1]=0>m.Azd?0:m.Azd,l[2]=0>m.Wyd?0:m.Wyd,l};var m=new d},1126:function(u,D,a){a.d(D,"a",function(){return h});u=a(0);D=a(38);
var c=a(213),b=a(359),e=a(186),f=a(42),d=a(537);class h extends D.a{constructor(m){super();this.qT=[];this.sf=(v,t)=>{var z,r=t.jd.block;v=!1;if(r.Pk&&r.state&1&&(z=this.view.Af(t.jd.block.oe.BlockCachePosition.PaneType).MG(t.jd.hash))){r=this.zJd(r.je);if(z=z.pf)for(let n=this.qT.length-1;0<=n;n--)z.contains(this.qT[n].bottomRight)&&(this.qT.splice(n,1),v=!0);if(r)for(let n=0,w=r.length;n<w;n++)this.rangeList.push(e.a.LQ(r[n])),v=!0;v&&(t=this.view.urc(t.jd.block.oe.BlockCachePosition.PaneType).MG(t.jd.hash),
this.raiseEvent(h.AJd,new d.a(t)))}};this.an=()=>{this.DJb()};this.Mo=()=>{this.qT=[]};this.tne=m;var l=m.Ea;l.mt(this.sf);l.mha(this.sf);l.U_b(this.sf);l.jH(this.an);m.$.xa.KJ(this.Mo);m.$.Cb.KJ(this.Mo);for(const v of m.Nn)for(let t of v)for(let z of t)l=m.Ea.Dl(z.hashCode),this.sf(this,new b.a(new c.a(l,z.hashCode),null))}get rangeList(){return this.qT}get view(){return this.tne}dispose(){this.view&&(this.view.Ea.gr(this.sf),this.view.Ea.HI(this.an),this.view.Ea.zcb(this.sf),this.view.Ea.YJb(this.sf),
this.view.$.xa.sL(this.Mo),this.view.$.Cb.sL(this.Mo));this.qT=this.tne=null;super.dispose()}N_b(m){m=this.zJd(m);const l=this.view.KH;if(m&&0<m.length&&l)for(let v=0,t=m.length;v<t;v++)l.contains(this.qT[v])||this.qT.push(e.a.LQ(m[v]))}DJb(){const m=this.view.KH;if(this.qT.length&&m)for(let l=this.qT.length-1;0<=l;l--)m.contains(this.qT[l])||this.qT.splice(l,1)}n6e(m){return this.F5e(m)}F5e(m){m=f.I(m,this.qT,!0);return 0<m.length?m[0]:null}}h.AJd="lrc";Object(u.a)(h,"LoadedRangeCollection",D.a,
[])},1127:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1141:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(38);class f extends e.a{constructor(na){super();na.da.Ga(376,this)}cPg(na){this.addHandler("TAF",na)}ylj(na){this.removeHandler("TAF",na)}Laj(){this.raiseEvent("TAF")}}Object(u.a)(f,"GridHighlightBehaviorEventManager",e.a,[498,2]);class d extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){this.ob(this.$.da.za(376)||new f(this.$))}static ka(na){na.da.Ga(377,new d(na))}}Object(u.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(50),m=a(37),l=a(27),v=a(78),t=a(15),z=a(239),r=a(14),n=a(156),w=a(5),B=a(113),A=a(12);class y extends Sys.EventArgs{constructor(na,ab){super();this.start=na;this.H6a=ab}}Object(u.a)(y,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var x=a(33);class F extends e.a{constructor(na){super();this.Qmc=[3];this.Mqa=void 0;this.gridView=na;this.ZCc=x.a.hR(this.gridView.$);this.BB=x.a.BB(this.gridView.$)}get coloredReferencesManager(){const na=this.gridView.$.da.za(281);na||t.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return na}get qB(){if(this.Mqa)return this.Mqa;const na=this.gridView.$.da.za(464);na||t.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
na.qB||t.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Mqa=na.qB}DNg(na){this.addHandler("mrek",na)}hx(na,ab,Gb){for(const fc of this.gridView.Nn)z.a.instance.ta(r.a.Ij,fc.domElement,na);z.a.instance.ta(r.a.Pf,document.documentElement,ab);this.gridView.fc.A9b(!0);Gb&&z.a.instance.ta(r.a.Jy,this.gridView.zj,ab)}C0d(na,ab,Gb){for(const fc of this.gridView.Nn)z.a.instance.Ba(r.a.Ij,fc.domElement,na);z.a.instance.Ba(r.a.Pf,
document.documentElement,ab);this.gridView.fc.A9b(!1);Gb&&z.a.instance.Ba(r.a.Jy,this.gridView.zj,ab)}Dfj(na,ab){for(const Gb of this.gridView.Nn)n.a.instance.ta(r.a.Yf,Gb.domElement,na);n.a.instance.ta(r.a.we,document.documentElement,ab)}LXj(na,ab){for(const Gb of this.gridView.Nn)n.a.instance.Ba(r.a.Yf,Gb.domElement,na);n.a.instance.Ba(r.a.we,document.documentElement,ab)}dIe(na,ab,Gb,fc){const pb=document.createElement("div");pb.className=ab;for(const Ea of Gb)pb.classList.add(Ea);na.appendChild(pb);
z.a.instance.ta(r.a.pointerDown,pb,fc);return pb}b7e(na){na=na.Gb.parentNode;if(!na)return t.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;na=parseInt(na.getAttribute(w.a.H6a),10);return isNaN(na)?(t.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.Dv(3,1,na)}MMb(na,ab,Gb=!0){na=Gb&&(this.BB?!!this.qB&&
this.qB.dri(na):!!this.coloredReferencesManager&&this.coloredReferencesManager.cri(na));for(const fc of ab)A.DOMElementExtensions.setVisible(fc,na)}Jbc(){return this.gridView.Vl?B.a(this.gridView.$):this.gridView.Vb}TRf(){if(this.BB){var na=this.Jbc();na&&this.qB?this.ZCc?na.fC(null):this.qB.mgb(na,null):(t.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Wg(this.Qmc),this.gridView.qb.Qi(null,
this.Qmc))}else this.odj()}odj(){const na=this.Jbc();na&&this.coloredReferencesManager?this.ZCc?na.fC(null):this.coloredReferencesManager.fC(na,null):(t.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Wg(this.Qmc),this.gridView.qb.Qi(null,this.Qmc))}dQf(na,ab){this.raiseEvent("mrek",new y(na,ab))}}Object(u.a)(F,"BehaviorHelperMethods",e.a,[]);var I=a(87),L=a(40);e=a(94);
class X extends e.a{constructor(na,ab=null){super(na,ab)}$Za(){}}Object(u.a)(X,"HighlightFlyweightBehavior",e.a,[]);var P=a(19),G=a(463),C=a(76),H=a(11),J=a(117),M=a(224),S=a(45);e=a(238);var W=a(8),O=a(68),T=a(1),Y=a(34);class va extends e.a{constructor(na,ab,Gb){super(document.createElement("div"));this.c7b=null;this.lRb=!1;this.onPointerDown=fc=>{fc=Y.a(this.$)?Y.a(this.$).Vd(fc):fc;this.lRb=!1;if(3===(C.a.Db=fc.tb)){const pb=fc.Ca.rawEvent,Ea=pb.srcElement||pb.target;A.DOMElementExtensions.xf(this.domElement,
Ea)&&A.DOMElementExtensions.xf(pb.currentTarget,Ea)&&(this.lRb=!0,this.c7b=fc.clientPoint)}return!1};this.Of=fc=>{fc=Y.a(this.$)?Y.a(this.$).Vd(fc):fc;this.raiseEvent("GrPointerUp",fc);return this.lRb=!1};this.Fh=fc=>{fc=Y.a(this.$)?Y.a(this.$).Vd(fc):fc;3===fc.tb&&this.lRb&&this.Obi(fc.clientPoint)&&(this.raiseEvent("GrDrag"),this.lRb=!1);return!1};this.hd=fc=>{Y.a(this.$)&&Y.a(this.$).Vd(fc);return!0};this.$=Gb;Gb=!T.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(Gb?
O.a.jVe:O.a.iVe);this.domElement.classList.add(O.a.F$b);na.appendChild(this.domElement);A.DOMElementExtensions.setVisible(this.domElement,!1);this.WLa=document.createElement("div");this.WLa.classList.add(O.a.E$b);this.WLa.style.borderColor=ab;this.domElement.appendChild(this.WLa);z.a.instance.ta(r.a.pointerDown,this.domElement,this.onPointerDown);z.a.instance.ta(r.a.Pf,this.domElement,this.Of);n.a.instance.ta(r.a.we,this.domElement,this.Of);z.a.instance.ta(r.a.Ij,this.domElement,this.Fh);n.a.instance.ta(r.a.Yf,
this.domElement,this.Fh);M.a.instance.ta(r.a.click,this.domElement,this.hd)}Cre(na){this.addHandler("GrDrag",na)}EVf(na){this.removeHandler("GrDrag",na)}Bre(na){this.addHandler("GrContxt",na)}DVf(na){this.removeHandler("GrContxt",na)}Dre(na){this.addHandler("GrPointerUp",na)}FVf(na){this.removeHandler("GrPointerUp",na)}dispose(){S.a.xna(this.domElement);super.dispose()}Xig(na){this.domElement.parentNode.removeChild(this.domElement);na.appendChild(this.domElement)}L2f(){this.domElement.classList.remove(O.a.F$b);
this.WLa.classList.remove(O.a.E$b);this.WLa.classList.add(O.a.kVe)}khg(){this.WLa.classList.remove(O.a.kVe);this.WLa.classList.add(O.a.E$b);this.domElement.classList.add(O.a.F$b)}Obi(na){return!!this.c7b&&(3<Math.abs(na.x-this.c7b.x)||3<Math.abs(na.y-this.c7b.y))}static zwb(na){return T.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(na=Y.a(na.$)?Y.a(na.$).zoom:W.a.e0,Math.round(9/Math.max(na,1))):9}}va.Eyd=0;Object(u.a)(va,"TouchGrippie",e.a,[]);class ca extends X{constructor(na,
ab,Gb,fc){super(ab);this.Qtd=this.eZc=this.lpb=!1;this.Jqb=null;this.Xba=this.Ltd=!1;this.Xw=()=>{this.lpb&&this.Ltd?this.zoa():this.c5()};this.vDf=Ea=>{3===Ea.tb&&(this.Ltd=!0,this.zoa());return!1};this.wDf=Ea=>{if(3===Ea.tb){if(!Ea.Gb||this.Roi(Ea))return!1;this.Ltd=!1;this.c5()}return!1};this.Ag=()=>{this.Xba&&this.G0d();this.zoa();this.Qtd=!1};this.Np=()=>{this.c5();this.Qtd=!0};this.Eza=(Ea,xb)=>{xb.e5===this.e5&&(xb.visible?this.Qtd||this.zoa():this.c5())};this.iJf=()=>{this.xDf(this.eP.domElement,
!1)};this.Ozf=()=>{this.xDf(this.HM.domElement,!0)};this.ypc=(Ea,xb)=>{this.ha.pAa(xb)};this.zpc=(Ea,xb)=>{this.ha.pAa(G.b(xb))};this.mGb=()=>{3===C.a.Db?this.zoa():this.c5();this.Xba&&1===C.a.Db&&this.G0d()};this.jJf=()=>{this.Ywj()};this.JOe=()=>{this.c5()};this.Mn=()=>{this.ha.Ra.$b&&this.c5()};this.Czf=()=>{this.c5()};this.oDf=(Ea,xb)=>{this.G0d();3===xb.tb?this.zoa():this.c5()};this.ztc=()=>{this.lpb&&(this.c5(),this.zoa())};const pb=Gb.$;this.Aq=Gb;this.ha=Gb.ha;this.Cba=na;this.xuj=ab;this.paneType=
fc;na=this.domElement.currentStyle;ab="#000000";na&&(ab=na.borderTopColor);this.eP=new va(this.Ncd(),ab,pb);this.HM=new va(this.Ncd(),ab,pb);this.tkf=pb.ea.isNamedObjectViewMode&&1===pb.workbookContext.NovMode;this.eP.Cre(this.iJf);this.eP.Bre(this.ypc);this.eP.Dre(this.zpc);this.HM.Cre(this.Ozf);this.HM.Bre(this.ypc);this.HM.Dre(this.zpc);for(const Ea of this.gridView.Nn)n.a.instance.ta(r.a.Df,Ea.domElement,this.wDf),n.a.instance.ta(r.a.we,Ea.domElement,this.vDf);Gb.view.nt(this.Xw);Gb.Vb.Xk(this.JOe);
Gb.qb.Cob(this.Eza);Gb.hXc(this.Czf);pb.VA(this.ztc);Gb.mv(this.ztc);this.ha.HY(this.Ag);this.ha.Y2(this.Np);Gb.IC(this.Mn);this.ha.Z_b(this.oDf);C.a.Mre(this.mGb);m.TaskExtensions.Aa(h.GetServiceTaskFactory.Oa(pb.da,376,377,0),Ea=>{Ea.result.cPg(this.jJf)},pb.la,3)}get gridView(){return this.Aq}dispose(){I.a.qc([this.eP,this.HM]);this.eP.EVf(this.iJf);this.eP.DVf(this.ypc);this.eP.FVf(this.zpc);this.HM.EVf(this.Ozf);this.HM.DVf(this.ypc);this.HM.FVf(this.zpc);for(var na of this.gridView.Nn)n.a.instance.Ba(r.a.Df,
na.domElement,this.wDf),n.a.instance.Ba(r.a.we,na.domElement,this.vDf);this.gridView.view.ir(this.Xw);this.gridView.Vb.Fk(this.JOe);this.gridView.qb.mKb(this.Eza);this.gridView.dMd(this.Czf);this.gridView.$.bE(this.ztc);this.gridView.Oy(this.ztc);this.ha.MW(this.Ag);this.ha.A7(this.Np);this.gridView.cE(this.Mn);this.ha.Nuc(this.oDf);C.a.NVf(this.mGb);this.Xba&&t.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(na=this.gridView.$.da.za(376))&&na.ylj(this.jJf);
super.dispose()}nTa(){if(!this.Cba.range||!this.Cba.range.equals(this.Fdb))return!1;const na=!this.gridView.GNa();return this.gridView.eb&&na&&(this.Fdb.isRow||this.Fdb.hf)?!1:this.Xba?!0:3===C.a.Db}c5(){this.lpb&&(this.eP.set_visible(!1),this.HM.set_visible(!1),this.lpb=!1)}zoa(){if(this.nTa()){this.q0j();var na=A.DOMElementExtensions.getBoundingClientRect(this.Jqb);na||t.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.tkf,this.eZc,this.gridView.zj,this.gridView.ib.tj);var ab=A.DOMElementExtensions.getBoundingClientRect(this.xuj),Gb=new Sys.UI.Bounds(ab.x-na.x,ab.y-na.y,ab.width,ab.height),fc=this.Fdb,pb=fc.topLeft,Ea=fc.bottomRight,xb=fc.isRow||fc.hf;if(fc.hf){var bc=this.WHh();fc=Gb.x-2*va.zwb(this.gridView);var zb=bc;var Ub=Gb.x+ab.width}else fc.isRow?(fc=Ub=this.VHh(),zb=Gb.y-2*va.zwb(this.gridView),bc=Gb.y+ab.height):(zb=Gb.y,bc=Gb.y+ab.height,this.gridView.rtl?
(fc=Gb.x+ab.width,Ub=Gb.x):(fc=Gb.x,Ub=Gb.x+ab.width));ab=va.Eyd+(xb?0:va.zwb(this.gridView));this.eP.style.left=H.HelperMethods.uc(fc-ab);this.eP.style.top=H.HelperMethods.uc(zb-ab);this.HM.style.left=H.HelperMethods.uc(Ub-ab);this.HM.style.top=H.HelperMethods.uc(bc-ab);this.eP.set_visible(this.Rif(zb,fc,pb,xb,na));this.HM.set_visible(this.Rif(bc,Ub,Ea,xb,na));this.lpb=!0}}Rif(na,ab,Gb,fc,pb){const Ea=A.DOMElementExtensions.getBoundingClientRect(this.gridView.Af(this.paneType).domElement);pb=new Sys.UI.Bounds(Ea.x-
pb.x-3,Ea.y-pb.y-3,Ea.width+6,Ea.height+6);return(this.gridView.ib.Li(Gb)===this.paneType||fc)&&L.a.EN(pb,new Sys.UI.Point(ab,na))}q0j(){if(this.tkf!==this.eZc){this.Jqb=null;const na=this.Ncd();this.eP.Xig(na);this.HM.Xig(na)}}WHh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+va.Eyd-va.zwb(this.gridView))/2}VHh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+va.Eyd-va.zwb(this.gridView))/2}uHf(){this.zoa()}Roi(na){return A.DOMElementExtensions.eSa(na.Gb,
P.a.rp)&&(this.Vpi(na)||this.Wpi(na))}Wpi(na){if(this.gridView.rtl)na=na.clientPoint.x;else{const ab=A.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.x-(ab.x+ab.width-J.a.Ou)}return 0<na&&na<=J.a.Ou}Vpi(na){const ab=A.DOMElementExtensions.getBoundingClientRect(na.Gb);na=na.clientPoint.y-(ab.y+ab.height-J.a.Ou);return 0<na&&na<=J.a.Ou}xDf(na,ab){this.Xba&&t.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.v1c(na,ab,this.Xba);
this.c5()}Ywj(){this.Xba||(t.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Xba=!0,this.eP.L2f(),this.HM.L2f(),this.gridView.ha.sourceRange=this.gridView.ha.ra.$c,this.zoa())}G0d(){this.Xba&&(t.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Xba=!1,this.eP.khg(),this.HM.khg())}Ncd(){this.Jqb||(this.eZc=!1,this.Jqb=this.gridView.zj);return this.Jqb}}Object(u.a)(ca,"SelectionTouchGrippiesBehaviorBase",X,[]);class V extends ca{constructor(na,
ab,Gb,fc){super(na,ab,Gb,fc)}get e5(){return 19}get Fdb(){return this.gridView.ha.ra.activeRange}nTa(){const na=this.gridView.ri||this.gridView.eb;return!this.gridView.ha.ra.Mg&&!na&&super.nTa()}}Object(u.a)(V,"DiscontinuousSelectionTouchGrippiesBehavior",ca,[]);var ra=a(174);class N extends X{constructor(na){super(na);const ab=document.createElement("div");ab.className=O.a.pDh;na.appendChild(ab)}}Object(u.a)(N,"SelectionBorderBehavior",X,[]);class ea{}ea.VCh="ewr-selection-draghandle";ea.$Ch="ewr-selection-draghandle-grab";
ea.kDh="ewr-selection-draghandle-top-ie";ea.lDh="ewr-selection-draghandle-top-ie-enhanced";ea.iDh="ewr-selection-draghandle-top";ea.jDh="ewr-selection-draghandle-top-enhanced";ea.YCh="ewr-selection-draghandle-bottom-ie";ea.ZCh="ewr-selection-draghandle-bottom-ie-enhanced";ea.WCh="ewr-selection-draghandle-bottom";ea.XCh="ewr-selection-draghandle-bottom-enhanced";ea.cDh="ewr-selection-draghandle-left-ie";ea.dDh="ewr-selection-draghandle-left-ie-enhanced";ea.aDh="ewr-selection-draghandle-left";ea.bDh=
"ewr-selection-draghandle-left-enhanced";ea.gDh="ewr-selection-draghandle-right-ie";ea.hDh="ewr-selection-draghandle-right-ie-enhanced";ea.eDh="ewr-selection-draghandle-right";ea.fDh="ewr-selection-draghandle-right-enhanced";ea.rVe="ewr-selection-dragtooltip";ea.sVe="ewr-selection-dragtooltip-updated";ea.wDh="ewr_selection_rearrangeleft";ea.xDh="ewr_selection_rearrangeright";ea.yDh="ewr_selection_rearrangetop";ea.vDh="ewr_selection_rearrangebottom";ea.selecting="selecting";ea.zDh="ewr-selection-resizemarqueehandle";
ea.CDh="ewr-selection-resizemarqueehandle-topleft";ea.DDh="ewr-selection-resizemarqueehandle-topright";ea.ADh="ewr-selection-resizemarqueehandle-bottomleft";ea.BDh="ewr-selection-resizemarqueehandle-bottomright";ea.LCh="ewr-marquee-thick";ea.PCh="ewr-resizemarqueehandle-thick";Object(u.a)(ea,"CssClassNames",null,[]);var Ba=a(249),ka=a(21);class Ka extends N{constructor(na,ab,Gb,fc){super(na);this.aUa=!1;this.yoe=this.zoe=null;this.osa=0;this.Zh=T.EwaSettings.getBooleanFeatureGate(ra.a.a9b,!1);this.ooi=
T.EwaSettings.getBooleanFeatureGate(ra.a.Nph,!1);this.YEc=this.Ufc=this.gF=0;this.$w=this.hb=this.sourceRange=this.mna=null;this.Of=pb=>{pb=Y.a(this.$).Vd(pb);return this.nEd(pb)};this.onPointerDown=pb=>{pb=Y.a(this.$).Vd(pb);if(2===pb.tb&&pb.jo===Sys.UI.MouseButton.leftButton&&!this.aUa){var Ea=this.Odc(pb);if(!Ea)return t.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hb=Ea.clone();this.sourceRange=this.hb.clone();this.mna=this.hb;
if(Ea=this.RZh(pb))this.mh=5,this.YEc=Ea.top-this.sourceRange.top,this.Ufc=Ea.left-this.sourceRange.left,ka.h(this.$).Gf.gm(this.Zh?Ka.KJa:Ka.p9c),this.jqc(pb),this.aUa=!0,Ba.b(this.$,!0)}return!1};this.Fh=pb=>{pb=Y.a(this.$).Vd(pb);if(this.Zh&&this.mqc(pb))return!0;if(pb=this.ha.ko(pb.clientPoint,pb.Gb,5,void 0,void 0,!0)){pb=this.Yha(pb);if(this.hb.equals(pb))return!0;this.hb=pb;if(!this.az())return t.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.gvb(!0),!1}return!0};this.ed=(pb,Ea)=>{Ea.IN||(T.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.pBa(this.$.isEditMode&&this.woa()):this.pBa(this.$.isEditMode))};this.ns=[];this.$=ab;this.ha=ka.h(this.$).ha;this.paneType=Gb;this.xo=fc;ab=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ab=this.ooi?ab?[ea.jDh,ea.XCh,ea.bDh,ea.fDh]:[ea.lDh,ea.ZCh,ea.dDh,ea.hDh]:ab?[ea.iDh,ea.WCh,ea.aDh,ea.eDh]:[ea.kDh,ea.YCh,ea.cDh,ea.gDh];for(const pb of ab)ab=
this.xo.dIe(na,pb,this.Zh?[ea.$Ch]:[ea.VCh],this.onPointerDown),this.ns.push(ab);this.$.nl(this.ed);T.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.pBa(this.$.isEditMode)}get qb(){return ka.h(this.$).qb}get mh(){return this.ha.selectionType}set mh(na){this.ha.selectionType=na}dispose(){this.ns.forEach(na=>{z.a.instance.Ba(r.a.pointerDown,na,this.onPointerDown)});this.ns.length=0;this.mna=this.sourceRange=this.hb=null;t.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.osa}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Kl(this.ed),1===this.osa&&(t.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.wt(this.yoe,this.zoe,!1)));super.dispose()}nEd(na){if(5!==this.mh)return!1;(na=this.Cza(na))||this.gvb(!1);Ba.b(this.$,!1);return na}hx(na,ab){t.ULS.shipAssertTag(537159377,0,!this.osa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.osa+=1;this.yoe=na;this.zoe=ab;this.xo.hx(na,
ab,this.LCc())}Yha(na){if(!na||!this.hb)return t.ULS.shipAssertTag(537159376,0,!!na,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),t.ULS.shipAssertTag(537159375,0,!!this.hb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ab=this.hb.clone();1!==this.gF&&(ab.left=Math.max(na.left-this.Ufc,1),ab.right=ab.left+this.sourceRange.width-1);2!==this.gF&&(ab.top=Math.max(na.top-this.YEc,1),ab.bottom=ab.top+this.sourceRange.height-1);return this.a_a(ab)}wt(na,
ab,Gb=!0,fc=!0){t.ULS.shipAssertTag(537159374,0,1===this.osa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.osa;this.Zh||ka.h(this.$).Gf.gm(w.a.TQ);this.xo.C0d(na,ab,this.LCc());Gb&&this.v2c(fc);this.gF=0;this.aUa=!1}a_a(na){var ab=ka.h(this.$);let Gb=na;if(ab.ib.Y4){if(!ab.Sb(na.topLeft)){ab=ab.fk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ab.KH,this.mna.top!==na.top?1:2);try{ab.Rk=this.mna.top<na.top||this.mna.left<na.left,ab.Hs(na.topLeft),
Gb=ab.$$cu().range}finally{ab&&ab.dispose()}}Gb.right=Gb.left+na.width-1;Gb.bottom=Gb.top+na.height-1}return this.mna=Gb}pBa(na){this.ns.forEach(ab=>{A.DOMElementExtensions.setVisible(ab,na)})}RZh(na){const ab=na.Gb;na=na.clientPoint;if(!ab||!na)return t.ULS.shipAssertTag(537159373,0,!!ab,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),t.ULS.shipAssertTag(537159372,0,!!na,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;na.y+=ab===this.ns[Ka.JJa]?
2:ab===this.ns[Ka.s9c]?-2:0;na.x+=ab===this.ns[Ka.t9c]?2:ab===this.ns[Ka.IJa]?-2:0;return this.ha.ko(na,ab,5,void 0,void 0,!0)}}Ka.p9c="move";Ka.L1a="copy";Ka.KJa="grabbing";Ka.JJa=0;Ka.s9c=1;Ka.t9c=2;Ka.IJa=3;Object(u.a)(Ka,"DragSelectionClickBehaviorBase",N,[]);class Oa extends Ka{constructor(na,ab,Gb,fc,pb,Ea){super(na,ab,Gb,pb);this.Za=this.rG=null;this.E$e=()=>{this.gvb(!0)};T.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.pBa(this.woa()&&this.$.isEditMode);
this.gridView=ka.h(this.$);this.ZF=fc;this.coloredReferencesManager=this.$.da.za(281);t.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.BB=x.a.BB(this.$))na=this.$.da.za(464),t.ULS.shipAssertTag(512312961,0,!!na,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.qB=na.qB;
for(const xb of this.ns)z.a.instance.ta(r.a.sW,xb,this.ZF.Wcf),z.a.instance.ta(r.a.Jy,xb,this.ZF.Xcf);this.$Za(Ea)}$Za(na){this.xo.MMb(na,this.ns);this.ZF.QAa()}jqc(na){t.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.JMa=!0;this.Za.XE(!1);this.mh=5;this.ZF.mOe(na.Gb);this.Za.textBox.removeSelection();this.Za.j0b(this.E$e);this.hx(this.Fh,this.Of);this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0}Cza(){const na=
this.uG();this.mh=-1;this.wt(this.Fh,this.Of);return na}v2c(){this.gridView.JMa=!1;this.ZF.nOe(this.ns[0]);this.Za.textBox.setCaretPositionToEnd();this.Za.Yuc(this.E$e);this.xo.TRf()}gvb(na){t.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");na&&this.wt(this.Fh,this.Of)}Odc(na){this.Za=this.xo.Jbc();this.rG=this.xo.b7e(na);return this.Za&&this.rG&&this.rG.range?this.rG.range:(t.ULS.shipAssertTag(537159388,
0,!!this.Za,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),t.ULS.shipAssertTag(537159387,0,!!this.rG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),t.ULS.shipAssertTag(537159386,0,!!this.rG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}uG(){return this.rG?this.BB?this.qB.KEb(this.Za,this.rG,this.hb):this.coloredReferencesManager.KEb(this.Za,this.rG,this.hb):(t.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}az(){return this.uG()}LCc(){return!0}mqc(){return!1}woa(){return!0}}Object(u.a)(Oa,"DragMarqueeClickBehavior",Ka,[]);var wa=a(85),qa=a(107),aa=a(170),ia=a(416),Ha=a(13),Z=a(225),la=a(24),Xa=a(761),Za=a(42),xa=a(188),fa=a(706),ua=a(116),sa=a(29),sb=a(281),hb=a(60);const bb=(na,ab,Gb,fc,pb,Ea,xb,bc=null)=>{bc=na.Na(41,bc);bc.sourceRange=ab;bc.destinationRange=Gb;return hb.g(na,"RearrangeRowColumn",bc,fc,pb,Ea,xb,0)},lb=(na,ab,Gb,fc,pb,Ea,xb=null)=>{xb=na.Na(1,xb);xb.moveRange=ab;return hb.g(na,
"MoveLineItems",xb,Gb,fc,pb,Ea,0)};class Fa{constructor(na,ab){this.destinationRange=this.sourceRange=null;this.sourceRange=na;this.destinationRange=ab}}Object(u.a)(Fa,"MacroRecorderTableRowColumnRearrangedPayload",null,[125]);var Na=a(44);class Mb extends Ka{constructor(na,ab,Gb,fc,pb){super(na,ab,Gb,pb);this.Via=Ha.a.instance.ga(2259);this.$tb=Ha.a.instance.ga(2260);this.toa=Ha.a.instance.ga(2261);this.iNb=Ha.a.instance.ga(2262);this.kA=this.Nh=null;this.Yq=this.hf=this.isRow=this.Zq=!1;this.XI=
this.AH=null;this.co=this.wCb=0;this.onKeyDown=Ea=>{if(this.Zh){if(this.o5(Ea)||Ea.Ca.keyCode===wa.a.jfa)return this.x5||(qa.KeyInputManager.instance.ta(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!0),!this.Eu&&this.o5(Ea)&&(ka.h(this.$).Gf.gm(Mb.L1a),this.Eu=!0),this.Fu||Ea.Ca.keyCode!==wa.a.jfa||(ka.h(this.$).Gf.gm(Ka.KJa),this.Fu=!0,2===this.co?(this.Ox(!1),this.gF=0,this.Nh=this.Yq?[11]:[12],this.Zq=this.Yq,this.jRa(),this.jJ()):3===this.co?(this.y3(!1),this.gF=this.isRow?
1:2,this.tO(),this.az()):1===this.co&&(this.fia(!1),this.tO(),this.az())),!0}else if(!this.Eu&&(Ea.Ca.keyCode===wa.a.G8||l.a.isMac&&Ea.Ca.keyCode===wa.a.wpa))return qa.KeyInputManager.instance.ta(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),ka.h(this.$).Gf.gm(Mb.L1a),this.Eu=!0;return!1};this.onKeyUp=Ea=>{if(this.Zh){if(this.o5(Ea)||Ea.Ca.keyCode===wa.a.jfa)return this.wCb=this.o5(Ea)?0:1,this.Ep&&ka.h(this.$).Gf.gm(Ka.KJa),Ea.Ca.keyCode===wa.a.jfa&&(2===this.co?(this.y3(!1),this.gF=0,
this.tO(!0),this.az(!0)):3===this.co?(this.Ox(!1),this.gF=this.isRow?1:2,this.Nh=this.isRow?[11]:[12],this.jRa(!0),this.jJ(!0)):1===this.co&&(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.CAa(!0),this.jJ(!0))),this.opa(this.wCb),!0}else if(Ea.Ca.keyCode===wa.a.G8||l.a.isMac&&Ea.Ca.keyCode===wa.a.wpa)return this.opa(),this.Ep&&ka.h(this.$).Gf.gm(Ka.p9c),!0;return!1};this.hL=Ea=>{Ea=Y.a(this.$).Vd(Ea);5===this.mh?this.nEd(Ea):(this.Ep=!1,this.qb.Wg(this.Nh),!this.$.Zp([this.hb],!1)||this.iKd()||this.fBb()||
(this.ha.sourceRange=this.sourceRange.clone(),this.Zh?this.EId():this.$ub(),this.xy()?this.hb.top>this.sourceRange.top&&(Ea=this.hb.height,this.hb.top-=Ea,this.hb.bottom-=Ea):this.hb.left>this.sourceRange.left&&(Ea=this.hb.width,this.hb.left-=Ea,this.hb.right-=Ea),this.uG()));this.wt(this.gL,this.hL);this.tableRange=null;this.mh=-1;this.Zh&&(this.kA=null,this.co=0);return!0};this.V6=()=>{this.Ep=!1;this.co=0;this.qb.Wg(this.Nh);if(!this.$.Zp([this.hb],!1))return this.wt(this.U6,this.V6),this.mh=-1,
!0;if(!(this.ha.ra.$c.equals(this.hb)||this.Qba(this.hb)||this.Qba(this.sourceRange)||this.fBb()||(this.uG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.b9b]:!0,[w.a.d9b]:this.Zq,[w.a.LU]:this.ha.sourceRange,[w.a.KU]:this.ha.ra.$c,[w.a.HJa]:this.Fu}),this.Eu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Zq)){var Ea=this.hb.height;this.hb.top-=Ea;this.hb.bottom-=Ea}else this.hb.left>this.sourceRange.left&&
(this.hf||this.hb.top===this.sourceRange.top&&!this.Zq)&&(Ea=this.hb.width,this.hb.left-=Ea,this.hb.right-=Ea);this.uG()}this.wt(this.U6,this.V6);this.kA=this.tableRange=null;this.mh=-1;this.Zq=!1;return!0};this.gL=Ea=>{var xb=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");xb&&(Ea=Y.a(this.$).Vd(Ea));var bc=Ea.clientPoint;xb||(Ea=Y.a(this.$).Vd(Ea));this.Zh&&(this.$w=Ea);if(Ea=this.ha.ko(bc,Ea.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Ea.topLeft)){xb=
ka.h(this.$);const Ub=xb.ag(Ea);var zb=xb.Af(this.paneType);bc=fa.a.Vs(zb.view.ei,this.domElement.parentNode,bc,xb.rtl);zb=!1;let wc=2;this.xy()&&bc.y-Ub.topLeft.y>Ub.height/2?(zb=!0,wc=1):!this.xy()&&bc.x-Ub.topLeft.x>Ub.width/2&&(zb=!0);if(zb){xb=xb.fk("DragSelectionClickBehavior.OnPointerMoveRearrange",xb.KH,wc);try{xb.Hs(Ea),xb.$$mn(),Ea=xb.$$cu().range}finally{xb&&xb.dispose()}}this.hb=this.q3(Ea);this.ha.sourceRange=this.hb;this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.qb.Wg(this.sB());
if(6!==this.mh){for(Ea=1;4>=Ea;Ea++)xb=this.Og[Ea.toString()],xb.parentNode.removeChild(xb),this.qb.Dv(this.xy()?11:12,Ea).wf.appendChild(xb);this.mh=6}}else if(this.hb=this.Yha(Ea),this.Zh)this.cyb(!1);else if(this.qb.Qi(this.hb,this.sB()),this.qb.Tn(this.sB()),this.qb.Wg(this.Nh),5!==this.mh){for(Ea=1;4>=Ea;Ea++)xb=this.Og[Ea.toString()],xb.parentNode.removeChild(xb),this.qb.Dv(this.iba(),Ea).wf.appendChild(xb);this.mh=5}this.Wy()}return!0};this.U6=Ea=>{var xb=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
xb&&(Ea=Y.a(this.$).Vd(Ea));var bc=Ea.clientPoint;xb||(Ea=Y.a(this.$).Vd(Ea));this.$w=Ea;if(xb=this.ha.ko(bc,Ea.Gb,5,void 0,void 0,!0)){if(this.ryb(xb))return this.hb=this.Yha(xb),this.byb(!1),!0;var zb=ka.h(this.$),Ub=zb.ag(xb),wc=zb.Af(this.paneType);bc=fa.a.Vs(wc.view.ei,this.domElement.parentNode,bc,zb.rtl);wc=!1;let mb=2;this.Zq=!1;if(this.isRow||this.hf){this.isRow&&bc.y-Ub.topLeft.y>Ub.height/2?(wc=!0,mb=1):this.hf&&bc.x-Ub.topLeft.x>Ub.width/2&&(wc=!0);if(wc){Ea=zb.fk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
zb.KH,mb);try{Ea.Hs(xb),Ea.$$mn(),xb=Ea.$$cu().range}finally{Ea&&Ea.dispose()}}this.hb=this.Yha(xb)}else{bc.x-Ub.topLeft.x===Ub.width?(this.Zq=!1,wc=!0):bc.y-Ub.topLeft.y>Ub.height/2&&(this.Zq=wc=!0,mb=1);this.kA&&(this.Zq=this.Yq);if(wc){zb=zb.fk("DragSelectionClickBehavior.OnPointerMoveDragInsert",zb.KH,mb);try{zb.Hs(xb),zb.$$mn(),xb=zb.$$cu().range}finally{zb&&zb.dispose()}}this.qb.Wg(this.Nh);this.Nh=this.Zq?[11]:[12];for(zb=1;4>=zb;zb++)(Ub=this.Og[zb.toString()])&&Ub.parentNode.removeChild(Ub),
this.Og[zb.toString()]=null;this.hA(Ea.clientPoint,Ea.Gb,this.Zq?11:12,!0);this.hb=this.q3(xb)}this.ha.sourceRange=this.hb;this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.qb.Wg(this.sB());if(6!==this.mh){for(Ea=1;4>=Ea;Ea++)xb=this.Og[Ea.toString()],xb.parentNode.removeChild(xb),this.qb.Dv(this.isRow||this.Zq?11:12,Ea).wf.appendChild(xb);this.mh=6}this.Wy()}return!0};this.Ag=()=>{this.domElement.classList.remove(ea.selecting)};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=
()=>{if(this.$.isEditMode){const Ea=this.woa();this.pBa(Ea)}};this.Qma=()=>{this.Zh?this.Ep&&5<=this.mh&&(this.tableRange?this.Fu?this.Ox(!0):this.fia(!0):this.Fu?this.isRow||this.hf?this.Ox(!0):this.y3(!0):this.isRow||this.hf?this.y3(!0):this.Ox(!0)):this.Ep&&5<=this.mh&&(this.tableRange?(this.qb.Wg(this.Nh),this.wt(this.gL,this.hL)):(this.qb.Wg(this.sB()),this.wt(this.Fh,this.Of)))};this.tableManager=fc;T.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.pBa(this.woa()&&
this.$.isEditMode);this.tableRange=null;this.Og={};this.x5=this.Fu=this.Eu=this.Ep=!1;this.ha.Y2(this.Np);this.ha.HY(this.Ag);this.ha.z0b(this.Qma);this.ha.QE(this.Pc);this.Zgb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.A7(this.Np),this.ha.MW(this.Ag),this.ha.lKb(this.Qma),this.ha.JI(this.Pc));if(this.Og)for(let na=1;4>=na;na++)A.DOMElementExtensions.tf(this.Og[na.toString()]);this.Og=this.Nh=null;this.Eu&&this.opa();this.Zh&&this.Fu&&this.opa(1);
super.dispose()}jqc(na){this.Zh&&(this.$w=na,this.kA=null,this.Yq=this.isRow=this.hf=this.Zq=!1,qa.KeyInputManager.instance.ta(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown));this.Ep=!0;this.tableRange=this.P0c(this.tableManager.Dn(this.sourceRange.topLeft));ka.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.kA=this.tableRange,this.co=1,this.Nh=(this.Yq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:
[12],this.mh=6,this.hx(this.gL,this.hL),this.AH=this.Via,this.XI=this.toa,this.hA(na.clientPoint,na.Gb,this.Yq?11:12,!0,!0),this.jJ(!0)):(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.mh=6,this.hx(this.gL,this.hL),this.hA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.co=3,this.gF=this.isRow?1:2,this.mh=
6,this.Nh=this.isRow?[11]:[12],this.hx(this.U6,this.V6),this.AH=this.Via,this.XI=this.toa,this.hA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!0),this.jJ(!0)):(this.co=2,this.gF=0,this.hx(this.Fh,this.Of),this.AH=this.$tb,this.XI=this.iNb,this.hA(na.clientPoint,na.Gb,this.iba(),!1,!0),this.az(!0))):(this.hx(this.Fh,this.Of),qa.KeyInputManager.instance.ta(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.hA(na.clientPoint,na.Gb,this.iba(),
!1),this.az()))}Cza(){this.Ep=!1;this.Zh&&(this.co=0);this.qb.Wg(this.sB());if(!this.$.Zp([this.hb],!1))return this.wt(this.Fh,this.Of),this.mh=-1,!0;if(this.ha.ra.$c.equals(this.hb)||this.Qba(this.hb)||this.Qba(this.sourceRange))this.mh=-1;else{this.uG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,ab=this.ha.ra.$c;this.Zh?this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.LU]:na,[w.a.KU]:ab,[w.a.HJa]:this.Fu}):this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.LU]:na,
[w.a.KU]:ab})}!this.Zh&&this.tableRange||this.wt(this.Fh,this.Of);return!0}v2c(na){na&&(qa.KeyInputManager.instance.Ba(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown),this.Zh&&ka.h(this.$).Gf.gm(w.a.TQ),this.Ep=!1);for(na=1;4>=na;na++){const ab=this.Og[na.toString()];ab&&ab.parentNode.removeChild(ab);this.Og[na.toString()]=null}this.Nh=null}mqc(na){const ab=this.ha.ko(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.$w=na;return this.ryb(ab)?(this.hb=this.q3(ab),this.byb(!0),!0):this.vld(ab)?
(this.hb=this.Yha(ab),this.cyb(!0),!0):!1}ryb(na){return!!this.kA&&1!==this.co&&!!na&&this.kA.contains(na.topLeft)}vld(na){return!!this.kA&&1===this.co&&!!na&&!this.kA.contains(na.topLeft)}byb(na){this.tableRange=this.kA;this.co=1;const ab=!this.Fu;na?(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.CAa(ab),this.jJ(ab)):(this.y3(!1),this.tO(ab),this.az(ab))}cyb(na){this.tableRange=null;this.co=2;const ab=!this.Fu;na?(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.Zq=this.Yq,this.jRa(ab),this.jJ(ab)):(this.fia(!1),
this.tO(ab),this.az(ab))}Odc(){return this.ha.ra.$c}uG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}az(na=!1){this.qb.Qi(this.hb,this.sB());this.qb.Tn(this.sB());this.Wy(na);return!0}jJ(na=!1){this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.Wy(na)}gvb(){t.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}LCc(){return!1}woa(){if(!ka.h(this.$).ha.ra.Mg)return!1;const na=ka.h(this.$).getRangeInformation(this.ha.ra.$c);
for(const ab of na)if(Object(ia.a)(Z.PivotTableRange,ab))return!1;return!0}P0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.zba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const ab=new la.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!ab.equals(na))return this.sourceRange=ab,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Zh?this.Yq=na.left===this.sourceRange.left&&
na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.xy())return na}return null}q3(na){const ab=na.clone();this.xy()?ab.left=Math.max(na.left-this.Ufc,1):ab.top=Math.max(na.top-this.YEc,1);ab.right=ab.left+this.sourceRange.width-1;ab.bottom=ab.top+this.sourceRange.height-1;return this.a_a(ab)}fBb(){const na=this.hb.topLeft.Ad(this.sourceRange);return na||this.Zh&&
!this.tableRange?na:this.xy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}iKd(){if(this.xy()&&this.hb.left!==this.tableRange.left||!this.xy()&&this.hb.top!==this.tableRange.top){const na=sa.a.Zc(1,1,0,913,0,2065438552,"RearrangeInvalidDest");Na.a(this.$).Rr([na]);return!0}return!1}EId(){const na=this.$.Jb.Ac("UserAction","RearrangeRowColumnClientSide"),ab={["CopyPasteTargetType"]:1,["OperationId"]:aa.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Fu,
["EncounteredDeploymentErrors"]:!1},Gb=this.Eu?2:1,fc=this.$.da.za(254);(new Promise((pb,Ea)=>{this.$ub(xb=>{xb.Errors&&0<xb.Errors.length?Ea(new Xa.a(22,xb.Errors)):pb(!0)},xb=>{xb=ua.a.Oe(xb.data);Ea(new Xa.a(22,xb))})})).then(()=>{t.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');fc&&fc.Nrf(ab,Gb,this.sourceRange,this.hb);return Promise.resolve(!0)},pb=>{t.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${pb?
copyPasteInfra.getStringifiedError(pb):"null"}, copyPasteTargetType="${1}"`);return fc?fc.BGf(pb,ab,Gb,this.sourceRange,this.hb):Promise.reject(pb)})}$ub(na=null,ab=null){const Gb={};this.xy()?(Gb.FirstRow=this.hb.top-1,Gb.FirstColumn=0,Gb.DeltaColumn=0,Gb.DeltaRow=this.hb.bottom-this.hb.top+1):(Gb.FirstRow=0,Gb.FirstColumn=this.hb.left-1,Gb.DeltaColumn=this.hb.right-this.hb.left+1,Gb.DeltaRow=0);Gb.LastRow=W.a.Pz;Gb.LastColumn=W.a.Rw;Gb.SheetName=this.$.xa.na?this.$.xa.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;
const fc=Za.v(this.sourceRange,this.$);this.$.userOperationManager.Kc(new xa.a(514,0,(pb,Ea,xb)=>bb(this.$.pa.ya,fc,Gb,na?sb.b(pb,na):pb,ab?sb.a(Ea,ab):Ea,xb,null),64,()=>new Fa(fc,Gb)),null)}Qba(na){na=ka.h(this.$).getRangeInformation(na);for(let ab=0,Gb=na.length;ab<Gb;++ab)if(Object(ia.a)(Z.PivotTableRange,na[ab]))return na=sa.a.Zc(1,0,0,900,0,2105176604,"InsDelCellsPivotTable"),Na.a(this.$).Rr([na]),!0;return!1}hA(na,ab,Gb,fc,pb=!1){var Ea=A.DOMElementExtensions.getBoundingClientRect(ab);let xb=
ab===this.ns[Ka.JJa]||ab===this.ns[Ka.s9c];if(this.Zh){var bc=ab===this.ns[Ka.t9c]||ab===this.ns[Ka.IJa];this.isRow&&bc||this.hf&&xb?bc="100px":(xb=this.isRow||xb,bc=(xb?pb?Mb.YZd:Mb.d_d:pb?Mb.XZd:Mb.a_d)+"px");ab=xb?ab===this.ns[Ka.JJa]?"top":"bottom":ab===this.ns[Ka.IJa]?"right":"left";na=100*(xb?na.x-Ea.x:na.y-Ea.y)/(xb?Ea.width:Ea.height);for(Ea=1;4>=Ea;Ea++){fc=document.createElement("div");var zb=document.createElement("div");const Ub=document.createElement("div");fc.appendChild(zb);fc.appendChild(Ub);
pb&&(zb=document.createElement("div"),fc.appendChild(zb),Ub.style.fontWeight="bold");fc.className=ea.sVe;this.Og[Ea.toString()]=fc;this.qb.Dv(Gb,Ea).wf.appendChild(fc);fc=this.Og[Ea.toString()];fc.style[ab]=bc;fc.style[xb?"left":"top"]=na+"%"}}else for(pb=(xb?-Mb.c_d:-Mb.$Zd)+"px",bc=xb?ab===this.ns[Ka.JJa]?"top":"bottom":ab===this.ns[Ka.IJa]||fc?"right":"left",ab=100*(xb?fc?0:na.x-Ea.x:na.y-Ea.y)/(xb?Ea.width:Ea.height),na=1;4>=na;na++)Ea=document.createElement("div"),Ea.className=ea.rVe,this.Og[na.toString()]=
Ea,this.qb.Dv(Gb,na).wf.appendChild(Ea),Ea=this.Og[na.toString()],Ea.style[bc]=pb,Ea.style[xb?"left":"top"]=ab+"%"}Wy(na=!1){const ab=this.hb.toString();if(this.Zh)for(var Gb=1;4>=Gb;Gb++)if(this.Zgb){const fc=this.Og[Gb.toString()];fc&&fc.childNodes&&0<fc.childNodes.length&&(fc.childNodes[0].innerText=ab,fc.childNodes[1].innerText=this.AH,na&&(fc.childNodes[2].innerText=this.XI))}else this.Og[Gb.toString()].childNodes[0].innerText=ab,this.Og[Gb.toString()].childNodes[1].innerText=this.AH,na&&(this.Og[Gb.toString()].childNodes[2].innerText=
this.XI);else for(na=1;4>=na;na++)if(this.Zgb){if(Gb=this.Og[na.toString()])Gb.innerText=ab}else this.Og[na.toString()].innerText=ab}opa(na=0){0===na?this.Eu=!1:1===na&&(this.Fu=!1);this.Zh&&(this.Eu||this.Fu)||(qa.KeyInputManager.instance.Ba(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!1)}Ox(na){this.qb.Wg(this.sB());this.wt(this.Fh,this.Of,void 0,na)}y3(na){this.qb.Wg(this.Nh);this.wt(this.U6,this.V6,void 0,na)}fia(na){this.qb.Wg(this.Nh);this.wt(this.gL,this.hL,void 0,na)}tO(na=
!1){this.mh=5;this.hx(this.Fh,this.Of);this.AH=this.$tb;this.XI=this.iNb;this.hA(this.$w.clientPoint,this.$w.Gb,this.iba(),!1,na)}jRa(na=!1){this.mh=6;this.hx(this.U6,this.V6);this.AH=this.Via;this.XI=this.toa;this.hA(this.$w.clientPoint,this.$w.Gb,this.isRow||this.Yq?11:12,!0,na)}CAa(na=!1){this.mh=6;this.hx(this.gL,this.hL);this.AH=this.Via;this.XI=this.toa;this.hA(this.$w.clientPoint,this.$w.Gb,this.xy()?11:12,!0,na)}o5(na){return na.Ca.keyCode===wa.a.G8||l.a.isMac&&na.Ca.keyCode===wa.a.wpa}xy(){return!this.Zh&&
this.isRow||this.Zh&&this.Yq}iba(){return this.Zh?48:6}sB(){return this.Zh?Mb.r9c:Mb.u9c}}Mb.$Zd=50;Mb.c_d=25;Mb.a_d=-85;Mb.d_d=-40;Mb.XZd=-120;Mb.YZd=-50;Mb.L1a="copy";Mb.u9c=[6];Mb.r9c=[48];Object(u.a)(Mb,"DragSelectionClickBehavior",Ka,[]);var dc=a(83);class Cb extends Ka{constructor(na,ab,Gb,fc,pb){super(na,ab,Gb,pb);this.Nh=null;this.hf=this.isRow=!1;this.Ag=()=>{this.domElement.classList.remove(ea.selecting)};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.Pc=()=>{if(this.$.isEditMode){const Ea=
this.woa();this.pBa(Ea)}};this.tableManager=fc;T.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.pBa(this.woa()&&this.$.isEditMode);this.Og={};this.Ep=!1;this.ha.Y2(this.Np);this.ha.HY(this.Ag);this.ha.QE(this.Pc);this.Zgb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.A7(this.Np),this.ha.MW(this.Ag),this.ha.JI(this.Pc),T.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.lKb(this.Qma));
if(this.Og)for(let na=1;4>=na;na++)A.DOMElementExtensions.tf(this.Og[na.toString()]);this.Og=this.Nh=null;super.dispose()}v2c(na){na&&(this.Zh&&ka.h(this.$).Gf.gm(w.a.TQ),qa.KeyInputManager.instance.Ba(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown),this.Ep=!1);for(na=1;4>=na;na++){const ab=this.Og[na.toString()];ab&&ab.parentNode.removeChild(ab);this.Og[na.toString()]=null}this.Nh=null}Odc(){return this.ha.ra.$c}uG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}az(na=!1){this.qb.Qi(this.hb,
this.sB());this.qb.Tn(this.sB());this.Wy(na);return!0}jJ(na=!1){this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.Wy(na)}gvb(){t.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}LCc(){return!1}hA(na,ab,Gb,fc,pb=!1){var Ea=A.DOMElementExtensions.getBoundingClientRect(ab);let xb=ab===this.ns[Ka.JJa]||ab===this.ns[Ka.s9c];if(this.Zh){var bc=ab===this.ns[Ka.t9c]||ab===this.ns[Ka.IJa];this.isRow&&bc||this.hf&&
xb?bc="100px":(xb=this.isRow||xb,bc=(xb?pb?Cb.YZd:Cb.d_d:pb?Cb.XZd:Cb.a_d)+"px");ab=xb?ab===this.ns[Ka.JJa]?"top":"bottom":ab===this.ns[Ka.IJa]?"right":"left";na=100*(xb?na.x-Ea.x:na.y-Ea.y)/(xb?Ea.width:Ea.height);for(Ea=1;4>=Ea;Ea++){fc=document.createElement("div");var zb=document.createElement("div");const Ub=document.createElement("div");fc.appendChild(zb);fc.appendChild(Ub);pb&&(zb=document.createElement("div"),fc.appendChild(zb),Ub.style.fontWeight="bold");fc.className=ea.sVe;this.Og[Ea.toString()]=
fc;this.qb.Dv(Gb,Ea).wf.appendChild(fc);fc=this.Og[Ea.toString()];fc.style[ab]=bc;fc.style[xb?"left":"top"]=na+"%"}}else for(pb=(xb?-Cb.c_d:-Cb.$Zd)+"px",bc=xb?ab===this.ns[Ka.JJa]?"top":"bottom":ab===this.ns[Ka.IJa]||fc?"right":"left",ab=100*(xb?fc?0:na.x-Ea.x:na.y-Ea.y)/(xb?Ea.width:Ea.height),na=1;4>=na;na++)Ea=document.createElement("div"),Ea.className=ea.rVe,this.Og[na.toString()]=Ea,this.qb.Dv(Gb,na).wf.appendChild(Ea),Ea=this.Og[na.toString()],Ea.style[bc]=pb,Ea.style[xb?"left":"top"]=ab+"%"}Qig(na,
ab,Gb){const fc=ka.h(this.$),pb=fc.ag(na);var Ea=fc.Af(this.paneType);Gb=fa.a.Vs(Ea.view.ei,this.domElement.parentNode,Gb,fc.rtl);Ea=!1;let xb=2;ab&&Gb.y-pb.topLeft.y>pb.height/2?(Ea=!0,xb=1):!ab&&Gb.x-pb.topLeft.x>pb.width/2&&(Ea=!0);if(Ea){ab=fc.fk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",fc.KH,xb);try{ab.Hs(na),ab.$$mn(),ab.$$cu()}finally{ab&&ab.dispose()}}}fia(na){this.qb.Wg(this.Nh);this.wt(this.gL,this.hL,void 0,na)}Ox(na){this.qb.Wg(this.sB());this.wt(this.Fh,this.Of,
void 0,na)}iba(){return this.Zh?48:6}sB(){return this.Zh?Cb.r9c:Cb.u9c}o5(na){return na.Ca.keyCode===wa.a.G8||l.a.isMac&&na.Ca.keyCode===wa.a.wpa}Qba(na){na=ka.h(this.$).getRangeInformation(na);for(let ab=0,Gb=na.length;ab<Gb;++ab)if(Object(ia.a)(Z.PivotTableRange,na[ab]))return na=sa.a.Zc(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),Na.a(this.$).Rr([na]),!0;return!1}}Cb.$Zd=50;Cb.c_d=25;Cb.a_d=-85;Cb.d_d=-40;Cb.XZd=-120;Cb.YZd=-50;Cb.u9c=[6];Cb.r9c=[48];Object(u.a)(Cb,"DragSelectionClickBehaviorTemporary",
Ka,[]);class Tb extends Cb{constructor(na,ab,Gb,fc,pb){super(na,ab,Gb,fc,pb);this.kA=null;this.Yq=this.Zq=!1;this.wCb=0;this.XI=this.AH=null;this.co=0;this.Via=Ha.a.instance.ga(2259);this.$tb=Ha.a.instance.ga(2260);this.toa=Ha.a.instance.ga(2261);this.iNb=Ha.a.instance.ga(2262);this.onKeyDown=Ea=>{if(this.Zh){if(this.o5(Ea)||Ea.Ca.keyCode===wa.a.jfa)return this.x5||(qa.KeyInputManager.instance.ta(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!0),!this.Eu&&this.o5(Ea)&&(ka.h(this.$).Gf.gm(Ka.L1a),
this.Eu=!0),this.Fu||Ea.Ca.keyCode!==wa.a.jfa||(ka.h(this.$).Gf.gm(Ka.KJa),this.Fu=!0,2===this.co?(this.Ox(!1),this.gF=0,this.Nh=this.Yq?[11]:[12],this.Zq=this.Yq,this.jRa(),this.jJ()):3===this.co?(this.y3(!1),this.gF=this.isRow?1:2,this.tO(),this.az()):1===this.co&&(this.fia(!1),this.tO(),this.az())),!0}else if(!this.Eu&&(Ea.Ca.keyCode===wa.a.G8||l.a.isMac&&Ea.Ca.keyCode===wa.a.wpa))return qa.KeyInputManager.instance.ta(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),ka.h(this.$).Gf.gm(Ka.L1a),
this.Eu=!0;return!1};this.onKeyUp=Ea=>{if(this.Zh){if(this.o5(Ea)||Ea.Ca.keyCode===wa.a.jfa)return this.wCb=this.o5(Ea)?0:1,this.Ep&&ka.h(this.$).Gf.gm(Ka.KJa),Ea.Ca.keyCode===wa.a.jfa&&(2===this.co?(this.y3(!1),this.gF=0,this.tO(!0),this.az(!0)):3===this.co?(this.Ox(!1),this.gF=this.isRow?1:2,this.Nh=this.isRow?[11]:[12],this.jRa(!0),this.jJ(!0)):1===this.co&&(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.CAa(!0),this.jJ(!0))),this.opa(this.wCb),!0}else if(Ea.Ca.keyCode===wa.a.G8||l.a.isMac&&Ea.Ca.keyCode===
wa.a.wpa)return this.opa(),this.Ep&&ka.h(this.$).Gf.gm(Ka.p9c),!0;return!1};this.hL=Ea=>{Ea=Y.a(this.$).Vd(Ea);5===this.mh?this.nEd(Ea):(this.Ep=!1,this.qb.Wg(this.Nh),!this.$.Zp([this.hb],!1)||this.iKd()||this.fBb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Zh?this.EId():this.$ub(),this.xy()?this.hb.top>this.sourceRange.top&&(Ea=this.hb.height,this.hb.top-=Ea,this.hb.bottom-=Ea):this.hb.left>this.sourceRange.left&&(Ea=this.hb.width,this.hb.left-=Ea,this.hb.right-=Ea),this.uG()),this.Gwd());
this.wt(this.gL,this.hL);this.tableRange=null;this.mh=-1;this.Zh&&(this.kA=null,this.co=0);return!0};this.V6=()=>{this.Ep=!1;this.co=0;this.qb.Wg(this.Nh);if(!this.$.Zp([this.hb],!1))return this.wt(this.U6,this.V6),this.mh=-1,!0;if(!(this.ha.ra.$c.equals(this.hb)||this.Qba(this.hb)||this.Qba(this.sourceRange)||this.fBb()||(this.uG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.b9b]:!0,[w.a.d9b]:this.Zq,[w.a.LU]:this.ha.sourceRange,[w.a.KU]:this.ha.ra.$c,
[w.a.HJa]:this.Fu}),this.Eu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Zq)){var Ea=this.hb.height;this.hb.top-=Ea;this.hb.bottom-=Ea}else this.hb.left>this.sourceRange.left&&(this.hf||this.hb.top===this.sourceRange.top&&!this.Zq)&&(Ea=this.hb.width,this.hb.left-=Ea,this.hb.right-=Ea);this.uG()}this.wt(this.U6,this.V6);this.kA=this.tableRange=null;this.mh=-1;this.Zq=!1;this.Gwd();return!0};this.gL=Ea=>{const xb=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
xb&&(Ea=Y.a(this.$).Vd(Ea));var bc=Ea.clientPoint;xb||(Ea=Y.a(this.$).Vd(Ea));this.Zh&&(this.$w=Ea);if(Ea=this.ha.ko(bc,Ea.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(Ea.topLeft)){if(this.Qig(Ea,this.xy(),bc),this.hb=this.q3(Ea),this.ha.sourceRange=this.hb,this.qb.Qi(this.hb,this.Nh),this.qb.Tn(this.Nh),this.qb.Wg(this.sB()),6!==this.mh){for(bc=1;4>=bc;bc++)Ea=this.Og[bc.toString()],Ea.parentNode.removeChild(Ea),this.qb.Dv(this.xy()?11:12,bc).wf.appendChild(Ea);this.mh=6}}else if(this.hb=
this.Yha(Ea),this.Zh)this.cyb(!1);else if(this.qb.Qi(this.hb,this.sB()),this.qb.Tn(this.sB()),this.qb.Wg(this.Nh),5!==this.mh){for(bc=1;4>=bc;bc++)Ea=this.Og[bc.toString()],Ea.parentNode.removeChild(Ea),this.qb.Dv(this.iba(),bc).wf.appendChild(Ea);this.mh=5}this.Wy()}return!0};this.U6=Ea=>{var xb=T.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");xb&&(Ea=Y.a(this.$).Vd(Ea));var bc=Ea.clientPoint;xb||(Ea=Y.a(this.$).Vd(Ea));this.$w=Ea;if(xb=this.ha.ko(bc,Ea.Gb,5,
void 0,void 0,!0)){if(this.ryb(xb))return this.hb=this.Yha(xb),this.byb(!1),!0;var zb=ka.h(this.$),Ub=zb.ag(xb),wc=zb.Af(this.paneType);bc=fa.a.Vs(wc.view.ei,this.domElement.parentNode,bc,zb.rtl);wc=!1;let mb=2;this.Zq=!1;if(this.isRow||this.hf){this.isRow&&bc.y-Ub.topLeft.y>Ub.height/2?(wc=!0,mb=1):this.hf&&bc.x-Ub.topLeft.x>Ub.width/2&&(wc=!0);if(wc){Ea=zb.fk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",zb.KH,mb);try{Ea.Hs(xb),Ea.$$mn(),xb=Ea.$$cu().range}finally{Ea&&Ea.dispose()}}this.hb=
this.Yha(xb)}else{bc.x-Ub.topLeft.x===Ub.width?(this.Zq=!1,wc=!0):bc.y-Ub.topLeft.y>Ub.height/2&&(this.Zq=wc=!0,mb=1);this.kA&&(this.Zq=this.Yq);if(wc){zb=zb.fk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",zb.KH,mb);try{zb.Hs(xb),zb.$$mn(),xb=zb.$$cu().range}finally{zb&&zb.dispose()}}this.qb.Wg(this.Nh);this.Nh=this.Zq?[11]:[12];for(zb=1;4>=zb;zb++)(Ub=this.Og[zb.toString()])&&Ub.parentNode.removeChild(Ub),this.Og[zb.toString()]=null;this.hA(Ea.clientPoint,Ea.Gb,this.Zq?11:
12,!0);this.hb=this.q3(xb)}this.ha.sourceRange=this.hb;this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.qb.Wg(this.sB());if(6!==this.mh){for(Ea=1;4>=Ea;Ea++)xb=this.Og[Ea.toString()],xb.parentNode.removeChild(xb),this.qb.Dv(this.isRow||this.Zq?11:12,Ea).wf.appendChild(xb);this.mh=6}this.Wy()}return!0};this.Qma=()=>{this.Zh?this.Ep&&5<=this.mh&&(this.tableRange?this.Fu?this.Ox(!0):this.fia(!0):this.Fu?this.isRow||this.hf?this.Ox(!0):this.y3(!0):this.isRow||this.hf?this.y3(!0):this.Ox(!0)):this.Ep&&
5<=this.mh&&(this.tableRange?(this.qb.Wg(this.Nh),this.wt(this.gL,this.hL)):(this.qb.Wg(this.sB()),this.wt(this.Fh,this.Of)))};this.tableRange=null;this.x5=this.Eu=this.Fu=!1;this.ha.z0b(this.Qma)}dispose(){T.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.lKb(this.Qma);this.Eu&&this.opa();this.Zh&&this.Fu&&this.opa(1);super.dispose()}jqc(na){this.Zh&&(this.$w=na,this.kA=null,this.Yq=this.isRow=this.hf=this.Zq=!1,qa.KeyInputManager.instance.ta(r.a.Ob,
this.domElement.ownerDocument.body,this.onKeyDown));this.Ep=!0;this.tableRange=this.P0c(this.tableManager.Dn(this.sourceRange.topLeft));ka.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.kA=this.tableRange,this.co=1,this.Nh=(this.Yq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.mh=6,this.hx(this.gL,this.hL),this.AH=this.Via,this.XI=this.toa,this.hA(na.clientPoint,na.Gb,this.Yq?11:12,!0,!0),this.jJ(!0)):
(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.mh=6,this.hx(this.gL,this.hL),this.hA(na.clientPoint,na.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.co=3,this.gF=this.isRow?1:2,this.mh=6,this.Nh=this.isRow?[11]:[12],this.hx(this.U6,this.V6),this.AH=this.Via,this.XI=this.toa,this.hA(na.clientPoint,na.Gb,this.isRow?11:12,
!0,!0),this.jJ(!0)):(this.co=2,this.gF=0,this.hx(this.Fh,this.Of),this.AH=this.$tb,this.XI=this.iNb,this.hA(na.clientPoint,na.Gb,this.iba(),!1,!0),this.az(!0))):(this.hx(this.Fh,this.Of),qa.KeyInputManager.instance.ta(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.hA(na.clientPoint,na.Gb,this.iba(),!1),this.az()))}Cza(){this.Ep=!1;this.Zh&&(this.co=0);this.qb.Wg(this.sB());if(!this.$.Zp([this.hb],!1))return this.wt(this.Fh,this.Of),
this.mh=-1,!0;if(this.ha.ra.$c.equals(this.hb)||this.Qba(this.hb)||this.Qba(this.sourceRange))this.mh=-1;else{this.uG();this.ha.sourceRange=this.sourceRange.clone();const na=this.ha.sourceRange,ab=this.ha.ra.$c;this.Zh?this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.LU]:na,[w.a.KU]:ab,[w.a.HJa]:this.Fu}):this.$.Xc(-694765314,2,30,{[w.a.yaa]:this.Eu,[w.a.LU]:na,[w.a.KU]:ab})}!this.Zh&&this.tableRange||this.wt(this.Fh,this.Of);this.Gwd();return!0}mqc(na){const ab=this.ha.ko(na.clientPoint,na.Gb,5,
void 0,void 0,!0);this.$w=na;return this.ryb(ab)?(this.hb=this.q3(ab),this.byb(!0),!0):this.vld(ab)?(this.hb=this.Yha(ab),this.cyb(!0),!0):!1}Wy(na=!1){const ab=this.hb.toString();if(this.Zh)for(var Gb=1;4>=Gb;Gb++)if(this.Zgb){const fc=this.Og[Gb.toString()];fc&&fc.childNodes&&0<fc.childNodes.length&&(fc.childNodes[0].innerText=ab,fc.childNodes[1].innerText=this.AH,na&&(fc.childNodes[2].innerText=this.XI))}else this.Og[Gb.toString()].childNodes[0].innerText=ab,this.Og[Gb.toString()].childNodes[1].innerText=
this.AH,na&&(this.Og[Gb.toString()].childNodes[2].innerText=this.XI);else for(na=1;4>=na;na++)if(this.Zgb){if(Gb=this.Og[na.toString()])Gb.innerText=ab}else this.Og[na.toString()].innerText=ab}ryb(na){return!!this.kA&&1!==this.co&&!!na&&this.kA.contains(na.topLeft)}vld(na){return!!this.kA&&1===this.co&&!!na&&!this.kA.contains(na.topLeft)}byb(na){this.tableRange=this.kA;this.co=1;const ab=!this.Fu;na?(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.CAa(ab),this.jJ(ab)):(this.y3(!1),this.tO(ab),this.az(ab))}cyb(na){this.tableRange=
null;this.co=2;const ab=!this.Fu;na?(this.Ox(!1),this.Nh=this.Yq?[11]:[12],this.Zq=this.Yq,this.jRa(ab),this.jJ(ab)):(this.fia(!1),this.tO(ab),this.az(ab))}woa(){if(!ka.h(this.$).ha.ra.Mg)return!1;const na=ka.h(this.$).getRangeInformation(this.ha.ra.$c);for(const ab of na)if(Object(ia.a)(Z.PivotTableRange,ab))return!1;return!0}P0c(na){if(na&&na.contains(this.sourceRange)&&!na.equals(this.sourceRange)){if(na.zba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===na.top){const ab=
new la.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,this.sourceRange.right,!1,!1);if(!ab.equals(na))return this.sourceRange=ab,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),na}this.Zh?this.Yq=na.left===this.sourceRange.left&&na.right===this.sourceRange.right:this.isRow=na.left===this.sourceRange.left&&na.right===this.sourceRange.right;if(na.top===this.sourceRange.top&&na.bottom===this.sourceRange.bottom||this.xy())return na}return null}q3(na){const ab=na.clone();
this.xy()?ab.left=Math.max(na.left-this.Ufc,1):ab.top=Math.max(na.top-this.YEc,1);ab.right=ab.left+this.sourceRange.width-1;ab.bottom=ab.top+this.sourceRange.height-1;return this.a_a(ab)}fBb(){const na=this.hb.topLeft.Ad(this.sourceRange);return na||this.Zh&&!this.tableRange?na:this.xy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}iKd(){if(this.xy()&&this.hb.left!==this.tableRange.left||!this.xy()&&this.hb.top!==this.tableRange.top){const na=sa.a.Zc(1,1,0,913,0,
2065438552,"RearrangeInvalidDest");Na.a(this.$).Rr([na]);return!0}return!1}EId(){const na=this.$.Jb.Ac("UserAction","RearrangeRowColumnClientSide"),ab={["CopyPasteTargetType"]:1,["OperationId"]:aa.a.create().toString(),["Stopwatch"]:na,["DragDropIsShiftKeyDown"]:this.Fu,["EncounteredDeploymentErrors"]:!1},Gb=this.Eu?2:1,fc=this.$.da.za(254);(new Promise((pb,Ea)=>{this.$ub(xb=>{xb.Errors&&0<xb.Errors.length?Ea(new Xa.a(22,xb.Errors)):pb(!0)},xb=>{xb=ua.a.Oe(xb.data);Ea(new Xa.a(22,xb))})})).then(()=>
{t.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');fc&&fc.Nrf(ab,Gb,this.sourceRange,this.hb);return Promise.resolve(!0)},pb=>{t.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${pb?copyPasteInfra.getStringifiedError(pb):"null"}, copyPasteTargetType="${1}"`);return fc?fc.BGf(pb,ab,Gb,this.sourceRange,this.hb):Promise.reject(pb)})}$ub(na=null,ab=null){const Gb={};this.xy()?
(Gb.FirstRow=this.hb.top-1,Gb.FirstColumn=0,Gb.DeltaColumn=0,Gb.DeltaRow=this.hb.bottom-this.hb.top+1):(Gb.FirstRow=0,Gb.FirstColumn=this.hb.left-1,Gb.DeltaColumn=this.hb.right-this.hb.left+1,Gb.DeltaRow=0);Gb.LastRow=W.a.Pz;Gb.LastColumn=W.a.Rw;Gb.SheetName=this.$.xa.na?this.$.xa.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;const fc=Za.v(this.sourceRange,this.$);this.$.userOperationManager.Kc(new xa.a(514,0,(pb,Ea,xb)=>bb(this.$.pa.ya,fc,Gb,na?sb.b(pb,na):pb,ab?sb.a(Ea,ab):Ea,xb,
null),64,()=>new Fa(fc,Gb)),null)}opa(na=0){0===na?this.Eu=!1:1===na&&(this.Fu=!1);this.Zh&&(this.Eu||this.Fu)||(qa.KeyInputManager.instance.Ba(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!1)}tO(na=!1){this.mh=5;this.hx(this.Fh,this.Of);this.AH=this.$tb;this.XI=this.iNb;this.hA(this.$w.clientPoint,this.$w.Gb,this.iba(),!1,na)}jRa(na=!1){this.mh=6;this.hx(this.U6,this.V6);this.AH=this.Via;this.XI=this.toa;this.hA(this.$w.clientPoint,this.$w.Gb,this.isRow||this.Yq?11:12,!0,na)}CAa(na=
!1){this.mh=6;this.hx(this.gL,this.hL);this.AH=this.Via;this.XI=this.toa;this.hA(this.$w.clientPoint,this.$w.Gb,this.xy()?11:12,!0,na)}xy(){return!this.Zh&&this.isRow||this.Zh&&this.Yq}y3(na){this.qb.Wg(this.Nh);this.wt(this.U6,this.V6,void 0,na)}Gwd(){const na=dc.a.instance.Ub("Common.ISystemInitiatedFeedback");na&&na.execute(ab=>{ab.logActivity("DragDrop",null)})}}Object(u.a)(Tb,"DragSelectionClickBehaviorCellRangeAndTable",Cb,[]);var Jb=a(319),eb=a(142);class za extends Cb{constructor(na,ab,Gb,
fc,pb){super(na,ab,Gb,fc,pb);this.Qma=()=>{this.Ep&&this.fia(!0);5===this.mh&&this.Ox(!0)};this.hL=Ea=>{Y.a(this.$).Vd(Ea);this.Ep=!1;this.qb.Wg(this.Nh);this.ha.sourceRange=this.sourceRange.clone();this.fmf?this.$.Xc(927125067,C.a.Db,30,null):this.j7a?(this.uG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.yaa]:!0,[w.a.LU]:this.ha.sourceRange,[w.a.KU]:this.ha.ra.$c,[w.a.HJa]:!1}),ka.h(this.$).Gf.gm(w.a.TQ),this.j7a=!1):this.A9i();this.wt(this.gL,this.hL);this.mh=-1;
return!0};this.gL=Ea=>{Ea=Y.a(this.$).Vd(Ea);const xb=Ea.clientPoint;this.$w=Ea;let bc=this.ha.ko(xb,Ea.Gb,5,void 0,void 0,!0);if(bc){if(!this.wsd(bc))return this.A9h(Ea),!0;this.Qig(bc,this.isRow,xb);if(this.isRow||this.hf)this.hb=this.q3(bc);this.ha.sourceRange=this.hb;this.qb.Qi(this.hb,this.Nh);this.qb.Tn(this.Nh);this.qb.Wg(this.sB());this.Wy()}return!0};this.onKeyDown=Ea=>this.o5(Ea)?(this.x5||(qa.KeyInputManager.instance.ta(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!0),
this.j7a||(ka.h(this.$).Gf.gm(Ka.L1a),this.j7a=!0),!0):!1;this.onKeyUp=Ea=>{this.o5(Ea)&&(qa.KeyInputManager.instance.Ba(r.a.Dd,this.domElement.ownerDocument.body,this.onKeyUp),this.x5=!1,this.Ep?ka.h(this.$).Gf.gm(Ka.KJa):ka.h(this.$).Gf.gm(w.a.TQ),this.j7a=!1);return!0};this.hFf=Ea=>{Ea.Errors&&0<Ea.Errors.length?(t.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${sa.a.sc(Ea.Errors)}]`),this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right,this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1?(this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hb.top||(this.hb.top-=this.sourceRange.height),this.hb.bottom=this.hb.top+this.sourceRange.height-1):this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1?(this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right):(this.sourceRange.left>this.hb.left||(this.hb.left-=this.sourceRange.width),this.hb.right=this.hb.left+this.sourceRange.width-1);this.uG();this.mh=-1};this.gFf=Ea=>{Ea=ua.a.Oe(Ea.data);t.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${sa.a.sc(Ea)}]`)};this.ha.z0b(this.Qma);this.j7a=this.x5=!1}dispose(){T.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.lKb(this.Qma);
super.dispose()}jqc(na){this.$w=na;this.isRow=this.hf=!1;this.Ep=!0;qa.KeyInputManager.instance.ta(r.a.Ob,this.domElement.ownerDocument.body,this.onKeyDown);(this.kc=this.tableManager.lka(this.sourceRange))||t.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.fmf=(new eb.a(this.$.xa)).ki;ka.h(this.$);ka.h(this.$).Gf.gm(Ka.KJa);this.wsd(this.hb)?(this.isRow=this.Kti(),this.hf=this.rni(),this.isRow||
this.hf?(this.W7a=!1,this.CAa(na),this.hb=this.q3(this.hb),this.jJ()):(this.W7a=!0,this.tO(na),this.az())):(this.W7a=!0,this.tO(na),this.az())}Cza(){return this.fmf?(this.$.Xc(927125067,C.a.Db,30,null),this.Ox(!0),this.W7a=!1,this.mh=-1,!0):this.j7a?(this.uG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[w.a.yaa]:!0,[w.a.LU]:this.ha.sourceRange,[w.a.KU]:this.ha.ra.$c,[w.a.HJa]:!1}),ka.h(this.$).Gf.gm(w.a.TQ),this.Ox(!0),this.Ep=this.W7a=!1,this.mh=-1,!0):5===this.mh?(this.Ox(!0),
this.W7a=!1,this.dIj(),this.mh=-1,!0):!1}mqc(na){const ab=this.ha.ko(na.clientPoint,na.Gb,5,void 0,void 0,!0);this.$w=na;return this.W7a?!1:this.wsd(ab)?(this.B9h(na),!0):!1}Wy(){let na=new la.Range(this.hb.top,this.hb.left,this.hb.bottom,this.hb.right,!1,!0);6===this.mh&&(this.isRow?(--na.top,na.bottom=na.top+this.hb.height-1):(--na.left,na.right=na.left+this.hb.width-1));for(let ab=1;4>=ab;ab++)if(this.Zgb){const Gb=this.Og[ab.toString()];Gb&&Gb.childNodes&&0<Gb.childNodes.length&&(Gb.childNodes[0].innerText=
na.toString())}else this.Og[ab.toString()].childNodes[0].innerText=na.toString()}woa(){if(!ka.h(this.$).ha.ra.Mg)return!1;var na=ka.h(this.$).getRangeInformation(this.ha.ra.$c);for(var ab of na)if(Object(ia.a)(Z.PivotTableRange,ab)&&(na=this.tableManager.lka(ab)))return ab=!na.isOlap||!na.eOa(!0),t.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",na),na.isActionable&&ab;return!1}q3(na){na=na.clone();this.isRow?
(na.left=this.sourceRange.left,na.right=this.kc.right,na.bottom=na.top+this.sourceRange.height-1):this.hf?(na.top=this.sourceRange.top,na.bottom=this.kc.AL.bottom,na.right=na.left+this.sourceRange.width-1):t.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.a_a(na)}A9i(){const na={},ab=Za.v(this.sourceRange,this.$);ka.h(this.$).getRangeInformation(this.hb);if(this.isRow){ab.FirstColumn=na.FirstColumn=this.hb.left-
1;ab.LastColumn=na.LastColumn=this.hb.right-1;if(this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1){t.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hb.top?na.LastRow=na.FirstRow=this.hb.top-1:(na.FirstRow=this.hb.top-this.sourceRange.height-1,na.LastRow=na.FirstRow+this.sourceRange.height-1)}else{na.FirstRow=this.hb.top;na.LastRow=this.hb.bottom-1;if(this.sourceRange.left<=this.hb.left&&
this.sourceRange.right>=this.hb.left-1){t.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}na.LastColumn=this.sourceRange.left>this.hb.left?na.FirstColumn=this.hb.left-1:na.FirstColumn=this.hb.left-this.sourceRange.width-1}const Gb={};Gb.SheetName=this.$.xa.na?this.$.xa.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;Gb.Ranges=Array(2);Gb.Ranges[0]=ab;Gb.Ranges[1]=na;this.LEh(Gb)}LEh(na){this.$.userOperationManager.Kc(new xa.a(265,
0,(ab,Gb,fc)=>lb(this.$.pa.ya,na,this.hFf?sb.b(ab,this.hFf):ab,this.gFf?sb.a(Gb,this.gFf):Gb,fc,null),64),null)}wsd(na){return null!==this.kc&&(null===this.kc.AL||na.left>=this.kc.AL.left)&&(null===this.kc.fF||na.right<=this.kc.fF.right)&&(null===this.kc.fF||na.top>=this.kc.fF.top)&&(null===this.kc.AL||na.bottom<=this.kc.AL.bottom)}Kti(){return null!==this.kc&&null!==this.kc.AL&&this.kc.AL.top<=this.hb.top&&this.kc.AL.left<=this.hb.left&&this.kc.AL.right>=this.hb.left}rni(){return null!==this.kc&&
null!==this.kc.fF&&this.kc.fF.top===this.hb.top&&this.kc.fF.left<=this.hb.left&&this.kc.fF.right>=this.hb.right}CAa(na){this.mh=6;this.Nh=this.isRow?[11]:[12];this.hx(this.gL,this.hL);this.hA(na.clientPoint,na.Gb,this.isRow?11:12,!0,!1)}tO(na){this.mh=5;this.hx(this.Fh,this.Of);this.hA(na.clientPoint,na.Gb,this.iba(),!1,!1)}B9h(na){this.Ox(!1);this.CAa(na);this.hb=this.q3(this.hb);this.jJ()}A9h(na){this.fia(!1);this.tO(na);this.az()}dIj(){if(!this.Qba(this.hb)){var na=sa.a.Zc(1,0,903,902,0,2069074184,
"PivotTableInvalidMove");na.HelpTopicId=Jb.a.RLj;na.HelpDescription=Ha.a.instance.ga(908);Na.a(this.$).Rr([na])}}}Object(u.a)(za,"DragSelectionClickBehaviorPivotTableRange",Cb,[]);var ha=a(372);class fb extends N{constructor(na,ab){super(na);this.Ag=()=>{this.domElement.classList.remove(ea.selecting);ha.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Np=()=>{this.domElement.classList.add(ea.selecting)};this.onPointerDown=Gb=>{2===Gb.tb&&Gb.jo===Sys.UI.MouseButton.leftButton&&
(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.ra.$c,ha.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Wca=()=>{this.gridView.$.Xc(1983983164,2,30,null);return!0};this.ed=()=>{A.DOMElementExtensions.setVisible(this.Raa,this.gridView.$.isEditMode)};this.c7=()=>{A.DOMElementExtensions.setVisible(this.Raa,!1)};this.b7=()=>{A.DOMElementExtensions.setVisible(this.Raa,!0)};this.qDf=()=>{A.DOMElementExtensions.setVisible(this.Raa,!1)};
this.pDf=()=>{A.DOMElementExtensions.setVisible(this.Raa,!0)};this.WFb=(Gb,fc)=>{A.DOMElementExtensions.setVisible(this.Raa,!fc.Coe)};this.gridView=ab;ab=document.createElement("div");ab.className=O.a.oDh;this.Raa=ab;this.ed(null,null);na.appendChild(ab);z.a.instance.ta(r.a.pointerDown,this.Raa,this.onPointerDown);M.a.instance.ta(r.a.Bk,this.Raa,this.Wca);this.gridView.ha.Y2(this.Np);this.gridView.ha.HY(this.Ag);this.gridView.$.nl(this.ed);this.gridView.$.rb.H0b(this.c7);this.gridView.$.rb.G0b(this.b7);
this.gridView.fre(this.WFb);this.gridView.fc.Xk(this.qDf);this.gridView.fc.sm(this.pDf)}dispose(){z.a.instance.Ba(r.a.pointerDown,this.Raa,this.onPointerDown);M.a.instance.Ba(r.a.Bk,this.Raa,this.Wca);this.gridView.$&&(this.gridView.ha.A7(this.Np),this.gridView.ha.MW(this.Ag),this.gridView.$.Kl(this.ed),this.gridView.$.rb.ovc(this.c7),this.gridView.$.rb.nvc(this.b7),this.gridView.mVf(this.WFb),this.gridView.fc.Fk(this.qDf),this.gridView.fc.Il(this.pDf));super.dispose()}}Object(u.a)(fb,"FillHandleClickBehavior",
N,[]);class rb extends X{constructor(na,ab){super(na);this.zZi=Gb=>{const fc=H.HelperMethods.Do(Gb);var pb=this.Fwa.L2d(Gb.clientPoint);if(!pb)return!1;var Ea=pb.ve,xb=this.Fwa.Ea.Xwb(Ea.hashCode).Vva(pb.lJ);if(!xb)return!1;Gb=Ea.$i.domElement;pb=H.HelperMethods.iqe(H.HelperMethods.qxb(Ea.domElement,Gb),pb.lJ);Ea=0;xb=this.Fwa.Sb(xb.getRange());for(let zb=0,Ub=rb.IBe.length;zb<Ub;++zb){const wc=rb.IBe[zb];if((128===wc||64===wc)&&this.Fwa.$.isEditMode)continue;var bc=xb.sLa(wc);if(!bc||!bc.R6a||"none"===
bc.R6a.style.display)continue;bc=bc.R6a;const mb=H.HelperMethods.qxb(bc,Gb);bc=new Sys.UI.Bounds(mb.x,mb.y,bc.offsetWidth,bc.offsetHeight);if(L.a.EN(bc,pb)){Ea=wc;break}}return 0!==Ea?(xb.invoke(Ea,fc),!0):!1};this.Dxg=ab;M.a.instance.ta(r.a.click,na,this.zZi)}get Fwa(){return this.Dxg}}rb.IBe=[1,2,32,256,128,64];Object(u.a)(rb,"IPadSelectionClickThroughBehavior",X,[]);var pa=a(22);class Ma{constructor(na){this.Wcf=ab=>{this.NDc(ab.Gb,1);return!0};this.Xcf=ab=>{this.NDc(ab.Gb,-1);return!0};this.Ag=
()=>{this.lrd=!1};this.Np=()=>{this.lrd=!0};this.gridView=na;this.r6a=0;this.lrd=this.Fic=!1;this.e6=Number.NaN;this.gridView.ha.Y2(this.Np);this.gridView.ha.HY(this.Ag);this.gridView.ha.z0b(this.Ag)}dispose(){this.gridView.ha.A7(this.Np);this.gridView.ha.MW(this.Ag);this.gridView.ha.lKb(this.Ag)}QAa(){this.r6a=0;this.Fic=!1;this.e6=Number.NaN}mOe(na){this.Fic=!0;this.NDc(na,1)}nOe(na){this.Fic=!1;this.NDc(na,-1)}NDc(na,ab){if(na)if(na.parentNode)if(this.lrd)isNaN(this.e6)||(this.aEc(this.e6,!1),
this.e6=Number.NaN);else if(na=parseInt(na.parentNode.getAttribute(w.a.H6a),10),isNaN(na))t.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.e6)&&na!==this.e6){if(this.Fic)return;this.aEc(this.e6,!1)}if(isNaN(this.e6)||na!==this.e6)this.e6=na,this.r6a=0;!this.r6a&&0<ab&&this.aEc(na,!0);this.r6a=Math.max(this.r6a+ab,0);!this.r6a&&0>ab&&(this.aEc(na,!1),this.e6=Number.NaN)}else t.ULS.shipAssertTag(537159367,
0,!!na.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else t.ULS.shipAssertTag(537159368,0,!!na,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}aEc(na,ab){for(let fc=1;4>=fc;fc++){var Gb=this.gridView.qb.Dv(3,fc,na).wf;A.DOMElementExtensions.toggleCssClass(Gb,ea.LCh,ab);for(Gb=Gb.firstChild;Gb;Gb=Gb.nextSibling)pa.a.contains(Gb.className,"resizemarqueehandle",!0)&&A.DOMElementExtensions.toggleCssClass(Gb,ea.PCh,ab)}}}Object(u.a)(Ma,"MarqueeHoveringManager",
null,[]);var Ja=a(177),Ga=a(82),La=a(821),nb=a(1236);class Lb extends X{constructor(na,ab){super(na);this.kqc=()=>{if(!this.Au)return t.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Au.xQf(this.VH,!1);this.Au.dQe(this.VH,!1);if(3===this.Au.model.state)return!0;this.Au.Tcf(!0);return!0};this.k0=()=>{if(!this.Au)return!1;this.Au.Eaj();this.Au.hOd(this.VH,!1);if(3===this.Au.model.state)return!0;this.Au.Tcf(!1);return!0};
this.onPointerDown=Gb=>this.Au?2===Gb.tb&&Gb.jo===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.rGb=()=>{if(!this.Au)return!1;this.Au.hOd(this.VH,!0);this.Au.xQf(this.VH,!0);this.Au.dQe(this.VH,!0);this.Au.RLb(!0);return!0};this.onDoubleClick=Gb=>{if(Gb.Ca)return Gb.Ca.stopPropagation(),!0;t.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Au=Object(Ga.a)(nb.a,ab.metadata);this.HF=document.createElement("div");this.HF.id=
`${na.id}-${w.a.yBe}`;this.HF.className=La.a.f2g;this.VH=document.createElement("div");this.VH.id=`${na.id}-${w.a.H1c}`;this.VH.className=La.a.H1c;this.HF.appendChild(this.VH);na.appendChild(this.HF);t.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");z.a.instance.ta(r.a.sW,this.HF,this.kqc);z.a.instance.ta(r.a.Jy,this.HF,this.k0);z.a.instance.ta(r.a.pointerDown,this.HF,this.onPointerDown);Ja.a.instance.ta(r.a.click,
this.HF,this.rGb);Ja.a.instance.ta(r.a.Bk,this.HF,this.onDoubleClick);A.DOMElementExtensions.setVisible(this.HF,ab.isVisible)}dispose(){z.a.instance.Ba(r.a.sW,this.HF,this.kqc);z.a.instance.Ba(r.a.Jy,this.HF,this.k0);z.a.instance.Ba(r.a.pointerDown,this.HF,this.onPointerDown);Ja.a.instance.Ba(r.a.click,this.HF,this.rGb);Ja.a.instance.Ba(r.a.Bk,this.HF,this.onDoubleClick);A.DOMElementExtensions.tf(this.VH);this.VH=null;A.DOMElementExtensions.tf(this.HF);this.Au=this.HF=null;super.dispose()}$Za(na){this.Au=
Object(Ga.a)(nb.a,na.metadata);na.isVisible!==na.qya&&(this.Au.eCj(na.isVisible?1:0),A.DOMElementExtensions.setVisible(this.HF,na.isVisible))}}Object(u.a)(Lb,"RangeCatchUpActivityHighlightBehavior",X,[]);class ac extends ca{constructor(na,ab,Gb,fc){super(na,ab,Gb,fc)}get e5(){return 16}get Fdb(){return this.gridView.ha.rangePicker.Xed(!1)}nTa(){return(this.gridView.inRangePicker||this.gridView.ri)&&super.nTa()}}Object(u.a)(ac,"RangePickerTouchGrippiesBehavior",ca,[]);class ib extends X{constructor(na,
ab){super(na);const Gb=document.createElement("div"),fc=document.createElement("div");Gb.className=ab?ea.wDh:ea.yDh;fc.className=ab?ea.xDh:ea.vDh;na.appendChild(Gb);na.appendChild(fc)}}Object(u.a)(ib,"RearrangeHighlightBehavior",X,[]);var Ra;(function(na){na[na.topLeft=0]="topLeft";na[na.topRight=1]="topRight";na[na.bottomLeft=2]="bottomLeft";na[na.bottomRight=3]="bottomRight";na[na.error=4]="error"})(Ra||(Ra={}));Object(u.b)("Corner",Ra);class ya extends X{constructor(na,ab,Gb,fc,pb){super(na);this.Za=
this.rG=null;this.U3=0;this.hb=this.sourceRange=null;this.aUa=!1;this.onPointerDown=Ea=>{Ea=Y.a(this.$).Vd(Ea);if(this.j7f(Ea)&&!this.aUa){this.bsf();this.Za=this.xo.Jbc();this.rG=this.xo.b7e(Ea);if(!this.Za||!this.rG||!this.rG.range)return t.ULS.shipAssertTag(537159361,0,!!this.Za,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),t.ULS.shipAssertTag(537159360,0,!!this.rG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),t.ULS.shipAssertTag(537159331,0,
!!this.rG.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.hb=this.rG.range.clone();this.sourceRange=this.hb.clone();this.U3=this.R2e(Ea);if(4===this.U3)return t.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const xb=this.J4e(Ea,!0);if(!xb)return t.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;
if(!this.SIe(xb))return t.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.JMa=!0;this.Za.XE(!1);this.ZF.mOe(Ea.Gb);this.xo.dQf(!0,this.Cba.mU);this.Za.textBox.removeSelection();this.Za.j0b(this.F$e);this.sTf();this.aUa=!0;Ba.b(this.$,!0)}return!0};this.Fh=Ea=>{Ea=Y.a(this.$).Vd(Ea);Ea=this.J4e(Ea,!1);if(!Ea)return!0;Ea=this.SIe(Ea);if(!Ea)return t.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.Gac(!0),!1;if(this.hb.equals(Ea))return!0;this.hb=Ea;Ea=this.az();Ea||(t.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Gac(!0));return Ea};this.Of=Ea=>{Y.a(this.$).Vd(Ea);Ea=this.uG();t.ULS.shipAssertTag(537159325,0,Ea,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Gac(!Ea);return Ea};this.F$e=()=>{this.Gac(!0)};this.gridView=ab;this.$=ab.$;this.xL=[];this.ha=this.gridView.ha;this.ZF=Gb;this.xo=fc;this.Cba=
pb;this.coloredReferencesManager=this.$.da.za(281);t.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.BB=x.a.BB(this.$))ab=this.$.da.za(464),t.ULS.shipAssertTag(510255176,0,!!ab,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.qB=ab.qB;for(const Ea of this.FYf())ab=this.xo.dIe(na,
Ea,this.Sse(),this.onPointerDown),this.xL.push(ab);for(const Ea of this.xL)z.a.instance.ta(r.a.sW,Ea,this.ZF.Wcf),z.a.instance.ta(r.a.Jy,Ea,this.ZF.Xcf);this.$Za(pb)}dispose(){this.xL.forEach(na=>{z.a.instance.Ba(r.a.pointerDown,na,this.onPointerDown)});this.xL.length=0;super.dispose()}$Za(na){this.Cba=na;this.ate(na);this.xo.MMb(na,this.xL,this.GUd());this.ZF.QAa()}J4e(na,ab){const Gb=na.Gb;na=na.clientPoint;if(!Gb||!na)return t.ULS.shipAssertTag(537159324,0,!!Gb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
t.ULS.shipAssertTag(537159323,0,!!na,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ab&&(na=this.bwf(na));ab=this.ha.ko(na,Gb,0,!0,!1,!0);ab||(na=this.bwf(na),ab=this.ha.ko(na,Gb,0,!0,!1,!0));return ab}bwf(na){na.y+=0===this.U3||1===this.U3?2:-2;na.x+=0===this.U3||2===this.U3?2:-2;return na}SIe(na){if(!na||!this.sourceRange)return t.ULS.shipAssertTag(537159322,0,!!na,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),t.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.U3)return new la.Range(na.top,na.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.U3)return new la.Range(na.top,this.sourceRange.left,this.sourceRange.bottom,na.right,!0,!1);if(2===this.U3)return new la.Range(this.sourceRange.top,na.left,na.bottom,this.sourceRange.right,!0,!1);if(3===this.U3)return new la.Range(this.sourceRange.top,this.sourceRange.left,na.bottom,na.right,!0,!1);t.ULS.shipAssertTag(537159320,
0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Ra[this.U3]}`);return null}uG(){return this.BB?this.qB.KEb(this.Za,this.rG,this.hb):this.coloredReferencesManager.KEb(this.Za,this.rG,this.hb)}az(){return this.uG()}Gac(na){na&&t.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.ZF.nOe(this.xL[0]);this.xo.dQf(!1,this.Cba.mU);this.Za.textBox.setCaretPositionToEnd();
this.Za.Yuc(this.F$e);this.ehg();this.aUa=this.gridView.JMa=!1;Ba.b(this.$,!1);this.xo.TRf()}}Object(u.a)(ya,"ResizeMarqueeBehaviorBase",X,[]);class Va extends ya{constructor(na,ab,Gb,fc,pb){super(na,ab,Gb,fc,pb)}FYf(){return[ea.CDh,ea.DDh,ea.ADh,ea.BDh]}Sse(){return[ea.zDh]}R2e(na){na=na.Gb;if(na===this.xL[0])return 0;if(na===this.xL[1])return 1;if(na===this.xL[2])return 2;if(na===this.xL[3])return 3;t.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}sTf(){this.xo.hx(this.Fh,this.Of,!0)}ehg(){this.xo.C0d(this.Fh,this.Of,!0)}j7f(na){return 2===(C.a.Db=na.tb)&&na.jo===Sys.UI.MouseButton.leftButton}GUd(){return!0}bsf(){t.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}ate(na){for(const ab of this.xL)ab.style.backgroundColor=na.wf.style.borderColor}}Object(u.a)(Va,"ResizeMarqueeMouseBehavior",ya,[]);class oa extends ya{constructor(na,ab,Gb,fc,pb){super(na,ab,Gb,
fc,pb);this.mGb=()=>{const Ea=3===C.a.Db;this.bvd&&!Ea?this.xo.MMb(this.Cba,this.xL,!1):!this.bvd&&Ea&&this.xo.MMb(this.Cba,this.xL,!0);this.bvd=Ea};this.BYi=(Ea,xb)=>{xb.H6a===this.Cba.mU&&this.xo.MMb(this.Cba,this.xL,!xb.start&&this.GUd())};C.a.Mre(this.mGb);this.bvd=3===C.a.Db;this.xo.DNg(this.BYi)}dispose(){C.a.NVf(this.mGb);super.dispose()}FYf(){return[O.a.ECh,O.a.DCh]}Sse(){const na=!T.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[na?O.a.jVe:O.a.iVe,O.a.F$b,na?O.a.CCh:
O.a.E$b]}R2e(na){na=na.Gb;if(na===this.xL[0])return 0;if(na===this.xL[1])return 3;t.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}sTf(){l.a.vy?this.xo.hx(this.Fh,this.Of,!1):this.xo.Dfj(this.Fh,this.Of)}ehg(){l.a.vy?this.xo.C0d(this.Fh,this.Of,!1):this.xo.LXj(this.Fh,this.Of)}j7f(na){return 3===(C.a.Db=na.tb)}GUd(){return 3===C.a.Db}bsf(){t.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}ate(){}}
Object(u.a)(oa,"ResizeMarqueeTouchBehavior",ya,[]);class kb extends X{constructor(na,ab){super(na);kb.wsb(na,P.a.UCh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.horizontal);kb.wsb(na,P.a.TCh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.vertical);kb.wsb(na,P.a.QCh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.horizontal);kb.wsb(na,P.a.SCh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.vertical);kb.wsb(na,O.a.RCh)}static wsb(na,ab,Gb){const fc=document.createElement("div");fc.className=ab;Gb&&(fc.style.backgroundImage=
`url("${Gb}")`);na.appendChild(fc)}}Object(u.a)(kb,"SelectionCutCopyBehavior",X,[]);class Sa extends X{constructor(na){super(na);appChrome.renderSpinner(na)}}Object(u.a)(Sa,"SelectionPasteBehavior",X,[]);class U extends X{constructor(na,ab){super(na);U.Nsb(na,P.a.uDh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.horizontal);U.Nsb(na,P.a.tDh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.vertical);U.Nsb(na,P.a.qDh+" "+O.a.jva,null===ab||void 0===ab?void 0:ab.horizontal);U.Nsb(na,P.a.sDh+" "+O.a.jva,null===
ab||void 0===ab?void 0:ab.vertical);U.Nsb(na,O.a.rDh)}static Nsb(na,ab,Gb){const fc=document.createElement("div");fc.className=ab;Gb&&(fc.style.backgroundImage=`url("${Gb}")`);na.appendChild(fc)}}Object(u.a)(U,"SelectionRangePickerBehavior",X,[]);class ta extends ca{constructor(na,ab,Gb,fc){super(na,ab,Gb,fc)}get e5(){return 0}get Fdb(){return this.gridView.ha.ra.$c}nTa(){const na=this.gridView.ri||this.gridView.eb;return this.gridView.ha.ra.Mg&&!na&&super.nTa()}}Object(u.a)(ta,"SelectionTouchGrippiesBehavior",
ca,[]);var ub=a(53);class hc extends v.a{constructor(na,ab){super();this.Ipb=(Gb,fc)=>{Gb=fc.e5;const pb=this.gridView;fc=fc.ydi;const Ea=fc.wf,xb=fc.G$;l.a.Xg&&xb.push(new rb(Ea,pb));switch(Gb){case 24:fc.G$.push(new Lb(Ea,fc));break;case 0:fc.G$.push(new fb(Ea,pb));l.a.Fp||(T.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(xb.push(new Tb(Ea,this.gridView.$,fc.paneType,this.tableManager,this.xo)),T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&xb.push(new za(Ea,this.gridView.$,fc.paneType,this.tableManager,this.xo))):xb.push(new Mb(Ea,this.gridView.$,fc.paneType,this.tableManager,this.xo)));xb.push(new ta(fc,Ea,pb,fc.paneType));break;case 3:xb.push(new N(Ea));l.a.Fp||(xb.push(new Oa(Ea,this.gridView.$,fc.paneType,this.ZF,this.xo,fc)),xb.push(new Va(Ea,this.gridView,this.ZF,this.xo,fc)),xb.push(new oa(Ea,this.gridView,this.ZF,this.xo,fc)));break;case 4:case 5:xb.push(new kb(Ea,this.nue));break;case 30:xb.push(new Sa(Ea));break;case 16:xb.push(new U(Ea,
this.nue));xb.push(new ac(fc,Ea,pb,fc.paneType));break;case 11:case 12:xb.push(new ib(Ea,11===Gb));break;case 17:xb.push(new N(Ea));break;case 19:xb.push(new N(Ea)),xb.push(new V(fc,Ea,pb,fc.paneType))}fc.l2b=!0};this.$=na;this.gridView=ka.h(na);this.tableManager=ab;this.ZF=new Ma(this.gridView);this.xo=new F(this.gridView);this.gridView.qb&&(this.gridView.qb.$Mg(this.Ipb),this.gridView.qb.update(!1));na.da.Ga(64,this)}get nue(){T.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.mue&&(this.mue={vertical:ub.a.current.io(105),horizontal:ub.a.current.io(106)});return this.mue}dispose(){this.gridView.qb.Pjj(this.Ipb);this.ZF&&(this.ZF.dispose(),this.ZF=null);super.dispose()}}Object(u.a)(hc,"GridHighlightsBehaviorManager",v.a,[]);class Bc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){m.TaskExtensions.Aa(h.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya),na=>{this.ob(this.$.da.za(64)||new hc(this.$,na.result))},this.la,3)}static ka(na){na.da.Ga(149,
new Bc(na))}}Object(u.a)(Bc,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(D,"a",function(){return Qa});const Qa=()=>{c.a.Fa(Bc.ka);c.a.Fa(d.ka)}},1149:function(u,D,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(183),h=a(55);class m{constructor(Qa){this.aqh=Qa}nc(){return!1}executeCommand(Qa,na){Qa=na.command;na=null;switch(Qa){case 1243860697:this.aqh.bTj();break;default:na=d.a(Qa)}return na||h.Task.Ta(!0)}wc(Qa,na){return 1243860697===na.command}Jc(){return!1}}Object(u.a)(m,"SheetDropdownMenuCommandHandler",
null,[165]);class l extends b.a{constructor(Qa){super(Qa)}nd(){this.$.ny(Qa=>{Qa.ygc().then(()=>{f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,32,33,this.Ya),na=>{this.Yc([new m(na.result.LDj)])},this.$.la)})})}static ka(Qa){b.a.Nd(392,new l(Qa))}}Object(u.a)(l,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var v=a(222),t=a(5),z=a(74),r=a(33),n=a(1),w=a(15),B=a(27),A=a(177),y=a(14),x=a(87),F=a(45),I=a(239),L=a(156),X=a(107),P=a(40),G=a(416),C=a(82),H=a(13),J=a(35);class M{constructor(){this.TMe=
new J.a(!0);this.SJc=0}get K8c(){return this.SJc}get navigationButtonsDisabled(){return!!(this.K8c&1)}get operationButtonsDisabled(){return!!(this.K8c&2)}rSg(Qa,na){this.TMe.add(Qa,na);this.JS()}JS(){this.SJc=0;J.a.forEach(this.TMe.Gu,Qa=>{this.SJc=this.K8c|Qa.value})}}Object(u.a)(M,"SheetTabBarDisabledStateManager",null,[]);var S=a(238),W=a(31);class O{}O.Pzh="ewa-stb-uir";O.OSe="ewa-stb-drag";O.zzh="ewa-stb-navarea";O.Azh="ewa-stb-navarea-dimensions";O.Czh="ewa-stb-navbutton";O.uU="cui-disabled";
O.Bzh="ewa-stb-navareaextra";O.Gia="cui-img-container";O.tzh="ewa-stb-contentarea";O.PSe="ewa-stb-left-scrollable";O.$Se="ewa-stb-right-scrollable";O.Nzh="ewa-stb-tabarea";O.Mzh="ewa-stb-sheettabmoveindicator";O.bTe="ewa-stb-tabs";O.QPj="tab-active";O.YPj="tab-inactive";O.XPj="tab-hover";O.Ozh="ewa-stb-tabs-ghost";O.SPj="tab-anchor-text";O.dark="dark";O.light="light";O.RPj="tab-active-text";O.VPj="tab-content-container";O.$Pj="tab-text";O.Fzh="ewa-stb-nsv-inactive";O.Gzh="ewa-stb-nsv-inactive-svg";
O.Dzh="ewa-stb-nsv-active";O.Ezh="ewa-stb-nsv-active-svg";O.pyh="ewa_nsv_margin";O.uzh="ewa-stb-disable-scrollbar";O.zzi="leave-size-fixed-on-tab-hover-old";O.yzi="leave-size-fixed-on-tab-hover";O.TSe="ewa-stb-locked-sheet";O.USe="ewa-stb-locked-sheet-svg-16px";O.vzh="ewa-stb-dropdown-menu-button";O.ruh="ewa-active-sheet-menu-item";Object(u.a)(O,"CssClassNames",null,[]);var T=a(732),Y=a(19),va=a(259),ca=a(101),V=a(188),ra=a(247),N=a(46),ea=a(286),Ba=a(53),ka=a(12),Ka=a(71),Oa=a(318),wa=a(11),qa=a(99),
aa=a(347),ia=a(21),Ha=a(191),Z=a(372),la=a(369),Xa=a(44),Za=a(224),xa=a(85);class fa extends S.a{constructor(Qa,na,ab=!1){super(Qa);this.ubb=this.fta=null;this.$=na;this.XX=ab}get disabled(){return this.XX}dispose(){this.ubb=this.fta=this.$=null;super.dispose()}FS(Qa){this.XX=Qa;this.domElement.setAttribute(t.a.Tsa,Qa.toString());ka.DOMElementExtensions.toggleCssClass(this.domElement,T.a.uU,Qa)}}Object(u.a)(fa,"SheetBarButton",S.a,[]);var ua=a(708);class sa extends fa{constructor(Qa,na,ab,Gb=!1){super(document.createElement("a"),
na,Gb);this.hd=fc=>{this.disabled||this.$.Xc(-1935155518,fc.tb,30,null);return!0};this.tGb=fc=>{fc="mouseover"===fc.type||"focus"===fc.type;const pb=Z.a(this.$)?this.ubb:this.fta;wa.HelperMethods.LZd(pb,this.Sha,this.Sha+t.a.agc,fc&&!ia.h(this.$).inRangePicker)};this.rh=()=>{this.FS(!0)};this.Nf=()=>{this.FS(!1)};this.Sha=n.EwaSettings.ma(496)?Y.a.Jad:Y.a.KTe;this.fta=ab.pb(this.domElement,H.a.instance.ga(509),0,this.Sha,H.a.instance.ga(510),ua.a.$3c,Gb);Qa.appendChild(this.domElement);this.Gc.ka("contextmenu",
fc=>{Ka.g(fc)});n.EwaSettings.ma(496)||(this.Gc.ka("mouseover",this.tGb),this.Gc.ka("mouseout",this.tGb));Za.a.instance.ta(y.a.click,this.domElement,this.hd);this.Kla=X.KeyInputManager.instance.Ms(this.domElement,this.hd,xa.a.Sh,xa.a.B1);ia.h(this.$).fc.Xk(this.rh);ia.h(this.$).fc.sm(this.Nf)}dispose(){Za.a.instance.Ba(y.a.click,this.domElement,this.hd);X.KeyInputManager.instance.Vv(this.domElement,this.Kla);ia.h(this.$)&&ia.h(this.$).fc&&(ia.h(this.$).fc.Fk(this.rh),ia.h(this.$).fc.Il(this.Nf));
super.dispose()}FS(Qa){const na=sa.g7f(this.$);super.FS(Qa||na)}static g7f(Qa){return!Qa.isEditMode||!Qa.xa.count}}Object(u.a)(sa,"InsertSheetButton",fa,[]);class sb extends fa{constructor(Qa,na,ab){super(document.createElement("a"),na);this.hd=Gb=>{this.$.Xc(-684145703,Gb.tb,0,null);return!0};this.tGb=Gb=>{wa.HelperMethods.LZd(this.wze,this.Sha,this.Sha+t.a.agc,("mouseover"===Gb.type||"focus"===Gb.type)&&!ia.h(this.$).inRangePicker)};this.$=na;this.Sha=n.EwaSettings.ma(496)?Y.a.Jad:Y.a.KTe;this.wze=
ab.pb(this.domElement,H.a.instance.ga(511),0,this.Sha,H.a.instance.ga(512),ua.a.$3c);Qa.appendChild(this.domElement);this.Gc.ka("contextmenu",Gb=>{Ka.g(Gb)});this.Gc.ka("mouseover",this.tGb);this.Gc.ka("mouseout",this.tGb);Za.a.instance.ta(y.a.click,this.domElement,this.hd);this.Kla=X.KeyInputManager.instance.Ms(this.domElement,this.hd,xa.a.Sh,xa.a.B1)}dispose(){Za.a.instance.Ba(y.a.click,this.domElement,this.hd);X.KeyInputManager.instance.Vv(this.domElement,this.Kla);this.wze=null;super.dispose()}}
Object(u.a)(sb,"InsertTemplateButton",fa,[]);class hb{constructor(Qa,na){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Qa;this.newSheetIndex=na}getSheetName(){return this.sheetName}}Object(u.a)(hb,"MacroRecorderSheetReorderedPayload",null,[125]);var bb=a(91);class lb extends S.a{constructor(Qa,na){super(document.createElement("div"));this.IR=()=>{w.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.MWf(!1,"OnSheetsChanged")};this.cRi=()=>{this.Kj()};this.bRi=()=>{this.$j()};
this.$=Qa;this.tQj=na;this.WU=!1;this.yPb=0}dispose(){this.$j();super.dispose()}bTj(){this.MWf(!0,"TogglerSheetDropdownMenu")}MWf(Qa,na){w.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${na}, toggle: ${Qa}, toggleStateId: ${this.yPb}`);Qa&&(this.yPb+=1);const ab=this.$.Jb.Ac("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${na}, toggle: ${Qa}, toggleStateId: ${this.yPb}, sheetCount: ${this.$.xa.count}`);Qa=this.Tgh();appChrome.renderSheetDropdownMenu(this.domElement,
this.tQj,Qa,this.yPb,this.cRi,this.bRi,()=>{ab.stop()},Z.a(this.$))}Tgh(){const Qa=this.$.xa,na=[];for(let Gb=0;Gb<Qa.count;Gb++){var ab=Object(C.a)(qa.a,Qa.getItem(Gb));0===ab.ZB&&(ab=this.Sgh(ab),na.push(ab))}return na}Sgh(Qa){const na={};na.key=Qa.name;na.text=Qa.name;na.onClick=this.Ugh(Qa);Qa.active&&(na.className=Z.a(this.$)?"ewa-active-sheet-menu-item-present-mode":O.ruh);return na}Ugh(Qa){return()=>{const na=new bb.a(-1876836819,0,this.$.Hc,30,null);this.$.Ka.Lb(na,{[t.a.LTd]:Qa.name})}}Kj(){if(!this.WU){const Qa=
this.$.xa;Qa.Uf(this.IR);Qa.kXc(this.IR);Qa.GY(this.IR);Qa.oha(this.IR);Qa.NGa(this.IR);Qa.Jre(this.IR);Qa.NZa(this.IR);this.WU=!0}}$j(){if(this.WU){const Qa=this.$.xa;Qa.Bg(this.IR);Qa.fMd(this.IR);Qa.z7(this.IR);Qa.Ena(this.IR);Qa.yRa(this.IR);Qa.LVf(this.IR);Qa.dKb(this.IR);this.WU=!1}}}Object(u.a)(lb,"SheetDropdownMenu",S.a,[610,2]);var Fa=a(351);class Na extends fa{constructor(Qa,na,ab){super(document.createElement("a"),Qa,!0);this.rg=()=>{this.FS(!1);this.$.ea.lo(this.rg)};this.hd=Gb=>{this.keg(Gb.tb);
return!0};this.onKeyDown=Gb=>13===Gb.Ca.keyCode||32===Gb.Ca.keyCode?(this.keg(Gb.tb),!0):!1;this.fta=na.pb(this.domElement,H.a.instance.ga(513),0,Y.a.szh,H.a.instance.ga(513),ua.a.b9h,this.disabled);this.domElement.classList.add(O.vzh);ab.appendChild(this.domElement);this.fsh();this.lfj()}dispose(){this.GXj();super.dispose()}FS(Qa){super.FS(Qa||!this.$.ea.ila)}fsh(){const Qa=this.$.ea;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7308390_FixSheetDropdownMenuAnchorDisabled")?Qa.qg?this.FS(!1):Qa.Kk(this.rg):
Qa.Kk(this.rg)}keg(Qa){this.disabled||(w.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${Fa.a[Qa]}`),this.$.Ka.Lb(new bb.a(1243860697,Qa,this.$.Hc,30,null)))}lfj(){Za.a.instance.ta(y.a.click,this.domElement,this.hd);X.KeyInputManager.instance.ta(y.a.Ob,this.domElement,this.onKeyDown)}GXj(){Za.a.instance.Ba(y.a.click,this.domElement,this.hd);X.KeyInputManager.instance.Ba(y.a.Ob,this.domElement,this.onKeyDown)}}Object(u.a)(Na,"SheetDropdownMenuAnchor",fa,[]);var Mb=
a(60);const dc=(Qa,na,ab,Gb,fc,pb,Ea,xb=null)=>{xb=Qa.Na(9,xb);xb.sheetName=na;xb.newSheetIndex=ab;return Mb.g(Qa,"ReorderSheets",xb,Gb,fc,pb,Ea,0)};var Cb=a(172),Tb=a(128),Jb=a(187),eb=a(132),za=a(59),ha=a(208),fb=a(198),rb=a(166),pa=a(133);class Ma{constructor(Qa,na,ab){this.Am=na;this.Nw=ab;this.sheet=Qa;this.altText=H.a.instance.ga(1984)}NK(){return this.sheet.active}frd(){return this.sheet.isLockPausedInSession}uta(){return this.Am?Y.a.SSe:this.NK()?Y.a.RSe:Y.a.QSe}Poa(){return this.sheet.ki?
ua.a.jPf:ua.a.tXj}pYd(){return 16}eia(){return null}vta(){return this.Am?this.Nw?O.USe:O.TSe:null}VZd(){return null}Us(){return null}lnd(){return 0}NYc(){return!0}}Object(u.a)(Ma,"LockPausedSheetIconDataSource",null,[630]);class Ja{constructor(Qa,na,ab){this.Am=na;this.Nw=ab;this.sheet=Qa;this.altText=H.a.instance.ga(1983)}NK(){return this.sheet.active}frd(){return this.sheet.ki}uta(){return this.Am?Y.a.SSe:this.NK()?Y.a.RSe:Y.a.QSe}Poa(){return ua.a.jPf}pYd(){return 16}eia(){return null}vta(){return this.Am?
this.Nw?O.USe:O.TSe:null}VZd(){return null}Us(){return null}lnd(){return 0}NYc(){return!0}}Object(u.a)(Ja,"LockedSheetIconDataSource",null,[630]);class Ga{constructor(Qa,na,ab,Gb){this.sheet=Qa;this.altText=H.a.instance.ga(1897);this.pTj=na;this.c8f=ab;this.Nw=Gb}NK(){return this.sheet.active}frd(){return this.sheet.Ed.Iv}eia(){return this.Nw?this.NK()?O.Ezh:O.Gzh:this.NK()?O.Dzh:O.Fzh}uta(){return!this.NK()&&this.c8f()?Y.a.sBh:Y.a.rBh}Poa(){return!this.NK()&&this.c8f()?ua.a.VDj:ua.a.UDj}pYd(){return 14}vta(){return O.pyh}VZd(){return this.sheet.Ed.Onb}Us(){return this.pTj}lnd(){return 8}NYc(){return!1}}
Object(u.a)(Ga,"NamedSeetViewSheetIconDataSource",null,[630]);var La=a(157),nb=a(127);class Lb{constructor(Qa,na){this.hra=this.Y1=this.ZBa=this.Fl=null;this.Tkf=!1;this.ETc=this.Poa=this.vta=this.eia=this.uta=null;this.fO=()=>{this.dataSource.NK()&&f.TaskExtensions.Aa(this.yDb,()=>{dialogControls.renderToolTip(this.dataSource.Us(),"SheetIconTooltip",this.dataSource.VZd(),this.$I,10,!1,!1,1)},this.$.la,3)};this.eO=()=>{this.dataSource.NK()&&this.clearToolTip()};this.$=Qa;this.dataSource=na;this.Nw=
r.a.Osd()}get Gc(){return this.Y1||(this.Y1=nb.a.instance.Zd(this.$I))}get yDb(){if(this.hra)return this.hra;const Qa=new La.a;this.$.ny(na=>{f.TaskExtensions.Aa(na.iwd(),()=>{Qa.setResult(!0)},this.$.la,3)});return this.hra=Qa.task}get $I(){return this.ETc}Aig(){if(this.$I&&(this.Fl||this.ZBa)){if(this.Nw){var Qa=this.dataSource.Poa();this.Poa!==Qa&&(this.ZBa&&this.ZBa.parentNode.removeChild(this.ZBa),this.hff(),this.Poa=Qa)}else Qa=this.dataSource.uta(),this.uta!==Qa&&(this.iNd(this.Fl,this.uta,
Qa),this.uta=Qa);Qa=this.dataSource.eia();this.eia!==Qa&&(this.Nw?this.nmj(this.ZBa,this.eia,Qa):this.iNd(this.Fl,this.eia,Qa),this.eia=Qa);Qa=this.dataSource.vta();this.vta!==Qa&&(this.iNd(this.$I,this.vta,Qa),this.vta=Qa);this.dataSource.Us()&&!this.dataSource.NK()&&this.clearToolTip()}}EIj(Qa,na,ab){this.Fii(Qa,na,ab);ka.DOMElementExtensions.setVisible(this.$I,this.dataSource.frd())}clearToolTip(){f.TaskExtensions.Aa(this.yDb,()=>{dialogControls.clearToolTip(this.dataSource.Us())},this.$.la,3)}Fii(Qa,
na,ab){this.$I&&this.Tkf!==Qa&&(this.$I.parentNode.removeChild(this.$I),this.vta=this.eia=this.Poa=this.uta=this.ETc=null,this.dataSource.Us()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.$I||(this.ETc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.$I,T.a.Gia),Sys.UI.DomElement.addCssClass(this.$I,Y.a.Rx),n.EwaSettings.ma(496)?Qa===this.dataSource.NYc()?na.appendChild(this.$I):na.insertBefore(this.$I,ab):Qa?na.insertBefore(this.$I,ab):na.appendChild(this.$I),
this.Nw?this.hff():(this.Fl=document.createElement("img"),this.Fl.tabIndex=-1,this.Fl.alt=this.dataSource.altText,this.$I.appendChild(this.Fl),this.Fl.src=Ba.a.Ge(this.dataSource.lnd())),this.dataSource.Us()&&(this.Gc.ka("mouseover",this.fO,!0),this.Gc.ka("mouseout",this.eO,!0)),this.Tkf=Qa)}nmj(Qa,na,ab){Qa&&(Sys.UI.DomElement.removeCssClass(Qa,na),Sys.UI.DomElement.addCssClass(Qa,ab))}iNd(Qa,na,ab){na&&Sys.UI.DomElement.removeCssClass(Qa,na);ab&&Sys.UI.DomElement.addCssClass(Qa,ab)}dispose(){x.a.Ia(this.Y1)}hff(){const Qa=
this.$.da.za(388);Qa?(this.ZBa=Qa.qka(this.dataSource.Poa(),this.dataSource.pYd()))?this.$I.appendChild(this.ZBa):w.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Poa()} was not found.`):w.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(u.a)(Lb,"SheetIcon",null,[2]);var ac=a(352),ib=a(94),Ra=a(153);class ya extends ib.a{constructor(Qa,na){super(Qa.domElement);this.onKeyDown=ab=>
{121===ab.keyCode&&ab.shiftKey&&!this.soa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.soa.anchor),Ka.g(ab))};this.Wca=ab=>{if(!this.$.isEditMode||this.soa.disabled)return!0;this.rename(!1,ab.tb);return!0};this.am=ab=>this.soa.disabled?!0:this.showContextMenu(ab.clientPoint,ab.tb,ab.Gb);this.Pke=Qa;this.$=na;Za.a.instance.ta(y.a.Bk,Qa.domElement,this.Wca);ac.a.instance.ta(Qa.domElement,this.am);this.Gc.ka("keydown",this.onKeyDown)}get soa(){return this.Pke}dispose(){this.soa&&(Za.a.instance.Ba(y.a.Bk,
this.soa.domElement,this.Wca),ac.a.instance.Ba(this.soa.domElement,this.am),this.Pke=null);this.$=null;super.dispose()}showContextMenu(Qa,na,ab){this.soa.activate(na,r.a.Atd());na=new bb.a(-1075099431,na,this.$.Hc,30,null);let Gb;return!Ra.a(Gb=this.$.Ka.Lb(na,{[t.a.H6f]:Qa,[ya.MDj]:this.soa.sheet,[t.a.I6f]:ab}))&&(6!==Gb.status||Gb.result)}rename(Qa,na){this.$.Xc(817296323,na,Qa?19:0,null)}}ya.MDj="Sheet";Object(u.a)(ya,"SheetOpsSheetClickHelper",ib.a,[]);var Va=a(41);class oa extends fa{constructor(Qa,
na,ab,Gb,fc,pb,Ea){super(document.createElement("li"),Qa);this.y3c=this.x3c=this.G6f=this.F6f=0;this.Y6c=.5;this.WU=this.JTd=!1;this.color=this.EJc=this.hF=this.VEb=this.aP=null;this.ujc=this.Ljf=!1;this.g7b="#BEBBB8";this.aHc=null;this.onKeyDown=xb=>13!==xb.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Uz=xb=>32!==xb.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.fO=()=>{this.disabled||(this.tS.YZi(this),this.tS.UF||this.koa(!0,void 0,"OnMouseOver"))};this.eO=()=>{this.disabled||
this.koa(!1,void 0,"OnMouseOut")};this.sGb=()=>{this.tS.UF||(this.cNj(),this.sheet.a1||ia.h(this.$).KKb(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.S6=()=>{this.TPe(!1);return!1};this.hd=xb=>{if(this.disabled)return!0;const bc=ia.h(this.$);this.sheet.active||3!==xb.tb?this.Am?this.activateSheet(xb.tb):r.a.Atd()&&bc.focus():(!r.a.cOa(this.$)&&!this.gCb||bc.eb||bc.ri||bc.Itb(),this.activateSheet(xb.tb));return 3!==xb.tb};this.onPointerDown=xb=>{if(this.disabled)return!0;this.TPe(!0);
ia.h(this.$).inRangePicker&&w.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var bc=3===xb.tb;if(2===xb.tb||bc&&this.Uxa)this.Am?(this.koa(!0,!bc,"OnPointerDown"),bc=h.Task.delay(bc?this.G6f:this.F6f).jp(()=>!0)):bc=this.activateSheet(xb.tb),this.zBb&&(this.ujc=!0,this.tS.xvc=f.TaskExtensions.Aa(bc,()=>{this.ujc&&this.tS.$Zi(this,xb)},this.la,11));return!1};this.Of=xb=>{if(this.disabled||!this.zBb&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;
const bc=this.tS.UF&&!r.a.dkf();this.ujc=!1;this.Am&&this.koa(2===xb.tb,void 0,"OnPointerUp");this.tS.xvc&&(f.TaskExtensions.Aa(this.tS.xvc,()=>{this.tS.ZZi(this)},this.la,11),this.tS.xvc=null);return bc};this.jO=()=>{this.ujc=!1;this.JTd||this.koa(!1,void 0,"OnTouchMove");return!1};this.CDe=new ya(this,Qa);this.Am=pb;this.Nw=Ea;this.gCb=r.a.gCb(Qa);this.bqd=n.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.Nw;this.Am?(this.F6f=Qa.va.SheetDragReorderDelayInMilliseconds,
this.G6f=Qa.va.SheetDragReorderDelayInMillisecondsForTouch,this.x3c=18,this.y3c=20):(this.x3c=19,this.y3c=22);this.$=Qa;this.jYb=Gb;this.tS=fc;this.zBb=fc.Fte();this.dhh();this.Xah();this.Lmd=Qa.Jb.Ng("UserAction",this.name);this.erd=!1;ka.DOMElementExtensions.Pu(this.domElement,t.a.es,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.hF);this.qoa=new Jb.a;Qa=new Ja(this.sheet,this.Am,this.Nw);this.qoa.add(new Lb(this.$,Qa));this.$.ea.eNb&&(Qa=new Ma(this.sheet,this.Am,
this.Nw),this.qoa.add(new Lb(this.$,Qa)));this.bqd||(Qa=new Ga(this.sheet,this.tS.dzc,()=>this.color?oa.SUd(this.color):!1,this.Nw),this.VEb=new Lb(this.$,Qa),this.qoa.add(this.VEb));this.Uxa=this.tS.Uxa;this.Ngb();this.Bgj();this.Eye=new ea.a(this.domElement,1);na.insertBefore(this.domElement,ab);Z.a(this.$)&&this.vjg(!0)}get Gkh(){return this.EJc||(this.EJc=fb.a.xp("#F5F5F5"))}get name(){return this.aP.innerText}set name(Qa){this.aP&&(this.aP.innerText=Qa,this.ADc(),this.wjg())}get sheet(){return this.jYb}get anchor(){return this.aHc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Qa){this.anchor.tabIndex=
Qa}lWh(){return ka.DOMElementExtensions.Ff(this.anchor)?this.anchor:null}dispose(){if(this.WU){I.a.instance.Ba(y.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.Ba(y.a.Ob,this.domElement,this.onKeyDown);X.KeyInputManager.instance.Ba(y.a.Ip,this.domElement,this.Uz);Za.a.instance.Ba(y.a.click,this.domElement,this.hd);I.a.instance.Ba(y.a.sW,this.domElement,this.sGb);I.a.instance.Ba(y.a.Jy,this.domElement,this.S6);if(this.zBb||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.Ba(y.a.Pf,
this.domElement,this.Of),this.Uxa&&(L.a.instance.Ba(y.a.we,this.domElement,this.Of),L.a.instance.Ba(y.a.Yf,this.domElement,this.jO));this.WU=!1;this.g7b="#BEBBB8"}x.a.qc([this.CDe,this.Eye]);this.aP=this.hF=this.aHc=this.tS=this.Eye=this.CDe=null;if(this.qoa){for(let Qa of this.qoa)Qa.dispose();this.qoa=null}this.color=this.jYb=null;super.dispose()}FS(Qa){Qa&&this.koa(!1,!1);super.FS(Qa)}zVd(Qa){if(za.a.yg.iR){this.$Me();var na=e.GetServiceTaskFactory.Oa(this.$.da,322,323,1);f.TaskExtensions.Aa(na,
ab=>{Cb.UISurfaces.QH().then(Gb=>{const fc=ab.result;fc.Wzj(Gb);fc.show(Qa);return null},Gb=>{w.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Gb}`);return null})},this.la,3)}}mqe(){if(this.sheet.active&&this.$.yr){var Qa=this.$.yr,na=ia.h(this.$),ab=na.lk;if(this.sheet.Ed.Iv){if(!this.VEb){var Gb=new Ga(this.sheet,this.tS.dzc,()=>this.color?oa.SUd(this.color):!1,this.Nw);this.VEb=new Lb(this.$,Gb);this.qoa.add(this.VEb)}ab&&na.Dgb(1);
Qa.classList.add(Y.a.nVe);Qa=oa.Fhd(t.a.Gwf);na=oa.Fhd(t.a.mAd);ab=oa.Fhd(t.a.xwf);Gb=this.sheet.Ed.EUd;this.sheet.Ed.EUd=!1;"true"===ab&&Gb&&this.$.ea.HUd?(Tb.a.Rv(t.a.xwf,"false",Tb.a.ZV),this.$.ea.HUd=!1,this.zVd(3)):"true"===Qa&&"true"===na&&"true"===ab?this.$.ea.IUd&&this.$.ea.ANb&&(this.sheet.Ed.iI?(Qa=1,Tb.a.Rv(t.a.mAd,"false",Tb.a.ZV),this.$.ea.ANb=!1):Qa=0,Tb.a.Rv(t.a.Gwf,"false",Tb.a.ZV),this.$.ea.IUd=!1,this.zVd(Qa)):this.sheet.Ed.iI&&"true"===na&&"true"===ab&&this.$.ea.ANb&&(Tb.a.Rv(t.a.mAd,
"false",Tb.a.ZV),this.$.ea.ANb=!1,this.zVd(2))}else this.$Me(),ab&&na.Dgb(0),Qa.classList.remove(Y.a.nVe)}}$Me(){const Qa=this.$.da.za(322);Qa&&Qa.dismiss()}Ngb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.U7a()?O.QPj:O.YPj;n.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.aP.parentNode.classList.add(O.yzi):this.aP.parentNode.classList.add(O.zzi);this.wjg();this.bqd&&this.mqe();this.FIj();this.Djg();this.ADc();this.bqd||this.mqe()}XZi(){this.JTd=
!0;this.koa(!0,!0,"OnSheetReorderStarted")}WZi(){this.JTd=!1;this.koa(!1,void 0,"OnSheetReorderEnded")}activate(Qa=0,na=!1){this.Y3b()||(this.sheet.activate(),na&&ia.h(this.$).focus(),Qa={["InputMethod"]:Fa.a[Qa],["AppMode"]:this.$.Hc,["Location"]:"canvas"},pa.b(this.$).Gd(eb.a.IDj,Qa))}vjg(Qa){this.g7b=Qa?"#797775":"#BEBBB8";this.Y6c=Qa?-.5:.5;this.EJc=Qa?fb.a.xp("#3B3A39"):fb.a.xp("#F5F5F5");this.Djg()}Nwj(Qa){this.zBb=Qa}QCd(Qa){Qa.q4c();this.SBe(Qa)}SBe(Qa){Qa.w1a();this.sheet.activate()}vHg(Qa){Qa=
new bb.a(-1876836819,Qa,this.$.Hc,30,null);return this.$.Ka.Lb(Qa,{[t.a.LTd]:this.sheet.name})}wjg(){this.aP.parentNode.setAttribute("sheet-title",this.aP.innerText)}ADc(){const Qa=this.BPh();this.anchor.setAttribute(t.a.nv,Qa);this.anchor.setAttribute(t.a.Bha,this.sheet.active.toString())}BPh(){const Qa=this.sheet.Ed.Iv,na=this.sheet.Ed.Onb,ab=this.sheet.ki,Gb=this.sheet.isLockPausedInSession;return Qa&&ab?String.format(H.a.instance.nb(20),this.name,na):Qa&&Gb?String.format(H.a.instance.nb(22),this.name,
na):Qa?String.format(H.a.instance.nb(19),this.name,na):ab?String.format(H.a.instance.nb(18),this.name):Gb?String.format(H.a.instance.nb(21),this.name):this.name}activateSheet(Qa=0){if(r.a.Atd()){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Y3b())return h.Task.Ta(!1);rb.a.current.kS="ActivateSheet";this.sheet.activate();return h.Task.Ta(!0)}return this.vHg(Qa)}Djg(){const Qa=this.sheet.tabColor;this.color=Qa?fb.a.xp(Qa):this.Gkh;this.Ljf=oa.SUd(this.color);
this.koa(!1,void 0,"UpdateTabColor")}koa(Qa,na=!1,ab=null){if(this.sheet){ab=this.sheet.active;var Gb=this.U7a(),fc=!!this.sheet.tabColor,pb=fb.a.EG(ab||Gb?ha.a.white:this.color);this.hF.style.background="";ab||Gb?(fc?n.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.uMa?this.MBj():this.Am?this.LBj():this.KBj():this.Am||(this.hF.style.backgroundColor=pb),this.hF.style.height=this.x3c.toString()+"px"):(this.hF.style.filter="",this.hF.style.backgroundColor=
pb,this.hF.style.height=this.y3c.toString()+"px");this.aP.className=ab?O.RPj:Gb?O.dark:this.Ljf?O.light:O.dark;for(let Ea of this.qoa)Ea.Aig();this.Am&&(Qa&&!fc&&(this.hF.style.backgroundColor="#E1DFDD"),ka.DOMElementExtensions.toggleCssClass(this.domElement,O.XPj,Qa),na?(fc||(this.hF.style.backgroundColor=this.g7b),this.domElement.style.backgroundColor=this.g7b):(fc||(this.hF.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.aP.style.fontWeight=ab||Gb||!this.Am&&Qa?this.Am?
"600":"bold":""}else w.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${ab}`)}LBj(){const Qa=this.hF.style,na=fb.a.EG(oa.R1c(this.color,this.Y6c));Qa.background=na}KBj(){const Qa=this.hF.style,na=fb.a.EG(oa.R1c(this.color,1)),ab=fb.a.EG(oa.R1c(this.color,this.Y6c));Qa.background=`$linear-gradient(${na}, ${ab})`}MBj(){this.hF.style.background="transparent"}Xah(){this.aHc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=O.SPj;ka.DOMElementExtensions.Pu(this.anchor,t.a.vpb,null,null);this.tabIndex=-1}dhh(){this.hF=document.createElement("span");this.hF.className=O.VPj;this.aP=document.createElement("span");this.aP.className=O.$Pj;this.aP.dir=this.sheet.rtlName?"rtl":"ltr";this.hF.appendChild(this.aP)}FIj(){const Qa=this.$.HJ;for(let na of this.qoa)na.EIj(Qa,this.hF,this.aP)}U7a(){return ia.h(this.$).U7a(this.sheet)}cNj(){this.Lmd.start();this.erd=!0}TPe(Qa){this.erd&&
(this.Lmd.stop(),w.ULS.sendTraceTag(537153686,0,50,Va.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Lmd.zc,["Has been clicked"]:Qa})),this.erd=!1)}Bgj(){I.a.instance.ta(y.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.ta(y.a.Ob,this.domElement,this.onKeyDown);X.KeyInputManager.instance.ta(y.a.Ip,this.domElement,this.Uz);this.Gc.ka("mouseover",this.fO);this.Gc.ka("mouseout",this.eO);I.a.instance.ta(y.a.sW,this.domElement,
this.sGb);I.a.instance.ta(y.a.Jy,this.domElement,this.S6);if(this.zBb||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.ta(y.a.Pf,this.domElement,this.Of),this.Uxa&&(L.a.instance.ta(y.a.we,this.domElement,this.Of),L.a.instance.ta(y.a.Yf,this.domElement,this.jO));Za.a.instance.ta(y.a.click,this.domElement,this.hd);this.WU=!0}Y3b(){const Qa=this.$.da.za(65);return Qa&&Qa.jla()?(Qa.Nwc(),this.SBe(Qa),!0):!1}static Fhd(Qa){let na=Tb.a.get(Qa);na||(Tb.a.Rv(Qa,
"true",Tb.a.ZV),na=Tb.a.get(Qa));return na}static R1c(Qa,na){if(1<na||-1>na)return Qa;let ab=Qa.r,Gb=Qa.g;Qa=Qa.b;0<na?(ab=ab*(1-na)+255*na,Gb=Gb*(1-na)+255*na,Qa=Qa*(1-na)+255*na):(ab*=1+na,Gb*=1+na,Qa*=1+na);return ha.a.Yvb(Math.round(ab),Math.round(Gb),Math.round(Qa))}static SUd(Qa){return 128>=(222*Qa.r+707*Qa.g+71*Qa.b)/1E3}}Object(u.a)(oa,"SheetTabButton",fa,[]);class kb extends fa{constructor(Qa,na,ab){super(document.createElement("a"),na);this.Sha=n.EwaSettings.ma(496)?Y.a.Jad:Y.a.LAh;ab.pb(this.domElement,
H.a.instance.ga(713),0,this.Sha,H.a.instance.ga(713),ua.a.$3c,!0);Qa.appendChild(this.domElement);this.Gc.ka("contextmenu",Gb=>{Ka.g(Gb)})}}Object(u.a)(kb,"WorkbookProtectionButton",fa,[]);var Sa=a(51),U=a(39),ta=a(57);class ub extends S.a{constructor(Qa,na,ab=null,Gb=null){super(na);this.sheetTabActivatePreviousHidden=H.a.instance.ga(722);this.sheetTabActivateNextHidden=H.a.instance.ga(724);this.svgIconProvider=null;this.xh=[];this.cL=Array(6);this.xAd=Array(6);this.fTa=this.Lzb=this.XH=this.gzc=
this.teb=this.izc=this.QTd=this.jl=null;this.isRtl=!1;this.RK=this.wv=0;this.W8b=this.wvc=!1;this.isc=this.Wna=0;this.YM=this.h4=this.Aaa=this.f9b=null;this.wec=this.uD=0;this.LOb=null;this.DCb=-1;this.pZ=null;this.jrc=0;this.QAc=-1;this.pna=0;this.xua=new M;this.HNc=!1;this.xvc=this.jzc=this.gNb=this.Lke=this.a0=null;this.Sce=!1;this.Ind=null;this.Nzd=!1;this.htmlSanitizationHelper=this.Kke=null;this.PD=(fc,pb)=>{this.hIf(pb.item)};this.Hza=(fc,pb)=>{fc=this.$.xa.na.index;for(let Ea=0,xb=this.xh.length;Ea<
xb;Ea++){const bc=this.SQ(Ea);if(bc.name===pb.oldName){bc.name=pb.newName;this.z0();Ea===fc&&this.M0(6);break}}};this.lIf=(fc,pb)=>{(fc=this.U3a(pb.item))&&fc.Ngb()};this.mIf=(fc,pb)=>{pb.visible?(this.XSa(!1),this.iIf(pb.item)):this.hIf(pb.item)};this.$N=fc=>{this.UF?(this.pZ=fc,this.mQb()):(this.pZ&&(this.isc+=this.pZ.clientPoint.x-fc.clientPoint.x),this.pZ=fc,Math.abs(this.isc)>=this.Tph&&this.mQb());return!0};this.jO=fc=>{fc.Ca.preventDefault();return!1};this.Y0f=fc=>{this.U0f(fc,!0)};this.X0f=
fc=>{this.U0f(fc,!1)};this.O6=fc=>{if(this.UF&&(this.Kz||this.gmf(fc)))if(this.W8b=this.iif(fc),this.Kz){let pb;fc=(pb=this.SQ(this.uD+1))?pb.sheet:null;this.reorderSheets(fc,this.uD+1===this.OTd,!0)}else fc=this.Nzd?null:this.Ind,this.reorderSheets(fc,this.Nzd,!0);this.AQ();return!0};this.Eh=(fc,pb)=>{pb.WD&&this.M1d(pb.WD);this.jyc(!1);this.z0();pb.na&&(this.M1d(pb.na),this.M0(6),this.ea.Uma())};this.Syf=(fc,pb)=>{this.sEc(pb.item)};this.Tyf=(fc,pb)=>{this.sEc(pb.item)};this.Uyf=(fc,pb)=>{this.sEc(pb.item)};
this.MPa=(fc,pb)=>{this.sEc(pb.item)};this.pza=()=>{this.P2c()};this.ed=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.P2c();this.I6c();n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(ta.d(this.$)||ta.e(this.$))&&(U.PageLoadTrackingInfo.instance.bS(t.a.ABa,["sheetTabBar"]),U.PageLoadTrackingInfo.instance.QW(t.a.ABa,["sheetTabBar"]));this.q6c();this.z0();this.XSa(!0);this.M0(6)};this.ij=()=>{this.isVisible&&(this.z0(),this.M0(6))};this.yf=()=>{Object(G.a)(sa,
this.XH)===ca.k(this.$.hg)&&this.q6c();for(const fc of this.xh)fc.Nwj(!ca.k(this.$.hg))};this.kIf=(fc,pb)=>{this.dmj(pb.item,pb.isUserOperation)};this.KGb=(fc,pb)=>{this.iIf(pb.item)};this.onKeyDown=fc=>{switch(fc.keyCode){case 9:var pb=this.domElement.querySelectorAll(ka.DOMElementExtensions.Ir);const Ea=ka.DOMElementExtensions.wm(pb);pb=ka.DOMElementExtensions.tB(pb);ka.DOMElementExtensions.rBa(fc,Ea,pb);break;case 39:case 37:ka.DOMElementExtensions.W3f(fc,this.domElement.querySelectorAll(ka.DOMElementExtensions.Ir),
39===fc.keyCode?!this.isRtl:this.isRtl)}w.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${fc.keyCode}`)};this.onScroll=()=>{this.jl.scrollLeft!==this.Wna&&this.xRj()};this.hO=fc=>{if(fc.ctrlKey||fc.E3)return!1;this.jl.scrollLeft+=Math.floor(30*fc.dDa);if(this.Kz&&this.UF){const pb=this.k3e("OnMouseWheel");pb&&this.sYd(0<fc.dDa,pb.x+pb.width/2)}return!0};this.dG=(fc,pb)=>{if(this.xua)this.T$e("PartialInteractivity",pb.uM?3:0);else{this.AQ(!1);this.qSd(pb.uM);for(const Ea of this.Dxe)Ea&&
Ea.FS(pb.uM);for(const Ea of this.xh)Ea&&Ea.FS(pb.uM)}};this.WFb=(fc,pb)=>{fc=0;pb.Coe&&(fc=2|(pb.NDj?1:0));this.T$e("ComponentRangePicker",fc)};this.$=Qa;this.ea=this.$.ea;this.n9b=(this.Kz=r.a.dkf())&&!n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Am=n.EwaSettings.ma(496);this.Nw=r.a.Osd();this.dmf=this.Am&&!this.$.Lw;this.Kz&&(this.Sce=this.Am&&!B.a.vy);this.hKi=this.$.va.SheetTabNavigateButtonLongKeyPressPeriodMS;this.gKi=this.$.va.SheetTabNavigateButtonIntervalPeriodMS;
this.Tph=this.$.va.SheetTabDragStartPixelThreshold;this.vQa=this.wQa=-1;this.O4c=!1;this.htmlSanitizationHelper=Gb;this.Nw&&(this.svgIconProvider=ab);this.PC=new ea.a(this.domElement,3);this.Am&&this.domElement.classList.add(O.Pzh);this.Meh();this.mch();this.Neh();n.EwaSettings.FN()&&document.getElementById(t.a.yba)||this.Sfh();this.jyc(!0);this.ed(null,null);Qa=this.$.xa;Qa.Uf(this.Eh);Qa.kXc(this.pza);Qa.GY(this.PD);Qa.oha(this.KGb);Qa.NGa(this.Hza);Qa.Jre(this.kIf);Qa.NZa(this.mIf);Qa.lNg(this.lIf);
Qa.vXc(this.Syf);Qa.Gre(this.Tyf);Qa.Hre(this.Uyf);Qa.Ire(this.MPa);this.$.nl(this.ed);this.$.VA(this.ij);va.a(this.$).ai(this);this.$.da.Ga(32,this);n.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.mu(this.yf);this.hzc=this.Be.Zd(this.domElement);this.hzc.ka("keydown",this.onKeyDown);Xa.a(this.$).oq()&&this.dG(null,new la.a(!0));Xa.a(this.$).Xf.k$(this.dG);ia.h(this.$).fre(this.WFb);this.hzc.ka("mousedown",fc=>{fc.preventDefault()});A.a.instance.ta(y.a.HD,
this.domElement,this.hO);this.PTd=this.Be.Zd(this.jl);this.PTd.ka("scroll",this.onScroll);this.xRj=Oa.a(()=>{this.z0()},200,this.$.la,N.a.SDj,!0);this.$.xD(t.a.KKj);this.dmf&&(this.Kke=new lb(this.$,this.fTa.domElement));n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&U.PageLoadTrackingInfo.instance.D0(t.a.ABa,["sheetTabBar"])}get mc(){return this.domElement}get Ff(){return this.isVisible}get de(){return ra.a.NTd}get UF(){return this.HNc}get OTd(){return this.xh.length}get dzc(){return this.Lke}get Uxa(){return this.Sce}get navigationButtonsDisabled(){return!!this.xua&&
this.xua.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.xua&&this.xua.operationButtonsDisabled}get wAd(){return this.Am?this.$.HJ?[Y.a.o$b,Y.a.XSe,Y.a.ZSe,Y.a.n$b,Y.a.gva,Y.a.gva]:[Y.a.n$b,Y.a.ZSe,Y.a.XSe,Y.a.o$b,Y.a.gva,Y.a.gva]:this.$.HJ?[Y.a.o$b,Y.a.WSe,Y.a.YSe,Y.a.n$b,Y.a.gva,Y.a.gva]:[Y.a.n$b,Y.a.YSe,Y.a.WSe,Y.a.o$b,Y.a.gva,Y.a.gva]}get yAd(){return this.$.HJ?[null,ua.a.xFe,ua.a.vFe]:[null,ua.a.vFe,ua.a.xFe]}get NNf(){return this.$.HJ?[null,ua.a.yFe,ua.a.wFe]:[null,ua.a.wFe,
ua.a.yFe]}get iDb(){if(this.isRtl){if(B.a.VF)return 0;if(B.a.fg)return-1*(this.jl.scrollWidth-this.jl.clientWidth);if(B.a.vy)return this.jl.scrollWidth-this.jl.clientWidth;w.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get dLb(){if(this.isRtl){if(B.a.VF)return this.jl.scrollWidth-this.jl.clientWidth;if(B.a.fg||B.a.vy)return 0;w.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.jl.scrollWidth-
this.jl.clientWidth}get Dxe(){return this.xua?[this.XH,this.Lzb]:[this.XH,this.Lzb,this.fTa]}get ZPj(){return this.xh.concat(this.fTa)}get LDj(){return this.Kke}pb(Qa,na,ab,Gb,fc,pb,Ea=!1){Qa.removeAttribute("Href");Qa.setAttribute(t.a.Ld,t.a.ot);Qa.className=O.Czh;Qa.title=na;Qa.tabIndex=0;this.Nw&&pb?ab=this.svgIconProvider.Kba(pb,12,12,Qa,24,24):(na=document.createElement("span"),na.className=this.Am?Y.a.K5g:Y.a.Rx,na.classList.add(T.a.Gia),na.tabIndex=-1,Qa.appendChild(na),pb=document.createElement("img"),
pb.src=Ba.a.Ge(ab),pb.className=Gb,pb.alt=fc,pb.tabIndex=-1,na.appendChild(pb),ab=pb);Ea&&Qa.classList.add(T.a.uU);return ab}dispose(){if(this.$){var Qa=this.$.xa;Qa.Bg(this.Eh);Qa.fMd(this.pza);Qa.z7(this.PD);Qa.Ena(this.KGb);Qa.yRa(this.Hza);Qa.LVf(this.kIf);Qa.dKb(this.mIf);Qa.Wjj(this.lIf);Qa.rMd(this.Syf);Qa.IVf(this.Tyf);Qa.JVf(this.Uyf);Qa.KVf(this.MPa);this.$.Kl(this.ed);this.$.bE(this.ij);Xa.a(this.$)&&Xa.a(this.$).Xf.Rda(this.dG);this.xua&&ia.h(this.$).mVf(this.WFb);A.a.instance.Ba(y.a.HD,
this.domElement,this.hO)}x.a.qc(this.xAd);this.xAd=null;if(this.cL)for(Qa=0;Qa<this.cL.length;Qa++){const na=ka.DOMElementExtensions.vK(this.cL[Qa],this.domElement,!1,"a");na&&F.a.xna(na)}x.a.Ia(this.PC);x.a.Ia(this.hzc);x.a.Ia(this.PTd);this.PTd=this.hzc=this.Lzb=this.XH=this.PC=null;this.$&&this.Kz&&this.AQ(!1);this.Aaa=null;this.IRd(null,"Dispose");this.LOb=this.YM=this.f9b=null;this.P2c();this.teb=this.izc=this.QTd=this.jl=this.cL=this.$=this.ea=null;super.dispose()}gg(Qa,na){if(!na){w.ULS.shipAssertTag(537153760,
0,0<this.xh.length,"There is no sheet tab button.");if(!this.xh.length)return!1;Qa=null;for(const ab of this.xh)if(Qa=ab.lWh())break;if(!Qa)return w.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ka.DOMElementExtensions.setFocus(Qa)}return!na}lh(Qa){return ka.DOMElementExtensions.xf(this.mc,Qa)}sj(){}Wj(){}reorderSheets(Qa,na,ab){if(this.a0&&this.a0!==Qa){const Gb=this.a0.index;this.cmj(this.a0,Qa,na);Qa=Qa?Qa.index-1:na?this.$.xa.count-1:0;Gb!==Qa&&(this.ODi(Gb,Qa,ab),
this.Jsh(this.a0.name,Qa))}}n7h(Qa){Qa=this.tja(Qa);return-1!==Qa&&this.wv<=Qa&&Qa<=this.RK?this.xh[Qa].domElement:null}Y0j(Qa){if(this.Nw){for(var na=0;na<this.cL.length;na++){const ab=this.cL[na];if(ab&&this.svgIconProvider){const Gb=ab.parentNode;this.OUf(ab);Gb&&(this.cL[na]=this.svgIconProvider.Kba(Qa?this.NNf[na]:this.yAd[na],12,12,Gb,24,24))}}for(na=0;na<this.xh.length;na++)this.xh[na].vjg(Qa);this.fTa&&this.fTa.fta&&this.ujg(ua.a.c9h,this.fTa,Qa);this.XH&&this.XH.fta&&this.ujg(ua.a.N7g,this.XH,
Qa)}}ujg(Qa,na,ab){na.ubb||(na.ubb=this.svgIconProvider.Kba(Qa,12,12,na.fta.parentNode,24,24));na.ubb&&(ka.DOMElementExtensions.setVisible(na.fta,!ab),ka.DOMElementExtensions.setVisible(na.ubb,ab))}$Zi(Qa,na){var ab=ia.h(this.$);const Gb=ab.inRangePicker,fc=wa.HelperMethods.Do(na);if(ab.eb&&!Gb){const pb=ab.Vl?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Ea=void 0;n.EwaSettings.X7a&&(Ea=[Object(Ha.a)(ab.fc.textBox.eCa)]);Ha.b(this.$).tCa(fc.rawEvent,pb,Ea);ab.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}ab=this.Uxa&&3===na.tb;!(2===na.tb&&fc.button===Sys.UI.MouseButton.leftButton||ab)||Gb||this.UF||Xa.a(this.$).oq()||(ab&&Qa.XZi(),this.DCb=na.clientPoint.x,this.pZ=na,this.KVg(Qa))}YZi(Qa){!this.Kz&&this.UF&&this.IVd(Qa.sheet,!1)}ZZi(Qa){this.Kz||(this.UF&&this.reorderSheets(Qa.sheet,!1,!0),this.AQ());this.z0()}Fte(){return this.$.isEditMode&&!ca.k(this.$.hg)}z0(){const Qa=wa.HelperMethods.y6(()=>{this.WZj();this.Am&&this.mBj();this.qSd()});w.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Qa}`)}mBj(){const Qa=this.RK===this.xh.length-1;ka.DOMElementExtensions.toggleCssClass(this.teb,this.$.HJ?O.$Se:O.PSe,!!this.wv);ka.DOMElementExtensions.toggleCssClass(this.teb,this.$.HJ?O.PSe:O.$Se,!Qa)}qSd(Qa=!1){const na=!this.wv,ab=this.RK===this.xh.length-1;this.C4f(4,this.sheetTabActivatePreviousHidden,!na);this.C4f(5,this.sheetTabActivateNextHidden,!ab);this.yyc(0,na||Qa);this.yyc(1,na||Qa);this.yyc(2,ab||Qa);this.yyc(3,
ab||Qa)}C4f(Qa,na,ab){if(Qa=this.cL[Qa]){ka.DOMElementExtensions.setVisible(Qa,ab);var Gb=this.T4e(Qa);Gb.title="img"===Qa.nodeName?Qa.alt=0<this.xh.length&&ab?na:"":Qa.title=0<this.xh.length&&ab?na:"";Gb.tabIndex=ab?0:-1}}T4e(Qa){return this.Nw?Qa.parentNode:Qa.parentNode.parentNode}yyc(Qa,na){if(Qa=this.cL[Qa])Qa=this.T4e(Qa),void 0!==Qa&&null!==Qa&&(!this.xh.length||na?(Qa.classList.add(T.a.uU),Qa.setAttribute(t.a.Tsa,"true")):(Qa.classList.remove(T.a.uU),Qa.setAttribute(t.a.Tsa,"false")))}XSa(Qa){const na=
this.$.HJ?this.xh.length-1:0;let ab=this.s7e(this.$.HJ?0:this.xh.length-1);ab&&(ab.borderRightWidth=Qa?"1px":"0");this.wv!==this.RK&&(ab=this.s7e(na))&&(ab.borderRightWidth="0")}zqe(Qa,na){this.xh||(this.xh=[]);-1===na?this.xh.push(Qa):this.xh.splice(na,0,Qa)}A6b(Qa,na){let ab=-1,Gb=null;na||(ab=this.r_h(Qa.index),-1!==ab&&(Gb=this.ILa(ab)));Qa=new oa(this.$,this.jl,Gb,Qa,this,this.Am,this.Nw);this.zqe(Qa,ab);ka.DOMElementExtensions.setVisible(Qa.domElement,!0)}IVd(Qa,na){var ab=this.U3a(Qa);if(ab){this.Ind=
Qa;this.Nzd=na;Qa=ab.domElement;ab=this.isRtl?Qa.offsetLeft+(this.jl.scrollWidth-this.jl.clientWidth-this.jl.scrollLeft):Qa.offsetLeft-this.jl.scrollLeft;if(!this.isRtl&&na||this.isRtl&&!na)ab+=Qa.offsetWidth;this.gzc.style.left=wa.HelperMethods.uc(ab-4);ka.DOMElementExtensions.setVisible(this.gzc,!0)}}hcf(){ka.DOMElementExtensions.setVisible(this.gzc,!1)}M0(Qa){const na=wa.HelperMethods.y6(()=>{switch(Qa){case 0:this.bxc(0);break;case 1:this.bxc(this.wv-1);break;case 2:this.bxc(this.wv+1);break;
case 3:this.scrollIntoView(this.xh.length-1);break;case 4:this.wv&&1<=this.xh.length&&(this.loe(this.wv-1),this.eQd());break;case 5:this.RK!==this.xh.length-1&&1<=this.xh.length&&(this.loe(this.RK+1),this.eQd());break;case 6:this.eQd()}});this.n9b&&this.UF&&this.mQb();w.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Qa}, duration = ${na}`)}loe(Qa){(Qa=this.SQ(Qa))&&Qa.activate()}uIh(Qa){if(0===Qa.ZB){const na=this.$.xa;let ab=0;for(let Gb=0,fc=na.count;Gb<fc;Gb++){const pb=
Object(C.a)(qa.a,na.getItem(Gb));if(pb===Qa)return ab;0===pb.ZB&&ab++}}return-1}hIh(Qa){const na=this.$.xa;for(let ab=Qa.index+1,Gb=na.count;ab<Gb;ab++)if(Qa=Object(C.a)(qa.a,na.getItem(ab)),0===Qa.ZB)return Qa;return null}tja(Qa){for(let na=0;na<this.xh.length;na++){const ab=this.SQ(na);if(!ab)w.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${na}] is null even though index is not out of bounds!`);else if(ab.sheet===Qa)return na}return-1}U3a(Qa){Qa=
this.tja(Qa);return this.SQ(Qa)}ODi(Qa,na,ab){const Gb={};Gb.a=this.$.va.UserSessionId;Gb.b=ab;Gb.c=this.W8b;Gb.d=Qa;Gb.e=na;Gb.f=this.$.xa.count;Sa.b().Pe(2,Gb,ab)}cmj(Qa,na,ab){const Gb=Object(C.a)(aa.a,this.$.xa);na?(na=na.index,na=Qa.index<na?na-1:na):na=ab?Gb.count-1:0;Gb.reorderSheet(Qa,na,!0)}a4f(Qa){ia.h(this.$).Gf.gm(Qa)}KVg(Qa){if(!this.wvc){const na=this.domElement.ownerDocument.body;this.Kz?(I.a.instance.ta(y.a.Ij,document.documentElement,this.$N),this.Uxa&&(L.a.instance.ta(y.a.Yf,document.documentElement,
this.$N),L.a.instance.ta(y.a.Yf,this.domElement,this.jO))):(I.a.instance.ta(y.a.Ij,na,this.$N),L.a.instance.ta(y.a.Yf,na,this.$N));I.a.instance.ta(y.a.Pf,document.documentElement,this.O6);L.a.instance.ta(y.a.we,na,this.O6);this.wvc=!0}this.a0=Qa.sheet;this.W8b=!1;this.Kz?(this.YM=null,this.f9b=Qa,this.Aaa=Qa.domElement,this.IRd(ka.DOMElementExtensions.getBoundingClientRect(this.Aaa),"BeginSheetTabButtonDrag")):(w.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(O.OSe),this.domElement.style.cursor="",this.a4f("pointer"))}AQ(Qa=!0){if(this.wvc){this.a4f(t.a.TQ);const na=this.domElement.ownerDocument.body;this.Kz?(I.a.instance.Ba(y.a.Ij,document.documentElement,this.$N),this.Uxa&&(L.a.instance.Ba(y.a.Yf,document.documentElement,this.$N),L.a.instance.Ba(y.a.Yf,this.domElement,this.jO))):(I.a.instance.Ba(y.a.Ij,na,this.$N),L.a.instance.Ba(y.a.Yf,na,this.$N));I.a.instance.Ba(y.a.Pf,document.documentElement,this.O6);L.a.instance.Ba(y.a.we,
na,this.O6);this.HNc=this.wvc=!1}this.isc=0;this.W8b=!1;this.Ind=this.a0=null;this.Kz?(this.Aaa&&(this.Aaa.style.visibility="visible",this.Aaa=null),this.f9b=null,this.IRd(null,"EndSheetTabButtonDrag"),this.YM&&(this.YM.parentNode&&this.YM.parentNode.removeChild(this.YM),this.YM=null),this.ooj(Qa)):(this.domElement.classList.remove(O.OSe),this.hcf())}ooj(Qa){this.BXd(Qa);this.uD=this.DCb=-1}Jsh(Qa,na){const ab=this.$.pa,Gb=ab?ab.ya:null;this.$.userOperationManager.Kc(new V.a(557,0,(fc,pb,Ea)=>dc(Gb,
Qa,na,fc,pb,Ea,null),64,()=>new hb(Qa,na)),null)}SQ(Qa){return 0<=Qa&&Qa<this.xh.length?this.xh[Qa]:null}r7e(Qa){return(Qa=this.SQ(Qa))?Qa.sheet:null}ILa(Qa){return(Qa=this.SQ(Qa))?Qa.domElement:null}s7e(Qa){return(Qa=this.ILa(Qa))?Qa.style:null}r_h(Qa){const na=this.$.xa;Qa+=1;let ab=-1;const Gb=this.xh?this.xh.length:0;for(;Qa<na.count;){const fc=Object(C.a)(qa.a,na.getItem(Qa));if(0===fc.ZB){for(ab=0;ab<Gb&&this.r7e(ab)!==fc;ab++);break}Qa++}return-1===ab||ab===Gb?-1:ab}hIf(Qa){var na=this.U3a(Qa);
na&&(this.Kz&&this.UF&&(w.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.AQ()),this.jl.removeChild(na.domElement),na=Array.indexOf(this.xh,na),this.xh.splice(na,1),this.z0(),(!this.isRtl&&na===this.xh.length||this.isRtl&&!na)&&this.XSa(!0),this.n9b&&this.UF?Qa===this.a0?(this.AQ(),this.M0(6)):this.mQb():
this.M0(6))}iIf(Qa){const na=Object(C.a)(qa.a,Qa);this.Kz&&this.UF&&(w.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.AQ());if(0===na.ZB){this.XSa(!1);var ab=this.tja(Qa);-1===ab&&(w.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.A6b(na,!1),ab=this.tja(Qa));this.aaf(ab,!0)}}dmj(Qa,na){const ab=this.U3a(Qa);ab&&(this.Kz&&this.UF&&!na&&(w.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),n.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.AQ()),Qa=this.MPj(Qa,ab),!n.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Kz&&Qa&&na&&Qa.WZi())}MPj(Qa,
na){var ab=Array.indexOf(this.xh,na);const Gb=this.uIh(Object(C.a)(qa.a,Qa));if(-1===Gb||-1===ab)return null;ab!==Gb||this.Kz?(this.XSa(!1),{UIh:this.wv,Byi:this.RK}=ub.$lj(ab,Gb,this.wv,this.RK),na&&na.domElement.parentNode===this.jl&&(this.jl.removeChild(na.domElement),this.xh.splice(ab,1)),na=this.hIh(Qa),ab=this.tja(na),na=new oa(this.$,this.jl,this.ILa(ab),Object(C.a)(qa.a,Qa),this,this.Am,this.Nw),this.zqe(na,ab),ab=this.tja(Qa),this.aaf(ab,!1,!this.Am)):na=null;return na}vth(){const Qa=this.xh?
this.xh.length:0,na=this.wv,ab=this.RK;for(let Gb=0;Gb<Qa;Gb++){const fc=this.SQ(Gb),pb=Gb>=na;fc&&(fc.tabIndex=pb&&Gb<=ab?0:-1)}}HYj(){const Qa=this.xh?this.xh.length:0;for(let na=0;na<Qa;na++){const ab=this.SQ(na);ab&&ab.Ngb()}}aaf(Qa,na,ab=!0){na&&Qa<=this.wv&&this.wv++;this.vth();this.XSa(!0);this.z0();this.n9b&&this.UF?this.mQb():ab&&this.M0(6)}jyc(Qa){const na=this.$.HJ;if(Qa||this.isRtl!==na)this.isRtl=na,this.domElement.classList.remove(this.isRtl?Y.a.VSe:Y.a.aTe),this.domElement.classList.add(this.isRtl?
Y.a.aTe:Y.a.VSe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.HYj();Qa||this.XSa(!0);for(Qa=0;Qa<this.cL.length;Qa++)0!==Qa&&3!==Qa&&(!this.Am||4!==Qa&&5!==Qa)&&this.D4f(Qa)}Meh(){const Qa=this.QTd=document.createElement("div");Qa.className=O.zzh;this.Am&&Qa.classList.add(O.Azh);this.domElement.appendChild(Qa);this.u6b(Qa,1,717,716);this.u6b(Qa,2,719,718);this.dmf&&(this.fTa=new Na(this.$,this,Qa));this.Am||this.u6b(Qa,4,723,722)}Neh(){const Qa=this.izc=document.createElement("div");Qa.className=
O.Bzh;this.domElement.appendChild(Qa);this.Am||this.u6b(Qa,5,725,724);this.q6c()}Sfh(){const Qa=document.getElementById(t.a.JDj),na=document.getElementById(t.a.KDj);Qa&&!na&&w.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Qa.parentNode.id}. progressBar div has child: ${!!Qa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(t.a.GTd)}`);const ab=r.a.kmf(this.$);if(ab&&Qa&&na)this.domElement.appendChild(Qa),
this.gNb=Qa.firstChild,this.jzc=document.getElementById(t.a.GTd),na.style.visibility="visible";else{const Gb=document.createElement("div"),fc=document.createElement("div");Gb.className=Y.a.Kzh;fc.className=Y.a.Izh;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(fc.id=t.a.peb);fc.style.display="none";const pb=document.createElement("div");pb.className=Y.a.Lzh;const Ea=document.createElement("div");Ea.className=Y.a.Jzh;const xb=document.createElement("div");xb.className=
Y.a.Hzh;fc.appendChild(pb);fc.appendChild(Ea);fc.appendChild(xb);Gb.appendChild(fc);this.domElement.appendChild(Gb);this.gNb=fc;this.jzc=Ea;w.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",ab,Qa,na)}}D4f(Qa){var na=this.cL[Qa];if(na)if(this.Nw){const ab=na.parentNode;this.OUf(na);na=Z.a(this.$)?this.NNf[Qa]:this.yAd[Qa];this.cL[Qa]=
this.svgIconProvider.Kba(na,12,12,ab,24,24)}else na.className=this.wAd[Qa]}OUf(Qa){(null===Qa||void 0===Qa?0:Qa.parentNode)&&Qa.parentNode.removeChild(Qa)}mch(){const Qa=this.teb=document.createElement("div");Qa.className=O.tzh;this.domElement.appendChild(Qa);this.Vgh(Qa)}Vgh(Qa){const na=document.createElement("div");na.className=O.Nzh;na.classList.add(O.uzh);this.$.printingEnabled||na.classList.add(W.a.hVe);Qa.appendChild(na);this.jl=document.createElement("ul");ka.DOMElementExtensions.Pu(this.jl,
t.a.rZc,null,null);this.jl.className=W.a.bTe;na.appendChild(this.jl);this.Feh();this.Lke=document.createElement("div");this.dzc.id="SheetIconTooltipContainer";na.appendChild(this.dzc)}Feh(){const Qa=document.createElement("div");var na="<div class='"+Y.a.N5g+"'>{0}</div>";const ab=Ba.a.Afd(Y.a.KAh,0,"55_16_N","");na=String.format(na,ab);n.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:7144485_ReduceInnerHTMLUsageSheetTabBarControl")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(Qa,na):Qa.innerHTML=na;Qa.className=O.Mzh;ka.DOMElementExtensions.setVisible(Qa,!1);this.gzc=Qa;this.jl.appendChild(Qa)}I6c(){const Qa=this.$.xa;for(let na=0,ab=Qa.count;na<ab;na++){const Gb=Object(C.a)(qa.a,Qa.getItem(na));0===Gb.ZB&&(this.A6b(Gb,!0),Gb.active&&Gb.activate())}}P2c(){x.a.qc(this.xh);this.xh=[];this.RK=this.wv=0}u6b(Qa,na,ab,Gb){const fc=document.createElement("a");Qa.appendChild(fc);Qa=this.yAd[na];this.cL[na]=this.pb(fc,
H.a.instance.ga(Gb),0,this.wAd[na],H.a.instance.ga(ab),Qa);if(5===na||4===na)ka.DOMElementExtensions.vK(this.cL[na],fc,!1,"span").style.marginTop="10px";this.D4f(na);ab=this.xAd[na]=this.Be.Zd(fc);I.a.instance.ta(y.a.pointerDown,fc,Ea=>Ea.ctrlKey&&this.tQi(na)?!0:this.oFf(na));I.a.instance.ta(y.a.Pf,fc,()=>this.pFf());L.a.instance.ta(y.a.we,fc,()=>this.pFf());I.a.instance.ta(y.a.pointerOut,fc,()=>this.H2c());X.KeyInputManager.instance.ta(y.a.Ob,fc,Ea=>13!==Ea.Ca.keyCode&&32!==Ea.Ca.keyCode||this.O4c?
!1:(this.O4c=!0,this.oFf(na)));X.KeyInputManager.instance.ta(y.a.Dd,fc,Ea=>13===Ea.Ca.keyCode||32===Ea.Ca.keyCode?(this.O4c=!1,this.H2c()):!1);const pb=this.Fte();Gb=Ea=>{"mouseup"===Ea.type&&this.Kz&&this.UF||Ka.g(Ea);fc.classList.contains(T.a.uU)||(pb?this.HWi(Ea,na):this.Am||this.qFf(Ea,na))};ab.ka("mouseover",Gb);ab.ka("mouseout",Gb);ab.ka("focus",Gb);ab.ka("blur",Gb);pb&&ab.ka("mouseup",Gb)}iif(Qa){let na=!1;const ab=this.$.uf;ab&&(na=P.a.EN(ka.DOMElementExtensions.getBoundingClientRect(ab),
Qa.clientPoint));return na}gmf(Qa){return P.a.EN(ka.DOMElementExtensions.getBoundingClientRect(this.domElement),Qa.clientPoint)||this.iif(Qa)}qIh(Qa){let na=null;const ab=Qa.clientPoint;let Gb=this.wv;if(this.gmf(Qa))for(Gb=this.wv;Gb<=this.RK;Gb++)if(na=this.SQ(Gb))if(Qa=ka.DOMElementExtensions.getBoundingClientRect(na.domElement),!this.isRtl&&ab.x<Qa.x+Qa.width||this.isRtl&&ab.x>Qa.x)break;return{returnValue:na,tHj:Gb>this.RK}}mQb(){if(this.Kz){if(!this.YM){w.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.YM=this.Aaa.cloneNode(!0);if(!this.y_f(this.YM,this.Aaa,!0,"UpdateDragAndDropState"))return;this.Aaa.style.visibility="hidden";this.YM.classList.add(O.Ozh);this.YM.style.borderRightWidth="";this.wec=this.pZ.clientPoint.x-this.h4.width/2;this.YM.style.left=this.wec+"px";this.uD=this.tja(this.a0);0>this.uD&&w.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.n9b&&(this.uD=this.tja(this.a0));var Qa=ka.DOMElementExtensions.getBoundingClientRect(this.jl),
na=Qa.x;Qa=Qa.x+Qa.width;let ab=this.pZ.clientPoint.x-this.h4.width/2;ab=Math.min(ab,Qa-this.h4.width);ab=Math.max(ab,na);this.YM.style.transform="translateX("+Math.abs(ab-this.wec)*(this.wec<ab?1:-1)+"px)";const Gb=this.pZ.clientPoint.x>this.DCb;let fc=this.pZ.clientPoint.x;ab>=Qa-this.h4.width?(fc=Qa-this.h4.width/2,this.bQd()||this.pna||(w.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.jrc=
this.jl.scrollLeft,this.pna=window.requestAnimationFrame(this.Y0f))):ab<=na?(fc=na+this.h4.width/2,this.aQd()||this.pna||(w.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.jrc=this.jl.scrollLeft,this.pna=window.requestAnimationFrame(this.X0f))):this.pna&&(w.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.BXd());
this.pZ.clientPoint.x!==this.DCb&&(this.sYd(Gb,fc),this.DCb=this.pZ.clientPoint.x)}else(Qa=({tHj:na}=this.qIh(this.pZ)).returnValue)?this.IVd(Qa.sheet,na):this.hcf();this.HNc=!0}sYd(Qa,na){let ab;for(;({w3b:ab}=this.Uph(na,Qa)).returnValue;)this.LOb=ab,this.lRg(Qa)}lRg(Qa){if(this.LOb){var na=(Qa?1:-1)*this.h4.width;if(Qa&&!this.$.HJ||!Qa&&this.$.HJ){var ab=this.Aaa;var Gb=this.uD+1;var fc=!0}else ab=(Gb=this.SQ(this.uD+1))?Gb.domElement:null,Gb=this.uD-1,fc=!1;if(this.y_f(this.LOb,ab,fc,"AnimateSheetSwap")){w.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.uD} and other sheet-index ${Gb}. amount of sheets in the bar: ${this.OTd} isMovingRight: ${Qa}`);0<=this.uD&&this.uD<this.xh.length&&0<=Gb&&Gb<this.xh.length?(Qa=this.xh[Gb],this.xh[Gb]=this.xh[this.uD],this.xh[this.uD]=Qa):(w.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.xh.length}, ghostIndex: ${this.uD}, swappedSheetIndex: ${Gb}`),this.AQ());this.uD=
Gb;var pb=this.LOb;pb.style.transform="translateX("+na+"px)";window.requestAnimationFrame(()=>{pb.style.transform="translateX(0px)"})}}}y_f(Qa,na,ab,Gb){const fc=pb=>pb?`Node ID: ${pb.id} , Node class: ${pb.className}, Node name: ${pb.nodeName},`:null;try{return this.jl.insertBefore(Qa,na),!0}catch(pb){return Qa=this.U3a(this.a0),w.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Qa?Qa!==this.f9b?"Changed":"NoChange":"Removed",Gb,fc(na),fc(na.parentNode),fc(this.jl),ab,this.uD,this.OTd,pb),this.AQ(),!1}}Uph(Qa,na){var ab=this.$.HJ===na?this.SQ(this.uD-1):this.SQ(this.uD+1);if(!ab)return{returnValue:!1,w3b:null};ab=ab.domElement;const Gb=ka.DOMElementExtensions.getBoundingClientRect(ab);return this.h4?na?{returnValue:Qa+this.h4.width/2>=Gb.x+.5*Gb.width,w3b:ab}:{returnValue:Qa-this.h4.width/2<=Gb.x+.5*Gb.width,w3b:ab}:(w.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.AQ(),{returnValue:!1,w3b:ab})}U0f(Qa,na){let ab;ab=na?this.Y0f:this.X0f;if(-1===this.QAc)this.QAc=Qa,this.pna=window.requestAnimationFrame(ab);else{Qa=Math.floor((Qa-this.QAc)/1E3*300);var Gb=this.dLb>this.iDb?1:-1;this.scrollLeft(Math.abs(this.jl.scrollLeft-(na?this.jrc+Qa*Gb:this.jrc-Qa*Gb))*(na?-1:1));if(Qa=this.k3e("ScrollStep"))this.sYd(na,Qa.x+Qa.width/2),na&&!this.bQd()||!na&&!this.aQd()?this.pna=window.requestAnimationFrame(ab):(w.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.BXd())}}bQd(){const Qa=this.dLb>this.iDb;return Qa&&this.Wna>=this.dLb||!Qa&&this.Wna<=this.dLb}aQd(){const Qa=this.dLb>this.iDb;return Qa&&this.Wna<=this.iDb||!Qa&&this.Wna>=this.iDb}BXd(Qa=!0){this.jl&&(this.Wna=this.jl.scrollLeft);window.cancelAnimationFrame(this.pna);this.pna=0;this.QAc=-1;Qa&&this.z0()}IRd(Qa,na){Qa||w.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${na}`);this.h4=Qa}tQi(Qa){return 2===Qa?(this.M0(3),
!0):1===Qa?(this.M0(0),!0):!1}oFf(Qa){w.ULS.shipAssertTag(537153732,0,-1===this.wQa&&-1===this.vQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.wQa&&(window.clearTimeout(this.wQa),this.wQa=-1);-1!==this.vQa&&(window.clearInterval(this.vQa),this.vQa=-1);this.M0(Qa);this.wQa=window.setTimeout(()=>{this.sNj(Qa)},this.hKi);return!0}sNj(Qa){this.vQa=window.setInterval(()=>{this.M0(Qa)},this.gKi)}pFf(){this.H2c();
return!this.Kz||!this.UF}H2c(){window.clearTimeout(this.wQa);window.clearInterval(this.vQa);this.vQa=this.wQa=-1;return!0}qFf(Qa,na){const ab=this.wAd[na];wa.HelperMethods.LZd(this.cL[na],ab,ab+t.a.agc,"mouseover"===Qa.type||"focus"===Qa.type)}HWi(Qa,na){const ab=this.Dic(na),Gb=5===na;if("mouseup"===Qa.type){if(Gb||4===na)ab||this.reorderSheets(null,Gb,!1),this.AQ()}else!this.Kz&&this.UF?(ab||this.IVd(this.r7e(Gb?this.RK:this.wv),Gb),this.M0(Gb?2:1)):this.Am||this.qFf(Qa,na)}Dic(Qa){return!!ka.DOMElementExtensions.Cgd(this.cL[Qa],
"a").title}sEc(Qa){this.M1d(Qa);this.z0()}M1d(Qa){(Qa=this.U3a(Qa))&&Qa.Ngb()}eQd(){var Qa=this.$.xa;if(Qa.na&&(!ta.e(this.$)||Qa.count))if(Qa=this.tja(Qa.na),-1===Qa)w.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var na=this.ILa(Qa);Qa<this.wv?this.bxc(Qa):Qa>this.wv&&!this.Btd(na)&&this.scrollIntoView(Qa)}}WZj(){this.wv=0;this.RK=this.xh.length-1;let Qa=!1;for(let na=0;na<this.xh.length;na++){const ab=this.SQ(na);if(!ab)break;
const Gb=this.Btd(ab.domElement);ab.tabIndex=Gb?0:-1;if(!Qa&&Gb)this.wv=na,Qa=!0;else if(Qa&&!Gb){this.RK=na-1;break}}}bxc(Qa){this.$.xa.count&&(this.xh.length||this.I6c(),this.P2f(this.ILa(Math.max(0,Math.min(Qa,this.xh.length-1)))),this.z0())}scrollIntoView(Qa){w.ULS.shipAssertTag(537153697,0,Qa>=this.wv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.xh.length||this.I6c();var na=this.ILa(Math.max(0,Math.min(Qa,
this.xh.length-1))),ab=this.ILa(this.wv);if(!this.Btd(na)){na=ka.DOMElementExtensions.getBoundingClientRect(na);var Gb=ka.DOMElementExtensions.getBoundingClientRect(this.teb);na=this.isRtl?Gb.x-na.x:na.x+na.width-(Gb.x+Gb.width);for(Gb=0;ab&&Gb<na;){const fc=ka.DOMElementExtensions.getBoundingClientRect(ab);Gb+=fc.width;ab=ab.nextSibling}ab?this.P2f(ab):w.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.wv}, lastVisibleSheetTabIndex = ${this.RK}, scroll to index: ${Qa}`)}this.z0()}}P2f(Qa){const na=
ka.DOMElementExtensions.getBoundingClientRect(this.jl);Qa=ka.DOMElementExtensions.getBoundingClientRect(Qa);this.isRtl?this.scrollLeft(Math.floor(na.x+na.width-(Qa.x+Qa.width+.5))):this.scrollLeft(Math.ceil(na.x-Qa.x-.5))}scrollLeft(Qa){(0>Qa&&this.bQd()||0<Qa&&this.aQd())&&w.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const na=this.jl.scrollLeft;if(this.isRtl){if(B.a.VF||B.a.fg){this.jl.scrollLeft=this.Wna=na-Qa;
return}if(B.a.bI){this.jl.scrollLeft=this.Wna=na+Qa;return}w.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.jl.scrollLeft=this.Wna=na-Qa}Btd(Qa){Qa=ka.DOMElementExtensions.getBoundingClientRect(Qa);const na=ka.DOMElementExtensions.getBoundingClientRect(this.teb);return Qa&&na?Qa.x>=na.x-1&&Qa.x+Qa.width<=na.x+na.width+1:(w.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}gfh(){const Qa=
this.izc;if(sa.g7f(this.$))this.Am?(x.a.Ia(this.XH),this.XH=new sa(Qa,this.$,this,!0)):(x.a.Ia(this.XH),this.XH=null);else if(!this.XH||this.Am)x.a.Ia(this.XH),ca.k(this.$.hg)?this.XH=new kb(Qa,this.$,this):this.XH=new sa(Qa,this.$,this)}YIe(Qa,na){var ab=this.$.xa;if(!this.$.isEditMode||!ab.count)x.a.Ia(na),na=null;else if(!na)if(ab=this.Am?this.QTd:this.izc,ca.k(this.$.hg))na=new kb(ab,this.$,this);else switch(Qa){case 0:na=new sa(ab,this.$,this);break;case 1:na=new sb(ab,this.$,this);break;default:w.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return na}q6c(){n.EwaSettings.ma(420)?(this.XH=this.YIe(0,this.XH),this.Lzb=this.YIe(1,this.Lzb)):this.gfh()}k3e(Qa){const na=ka.DOMElementExtensions.getBoundingClientRect(this.YM);na||(w.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Qa}: GetBoundingClientRect returned null for the dragged sheet.`),
this.AQ());return na}T$e(Qa,na){this.xua.rSg(Qa,na);this.AQ(!1);this.qSd(this.navigationButtonsDisabled);for(const ab of this.ZPj)ab&&ab.FS(this.navigationButtonsDisabled);for(const ab of this.Dxe)ab&&ab.FS(this.operationButtonsDisabled)}static $lj(Qa,na,ab,Gb){Qa<ab?(na>ab&&ab--,na>Gb&&Gb--):Qa>Gb?(na<ab&&ab++,na<Gb&&Gb++):na<ab&&ab++;return{UIh:ab,Byi:Gb}}}Object(u.a)(ub,"SheetTabBarControl",S.a,[495,2,39]);class hc extends v.a{constructor(Qa){super();this.$=Qa;this.Fb()}create(){const Qa=this.$.Eb;
if(z.a(this.$.va,1))U.PageLoadTrackingInfo.instance.Tda(t.a.ABa,["sheetTabBar"]);else{var na=document.getElementById(Qa+t.a.N7c);if(na){n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&U.PageLoadTrackingInfo.instance.lBa(t.a.ABa);var ab=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&n.EwaSettings.isChangeGateEnabled("OfficeVSO:7144485_ReduceInnerHTMLUsageSheetTabBarControl")?e.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):h.Task.Ta(null),
Gb=r.a.Osd()?e.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Ya):h.Task.Ta(null);f.TaskExtensions.Aa(f.TaskExtensions.Fd([Gb,ab],this.$.la),()=>{this.ob(this.$.da.za(32)||new ub(this.$,na,Gb.result,ab.result))},this.$.la,3)}else U.PageLoadTrackingInfo.instance.Tda(t.a.ABa,["sheetTabBar"])}}static ka(Qa){Qa.da.Ga(33,new hc(Qa))}}Object(u.a)(hc,"SheetTabBarFactory",v.a,[]);a.d(D,"a",function(){return Bc});const Bc=()=>{c.a.Fa(Qa=>{hc.ka(Qa);l.ka(Qa)})}},1156:function(u,D,a){var c=a(9),b=a(1);u=a(0);
var e=a(222),f=a(15),d=a(31),h=a(5),m=a(12),l=a(22),v=a(13),t=a(254),z=a(21),r=a(30);class n{constructor(ia){this.Iwc=ia||""}static get CPe(){return n.P9d||(n.P9d=new n(""))}static get yxd(){return n.Pee||(n.Pee=n.ied(2).Iwc)}static n4a(ia){ia=r.a.Eg(ia||"");return new n(ia)}static ubc(ia){return n.n4a(v.a.instance.ga(ia))}static ied(ia){return new n(v.a.instance.Ua(ia))}static wLh(ia,...Ha){return n.vLh(v.a.instance.nb(ia),...Ha)}static vLh(ia,...Ha){const Z=Ha.length,la=Array(Z);for(let Xa=0;Xa<
Z;Xa++)la[Xa]=(Ha[Xa]||n.CPe).Iwc;return new n(String.format(ia,la))}}n.P9d=null;n.Pee=null;Object(u.a)(n,"SafeHtml",null,[548]);const w=(ia,Ha)=>{Ha&&(ia.append(Ha),ia.append(n.yxd))};class B{constructor(ia,Ha,Z,la=null){this.FAf=(Xa,Za)=>{this.qRf(Za.Wd.command)};this.$=ia;this.htmlSanitizationHelper=la;this.ufa=document.createElement("div");this.ufa.setAttribute(h.a.e3,h.a.xk);this.ufa.className=d.a.Bad;Ha.insertBefore(this.ufa,Z);this.Gga=document.createElement("div");this.Gga.setAttribute(h.a.e3,
h.a.xk);this.Gga.className=d.a.Bad;Ha.insertBefore(this.Gga,this.ufa);this.nAg=v.a.instance.Ua(2);this.F$=document.createElement("div");this.F$.setAttribute(h.a.Ld,h.a.Ssa);this.F$.setAttribute(h.a.Usa,h.a.rpb);this.F$.className=d.a.Bad;Ha.insertBefore(this.F$,this.Gga);this.register();this.$.da.Ga(211,this)}get Aya(){return this.nAg}get isActive(){return!0}get activeCell(){return z.h(this.$).Sb(null)}get ysd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}dispose(){this.$&&
this.unregister();m.DOMElementExtensions.tf(this.F$);m.DOMElementExtensions.tf(this.ufa);m.DOMElementExtensions.tf(this.Gga);this.Gga=this.ufa=this.F$=this.$=null}setEnabled(ia){this.B3f(this.Gga,ia)}iyj(){this.B3f(this.ufa,!0)}readText(ia){this.VIb(n.n4a(ia),!0)}WQa(ia){this.VIb(n.n4a(ia),!1)}tRf(ia,Ha){if(1>Ha||!ia)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Z=new Sys.StringBuilder;ia=String.format(v.a.instance.nb(34),Ha,ia);w(Z,ia);w(Z,v.a.instance.ga(856));
this.VIb(n.n4a(Z.toString()),!1)}}Ycj(ia,Ha,Z){if(1>Z||1>Ha||Ha>Z||!ia)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var la=new Sys.StringBuilder;w(la,ia);la.append(String.format(v.a.instance.nb(55),Ha,Z));this.VIb(n.n4a(la.toString()),!1)}}qRf(ia){ia=this.N2h(ia);this.VIb(ia,!1)}VIb(ia,Ha){if(ia=ia?ia.Iwc:null)Ha=Ha?this.Gga:this.ufa,l.a.equals(Ha.innerHTML,ia,!1)&&(ia+=n.yxd),this.ysd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(Ha,ia):Ha.innerHTML=ia}acb(ia,
Ha){this.F$.getAttribute(h.a.Usa)!==Ha&&this.F$.setAttribute(h.a.Usa,Ha);ia=ia?n.n4a(ia).Iwc:"";this.ysd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(this.F$,ia):this.F$.innerHTML=ia}Zcj(ia,Ha,Z,la){const Xa=v.a.instance.nb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===ia||null===ia));f.ULS.shipAssertTag(537153948,0,!(void 0===Ha||null===Ha));f.ULS.shipAssertTag(537153947,0,!(void 0===Z||null===Z));f.ULS.shipAssertTag(537153946,0,!(void 0===la||null===la));f.ULS.shipAssertTag(537153945,
0,!(void 0===Xa||null===Xa));ia=String.format(Xa,ia||"",Ha||"",Z||"",la||"");this.acb(ia,h.a.pHa)}LYj(ia){var Ha=this.Gga.style;ia?(ia=t.a.N2b(ia.cell,Ha),Ha=ia.cC,Ha.top=Ha.left=Ha.bottom=Ha.right=null,ia.a3()):Ha.cssText=""}N2h(ia){switch(ia){case -1985798686:return n.ubc(12);case -911352779:return n.ubc(11);case 237279923:return n.ubc(13);case -1502853784:return n.ied(81);case -111689794:return n.ied(78);case -287251124:return this.Hid(1327,Ha=>Ha.bold);case -1925065947:return this.Hid(1328,Ha=>
Ha.italic);case 1764140053:return this.Hid(1329,Ha=>Ha.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.Asa(this.FAf))}unregister(){this.$&&this.$.Ka.HAa(this.FAf)}B3f(ia,Ha){const Z=ia===this.ufa;Ha?(ia.setAttribute(h.a.Usa,h.a.pHa),Z&&ia.setAttribute(h.a.Ld,h.a.Ssa),ia.setAttribute(h.a.e3,h.a.zr),ia.removeAttribute(h.a.e3),
this.ysd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(ia,ia.innerHTML+" "):ia.innerHTML+=" "):(ia.removeAttribute(h.a.Usa),Z&&ia.removeAttribute(h.a.Ld),ia.setAttribute(h.a.e3,h.a.xk))}Hid(ia,Ha){const Z=this.activeCell;if(!Z)return null;const la=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),Xa=[7,8];Ha=Ha(Z)?!0:!1;return n.wLh(la?Xa[+Ha]:Xa[+!Ha],n.ubc(ia))}}Object(u.a)(B,"AriaLiveNotifier",null,[505,482,2]);var A=a(50),y=a(37);class x extends e.a{constructor(ia){super();
this.$=ia;this.Fb()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const ia=A.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);y.TaskExtensions.Aa(y.TaskExtensions.Fd([ia],this.$.la),()=>{this.ob(this.$.da.za(211)||new B(this.$,this.$.ru,this.$.uf,ia.result))},this.la,3)}else this.ob(this.$.da.za(211)||new B(this.$,this.$.ru,this.$.uf))}static ka(ia){ia.da.Ga(212,
new x(ia))}}Object(u.a)(x,"AriaLiveNotifierFactory",e.a,[]);var F=a(27),I=a(212),L=a(138),X=a(70);class P{constructor(ia,Ha){this.y0=this.IW=this.rO=null;this.Fja=Ha;this.igh(ia);this.X7i();b.EwaSettings.xb()&&ia.da.Ga(244,this)}get isActive(){return!!this.Fja&&document.activeElement===this.Fja}readText(ia){ia=String.format(v.a.instance.nb(30),ia);this.rO.setAttribute(h.a.nv,ia);this.IW.setAttribute(h.a.nv,ia);this.JPj()}dispose(){this.y0&&this.y0.parentNode&&this.y0.parentNode.removeChild(this.y0);
this.IW=this.rO=this.y0=this.Fja=null}igh(ia){var Ha=ia.Eb+"readoutElementWrapper";const Z=ia.Eb+"readoutElement1",la=ia.Eb+"readoutElement2";this.y0=document.getElementById(Ha);this.y0||(this.y0=document.createElement(I.a.div),this.y0.id=Ha,this.rO=document.createElement(I.a.label),this.rO.id=Z,this.rO.setAttribute(L.a.contentEditable,X.a.cRb),this.rO.setAttribute(h.a.Ld,h.a.B_a),this.IW=document.createElement(I.a.label),this.IW.id=la,this.IW.setAttribute(L.a.contentEditable,X.a.cRb),this.IW.setAttribute(h.a.Ld,
h.a.B_a),this.rO.style.width="0px",this.rO.style.height="0px",this.IW.style.width="0px",this.IW.style.height="0px",this.rO.tabIndex=-1,this.IW.tabIndex=-1,this.y0.appendChild(this.rO),this.y0.appendChild(this.IW),ia=ia.Eb+h.a.y5b,Ha=document.getElementById(ia),f.ULS.shipAssertTag(537153942,3,!!Ha,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${ia}`),Ha&&Ha.appendChild(this.y0))}X7i(){this.Fja&&this.rO&&this.IW&&(this.Fja.setAttribute(h.a.d3,this.rO.id),
this.Fja.setAttribute(h.a.oZc,`${this.rO.id} ${this.IW.id}`))}JPj(){if(this.isActive){let ia="";m.DOMElementExtensions.hasAttribute(this.Fja,h.a.d3)&&(ia=this.Fja.getAttribute(h.a.d3).toString());this.Fja.setAttribute(h.a.d3,ia===this.rO.id?this.IW.id:this.rO.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static x7a(){if(null==P.Jvb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!F.a.PNa)P.Jvb=
!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(P.Jvb=!1,F.a.bI||F.a.fg)P.Jvb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return P.Jvb}static ka(ia){P.x7a()&&ia.da.Ga(244,new P(ia,z.h(ia).fc.textBox.Qe))}}P.Jvb=null;Object(u.a)(P,"FocusBasedReadout",null,[482,2]);class G extends e.a{constructor(ia){super();this.$=ia;this.Fb()}create(){P.x7a()?
z.h(this.$).fc.textBox.gU(()=>{const ia=this.$.da.za(244)||new P(this.$,z.h(this.$).fc.textBox.Qe);this.ob(ia)}):this.ob(null)}static ka(ia){ia.da.Ga(315,new G(ia))}}Object(u.a)(G,"FocusBasedReadoutFactory",e.a,[]);var C=a(7),H=a(87),J=a(82);const M=ia=>{switch(ia){case 1:return 1450;case 2:return 1451;case 3:return 1452;case 4:return 1453;case 5:return 1454;case 6:return 1455;case 7:return 1456;case 8:return 1457;case 9:return 1458;case 10:return 1459;case 11:return 1460;case 12:return 1461;case 13:return 1462;
case 14:return 1463;case 15:return 1464;case 16:return 1465;case 17:return 1466;case 18:return 1467;case 19:return 1468;case 20:return 1469;case 21:return 1470;case 22:return 1473;case 23:return 1471;case 24:return 1472;case 25:return 1474;case 26:return 1475;case 27:return 1476;case 28:return 1477;default:return 1478}};var S=a(24),W=a(42),O=a(211),T=a(47),Y=a(46),va=a(122);class ca{static get Nbj(){return ca.yie||(ca.yie=RegExp("([A-Z]+)","g"))}static get Mbj(){return ca.xie||(ca.xie=RegExp("([A-Z])",
"g"))}static get M3g(){return ca.l7d||(ca.l7d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static vid(ia){return ca.k6e(ia.toString())}static k6e(ia){return ca.M3g.test(ia)?ia.replace(ca.Nbj,"$1 ").replace(ca.Mbj,' "$1"').trim():ia}static wmj(ia){const Ha=ia.lastIndexOf("!");return ia.substring(0,-1<Ha?Ha+1:0)+ca.k6e(ia.substring(-1<Ha?Ha+1:0,ia.length))}}ca.yie=null;ca.xie=null;ca.l7d=null;Object(u.a)(ca,"RangeAriaExtensions",
null,[]);class V{constructor(){this.activeItemName=null;this.Qlf=!1;this.tableName=null;this.m1a=0;this.DBc=!1}}Object(u.a)(V,"SelectionReadoutState",null,[]);a(64);var ra=a(76);class N{constructor(ia,Ha,Z,la,Xa){this.gridReadoutNotifier=null;this.Wbb=!1;this.hta=this.Cpb=null;this.Dda=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):z.h(this.$).eb||this.L1b.tq()};
this.oNi=()=>{if(!z.h(this.$).ha.Ra.Yrd){var Za,xa=({activeCell:Za}=this.COh()).returnValue;this.readText(xa,Za)}};this.Mp=()=>{const Za=this.activeCell;this.readText("Editing",Za);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Za&&Za.ifc&&!z.h(this.$).yaf||this.L1b.cancel()};this.Pc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.Dda(),this.Wbb&&z.h(this.$).inRangePicker&&1===ra.a.Db&&(null===this.Cpb?this.Cpb=T.a.instance.create(this.aKd,N.QVc,"readSelectedRanges"):this.Cpb.tq()))};this.$=Ha;this.ariaLiveNotifier=ia;this.sparklineManager=la;this.tableManager=Z;this.YD=new V;this.x7a=P.x7a();this.Wbb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.x7a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=Xa:this.gridReadoutNotifier=Ha.da.za(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),N.QVc=700);this.L1b=T.a.instance.create(this.oNi,N.QVc,Y.a.Huj,!1);this.Kj()}get activeCell(){return z.h(this.$).Sb(null)}dispose(){this.$&&this.$j();H.a.Ia(this.L1b);this.sparklineManager=this.$=this.L1b=null}S0e(ia,Ha,Z=!0){if(!ia)return"";var la=this.$.da;const Xa=new Sys.StringBuilder;this.gSg(Xa,ia,Ha);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Za=this.tableManager.lka(ia.range);(null===
Za||void 0===Za?0:Za.eVd)&&this.Mue(Xa,Za);Za=this.tableManager.Dn(ia.range);(null===Za||void 0===Za?0:Za.zba)&&this.Mue(Xa,Za)}Za=ia.xba?this.I3e(ia):ia.text;w(Xa,Za);Za=this.$.activeItemName;this.YD.activeItemName!==Za&&(w(Xa,Za),this.YD.activeItemName=Za);Za=1===Ha.length?W.K(Ha).isSingle?"":v.a.instance.ga(852):String.format(v.a.instance.nb(31),Ha.length);w(Xa,Za);for(var xa of Ha)w(Xa,ca.vid(xa)),1===Ha.length&&N.Qvi(xa)&&(Za=z.h(this.$).Ea.us(xa.bottomRight),void 0!==Za&&null!==Za&&Za.text&&
(Za=Za.xba?this.H3e(Za,Za.text):Za.text,w(Xa,Za)));xa=ia.cell;xa=this.h0h(xa.erj,xa.P6g);w(Xa,xa);this.QRg(Xa,ia);Z&&(ia.a8a?w(Xa,v.a.instance.ga(840)):ia.Rxa&&w(Xa,v.a.instance.ga(841)));if(ia.hasAutoFilter||ia.Z4)this.hSg(Xa,ia.hasAutoFilter?ia.cell.autoFilterType:ia.cell.v5i),Z&&w(Xa,v.a.instance.ga(843));O.c(this.$,ia.range)&&w(Xa,v.a.instance.ga(847));this.NRg(Xa,ia);Z=(Z=la.za(14))?Z.APh():"";w(Xa,Z);ia.wB&&(Z=z.h(this.$).Ea.us(ia.range),Z=!!Z&&Z.Paf,N.hEj(ia)?N.ORg(Xa,ia):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
Z?w(Xa,v.a.instance.ga(845)):w(Xa,v.a.instance.ga(844)));ia.rV&&(w(Xa,v.a.instance.ga(846)),ia.qyb&&w(Xa,String.format(v.a.instance.nb(16),ia.ujh)),w(Xa,ia.iconName));ia.hasRichValueIcon&&(xa=this.$.da.za(271),Z="",xa&&ia.cell.Xpf&&(xa=xa.IU(ia.cell.Xpf))&&xa.DomainId.Id!==N.$4j&&(Z=xa.Name),ia.cell.ami?(w(Xa,String.format(v.a.instance.nb(187),Z)),w(Xa,v.a.instance.ga(1801))):(w(Xa,String.format(v.a.instance.nb(185),Z)),w(Xa,v.a.instance.ga(1800))));this.Bbi(ia)&&w(Xa,N.HWh(ia));(la=la.za(231))&&
w(Xa,la.W3e(Ha,!0));1===Ha.length&&Ha[0].isSingle&&N.gEj(ia,Ha[0],this.$)&&(Ha=this.$.da.za(271))&&w(Xa,Ha.LPh());ia.BPb&&ia.CPb&&w(Xa,ia.CPb);(Ha=ia.cell.z2g)&&w(Xa,Ha);ia.FNa&&ia.SHb&&(ia=ia.DGd)&&(w(Xa,v.a.instance.ga(1975)),w(Xa,ia));return Xa.toString()}Mze(ia){this.hta=this.YD;this.YD=Object(C.a)(new V,{activeItemName:this.hta.activeItemName,DBc:ia?this.hta.DBc:!1,tableName:ia?this.hta.tableName:"",m1a:ia?this.hta.m1a:-1})}ZYf(){this.hta&&(this.YD=this.hta,this.hta=null)}h0h(ia,Ha){return 2===
ia||2===Ha?v.a.instance.ga(874):1===ia||1===Ha?v.a.instance.ga(875):""}I3e(ia){return this.H3e(ia.cell,ia.text)}gSg(ia,Ha,Z){if(Z&&1===Z.length&&Z[0].isSingle){Z="";var la=this.tableManager.lka(Ha.range);if(la){Z=la.pivotTableName;this.OYc(ia,Z);var Xa=la.gic?v.a.instance.ga(835):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Xa+=(la.altText?la.altText+" . ":"")+(la.altTextSummary?la.altTextSummary:""));this.Oue(ia,!0,Z,Xa);w(ia,this.tableManager.Iti(la,
Ha.range)?v.a.instance.ga(837):"");w(ia,this.tableManager.qni(la,Ha.range)?v.a.instance.ga(836):"")}else if(la=this.tableManager.Dn(Ha.range)){Z=(Xa=z.h(this.$).Bb.Bj(Ha.range))?Xa.name:"";this.OYc(ia,Z);let Za="";Xa&&(Za=(Xa.oUa?Xa.oUa+" . ":"")+(Xa.pUa?Xa.pUa:""));this.Oue(ia,!1,Z,Za);w(ia,this.tableManager.Tif(la,Ha.range)?v.a.instance.ga(836):"")}else this.OYc(ia,Z),this.YD.tableName="",this.YD.m1a=-1}}OYc(ia,Ha){Ha!==this.YD.tableName&&this.YD.tableName&&(ia.append(v.a.instance.ga(this.YD.DBc?
834:833)),w(ia," "+this.YD.tableName))}Oue(ia,Ha,Z,la){Z!==this.YD.tableName&&(ia.append(v.a.instance.ga(Ha?832:831)),w(ia," "+Z),w(ia,la),this.YD.tableName=Z,this.YD.DBc=Ha,this.YD.m1a=-1)}Mue(ia,Ha){const Z=z.h(this.$).ha.ra.activeCell;if(Z.top!==Ha.top&&Z.left!==this.YD.m1a){ia.append(v.a.instance.ga(836));Ha=new S.Range(Ha.top,Z.left,Ha.top,Z.left,!0,!0);w(ia,ca.vid(Ha));if(Ha=z.h(this.$).Sb(Ha))Ha=Ha.xba?this.I3e(Ha):Ha.text,w(ia,Ha);this.YD.m1a=Z.left}}H3e(ia,Ha){const Z=ia.t6a;return ia.Owa?
String.format(v.a.instance.nb(14),Ha,Z):String.format(v.a.instance.nb(13),Ha,ca.wmj(Z))}Kj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var ia=z.h(this.$);f.ULS.shipAssertTag(537153929,0,!!ia,"Can't register to grid's events");ia&&(ia.Vb.Xk(this.Mp),ia.Ea.jw(this.Dda),ia.IC(this.Dda),this.Wbb&&ia.Vb.sm(this.Nf.bind(this)),ia=ia.ha,f.ULS.shipAssertTag(537153928,0,!!ia,"Can't register to selectionManager's events"),ia&&(ia.kH(this.Pc),ia.iH(this.Dda),
ia.Ra.W2(this.Dda),this.Wbb&&(this.aKd=this.aKd.bind(this))))}}$j(){if(this.$){var ia=z.h(this.$);ia&&(ia.Vb.Fk(this.Mp),ia.Ea.ix(this.Dda),ia.cE(this.Dda),this.Wbb&&ia.Vb.Il(this.Nf),ia=ia.ha)&&(ia.mG(this.Dda),ia.rL(this.Dda),ia.Ra.Dna(this.Dda))}}readText(ia,Ha){this.x7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(ia):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(ia),
this.Wbb&&!Ha||this.ariaLiveNotifier.LYj(Ha))}Nf(){this.Cpb&&this.Cpb.cancel()}aKd(){this.readText(this.y3h())}y3h(){let ia="";z.h(this.$).ha.rangePicker.lL.forEach(()=>{ia+=void 0});return ia+=" selected"}COh(){let ia;ia=null;var Ha=z.h(this.$).ha;if(1!==Ha.Ne&&!Ha.Ra.$b)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${Ha.Ne} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:ia};switch(Ha.Ne){case 2:return{returnValue:this.ARh(Ha),
activeCell:ia};case 64:var Z=Ha.Ra.$b.floatingObject,la="";if(Ha=Ha.Ra.$b.Ys||Ha.Ra.$b.Jd)la=(la=Ha.firstChild)?m.DOMElementExtensions.getTextContent(la):"";return{returnValue:String.format(v.a.instance.nb(53),N.Hbc(Z.altText,Z.altTextDescription,Z.name),la,Z.altTextDescription),activeCell:ia};case 4:return{returnValue:N.ZQg(Ha.Ra.$b.floatingObject),activeCell:ia};case 512:return{returnValue:va.a.q2e(Ha.Ra.$b.floatingObject.G9c),activeCell:ia};case 8:return Z=Ha.Ra.$b.floatingObject,{returnValue:String.format(v.a.instance.nb(51),
Z?Z.name:""),activeCell:ia};case 1:return ia=this.activeCell,{returnValue:this.S0e(ia,Ha.ra.selectedRanges),activeCell:ia}}return{returnValue:"",activeCell:ia}}ARh(ia){const Ha=new Sys.StringBuilder;Ha.append(N.c3g(ia));const Z=this.$.da.za(231);Z&&w(Ha,Z.W3e(ia.Ra.$b.floatingObject,!1));return Ha.toString()}Bbi(ia){ia=ia.$gf();let Ha=!1;this.YD.Qlf!==ia&&(this.YD.Qlf=ia,Ha=!0);return Ha}QRg(ia,Ha){if(Ha.Ayb)if(Ha=this.sparklineManager.t4h(Ha)){var Z=v.a.instance,la=Z.ga;a:switch(Ha.type){case 0:var Xa=
828;break a;case 1:Xa=829;break a;default:Xa=830}Z=la.call(Z,Xa);w(ia,String.format(v.a.instance.nb(25),Z));Ha=String.format(v.a.instance.nb(24),ca.vid(Ha.gMj));w(ia,Ha)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),w(ia,String.format(v.a.instance.nb(25),""))}hSg(ia,Ha){switch(Ha){case 1:case 11:w(ia,v.a.instance.ga(848));break;case 6:w(ia,v.a.instance.ga(848));w(ia,v.a.instance.ga(850));break;case 7:w(ia,v.a.instance.ga(848));w(ia,v.a.instance.ga(851));
break;case 2:w(ia,v.a.instance.ga(849));w(ia,v.a.instance.ga(850));break;case 3:w(ia,v.a.instance.ga(849));w(ia,v.a.instance.ga(851));break;default:w(ia,v.a.instance.ga(849))}}NRg(ia,Ha){var Z;const la=this.$.da.za(65);Ha=la?la.cLa(Ha.range):null;let Xa="";const Za=Object(J.a)(502,Ha);if(Ha)Xa=!Ha.H7a&&Za&&Za.pvi?String.format(v.a.instance.nb(29),Za.vQj):String.format(v.a.instance.nb(23),Ha.author);else if(null===(Z=null===la||void 0===la?void 0:la.$m)||void 0===Z?0:Z.FF)Xa=String.format(v.a.instance.nb(28),
la.$m.UN.author);w(ia,Xa)}static ZQg(ia){return String.format(v.a.instance.nb(52),N.Hbc(ia.altText,ia.altTextDescription,ia.name),ia.altTextDescription)}static HWh(ia){return v.a.instance.ga(ia.$gf()?838:839)}static Hbc(ia,Ha,Z){return ia||Ha?ia:Z}static c3g(ia){var Ha=ia.Ra.$b;ia=Ha.floatingObject;const Z=ia.Vc,la=Z.ChartTitle,Xa=ia.altText,Za=ia.altTextDescription,xa=!!(Z.Attributes&4);return(Ha=Ha.getSelectionDescription())?Ha:Z.DataRangeForDisplay?String.format(v.a.instance.nb(xa?49:47),N.Hbc(Xa,
Za,ia.name),Za,la,v.a.instance.ga(M(Z.ChartCategory)),Z.DataRangeForDisplay):String.format(v.a.instance.nb(xa?50:48),N.Hbc(Xa,Za,ia.name),Za,la,v.a.instance.ga(M(Z.ChartCategory)))}static hEj(ia){return b.EwaSettings.ma(102)&&(ia.p7a||ia.eic)}static ORg(ia,Ha){Ha.UTa?Ha.p7a?w(ia,String.format(v.a.instance.nb(26),Ha.UTa.topLeft.toString())):Ha.eic&&(Ha=Ha.UTa.ES(),w(ia,String.format(v.a.instance.nb(27),(Ha.LastColumn-Ha.FirstColumn+1).toString(),(Ha.LastRow-Ha.FirstRow+1).toString()))):f.ULS.shipAssertTag(537153924,
0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static gEj(ia,Ha,Z){return ia.wB||!b.EwaSettings.ma(138)?!1:(ia=Z.da.za(271))?ia.Dhc(Ha):!1}static Qvi(ia){return ia.top===ia.bottom&&ia.left+1===ia.right||ia.top+1===ia.bottom&&ia.left===ia.right}}N.$4j=268435712;N.QVc=500;Object(u.a)(N,"SelectionReadoutHandler",null,[503,2]);var ea=a(55),Ba=a(695);class ka extends e.a{constructor(ia){super();this.$=ia;this.Fb()}create(){const ia=
this.$.da,Ha=A.GetServiceTaskFactory.Oa(ia,211,212,this.Ya),Z=A.GetServiceTaskFactory.Oa(ia,66,134,this.Ya),la=A.GetServiceTaskFactory.Oa(ia,240,239,this.Ya);let Xa=ea.Task.Ta(null);b.EwaSettings.xb()&&(Xa=A.GetServiceTaskFactory.Oa(ia,244,315,this.Ya));y.TaskExtensions.Aa(y.TaskExtensions.Fd([Ha,Z,la,Xa],this.la),()=>{const Za=Object(Ba.a)(this.$.da,226,()=>new N(Ha.result,this.$,Z.result,la.result,Xa.result));this.ob(Za)},this.$.la,3)}static ka(ia){ia.da.Ga(227,new ka(ia))}}Object(u.a)(ka,"SelectionReadoutHandlerFactory",
e.a,[]);class Ka{constructor(ia,Ha){this.$=Ha;this.ariaLiveNotifier=ia}xRf(){const ia=this.CPh();this.ariaLiveNotifier.acb(ia,h.a.rpb)}CPh(){const ia=new Sys.StringBuilder;this.$.workbookContext&&w(ia,this.$.workbookContext.WorkbookFileName);w(ia,v.a.instance.ga(854));w(ia,this.EPh());w(ia,this.DPh());w(ia,v.a.instance.ga(855));return ia.toString()}EPh(){return this.$.isEditMode?v.a.instance.ga(859):v.a.instance.ga(860)}DPh(){var ia=this.k4j();const Ha=this.$.xa.na;ia=1!==ia?String.format(v.a.instance.nb(32),
ia):v.a.instance.ga(853);ia=new Sys.StringBuilder(ia);Ha&&Ha.sheetName&&(ia.append(n.yxd),ia.append(String.format(v.a.instance.nb(33),Ha.sheetName)));return ia.toString()}k4j(){let ia=0;for(const Ha of this.$.xa.items)Ha.visible&&ia++;return ia}}Object(u.a)(Ka,"WorkbookReadout",null,[]);class Oa{constructor(ia,Ha,Z){this.jEf=()=>{this.y3d.xRf();this.ariaLiveNotifier.setEnabled(!0)};this.$=Ha;this.ariaLiveNotifier=ia;this.y3d=new Ka(ia,Ha);this.bbc=Z.Vhd(this.$);this.bbc.sNg(this.jEf)}dispose(){this.bbc&&
this.bbc.ckj(this.jEf);this.bbc=this.ariaLiveNotifier=this.$=null}}Object(u.a)(Oa,"EmbeddedWorkbookReadoutHandler",null,[2]);class wa{constructor(ia,Ha){this.fW=()=>{this.dd||this.jue()};this.dd=!1;this.rZ=Ha.nZ;this.ariaLiveNotifier=ia;this.y3d=new Ka(ia,Ha);this.rZ&&this.rZ.dR?this.jue():this.Kj()}dispose(){this.$j();this.ariaLiveNotifier=this.rZ=null;this.dd=!0}Kj(){if(this.rZ){this.rZ.mv(this.fW);this.rZ.Ea.jw(this.fW);this.rZ.IC(this.fW);var ia=Object(J.a)(221,this.rZ);ia&&(ia.Vb.Xk(this.fW),
ia.ha.kH(this.fW),ia.ha.iH(this.fW),ia.ha.Ra.W2(this.fW))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}$j(){if(this.rZ){this.rZ.Ea.ix(this.fW);this.rZ.cE(this.fW);const ia=Object(J.a)(221,this.rZ);ia&&(ia.Vb.Fk(this.fW),ia.ha.mG(this.fW),ia.ha.rL(this.fW),ia.ha.Ra.Dna(this.fW))}}jue(){this.y3d.xRf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.iyj();this.dispose()}}Object(u.a)(wa,"WorkbookReadoutHandler",null,[2]);class qa extends e.a{constructor(ia){super();
this.$=ia;this.Fb()}create(){const ia=A.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);if(this.$.LK){const Ha=A.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);y.TaskExtensions.Aa(y.TaskExtensions.Fd([ia,Ha],this.$.la),()=>{const Z=Object(Ba.a)(this.$.da,228,()=>new Oa(ia.result,this.$,Ha.result));this.ob(Z)},this.$.la,3)}else y.TaskExtensions.Aa(ia,Ha=>{const Z=Object(Ba.a)(this.$.da,228,()=>new wa(Ha.result,this.$));this.ob(Z)},this.$.la,3)}static ka(ia){ia.da.Ga(229,new qa(ia))}}Object(u.a)(qa,
"WorkbookReadoutHandlerFactory",e.a,[]);a.d(D,"a",function(){return aa});const aa=()=>{c.a.Fa(ia=>{x.ka(ia);b.EwaSettings.xb()?G.ka(ia):P.ka(ia);ka.ka(ia);qa.ka(ia)})}},1159:function(u,D,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(15),h=a(4),m=a(31),l=a(5),v=a(24),t=a(76),z=a(58);class r{constructor(bb,lb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=bb;this.sortType=lb}gV(){return this.autoFilterOptions}}Object(u.a)(r,"MacroRecorderRangeColumnSortedOrFilteredPayload",
null,[125]);class n{constructor(bb){this.autoFilterOptions=null;this.autoFilterOptions=bb}gV(){return this.autoFilterOptions}}Object(u.a)(n,"MacroRecorderRangeItemFilteredPayload",null,[125]);var w=a(1129),B=a(42),A=a(371),y=a(188),x=a(60),F=a(162),I=a(211),L=a(47),X=a(46),P=a(12),G=a(282),C=a(1),H=a(183),J=a(22),M=a(281),S=a(21);class W{constructor(bb,lb){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=bb;this.tableRange=B.l(bb.Ranges[0],bb.SheetName);this.styleIndex=lb}}
Object(u.a)(W,"MacroRecorderTableStyleAppliedPayload",null,[125]);class O extends W{constructor(bb,lb,Fa,Na){super(bb,Fa);this.isCreation=this.hasHeaders=!1;this.hasHeaders=lb;this.isCreation=Na}}Object(u.a)(O,"MacroRecorderRangeFormatedAsTablePayload",W,[]);class T{constructor(bb,lb,Fa){this.description=this.title=this.tableRange=null;this.tableRange=bb;this.title=lb;this.description=Fa}Dn(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(u.a)(T,
"MacroRecorderTableAltTextEditedPayload",null,[125]);class Y{constructor(bb,lb){this.newName=this.oldName=null;this.oldName=bb;this.newName=lb}}Object(u.a)(Y,"MacroRecorderTableRenamedPayload",null,[125]);class va{constructor(bb){this.originalRange=null;this.originalRange=bb}}Object(u.a)(va,"MacroRecorderTableResizedPayload",null,[125]);class ca{constructor(bb,lb,Fa){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=bb;this.optionType=lb;this.isPivotTable=Fa}}Object(u.a)(ca,
"MacroRecorderTableStyleOptionToggledPayload",null,[125]);var V=a(29),ra=a(44);class N{constructor(bb){this.tableName=null;this.tableName=bb}}Object(u.a)(N,"MacroRecorderTableConvertedToRangePayload",null,[125]);var ea=a(806);class Ba{constructor(bb,lb,Fa){this.ssd=!1;this.sharedSheetRange=lb;this.$=bb;this.di=this.$.Jb.Ng("UserAction","ConvertToRangeManager");this.tableName=Fa}gbb(){this.di.start();const bb=this.$.pa.ya.Wb();return ea.i(this.$.pa.ya,this.sharedSheetRange,lb=>{this.showDialog(lb)},
null,null,null,bb)}showDialog(bb){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.di.zc} milliseconds`);bb&&!G.a(bb)&&((this.ssd=bb.Result)?(bb=V.a.Zc(3,2,0,738,0,-66108047,"ConvertToRange"),f.TaskExtensions.Aa(ra.a(this.$).vj(bb),lb=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.di.zc} milliseconds`);0===lb.result&&this.bah()},this.$.la,11)):this.cah());this.di.stop();
d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.di.zc} milliseconds`)}Nye(){const bb={};bb.IsQueryTable=this.ssd;bb.Range=this.sharedSheetRange;return bb}bah(){const bb=this.$.pa.ya;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.jgf(194,(lb,Fa,Na)=>ea.d(bb,this.Nye(),lb,Fa,Na,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}cah(){const bb=this.$.pa.ya;
d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.jgf(193,(lb,Fa,Na)=>ea.c(bb,this.Nye(),lb,Fa,Na,null),()=>new N(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}jgf(bb,lb,Fa=null){A.a(this.$.userOperationManager,lb,Na=>new y.a(bb,0,Na,void 0,Fa),null)}}Object(u.a)(Ba,"ConvertToRangeManager",null,[]);var ka=a(1128),Ka=a(946),Oa=a(13);class wa extends Ka.a{constructor(bb,lb){super(bb);this.ROb=lb}get pc(){return"FormatAsTableDialog"}get iC(){return 215}get Ql(){return Oa.a.instance.ga(732)}ek(){const bb=
B.s(this.kaa.TableRange);return()=>new O(bb,this.hasHeaders,this.ROb,!0)}pH(){const bb=B.s(this.kaa.TableRange),lb=this.kaa.HasTotalRow;return(Fa,Na,Mb)=>ea.h(this.$.pa.ya,bb,this.hasHeaders,!1,lb,this.ROb,Fa,Na,Mb,null)}}Object(u.a)(wa,"FormatAsTableReactDialog",Ka.a,[]);Ka=a(284);var qa=a(89);class aa extends Ka.a{constructor(bb){super(bb);this.jQj=(lb,Fa)=>{1===lb&&this.QUj(B.D(this.uLf(Fa[aa.JQf])))};this.dxb=lb=>{lb=this.lhd(lb);return this.Bed(lb)};this.gridView=S.h(bb);this.ra=this.gridView.ha.ra;
this.krc=this.gridView.Bb.Bj(this.ra.activeCell).usedRange;bb=this.nN(this.krc.toString());this.initializeAndShow(Oa.a.instance.ga(733),this.jQj,bb)}get pc(){return"ResizeTableDialog"}uLf(bb){bb=bb.startsWith("=")?bb.substring(1,bb.length):bb;if(({sheetName:bb,range:lb}=B.Z(bb,this.$.xa)).returnValue&&lb){var lb=B.v(lb,this.$);lb.SheetName=J.a.equals(bb,"",!0)?this.$.na.name:bb;return lb}return null}nN(bb){return{[aa.vV]:"ResizeTableDialog",[aa.JQf]:bb,["getInputErrorIfInvalid"]:this.dxb}}lhd(bb){bb=
this.uLf(bb);if(!bb)return 1;const lb=B.D(bb);return J.a.equals(bb.SheetName,this.$.na.sheetName,!0)&&this.krc.top===lb.top&&this.krc.Ad(lb)?0:2}Bed(bb){let lb="";switch(bb){case 1:lb=Oa.a.instance.ga(75);break;case 2:lb=qa.a.Rg(Oa.a.instance.ga(74))}return lb}QUj(bb){this.$.Xc(-1400250766,t.a.Db,8,{["ResizeTableRange"]:bb,["OriginalTableRange"]:this.krc})}}aa.vV="id";aa.JQf="range";Object(u.a)(aa,"ResizeTableDialog",Ka.a,[]);class ia extends Ka.a{constructor(bb){super(bb);bb=S.h(this.$);bb=bb.Bb.Bj(bb.ha.ra.activeCell);
J.a.ph(bb.oUa)?this.AFd="":this.AFd=bb.oUa;J.a.ph(bb.pUa)?this.zFd="":this.zFd=bb.pUa;bb=this.nN(this.AFd,this.zFd);this.initializeAndShow(Oa.a.instance.ga(742),this.dQj,bb)}get pc(){return"TableAltTextDialog"}dQj(bb,lb){1===bb&&(bb=lb[ia.DSj],lb=lb[ia.Flh],bb===this.AFd&&lb===this.zFd||this.$.Xc(868579142,t.a.Db,8,{["Title"]:bb,["Description"]:lb}))}nN(bb,lb){return{["id"]:"AltTextDialog",["title"]:bb,["description"]:lb}}}ia.vV="id";ia.DSj="title";ia.Flh="description";Object(u.a)(ia,"TableAltTextDialog",
Ka.a,[]);var Ha=a(771),Z=a(772),la=a(112),Xa=a(69),Za=a(55),xa=a(33),fa=a(145),ua=a(101);class sa{constructor(bb,lb,Fa,Na){this.menuId=null;this.wSa=-1;this.oQi=Mb=>{if(!G.a(Mb)){const Cb=S.h(this.$);var dc=new v.Range(1,1,1,1,!0,!1);dc=B.v(dc,this.$);null!=Mb.Result&&(fa.a("CreateSampleTable.NewSheet"),dc.SheetName=Mb.Result.toString());Cb.pg(dc,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.QIf=()=>{this.Kda()};this.x0i=Mb=>{if(!(this.ra.YMa()||(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
G.a(Mb)||this.pNa())&&G.a(Mb)&&this.pNa())){Mb=this.ra.activeCell;var dc=this.ra.activeRange;const Cb=this.tableManager.Ig.usedRange;2===this.wSa&&F.g(this.tableManager.Ig)&&Mb.bottom===Cb.bottom&&(dc=dc.V5?new v.Range(dc.top-1,dc.left,dc.bottom-1,dc.right,!1,!0):new v.Range(dc.top,dc.left,dc.bottom-1,dc.right,!1,!0),Mb=dc.contains(Mb)?Mb:v.Range.Qc(dc.bottom,Mb.left),S.h(this.$).ha.updateSelection(dc,Mb,0,3))}};this.M_i=Mb=>{G.a(Mb)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.af()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.L_i=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.af()};this.O_i=(Mb,dc)=>{dc&&this.GS(dc);G.b(Mb,-569193796)&&(Xa.a(this.$).fd.xM(-569193796),this.nzi(Mb.Errors[0]))};this.$=bb;this.tableManager=lb;this.namedSheetViewPublic=Fa;this.frame=this.$.frame;this.ha=S.h(this.$).ha;this.ra=this.ha.ra;this.Gz=C.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.AB=xa.a.AB(this.$);this.tableStyleManager=Na;this.tableStyleManager.zOg(this.QIf)}nc(bb,lb){switch(lb){case -544558380:return!(this.tableManager&&this.ra.HK()&&!this.pNa()&&F.d(this.tableManager.Ig));case 1544516694:return!(this.tableManager&&(this.ra.HK()?!this.pNa():this.ra.YMa()));case -697806646:case 323142015:return!this.ra.HK();case 341449783:case 2128797448:return C.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ra.HK()?!this.pNa():
this.ra.YMa())):!(this.tableManager&&this.tableManager.Ctd(this.ra.activeCell));case -123538519:return!(this.ra.HK()&&this.tableStyleManager&&this.tableStyleManager.Dtd());case 756677940:return!(C.EwaSettings.ma(403)&&this.wli());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.xli());case 844144422:return!this.ra.HK();case -723113214:return!this.ra.HK();case 1371713064:case 875133075:return!xa.a.AB(this.$)||ua.k(this.$.hg)}return!1}executeCommand(bb,lb,Fa){var Na;
bb=f.TaskExtensions.Rj();const Mb=this.$.pa.ya;let dc=null,Cb=1;const Tb=lb.command,Jb=this.$.pa.ya.Wb();let eb=null;if(this.AB)switch(Tb){case -2058042992:case 504133448:case -798968736:case 477776686:I.d(this.$,Fa.TopCellAddress,Tb,null);break;case -1400250766:I.d(this.$,Fa.OriginalTableRange,Tb,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const ha=S.h(this.$);I.d(this.$,ha.ha.ra.activeCell,Tb,null)}switch(Tb){case -2058042992:const ha=
z.a.li(Fa[t.a.lg]);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!ha.CriteriaType&&(ha.CriteriaType=0);sa.M2f(this.$,ha);dc=(U,ta,ub)=>ea.a(Mb,ha,null,null,!1,!1,!1,Ha.a.C5a(la.a.vHa,Z.a.clearAutoFilter,U),ta,ub,null);Cb=176;eb=()=>new n(ha);break;case 504133448:case -798968736:case 477776686:const fb=z.a.li(Fa[t.a.lg]),rb=Fa.TopCellAddress;sa.M2f(this.$,fb);const pa=504133448===lb.command?1:-798968736===lb.command?2:3;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&
rb){Fa=this.tableManager.Dn(rb);if(!Fa){var za=this.$.xa.na;(null===(Na=B.D(za.$0))||void 0===Na?0:Na.contains(rb))?Fa=B.D(za.$0):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Fa&&!this.$.hZc([Fa],!0,1))break}else if(Fa&&!this.$.Zp([Fa],!0,1))break}dc=(U,ta,ub)=>x.H(Mb,fb,pa,M.b(U,this.O_i),ta,ub,rb,Jb);Cb=177;eb=()=>new r(fb,pa);break;case 341449783:case 2128797448:this.wSa=341449783===Tb?
0:2;({aDa:dc,operationName:Cb,ek:eb}=this.toggleTableStyleOption(Mb,Jb));break;case -712419744:this.Gz?this.Vff(Fa[l.a.event]):this.Vff(null);break;case 875133075:case 1371713064:let Ma=B.r(this.ra.selectedRanges,this.$);if(!Ma)break;const Ja=this.j3h(Fa);dc=(U,ta,ub)=>ea.e(Mb,Ma,Ja,M.b(U,this.oQi),ta,ub,null,Jb);Na="TestHost"===this.$.va.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.va.HostName||Na,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
Cb=1025;break;case 1868184698:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({jAb:Na,aDa:dc,ek:eb}=this.yfg(null,Jb),Na)){Cb=206;break}new ka.a(this.$);break;case 844144422:new aa(this.$);break;case 1544516694:case -544558380:if(Na=Fa[t.a.Ic])this.wSa=this.p5h(Na),-1!==this.wSa&&({aDa:dc,operationName:Cb,ek:eb}=this.toggleTableStyleOption(Mb,Jb));break;case 756677940:if(this.pNa()&&this.Ukf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const Ga=Fa.Text,La=this.AYh();if(La){dc=(ta,ub,hc)=>ea.j(Mb,Ga,La,M.b(ta,this.M_i),M.a(ub,this.L_i),hc,Jb);Cb=217;let U=null;this.tableManager.Ig?U=this.tableManager.Ig.name:this.tableManager.eId?U=this.tableManager.eId.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");U&&(eb=()=>new Y(U,Ga))}else return d.ULS.sendTraceTag(537151175,0,
10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Za.Task.Ta(!1);break;case 323142015:if(this.pNa())break;return(new Ba(this.$,this.Ved(),this.tableManager.Ig.name)).gbb();case -1400250766:Cb=211;dc=this.dpj(Fa,Mb,Jb);const nb=B.m(Fa.OriginalTableRange,this.$.xa.na);eb=()=>new va(nb);break;case 1872288872:this.tableManager.waj();break;case -123538519:const Lb=this.o5h(Fa);Na=J.a.contains(Fa[t.a.Ic],l.a.pIb,!0)||J.a.contains(Fa[l.a.xG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${Na} with style index ${Lb.toString()}`);let ac=this.f7e();ac&&(dc=(U,ta,ub)=>ea.b(Mb,ac,Lb,U,ta,ub,null,Jb),eb=()=>new W(ac,Lb),Cb=212);break;case 753331043:Na=Fa[t.a.Ic];if(!Na)break;const ib=Number.parseInvariant(Na);if(this.ra.HK()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${ib}`);let U=this.f7e();U&&(dc=(ta,ub,
hc)=>ea.h(Mb,U,!1,!1,!1,ib,ta,ub,hc,null,Jb),eb=()=>new O(U,!1,ib,!1),Cb=215);break}if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({jAb:Fa,aDa:dc,ek:eb}=this.yfg(ib,Jb),Fa)){Cb=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${ib}`);new wa(this.$,Number.parseInvariant(Na));break;case 71074531:const Ra=Fa.HasHeader,ya=Fa.TableRange;dc=(U,ta,ub)=>ea.f(Mb,ya,Ra,!1,!1,U,ta,ub,null);eb=()=>
new w.a(Ra,ya);Cb=206;break;case -723113214:new ia(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Cb=1022;const Va=Fa.Title,oa=Fa.Description,kb=this.Ved();dc=(U,ta,ub)=>ea.g(Mb,Va,oa,kb,U,ta,ub,null);let Sa;this.tableManager.Ig&&(za=J.a.ph(this.tableManager.Ig.oUa)?"":this.tableManager.Ig.oUa,Sa=J.a.ph(this.tableManager.Ig.pUa)?"":this.tableManager.Ig.pUa);eb=Va==za?()=>new T(kb,void 0,oa):oa==Sa?()=>new T(kb,Va,void 0):()=>new T(kb,Va,oa);break;default:return H.a(Tb)}if(dc){const ha=
fb=>new y.a(Cb,0,fb,void 0,eb);bb=!this.namedSheetViewPublic||-2058042992!==Tb&&504133448!==Tb&&-798968736!==Tb&&477776686!==Tb?A.a(this.$.userOperationManager,dc,ha,lb):this.namedSheetViewPublic.yTa().continueWith(fb=>{fb.result&&A.a(this.$.userOperationManager,dc,ha,lb)})}return bb}toggleTableStyleOption(bb,lb){const Fa=this.ra.YMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Fa?"PivotTable":"table"} style option ${this.wSa} was toggled.`);const Na=this.Ved();return{aDa:(Mb,
dc,Cb)=>ea.l(bb,Na,this.wSa,M.b(Mb,this.x0i),dc,Cb,null,lb),operationName:196,ek:()=>new ca(Na,this.wSa,Fa)}}dpj(bb,lb,Fa){const Na=bb.OriginalTableRange,Mb=B.m(bb.ResizeTableRange,this.$.xa.na),dc=()=>{this.tableManager.Acg(Na)},Cb=Tb=>{Tb.Errors&&this.tableManager.Acg(Na)};return(Tb,Jb,eb)=>ea.k(lb,Mb,M.b(Tb,Cb),M.a(Jb,dc),eb,null,Fa)}o5h(bb){var lb=-1;bb[t.a.Ic]&&(lb=bb[t.a.Ic],lb=J.a.contains(lb,l.a.pIb,!0)?this.tableStyleManager.cxb(lb):Number.parseInvariant(bb[t.a.Ic]));return lb}j3h(bb){return(bb=
bb[t.a.Ic])?Number.parseInvariant(bb):0}wc(bb,lb){bb=!1;switch(lb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:bb=!0;break;case 756677940:bb=C.EwaSettings.ma(403);break;case 875133075:case 1371713064:bb=xa.a.AB(this.$)}return bb}Jc(bb,lb,Fa){bb=
!1;switch(lb){case "PopulateTableMoreStylesMenu":this.menuId=Fa.MenuId;this.tableStyleManager.Dtd()||this.tableStyleManager.G5a("formatAsTableMenu");bb=this.tableStyleManager.PMf(lb,Fa);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Fa.MenuId,this.tableStyleManager.Dtd()||this.tableStyleManager.G5a("accessibilityTab"),bb=this.tableStyleManager.PMf(lb,Fa)}return bb}dispose(){this.tableStyleManager.Wkj(this.QIf)}Kda(){(J.a.contains(this.menuId,"Format",!0)||J.a.contains(this.menuId,"Accessible",
!0))&&this.menuId&&this.frame.rx(this.menuId)}Ved(){return B.v(this.ra.activeCell,this.$)}AYh(){const bb=this.tableManager.Vud;return bb?B.v(bb,this.$):null}Vff(bb){if(this.tableManager){var lb=S.h(this.$),Fa=this.ra.activeCell,Na=this.tableManager.Dn(Fa),Mb=null;if(!Na||Na.OBa)for(let dc of lb.pia)for(let Cb of dc)lb=Cb.Kt,Fa.left>=lb[0]&&Fa.left<=lb[lb.length-1]&&(Mb=(lb=Cb.vs(Fa).vK())?P.DOMElementExtensions.ik(lb,m.a.rte):null);else{const dc=lb.Sb(v.Range.Qc(Na.top,Fa.left));if(this.Gz){L.a.instance.create(()=>
{dc.invoke(8,bb)},0,X.a.scg,!0,!0);return}Mb=dc.sLa(56).R6a}Mb&&L.a.instance.create(()=>{P.DOMElementExtensions.dhc(Mb,null)},0,X.a.scg,!0,!0)}}p5h(bb){bb=Number.parseInvariant(bb);return-1<bb&&8>=bb?bb:-1}pNa(){return!this.tableManager.Ig}Ukf(){return this.tableManager.eId?!1:(d.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}xli(){const bb=this.ra.HK(),lb=this.ra.Mg&&!S.h(this.$).Bb.N5(this.ra.$c);return bb||lb}wli(){return this.ra.HK()||
!this.Ukf()}s5h(bb){const lb=[];for(const Fa of bb)if(bb=I.b(this.$,Fa),null===bb||void 0===bb?0:bb.length)for(const Na of bb)Na.usedRange&&!lb.includes(Na.usedRange)&&lb.push(Na.usedRange);return lb}f7e(){const bb=this.ra.selectedRanges;let lb=[];if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))lb=this.s5h(bb);else for(const Fa of bb)S.h(this.$).Bb.N5(Fa)&&lb.push(Fa);return lb&&lb.length?B.r(lb,this.$):null}GS(bb){xa.a.Ala(this.$)&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
430,431,1),lb=>{lb.result.Uea(bb);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}nzi(bb){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,446,447,0),lb=>{lb.result.chh(this.$,bb)},this.$.la,3)}static M2f(bb,lb){lb.SheetName=bb.na.name;lb.NamedObjectView=bb.ea.isNamedObjectViewMode}yfg(bb,lb){let Fa,Na;if(!this.ra.Mg||1!=this.ra.$c.sH)return{jAb:!1,aDa:Fa,ek:Na};let Mb=B.v(this.ra.$c,this.$);Mb.LastColumn=Mb.FirstColumn+
3-1;Mb.LastRow=Mb.FirstRow+4-1;const dc=B.D(Mb),Cb=S.h(this.$);if(!dc.Nz||!Cb.Bb.Sxa(dc))return{jAb:!1,aDa:Fa,ek:Na};h.AFrameworkApplication.Rt("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{jAb:!1,aDa:Fa,ek:Na};if(null==bb)Fa=(Tb,Jb,eb)=>ea.f(this.$.pa.ya,Mb,!1,!1,!1,Tb,Jb,eb,lb),Na=()=>new w.a(!1,Mb);else{const Tb=B.s(Mb);Fa=(Jb,eb,za)=>ea.h(this.$.pa.ya,Tb,!1,!1,!1,bb,
Jb,eb,za,lb);Na=()=>new O(Tb,!1,bb,!0)}return{jAb:!0,aDa:Fa,ek:Na}}}Object(u.a)(sa,"TableCommandHandler",null,[165]);class sb extends b.a{constructor(bb){super(bb)}dispose(){super.dispose()}nd(){const bb=e.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya),lb=e.GetServiceTaskFactory.create(this.$.da,330,this.la,this.Ya),Fa=e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya);if(xa.a.AB(this.$)){const Na=e.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Ya);f.TaskExtensions.Aa(Za.Task.mJ(bb,
Fa,lb,Na),()=>{this.Yc([new sa(this.$,bb.result,Fa.result,lb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}else f.TaskExtensions.Aa(Za.Task.mJ(bb,Fa,lb),()=>{this.Yc([new sa(this.$,bb.result,Fa.result,lb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(bb){b.a.Nd(86,new sb(bb))}}Object(u.a)(sb,"TableCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return hb});const hb=()=>{c.a.Fa(bb=>
{sb.ka(bb)})}},1164:function(u,D,a){u=a(0);var c=a(84),b=a(552),e=a(15);class f{constructor(){this.CGc={}}mHg(Ka){this.CGc[Ka.id.toString()]=Ka}ELi(Ka){const Oa=this.CGc;for(let wa in Oa)Oa[wa].notify(Ka,!1);this.CGc={}}C$i(Ka,Oa){Oa&&this.mHg(Oa);return this.XGf(Ka,Oa)}f$c(Ka){this.ELi(Ka)}yPe(Ka,Oa){Ka.notify(Oa,!0)}}Object(u.a)(f,"AEventEmitter",null,[509]);var d;(function(Ka){Ka[Ka.notStarted=0]="notStarted";Ka[Ka.waiting=1]="waiting";Ka[Ka.shouldRetry=2]="shouldRetry";Ka[Ka.complete=3]="complete"})(d||
(d={}));Object(u.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ka){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ka]},"ResultType",this.G6e());this._state=Ka}}Object(u.a)(h,"AEventResult",null,[564]);class m extends h{constructor(){super();this.QTc=this.Nlb=null;this.state=0;this.NMc=this.xbe=!1}get MR(){return this.Nlb}get Moa(){return this.QTc}get Sji(){return this.xbe}G6e(){return"GetMoreInfo Result"}}
Object(u.a)(m,"GetMoreInfoResult",h,[563,564]);var l=a(4),v=a(80),t=a(40),z=a(685),r=a(373),n=a(164),w=a(642),B=a(575),A=a(105),y=a(25);class x{constructor(Ka,Oa,wa,qa,aa,ia,Ha,Z){this.La=Ka;this.yh=Oa;this.Ysg=wa;this.J1=qa;this.fe=aa;this.rLc=ia;this.Ixg=Ha;this.PYb=Z}afj(){this.s$a.Mb(y.a.openUrlInNewTab,A.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.s$a.Mb(y.a.dQa,A.a.frame,Object(c.a)(this,this.dQa,"openDocumentUrl"));l.AFrameworkApplication.XM?this.Crf():this.s$a.Me(y.a.V8b,
A.a.frame,Object(c.a)(this,this.V8b,"documentLoaded"),96)}openUrlInNewTab(Ka,Oa,wa,qa,aa){aa&&aa.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:aa.SourceControlId,["AppType"]:B.a[this.Mca]}),t.a.lf(aa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}dQa(Ka,Oa,wa,qa,aa){if(aa&&aa.MenuItemId){const ia=l.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Ha=l.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");
e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ia,Ha);if(ia&&Ha){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:aa.SourceControlId,["AppType"]:B.a[this.Mca]});Ka=aa.MenuItemId.toString();const Z={};Z[r.a.$Qa]="1";Z[r.a.documentUrl]=Ka;Z[r.a.reason]=w.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.nV().execute(la=>{la.Oj(n.a.Eua,Z)})}else this.openUrlInNewTab(Ka,
Oa,wa,qa,aa)}return 32}V8b(){this.Crf();return 32}xca(Ka,Oa,wa=""){if(Oa&&Oa.PF){const qa=z.a[Oa.status];Oa=Oa.PF.getTime();const aa=this.Ew()-Oa;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Ka,["RequestStatus"]:qa,["ElapsedMs"]:aa,["StartTime"]:Oa,["Notes"]:wa})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ka})}Crf(){var Ka=l.AFrameworkApplication.fa.qa("QPGVCI"),Oa=v.a.ly(document.URL,
"wdNewAndOpenCt",Ka);if(Oa){Oa=parseInt(Oa);var wa=v.a.ly(document.URL,"wdPreviousSession",Ka);Ka=v.a.ly(document.URL,"wdPreviousCorrelation",Ka);var qa=l.AFrameworkApplication.fa.qa("NAOPLP");if(l.AFrameworkApplication.XM){var aa=l.AFrameworkApplication.XM.getTime();!Oa||Oa>aa?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Oa,["DocumentLoadedTime"]:aa,["SessionId"]:wa,["Correlation"]:Ka}):e.ULS.sendTraceTag(5849683,202,
qa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:aa-Oa,["ClickTimestamp"]:Oa,["SessionId"]:wa,["Correlation"]:Ka})}else e.ULS.sendTraceTag(5849681,202,qa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:Oa,["SessionId"]:wa,["Correlation"]:Ka})}}get s$a(){return this.La.value}get aFb(){return this.yh.value}get Uwf(){return this.Ysg.value}get Mca(){return this.J1.value}get Nnc(){return this.fe.value}get Ew(){return this.rLc}get $V(){return this.Ixg.value}get supportsGetMoreInfoForPersonalStorage(){return this.PYb.value}static get instance(){return x.Ma||
(x.Ma=x.hN())}static hN(){return new x(new b.a(()=>l.AFrameworkApplication.ub),new b.a(()=>l.AFrameworkApplication.Bd),new b.a(()=>l.AFrameworkApplication.sa),new b.a(()=>l.AFrameworkApplication.sa.Pa.Fj),new b.a(()=>l.AFrameworkApplication.Fi),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.sa.Pa.$V),new b.a(()=>l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}x.Ma=null;Object(u.a)(x,"NewAndOpenCommonHelpers",null,[508]);var F=a(106);class I{constructor(Ka,Oa,wa){this.aYb=
this.Wi=null;this.cSc=0;this.yDg=Ka;this.fe=Oa;this.T8d=wa}lQg(){this.cSc=this.kdb+1}lOd(Ka){this.Wi&&(this.fe.np(this.Wi),this.Wi=null);Ka&&(this.cSc=0)}mNj(Ka){const Oa=this.sSj;0<=Oa?(this.lQg(),this.lOd(!1),this.Wi=new F.a(4,1,Oa,Ka,107),this.fe.Cg(this.Wi)):(this.lOd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.T8d}))}get kdb(){return this.cSc}get sSj(){return this.kdb>=this.m2f.length?-1:this.m2f[this.kdb]}get m2f(){if(!this.aYb){const Ka=(this.yDg.value||"0").split(",");
this.aYb=[];for(let Oa=0;Oa<Ka.length;Oa++){const wa=parseInt(Ka[Oa]);isNaN(wa)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.T8d,["Entry"]:Ka[Oa]}):Array.add(this.aYb,wa)}}return this.aYb}}Object(u.a)(I,"RetryHelper",null,[]);var L=a(41),X=a(30);class P extends f{constructor(Ka,Oa){super();this.o2=Ka;this.omb=new I(Oa,this.FEb.Nnc,"GetMoreInfo");this.$o=new m}NFi(){this.uyd("Document opened")}veh(Ka){return()=>{this.uyd(Ka,!0)}}XGf(Ka,Oa=
null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ka});3===this.$o.state?(Oa&&this.yPe(Oa,this.$o),e.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ka})):this.uyd(Ka);return this.$o}uyd(Ka,Oa=!1){this.omb.lOd(!Oa);1===this.$o.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ka,["RetryIndex"]:this.omb.kdb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:Ka,["RetryIndex"]:this.omb.kdb}),this.$o.state=1,Oa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.FEb.$V,l.AFrameworkApplication.Zi),this.FEb.aFb.iha(Oa,1,null,null,[P.Ihe,P.Ile],!1,5,this.zdh(),this.ydh(Ka),null))}zdh(){return Ka=>{var Oa=!1;let wa=!1;var qa=!1,aa;l.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(Ka.data.te?({At:aa}=L.d(Ka.data.te)).returnValue?aa?(qa=!0,this.$o.QTc=aa.StorageServiceDisplayName,this.$o.Nlb=P.pnf(aa.PersonalFileStorageUrl)?aa.PersonalFileStorageUrl:
"",""===this.$o.MR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")&&(this.$o.Nlb=v.a.Mda(l.AFrameworkApplication.breadcrumbFolderUrl)),Oa=""===this.$o.MR&&""!==this.$o.Moa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));qa||((aa=Ka.data.responseHeaders)?(this.$o.QTc=(aa[P.Ile]||"").toString(),Oa=(aa[P.Ihe]||"").toString(),this.$o.Nlb=P.pnf(Oa)?Oa:"",""===this.$o.MR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")?(this.$o.Nlb=v.a.Mda(l.AFrameworkApplication.breadcrumbFolderUrl),Oa=""===this.$o.MR&&""!==this.$o.Moa):Oa=""===Oa&&""!==this.$o.Moa):(e.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),wa=!0));qa=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.omb.kdb,wa,Oa,qa);this.FEb.xca("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ka.data,qa);this.F2f(3,Oa,wa)}}ydh(Ka){return Oa=>{this.FEb.xca("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Oa.data,"Failure");this.F2f(2);this.omb.mNj(this.veh(Ka))}}F2f(Ka,Oa=!1,wa=!1){this.$o.state=Ka;this.$o.xbe=
Oa;this.$o.NMc=wa;this.f$c(this.$o)}get FEb(){return this.o2.value}static get instance(){return P.Ma||(P.Ma=P.hN())}static hN(){return new P(new b.a(()=>x.instance),new b.a(()=>l.AFrameworkApplication.PZh))}static pnf(Ka){if(!Ka)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(X.a.vl(Ka).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}P.Ihe="PersonalFileStorageUrl";P.Ile=
"StorageServiceDisplayName";P.Ma=null;Object(u.a)(P,"GetMoreInfoActor",f,[]);var G=a(102),C=a(96);class H{constructor(Ka,Oa,wa,qa,aa){this.oyg=6E4;this.Pdf="inactive";this.qoe="active";this.jT=!0;this.fe=Ka;this.oxg=Oa;this.rLc=wa;this.bZb=qa;this.fb=new C.a;aa&&this.eNj();this.yde=this.g4e()}rWc(Ka){this.fb.addHandler(this.qoe,Ka)}KJg(Ka){this.fb.addHandler(this.Pdf,Ka)}eNj(){const Ka=new F.a(5,2,this.oyg,Object(c.a)(this,this.$ei,"inactiveLoop"),108);this.afi.Cg(Ka)}$ei(){const Ka=this.g4e(),Oa=
this.Ew()-Ka;Oa>this.mCc&&this.jT&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Oa}),this.jT=!1,this.fb.raiseEvent(this.Pdf));Ka-this.yde>this.mCc&&(this.jT=!0,this.fb.raiseEvent(this.qoe));this.yde=Ka}get afi(){return this.fe.value}get g4e(){return this.oxg}get Ew(){return this.rLc}get mCc(){return this.bZb.value}static get instance(){return H.Ma||(H.Ma=H.hN())}static hN(){return new H(new b.a(()=>G.a.instance),()=>l.AFrameworkApplication.wvd.getTime(),()=>
(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.mCc),!0)}}H.Ma=null;Object(u.a)(H,"InactivityManager",null,[]);var J=a(82),M=a(904);class S extends h{constructor(){super();this.Gfe=this.Ife=this.Hfe=null;this.state=this.zme=0;this.NMc=!1}get Xzd(){return this.Hfe}get fwf(){return this.Ife}get Wzd(){return this.Gfe}get ySj(){return this.zme}G6e(){return"MruActor Result"}}Object(u.a)(S,"MruResult",h,[565,564]);var W=a(240);class O{constructor(Ka,Oa,wa){this.task=null;this.Egc=Ka;this.sHi=Oa;
this.taskManager=wa;this.retryCount=this.Ozb=0;this.mRc=this.KCb=null}msi(Ka,Oa){return Ka===W.a.Idd||20===Oa||18===Oa||3===Oa}Ati(Ka){return 3===Ka||5===Ka||6===Ka||7===Ka||9===Ka||10===Ka||11===Ka||12===Ka||13===Ka||14===Ka||15===Ka||16===Ka||23===Ka||26===Ka||27===Ka||28===Ka}get Usc(){return this.mRc}reset(){this.Ozb=this.retryCount=0;this.mRc=this.KCb=null;this.task&&(this.taskManager.np(this.task),this.task=null)}Zii(Ka,Oa,wa,qa){this.mRc=String.format("{0}_{1}",wa,qa);if(this.retryCount>=this.sHi)return e.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.msi(wa,qa))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Ati(qa)&&1<=this.Ozb)return this.KCb=wa,!1;Oa=Math.max(Oa,this.Egc*Math.pow(2,this.Ozb));if(26===qa)Oa=Math.max(Oa,3E4);else if(27===qa||28===qa)Oa=Math.max(Oa,6E4);9===qa||412===wa&&(null==this.KCb||412!==this.KCb)?Oa=500:this.Ozb+=1;this.KCb=wa;this.retryCount+=1;this.task&&this.taskManager.np(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
Oa);this.task=new F.a(2,1,Oa,Ka,107);this.taskManager.Cg(this.task);return!0}}Object(u.a)(O,"RetryManager",null,[]);var T=a(97),Y=a(135),va=a(136);class ca{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(u.a)(ca,"WriteOptions",null,[]);var V=a(556),ra=a(189);class N extends f{constructor(Ka,Oa,wa,qa,aa,ia,Ha){super();this.o2=Ka;this.eAg=Oa;this.Ira=new O(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.Yw.Nnc);this.hsa=new O(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Yw.Nnc);this.vCg=wa;this.Mne=qa;this.GGg={};this.nT=new S;this.kxg=aa;this.nWb="";this.aw=ia;this.S9d=Ha;this.wCg=l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",
25)}get FFc(){return this.GGg}Tgj(){this.Yw.s$a.Mb(y.a.renameMostRecentlyUsedFileEntry,A.a.frame,Object(c.a)(this,this.Plj,"renameMruEntry"))}Plj(){return this.G3d("Rename")}XFi(){this.iuf("File Opened")}YFi(){this.iuf("IntervalUpdate")}iuf(Ka){e.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ka});this.G3d(Ka)}I4(Ka){(Ka=X.a.I4(Ka))&&Ka.startsWith(".")&&(Ka=Ka.substring(1,Ka.length));return Ka}k0e(){switch(this.Yw.Mca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";
case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}X6h(Ka){var Oa=this.kxg();if(!Oa)return null;const wa=new ca;wa.documentUrl=this.S9d.value?encodeURI(Oa):Oa;wa.mruItemId=this.nWb;wa.app=this.k0e();if(Oa=this.aw())wa.folderName=Oa.breadcrumbFolderName,Oa=Oa.un,wa.documentName=X.a.Sq(Oa),wa.documentExt=this.I4(Oa);Ka&&(wa.documentName?wa.documentName.length?255<=wa.documentName.length?Ka.set("DocumentNameLength","Long"):2084<=wa.documentName.length&&Ka.set("DocumentNameLength","VeryLong"):
Ka.set("DocumentNameLength","0"):Ka.set("DocumentNameLength","Null"));return JSON.stringify(wa)}G3d(Ka,Oa=!1){if(4===this.Yw.Mca&&!l.AFrameworkApplication.Dua)return 2;var wa=Y.a.hs();wa&&(wa.set("Trigger",Ka),wa.set("IsRetry",Oa?"true":"false"),wa.set("MruIdSent",this.nWb?"true":"false"),wa.set("URLEncoded",this.S9d.value?"true":"false"));T.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",wa);Ka=this.X6h(wa);if(!Ka)return Oa=!l.AFrameworkApplication.webEditingEnabled,wa&&(wa.set("WebEditingIsEnabled",
l.AFrameworkApplication.webEditingEnabled?"true":"false"),wa.set("ProtectedFile",l.AFrameworkApplication.etc?"true":"false")),T.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Oa,!1,Object.assign(new ra.a,{extendedProperties:wa})),2;this.hsa&&!Oa&&this.hsa.reset();wa=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Yw.$V,this.localeName);this.Mne?this.FFc["X-FileId"]=l.AFrameworkApplication.Zi:wa+=String.format("&{0}",l.AFrameworkApplication.Zi);l.AFrameworkApplication.Pb&&
(this.FFc["X-Office-AudienceGroup"]=Object(J.a)(String,l.AFrameworkApplication.Pb.AudienceGroup)||"");this.FFc["X-Timeout"]=15E3;return this.Yw.aFb.Rm(wa,2,Ka,this.FFc,!0,5,Object(c.a)(this,this.I5j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.fih,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}I5j(Ka){this.K$e(Ka.data)}K$e(Ka){const Oa=Y.a.hs();this.hsa&&(Oa&&this.hsa.Usc&&(Oa.set("LastError",this.hsa.Usc),Oa.set("NumRetries",this.hsa.retryCount.toString())),
this.hsa.reset());const wa=M.c(Ka.te);wa&&wa.diagnostics_data&&(this.nWb=wa.diagnostics_data.mru_id);Ka=+Ka.J3-+Ka.PF;Oa&&Oa.set("RequestDuration",Ka.toString());T.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ra.a,{extendedProperties:Oa}))}fih(Ka){if(Ka.data.httpStatus===W.a.Ssb)this.K$e(Ka.data);else{var Oa=Ka.data.httpStatus===W.a.hIb,wa=Y.a.hs();this.W$e(this.hsa,Ka,this.Thh(),wa);wa&&(wa.set("StatusCode",Ka.data.httpStatus.toString()),Oa||this.AWc(Ka.data,wa));T.Health.instance.recordKpiFailure("WriteMru",
String.format("RequestFailed_{0}",Ka.data.httpStatus),Oa,!1,Object.assign(new ra.a,{extendedProperties:wa}))}}Thh(){return()=>{this.G3d("Retry",!0)}}WZh(){this.R9a("Polling")}VZh(){this.R9a("Retry",!0)}RFi(){this.R9a("Open")}QFi(){this.R9a("Activity")}PFi(){this.R9a("OpenRecentLinks",!1,!0)}OFi(){this.R9a("ActivityRecentLinks",!1,!0)}R9a(Ka,Oa=!1,wa=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ka});const qa=Y.a.hs();qa&&(qa.set("Trigger",Ka),qa.set("IsRetry",Oa?"true":
"false"),wa&&qa.set("RecentLinks","true"));T.Health.instance.recordKpiUsage("GetMru",0,"smartfio",qa);this.Ira&&!Oa&&this.Ira.reset();wa?this.xIe(Object(c.a)(this,this.XZh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(c.a)(this,this.TZh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.xIe(Object(c.a)(this,this.YZh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.UZh,"getMruFromServerFailureCallback"))}AWc(Ka,Oa){Ka&&Ka.responseHeaders&&(Ka=Ka.responseHeaders["X-CorrelationId"])&&
Oa.set("ServerCorrelationId",Ka)}FCi(Ka,Oa){Ka&&(Oa&&Oa.set("RequestDuration",(+Ka.J3-+Ka.PF).toString()),T.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ra.a,{extendedProperties:Oa})))}YZh(Ka){this.L4e(Ka)}L4e(Ka,Oa=!1){var wa="";let qa=null,aa=null,ia=null;const Ha=M.c(Ka.data.te);Ha&&(qa=Ha.places?Ha.places.items:[],aa=Ha.documents?Ha.documents.items:[],(ia=M.a(Ha,Oa))&&(wa=L.c(ia)));l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.C_&&va.c()&&!Oa&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(wa,
!0));wa=Y.a.hs();this.Ira&&(wa&&this.Ira.Usc&&(wa.set("LastError",this.Ira.Usc),wa.set("NumRetries",this.Ira.retryCount.toString())),this.Ira.reset());Oa&&wa&&wa.set("RecentLinks","true");ia||qa||aa?(Oa?this.Yw.xca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Ka.data,"Success"):this.Yw.xca("MruActor.GetMruV2FromServerSuccessCallback",Ka.data,"Success"),this.gEc(3,ia,qa,aa),this.FCi(Ka.data,wa)):(Oa?this.Yw.xca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Ka.data,"Failure: Invalid JSON"):
this.Yw.xca("MruActor.GetMruV2FromServerSuccessCallback",Ka.data,"Failure: Invalid JSON"),wa&&this.AWc(Ka.data,wa),T.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ra.a,{extendedProperties:wa})),this.gEc(3,null,null,null,!0));this.f$c(this.nT)}XZh(Ka){this.L4e(Ka,!0)}W$e(Ka,Oa,wa,qa){let aa=0,ia=0;const Ha=M.c(Oa.data.te);Ha&&(null!=Ha.response_code&&(aa=Ha.response_code,qa&&qa.set("MruResponseCode",aa.toString()),9===aa&&(this.nWb="")),Ha.error_data&&null!=Ha.error_data.retry_after_ms&&
(ia=Ha.error_data.retry_after_ms,qa&&qa.set("ExpectedRetryAfter",ia.toString())));Ka&&(Oa=Ka.Zii(wa,ia,Oa.data.httpStatus,aa),qa&&(qa.set("CurrentRetryCount",Ka.retryCount.toString()),qa.set("RetryScheduled",Oa?"true":"false")))}UZh(Ka){this.K4e(Ka)}K4e(Ka,Oa=!1){const wa=Ka.data.httpStatus===W.a.hIb,qa=Y.a.hs();qa&&(qa.set("StatusCode",Ka.data.httpStatus.toString()),Oa&&qa.set("RecentLinks","true"),wa||this.AWc(Ka.data,qa));Oa?this.Yw.xca("MruActor.GetMruForRecentLinksFromServerFailureCallback",
Ka.data,"Failure"):this.Yw.xca("MruActor.GetMruFromServerFailureCallback",Ka.data,"Failure");this.gEc(2);this.W$e(this.Ira,Ka,Object(c.a)(this,this.VZh,"getMruFromServerRetryTask"),qa);T.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Ka.data.httpStatus),wa,!1,Object.assign(new ra.a,{extendedProperties:qa}));this.f$c(this.nT);l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.C_&&va.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Oa||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}TZh(Ka){this.K4e(Ka,!0)}gEc(Ka,Oa=null,wa=null,qa=null,aa=!1){if(3!==this.nT.state||3===Ka)this.nT.Hfe=Oa,this.nT.Ife=wa,this.nT.Gfe=qa,this.nT.state=Ka,this.nT.NMc=aa,this.nT.zme=this.Yw.Ew()}XGf(Ka,Oa){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ka,["ResultState"]:this.nT.state});Oa&&3===this.nT.state&&this.yPe(Oa,this.nT);return this.nT}xIe(Ka,Oa,wa=!1){this.gEc(1);let qa;const aa={};qa=wa?String.format(this.Yw.$V+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.wCg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Yw.$V+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.k0e(),this.localeName);this.vCg.value||(qa+="&entity=docs");l.AFrameworkApplication.Pb&&(aa["X-Office-AudienceGroup"]=Object(J.a)(String,l.AFrameworkApplication.Pb.AudienceGroup)||"");wa&&(aa["X-Office-Application"]="147");this.Mne?aa["X-FileId"]=l.AFrameworkApplication.Zi:qa+=String.format("&{0}",l.AFrameworkApplication.Zi);this.Yw.aFb.Rm(qa,1,null,aa,
!0,5,Ka,Oa,null)}get Yw(){return this.o2.value}get localeName(){return this.eAg.value}static get instance(){return N.Ma||(N.Ma=N.hN())}static hN(){return new N(new b.a(()=>x.instance),new b.a(()=>V.a.uK(l.AFrameworkApplication.lcid).name),new b.a(()=>l.AFrameworkApplication.sa.Pa.Jv),l.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.sa.Pa.Qx,()=>l.AFrameworkApplication.um,new b.a(()=>l.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}N.Ma=null;Object(u.a)(N,
"MruActor",f,[]);class ea{constructor(){this.pnb=this.Hie=this.gb=null;this.Nm=!1}get name(){return"Common.App.NewAndOpen.Core"}Vh(Ka){this.gb=Ka;Ka.register(508,"Common.INewAndOpenCommonHelpers").xc().Fc(()=>x.instance);Ka.register(509,"Common.IEventEmitter<Common.IGetMoreInfoResult>").xc().Fc(()=>P.instance);Ka.register(509,"Common.IEventEmitter<Common.IMruResult>").xc().Fc(()=>N.instance)}init(){l.AFrameworkApplication.fa.Fv(()=>{this.zzb()})}zzb(){this.gb.resolve("Common.INewAndOpenCommonHelpers");
this.gb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.gb.resolve("Common.IEventEmitter<Common.IMruResult>");var Ka=!1;x.instance.afj();l.AFrameworkApplication.oma&&(Ka=!0);l.AFrameworkApplication.sRf&&(N.instance.RFi(),l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&N.instance.PFi(),0<l.AFrameworkApplication.gwf&&this.Kpe(),this.bDj(),Ka=!0);l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ka&&P.instance.NFi();
l.AFrameworkApplication.X_j&&(Ka=N.instance,Ka.Tgj(),Ka.XFi(),G.a.instance.Cg(this.Y_j))}bDj(){H.instance.rWc(Object(c.a)(N.instance,N.instance.QFi,"makeGetMruRequestActivityTrigger"));l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&H.instance.rWc(Object(c.a)(N.instance,N.instance.OFi,"makeGetMruForRecentLinksRequestActivityTrigger"));H.instance.rWc(Object(c.a)(this,this.Kpe,"addGetMruFromServerTask"));H.instance.KJg(Object(c.a)(this,this.klh,
"deleteGetMruFromServerTask"))}klh(){G.a.instance.np(this.hwf)}Kpe(){G.a.instance.Cg(this.hwf)}get hwf(){return this.Hie||(this.Hie=new F.a(5,2,l.AFrameworkApplication.gwf,Object(c.a)(N.instance,N.instance.WZh,"getMruFromServerTask"),109))}get Y_j(){return this.pnb||(this.pnb=new F.a(2,2,6E4*l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(N.instance,N.instance.YFi,"makeUpdateMruTask"),197))}dispose(){this.Nm||(this.Nm=!0,this.pnb&&
(G.a.instance.np(this.pnb),this.pnb=null))}}Object(u.a)(ea,"CorePackageManager",null,[4,5,2]);var Ba=a(248);a.d(D,"a",function(){return ka});const ka=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");Ba.a.instance.Ei(new ea)}},1168:function(u,D,a){u=a(0);var c=a(4),b=a(222),e=a(15),f=a(84),d=a(54),h=a(195);class m{constructor(){this.yke=this.USc=!1;const Fa=c.AFrameworkApplication.wk;0>=Fa||(this.wk=Fa,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.wk,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Mha}),h.a.instance.NXc(Object(f.a)(this,this.VPa,"onSessionExpiredDetected")),h.a.instance.LXc(Object(f.a)(this,this.THf,"onSessionExpiringDetected")))}VPa(){h.a.instance.LMd(Object(f.a)(this,this.VPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Aai()}THf(){h.a.instance.KMd(Object(f.a)(this,this.THf,"onSessionExpiringDetected"));this.yke||this.USc||(e.ULS.sendTraceTag(20492680,
217,50,"SessionExpiringDetected - Showing expiring dialog."),this.yke=!0,this.TJj())}Aai(){this.USc||(c.AFrameworkApplication.oG(d.a.Mxc),this.USc=!0,this.SJj())}}Object(u.a)(m,"ASessionExpirationManager",null,[]);var l=a(87),v=a(38),t=a(29),z=a(13),r=a(44),n=a(250),w=a(6),B=a(81),A=a(253),y=a(69);class x extends m{constructor(Fa){super();this.Sa=new v.a;this.EH=this.inb=!1;this.$=Fa}gse(Fa){this.Sa.addHandler("SessionExpired",Fa)}p0b(Fa){this.Sa.addHandler("TokenRefreshed",Fa)}zMd(Fa){this.Sa.removeHandler("TokenRefreshed",
Fa)}get accessTokenExpiringMessage(){const Fa=(new Date(this.wk)).format(this.$.va.ShortTimeFormat);return String.format(z.a.instance.nb(78),Fa)}get tokenExpired(){return this.inb}get yeb(){return!1}get jca(){return!1}get PKd(){return!1}get c6(){return!1}jfc(){return h.a.instance.lR(c.AFrameworkApplication.wk)}dispose(){l.a.Ia(this.Sa);this.$=null}TJj(){this.$.isEditMode&&this.Kec(!1)}SJj(){this.inb=!0;this.Kec(!0);this.Sa.raiseEvent("SessionExpired")}Kec(Fa){e.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${Fa}, GotDeploymentOrTimedOutError ${this.$.ea.T4}`);
const Na=this.$.rb.kp;Fa&&Na&&Na.isVisible&&1299163859===Na.error.MessageId&&this.$.rb.kp.sv();const Mb=this.Zc(Fa);r.a(this.$).Ks(new n.a(w.a.hy,5,()=>{const dc=y.a(this.$),Cb=dc.fd.activityState;Cb[B.a.L2]=this.$.sqb(this.$.isEditMode);Cb[B.a.wM]=B.a.p$a;Cb[A.a.Kq]=w.a.accessTokenExpiringWarning;dc.fd.tr([Mb])}))}Zc(Fa){return Fa?t.a.BJe():this.Pgh()}Pgh(){const Fa=t.a.Zc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");Fa.Description=this.accessTokenExpiringMessage;return Fa}}Object(u.a)(x,
"EwaAccessTokenExpirationManager",m,[356,357,2]);var F=a(7),I=a(170),L=a(80),X=a(640),P=a(28);class G{constructor(Fa,Na){this.pJb=!1;this.correlationID=Fa;this.S6c=Na;this.yCc=!1;this.creationTime=P.a.Qa.zb}}Object(u.a)(G,"RefreshAccessTokenContext",null,[]);var C=a(58),H=a(60),J=a(171),M=a(46),S=a(110),W=a(118),O=a(1),T=a(22),Y=a(143),va=a(36),ca=a(115);class V{}Object(u.a)(V,"Error",null,[]);class ra{}Object(u.a)(ra,"NamedResult",null,[]);class N extends ra{}Object(u.a)(N,"ErrorInfo",ra,[]);class ea{constructor(Fa,
Na){this.eZb=Fa;this.WG=Na}get tokens(){return this.eZb}get errors(){return this.WG}}Object(u.a)(ea,"TokenRefreshArgs",null,[353]);class Ba{constructor(Fa,Na){this.documentVisibilityObserver=null;this.Sa=new v.a;this.Mx=null;this.mfb=this.gmb=!1;this.auc=null;this.vJb=!1;this.uxd=!0;this.Jde=this.ide=this.EH=this.inb=!1;this.aT=null;this.L$e=()=>{if(this.$.ea.Zb)this.iaf(!1);else if(this.uxd){this.uxd=!1;const Mb=y.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Mb.fi?
Mb.fi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Pdg()}]`)}};this.Tc=(Mb,dc)=>{this.context&&(Mb=this.$.ea,dc.YH&&this.context.pJb&&!this.context.yCc?(this.context.yCc=!0,dc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},dc.IsUserActive=Mb.Re.Jr,dc.RefreshAccessTokenCorrelationID=this.context.correlationID,dc=C.a.hc(dc),e.ULS.sendTraceTag(537170708,0,50,dc)):!this.gmb||Mb.Zb||this.context.S6c||(dc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
this.Mx&&(this.Mx.cancel(),dc.Aborted=!0,dc.ResetStopRefreshRetriesUntilTokenExpired=!0,this.mfb=!1),dc.TimeUntilTokenExpirationInMin=this.Pdg(),dc.RefreshAccessTokenCorrelationID=this.context.correlationID,dc=C.a.hc(dc),e.ULS.sendTraceTag(572019856,0,50,dc)))};this.Bza=()=>{if(this.context&&this.context.pJb&&!this.context.yCc){var Mb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Mb.CreatedForExpired=this.context.S6c;Mb.RefreshAccessTokenCorrelationID=this.context.correlationID;
Mb.OpenWorkbookErrors=t.a.sc(this.$.ea.fG);Mb.ExecutionContextErrors=t.a.sc(y.a(this.$).fd.errors);Mb.accesstokenTTL=c.AFrameworkApplication.wk;Mb=C.a.hc(Mb);e.ULS.sendTraceTag(537170707,0,15,Mb)}};this.haf=()=>{this.mfb=!1;this.iaf(!0)};this.bFd=()=>{this.vJb&&(this.$.ea.Re.KAa(this.bFd),this.vJb=!1);this.qag()};this.$=Fa;this.PZd=Na;this.NKd=Fa.Jb.Ng("WebServiceCall","refreshToken");h.a.instance.NXc(this.haf);h.a.instance.LXc(this.L$e);Na=this.$.ea;Na.Tj(this.Tc);Na.r0b(this.Bza);this.yIi=this.$.va.MinTokenLifetimeForRegularExpirationPromptInMin;
this.L6f=this.$.va.ShortAccessTokenExpirationPromptSeconds;this.CSf=this.$.va.RefreshAccessTokenDurationLimitInSec;this.Gjg(Fa.ea.WKf,c.AFrameworkApplication.wk);Fa=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.wk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Mha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.u3d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.w3d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${Fa}`);
this.$.da.$a(291,Mb=>{this.documentVisibilityObserver=Mb})}gse(Fa){this.Sa.addHandler("SessionExpired",Fa)}p0b(Fa){this.Sa.addHandler("TokenRefreshed",Fa)}zMd(Fa){this.Sa.removeHandler("TokenRefreshed",Fa)}get tokenExpired(){return this.inb}get jca(){return this.ide}get c6(){return this.Jde}get context(){return this.aT}get yeb(){return this.c6?!1:this.$.ea.Re.Jr?1>ca.a.D6:6>ca.a.E6}get PKd(){return this.gmb}jfc(){return h.a.instance.lR(c.AFrameworkApplication.wk)}dispose(){h.a.instance.LMd(this.haf);
h.a.instance.KMd(this.L$e);const Fa=this.$.ea;Fa&&(Fa.qk(this.Tc),Fa.evc(this.Bza));l.a.Ia(this.Sa);this.documentVisibilityObserver=this.$=null}Pdg(){return this.jfc()?0:(c.AFrameworkApplication.wk-(new Date).getTime())/6E4}Gjg(Fa,Na){if(0<Na&&!this.jfc()){const Mb=c.AFrameworkApplication.fa.ud("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.vY),dc=(Na-Fa.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=dc,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Na}] creationTime [${Fa.getTime()}] tokenLifetimeInMin [${dc}]`);
dc<this.yIi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.L6f}] tokenLifetimeInMin [${dc}]`),c.AFrameworkApplication.vY=this.L6f):c.AFrameworkApplication.vY!==Mb&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Mb}] tokenLifetimeInMin [${dc}]`),c.AFrameworkApplication.vY=Mb)}}fbh(Fa){return!this.context||
this.context.pJb||this.context.S6c!==Fa?(Fa=new G(I.a.create().toString(),Fa),this.context&&!this.context.yCc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${Fa.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.pJb}] `),this.aT=Fa,!0):!1}poj(Fa){Fa&&this.EH&&!this.jca&&this.$.ea.Re.Jr&&!this.c6&&(this.EH=!1)}iaf(Fa){this.poj(Fa);if(!(this.gmb||this.mfb&&!Fa||this.EH)&&
this.yeb){this.gmb=!0;var Na=this.context?this.context.creationTime:null,Mb=this.fbh(Fa);this.uxd=!0;var dc=this.$.ea,Cb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Cb.newContextCreated=Mb;Cb.IsUserActive=dc.Re.Jr;Cb.IsSessionActive=dc.Zb;Cb.ContainsChangesWorkbookOperations=this.$.userOperationManager.Hta();Cb.isSessionExpired=Fa;Cb.stopRefreshRetriesUntilTokenExpired=this.mfb;Cb.FailedToRefreshExpiredToken=this.EH;Cb.numOfFailuresWhileUserIsActive=ca.a.D6;Cb.numOfFailuresWhileUserIsInActive=
ca.a.E6;Cb.numOfFailuresWhileOffline=ca.a.gza;Cb.RefreshAccessTokenCorrelationID=this.context.correlationID;Mb&&Na&&(Cb.TimeInMinFromPreviosContextCreation=Math.round(W.b(P.a.Qa,Na)/60));Na=C.a.hc(Cb);e.ULS.sendTraceTag(40416199,0,50,Na);this.NKd.start();this.ide=dc.Re.Jr;this.Mx=new X.a;this.$zi(Fa);var Tb=this.PZd.Jej(!Fa,this.Mx?this.Mx.token:null);Tb.continueWith(()=>{this.M4g();const Jb=this.PZd.S9i(Tb);this.NKd.stop();const eb=this.jfc();if(!Jb||O.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
eb){const za=Tb.result.errors;Jb&&eb&&this.SIg(za);this.gai(za,Fa)}else this.mfb=!1,this.hai(Tb.result.tokens,Fa);this.gmb=!1},8)}}SIg(Fa){const Na=[Object(F.a)(new V,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];Fa.add(Object(F.a)(new N,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Na}))}$zi(Fa){Fa&&(this.$.ea.Re.Jr?this.qag():(this.$.ea.Re.pha(this.bFd),this.vJb=!0))}qag(){this.auc=J.AsyncMethodContext.Gr(()=>{this.Iej()},1E3*this.CSf,M.a.rej,this.auc)}M4g(){this.auc&&
this.auc.cancel();this.vJb&&(this.$.ea.Re.KAa(this.bFd),this.vJb=!1);this.Mx=null}Iej(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.CSf}]`);this.Mx.cancel()}gai(Fa,Na){this.mfb=!0;Na&&(this.EH||(this.inb=this.EH=!0),this.PZd.pBb(Fa)&&(this.Jde=!0));const Mb=!Na||this.yeb&&!ca.a.zzc?40380379:39982555;Na=this.bIe(Na);Na.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Na.FailedToRefreshExpiredToken=
this.EH;Na.LastErrorIsPermanent=this.c6;if(0<Fa.count){var dc=Fa.oa(0);Na.errorName=dc.Name;0<dc.Errors.length&&(Na.ErrorId=dc.Errors[0].Id,dc=dc.Errors[0].Details,Na.ErrorDetails=this.sph(dc.toString())?"PiiScrubbed":dc)}Na=C.a.hc(Na);e.ULS.sendTraceTag(Mb,0,15,Na);this.Sa.raiseEvent("TokenRefreshed",new ea(null,Fa))}sph(Fa){return T.a.contains(Fa,"makes the internet safe for businesses",!0)}bIe(Fa){const Na={},Mb=this.$.ea;Na.Name="";Na.IsUserActive=Mb.Re.Jr;Na.IsSessionActive=Mb.Zb;Na.GotDeploymentOrTimedOutError=
Mb.T4;Na.TimeInSecFromLastStatefulSuccessfulRequest=Mb.n1;Na.TimeFromLastUserActivityInMs=Mb.Re.Nfb;Na.calledFromSessionExpiredFlow=Fa;Na.RefreshTokenDurationInMS=this.NKd.zc;Na.numOfFailuresWhileUserIsActive=ca.a.D6;Na.numOfFailuresWhileUserIsInActive=ca.a.E6;Na.numOfFailuresWhileOffline=ca.a.gza;Na.RefreshAccessTokenCorrelationID=this.context.correlationID;Na.accessTokenTTL=c.AFrameworkApplication.wk;Na.ContainsChangesWorkbookOperations=this.$.userOperationManager.Hta();Na.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.si.toString():"Unknown";Na.TimeFromFirstOpenInHr=Math.floor(W.b(P.a.Qa,S.toUtc(Mb.WKf))/3600);return Na}hai(Fa,Na){this.EH=!1;this.A1j();this.Gjg(new Date,c.AFrameworkApplication.wk);const Mb=this.$.ea,dc=!Na&&Mb.Re.Jr,Cb=!this.$.isEditMode&&Mb.bcb;Na=this.bIe(Na);Na.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Na.shouldTriggerSilentReloadAfterExpiring=dc;Na.WopiTokenTaskItemPriority=c.AFrameworkApplication.w3d;Na.isDirtyViewSession=Cb;Na=C.a.hc(Na);
e.ULS.sendTraceTag(39982556,0,15,Na);this.Sa.raiseEvent("TokenRefreshed",new ea(Fa,null));Cb?Mb.Re.Jr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Mb.Odd()):Mb.Re.Jr?dc&&(Fa=y.a(this.$).fd.activityState,Fa[ca.a.fgb]=!0,Fa[Y.a.zY]=!0,Fa[va.a.cs]=this.$.isEditMode,r.a(this.$).Ks(new n.a(w.a.foa,2,null))):Mb.Zb&&H.j(this.$.pa.ya,!0,!1,!1,null,null,null,null,
null)}A1j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=L.a.MT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.KP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=L.a.MT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.wY,c.AFrameworkApplication.wk.toString()),this.$.ea.Xqc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.va.AccessToken=c.AFrameworkApplication.accessToken;this.$.va.AccessTokenValidTo=c.AFrameworkApplication.wk;void 0!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.MT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.KP,c.AFrameworkApplication.accessToken),this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion=L.a.MT(this.$.va.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.wY,c.AFrameworkApplication.wk.toString()));void 0!==this.$.va.EmbedConfiguratorUrl&&null!==this.$.va.EmbedConfiguratorUrl&&(this.$.va.EmbedConfiguratorUrl=L.a.MT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.KP,c.AFrameworkApplication.accessToken),this.$.va.EmbedConfiguratorUrl=L.a.MT(this.$.va.EmbedConfiguratorUrl,c.AFrameworkApplication.wY,c.AFrameworkApplication.wk.toString()));this.context.pJb=!0}}Object(u.a)(Ba,"EwaAccessTokenExpirationRefreshManager",null,[356,
357,2]);var ka=a(187),Ka=a(157),Oa=a(82),wa=a(416);class qa{}qa.j_b="ActivityDuration";qa.error="Error";qa.ead="Errors";qa.failed="Failed";qa.HIh="FirstActivity";qa.initialized="Initialized";qa.myi="LastActivity";qa.hZf="RetryOverride";qa.Onj="RequestGroups";qa.requests="Requests";qa.WYf="Responses";qa.Nxc="SessionDuration";qa.status="Status";qa.success="Success";qa.successful="Successful";qa.tokens="Tokens";Object(u.a)(qa,"SessionExpirationStrings",null,[]);var aa=a(106);class ia{constructor(Fa){this.Zo=
{};this.QX={};this.SBg={};this.wrf=15;this.dde=!1;this.CDg=new Date;this.MVb=new Date;this.fe=Fa;this.VYb=new aa.a(2,2,6E4*this.wrf,Object(f.a)(this,this.zmg,"writeMeasures"),135,"SL",!1);this.fe.Cg(this.VYb);this.$hi()}zmg(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.hc({["Aggregate"]:this.QX,["Current"]:this.Zo}))}$hi(){this.QX[qa.Onj]=0;this.QX[qa.requests]=0;this.QX[qa.WYf]=0;this.QX[qa.status]=qa.initialized;this.QX[qa.HIh]=new Date;this.QX[qa.Nxc]=0;this.QX[qa.j_b]=0;this.QX[qa.Nxc]=0;this.Zo[qa.Nxc]=
0;this.QX[qa.j_b]=0;this.Zo[qa.j_b]=0}Dnd(Fa,Na){var Mb=Fa[Na];Mb=Mb?Mb:0;Mb++;Fa[Na]=Mb;this.fSd(Fa)}fSd(Fa){const Na=new Date;Fa[qa.j_b]=+Na-+this.MVb;this.MVb=Na;Fa[qa.Nxc]=+this.MVb-+this.CDg;Fa[qa.myi]=this.MVb}X0(Fa,Na){this.Zo[Fa]=Na;this.fSd(this.Zo)}ERd(Fa,Na){this.Zo[Fa]=Na;this.fSd(this.Zo)}incrementCounter(Fa){this.Dnd(this.Zo,Fa);this.Dnd(this.QX,Fa);this.Dnd(this.SBg,Fa)}flush(){this.dde||(this.QX[qa.status]=this.Zo[qa.status],this.zmg(this.VYb),this.fe.Kna(this.VYb,6E4*this.wrf))}stop(){e.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.dde=!0;this.fe.np(this.VYb)}}Object(u.a)(ia,"SessionLogger",null,[463]);var Ha=a(97),Z=a(641),la=a(30),Xa=a(373),Za=a(164),xa=a(937),fa=a(189),ua=a(165);class sa{constructor(Fa,Na,Mb,dc=null,Cb=!1,Tb=null,Jb=!1,eb=!1){this.P9=0;this.A2=this.Wi=null;this.eZb=new ka.a;this.WG=new ka.a;this.vk=null;this.GVb=!1;this.knb=this.lnb=null;this.fe=Fa;this.Xhe=Na;this.Xhe.execute(za=>{za.em(Za.a.Hmd,Object(f.a)(this,this.KUi,"onHostResponseReceived"))});
this.dH=Mb;this.Ame=new xa.a("WebServiceCall","TokenRefresh");this.jh=dc||new ia(Fa);this.xDg=Cb;this.xT=Tb?Tb:Z.SessionStatusManager.instance;this.R9d=Jb;this.gUb=eb}KUi(Fa){if(Fa.MessageId!==Za.a.Hmd)ua.a(39408099,306,15,"Unexpected message.");else{var Na=new ka.a,Mb=new ka.a;this.jh.incrementCounter(qa.WYf);var dc=Fa.Values[Xa.a.s2f];if(!dc||0>=dc.length)ua.a(40122317,306,15,"Found no tokens in the dictionary"),dc=Fa.Values;ua.a(40122318,306,100,"The Tokens array contains {0} tokens",dc.length);
this.jh.X0("Correlation",Fa.CorrelationId);var Cb="";for(let eb=0;eb<dc.length;eb++){this.jh.ERd(qa.tokens,dc.length);var Tb=dc[eb],Jb=Tb;if(!Jb||!Jb.Name)continue;this.jh.incrementCounter(Jb.Name);const za=Tb;if(za&&za.Value)ua.a(39408128,306,100,"Received token with name: {0}",za.Name),Na.add(za),this.eZb.add(za),this.gUb||this.jh.X0(qa.status,qa.success),this.R9d&&this.xT&&this.xT.Qoj();else if(Tb=this.r3h(Tb),ua.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Jb.Name,JSON.stringify(Tb),this.A2),Mb.add(Tb),this.gUb||(this.WG.add(Tb),Cb=JSON.stringify(Tb),this.jh.X0(qa.error,JSON.stringify(Tb)),this.jh.X0(qa.status,qa.failed)),this.R9d)for(const ha of Tb.Errors)Jb=this.fVh(ha),this.xT&&this.xT.lLg(Jb)}this.gUb?(0<Mb.count?this.knb?this.knb(new ea(Na,Mb)):ua.a(512267295,306,15,"Received errors but the promise has completed"):this.lnb?this.lnb(new ea(Na,Mb)):ua.a(512267294,306,15,"Received valid tokens but the promise has completed"),ua.a(512344162,306,50,
"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Na.count,Mb.count,Fa.CorrelationId,this.A2)):(0<Mb.count&&""!==Cb?(dc=Object.assign(new fa.a,{extendedProperties:new Map}),dc.extendedProperties.set("Errors",Cb),dc.extendedProperties.set("RetryCount",this.P9.toString()),dc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Ha.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,dc)):Ha.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),ua.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Na.count,Mb.count,Fa.CorrelationId,this.A2),0<Mb.count&&!this.pBb(Mb)?(Fa=this.dH.H6e(Mb),Fa!==this.dH.ldb&&(this.jh.ERd(qa.hZf,Fa),this.fe.Kna(this.Wi,Fa))):(this.jh.flush(),this.Wi&&(ua.a(39408131,306,100,"Deleting task {0} from task manager",this.Wi.name),this.fe.np(this.Wi)),this.vk&&!this.vk.task.isCompleted?this.vk.setResult(new ea(Na,Mb)):ua.a(512267293,306,15,"Received results but the task has completed")))}}r3h(Fa){if(!Fa)return null;
const Na=Object.assign(new N,{Name:Fa.Name,Errors:[]});for(const Mb of Fa.Errors)Fa=new V,Fa.Id=Mb.Id,Fa.Details=la.a.V6e(Mb.Details,500),Na.Errors.push(Fa);return Na}requestTokensOnce(){this.cYf()}cYf(){c.AFrameworkApplication.JDb("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.P9>=this.dH.Quf?(ua.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.A2),this.hIe(this.vk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):
(Ha.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.E1f())}E1f(){const Fa={};Fa[Xa.a.s2f]=this.dH.tokens;const Na=I.a.create().toString();ua.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.dH.tokens),this.P9+1,Na,this.A2);this.Xhe.execute(Mb=>{Mb.Oj(Za.a.Bue,Fa,Na)});this.P9++;this.jh.incrementCounter(qa.requests)}hIe(Fa,Na,Mb){const dc=new ka.a;for(let Cb=0;Cb<this.dH.tokens.length;Cb++){const Tb=Object.assign(new N,
{Name:this.dH.tokens[Cb],Errors:[Object.assign(new V,{Id:Na,Details:Mb})]});dc.add(Tb);this.WG.add(Tb)}this.fe.np(this.Wi);this.jh.X0(qa.ead,JSON.stringify(this.WG));this.jh.X0(qa.status,qa.failed);Fa&&!Fa.task.isCompleted&&Fa.setResult(new ea(new ka.a,this.WG))}Jej(Fa,Na=null){c.AFrameworkApplication.JDb("258ec738;j5j99381");this.Ame.start();this.GVb=Fa;this.A2=I.a.create().toString();ua.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.A2,this.GVb);this.P9=0;this.WG.clear();
this.eZb.clear();const Mb=new Ka.a;this.vk=Mb;Na&&Na.R(()=>{const dc=!!Mb&&!Mb.task.isCompleted;ua.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.A2,this.GVb,dc);dc&&this.hIe(Mb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.gUb?this.dYf(this.dH.Quf).then(dc=>{this.vk&&!this.vk.task.isCompleted&&this.vk.setResult(dc);this.knb=this.lnb=null;this.jh.X0(qa.ead,JSON.stringify(this.WG));this.jh.X0(qa.status,qa.success);
this.jh.flush()}).catch(dc=>{this.vk&&!this.vk.task.isCompleted&&this.vk.setResult(Object(Oa.a)(353,dc));this.knb=this.lnb=null;this.jh.X0(qa.ead,JSON.stringify(this.WG));this.jh.X0(qa.status,qa.failed);this.jh.flush()}):(this.Wi=new aa.a(this.dH.priority,2,this.dH.ldb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Za.a.Bue,!0),this.xDg&&this.cYf(),this.fe.Cg(this.Wi));return this.vk.task}dYf(Fa){const Na=this,Mb=new Promise((eb,za)=>{Na.lnb=eb;Na.knb=za;Ha.Health.instance.recordKpiUsage("WACTokenRefresh",
1,"wwrelfc",null);Na.E1f()}),dc=this,Cb=new Promise((eb,za)=>{window.setTimeout(()=>{za(dc.mIe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},dc.dH.ldb)});let Tb=Fa;const Jb=this;return new Promise((eb,za)=>{Tb--;Promise.race([Mb,Cb]).then(ha=>{Ha.Health.instance.recordKpiSuccess("WACTokenRefresh",null);eb(ha)}).catch(ha=>{var fb=Jb.dH.ldb;if(Object(wa.a)(353,ha)&&(ha=Object(Oa.a)(353,ha),0<ha.errors.count)){Jb.nCi(ha.errors);Jb.tr(ha.errors);if(Jb.pBb(ha.errors)){za(ha);
return}const rb=Jb.dH.H6e(ha.errors);rb!==Jb.dH.ldb?(Jb.jh.ERd(qa.hZf,rb),fb=rb):Jb.Jvi(ha.errors)&&(fb=0)}Tb?window.setTimeout(()=>{Jb.dYf(Tb).then(eb).catch(za)},fb):(fb=Jb.mIe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Jb.tr(fb.errors),za(fb),ua.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Jb.A2))})})}tr(Fa){for(let Na of Fa)this.WG.add(Na)}Jvi(Fa){if(!Fa.count)return!1;Fa=Fa.oa(Fa.count-1);
return Fa.Errors.length?"TIMEOUT"==Fa.Errors[0].Id:!1}mIe(Fa,Na){const Mb=new ka.a;for(let dc=0;dc<this.dH.tokens.length;dc++){const Cb=this.Wch(this.dH.tokens[dc],Fa,Na);Mb.add(Cb)}return new ea(new ka.a,Mb)}Wch(Fa,Na,Mb){return Object.assign(new N,{Name:Fa,Errors:[Object.assign(new V,{Id:Na,Details:Mb})]})}nCi(Fa){if(Fa.count){Fa=Fa.oa(Fa.count-1);Fa=JSON.stringify(Fa);var Na=Object.assign(new fa.a,{extendedProperties:new Map});Na.extendedProperties.set("Errors",Fa);Na.extendedProperties.set("RetryCount",
this.P9.toString());Na.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());Ha.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Na);this.jh.X0(qa.error,Fa);this.jh.X0(qa.status,qa.failed)}}S9i(Fa){this.Ame.stop();const Na=this.vbi(Fa.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!Na,this.A2,this.GVb,this.P9,this.WG.count,0<Fa.result.errors.count?Fa.result.errors.oa(0).Name:"",0<Fa.result.errors.count&&0<Fa.result.errors.oa(0).Errors.length?Fa.result.errors.oa(0).Errors[0].Id:"",0<Fa.result.errors.count&&0<Fa.result.errors.oa(0).Errors.length?Fa.result.errors.oa(0).Errors[0].Details:"");return Na?!1:this.R9i(Fa.result.tokens)}pBb(Fa){return this.dH.pBb(Fa)}R9i(Fa){for(let Na=0;Na<Fa.count;Na++){const Mb=Fa.oa(Na);if(Mb.Name===Xa.a.accessToken){const dc=(new Date).getTime();
Mb.Expiry>c.AFrameworkApplication.wk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Mb.Expiry,["NowGetTime"]:dc,["BootTime"]:c.AFrameworkApplication.Mha},"PreviousAccessTokenTtl",c.AFrameworkApplication.wk),c.AFrameworkApplication.accessToken=Mb.Value,c.AFrameworkApplication.wk=Math.floor(Mb.Expiry),c.AFrameworkApplication.v3d=dc,c.AFrameworkApplication.kZa=Math.floor(Mb.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Mb.Expiry,["NowGetTime"]:dc,["BootTime"]:c.AFrameworkApplication.Mha},"PreviousAccessTokenTtl",c.AFrameworkApplication.wk)}}return!0}vbi(Fa){let Na=!1;for(let Mb=0;Mb<Fa.count;Mb++){Na=!0;const dc=Fa.oa(Mb);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",dc.Name,JSON.stringify(dc.Errors),this.A2)}return Na}fVh(Fa){let Na=d.a.Mxc;Fa=parseInt(Fa.Id);if(isNaN(Fa))Na=d.a.d5j;else{switch(Fa){case 401:Na=d.a.g5j;break;case 403:Na=d.a.b5j;
break;case 500:Na=d.a.c5j;break;case 503:Na=d.a.f5j}Na===d.a.Mxc&&(Na=500<Fa?d.a.e5j:d.a.a5j)}return Na}}Object(u.a)(sa,"TokenRefreshManager",null,[354]);class sb{constructor(){this.ldb=c.AFrameworkApplication.j5j;this.Quf=c.AFrameworkApplication.h5j;this.tokens=c.AFrameworkApplication.d8h();this.priority=c.AFrameworkApplication.w3d;this.jje=this.LAj();this.pVc=c.AFrameworkApplication.c8h()}pBb(Fa){Fa=JSON.stringify(Fa);if(this.pVc&&0<this.pVc.length)for(const Na of this.pVc)if(0<Na.length&&0<=Fa.indexOf(Na))return!0;
return!1}H6e(Fa){try{if(Fa)for(let Na of Fa)if(Na.Errors)for(const Mb of Na.Errors)if(Mb.Id in this.jje)return Number.parseInvariant(this.jje[Mb.Id].toString())}catch(Na){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Na.toString())}return this.ldb}LAj(){const Fa={};try{if(!c.AFrameworkApplication.vec()||0>=c.AFrameworkApplication.vec().length||""===c.AFrameworkApplication.vec()[0])return Fa;for(const Na of c.AFrameworkApplication.vec())0<Na.length&&
(Fa[Na]=c.AFrameworkApplication.i5j)}catch(Na){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Na.toString())}return Fa}}Object(u.a)(sb,"TokenRefreshPolicy",null,[352]);class hb extends b.a{constructor(Fa){super();this.$=Fa;this.Fb()}create(){c.AFrameworkApplication.ON("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.ob(this.adh()):
this.ob(this.$.da.za(38)||this.$.da.Ga(38,new x(this.$)))}adh(){var Fa=this.$.da.za(38);if(Fa)return Fa;Fa=new sa(c.AFrameworkApplication.Fi,c.AFrameworkApplication.nV(),new sb);return this.$.da.Ga(38,new Ba(this.$,Fa))}static ka(Fa){Fa.da.Ga(39,new hb(Fa))}}Object(u.a)(hb,"AccessTokenExpirationManagerFactory",b.a,[]);var bb=a(9);a.d(D,"a",function(){return lb});const lb=()=>{bb.a.Fa(hb.ka)}},1199:function(u,D,a){u=a(0);var c=a(84),b=a(146);class e extends b.a{constructor(y){super(!1,!1,!0);this.cSb=
y}start(){const y={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.cSb.Mmd}};this.initializeAndShow("",Object(c.a)(this,this.Ppj,"resultHandler"),y)}Ppj(y,x){1===y&&(this.cSb.Mmd=x.tooltipPersistenceEnabled)}}Object(u.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(105),d=a(25);class h{constructor(y,x){this.La=y;this.cSb=x}Fg(){this.La.Mb(d.a.pHj,f.a.frame,Object(c.a)(this,this.qHj,"showAccessibilitySettingsDialogHandler"))}qHj(){(new e(this.cSb)).start();
return 32}}Object(u.a)(h,"AccessibilitySettingsDialogActor",null,[264]);var m=a(157),l=a(4);const v=y=>{const x=new m.a;l.AFrameworkApplication.Bd.Rm(t(y),1,null,null,!0,2,F=>{200===F.data.httpStatus?x.setResult("true"===F.data.te.toLowerCase()):x.setResult(!1)},()=>{x.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return x.task},t=y=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",y,l.AFrameworkApplication.Zi);
var z=a(136);class r{constructor(){this.hXa=null}get Mmd(){return!!this.hXa}set Mmd(y){y!==this.hXa&&(this.hXa=y,z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(y),this.Clf()&&l.AFrameworkApplication.Bd.Rm(t("saveHoverableRibbonTooltipIsEnabled"),2,y.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}DAi(){const y=new m.a;if(this.hXa)y.setResult(this.hXa);else if(this.Clf()){const x=v("getHoverableRibbonTooltipIsEnabled");x.continueWith(()=>
{this.hXa=x.result;z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(x.result);y.setResult(x.result)},8)}else y.setResult(!1)}Clf(){const y=l.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),x=l.AFrameworkApplication.fa.qa("IsAnonymousUser");return y&&!x}}Object(u.a)(r,"AccessibilitySettingsInfo",null,[262]);var n=a(248),w=a(165);class B{constructor(){this.gb=null}get name(){return"Common.App.AccessibilitySettings"}Vh(y){this.gb=y;this.gb.register(r,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(()=>
new r).xc();this.gb.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(()=>new h(l.AFrameworkApplication.ub,this.gb.Jh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).xc()}init(){const y=this.gb.Jh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),x=this.gb.Jh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");y&&x?(x.Fg(),y.DAi()):w.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){n.a.instance.Ei(new B)}}Object(u.a)(B,"AccessibilitySettingsPackage",null,[4,5]);a.d(D,"a",function(){return A});const A=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");B.main()}},1200:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(87),d=a(27),h=a(416),m=a(1126),l=a(521),v=a(186),t=a(225),z=a(24),r=a(64),n=a(42),w=a(162),
B=a(211),A=a(47),y=a(46),x=a(12),F=a(71),I=a(127),L=a(1),X=a(11),P=a(21),G=a(343),C=a(239),H=a(14),J=a(156),M=a(94),S=a(5),W=a(249),O=a(76),T=a(44),Y=a(34);class va extends M.a{constructor(la,Xa,Za,xa){super(la);this.Bcg=[6];this.vcg=[26];this.fs=null;this.cBb=this.pkc=!1;this.Ds=this.wba=null;this.C5=!1;this.onPointerDown=fa=>{if(1!==this.$.Ka.NH())return!0;fa=Y.a(this.$).Vd(fa);if(this.CB)return!0;var ua=T.a(this.$).ird||T.a(this.$).oq();if(this.ctd||ua)return this.Zcb(),!0;this.Ds=this.im;this.DLd();
this.omd();ua=2===fa.tb&&fa.jo===Sys.UI.MouseButton.leftButton;const sa=3===fa.tb;if(ua||sa)fa=this.ha.ko(fa.clientPoint,fa.Gb,5,void 0,void 0,!0),fa||(fa=this.Ds),this.cBb=ua,this.pkc=sa,this.Ds=this.E8e(fa),this.omd(),ua?this.Rfj():sa&&this.Kgj(),W.b(this.$,!0);return!0};this.Fh=fa=>{fa=Y.a(this.$).Vd(fa);if(!this.CB)return!1;let ua=this.cBb?this.ha.ko(fa.clientPoint,fa.Gb,5,void 0,void 0,!0):this.ha.ko(fa.clientPoint,fa.Gb,5,!0,!1,!0);this.C5&&!ua&&(ua=this.ha.hpb(fa.clientPoint,fa.Gb,5));ua&&
(fa=this.E8e(this.a_a(ua)),this.F2b(fa.bottomRight),this.Ds.equals(fa)||(this.Ds=fa,this.KJb(!1),this.DLd(!1),this.omd(!1),this.rdi(),this.qb.update(!1)),this.DZj(this.Ds));return!0};this.Of=fa=>{Y.a(this.$).Vd(fa);if(!this.CB)return!1;this.resizeTable();this.Zcb();return!0};this.VGb=fa=>{Y.a(this.$).Vd(fa);if(!this.CB)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Zcb();return!0};this.k0=fa=>{Y.a(this.$).Vd(fa);
this.Zcb();return!0};this.Xzf=()=>{this.CB&&this.Zcb()};this.gridView=Xa;this.$=Xa.$;this.tableManager=xa;this.ha=Xa.ha;this.qb=Xa.qb;this.parentElement=la;this.CZg();d.a.Fp||d.a.z5||C.a.instance.ta(H.a.pointerDown,this.wba,this.onPointerDown);this.im=Za;this.UNc=this.ctd=!1;this.tableManager.ULg(this.Xzf);this.C5=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7030316_NewTableResizeExperience")}get CB(){return this.cBb||this.pkc}get Dmf(){return this.UNc}dispose(){this.Zcb();this.tableManager.Rij(this.Xzf);
this.Dmf||d.a.Fp||d.a.z5||C.a.instance.Ba(H.a.pointerDown,this.wba,this.onPointerDown);if(this.CB){W.b(this.$,!1);try{this.Wv()}catch(la){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${la}`)}}this.parentElement&&this.parentElement.contains(this.wba)&&this.parentElement.removeChild(this.wba);this.wba=this.parentElement=null;super.dispose()}E8e(la){const Xa=la.bottom-this.im.topLeft.bottom-1;return 0<=la.right-this.im.topLeft.right+
1&&0<=Xa&&la.bottom>=this.im.top&&la.right>=this.im.left?new z.Range(this.im.top,this.im.left,la.bottom,la.right,!1,!1):this.Ds}omd(la=!0){this.ryc([this.Ds],6,la);this.qb.Tn(this.Bcg)}KJb(la=!0){this.qb.Wg(this.Bcg);this.ryc([null],6,la)}DLd(la=!0){this.qb.Wg(this.vcg);this.ryc([null],26,la)}rdi(){const la=this.iQj();0<la.length&&(this.ryc(la,26,!1),this.qb.Tn(this.vcg))}iQj(){const la=[];this.im.contains(this.Ds)&&(this.im.right!==this.Ds.right&&la.push(new z.Range(this.im.top,this.Ds.right+1,this.Ds.bottom,
this.im.right,!1,!1)),this.im.bottom!==this.Ds.bottom&&la.push(new z.Range(this.Ds.bottom+1,this.im.left,this.im.bottom,this.im.right,!1,!1)));return la}resizeTable(){if(!this.Ds.equals(this.im)){const la=new z.Range(this.im.top,this.im.left,this.Ds.bottom,this.Ds.right,!1,!1);this.WUj(la);this.ctd=!0}}onKeyDown(la){Y.a(this.$).Vd(la);return!0}W$a(){this.Dmf&&(d.a.Fp||d.a.z5||(C.a.instance.ta(H.a.pointerDown,this.wba,this.onPointerDown),this.wba.classList.remove("ewr-table-resize-default-cursor"),
this.UNc=this.wba.disabled=!1),this.UNc=!1)}CZg(){const la=document.createElement("div");la.className="ewr-table-resize-handle";const Xa=document.createElement("div");Xa.className="ewr-table-resize-fillhandle-higher";const Za=document.createElement("div");Za.className="ewr-table-resize-fillhandle-broader";la.appendChild(Xa);la.appendChild(Za);this.wba=la;this.parentElement.appendChild(this.wba)}F2b(la){const Xa=this.C5?2:5;let Za=60;const xa=this.Ds.contains(la);let fa=la.top,ua=la.bottom,sa=la.left,
sb=la.right,hb=null;if(xa){if(this.gridView.MK(this.im.topLeft)&&!this.im.OBa)return;this.C5?la.bottom<this.Ds.bottom?(fa=Math.max(1,ua-Xa,this.im.top),Za=16):(sa=Math.max(1,sb-Xa,this.im.left),Za=4):(fa=Math.max(1,ua-Xa,this.im.top),sa=Math.max(1,sb-Xa,this.im.left));ua=fa;sb=sa;hb=new z.Range(fa,sa,fa,sa,!1,!1)}else this.C5?la.right>=this.im.right?(sb+=Xa,Za=8):la.bottom>=this.im.bottom&&(ua+=Xa,Za=32):(ua+=Xa,sb+=Xa),fa=ua,sa=sb,hb=new z.Range(ua,sb,ua,sb,!1,!1),Za=16;this.gridView.MK(hb)||(this.fs?
this.fs.Gp||(this.fs=A.a.instance.create(()=>{this.gridView.Ht(hb,Za,"TableResizeBehavior.BringRangeIntoView")},40,y.a.zcg)):this.fs=A.a.instance.create(()=>{this.gridView.Ht(hb,Za,"TableResizeBehavior.BringRangeIntoView")},40,y.a.zcg))}a_a(la){let Xa=la;if(this.gridView.ib.Y4){if(!this.gridView.Sb(la.topLeft)){const Za=this.gridView.fk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.KH,this.Ds.top!==la.top?1:2);try{Za.Rk=this.Ds.top<la.top||this.Ds.left<la.left,Za.Hs(la.topLeft),Xa=Za.$$cu().range}finally{Za&&
Za.dispose()}}Xa.right=Xa.left+la.width-1;Xa.bottom=Xa.top+la.height-1}return Xa}ryc(la,Xa,Za=!0){const xa=[];for(const fa of la)xa.push(new G.a(fa,r.d(this.$.na)));this.qb.nx(xa,[Xa],!0,void 0,Za)}Rfj(){this.C5&&C.a.instance.ta(H.a.Ij,document.documentElement,this.Fh);for(const la of this.gridView.Nn)C.a.instance.ta(H.a.Ij,la.domElement,this.Fh);C.a.instance.ta(H.a.Pf,document.documentElement,this.Of);this.MMe()}Kgj(){this.C5&&J.a.instance.ta(H.a.Yf,document.documentElement,this.Fh);for(const la of this.gridView.Nn)J.a.instance.ta(H.a.Yf,
la.domElement,this.Fh);J.a.instance.ta(H.a.we,document.documentElement,this.VGb);this.MMe()}Wv(){this.cBb&&this.PXj();this.pkc&&this.aYj()}PXj(){this.C5&&C.a.instance.Ba(H.a.Ij,document.documentElement,this.Fh);for(const la of this.gridView.Nn)C.a.instance.Ba(H.a.Ij,la.domElement,this.Fh);C.a.instance.Ba(H.a.Pf,document.documentElement,this.Of);this.ASf()}aYj(){this.C5&&J.a.instance.Ba(H.a.Yf,document.documentElement,this.Fh);for(const la of this.gridView.Nn)J.a.instance.Ba(H.a.Yf,la.domElement,this.Fh);
J.a.instance.Ba(H.a.we,document.documentElement,this.VGb);this.ASf()}MMe(){this.C5||C.a.instance.ta(H.a.Jy,document.documentElement,this.k0);this.gridView.fc.A9b(!0)}ASf(){this.C5||C.a.instance.Ba(H.a.Jy,document.documentElement,this.k0);this.gridView.fc.A9b(!1)}WUj(la){this.$.Xc(-1400250766,O.a.Db,30,{["ResizeTableRange"]:la,["OriginalTableRange"]:this.im})}DZj(la){if(!this.im.contains(la)){la=this.hQj();for(const Xa of la)if(this.tableManager.Ctd(Xa)){this.gridView.Gf.gm(S.a.sLi);return}}this.gridView.rtl?
this.gridView.Gf.gm(S.a.AKi):this.gridView.Gf.gm(S.a.DMi)}Zcb(){if(this.CB){W.b(this.$,!1);try{this.Wv()}catch(la){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${la}`)}}this.fs&&(this.fs.cancel(),this.fs.dispose());this.pkc=this.cBb=!1;this.KJb();this.DLd();W.b(this.$,!1);this.gridView.Gf.gm(S.a.TQ)}hQj(){const la=[];this.im.right!==this.Ds.right&&la.push(new z.Range(this.im.top,this.im.right+1,this.Ds.bottom,this.Ds.right,!1,!1));
this.im.bottom!==this.Ds.bottom&&la.push(new z.Range(this.im.bottom+1,this.im.left,this.Ds.bottom,this.im.right,!1,!1));return la}static createInstance(la,Xa,Za,xa){if(!Xa)return null;const fa=la.qb;fa.nx(Za,[27],!0);fa.Tn(va.eQj);Za=fa.Dv(27,la.ib.Li(Xa.bottomRight),va.rUh(Xa,Za)).wf;return new va(Za,la,Xa,xa)}static rUh(la,Xa){var Za;for(let xa=0;xa<Xa.length;xa++)if((null===(Za=Xa[xa])||void 0===Za?0:Za.range)&&Xa[xa].range.equals(la))return xa;return 0}}va.eQj=[27];Object(u.a)(va,"TableResizeBehavior",
M.a,[]);var ca=a(7);M=a(238);class V{}V.$zh="ewa-ttrd-buttonarea";Object(u.a)(V,"CssClassNames",null,[]);var ra=a(49),N=a(132),ea=a(91),Ba=a(22),ka=a(13),Ka=a(254),Oa=a(133),wa=a(262);class qa extends M.a{constructor(la){super(document.createElement("div"));this.TVc=this.nqd=this.pLf=this.VQ=!1;this.ULb=null;this.Ph=()=>{B.c(this.$,this.gridView.ha.ra.activeCell)?(this.ZMa=!0,this.ssb(!1)):(this.r_=this.ZMa=!1,this.qhg())};this.Tt=()=>{this.ZMa?this.ssb(!0):this.r_=!1};this.aAf=()=>{this.TVc=!0;this.ZMa&&
(this.r_=!1)};this.onContentReady=()=>{this.$.isEditMode?B.c(this.$,this.gridView.ha.ra.activeCell)&&(this.ZMa=!0,this.ssb(!1)):this.r_=!1};this.oza=()=>{this.TVc=!1;this.ZMa?this.ssb(!1):this.r_=!1};this.sf=(Xa,Za)=>{this.ZMa&&(Xa=this.gridView.urc(Za.jd.block.oe.BlockCachePosition.PaneType).MG(Za.jd.hash))&&(Xa.QMd(this.obf),Xa.UXc(this.obf))};this.obf=()=>{this.HWf()};this.$=la;this.gridView=P.h(this.$);this.parentElement=this.domElement;this.parentElement.className=V.$zh;this.RLa=this.gridView.zj;
this.ZMa=!0;this.Ihi();this.UTg();this.ssb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get r_(){return this.nqd}set r_(la){this.nqd!==la&&(this.nqd=this.isVisible=la)}get $Bb(){return!!(this.$.rd&16)}get Rqi(){const la=this.gridView.ha.ra.activeCell;return la.right===la.maxColumns}get Jnb(){const la=this.gridView.Sb(null);return la&&this.gridView.L5(la.range)?this.nwa(la):(la&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),
null)}dispose(){this.$&&this.$lh();this.$=this.gridView=this.parentElement=this.RLa=null;super.dispose()}dSh(la){const Xa=this.i6h(this.gridView.Sb(null).range);return Xa?`=SUBTOTAL(${la},${Xa})`:null}i6h(la){var Xa=P.h(this.$).Bb.Bj(la);if(!Xa)return null;Xa=w.a(Xa,!1);Xa.right=Xa.left=la.left;return Xa.toString()}Ihi(){qa.CM={};qa.CM["100"]=ka.a.instance.ga(1099);qa.CM["101"]=ka.a.instance.ga(1102);qa.CM["102"]=ka.a.instance.ga(1101);qa.CM["103"]=ka.a.instance.ga(1106);qa.CM["104"]=ka.a.instance.ga(1103);
qa.CM["105"]=ka.a.instance.ga(1104);qa.CM["109"]=ka.a.instance.ga(1100);qa.CM["107"]=ka.a.instance.ga(1107);qa.CM["110"]=ka.a.instance.ga(1109);qa.CM["111"]=ka.a.instance.ga(1160)}M3i(){var la=this.gridView.Sb(null);if(la&&(la=la.wB?la.formulaBarText:null))if("=SUBTOTAL("===la.substring(0,10)){if(la=la.substring(10,13),la in qa.CM)return la}else return"111";return"100"}UTg(){this.gridView.Ea.mt(this.sf);this.gridView.ha.iH(this.Ph);this.gridView.mv(this.onContentReady);this.gridView.fc.Xk(this.aAf);
this.gridView.fc.sm(this.oza)}$lh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.rL(this.Ph),this.gridView.Ea.gr(this.sf)),this.gridView.Oy(this.onContentReady),this.gridView.fc&&(this.gridView.fc.Fk(this.aAf),this.gridView.fc.Il(this.oza)),this.qhg())}ssb(la){this.OZj(la);this.$Bb&&(this.KOj(),this.Jnb?(this.pLf||this.dUg(),this.TVc?this.r_=!1:(this.r_=!0,this.HWf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.r_=!1))}HWf(){appChrome.renderTableTotalRowOptions(this.parentElement,qa.CM,qa.CM[this.M3i()].toString(),Math.round(Y.a(this.$).yi(17)),la=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${la}`);let Xa={["SelectedOption"]:qa.CM[la],["FunctionKeyCode"]:la,["Location"]:"canvas"};Oa.b(this.$).Gd(N.a.mQj,Xa,null,!0);if("111"===la)return this.cli(),!0;if("100"!==la){this.ULb=this.dSh(la);if(!this.ULb)return e.ULS.sendTraceTag(537151197,0,50,
"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.JSa(this.ULb)}else this.JSa("");x.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}cli(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const la=new ea.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(la)}nwa(la){if(!la)return null;var Xa=this.gridView.fc.textBox.domElement;var Za=0<x.DOMElementExtensions.getHeight(Xa)&&
0<x.DOMElementExtensions.getWidth(Xa)&&0<=Xa.offsetTop&&0<=Xa.offsetLeft;if(Za)Xa=x.DOMElementExtensions.nwa(Xa,this.gridView.zj);else{Xa=this.gridView.getCellBounds(la.cell);var xa=x.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);Xa=new Sys.UI.Bounds(Xa.x-xa.x,Xa.y-xa.y,Xa.width,Xa.height)}if(Xa)if(Za)2<Xa.height&&2<Xa.height&&(Xa.x+=1,Xa.y+=1,Xa.height-=2,Xa.width-=2);else if(Za=P.h(this.$).sK(la.cell))Za=Za.width,xa=Ba.a.equals(Ka.a.Hwb(la.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&
xa&&(Xa.x=Xa.x+Xa.width-Za),la.Ela&&this.gridView.rtl===xa&&(Xa.width=Za);else return null;return Xa}OZj(la){var Xa=this.Jnb;if(Xa){var Za=17>=Xa.height?Xa.y:Xa.y+Xa.height-17-2;Xa=this.Rqi?this.gridView.rtl?Xa.x:Xa.x+Xa.width-(17<Xa.height?17:Xa.height):this.gridView.rtl?Xa.x-(17<Xa.height?17:Xa.height):Xa.x+Xa.width;var xa=Y.a(this.$).nka(new Sys.UI.Point(Xa,Za));this.parentElement.style.top=X.HelperMethods.uc(xa.y);this.parentElement.style.left=X.HelperMethods.uc(xa.x);Y.a(this.$).dAj(this.parentElement);
la&&(this.r_=this.gridView.xkc(new ra.a(Xa,Za)))}else this.r_=!1}dUg(){this.RLa.insertBefore(this.parentElement,this.RLa.firstChild);this.pLf=!0}KOj(){this.VQ||(this.gridView.view.nt(this.Tt),this.VQ=!0)}qhg(){this.VQ&&this.gridView.view&&(this.gridView.view.ir(this.Tt),this.VQ=!1)}JSa(la){const Xa=this.gridView.Vb,Za=this.gridView.Sb(null);Za&&(la=Object(ca.a)(new wa.a,{Text:la}),this.gridView.setCell(la,Za.range,0,127,null),Xa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}qa.lQj="TableTotalRowDropDownIconButtonId";
qa.CM=null;Object(u.a)(qa,"TableTotalRowOptions",M.a,[2]);class aa extends m.a{constructor(la){super(P.h(la));this.Nqb=this.k1=this.GBc=this.Lqb=null;this.sue=!1;this.xde=null;this.yTb=0;this.i7b=null;this.W1b=()=>{const Xa={},Za=this.zid();for(let fa in Za){const ua=Za[fa];if(!ua)continue;const sa=this.m5h(ua);if(sa){if(sa in this.wGa){var xa=this.wGa[sa];if(xa.CB){xa.im.equals(ua)||(xa.im=ua);delete this.wGa[sa];Xa[sa]=xa;continue}}(xa=va.createInstance(P.h(this.$),ua,this.$Oh(),this))?Xa[sa]=xa:
e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ua.Cz(!1)}`)}}this.h4b(null,null);this.gSb=Xa};this.h4b=()=>{const Xa=this.wGa;for(let fa in Xa){var Za=fa,xa=Xa[fa];xa&&(xa.dispose(),delete this.wGa[Za])}this.gSb={}};this.NQf=()=>{this.h4b(null,null);this.W1b(null,null)};this.onFocus=()=>{this.xde=P.h(this.$).ha.ra.activeCell};this.CR=()=>{this.$.isEditMode&&this.Ph(null,null)};this.Ph=()=>{!this.sue&&B.c(this.$,this.gridView.ha.ra.activeCell)&&
this.NAi()};this.bW=()=>{this.Ezb(1);this.$.ea.lo(this.bW)};this.cIb=()=>{this.sue=!0;this.GBc=new qa(this.$)};this.$=la;this.gridView=P.h(this.$);this.$.da.Ga(66,this);this.gSb={};this.W1b(null,null);this.$.xa&&this.$.xa.Uf(this.NQf);this.jse(this.W1b);this.$.ea.FY(this.CR);this.gridView.ha.iH(this.Ph);this.$.isEditMode&&this.Ph(null,null)}jse(la){this.addHandler(m.a.AJd,la)}XVf(la){this.removeHandler(m.a.AJd,la)}ULg(la){this.addHandler("tce",la)}Rij(la){this.removeHandler("tce",la)}get wGa(){return this.gSb}get Vud(){return this.xde}get iJa(){return this.yTb}get Ig(){const la=
P.h(this.$);return la.Bb.Bj(la.ha.ra.activeCell,!1)}get eId(){return this.Vud?P.h(this.$).Bb.Bj(this.Vud,!1):null}Ctd(la){return!!this.F5e(la)}Dn(la){return this.P1h(this.n6e(la))}pwb(la){return this.n6e(la)}Hgj(la){la?(this.Nqb?this.Nqb!==la&&(f.a.Ia(this.k1),this.k1=null,this.Nqb=la):this.Nqb=la,this.k1||(this.k1=I.a.instance.Zd(this.Nqb)),this.k1.Ni("focusin")||this.k1.ka("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Tif(la,
Xa){return la?la.zba&&la.top===Xa.top:(e.ULS.shipAssertTag(537151244,0,!!la,"autofilterRange can't be null"),!1)}lka(la){la=this.Lqb?n.I(la,this.Lqb):this.view.getRangeInformation(la);return 0<la.length&&Object(h.a)(t.PivotTableRange,la[0])?la[0]:null}qni(la,Xa){return la?!la.gic&&!!la.fF&&la.fF.Ad(Xa):(e.ULS.shipAssertTag(537151243,0,!!la,"Pivot table can't be null"),!1)}Iti(la,Xa){return la?!la.gic&&!!la.AL&&la.AL.Ad(Xa):(e.ULS.shipAssertTag(537151242,0,!!la,"Pivot table can't be null"),!1)}N_b(la){super.N_b(la);
if((la=X.HelperMethods.Q5e(la))&&0<la.length){this.Lqb=Array(la.length);for(let Xa=0;Xa<la.length;Xa++)this.Lqb[Xa]=v.a.LQ(la[Xa])}}DJb(){super.DJb();this.Lqb=null}Cah(la,Xa){return this.lHe(la,Xa).returnValue}lHe(la,Xa){var Za=!1;if(!la||!Xa)return{returnValue:!1,PY:Za};la=la.clone();la.right+=1;la.left=la.right;return!la.Nz||la.top<Xa.ib.dj&&(Za=la.clone(),Za.bottom>=Xa.ib.dj&&(Za.bottom=Xa.ib.dj-1),!({PY:Za}=this.kHe(Za,Xa)).returnValue)||la.bottom>=Xa.ib.dj&&(Za=la.clone(),Za.top<=Xa.ib.dj&&(Za.top=
Xa.ib.dj),!({PY:Za}=this.kHe(Za,Xa)).returnValue)?{returnValue:!1,PY:Za}:{returnValue:!0,PY:Za}}Acg(la){(la=this.Dn(la.topLeft))&&la.toString()in this.wGa&&(this.wGa[la.toString()].ctd=!1)}waj(){this.raiseEvent("tce")}Xh(la,Xa){if(!this.GBc)return!1;switch(Xa){case -569786022:case 541421805:if(this.GBc.r_){const Za=document.getElementById(qa.lQj);Za&&A.a.instance.create(()=>{x.DOMElementExtensions.dhc(Za,null)},0,y.a.fQj,!0,!0)}return!0;default:return!1}}dispose(){this.h4b(null,null);this.XVf(this.W1b);
this.$.xa.Bg(this.NQf);this.$.Jl(this.h4b);this.gSb=null;this.$.ea&&this.$.ea.C0(this.CR);this.gridView.ha.rL(this.Ph);this.GBc=null;L.EwaSettings.ma(403)&&this.k1&&(f.a.Ia(this.k1),this.k1=null);super.dispose()}Pai(la,Xa,Za,xa){const fa=this.gridView.Bb.Bj(new z.Range(Xa,Za,Xa,Za,!1,!1));if(this.i7b=fa){var ua=fa.usedRange,sa=la.ctrlKey||d.a.isMac&&F.b(la),sb=!la.shiftKey&&sa;la=la.shiftKey&&!sa;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(P.h(this.$).ha.selectionType=
3);switch(xa){case 0:this.yTb=0;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Xa=this.O6c(la,ua.top,Za,ua.bottom,Za),this.JSd(Xa,sb,la)):this.KSd(ua.top,Za,ua.bottom,Za,w.d(fa),w.g(fa),sb);break;case 1:this.yTb=1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Xa=this.O6c(la,Xa,ua.left,Xa,ua.right),this.JSd(Xa,sb,la)):this.KSd(Xa,ua.left,Xa,ua.right,!1,!1,sb);break;case 2:this.yTb=2;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(Xa=this.O6c(la,ua.top,ua.left,ua.bottom,ua.right),this.JSd(Xa,sb,la)):this.KSd(ua.top,ua.left,ua.bottom,ua.right,w.d(fa),w.g(fa),sb);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${xa.toString()}`);return}L.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(P.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}FEj(la){const Xa=this.i7b.usedRange;return this.Zkf(la)||1!==this.iJa&&this.Zkf(new z.Range(Xa.top,la.left,Xa.bottom,la.right,!1,!1))?!0:!1}zJd(la){return la.Autofilters}kHe(la,Xa){let Za;Za=!1;const xa=Xa.ib.Li(la),fa=Xa.Af(xa).ui;if(!fa)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${xa}`),{returnValue:!1,PY:Za};if(!fa.Ke(la))return{returnValue:!0,
PY:Za};la=Xa.fk("TableManager.CouldExpandImpl",la,2);try{for(;la.$$mn();){if(la.$$cu().text||la.ao.Qaf)return Za=!0,{returnValue:!1,PY:Za};if(la.$$cu().cI)return{returnValue:!1,PY:Za}}}finally{la&&la.dispose()}return{returnValue:!0,PY:Za}}P1h(la){if(!la)return null;const Xa=new l.AutofilterRange(la.top,la.left,la.bottom,la.right,null,null,null,la.id,la.zba);Xa.OBa=la.OBa;const Za=this.gridView.Bb.Bj(la,!0);if(!Za)return null;for(let xa=0,fa=this.rangeList.length;xa<fa;xa++){const ua=this.rangeList[xa],
sa=this.gridView.Bb.Bj(ua,!0);sa&&sa.name===Za.name&&ua!==la&&this.Psi(ua)&&(Xa.union(ua),ua.OBa&&(Xa.OBa=!0))}return Xa}Psi(la){return!!P.h(this.$).Bb.Bj(la)}$Oh(){const la=[];for(const Xa of this.rangeList){const Za=new G.a(this.Dn(Xa.topLeft),r.d(this.$.na));la.push(Za)}return la}zid(){const la={};for(const Xa of this.rangeList){if(!Xa)continue;const Za=this.Dn(Xa.topLeft);Za&&(la[Za.toString()]=this.Dn(Xa.topLeft))}return la}NAi(){this.$.ea.qg?this.Ezb(0):this.$.ea.Kk(this.bW)}Ezb(la){this.$.ny(Xa=>
{Xa.cba(la).then(this.cIb)})}m5h(la){const Xa=this.gridView.Bb.Bj(la);return Xa?Xa.name:la.toString()}KSd(la,Xa,Za,xa,fa,ua,sa){const sb=la+(fa?1:0),hb=Za-(ua?1:0),bb=this.gridView.inRangePicker||this.gridView.ri;let lb=!1;const Fa=new z.Range(sb,Xa,hb,xa,!1,!1);if(fa||ua){fa=bb?G.a.Msb(this.gridView.ha.rangePicker.lL):this.gridView.ha.ra.selectedRanges;for(const Na of fa){lb=this.Rrb(Na,sb,Xa,hb,xa);fa=this.Rrb(Na,la,Xa,Za,xa);if(bb&&lb)break;if(!bb&&(lb||fa)){this.gridView.ha.updateSelection(Na,
Na.topLeft,0,1);if(sa&&fa)return;break}}}lb&&(Fa.top=la,Fa.bottom=Za);la=Fa.topLeft;sa?this.gridView.ha.updateSelection(Fa,la,0,1):bb?this.gridView.ha.ox([Fa],0,la,0):this.gridView.ha.updateSelection(Fa,la,0,3)}JSd(la,Xa,Za){la&&(Za=Za?P.h(this.$).ha.ra.activeCell:la.topLeft,Xa?this.gridView.ha.updateSelection(la,Za,0,1):this.gridView.ha.ox([la],0,Za,0))}O6c(la,Xa,Za,xa,fa){const ua=w.d(this.i7b),sa=w.g(this.i7b),sb=Xa+(1!==this.iJa&&ua?1:0),hb=xa-(1!==this.iJa&&sa?1:0),bb=this.gridView.inRangePicker||
this.gridView.ri;if(la){var lb=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&bb&&!G.a.Msb(this.gridView.ha.rangePicker.lL).length?new z.Range(sb,Za,hb,fa,!1,!1):bb?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ra.activeCell;lb=new z.Range(lb.top<sb?lb.top:sb,lb.left<Za?lb.left:Za,lb.bottom>hb?lb.bottom:hb,lb.right>fa?lb.right:fa,!1,!1)}else lb=new z.Range(sb,Za,hb,fa,!1,!1);if(1!==this.iJa&&(ua||sa)&&(!la||la&&this.Rrb(lb,sb,Za,hb,fa))){la=bb?G.a.Msb(this.gridView.ha.rangePicker.lL):
this.gridView.ha.ra.selectedRanges;for(const Fa of la)if(this.Rrb(Fa,sb,Za,hb,fa)){lb.top=Xa;lb.bottom=xa;break}}return lb}Zkf(la){const Xa=this.gridView.inRangePicker||this.gridView.ri?G.a.Msb(this.gridView.ha.rangePicker.lL):this.gridView.ha.ra.selectedRanges;for(const Za of Xa)if(this.Rrb(Za,la.top,la.left,la.bottom,la.right))return!0;return!1}Rrb(la,Xa,Za,xa,fa){return!!la&&la.top===Xa&&la.bottom===xa&&la.left===Za&&la.right===fa}}Object(u.a)(aa,"TableManager",m.a,[494,2]);class ia extends b.a{constructor(la){super();
this.tableManager=null;this.$=la;this.Fb()}create(){this.ob(this.tableManager||(this.tableManager=new aa(this.$)))}}Object(u.a)(ia,"TableManagerFactory",b.a,[]);var Ha=a(1217);a.d(D,"a",function(){return Z});const Z=()=>{c.a.Fa(la=>{la.da.Ga(134,new ia(la));la.da.Ga(330,new Ha.a(la))})}},1217:function(u,D,a){u=a(0);var c=a(222),b=a(50),e=a(37),f=a(7),d=a(15),h=a(111),m=a(815),l=a(1463),v=a(723),t=a(1393),z=a(38),r=a(5),n=a(161),w=a(76),B=a(60),A=a(162),y=a(47),x=a(46),F=a(110);a(28);var I=a(193),
L=a(29),X=a(282),P=a(1),G=a(22),C=a(13);a(30);class H{}Object(u.a)(H,"TableStyleElement",null,[]);var J=a(749),M=a(208),S=a(88),W=a(526);class O{static Csf(ra,N){return O.Dcg[ra.Type]-O.Dcg[N.Type]}static f5a(ra,N){try{return appChrome.buildTableStyleGalleryIconNew(O.$Ba,O.Soa,ra,N)}catch(ea){return null}}static Fmf(ra){return ra&&w.a.Ic in ra&&(ra=ra[w.a.Ic])?G.a.zG(ra,r.a.pIb):!1}static Mta(ra){const N=[];let ea=0;for(const Ba of ra){N[ea]={};N[ea].backgroundColor="white";N[ea].color="black";for(let ka in Ba)switch(ra=
Ba[ka],ka){case "background-color":N[ea].backgroundColor=ra;break;case "color":N[ea].color=ra;break;case "font-size":N[ea].fontSize=ra;break;case "border-bottom":N[ea].borderBottom=ra;break;case "border-right":N[ea].borderRight=ra;break;case "border-left":N[ea].borderLeft=ra;break;case "border-top":N[ea].borderTop=ra}ea++}return N}static M5b(ra,N){const ea=[];if(null===ra||void 0===ra?0:ra.TableStyleElementsList){var Ba=0===ra.Category;for(let ka=0;ka<O.Soa;ka++)ea.push(...O.bTh(ra,N,Ba,ka))}else{if(O.i8c)return O.i8c;
ra={color:"black","background-color":"white"};for(N=0;N<O.Soa;N++)for(Ba=0;Ba<O.$Ba;Ba++)ea.push(ra);O.i8c=ea}return ea}static n5h(ra,N){if(!ra.TableStyleElementsList)return"";let ea="";for(const Ba of ra.TableStyleElementsList)if(Ba.BackgroundColor&&"#000000"!==Ba.BackgroundColor)switch(Ba.Type){case 0:ea=Ba.BackgroundColor;break;case 5:case 7:if(N.oia||N.hS)ea=Ba.BackgroundColor;break;case 3:case 4:if(N.firstCol||N.lastCol)ea=Ba.BackgroundColor;break;case 2:N.totalRow&&(ea=Ba.BackgroundColor);break;
case 1:N.headerRow&&(ea=Ba.BackgroundColor)}return ea}static O4b(ra){ra=new M.a(parseInt(String("0x"+ra.substr(1,2)),16),parseInt(String("0x"+ra.substr(3,2)),16),parseInt(String("0x"+ra.substr(5,2)),16));return J.a.vLa(ra)}static $7e(ra,N){if(!ra||!N)return"";N=(N=O.n5h(ra,N))?O.O4b(N)+", ":C.a.instance.ga(2060)+", ";switch(ra.Index){case 0:return N+C.a.instance.ga(1994);case 1:return N+C.a.instance.ga(1995);case 2:return N+C.a.instance.ga(1996);case 3:return N+C.a.instance.ga(1997);case 4:return N+
C.a.instance.ga(1998);case 5:return N+C.a.instance.ga(1999);case 6:return N+C.a.instance.ga(2E3);case 7:return N+C.a.instance.ga(2001);case 8:return N+C.a.instance.ga(2002);case 9:return N+C.a.instance.ga(2003);case 10:return N+C.a.instance.ga(2004);case 11:return N+C.a.instance.ga(2005);case 12:return N+C.a.instance.ga(2006);case 13:return N+C.a.instance.ga(2007);case 14:return N+C.a.instance.ga(2008);case 15:return N+C.a.instance.ga(2009);case 16:return N+C.a.instance.ga(2010);case 17:return N+
C.a.instance.ga(2011);case 18:return N+C.a.instance.ga(2012);case 19:return N+C.a.instance.ga(2013);case 20:return N+C.a.instance.ga(2014);case 21:return N+C.a.instance.ga(2015);case 22:return N+C.a.instance.ga(2016);case 23:return N+C.a.instance.ga(2017);case 24:return N+C.a.instance.ga(2018);case 25:return N+C.a.instance.ga(2019);case 26:return N+C.a.instance.ga(2020);case 27:return N+C.a.instance.ga(2021);case 28:return N+C.a.instance.ga(2022);case 29:return N+C.a.instance.ga(2023);case 30:return N+
C.a.instance.ga(2024);case 31:return N+C.a.instance.ga(2025);case 32:return N+C.a.instance.ga(2026);case 33:return N+C.a.instance.ga(2027);case 34:return N+C.a.instance.ga(2028);case 35:return N+C.a.instance.ga(2029);case 36:return N+C.a.instance.ga(2030);case 37:return N+C.a.instance.ga(2031);case 38:return N+C.a.instance.ga(2032);case 39:return N+C.a.instance.ga(2033);case 40:return N+C.a.instance.ga(2034);case 41:return N+C.a.instance.ga(2035);case 42:return N+C.a.instance.ga(2036);case 43:return N+
C.a.instance.ga(2037);case 44:return N+C.a.instance.ga(2038);case 45:return N+C.a.instance.ga(2039);case 46:return N+C.a.instance.ga(2040);case 47:return N+C.a.instance.ga(2041);case 48:return N+C.a.instance.ga(2042);case 49:return N+C.a.instance.ga(2043);case 50:return N+C.a.instance.ga(2044);case 51:return N+C.a.instance.ga(2045);case 52:return N+C.a.instance.ga(2046);case 53:return N+C.a.instance.ga(2047);case 54:return N+C.a.instance.ga(2048);case 55:return N+C.a.instance.ga(2049);case 56:return N+
C.a.instance.ga(2050);case 57:return N+C.a.instance.ga(2051);case 58:return N+C.a.instance.ga(2052);case 59:return N+C.a.instance.ga(2053);default:return ra.Name?ra.Name:""}}static t_h(ra){return(ra+1)%O.mei}static Pxb(ra,N,ea=""){return ra||!ea?`${O.kdf}, ${ra.Index.toString()}, -version, ${N.toString()}`:`${O.kdf}, ${ea}, -version, ${N.toString()}`}static bTh(ra,N,ea,Ba){const ka=[];for(let Ka=0;Ka<O.$Ba;Ka++)ka.push(O.Rfd(ra,N,ea,Ba,Ka));return ka}static Rfd(ra,N,ea,Ba,ka){ra=ra.TableStyleElementsList;
let Ka=new H;const Oa={};if(!ra)return Oa;for(var wa of ra)if(0===wa.Type){Ka=wa;break}wa=!!Ka.BackgroundColor;let qa="";!ea&&Ka.TableStyleBorderFromatList&&0<Ka.TableStyleBorderFromatList.length&&(qa=Ka.TableStyleBorderFromatList[0].Color);Oa["background-color"]=wa?Ka.BackgroundColor:"#FFFFFF";Ka.FontColor||(Ka.FontColor="#000000");Oa.color=Ka.FontColor;O.hCe(Ba,ka,Oa,Ka,qa,ea,wa);for(const aa of ra)aa&&0!==aa.Type&&(2!==aa.Type||wa||(aa.BackgroundColor=Ka.BackgroundColor),O.ttd(aa,Ba,ka,N)&&(aa.BackgroundColor&&
(Oa["background-color"]=aa.BackgroundColor),Oa.color=aa.FontColor||Ka.FontColor,O.hCe(Ba,ka,Oa,aa,qa,ea,wa)));return Oa}static jV(ra,N,ea,Ba,ka,Ka){ea&&(ea.Color&&!ea.Style&&(ea.Style=1),ea.Style&&!ea.Color&&(ea.Color=ka?"#000000":Ba?Ba:Ka?"#FFFFFF":"#000000"),N[O.borders[ra]]="1px "+O.TV[ea.Style]+" "+ea.Color)}static ttd(ra,N,ea,Ba){return-1===ra.Type?!1:O.vtd(ra,N,ea,Ba)||O.Wui(ra,N,ea,Ba)||O.wtd(ra,N,ea,Ba)}static Wui(ra,N,ea,Ba){return!N&&Ba.headerRow||N===O.Soa-1&&Ba.totalRow?!1:1===N%2&&5===
ra.Type&&Ba.hS&&Ba.headerRow||1<N&&!!((N-1)%(ra.BandSize+1))&&6===ra.Type&&Ba.hS&&Ba.headerRow||!(N%2)&&5===ra.Type&&Ba.hS&&!Ba.headerRow||!!(N%(ra.BandSize+1))&&6===ra.Type&&Ba.hS&&!Ba.headerRow||!(ea%2)&&7===ra.Type&&Ba.oia||!!(ea%(ra.BandSize+1))&&8===ra.Type&&Ba.oia}static wtd(ra,N,ea,Ba){return N===O.Soa-1&&2===ra.Type&&Ba.totalRow||ea===O.$Ba-1&&N===O.Soa-1&&12===ra.Type&&Ba.totalRow&&Ba.lastCol||!ea&&N===O.Soa-1&&11===ra.Type&&Ba.totalRow&&Ba.firstCol||ea===O.$Ba-1&&4===ra.Type&&Ba.lastCol}static vtd(ra,
N,ea,Ba){return!N&&1===ra.Type&&Ba.headerRow||!ea&&3===ra.Type&&Ba.firstCol||!ea&&!N&&9===ra.Type&&Ba.headerRow&&Ba.firstCol||ea===O.$Ba-1&&!N&&10===ra.Type&&Ba.headerRow&&Ba.lastCol}static hCe(ra,N,ea,Ba,ka,Ka,Oa){if(Ba.TableStyleBorderFromatList)for(const wa of Ba.TableStyleBorderFromatList)if(wa.Style)switch(wa.Position){case 0:ra&&12!==Ba.Type&&11!==Ba.Type&&2!==Ba.Type&&5!==Ba.Type&&6!==Ba.Type||O.jV(0,ea,wa,ka,Ka,Oa);break;case 1:ra!==O.Soa-1&&1!==Ba.Type&&10!==Ba.Type&&9!==Ba.Type&&5!==Ba.Type&&
6!==Ba.Type||O.jV(1,ea,wa,ka,Ka,Oa);break;case 2:N&&12!==Ba.Type&&10!==Ba.Type&&7!==Ba.Type&&8!==Ba.Type&&4!==Ba.Type||O.jV(2,ea,wa,ka,Ka,Oa);break;case 3:N!==O.$Ba-1&&9!==Ba.Type&&11!==Ba.Type&&3!==Ba.Type&&7!==Ba.Type&&8!==Ba.Type||O.jV(3,ea,wa,ka,Ka,Oa);break;case 5:N!==O.$Ba-1&&3!==Ba.Type&&4!==Ba.Type&&7!==Ba.Type&&8!==Ba.Type&&O.jV(3,ea,wa,ka,Ka,Oa);break;case 6:ra!==O.Soa-1&&2!==Ba.Type&&1!==Ba.Type&&5!==Ba.Type&&6!==Ba.Type&&O.jV(1,ea,wa,ka,Ka,Oa)}}static q5h(){const ra=Array(12);ra[0]=0;
ra[7]=1;ra[8]=2;ra[5]=3;ra[6]=4;ra[4]=5;ra[3]=6;ra[1]=7;ra[2]=8;ra[9]=9;ra[10]=10;ra[11]=11;ra[12]=13;return ra}}O.Soa=5;O.$Ba=5;O.mei=5;O.kdf="TableStyleIcon";O.TV=[null,S.a.solid,S.a.dashed,S.a.dotted,S.a.dashed,S.a.dotted,S.a.dashed,S.a.double];O.borders=[W.a.borderTop,W.a.borderBottom,W.a.borderLeft,W.a.borderRight];O.Dcg=O.q5h();O.i8c=null;Object(u.a)(O,"TableStyleHelper",null,[]);class T{constructor(ra,N,ea,Ba,ka,Ka){this.headerRow=ra;this.totalRow=N;this.firstCol=ea;this.lastCol=Ba;this.hS=
ka;this.oia=Ka}equals(ra){return ra?this.headerRow===ra.headerRow&&this.totalRow===ra.totalRow&&this.firstCol===ra.firstCol&&this.lastCol===ra.lastCol&&this.oia===ra.oia&&this.hS===ra.hS:!1}}Object(u.a)(T,"TableStyleOptions",null,[]);var Y=a(790);class va extends z.a{constructor(ra,N,ea){super();this.J8i={["height"]:"100%"};this.tJb={};this.YIa=this.ujd=0;this.lastSyncTime=new Date;this.gea=-1;this.oO=null;this.lna={};this.NL=null;this.bJ={};this.qUa={};this.Ytc=null;this.SBb=this.B7a=this.isInitialized=
this.Skf=!1;this.Xwc=null;this.gBc=this.yOb=this.pZe=!1;this.mUi=(Ba,ka,Ka)=>{let Oa=!1;if(X.a(Ba))-315732528!==Ba.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${L.a.sc(Ba.Errors)}`),this.jDf(null,ka,Ka));else if(d.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Ba=Ba.Result)&&Ba.TableStyleItems.length){Ka=60<Ba.TableStyleItems.length;var wa=!1,
qa=!1;if(this.NL)for(var aa=0;60>aa;++aa){const ia=Ba.TableStyleItems[aa],Ha=this.NL.TableStyleItems[aa];if(ia.HasStyleViolations!==Ha.HasStyleViolations){Oa=qa=!0;break}for(let Z=0;9>Z&&!(Z>=ia.TableStyleElementsList.length);Z++)if(!G.a.equals(ia.TableStyleElementsList[Z].BackgroundColor,Ha.TableStyleElementsList[Z].BackgroundColor,!1)){Oa=wa=!0;break}}else{this.YIa=0;for(aa of Ba.TableStyleItems)aa.TableStyleElementsList&&aa.TableStyleElementsList.sort(O.Csf),this.bJ[aa.Name]=aa}if(wa||qa)for(wa=
0;60>wa;++wa)qa=Ba.TableStyleItems[wa],this.bJ[qa.Name]=qa;if(Ka&&this.NL)for(d.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${Ba.TableStyleItems.length-60}`),Oa=!0,Ka=60;Ka<Ba.TableStyleItems.length;++Ka)wa=Ba.TableStyleItems[Ka],wa.Name in this.bJ||wa.TableStyleElementsList&&wa.TableStyleElementsList.sort(O.Csf),this.bJ[wa.Name]=wa;if(Y.a(this.bJ).length!==Ba.TableStyleItems.length)for(Oa=!0,wa=Ka=60;wa<this.NL.TableStyleItems.length;)Ka>=
Ba.TableStyleItems.length?delete this.bJ[this.NL.TableStyleItems[wa].Name]:Ka>=Ba.TableStyleItems.length||!G.a.equals(Ba.TableStyleItems[Ka].Name,this.NL.TableStyleItems[wa].Name,!1)?delete this.bJ[this.NL.TableStyleItems[wa].Name]:++Ka,++wa;this.NL=Ba;this.SSf(Oa);Oa&&this.n0c();ka&&("accessibility"===ka?(this.yOb=!1,this.gBc=!0):this.gBc=!1);this.Skf||(this.lvi()&&this.$.af(),this.Skf=!0);this.ujd=0;this.SBb||this.pZe?this.gBc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),
this.pZe=!0)}};this.jDf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.ujd++;5>this.ujd&&y.a.instance.create(()=>{this.G5a("getTableStylesFailed")},1E3,x.a.Ccg,!0,!0)};this.PIf=()=>{this.SBb&&(this.SBb=!1,this.Xwc&&this.Xwc(),y.a.instance.create(()=>{this.G5a("galleryMenuClosed")},1E3,x.a.Ccg,!0,!0))};this.$=ra;this.Va=N;this.tableManager=ea;this.$.da.Ga(329,this);this.J0c=this.Kwb();this.$.Ka.OZa(this.PIf)}faf(ra){const N=this.tableManager.Ig;
if(!N)return!1;ra=ra[w.a.Ic];if(!ra)return!1;switch(Number.parseInvariant(ra)){case 0:return A.d(N);case 1:return A.c(N);case 2:return A.g(N);case 3:return A.e(N);case 4:return A.f(N);case 5:return A.b(N);case 6:return N.hasAutoFilter}return!1}PMf(ra,N){if(h.a.isEmpty(this.bJ))return!0;if("PopulateTableMoreStylesMenu"!==ra&&"PopulateTableAccessibleStylesMenu"!==ra)return!1;if("PopulateTableAccessibleStylesMenu"===ra&&!this.gBc)return this.yOb||(this.yOb=!0,this.G5a("accessibilityTab")),!0;this.SBb=
!0;const ea=this.Va.cq("TableStylesMenu"),Ba=this.Va.gB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),ka=this.Va.gB("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ka=this.Va.gB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Oa=this.Va.gB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let wa=-123538519,qa;if(N.MenuId)if(G.a.contains(N.MenuId,"FormatAsTable",!0))wa=753331043,this.B7a=!0;else{qa=C.a.instance.ga(1993);var aa=O.Pxb(null,1,"-1");
P.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Oa.ku("-1",wa,"QueryTableStyle",0,"-1",aa,void 0,void 0,qa):Oa.ku("-1",wa,"QueryTableStyle",0,"-1",void 0,void 0,void 0,qa);this.B7a=!1}aa=0;const ia=this.bJ;for(let Ha in ia){const Z=ia[Ha];if("PopulateTableAccessibleStylesMenu"===ra&&Z.HasStyleViolations)continue;let la;qa=O.$7e(Z,this.Kwb());la=O.Pxb(Z,this.YIa);if(Z)switch(Z.Category){case 0:Ba.ku(Z.Index.toString(),wa,"QueryTableStyle",0,Z.Index.toString(),
la,void 0,void 0,qa);aa++;break;case 3:ka.ku(Z.Index.toString(),wa,"QueryTableStyle",0,Z.Index.toString(),la,void 0,void 0,qa);break;case 2:Ka.ku(Z.Index.toString(),wa,"QueryTableStyle",0,Z.Index.toString(),la,void 0,void 0,qa);break;case 1:Oa.ku(Z.Index.toString(),wa,"QueryTableStyle",0,Z.Index.toString(),la,void 0,void 0,qa)}}0<aa&&this.U2(ea,Ba,1961);this.U2(ea,Oa,1962);this.U2(ea,Ka,1963);this.U2(ea,ka,1964);N.MenuItems=ea.QC();this.isInitialized||(this.isInitialized=!0);return!0}gld(ra){ra[m.a.On]=
!1;let N=ra[w.a.Ic];if(N&&!h.a.isEmpty(this.bJ)){G.a.contains(ra.ParentMenuId,"FormatAsTable",!0)?this.B7a=!0:this.B7a=!1;this.B7a||this.aig();O.Fmf(ra)&&(N=this.cxb(N).toString());var ea=this.Kwb();ra[m.a.Alt]="-1"===N?C.a.instance.ga(1993):O.$7e(this.tjd(N),ea);if(N in this.qUa&&ea.equals(this.J0c))this.RMf(ra,N,ea,!0);else{if(!this.Ytc||this.Ytc&&!this.Ytc.Gp)this.lna={},this.Ytc=y.a.instance.create(()=>{this.SSf();this.J0c=this.Kwb()},0,x.a.kQj,!0,!0);this.aHd(ea,ra,N)}}}getTableStyleIndexFromName(ra){if(!ra||
h.a.isEmpty(this.bJ))return-1;if(ra in this.bJ)return this.bJ[ra].Index;this.G5a("getTableStyleIndexFromName");return-1}Dtd(){return!!this.NL}cxb(ra){this.oO||this.n0c();return ra in this.oO?this.oO[ra]:-1}G5a(ra){if(this.$.isEditMode){var N=new Date;if(30<F.getElapsedSeconds(this.lastSyncTime,N)||h.a.isEmpty(this.bJ)||this.yOb){let ea=this.$.pa.ya.Wb();this.lastSyncTime=N;ra=this.yOb&&"accessibilityTab"===ra||"galleryMenuClosed"===ra;B.m(this.$.pa.ya,ra,this.mUi,this.jDf,null,ra?"accessibility":
"normal",ea)}}}dispose(){this.oO=this.qUa=this.NL=this.bJ=null;this.$.Ka.fKb(this.PIf);super.dispose()}zOg(ra){this.addHandler("RefreshTableStyleGallery",ra)}Wkj(ra){this.removeHandler("RefreshTableStyleGallery",ra)}n0c(){const ra={};this.tableManager.Ig&&(this.gea=this.getTableStyleIndexFromName(this.tableManager.Ig.FBc));for(let N=1;7>=N;N++)ra["preview"+N]=this.xZh(N);this.oO=ra}xZh(ra){var N=this.NL.TableStyleItems.length;N=4>=this.gea?this.gea+ra-1:4<this.gea&&this.gea<N-4?4===ra?this.gea:Math.floor(this.gea+
ra-4):this.gea+ra-1;-1===N||N.toString()in this.qUa||(N=ra-3);return N}aig(){if(this.tableManager.Ig){let ra=!1;const N=this.getTableStyleIndexFromName(this.tableManager.Ig.FBc);if(N!==this.gea){if(this.oO){const ea=this.oO;for(let Ba in ea)ea[Ba]===N&&(ra=!0)}this.gea=N;ra||h.a.isEmpty(this.qUa)||this.n0c()}}}U2(ra,N,ea){const Ba=this.Va.Ec();Ba.fq="Thin";Ba.title=C.a.instance.ga(ea);Ba.buttons.push(N);ra.tc.push(Ba)}Kwb(){const ra=this.tableManager.Ig;return this.B7a||!ra?new T(!0,!1,!1,!1,!0,!1):
new T(A.d(ra),A.g(ra),A.c(ra),A.e(ra),A.f(ra),A.b(ra))}SSf(ra=!1){const N={},ea={},Ba=this.Kwb();if(!h.a.isEmpty(this.bJ)&&(this.tableManager.Ig&&this.aig(),!Ba.equals(this.J0c)||ra||h.a.isEmpty(this.qUa))){this.YIa=O.t_h(this.YIa);ra=this.bJ;for(var ka in ra){const Ka=ra[ka],Oa=O.Pxb(Ka,this.YIa);N[Ka.Index.toString()]=O.f5a(O.Mta(O.M5b(Ka,Ba)),Oa);ea[Oa]=N[Ka.Index.toString()];this.sJb(ea)}ka=O.Pxb(null,this.YIa,"-1");N["-1"]=O.f5a(O.Mta(O.M5b(null,Ba)),ka);ea[ka]=N["-1"];this.sJb(ea);I.c(this.qUa,
N,!1)}}lvi(){const ra=n.a(this.$);return ra?ra.Gm.gA===r.a.TQa:!1}aHd(ra,N,ea){Number.parseInvariant(ea);"-1"===ea&&G.a.contains(N.ParentMenuId,"FormatAsTable",!0)||this.RMf(N,ea,ra,!1)}RMf(ra,N,ea,Ba){const ka=O.Pxb(null,this.YIa,N);O.Fmf(ra)?(ka in this.lna?ea=this.lna[ka]:(ea=O.Mta(O.M5b(this.tjd(N),ea)),this.lna[ka]=ea),ra[m.a.GalleryButtonProps]=Object(f.a)(new l.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ka,Alt:ra[m.a.Alt],MenuItemId:N,TableCellStyles:ea,TableStyles:this.J8i})):
(ra[v.a.Icon]=ka,ra[m.a.GalleryButtonProps]=Object(f.a)(new t.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ka,Alt:ra[m.a.Alt],MenuItemId:N}),Ba||(Ba=[],this.tjd(N),"-1"===N||G.a.contains(ra.ParentMenuId,"FormatAsTable",!0)||(Ba=O.M5b(this.NL.TableStyleItems[Number.parseInvariant(N)],ea)),this.qUa[N]=O.f5a(O.Mta(Ba),ka)))}sJb(ra){if(this.SBb)this.Xwc=()=>{this.sJb(ra)};else{this.Xwc=null;var N=[];for(let Ba in ra){var ea=Ba;ea in this.tJb?N.push(ea):this.tJb[ea]=!0}try{0<N.length&&appChrome.api.unregisterIcons(N),
h.a.isEmpty(ra)||appChrome.api.registerIconProvider(()=>ra)}catch(Ba){}}}tjd(ra){ra=Number.parseInvariant(ra);if(-1===ra||!this.NL)return null;if(60<ra)for(let N=60;N<this.NL.TableStyleItems.length;++N){const ea=this.NL.TableStyleItems[N];if(ea.Index===ra)return ea}return this.NL.TableStyleItems[ra]}}Object(u.a)(va,"TableStyleManager",z.a,[250,2]);var ca=a(55);a.d(D,"a",function(){return V});class V extends c.a{constructor(ra){super();this.tableStyleManager=null;this.$=ra;this.Fb()}create(){const ra=
b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),N=b.GetServiceTaskFactory.Oa(this.$.da,66,134,this.Ya);e.TaskExtensions.Aa(ca.Task.mJ(ra,N),()=>{this.ob(this.tableStyleManager||(this.tableStyleManager=new va(this.$,ra.result,N.result)))},this.$.la,8)}}Object(u.a)(V,"TableStyleManagerFactory",c.a,[])},1231:function(u,D,a){u=a(0);var c=a(222),b=a(15),e=a(164),f=a(247),d=a(373),h=a(4),m=a(643),l=a(86),v=a(94),t=a(259),z=a(161),r=a(74),n=a(420),w=a(50),B=a(37),A=a(91),y=a(71),x=a(1),F=a(572),
I=a(21),L=a(33);class X extends v.a{constructor(W,O){super(W);this.mT=[];this.sde=null;this.VKb=T=>{let Y="forward";T.Values[d.a.direction]?Y=T.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");T=0;let va=!0;"backward"===Y?(T=this.Rud.length-1,va=!1):"forward"===Y?(T=0,va=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Y}`);this.$vf(va,T,!1)};this.iEf=()=>{this.mT=[]};this.NPa=T=>{-411645385===this.$.shortcutKeyManager.xs(T,
!0)&&this.Ajf()&&(this.$.Ka.Lb(new A.a(-411645385,1,this.$.Hc,6,null),{["event"]:T},T),T.stopPropagation())};this.IVi=T=>{this.Mma(T)};this.jb=O;this.Aq=I.h(this.jb);this.Gc.ka("keydown",this.IVi);this.Gc.ka("keyup",this.NPa);t.a(O).LOg(this.iEf);r.a(O.va,27)&&B.TaskExtensions.Aa(w.GetServiceTaskFactory.Oa(O.da,21,137,1),T=>{T=T.result;T.uo(e.a.Ccf);T.em(e.a.Ccf,this.VKb)},O.la)}get $(){return this.jb}get Rud(){this.mT.length||(this.mT=this.c4e());return this.mT}get Nla(){return this.sde}set Nla(W){this.sde=
W;this.mT=this.c4e()}dispose(){this.$&&t.a(this.$).jlj(this.iEf);this.jb=null;this.mT.length=0;super.dispose()}t9i(W){this.Mma(W)}$vf(W,O,T=!0,Y=null){var va=this.EPj(W,O,T,Y);if(!va){T=O;var ca=W?1:-1,V=this.Rud;do{va=!1;if(r.a(this.$.va,27)){if(T+=ca,T>=V.length||0>T)va=!0}else T=(T+ca+V.length)%V.length;if(va){this.NEi(W,O,Y);break}else if(va=this.jcg(W,O,T,!1,Y))break}while(T!==O)}}EPj(W,O,T=!0,Y=null){let va=null;0<=O&&(va=this.mT[O]);return(null===va||void 0===va?0:va.Ff)&&va.gg(W,T)?(Y&&y.g(Y),
b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${va.de} into a sub region`),va.sj(),!0):!1}jcg(W,O,T,Y,va=null){T=this.mT[T];if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const ca=t.a(this.jb).vB(f.a.CKa),V=t.a(this.jb).vB(f.a.Yxb),ra=this.Aq.ha.Ra.u_;if(T===V&&ra||T===ca&&!Y&&!ra)return!1}if((null===T||void 0===T?0:T.Ff)&&T.gg(W,!1)){va&&y.g(va);T.sj();if(W=this.mT[O])W.Wj(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${W.de} to ${T.de}`);
return!0}return!1}NEi(W,O,T=null){T&&y.g(T);if(O=this.mT[O])O.Wj(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${O.de}`);B.TaskExtensions.Aa(w.GetServiceTaskFactory.Oa(this.$.da,21,137,0),Y=>{Y.result.Oj(e.a.ynb,{[d.a.direction]:W?"forward":"backward"})},this.$.la)}Mma(W){var O=this.$.isEditMode?z.a(this.$):null;if(!this.$.rb.Nxa||X.tqi(O))if(117===W.keyCode&&(W.ctrlKey||y.b(W))){O=this.Y6e(W.target);var T=!W.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${O}`);
if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var Y=t.a(this.jb).vB(f.a.$Kb);Y=this.mT.indexOf(Y);h.AFrameworkApplication.sa.Pa.Mw&&this.$.D_&&-1!==Y&&O===Y&&m.ShyRibbon.QJ(this.$.Ueb,0)}else h.AFrameworkApplication.sa.Pa.Mw&&this.$.D_&&1===O&&m.ShyRibbon.QJ(this.$.Ueb,0);this.$vf(T,O,!0,W)}else 117!==W.keyCode||X.GWe?-411645385===this.$.shortcutKeyManager.xs(W)?this.Ajf()&&(this.$.Ka.Lb(new A.a(-411645385,1,this.$.Hc,6,null),{["event"]:W},W),W.stopPropagation()):
1588554917===this.$.shortcutKeyManager.xs(W)?0===this.mode?(F.a(this.$)||this.$.Ka.Lb(new A.a(1588554917,1,this.$.Hc,6,null),{["event"]:W},W),W.preventDefault(),W.stopPropagation()):3===this.mode&&(W.preventDefault(),W.stopPropagation()):x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.xs(W)?(O=this.Y6e(W.target),Y=t.a(this.jb).vB(f.a.$Kb),T=t.a(this.jb).vB(f.a.CKa),Y=this.mT.indexOf(Y),T=this.mT.indexOf(T),h.AFrameworkApplication.sa.Pa.Mw&&
this.$.D_&&-1!==Y&&O===Y&&1===this.$.Ueb&&m.ShyRibbon.QJ(1,0),-1!==T&&O!==T&&this.jcg(!0,O,T,!0,W)):this.S9h(W):(W=n.a.GC.notificationBar.R3(l.a.rVh(),!1),L.a.e8a()?W.image=3:W.image=0,n.a.GC.notificationBar.HC(W),X.GWe=!0)}Y6e(W){const O=this.Rud;for(let T=0,Y=O.length;T<Y;++T){const va=O[T];if(va&&va.lh(W))return T}return-1}c4e(){const W=[];for(let O=0,T=this.Nla.length;O<T;O++){const Y=t.a(this.$).vB(this.Nla[O]);Y&&W.push(Y)}return W}Ajf(){return 0===this.mode||4===this.mode}static tqi(W){return W?
W.inKeytipMode:!1}}X.GWe=!1;Object(u.a)(X,"AccessibilityManager",v.a,[545,2]);var P=a(149),G=a(22),C=a(13);class H extends X{constructor(W){super(document.documentElement,W);this.tC=0;this.tVg=[f.a.YGe,f.a.pBd,f.a.ufc,f.a.TZd,f.a.$Kb,f.a.p0c,f.a.Wdd,f.a.D9e,f.a.x_c,f.a.LBc,f.a.WKj,f.a.Yxb,f.a.D1c,f.a.CKa,f.a.NTd,f.a.J1c,f.a.Eag,f.a.eqf,f.a.T_c];this.O3j=[f.a.ufc,f.a.ilg,f.a.hlg,f.a.jlg];this.V8i=[f.a.ufc,f.a.oOf,f.a.pOf,f.a.rOf];this.t2g=[f.a.AZe,f.a.C9e,f.a.Udd,f.a.Sdd];this.A8i=[f.a.YGe,f.a.pBd,
f.a.p0c,f.a.Wdd,f.a.x_c,f.a.LBc,f.a.Yxb,f.a.D1c,f.a.CKa,f.a.NTd,f.a.PNf,f.a.J1c,f.a.T_c];this.K8i=[f.a.Yxb,f.a.FZe];const O=C.a.instance.Ua(253);this.Nyj=this.$.shortcutKeyManager.qLa(O);this.mode=0;W.da.Ga(15,this);B.TaskExtensions.Aa(w.GetServiceTaskFactory.Oa(W.da,21,137,1),T=>{T=T.result;T.uo(e.a.ynb);T.em(e.a.ynb,this.VKb)},W.la)}get mode(){return this.tC}set mode(W){this.tC=W;switch(W){case 0:this.Nla=this.tVg;break;case 2:this.Nla=this.O3j;break;case 3:this.Nla=this.V8i;break;case 4:this.Nla=
this.t2g;break;case 5:this.Nla=this.A8i;break;case 6:this.Nla=this.K8i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Mma(W){this.$.rd&65536&&super.Mma(W)}S9h(W){if(G.a.equals(this.Nyj,this.$.shortcutKeyManager.Vgd(W),!1)){const O=P.b(this.$);if(null===O||void 0===O?0:O.Ff)y.g(W),O.gg(!0,!1)}}}Object(u.a)(H,"EwaAccessibilityManager",X,[]);class J extends c.a{constructor(W){super();this.$=W;this.Fb()}create(){this.ob(this.$.da.za(15)||new H(this.$))}static ka(W){W.da.Ga(157,
new J(W))}}Object(u.a)(J,"AccessibilityManagerFactory",c.a,[]);var M=a(9);a.d(D,"a",function(){return S});const S=()=>{M.a.Fa(J.ka)}},1232:function(u,D,a){var c=a(9);u=a(0);var b=a(15),e=a(222),f=a(37),d=a(53),h=a(290),m=a(212);class l{}l.cTe="ewa-svg-icon";Object(u.a)(l,"CssClassNames",null,[]);var v=a(50),t=a(12),z=a(315),r=a(184);class n{constructor(A){this.rg=()=>{this.jqf();this.$.ea.lo(this.rg)};this.$=A;this.icg={};this.qYd={};const y=this.K3e("excelInitialAppSprite");y?(this.Dqe(y),this.$.ea.qg?
this.jqf():A.ea.Kk(this.rg),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.qYd=null;this.$.ea.lo(this.rg)}qka(A,y,x=null,F=null){let I;(I=this.qYd[A])||(this.qYd[A]=I=this.m4i(this.icg[A]));if(!I)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${A} was not found in loaded SVG sprites.`),null;const L=I.cloneNode(!0);if(!L.style){const X=z.b(I),P=z.b(L),G={};G.iconId=A;G.isOriginalNodeStyleNull=
void 0===I.style||null===I.style;G.isOriginalNodeCurrentStyleNull=void 0===I.currentStyle||null===I.currentStyle;G.isClonedNodeCurrentStyleNull=void 0===L.currentStyle||null===L.currentStyle;G.originalNode=X.substring(0,X.indexOf(">")+1);G.clonedNode=P.substring(0,P.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(G)}`)}L.setAttribute("style",`height: ${y}px; width: ${y}px;`);F&&(A=document.createElement("title"),
A.innerHTML=F,L.insertBefore(A,L.childNodes[0]));if(x)for(const X of x)Sys.UI.DomElement.addCssClass(L,X);return L}Kba(A,y,x,F,I=0,L=0,X=null,P=null){I&&L||(L=t.DOMElementExtensions.getBoundingClientRect(F),I=L.height,L=L.width);if(X=this.qka(A,y,X,P))F.appendChild(X),(F=t.DOMElementExtensions.OZ(X,"style",null))?X.setAttribute("style",F+` margin: ${(I-y)/2}px ${(L-x)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${A}`);
return X}jqf(){f.TaskExtensions.Aa(v.GetServiceTaskFactory.Oa(this.$.da,283,284,0),A=>{A=r.c(A.result.pn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(A,()=>{const y=this.K3e("excelUiSlice20Sprite");y?this.Dqe(y):b.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.la,3)},this.$.da.la,3)}Dqe(A){for(const y of A)y.type===m.a.oYd&&(this.icg[y.id]=y)}m4i(A){if(!A)return null;const y=A.viewBox;A=A.children;const x=document.createElementNS(h.a.rYd,
m.a.oYd);Sys.UI.DomElement.addCssClass(x,l.cTe);x.setAttribute("focusable","false");x.setAttribute("viewBox",y);this.TKg(x,A);return x}TKg(A,y){for(const F of y){const I=document.createElementNS(h.a.rYd,F.type);for(let L in F){y=L;var x=F[L];"className"===y?I.setAttribute("class",x):I.setAttribute(y,x)}A.appendChild(I)}}K3e(A){return(A=window[A])?A.icons:null}}Object(u.a)(n,"SvgIconProvider",null,[499,2]);class w extends e.a{constructor(A){super();this.$=A;this.Fb()}create(){f.TaskExtensions.Aa(d.a.sR([130],
4,this.Ya,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.ob(this.$.da.za(388)||new n(this.$)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}static ka(A){A.da.Ga(387,new w(A))}}Object(u.a)(w,"SvgIconProviderFactory",e.a,[]);a.d(D,"a",function(){return B});const B=()=>{c.a.Fa(w.ka)}},1257:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(21),f=a(1126);class d extends f.a{constructor(l,v){super(l);v.Ga(240,this)}t4h(l){for(const v of this.rangeList)if(l.range.contains(v))return v;
return null}zJd(l){return l.GridBlockModel&&(l=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(l.GridBlockModel))?l.getSparklineRanges():null}}Object(u.a)(d,"SparklineManager",f.a,[500]);class h extends b.a{constructor(l){super();this.sparklineManager=null;this.$=l;this.Fb()}create(){this.ob(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static ka(l){l.da.Ga(239,new h(l))}}Object(u.a)(h,"SparklineManagerFactory",b.a,[]);a.d(D,"a",function(){return m});const m=
()=>{c.a.Fa(h.ka)}},1279:function(u,D,a){u=a(0);var c=a(144),b=a(599);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.hpd()&&c.WacAirSpace.rCc()}animate(h,m,l,v,t){m&&c.WacAirSpace.FL(h.element,m);c.WacAirSpace.animate(h,v,t);l&&c.WacAirSpace.nhj(h.element,l)}}Object(u.a)(e,"AnimationManager",b.a,[2]);var f=a(100);a.d(D,"a",function(){return d});const d=()=>{f.a.Ul.Ga(141,new e)}},1454:function(u,D,a){a.r(D);u=a(1199);D=a(1164);var c=a(1122),b=a(1123),e=a(1124),f=a(1127);a(1125);
var d=a(1231),h=a(1279),m=a(9),l=a(0),v=a(222),t=a(187),z=a(552),r=a(15),n=a(811),w=a(518),B=a(83),A=a(4),y=a(78),x=a(904);class F extends y.a{constructor(C){super();this.Ovd=null;this.$=C;r.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Zpj(){const C=new t.a,H=w.a.mr(B.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>")),J=new z.a(()=>H.result);this.Ovd=new z.a(()=>new n.a(J.value,null));if(!this.Ovd)return C;var M=this.Ovd.value.$Z("NewAndOpenCoreManager",!1);if(!M||3!==M.state||
!M.Wzd)return M?r.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${M.state}, mruResult MruDocuments is null: ${!M.Wzd}`):r.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;M=M.Wzd;const S=["xlsx","xlsb","xlsm"];for(let O=0;O<M.length;O++){var W=M[O];if(0>Array.indexOf(S,W.extension))continue;const T=`${W.title}.${W.extension}`,Y=x.b(W,A.AFrameworkApplication.isRtl);W=W.url;T&&Y&&W?C.add({[F.fileName]:T,
[F.friendlyPath]:Y,[F.section]:"mru",[F.absoluteUrl]:W}):W||r.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return C}dispose(){super.dispose()}}F.fileName="FileName";F.friendlyPath="FriendlyPath";F.section="Section";F.absoluteUrl="AbsoluteUrl";Object(l.a)(F,"NewAndOpenCoreManager",y.a,[501,2]);class I extends v.a{constructor(C){super();this.$=C;this.Fb()}create(){this.ob(this.$.da.za(451)||this.$.da.Ga(451,new F(this.$)))}static ka(C){C.da.Ga(164,
new I(C))}}Object(l.a)(I,"NewAndOpenCoreFactory",v.a,[]);l=a(1156);v=a(1257);y=a(1232);var L=a(1200),X=a(1159),P=a(1149),G=a(1168);a=a(1141);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(D.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();m.a.Fa(I.ka);Object(h.a)();Object(l.a)();Object(v.a)();Object(y.a)();Object(f.a)();Object(L.a)();Object(X.a)();Object(P.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(G.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/2a0f82f9172c899a2096ea7813022450/EwaDSEsNext.acc.js.map