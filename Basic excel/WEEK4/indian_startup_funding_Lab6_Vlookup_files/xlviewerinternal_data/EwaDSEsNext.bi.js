'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[58],{1426:function(u,D,a){function c(K,ob){function Sb(je){return function($e){return kc([je,$e])}}function kc(je){if(bd)throw new TypeError("Generator is already executing.");for(;yc;)try{if(bd=1,Fd&&(Nd=je[0]&2?Fd["return"]:je[0]?Fd["throw"]||((Nd=Fd["return"])&&Nd.call(Fd),0):Fd.next)&&!(Nd=Nd.call(Fd,je[1])).done)return Nd;if(Fd=0,Nd)je=[je[0]&2,Nd.value];switch(je[0]){case 0:case 1:Nd=je;break;case 4:return yc.label++,
{value:je[1],done:!1};case 5:yc.label++;Fd=je[1];je=[0];continue;case 7:je=yc.ops.pop();yc.trys.pop();continue;default:if(!(Nd=yc.trys,Nd=0<Nd.length&&Nd[Nd.length-1])&&(6===je[0]||2===je[0])){yc=0;continue}if(3===je[0]&&(!Nd||je[1]>Nd[0]&&je[1]<Nd[3]))yc.label=je[1];else if(6===je[0]&&yc.label<Nd[1])yc.label=Nd[1],Nd=je;else if(Nd&&yc.label<Nd[2])yc.label=Nd[2],yc.ops.push(je);else{Nd[2]&&yc.ops.pop();yc.trys.pop();continue}}je=ob.call(K,yc)}catch($e){je=[6,$e],Fd=0}finally{bd=Nd=0}if(je[0]&5)throw je[1];
return{value:je[0]?je[1]:void 0,done:!0}}var yc={label:0,sent:function(){if(Nd[0]&1)throw Nd[1];return Nd[1]},trys:[],ops:[]},bd,Fd,Nd,Rd;return Rd={next:Sb(0),"throw":Sb(1),"return":Sb(2)},"function"===typeof Symbol&&(Rd[Symbol.iterator]=function(){return this}),Rd}function b(K,ob,Sb,kc){function yc(bd){return bd instanceof Sb?bd:new Sb(function(Fd){Fd(bd)})}return new (Sb||(Sb=Promise))(function(bd,Fd){function Nd($e){try{je(kc.next($e))}catch(Xe){Fd(Xe)}}function Rd($e){try{je(kc["throw"]($e))}catch(Xe){Fd(Xe)}}
function je($e){$e.done?bd($e.value):yc($e.value).then(Nd,Rd)}je((kc=kc.apply(K,ob||[])).next())})}function e(K,ob,Sb){if(Sb||2===arguments.length)for(var kc=0,yc=ob.length,bd;kc<yc;kc++)!bd&&kc in ob||(bd||(bd=Array.prototype.slice.call(ob,0,kc)),bd[kc]=ob[kc]);return K.concat(bd||Array.prototype.slice.call(ob))}function f(K,ob){function Sb(je){return function($e){return kc([je,$e])}}function kc(je){if(bd)throw new TypeError("Generator is already executing.");for(;yc;)try{if(bd=1,Fd&&(Nd=je[0]&2?
Fd["return"]:je[0]?Fd["throw"]||((Nd=Fd["return"])&&Nd.call(Fd),0):Fd.next)&&!(Nd=Nd.call(Fd,je[1])).done)return Nd;if(Fd=0,Nd)je=[je[0]&2,Nd.value];switch(je[0]){case 0:case 1:Nd=je;break;case 4:return yc.label++,{value:je[1],done:!1};case 5:yc.label++;Fd=je[1];je=[0];continue;case 7:je=yc.ops.pop();yc.trys.pop();continue;default:if(!(Nd=yc.trys,Nd=0<Nd.length&&Nd[Nd.length-1])&&(6===je[0]||2===je[0])){yc=0;continue}if(3===je[0]&&(!Nd||je[1]>Nd[0]&&je[1]<Nd[3]))yc.label=je[1];else if(6===je[0]&&
yc.label<Nd[1])yc.label=Nd[1],Nd=je;else if(Nd&&yc.label<Nd[2])yc.label=Nd[2],yc.ops.push(je);else{Nd[2]&&yc.ops.pop();yc.trys.pop();continue}}je=ob.call(K,yc)}catch($e){je=[6,$e],Fd=0}finally{bd=Nd=0}if(je[0]&5)throw je[1];return{value:je[0]?je[1]:void 0,done:!0}}var yc={label:0,sent:function(){if(Nd[0]&1)throw Nd[1];return Nd[1]},trys:[],ops:[]},bd,Fd,Nd,Rd;return Rd={next:Sb(0),"throw":Sb(1),"return":Sb(2)},"function"===typeof Symbol&&(Rd[Symbol.iterator]=function(){return this}),Rd}function d(K,
ob,Sb,kc){function yc(bd){return bd instanceof Sb?bd:new Sb(function(Fd){Fd(bd)})}return new (Sb||(Sb=Promise))(function(bd,Fd){function Nd($e){try{je(kc.next($e))}catch(Xe){Fd(Xe)}}function Rd($e){try{je(kc["throw"]($e))}catch(Xe){Fd(Xe)}}function je($e){$e.done?bd($e.value):yc($e.value).then(Nd,Rd)}je((kc=kc.apply(K,ob||[])).next())})}function h(K,ob,Sb){if(Sb||2===arguments.length)for(var kc=0,yc=ob.length,bd;kc<yc;kc++)!bd&&kc in ob||(bd||(bd=Array.prototype.slice.call(ob,0,kc)),bd[kc]=ob[kc]);
return K.concat(bd||Array.prototype.slice.call(ob))}function m(K,ob){var Sb="function"===typeof Symbol&&K[Symbol.iterator];if(!Sb)return K;K=Sb.call(K);var kc,yc=[];try{for(;(void 0===ob||0<ob--)&&!(kc=K.next()).done;)yc.push(kc.value)}catch(Fd){var bd={error:Fd}}finally{try{kc&&!kc.done&&(Sb=K["return"])&&Sb.call(K)}finally{if(bd)throw bd.error;}}return yc}function l(K){var ob="function"===typeof Symbol&&Symbol.iterator,Sb=ob&&K[ob],kc=0;if(Sb)return Sb.call(K);if(K&&"number"===typeof K.length)return{next:function(){K&&
kc>=K.length&&(K=void 0);return{value:K&&K[kc++],done:!K}}};throw new TypeError(ob?"Object is not iterable.":"Symbol.iterator is not defined.");}function v(K,ob,Sb){K=K||{};K=K.random||(K.Zjk||z)();K[6]=K[6]&15|64;K[8]=K[8]&63|128;if(ob){Sb=Sb||0;for(var kc=0;16>kc;++kc)ob[Sb+kc]=K[kc];return ob}return t(K)}function t(K){var ob=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;ob=(jc[K[ob+0]]+jc[K[ob+1]]+jc[K[ob+2]]+jc[K[ob+3]]+"-"+jc[K[ob+4]]+jc[K[ob+5]]+"-"+jc[K[ob+6]]+jc[K[ob+7]]+"-"+jc[K[ob+
8]]+jc[K[ob+9]]+"-"+jc[K[ob+10]]+jc[K[ob+11]]+jc[K[ob+12]]+jc[K[ob+13]]+jc[K[ob+14]]+jc[K[ob+15]]).toLowerCase();if("string"!==typeof ob||!Eb.test(ob))throw TypeError("Stringified UUID is invalid");return ob}function z(){if(!ja&&(ja="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!ja))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
return ja(Ta)}function r(K){return void 0==K?"mspq":"mspq-".concat(K)}function n(K,ob){if(void 0==K)throw Error(ob?ob():"Value should be defined");return K}function w(K,ob,Sb){K.has(ob)?n(K.get(ob)).push(Sb):K.set(ob,[Sb])}function B(K,ob,Sb){K.has(ob)?n(K.get(ob)).add(Sb):K.set(ob,new Set([Sb]))}function A(K,ob){var Sb;try{for(var kc=l(K.keys()),yc=kc.next();!yc.done;yc=kc.next())if(ob(K.get(yc.value)))return!0}catch(Fd){var bd={error:Fd}}finally{try{yc&&!yc.done&&(Sb=kc.return)&&Sb.call(kc)}finally{if(bd)throw bd.error;
}}return!1}function y(K,ob,Sb){var kc;void 0===Sb&&(Sb=function(Rd,je){return Rd===je});if(K.size!==ob.size)return!1;try{for(var yc=l(K.keys()),bd=yc.next();!bd.done;bd=yc.next()){var Fd=bd.value;if(!ob.has(Fd)||!Sb(K.get(Fd),ob.get(Fd)))return!1}}catch(Rd){var Nd={error:Rd}}finally{try{bd&&!bd.done&&(kc=yc.return)&&kc.call(yc)}finally{if(Nd)throw Nd.error;}}return!0}function x(K){return new Map(K.entries())}function F(K,ob,Sb){var kc,yc=new Map;try{for(var bd=l(Array.from(new Set(h(h([],m(W(K)),
!1),m(W(ob)),!1)))),Fd=bd.next();!Fd.done;Fd=bd.next()){var Nd=Fd.value;yc.set(Nd,Sb(K.get(Nd),ob.get(Nd)))}}catch(je){var Rd={error:je}}finally{try{Fd&&!Fd.done&&(kc=bd.return)&&kc.call(bd)}finally{if(Rd)throw Rd.error;}}return yc}function I(K,ob,Sb){var kc;if(!va(K,ob))throw Error("Maps should have the same keys");var yc=new Map;try{for(var bd=l(W(K)),Fd=bd.next();!Fd.done;Fd=bd.next()){var Nd=Fd.value;yc.set(Nd,Sb(K.get(Nd),ob.get(Nd)))}}catch(je){var Rd={error:je}}finally{try{Fd&&!Fd.done&&(kc=
bd.return)&&kc.call(bd)}finally{if(Rd)throw Rd.error;}}return yc}function L(K,ob){var Sb=0;K.forEach(function(kc){ob(kc)&&Sb++});return Sb}function X(K,ob){var Sb=new Map;K.forEach(function(kc,yc){ob(yc,kc)&&Sb.set(yc,kc)});return Sb}function P(K,ob){return X(K,function(Sb,kc){return ob(kc)})}function G(K,ob,Sb){for(var kc=new Map,yc=0;yc<K.length;yc++){var bd=K[yc];kc.set(ob(bd,yc),Sb(bd,yc))}return kc}function C(K,ob){return new Map(K.map(function(Sb,kc){return[Sb,ob(Sb,kc)]}))}function H(K,ob){if(K.length!==
ob.length)throw Error("Keys and values have different lengths");return C(K,function(Sb,kc){return ob[kc]})}function J(K,ob){var Sb,kc=new Map;try{for(var yc=l(K),bd=yc.next();!bd.done;bd=yc.next()){var Fd=bd.value;kc.set(ob(Fd),Fd)}}catch(Rd){var Nd={error:Rd}}finally{try{bd&&!bd.done&&(Sb=yc.return)&&Sb.call(yc)}finally{if(Nd)throw Nd.error;}}return kc}function M(K,ob){return void 0!=ob?K.get(ob):void 0}function S(K,ob){var Sb;try{for(var kc=l(K.entries()),yc=kc.next();!yc.done;yc=kc.next()){var bd=
m(yc.value,2),Fd=bd[0];if(ob(bd[1]))return Fd}}catch(Rd){var Nd={error:Rd}}finally{try{yc&&!yc.done&&(Sb=kc.return)&&Sb.call(kc)}finally{if(Nd)throw Nd.error;}}}function W(K){return h([],m(K.keys()),!1)}function O(K,ob){K=T(K,ob);if(1<K.length)throw Error("Condition should be false. ".concat("Found more than one key"));return 0<K.length?K[0]:void 0}function T(K,ob){return W(K).filter(function(Sb){return ob(K.get(Sb))})}function Y(K,ob){if(!K.has(ob))throw Error("Key not found");return K.get(ob)}function va(K,
ob){var Sb,kc;try{for(var yc=l(W(K)),bd=yc.next();!bd.done;bd=yc.next()){var Fd=bd.value;if(!ob.has(Fd))return!1}}catch(Xe){var Nd={error:Xe}}finally{try{bd&&!bd.done&&(Sb=yc.return)&&Sb.call(yc)}finally{if(Nd)throw Nd.error;}}try{for(var Rd=l(W(ob)),je=Rd.next();!je.done;je=Rd.next())if(Fd=je.value,!K.has(Fd))return!1}catch(Xe){var $e={error:Xe}}finally{try{je&&!je.done&&(kc=Rd.return)&&kc.call(Rd)}finally{if($e)throw $e.error;}}return!0}function ca(K){return X(K,function(ob,Sb){return void 0!=Sb})}
function V(K,ob,Sb){Oa(K,ob,function(kc){return Object.assign({},kc,Sb)})}function ra(K,ob){ob.forEach(function(Sb,kc){return K.set(kc,Sb)})}function N(K,ob){var Sb=[];K.forEach(function(kc,yc){return Sb.push(ob(kc,yc))});return Sb}function ea(K){return N(K,function(ob,Sb){return{key:Sb,value:ob}})}function Ba(K,ob,Sb){var kc=new Map;K.forEach(function(yc,bd){return kc.set(ob(bd),Sb(yc))});return kc}function ka(K,ob){var Sb=new Map;K.forEach(function(kc,yc){return Sb.set(ob(yc),kc)});return Sb}function Ka(K,
ob){return C(W(K),function(Sb){return ob(K.get(Sb),Sb)})}function Oa(K,ob,Sb){if(K.has(ob)){var kc=K.get(ob);K.set(ob,Sb(kc));return!0}return!1}function wa(K,ob,Sb){if(K.has(ob)){var kc=K.get(ob);K.set(ob,Sb(kc))}else K.set(ob,Sb(void 0))}function qa(K,ob,Sb){if(!Oa(K,ob,Sb))throw Error("Key not found");}function aa(K){return h([],m(K.values()),!1)}function ia(K){return new Promise(function(ob,Sb){var kc=new Map,yc=h([],m(K.keys()),!1).length;0===yc?ob(kc):K.forEach(function(bd,Fd){bd.then(function(Nd){kc.set(Fd,
Nd);yc--;0===yc&&ob(kc)},function(Nd){Sb(Nd)})})})}function Ha(K,ob,Sb){var kc;return K&&Z(K)&&K.hasOwnProperty(ob)?null!==(kc=K[ob])&&void 0!==kc?kc:Sb:Sb}function Z(K){return null!==K&&"object"===typeof K&&!Array.isArray(K)&&K.constructor===Object}function la(K,ob){switch(ob){case "azureportal-v1.0.0":return{tdb:new $c(K),XAa:new gd};default:return{tdb:new md(K),XAa:new Xd}}}function Xa(K,ob,Sb){var kc=-1<K.indexOf("?")?"&":"?";return"".concat(K).concat(kc).concat(encodeURIComponent(ob),"=").concat(encodeURIComponent(Sb))}
a.r(D);var Za={};a.r(Za);a.d(Za,"empty",function(){return gc});a.d(Za,"addToListMap",function(){return w});a.d(Za,"addToSetMap",function(){return B});a.d(Za,"anyValue",function(){return A});a.d(Za,"areEqual",function(){return y});a.d(Za,"clone",function(){return x});a.d(Za,"combineValues",function(){return F});a.d(Za,"combineValuesStrict",function(){return I});a.d(Za,"countWhereValue",function(){return L});a.d(Za,"filter",function(){return X});a.d(Za,"filterValues",function(){return P});a.d(Za,"fromItems",
function(){return G});a.d(Za,"fromKeys",function(){return C});a.d(Za,"fromKeysAndValues",function(){return H});a.d(Za,"fromValues",function(){return J});a.d(Za,"get",function(){return M});a.d(Za,"getFirstKeyWhereValue",function(){return S});a.d(Za,"getKeys",function(){return W});a.d(Za,"getKeyWhereValue",function(){return O});a.d(Za,"getKeysWhereValue",function(){return T});a.d(Za,"getOrThrow",function(){return Y});a.d(Za,"haveSameKeys",function(){return va});a.d(Za,"keepDefined",function(){return ca});
a.d(Za,"setProperties",function(){return V});a.d(Za,"setMultiple",function(){return ra});a.d(Za,"toArray",function(){return N});a.d(Za,"toKeyValuePairs",function(){return ea});a.d(Za,"transform",function(){return Ba});a.d(Za,"transformKeys",function(){return ka});a.d(Za,"transformValues",function(){return Ka});a.d(Za,"update",function(){return Oa});a.d(Za,"updateOrSet",function(){return wa});a.d(Za,"updateOrThrow",function(){return qa});a.d(Za,"valuesAsArray",function(){return aa});a.d(Za,"waitForValues",
function(){return ia});var xa=a(511),fa=a(0),ua=a(15),sa=a(87),sb=a(82),hb=a(416),bb=a(78),lb=a(49),Fa=a(259),Na=a(239),Mb=a(14),dc=a(752),Cb=a(68);class Tb{}Tb.Puh="ewa-bix-ltr";Tb.Quh="ewa-bix-rtl";Tb.Tuh="ewa-bix-titlebar";Tb.Ruh="ewa-bix-subtitle";Tb.Suh="ewa-bix-title";Tb.uRe="ewa-bix-close";Tb.Rx="clip16x16";Tb.Iuh="ewa-bix-body";Tb.Nuh="ewa-bix-drilldetails";Tb.Kuh="ewa-bix-DrillButton";Tb.Ouh="ewa-bix-hover";Tb.Luh="ewa-bix-DrillLabel1";Tb.Muh="ewa-bix-DrillLabel2";Tb.Uuh="ewa-bixfl";Tb.vRe=
"ewa-bixfl-NoFocus";Tb.Xuh="ewa-bixfl-ItemSelected";Tb.Vuh="ewa-bixfl-Icon";Tb.Wuh="ewa-bixfl-Item";Tb.Juh="ewa-bix-calloutBackground";Tb.j$b="ewa-ipad";Object(fa.a)(Tb,"CssClassNames",null,[]);var Jb=a(19),eb=a(5),za=a(60),ha=a(30),fb=a(238),rb=a(12),pa=a(71),Ma=a(13),Ja=a(21);class Ga extends fb.a{constructor(K,ob,Sb,kc,yc,bd){super(ob);this.w9c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];this.V6b=-1;this.zva=this.cub=this.bub=this.dub=null;this.hd=Fd=>{const Nd=this.domElement;
let Rd=Fd.target;for(;Rd!==Nd;){if(Rd.id.startsWith("bix-drill-action")){this.drillTo(this.V6b,Rd.id);pa.g(Fd);break}Rd=Rd.parentNode}};this.OHf=(Fd,Nd)=>{Fd=-1===this.V6b;const Rd=Nd.mdi;this.V6b=Rd;let je=null;Rd===this.Xxe.HierarchyId?(this.C3f(!1),this.drillUp||this.drillDown?(this.D3f(!0),rb.DOMElementExtensions.setVisible(this.domElement,!0),je=this.bub||this.dub):rb.DOMElementExtensions.setVisible(this.domElement,!1)):(this.D3f(!1),je=this.cub,Ga.Zxj(je,Nd.caption,Ma.a.instance.ga(1189)),this.C3f(!0),
rb.DOMElementExtensions.setVisible(this.domElement,!0));Fd||this.N3f(je)};this.$=K;this.Ty=Sb;this.Xxe=kc.Context;K=kc.DrillContext;this.drillUp=K.DrillUp;this.drillDown=K.DrillDown;this.imd=yc;this.GJ=bd;yc.bOg(this.OHf);this.vH()}dispose(){this.imd&&this.imd.Dkj(this.OHf);this.w9c=this.dub=this.bub=this.cub=this.zva=this.GJ=this.drillUp=this.drillDown=this.Xxe=this.Ty=this.GJ=this.imd=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var K=rb.DOMElementExtensions.kq(this.domElement);
if(!K)return!1;K=K.id;return!!K&&K.startsWith("bix-drill-action")}onKeyDown(K){const ob=K.keyCode;K=K.shiftKey;if(this.hasFocus()){let Sb=!1;13===ob?(this.drillTo(this.V6b,this.zva.id),Sb=!0):9===ob&&((Sb=this.$_(!K))||this.GLe());return Sb}return 9===ob?this.setInitialFocus(!K):!1}setFocus(K){return this.hasFocus()?this.$_(K):this.setInitialFocus(K)}vH(){rb.DOMElementExtensions.Pu(this.domElement,eb.a.F1b,null,null);var K='<button id="{0}" class="'+Tb.Kuh+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+
Tb.Luh+'">{3}</div><div id="{4}" class="'+Tb.Muh+'">{5}</div></button>';let ob="",Sb;let kc;if(this.drillDown){Sb=Ma.a.instance.ga(1191);var yc=this.drillDown.Caption;kc=String.format("{0} ({1})",Sb,yc?ha.a.h_(yc):"");yc=yc?ha.a.Eg(yc):"";ob+=String.format(K,"bix-drill-action-down",kc,"bixdddl_1",Sb,"bixdddl_2",yc)}this.drillUp&&(Sb=Ma.a.instance.ga(1190),yc=this.drillUp.Caption,kc=String.format("{0} ({1})",Sb,yc?ha.a.h_(yc):""),yc=yc?ha.a.Eg(yc):"",ob+=String.format(K,"bix-drill-action-up",kc,"bixddul_1",
Sb,"bixddul_2",yc));ob+=String.format(K,"bix-drill-action-to","","bixddtl_1",Ma.a.instance.ga(1189),"bixddtl_2","");K=this.domElement;rb.DOMElementExtensions.kr(K,ob);this.dub=this.getElementById("bix-drill-action-up");this.bub=this.getElementById("bix-drill-action-down");this.cub=this.getElementById("bix-drill-action-to");this.Gc.ka("click",this.hd);K.setAttribute(eb.a.d3,"");rb.DOMElementExtensions.setVisible(K,!1)}drillTo(K,ob){let Sb;switch(ob){case "bix-drill-action-up":Sb=this.drillUp.Id;break;
case "bix-drill-action-down":Sb=this.drillDown.Id;break;case "bix-drill-action-to":Sb=1;break;default:return}Ja.h(this.$).Uo(!0);this.GJ.B7g((kc,yc,bd)=>{var Fd=this.Ty,Nd=this.$.pa.ya,Rd=Fd.confirmationRequiredForDataOps,je=Sb;Fd=za.L(Nd,Fd.lx,Fd.externalSourceIndex,this.Ty.NR);Fd.requiresConfirmation=Rd;Fd.hierarchyId=K;Fd.levelId=je;return za.g(Nd,"BixDrill",Fd,kc,yc,bd,null,0)})}$_(K){let ob=0;if(this.zva)switch(this.zva.id){case "bix-drill-action-down":ob=0;break;case "bix-drill-action-up":ob=
1;break;case "bix-drill-action-to":ob=2}return this.G4f(K?ob+1:ob-1,K)}GLe(){const K=this.zva;K&&(K.blur(),this.domElement.setAttribute(eb.a.d3,""));this.zva=null}C3f(K){this.cub&&rb.DOMElementExtensions.setVisible(this.cub,K)}D3f(K){this.dub&&rb.DOMElementExtensions.setVisible(this.dub,K);this.bub&&rb.DOMElementExtensions.setVisible(this.bub,K)}N3f(K){K!==this.zva&&this.GLe();if(!K)return!1;K.tabIndex=0;rb.DOMElementExtensions.setFocus(K);this.domElement.setAttribute(eb.a.d3,K.id);this.zva=K;return!0}setInitialFocus(K){return this.G4f(K?
0:this.w9c.length-1,K)}G4f(K,ob){const Sb=this.w9c;for(;0<=K&&K<Sb.length;){const kc=rb.DOMElementExtensions.getElementById(this.domElement,Sb[K]);if(kc&&rb.DOMElementExtensions.isVisible(kc))return this.N3f(kc);K=ob?K+1:K-1}return!1}static Zxj(K,ob,Sb){Sb=String.format("{0} ({1})",Sb,ob);K.setAttribute("title",Sb);K.lastChild.innerText=ob}}Object(fa.a)(Ga,"BixDrillDetails",fb.a,[]);var La=a(224),nb=a(27),Lb=a(35),ac=a(209),ib=a(53);const Ra=Tb.Wuh,ya=Tb.Xuh,Va=`<div id="{0}" class="${Tb.Vuh}" style="{1}"><div class="${Jb.a.Rx}"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>`;
class oa{constructor(K,ob,Sb,kc,yc){this._element=null;this.lM=this.visible=!0;this.fieldListSelector=K;this.lIc=ob.Name||"";this.clientId=ob.ClientId;this.JEa=ob.IsCollapsible;this.parentId=ob.ClientParentId;this.MBg=ob.PivotCacheIndex;this.type=ob.TypeTag;this.pkg=ob.UserRank;this.Ydi=Sb;this.gKe=kc;this.pih=yc;this.fieldListSelector.dLg(this.clientId,this);this.children=[];ob.Children.forEach(bd=>{this.children.push(new oa(K,bd,Sb,kc,yc))})}get caption(){return this.lIc}get element(){return this._element||
(this._element=this.fieldListSelector.getElementById(oa.sbb+this.clientId))}get Mbi(){return-1!==this.parentId}get isCollapsed(){return this.lM}get isCollapsible(){return this.JEa}get isVisible(){return this.visible}get gMf(){return this.MBg}dispose(){this.children&&(sa.a.qc(this.children),this.children=null);this._element=null}KEe(){for(const K of this.children)K.visible=!1,K.JEa&&(K.lM=!0,K.K5f(),0<K.children.length&&K.KEe())}Sue(K,ob){this.visible=!K;var Sb=11*K;let kc=`aria-labelledby="${this.$va(oa.rNf)}" aria-selected="false" aria-level="${K+
1}"`;this.JEa&&(kc+=`aria-expanded="false" aria-owns="${this.$va(oa.qNf)}"`);this.JEa?(this.lM=!0,Sb=String.format(Va,this.$va(oa.pNf),this.O3e(Sb+4),this.$va(oa.pHd),this.gKe,eb.a.es,ib.a.Ge(9))):Sb=String.format('<div style="{0}"></div>',this.O3e(Sb+23));const yc=String.format('<span id="{0}">{1}</span>',this.$va(oa.rNf),ha.a.Eg(this.lIc));ob+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',
this.$va(oa.sbb),Ra,ha.a.h_(this.lIc),kc,Sb,yc);this.JEa&&(++K,ob+=String.format('<div id="{0}" role="group" style="display:none;">',this.$va(oa.qNf)),this.children.forEach(bd=>{ob=bd.Sue(K,ob)}),ob+="</div>");return ob}P7b(){this.element.blur();this.element.tabIndex=-1}aFh(){this.children.forEach(K=>{K.visible=!0})}c2e(K,ob){const Sb=this.children;for(const kc of Sb)if(!kc.JEa&&5===kc.type&&kc.pkg>ob&&(K=kc,ob=kc.pkg,3===ob))return{returnValue:K,bzd:ob};for(const kc of Sb)if(kc.JEa&&({bzd:ob,returnValue:K}=
kc.c2e(K,ob),3===ob))break;return{returnValue:K,bzd:ob}}X2h(){let K=this;for(;-1!==K.parentId;)K=this.fieldListSelector.ohd(K.parentId);return K}Vhc(K){let ob=this;for(;-1!==ob.parentId;){if(K.clientId===ob.parentId)return!0;ob=this.fieldListSelector.ohd(ob.parentId)}return!1}setFocus(){this.element.tabIndex=0;rb.DOMElementExtensions.setFocus(this.element)}K5f(){const K=rb.DOMElementExtensions.getElementById(this.element,this.$va(oa.pHd));if(K){var ob=this.element.nextSibling;rb.DOMElementExtensions.lCa(K,
this.lM,this.gKe,this.pih);this.element.setAttribute(eb.a.LY,this.lM?eb.a.zr:eb.a.xk);rb.DOMElementExtensions.setVisible(ob,!this.lM)}}fCj(){const K=this.fieldListSelector.domElement.querySelectorAll(`.${ya}`);for(let ob=0;ob<K.length;ob++){const Sb=K[ob];Sb.classList.remove(ya);Sb.setAttribute(eb.a.Bha,"false")}this.element.classList.add(ya);this._element.setAttribute(eb.a.Bha,"true")}vPb(){(this.lM=!this.lM)?this.KEe():this.aFh();this.K5f()}$va(K){return K+this.clientId}O3e(K){return String.format(this.Ydi,
K.toString())}}oa.pNf="bixflec_";oa.pHd="bixfleci_";oa.sbb="bixfli_";oa.rNf="bixflil_";oa.qNf="bixflg_";Object(fa.a)(oa,"BixFieldListItem",null,[2]);class kb extends Sys.EventArgs{constructor(K,ob){super();this.mdi=K;this.caption=ob}}Object(fa.a)(kb,"BixHierarchySelectionChangedEventArgs",Sys.EventArgs,[]);var Sa=a(11);class U extends fb.a{constructor(K,ob,Sb,kc,yc){super(ob);this.v3c=0;this.Oya=new Lb.a(!1);this.pxc=-1;this.fJ=this.gN=this.t1f=null;this.hd=Fd=>{Fd.Gb&&this.atc(Fd.Gb);return!0};this.dO=
Fd=>{Fd.button===Sys.UI.MouseButton.leftButton&&Fd.target&&(this.atc(Fd.target),pa.g(Fd))};this.onDoubleClick=Fd=>{if(Fd.button===Sys.UI.MouseButton.leftButton&&Fd.target){var Nd;0!==({OZb:Nd}=this.YXe(Fd.target)).returnValue&&(pa.g(Fd),(Fd=this.Y3e(Nd))&&Fd.isCollapsible&&this.vPb(Fd))}};(this.touchMode=yc)?La.a.instance.ta(Mb.a.click,this.domElement,this.hd):(this.Gc.ka("mousedown",this.dO),this.Gc.ka("dblclick",this.onDoubleClick));this.c$f=!nb.a.Tti&&!yc;let bd;K.isChromeRtl?(bd="padding-right:{0}px;",
this.v3c=39):(bd="padding-left:{0}px;",this.v3c=37);yc=new ac.a(kc.ExcludeHierarchies);yc.z$.sort((Fd,Nd)=>Fd-Nd);K=-1;ob=null;if(Sb=({WCb:K,ee:ob}=this.qef(Sb.FieldListItems,yc,K,ob,kc.Context)).returnValue)1===Sb.length&&(Sb=[...Sb[0].Children],Sb.forEach(Fd=>{Fd.ClientParentId=-1})),Sb.length&&(this.fieldListItems=[],Sb.forEach(Fd=>{this.fieldListItems.push(new oa(this,Fd,bd,Jb.a.vAh,Jb.a.wAh))}),ob||(ob=U.OHh(Sb,kc.Context.DimensionCaption)||Sb[0]),this.ee=this.ohd(ob.ClientId),this.vH())}bOg(K){this.get_events().addHandler("SelectionChanged",
K)}Dkj(K){this.get_events().removeHandler("SelectionChanged",K)}get gui(){return!!this.fieldListItems}dispose(){this.touchMode&&(La.a.instance.Ba(Mb.a.click,this.domElement,this.hd),this.touchMode=!1);this.fJ=null;this.fieldListItems&&(sa.a.qc(this.fieldListItems),this.fieldListItems=null);this.Oya=null;super.dispose()}focus(){this.setFocus(!0)}dLg(K,ob){this.Oya.add(K.toString(),ob)}ohd(K){K=K.toString();return this.Oya.lb(K)?this.Oya.getItem(K):null}hasFocus(){var K=rb.DOMElementExtensions.kq(this.fJ);
return K?(K=K.id)&&K.startsWith(oa.sbb)&&this.gN?!0:!1:!1}onKeyDown(K){K=K.keyCode;if(this.hasFocus()){var ob=!1;38===K||40===K?(this.$_(40===K),ob=!0):37===K||39===K?(K=K===this.v3c,ob=this.gN,ob.isCollapsible&&ob.isCollapsed!==K?this.vPb(ob):K&&ob.Mbi&&this.$_(!1),ob=!0):13===K||32===K?((K=this.gN)&&this.select(K),ob=!0):9===K&&this.HLe(!0);return ob}return 9===K?this.gN?this.KMb(this.gN):this.setInitialFocus(!0):!1}Vwj(){this.fJ.setAttribute(eb.a.jwe,"bix-drilldetails")}setFocus(K){return this.fJ.firstChild?
this.hasFocus()?this.$_(K):this.gN?this.KMb(this.gN):this.setInitialFocus(K):!1}start(){this.ee&&(this.select(this.ee.X2h()),this.gN&&this.scroll(this.gN,!0))}vH(){let K="";this.fieldListItems.forEach(ob=>{K=ob.Sue(0,K)});this.fJ=this.domElement;rb.DOMElementExtensions.kr(this.fJ,K.toString());rb.DOMElementExtensions.Pu(this.fJ,eb.a.H1b,null,null,null);this.fJ.setAttribute(eb.a.nv,Ma.a.instance.ga(1192));this.fJ.classList.add(Jb.a.rp);this.fJ.style.position="relative"}jYh(K){for(;K&&K!==this.fJ;){const ob=
K.id;if(ob&&ob.startsWith(oa.sbb))return K;K=K.parentNode}return null}qef(K,ob,Sb,kc,yc){const bd=Sb;if(!K||!K.length)return{returnValue:null,WCb:Sb,ee:kc};let Fd=0;for(let Nd=0,Rd=K.length;Nd<Rd;Nd++){const je=K[Nd];if(U.Fqi(ob,je))K[Nd]=null,++Fd;else{je.ClientParentId=bd;je.ClientId=++Sb;if(je.IsCollapsible&&(je.Children=({WCb:Sb,ee:kc}=this.qef(je.Children,ob,Sb,kc,yc)).returnValue,!je.Children)){K[Nd]=null;++Fd;continue}5!==je.TypeTag&&3!==je.TypeTag||je.PivotCacheIndex!==yc.HierarchyId||(je.UserRank=
3,kc=je)}}return Fd?Fd===K.length?{returnValue:null,WCb:Sb,ee:kc}:{returnValue:U.eij(K),WCb:Sb,ee:kc}:{returnValue:K,WCb:Sb,ee:kc}}HLe(K){const ob=this.gN;ob&&(ob.P7b(),this.fJ.setAttribute(eb.a.d3,""));this.P7b();K||(this.gN=null)}P7b(){this.c$f&&this.fJ.classList.add(Tb.vRe)}$_(K){let ob=this.gN;if(!ob)return this.setInitialFocus(K);const Sb=this.Oya.values,kc=Sb.length;let yc=Array.indexOf(Sb,ob);for(yc=K?++yc:--yc;0<=yc&&yc<kc;){ob=Sb[yc];if(ob.isVisible)return this.KMb(ob),this.scroll(ob,K),
!0;yc=K?++yc:--yc}return!1}scroll(K,ob){var Sb=K.element;K=Sb.offsetHeight;Sb=Sb.offsetTop;const kc=this.fJ,yc=kc.scrollTop,bd=(Math.floor(kc.clientHeight/K)-3)*K;let Fd=kc.scrollTop;ob?Sb>yc+K+bd&&(Fd=Sb-(K+bd)):Sb<yc+K&&(Fd=Sb-K);kc.scrollTop=Fd}setInitialFocus(K){const ob=this.Oya.count;let Sb=K?0:ob-1;for(;0<=Sb&&Sb<ob;){const kc=this.Oya.$f(Sb);if(kc.isVisible)return this.KMb(kc),this.scroll(kc,!0),!0;Sb=K?++Sb:--Sb}return!1}KMb(K){this.gN&&K!==this.gN&&this.HLe(!1);if(!K)return!1;this.fJ.setAttribute(eb.a.d3,
K.element.id);this.gN=K;-1!==this.pxc&&(K.setFocus(),this.c$f&&this.fJ.classList.remove(Tb.vRe));return!0}YXe(K){for(;K&&K!==this.fJ;){const ob=K.id;if(ob.startsWith(oa.sbb))return{returnValue:1,OZb:K};if(ob.startsWith(oa.pNf)||ob.startsWith(oa.pHd))return{returnValue:2,OZb:K};K=K.parentNode}return{returnValue:0,OZb:null}}Y3e(K){if(!K.id||!K.id.startsWith(oa.sbb)&&(K=this.jYh(K),!K))return null;K=K.id.split("_")[1];return Lb.a.Dc(this.Oya.Gu,K)}atc(K){var ob;K=({OZb:ob}=this.YXe(K)).returnValue;if(0!==
K&&(ob=this.Y3e(ob)))switch(K){case 2:this.vPb(ob);break;case 1:this.select(ob)}}select(K){if(K){K.fCj();this.KMb(K);if(K.isCollapsible){let ob=-1;({bzd:ob,returnValue:K}=K.c2e(null,ob));if(!K)return}this.ee=K;this.pxc!==K.gMf&&(this.pxc=K.gMf,this.t1f=K.caption,this.raiseEvent("SelectionChanged",new kb(this.pxc,this.t1f)),this.hasFocus()||this.P7b())}}vPb(K){K.vPb();K.isCollapsed&&this.ee&&this.ee.Vhc(K)&&this.select(K);this.scroll(K,!K.isCollapsed)}static OHh(K,ob){for(const Sb of K)if(11===Sb.TypeTag&&
Sb.Name===ob)return Sb;return null}static Fqi(K,ob){switch(ob.TypeTag){case 5:case 3:break;default:return!1}return 0<=Sa.HelperMethods.lw(K,0,K.gka(),ob.PivotCacheIndex,(Sb,kc)=>Sb-kc)}static eij(K){let ob=null;for(let Sb=0;Sb<K.length;Sb++)K[Sb]&&(ob||(ob=[]),ob.push(K[Sb]));return ob}}Object(fa.a)(U,"BixFieldListSelector",fb.a,[780]);var ta=a(50),ub=a(37),hc=a(210),Bc=a(47),Qa=a(46),na=a(282),ab=a(281),Gb=a(66);class fc extends dc.a{constructor(K,ob,Sb,kc){super(K,Ma.a.instance.ga(1186),!0,4);this.fieldListSelector=
this.$T=this.JOa=this.TC=this.XIc=this.Baa=null;this.Qbe=!1;this.dTi=(yc,bd)=>{if(this.domElement&&(this.JOa.bUa(),!na.a(yc))){const Fd=yc.Result;Fd&&this.DNj(Fd,bd);super.i0(yc,null,"")}};this.dJj=()=>{rb.DOMElementExtensions.kr(this.o2b,Ma.a.instance.ga(1188));const yc=this.Mea.querySelector("."+Tb.uRe);yc.tabIndex=-1;rb.DOMElementExtensions.setFocus(yc)};this.M$a=()=>{this.close(1);return!0};this.domElement.id=K.domElement.id+"_BIExploreCallout";this.Ty=ob;this.targetElement=Sb;this.TYf=!1;this.domElement.classList.remove(this.rtl?
Cb.a.vad:Cb.a.uad);this.domElement.classList.remove(Jb.a.hq);this.domElement.classList.add(this.rtl?Tb.Quh:Tb.Puh);(this.touchMode=kc)||this.domElement.classList.add(Tb.Ouh);this.Mea.className=Tb.Tuh;this.Mea.style.backgroundImage="";this.Xoa.className=Tb.Suh;this.rz.parentNode.className=Tb.uRe;K=this.Qb;K.className="";ob=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",Tb.Ruh,this.Ty.Xdi,Tb.Iuh,
"bix-fieldlistselector",Tb.Uuh,"bix-drilldetails",Tb.Nuh);rb.DOMElementExtensions.kr(K,ob);this.o2b=K.lastChild;this.Bfc()}get pc(){return"BIExploreCallout"}get omi(){return this.Qbe}get vIa(){return 6}get iC(){return 561}rri(K){K=document.getElementById(K);return rb.DOMElementExtensions.isVisible(K)?(this.Baa.setFocus(!0),!0):!1}B7g(K){this.XIc=K;Ja.h(this.$).Uo(!0);this.Qbe=!0;this.close(2)}dispose(){sa.a.qc([this.TC,this.JOa,this.Baa,this.fieldListSelector]);this.Ty=this.Baa=this.fieldListSelector=
this.JOa=this.TC=null;this.tuc();this.XIc=this.targetElement=this.o2b=null;super.dispose()}takeFocus(){this.setFocus()}close(K){this.tuc();super.close(K)}ug(K=!1){ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,12,477,0),ob=>{this.TYf||(this.JOa=ob.result.Rsb(this.Qb,500,null,null,736),this.JOa.WTa())},this.$.la);return ub.TaskExtensions.ts(ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.create(this.$.da,84,this.la,0),ob=>{this.TC=ob.result;this.TC.init(this.domElement,this.targetElement,
document.body,this.$.na.displayRtl);this.TC.C4c=8;this.TC.DYc=!0;this.TC.pbb=fc.W7h();this.sWc();this.TC.vq()},this.la,3),()=>hc.a.prototype.ug.call(this,K),this.la,3,Gb.a.current)}pH(){return this.XIc}o0a(){return(K,ob,Sb)=>{var kc=this.$.pa.ya;K=this.O4a(K);ob=this.aLa(ob);const yc=za.L(kc,this.Ty.lx,this.Ty.externalSourceIndex,this.Ty.NR);return za.g(kc,"GetBixAnalysis",yc,K,ob,Sb,null,4)}}onShow(){this.TC.wPd();super.onShow()}i0(K){const ob=K.Result;if(K.Errors&&!K.Errors.length&&ob&&-1===ob.Context.HierarchyId)this.TYf=
!0,this.JOa&&this.JOa.bUa(),Bc.a.instance.create(this.dJj,1,Qa.a.PVg,!0,!0),super.i0(K,null,"");else{var Sb=kc=>{kc.gA=0;this.UMa(169,(yc,bd,Fd)=>{var Nd=this.$.pa.ya,Rd=kc.FH,je=kc.yJb,$e=kc.gA;yc=ab.b(yc,this.dTi);const Xe=za.L(Nd,kc.lx,kc.externalSourceIndex,kc.ffh());Xe.type=4;Xe.version=Rd;Xe.relatedGroup=je;Xe.selectedTab=$e;return za.g(Nd,"GetPivotFieldListData",Xe,yc,bd,Fd,ob,4)},16)};ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.create(this.$.da,110,this.la,0),kc=>{Sb(kc.result)},this.la,
3)}}onKeyDown(K){let ob=this.o0e();if(K.altKey&&85===K.keyCode)this.close(1),pa.g(K);else if(117===K.keyCode&&K.ctrlKey)this.close(1),pa.g(K);else if(0===ob)if(13===K.keyCode)this.close(1);else super.onKeyDown(K);else{let Sb=!1;for(let kc=0;3>kc&&!Sb;kc++)2===ob?(Sb=this.fieldListSelector.onKeyDown(K))||(ob=1):1===ob&&((Sb=this.Baa.onKeyDown(K))||(ob=2));if(Sb)pa.g(K);else super.onKeyDown(K)}}setFocus(){(this.Baa||this.fieldListSelector)&&this.yTg(this.o0e())}yTg(K){let ob=!1;for(let Sb=0;2>Sb&&!ob;Sb++)1===
K&&this.Baa?(ob=this.Baa.setFocus(!0))||(K=2):2===K&&this.fieldListSelector&&((ob=this.fieldListSelector.setFocus(!0))||(K=1))}o0e(){if(!this.fieldListSelector||!this.Baa)return 0;const K=this.fieldListSelector.hasFocus(),ob=this.Baa.hasFocus();return!K&&!ob||ob?1:2}DNj(K,ob){let Sb=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new U(this.$,Sb,K,ob,this.touchMode);this.fieldListSelector.gui?(this.o2b.setAttribute(eb.a.A1b,"true"),Sb=this.getElementById("bix-drilldetails"),this.Baa=
new Ga(this.$,Sb,this.Ty,ob,this.fieldListSelector,this),this.fieldListSelector.Vwj(),this.fieldListSelector.start(),this.setFocus(),this.o2b.setAttribute(eb.a.A1b,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,rb.DOMElementExtensions.kr(this.Qb,Ma.a.instance.ga(1188)))}sWc(){const K=this.$T=document.createElement("div");K.classList.add(Tb.Juh);Na.a.instance.ta(Mb.a.pointerDown,K,this.M$a);this.domElement.ownerDocument.body.appendChild(K)}tuc(){this.$T&&(Na.a.instance.Ba(Mb.a.pointerDown,
this.$T,this.M$a),rb.DOMElementExtensions.tf(this.$T),this.$T=null)}static W7h(){return fc.pbb||(fc.pbb=[0,1,4,5])}}fc.pbb=null;Object(fa.a)(fc,"BIExploreCallout",dc.a,[756,222]);class pb extends bb.a{constructor(K,ob,Sb){super();this.$=K;this.Iha=Sb.w6b(K,null,ob,Jb.a.r$b,ib.a.Ge(9),Ma.a.instance.ga(1187),"BIXPointerDown")}get Dz(){return this.Iha.Dz}get S3b(){return this.Iha.S3b}dispose(){this.Iha.dispose();this.$=null;super.dispose()}getButton(K){return this.Iha.getButton(K)}fJj(K,ob,Sb,kc){this.Iha.Rp(K+
this.S3b,ob+this.S3b,Sb,kc)}gJj(){var K=Ja.h(this.$).ha.ra.activeCell;const ob=Ja.h(this.$).ib.Li(K);(K=Ja.h(this.$).ag(K,ob))&&0<=K.x&&0<=K.y?this.Rp(K.bottomRight.x+this.Dz,K.bottomRight.y+this.Dz,Ja.h(this.$).rtl,ob):this.hide()}Rp(K,ob,Sb,kc){this.Iha.Rp(K,ob,Sb,kc)}hide(){this.Iha.hide()}domElement(K){return this.Iha.domElement(K)}i3a(K){this.Iha.i3a(K)}}Object(fa.a)(pb,"BIExploreLaunchButton",bb.a,[]);var Ea=a(42);class xb{constructor(K){this.qib=!1;this.oEa=0;this.Rra=this.dRc=this.cRc=this.Xjb=
null;this.$=K;this.reset()}get confirmationRequiredForDataOps(){return this.qib}get externalSourceIndex(){return this.oEa}get Xdi(){return this.Xjb}get q_(){return!!this.NR}get Mhf(){return!!this.lx}get NR(){return this.cRc}get pivotTableName(){return this.dRc}get lx(){return this.Rra}reset(){this.Xjb="";this.Rra=this.dRc=this.cRc=null}qAj(K,ob){this.reset();this.qib=ob.confirmationRequiredForDataOps;this.oEa=ob.externalSourceIndex;this.dRc=ob.pivotTableName;this.Rra=Ea.o(K,this.$);K.Ad(ob.AL)||K.Ad(ob.fF)?
(ob=Ja.h(this.$).Sb(K),this.Xjb=ha.a.Eg(ob.text)):(K=K.top-ob.top,ob.gPd&&ob.gPd.length>K&&(this.Xjb=ob.gPd[K]))}qxj(K,ob,Sb){this.reset();this.oEa=ob.ExternalSourceIndex;this.qib=!!(ob.Attributes&64);this.Xjb=ha.a.Eg(Sb.ValueString);this.cRc={};this.NR.ChartId=K;this.NR.AnchorValue2=-1;switch(Sb.Type){case 1:case 2:0<=Sb.CategoryIndex?(this.NR.AnchorType=2,this.NR.AnchorValue1=Sb.CategoryIndex):(this.NR.AnchorType=1,this.NR.AnchorValue1=Sb.SeriesIndex);break;default:0>Sb.CategoryIndex&&0<=Sb.SeriesIndex?
(this.NR.AnchorType=1,this.NR.AnchorValue1=Sb.SeriesIndex):(this.NR.AnchorType=3,this.NR.AnchorValue1=Sb.SeriesIndex,this.NR.AnchorValue2=Sb.CategoryIndex)}this.Rra={};this.$.jk(this.lx);this.lx.FirstRow=-1;this.lx.FirstColumn=-1}}Object(fa.a)(xb,"BixSelectionContext",null,[]);var bc=a(787),zb=a(225),Ub=a(64),wc=a(317),mb=a(247),Db=a(706),Ic=a(459),Hc=a(3),Ab=a(516),db=a(55);class Pb extends bb.a{constructor(K,ob){super();this.callout=this.gridView=null;this.qQi=Sb=>{if(Sb.isLoaded){this.state=1;
Sb=this.$;const kc=Ja.h(Sb);this.mUg(kc);Sb.dk(this.Bc);Sb.VA(this.ij);kc.mv(this.ER);Ab.a(Sb).mv(this.PFb);Sb.userOperationManager.xr(this.xJf);wc.a.d$(1529658657,Hc.a.tw,0,1);Sb.Ka.P2(this)}else this.dispose()};this.Eza=(Sb,kc)=>{this.allow&&0===kc.e5&&(Sb=this.gridView.ha.Ne,1===Sb?(this.h3c(),this.mX()):2!==Sb||this.Ty.q_||(this.Ty.reset(),this.qy()))};this.rh=()=>{this.qy()};this.Bc=()=>{this.qy()};this.hd=(Sb,kc)=>{this.callout||this.showCallout(3===Sb.tb,kc)};this.xCd=()=>{this.callout.GAa(this.xCd);
this.callout=null;this.Dh.hide()};this.ij=()=>{this.callout?this.qy():this.R7a()&&this.Dh.hide()};this.PFb=()=>{3===this.state&&(this.state=1)};this.ER=()=>{3===this.state&&this.EPe()};this.xJf=(Sb,kc)=>{(Sb=kc.Qf?kc.Qf.operation:null)&&Sb.flags&4&&(this.allow&&0===kc.Mr?(this.state=3,this.qy()):3===this.state&&1===kc.Mr&&(kc=Sb.od?Sb.od.Errors:null)&&0<kc.length&&this.EPe())};this.EPe=()=>{this.state=1;this.mX()};this.$=K;this.state=2;this.Ty=new xb(K);this.Dh=new pb(K,this.hd,ob);Fa.a(this.$).ai(this);
xa.a.Kdf(K.domElement.ownerDocument,ib.a.current.io(96),this.qQi)}get mc(){return this.callout?this.callout.domElement:null}get Ff(){return!!this.callout}get de(){return mb.a.x_c}get k4e(){ua.ULS.shipAssertTag(537170304,8,!Ja.h(this.$).ib.tj,"GetLaunchMonocleButton is not supported in freeze pane");return Object(sb.a)(Sys.UI.Control,this.Dh.getButton(1))}get H4e(){return this.callout}get allow(){return this.$.he.get(6)&&1===this.state&&this.$.dc.b3(135200)}DDe(){this.showCallout(!1)}dispose(){this.gridView&&
(this.gridView.qb.mKb(this.Eza),this.gridView.Vb&&this.gridView.Vb.Fk(this.rh));if(this.$){const K=this.$;K.userOperationManager.mo(this.xJf);K.Jl(this.Bc);K.bE(this.ij);Ja.h(K).Oy(this.ER);Ab.a(K).Oy(this.PFb)}sa.a.Ia(this.Dh);this.Ty=this.$=this.gridView=this.callout=this.Dh=null;super.dispose()}nc(K,ob){if(1529658657===ob&&(8===K||!this.Ty.Mhf))return!0;1247109494!==ob&&-498523270!==ob||this.qy();return!1}executeCommand(K,ob){this.callout?this.qy():(this.scrollIntoView(),this.showCallout(3===ob.method));
return db.Task.Ta(!0)}wc(K,ob){return 1529658657===ob.command}Jc(){return!1}qy(){this.h3c();this.Dh.hide()}gg(K,ob){this.callout&&!ob&&this.callout.takeFocus();return!ob}lh(K){return rb.DOMElementExtensions.xf(this.mc,K)}sj(){}Wj(){}KOf(K,ob,Sb,kc,yc){this.Ty.reset();if(this.allow&&!Ub.e(this.$.na))if(Sb&&Sb.Attributes&512&&kc&&ob){const bd=this.$.HJ;this.h3c();this.Ty.qxj(ob,Sb,kc);this.R7a()?(ob=Ab.a(this.$).domElement,Sb=rb.DOMElementExtensions.getLocation(ob),kc=Math.abs(ob.scrollLeft),this.$.isChromeRtl&&
(Sys.Browser.agent===Sys.Browser.Safari&&(kc=ob.scrollWidth-ob.offsetWidth-kc),kc*=-1),K=new lb.a(K.x-Sb.x+kc,K.y-Sb.y+ob.scrollTop),bd&&(K.x=ob.offsetWidth-K.x)):(ob=this.gridView.Af(yc).view.ei,K=Db.a.Vs(ob,this.gridView.Af(yc).domElement,new Sys.UI.Point(Math.round(K.x),Math.round(K.y)),bd));this.Dh.fJj(K.x,K.y,bd,yc)}else this.qy()}mUg(K){K&&(this.gridView=K,this.gridView.qb.Cob(this.Eza),this.gridView.Vb.Xk(this.rh))}mX(){this.iGj()?this.Dh.gJj():this.Dh.hide()}iGj(){this.Ty.reset();if(!this.allow||
this.gridView.ha.Ra.$b)return!1;const K=Ic.a(this.$).CLa();if(Object(hb.a)(zb.PivotTableRange,K)&&K.supportsBIExplore){const kc=this.gridView.ha.ra.activeCell,yc=this.gridView.Sb(kc);if(kc&&yc&&this.gridView.ha.ra.U5){var ob=kc.left-K.left,Sb=kc.top-K.top;if(!(K.R6g&1<<ob||K.grj&1<<Sb||K.M6g&1<<ob||K.brj&1<<Sb||yc.hasAutoFilter)&&(ob=kc.Ad(K.AL)||kc.Ad(K.fF),Sb=!1,K.AL&&K.fF?Sb=kc.top<K.AL.top&&kc.left<K.fF.left||kc.top<K.fF.top:K.fF&&(Sb=kc.top<K.fF.top),!ob&&!Sb&&0<yc.text.length||ob&&(0<yc.text.length||
yc.Rxa||yc.a8a)))return this.Ty.qAj(kc,K),!0}}return!1}showCallout(K,ob=1){Ic.a(this.$).Sx(this.Ty.confirmationRequiredForDataOps,Sb=>{Sb&&this.Ty.Mhf&&(this.callout=new fc(this.$,this.Ty,this.Dh.domElement(ob),K),this.callout.initialize(),this.Dh.i3a(ob),this.callout.LP(this.xCd),this.callout.ug());this.Dh.getButton(1).$cb()})}h3c(){this.Dh.getButton(1).$cb();this.callout&&!this.callout.omi&&(this.callout.GAa(this.xCd),this.callout.sv(),this.callout=null)}scrollIntoView(){var K=this.gridView.ha;
if(1===K.Ne){K=K.ra.activeCell;const ob=this.gridView.view.visibleArea,Sb=this.gridView.ag(K);ob&&Sb&&!ob.contains(Sb)&&this.gridView.Ht(K,3,"BIExploreManager.ScrollIntoView")}}R7a(){return this.$.ea.isNamedObjectViewMode&&Ub.f(this.$.na)}static ka(K,ob){bc.a(K)||K.da.Ga(2,new Pb(K,ob))}}Object(fa.a)(Pb,"BIExploreManager",bb.a,[165,670,39,2,671]);var td=a(9),Vb=a(692),Ac=a(101),Kc=a(470),dd=a(142),Vd=a(28),Jd=a(183);class oe{constructor(K,ob,Sb){ob||ua.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");
this.$=K;this.fieldManagerPane=ob;this.wHg=Sb}nc(K,ob){return(2140436015===ob||-1006032470===ob)&&!(new dd.a(this.wHg)).Td(8192)}executeCommand(K,ob,Sb,kc){K=ob.command;kc=kc.N4();switch(K){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.Xzc(!Ac.f(this.$.hg),ob,!1),ua.ULS.sendTraceTag(537162717,0,50,`${2140436015===K?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.N8b(!0,!1,kc);case 1176256599:return this.N8b(!1,!1,kc);case -1751201991:return this.N8b(!0,
!0,kc);case -232434744:return this.N8b(!1,!0,kc);default:return Jd.a(K)}return db.Task.Ta(!0)}wc(K,ob){K=!1;switch(ob.command){case 2140436015:case -1006032470:K=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:K=!0}return K}Jc(){return!1}N8b(K,ob,Sb){const kc=Vd.a.Qa.zb,yc=Ja.h(this.$).ha.ra.activeCell;return ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,12,477,Sb),()=>{Ic.a(this.$).Sx(!1,bd=>{if(bd){Ja.h(this.$).Uo(!0);const Fd=Ea.o(yc,this.$);
this.$.Kc(-867563466,(Nd,Rd,je)=>za.J(this.$.pa.ya,Fd,0,!1,!1,!1,K,ob,Nd,Rd,je,null,null),kc,0,6,161,()=>new Kc.a(Fd,ob))}})},this.$.la,3)}static V1a(K,ob,Sb){const kc={};K.jk(kc);kc.FirstRow=ob;kc.FirstColumn=Sb;return kc}}Object(fa.a)(oe,"FieldListCommandHandler",null,[165]);class De extends Vb.a{constructor(K){super(K)}nd(){ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,16,74,this.Ya),K=>{this.Yc([new oe(this.$,K.result,this.$.xa)])},this.la,3)}static ka(K){Vb.a.Nd(75,new De(K))}}Object(fa.a)(De,
"FieldListCommandHandlerFactory",Vb.a,[]);var Ke=a(222);class rd{constructor(K,ob){this.zla=this.dsd=this.yla=this.qjc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.Pie=-1;this.kke=1;this.oEa=this.q$d=this.p$d=-1;this.Rra=null;if(K&&(this.gA=ob,this.yla=this.qjc=!1,K.na)){var Sb=Ja.h(K),kc=ob=null;if(Ub.f(K.na)){var yc=Ab.a(K);yc.Vc&&yc.Vc.Attributes&4&&(this.chartId=yc.chartId,ob=yc.Vc)}else Ub.i(K.na)&&((yc=Sb.ha.Ra.$b)?(Sb=yc.floatingObject)&&
0===Sb.type&&Sb.Vc&&Sb.Vc.Attributes&4&&(this.chartId=yc.floatingObject.id,ob=Sb.Vc):Sb.ha.ra.activeCell&&(yc=Ic.a(K).CLa(),Object(hb.a)(zb.PivotTableRange,yc)&&(kc=yc)));ob?(this.yla=!0,this.dsd=!!(ob.Attributes&256),this.anchorType=7,this.zla=!!(ob.Attributes&128),this.confirmationRequiredForDataOps=!!(ob.Attributes&64),this.oEa=ob.ExternalSourceIndex,this.FH=ob.FieldListVersion,this.cN=ob.FieldWellVersion,ob=this.Rra={},K.jk(ob),ob.FirstColumn=ob.FirstRow=-1):kc&&(this.qjc=!0,this.dsd=kc.isActionable,
this.anchorType=0,this.zla=kc.isOlap,this.confirmationRequiredForDataOps=kc.confirmationRequiredForDataOps,this.oEa=kc.externalSourceIndex,this.FH=kc.lGh,this.cN=kc.qGh,this.pivotTableName=kc.pivotTableName,this.Rra=Ea.o(kc,K))}}get yJb(){return this.Pie}set yJb(K){this.Pie=K}get gA(){return this.kke}set gA(K){this.kke=K}get FH(){return this.p$d}set FH(K){this.p$d=K}get cN(){return this.q$d}set cN(K){this.q$d=K}get HNa(){return this.yla||this.qjc}get qsi(){return this.HNa&&!this.dsd}get externalSourceIndex(){return this.oEa}get lx(){return this.Rra}get sheetName(){return this.lx?
this.lx.SheetName:null}get ptb(){return this.chartId+"_"+this.pivotTableName+"_"+this.FH+"_"+this.cN}ffh(){const K={};K.AnchorType=this.anchorType;7===this.anchorType&&(K.ChartId=this.chartId);K.AnchorValue1=K.AnchorValue2=-1;return K}static i6b(){return new rd(null,-1)}static create(K,ob){return new rd(K,ob)}static Gmf(K,ob){return K.HNa!==ob.HNa||K.anchorType!==ob.anchorType||K.chartId!==ob.chartId||K.pivotTableName!==ob.pivotTableName||!!K.lx&&!!ob.lx&&K.lx.SheetName!==ob.lx.SheetName}static Zvi(K,
ob){return rd.Gmf(K,ob)||K.yJb!==ob.yJb||K.gA!==ob.gA}}Object(fa.a)(rd,"FieldListRequestState",null,[743]);class bf extends Ke.a{constructor(K){super();this.$=K;this.Fb()}create(){const K=rd.create(this.$,-1);this.ob(K)}dispose(){this.$=null;super.dispose()}static ka(K){K.da.Ga(110,new bf(K))}}Object(fa.a)(bf,"FieldListRequestStateFactory",Ke.a,[]);var cc=a(417),Wc=a(33),id=a(788),Tc=a(107),Gd=a(4),Wd=a(85);class Dd{constructor(){this.uE=0;this.request=null;this.ql=!0}get correlationId(){return this.uE}Wwf(){return this.uE=
this.correlationId+1}}Object(fa.a)(Dd,"DataRequestInfo",null,[]);class Kd{}Kd.exh="ewa-flp-react-pane";Kd.dxh="ewa-flp-react-header";Kd.fxh="ewa-flp-react-title";Kd.bxh="ewa-flp-react-body";Kd.cxh="ewa-flp-react-close-button";Object(fa.a)(Kd,"CssClassNames",null,[]);var we=a(24),We=a(582),Od=a(188),le=a(283),de=a(116),Re=a(555),Ee=a(22);const Te=(K,ob,Sb)=>{if(K)for(let kc=0,yc=K.length;kc<yc;kc++){const bd=K[kc];bd.ClientId=Sb++;bd.ClientParentId=ob;Sb=Te(bd.Children,bd.ClientId,Sb)}return Sb},Ae=
(K,ob,Sb,kc)=>{for(const yc of K){if(yc.PivotCacheIndex===ob&&(yc.TypeTag===Sb||0===Sb))return yc;if(kc&&(K=Ae(yc.Children,ob,Sb,kc)))return K}return null},kf=(K,ob,Sb)=>{if(K)for(let yc=0,bd=K.length;yc<bd;yc++){var kc=K[yc];if(kc.ClientId===ob||Sb&&(kc=kf(kc.Children,ob,Sb)))return kc}return null};var Oe=a(7),$a=a(172),Zb=a(1320),Da=a(739);class Pa{constructor(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=
this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}}Object(fa.a)(Pa,"FieldListTaskPaneProps",null,[]);class tb{constructor(K,
ob){this.$=K;this.fieldManagerPane=ob}iE(K){$a.UISurfaces.ej().then(ob=>{ob.showTaskPane("FieldListTaskPane",this.tu(K,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}Vu(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd,je,$e){$a.UISurfaces.ej().then(Xe=>{Xe.updateTaskPane("FieldListTaskPane",this.tu(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd,je,$e));return null})}N7(){$a.UISurfaces.ej().then(K=>{K.setSelectedTaskPane("FieldListTaskPane");return null})}GF(){$a.UISurfaces.ej().then(K=>{K.hideTaskPane("FieldListTaskPane",2);return null})}tu(K,
ob,Sb,kc,yc,bd,Fd,Nd,Rd,je,$e){ob=Object(Oe.a)(new Pa,{type:"FieldListTaskPaneProps",fieldListItems:Sb,fieldWellsItems:kc,dataUpdateType:ob,isDataModel:yc,selectedTab:bd,isSortAscending:Fd,focusResetType:Nd,focusResetId:Rd,isRichPivotFieldList:je,fieldListSearchInfo:$e,isOlap:this.fieldManagerPane.zla,isPivotChart:this.fieldManagerPane.yla,fieldListSizePercentage:this.fieldManagerPane.qcj,onFieldExpandCollapse:this.fieldManagerPane.mcj,onExpandCollapseAll:this.fieldManagerPane.lcj,onFieldCheckedChanged:this.fieldManagerPane.vcj,
onFieldListItemMenuClickV2:this.fieldManagerPane.ocj,onSortOrderChanged:this.fieldManagerPane.gcj,onSaveFieldListSizePercentage:this.fieldManagerPane.Ocj,onSearchInputChanged:this.fieldManagerPane.pcj,onSelectedTabChanged:Xe=>{this.fieldManagerPane.hcj(Xe)},onFieldMove:(Xe,ig,Zg,Uf)=>{this.fieldManagerPane.ycj(Xe,ig,Zg,Uf)},onFieldWellItemMenuClickV2:(Xe,ig,Zg,Uf)=>{this.fieldManagerPane.rcj(Xe,ig,Zg,Uf)}});if(Wc.a.gd(this.$))return Object(Oe.a)(new Zb.a,{contentProps:ob,onOpen:()=>{this.fieldManagerPane.rGf()},
onClose:()=>{this.fieldManagerPane.dYi()},onManualClose:()=>{this.fieldManagerPane.eYi()},title:this.fieldManagerPane.yla?Ma.a.instance.ga(1177):Ma.a.instance.ga(1176),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});K=Object(Oe.a)(new Da.a,{type:"ExcelLegacyTaskPaneProps",container:K,paneProps:ob});return Object(Oe.a)(new Zb.a,{contentProps:K,onOpen:()=>{this.fieldManagerPane.rGf()}})}}Object(fa.a)(tb,"FieldListReactTaskPane",null,[733]);class Ib{constructor(K,ob,Sb){this.cachedItemIndex=
this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=K;this.cachedItemIndex=ob;this.cachedItemName=Sb}}Object(fa.a)(Ib,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class Yb{constructor(K,ob,Sb,kc){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=K;this.pivotData=ob;this.additionalInformation=Sb;this.activeCell=kc}getActiveCell(){return this.activeCell}}Object(fa.a)(Yb,"MacroRecorderPivotTablePivotedPayload",null,[125]);
var vc=a(153),Zc=a(91),nd=a(29),hd=a(1),Ud=a(103),ee=a(69),ec=a(701);class Vc{constructor(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}}Object(fa.a)(Vc,"FieldListItem",null,[]);class ud{constructor(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}}Object(fa.a)(ud,"FieldListSearchInfo",
null,[]);class ke{constructor(){this.id=0;this.name=null}}Object(fa.a)(ke,"FieldWellItem",null,[]);class te{constructor(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}}Object(fa.a)(te,"FieldWellsItems",null,[]);class pe extends fb.a{constructor(K,ob,Sb){var kc;super(K);this.tcd=300;this.HQ=new Dd;this.IQ=new Dd;this.E8c={};this.rva=this.hk=this.gk=null;this.xqb=this.R2b=this.dbc=!1;this.currentState=rd.i6b();this.DHa=this.mHa=null;this.lca=0;this.SRd=this.prd=
!1;this.qva=null;this.V7a=this.Hf=!1;this.aEe=this.SIb=this.sAa=null;this.UIb=-1;this.EW=[];this.RIb=!1;this.SQa=null;this.QIb=this.bRf=this.OJd=!1;this.PIb="";this.RQa=null;this.t7=0;this.s7="";this.MJd=!1;this.$Qf=null;this.pj=!1;this.wq=0;this.vcj=(yc,bd)=>{this.hk&&this.Bla&&(yc=kf(this.hk.FieldListItems,yc,!0))&&(ua.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.Wwi(yc,bd))};this.mcj=yc=>{this.hk&&(yc=kf(this.hk.FieldListItems,yc,!0))&&yc.IsCollapsible&&(5===
yc.TypeTag&&yc.IsCollapsed&&!yc.Children.length?(this.EW.length=0,this.EW.push(yc),this.Mbd()):(yc.IsCollapsed=!yc.IsCollapsed,this.Hf&&this.ybc(0,-1,!1,!1,!1,!1)))};this.lcj=yc=>{this.hk&&(ua.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.EW.length&&(this.EW.length=0),this.YQf(this.hk.FieldListItems,yc)?this.Mbd():this.Hf&&this.ybc(0,-1,!1,!1,!1,!1))};this.ocj=(yc,bd,Fd)=>{if(this.hk){var Nd=document.getElementById(bd);if(Nd){var Rd=kf(this.hk.FieldListItems,
yc,!0);if(Rd){yc={};yc.domElement=Nd;yc.fieldItem=Rd;yc.versionkey=this.ptb;yc.isChart=!!this.chartId;yc.isPpm=this.hk.IsPpm;yc.isOlap=this.currentState.zla;yc.supportsImplicitMeasures=this.hk.SupportsImplicitMeasures;yc.isKeyboardInput=Fd;this.SQa=bd;bd=new Zc.a(330754562,0,this.$.Hc,30,null);var je;this.RIb=!vc.a(je=this.$.Ka.Lb(bd,yc))&&(6!==je.status||je.result)}}}};this.gcj=yc=>{ua.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const bd=pe.Lsb(this.currentState);
this.$.userOperationManager.Kc(new Od.a(251,0,(Fd,Nd,Rd)=>{var je=this.$.pa.ya;const $e=za.L(je,this.currentState.lx,this.currentState.externalSourceIndex,bd);$e.isAscending=yc;return za.g(je,"ChangePivotFieldListSortOrder",$e,Fd,Nd,Rd,null,0)}),null)};this.Ocj=yc=>{this.Cie=yc};this.pcj=yc=>{yc!==this.s7&&(ua.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.s7=yc,this.ybc(0,-1,!1,!0,!1,!1))};this.qGf=()=>{if(this.RIb&&this.SQa){const yc=document.getElementById(this.SQa);
yc&&yc.classList.add("fieldItemMenuOpen")}};this.pGf=()=>{if(this.RIb&&this.SQa){const yc=document.getElementById(this.SQa);yc&&(yc.classList.remove("fieldItemMenuOpen"),yc.classList.contains("fieldItemOnHover")||yc.classList.contains("fieldItemOnFocus")||(yc.style.visibility="hidden"))}this.RIb=!1;this.SQa=null};this.mk=()=>{this.ORd(!0,null);this.hideTaskPane();return!0};this.Hha=()=>{if(this.$)if(ee.a(this.$).eNa&&this.isVisible&&this.currentState.HNa&&this.$.ea.Zb){if(this.HQ.ql&&!this.HQ.request){var yc=
this.HQ;var bd=this.$.pa.ya;var Fd=this.currentState.FH,Nd=this.currentState.yJb,Rd=this.currentState.gA,je=this.bTi,$e=this.cTi,Xe=this.HQ.Wwf();const ig=za.L(bd,this.currentState.lx,this.currentState.externalSourceIndex,pe.Lsb(this.currentState));ig.type=1;ig.version=Fd;ig.relatedGroup=Nd;ig.selectedTab=Rd;bd=za.g(bd,"GetPivotFieldListData",ig,je,$e,null,Xe,4);yc.request=bd}this.IQ.ql&&!this.IQ.request&&(yc=this.IQ,bd=this.$.pa.ya,Fd=this.currentState.cN,Nd=this.eTi,Rd=this.fTi,je=this.IQ.Wwf(),
$e=za.L(bd,this.currentState.lx,this.currentState.externalSourceIndex,pe.Lsb(this.currentState)),$e.type=1,$e.version=Fd,bd=za.g(bd,"GetPivotFieldManagerData",$e,Nd,Rd,null,je,4),yc.request=bd)}else pe.VY(this.HQ),pe.VY(this.IQ)};this.bTi=(yc,bd)=>{this.ENf(yc,bd,this.HQ)&&(yc=yc.Result)&&(this.currentState.FH=yc.FieldListVersion,this.HQ.ql=!1,this.rig(yc));Ic.a(this.$).vQb();this.refresh()};this.cTi=yc=>{this.nBf(yc,this.HQ)};this.eTi=(yc,bd)=>{this.ENf(yc,bd,this.IQ)&&(yc=yc.Result)&&(this.currentState.cN=
yc.FieldWellVersion,this.IQ.ql=!1,this.iig(yc));this.refresh()};this.fTi=yc=>{this.nBf(yc,this.IQ)};this.PNi=yc=>{if(nd.a.Zf(yc.Errors)){this.xqb=!1;this.mHa=null;for(let Fd=0,Nd=yc.Errors.length;Fd<Nd;++Fd)if(1244452614===yc.Errors[Fd].MessageId){if(hd.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){yc=Ja.h(this.$);var bd=yc.Bb.zp(yc.ha.ra.activeCell);bd&&(bd=we.Range.Qc(bd.WZf+1,bd.left),bd=Ea.v(bd,this.$),yc.pg(bd,null,null,null,3,"FieldManagerPane.OnApplyPivotSuccess"))}this.currentState.FH=
-1;this.currentState.cN=-1;this.refresh();break}}this.dbc=!0};this.ERi=yc=>{this.R2b=!1;if(!nd.a.Zf(yc.Errors)){if(0<this.EW.length)for(yc=0;yc<this.EW.length;++yc)this.EW[yc].IsCollapsed=!1;this.currentState.FH=-1;this.refresh()}};this.Ama=()=>{const yc=Ja.h(this.$).ha;yc.Ra.Hrd&&yc.Ne&470||Ja.h(this.$).inRangePicker||Ja.h(this.$).ri||this.hJb(!0,!0)};this.yf=()=>{this.refresh();this.$.ea.Ho.FieldListForceOnTop&&this.Xzc(!1,null,!0)};this.spc=()=>{this.hJb(!0,!0)};this.ed=()=>{this.hJb(!0,!1)};this.Eh=
(yc,bd)=>{yc=Ub.e(bd.WD)||Ub.e(bd.na);this.hJb(!0,yc)};this.dr=(yc,bd)=>{for(let Fd of bd.N1j)this.sig(Fd);this.prd&&(this.prd=!1,this.Gla||this.taskPaneManager.nh&&1===this.taskPaneManager.nh.taskPane.ih||this.taskPaneManager.qG(this,!0));this.hJb(!1,!0)};this.mDf=(yc,bd)=>{Ja.h(this.$).Ur||this.sig(bd.jd.hash)};this.OFb=()=>{this.refresh()};this.Tc=()=>{this.wL()};this.Oo=()=>{this.wL()};this.RIf=()=>{this.refresh()};this.QJf=()=>{this.Hha()};this.$=ob;this.hg=ob.hg;this.taskPaneManager=Sb;this.taskPaneManager.RE(this.RIf);
this.Dti=hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);this.Gla=Wc.a.gd(this.$);this.Cie=.5;this.qva=new tb(this.$,this);this.$.Ka.Qre(this.qGf);this.$.Ka.OZa(this.pGf);this.tcd=400;this.Gla||(K.style.width=Sa.HelperMethods.uc(this.tcd));Ee.a.equals("rtl",K.dir,!0)&&(this.pj=!0);this.pGh=[4,2,1,8];this.$.nl(this.ed);K=Ja.h(this.$);K.Ea.mt(this.mDf);K.PT(this.dr);Ab.a(this.$).Ea.mt(this.OFb);
K.ha.iH(this.Ama);K.IC(this.Ama);K.ha.Ra.LMg(this.spc);null===(kc=Ud.a(this.$))||void 0===kc?void 0:kc.y0b(this.spc);this.$.xa.Uf(this.Eh);this.$.ea.mu(this.yf);this.$.ea.Tj(this.Tc);this.$.ea.zM(this.Oo);ee.a(this.$).oXc(this.QJf);Fa.a(this.$).ai(this);this.refresh()}MP(K){this.get_events().addHandler(pe.eXe,K)}$R(K){this.get_events().removeHandler(pe.eXe,K)}RE(K){this.addHandler(pe.jvb,K)}nG(K){this.removeHandler(pe.jvb,K)}ure(K){this.addHandler(pe.cXe,K)}xVf(K){this.removeHandler(pe.cXe,K)}tre(K){this.addHandler(pe.bXe,
K)}wVf(K){this.removeHandler(pe.bXe,K)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get lx(){return this.currentState.lx}get zla(){return this.currentState.zla}get yla(){return this.currentState.yla}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get FH(){return this.currentState.FH}get cN(){return this.currentState.cN}get ptb(){return this.currentState.ptb}get isRtl(){return this.pj}get gUd(){return this.l_a}get Bla(){return!(!this.isVisible||
this.HQ.ql||this.IQ.ql||this.R2b||this.xqb)}get parentElement(){return this.$.domElement}get mc(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(K){K=this.m_a&&K;!K||this.DHa||this.V7a||this.Xgi();K!==super.isVisible&&(super.isVisible=K,this.raiseEvent(pe.jvb));this.RSf(null,K)}get Ff(){return this.isVisible}get de(){return mb.a.nGh}get ih(){return 1}get dl(){return Jb.a.zBh}get vN(){return Ma.a.instance.ga(1063)}get Lp(){return this.tcd}get isResizable(){return!0}get titleText(){return Ma.a.instance.ga(1176)}get qcj(){return this.Cie}get eC(){return this.taskPaneManager.Kva(this.mc,
this.titleText,this.Lp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Lp)}get l_a(){return this.$.dc.b3(36896)&&this.m_a}get m_a(){const K=new dd.a(this.$.xa);return this.$.isEditMode&&K.Td(8192)||!K.ki}get cjh(){return(this.pivotName||"")+(this.chartId||"")}vg(){}nq(){return this.l_a&&!Ac.f(this.hg)}Es(){const K=rd.create(this.$,this.UIb);return K.HNa&&!K.qsi&&!Ac.f(this.hg)}JR(){}Gqe(K,ob){(K=Ae(this.hk.FieldListItems,K,this.currentState.zla?
5:17,!0))&&K.CanDrag&&this.hK(K,ob,0,null,null)}hK(K,ob,Sb,kc,yc){let bd,Fd,Nd;if(kc&&!Ee.a.equals(kc,this.ptb,!1))alert(Ma.a.instance.Ua(18));else{({axis:kc,pos:Fd,mMf:Nd}=this.t0e(K.PivotCacheIndex,K.PivotTableIndex));-1!==K.PivotTableIndex?bd=kc:(Fd=bd=0,Nd=K.PivotCacheIndex);if(0===bd){if(7===K.TypeTag&&(K=0<=K.ClientParentId?kf(this.hk.FieldListItems,K.ClientParentId,!0):null,!K))return;Fd=0;Nd=K.PivotCacheIndex}if(bd!==ob||0===ob||Fd!==Sb&&Fd!==Sb-1){var Rd=new Ib(kc,K.PivotCacheIndex,K.Name);
Ic.a(this.$).Sx(this.currentState.confirmationRequiredForDataOps,je=>{je&&this.applyPivot(this.currentState,bd,Fd,K.TypeTag,Nd,ob,Sb,yc,Ja.h(this.$),Rd,K)})}}}ycj(K,ob,Sb,kc){if(this.hk&&this.gk){var yc=null;switch(ob){case 0:yc=kf(this.hk.FieldListItems,K,!0);break;case 1:yc=kf(this.gk.RowAxis,K,!1);break;case 2:yc=kf(this.gk.ColumnAxis,K,!1);break;case 4:yc=kf(this.gk.FilterAxis,K,!1);break;case 8:yc=kf(this.gk.DataAxis,K,!1)}yc&&(ua.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),
this.hK(yc,Sb,kc,null,null))}}YQf(K,ob){let Sb;Sb=!1;for(let kc=0;kc<K.length;kc++){const yc=K[kc];ob&&yc.IsCollapsible&&5===yc.TypeTag&&yc.IsCollapsed&&!yc.Children.length?(this.EW.push(yc),Sb=!0):ob&&yc.IsCollapsible&&yc.IsCollapsed?yc.IsCollapsed=!1:ob||!yc.IsCollapsible||yc.IsCollapsed||(yc.IsCollapsed=!0);yc.IsCollapsible&&yc.Children&&0<yc.Children.length&&this.YQf(yc.Children,ob)&&(Sb=!0)}return Sb}ybc(K,ob,Sb,kc,yc,bd){if(this.hk){var Fd=!1,Nd=!1,Rd=!1,je=null;Rd=null;var $e=K;kc&&0<this.EW.length&&
(this.EW.length=0);({wyb:Nd,pua:Rd,isRichPivotFieldList:Fd,returnValue:je}=this.Ied(this.hk.FieldListItems,kc,!1));Rd?this.R2b||this.Mbd():(Rd=new ud,Rd.needSearchReset=bd,Rd.needSearchRestore=!bd&&yc,Rd.searchRestoreValue=Rd.needSearchRestore?this.s7:"",Rd.searchWithNoMatch=""!==this.s7&&!Nd,Rd.searchWithNoMatch&&kc&&ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,211,212,0),Xe=>{Xe.result.readText(Ma.a.instance.ga(778))},this.$.la,3),""!==this.s7&&2===K&&(Rd.searchWithNoMatch?$e=1:Sb&&
je&&0<je.length&&(ob=je[0].id)),this.qva.Vu(this.DHa,0,je,null,this.hk.IsPpm,this.hk.SelectedTab,this.hk.IsSortAscending,$e,ob,Fd,Rd))}}hcj(K){ua.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.UIb=K;this.UPj()}rcj(K,ob,Sb,kc){if(this.gk){var yc=document.getElementById(Sb);if(yc){var bd=null,Fd=-1;switch(ob){case 4:bd=kf(this.gk.FilterAxis,K,!1);Fd=this.gk.FilterAxis.length;break;case 2:bd=kf(this.gk.ColumnAxis,K,!1);Fd=this.gk.ColumnAxis.length;break;case 1:bd=kf(this.gk.RowAxis,
K,!1);Fd=this.gk.RowAxis.length;break;case 8:bd=kf(this.gk.DataAxis,K,!1),Fd=this.gk.DataAxis.length}if(bd){var Nd={};this.currentState.yla?(Nd.AnchorType=8,Nd.ChartId=this.currentState.chartId):Nd.AnchorType=9;Nd.AnchorValue1=bd.PivotTableIndex;Nd.AnchorValue2=bd.PivotCacheIndex;var Rd,je;({axis:Rd,pos:je}=this.t0e(bd.PivotCacheIndex,bd.PivotTableIndex));K=new Zc.a(-1453503574,0,this.$.Hc,30,null);ob={};ob.domElement=yc;ob.fieldItem=bd;ob.zoneCount=Fd;ob.sourceAxis=Rd;ob.sourceAxisPos=je;ob.optionalPivotMenuAnchorParameter=
Nd;ob.isOlap=this.currentState.zla;ob.isPpm=this.hk.IsPpm;ob.versionkey=this.ptb;ob.isKeyboardInput=kc;ob.cell=this.currentState.lx;ob.externalSourceIndex=this.externalSourceIndex;kc=!1;hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.zla&&!this.hk.IsPpm&&this.hk.SupportsImplicitMeasures&&(bd=Ae(this.hk.FieldListItems,bd.PivotCacheIndex,5,!0),kc=!!bd&&!bd.IsCollapsible);ob.fieldItemsupportsImplicitMeasures=kc;this.SQa=Sb;var $e;this.RIb=!vc.a($e=
this.$.Ka.Lb(K,ob))&&(6!==$e.status||$e.result)}}}}ncj(K){K&&ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,103,104,0),ob=>{var Sb=ob.result;const kc=Ja.h(this.$),yc=Ea.v(we.Range.Qc(1,1),this.$).SheetName;ob=Sb.bhb(kc);let bd,Fd,Nd,Rd;ob?(Sb=ob.ve,bd=Sb.pf.top,Fd=Sb.pf.left,Nd=ob.lJ.x,Rd=ob.lJ.y):(bd=Fd=1,ob=Sb.NLa(kc),Nd=ob.x,Rd=ob.y);this.$.userOperationManager.Kc(new Od.a(203,0,(je,$e,Xe)=>le.t(this.$.pa.ya,yc,this.pivotName,K.PivotCacheIndex,0,bd,Fd,Nd,Rd,je,$e,Xe,null),void 0,()=>
new We.a(yc,this.pivotName,K.PivotCacheIndex,0)),null)},this.$.la,8)}dispose(){var K;if(this.$){this.$.Kl(this.ed);this.$.Ka.PVf(this.qGf);this.$.Ka.fKb(this.pGf);this.EW.length=0;const ob=Ja.h(this.$);ob&&(ob.vO(this.dr),ob.cE(this.Ama),ob.ha&&(ob.ha.rL(this.Ama),ob.ha.Ra.Djj(this.spc)),ob.Ea&&ob.Ea.gr(this.mDf));null===(K=Ud.a(this.$))||void 0===K?void 0:K.ivc(this.spc);K=Ab.a(this.$);(null===K||void 0===K?0:K.Ea)&&K.Ea.gr(this.OFb);this.$.xa&&this.$.xa.Bg(this.Eh);if(K=this.$.ea)K.Ov(this.yf),
K.qk(this.Tc),K.ZR(this.Oo);ee.a(this.$)&&ee.a(this.$).Ouc(this.QJf)}this.taskPaneManager&&this.taskPaneManager.nG(this.RIf);this.sAa&&(La.a.instance.Ba(Mb.a.click,this.sAa,this.mk),Tc.KeyInputManager.instance.Vv(this.sAa,this.aEe));this.hideTaskPane();this.taskPaneManager=this.$=this.qva=null;super.dispose()}gg(K,ob){if(!ob){K=rb.DOMElementExtensions.wm(this.domElement.querySelectorAll(rb.DOMElementExtensions.Ir));if(!K)return!1;rb.DOMElementExtensions.setFocus(K)}return!ob}lh(K){return rb.DOMElementExtensions.xf(this.mc,
K)}sj(){}Wj(){}UPj(){this.refresh()}Wwi(K,ob){K&&K.CanDrag&&this.hK(K,ob?-1:0,-1,null,null)}T6(){this.Gla&&this.nq()&&this.Es()&&(this.isVisible=!0)}rGf(){this.OJd=!0;this.refresh()}dYi(){this.hideTaskPane()}eYi(){this.ORd(!0,null);this.hideTaskPane()}Xgi(){this.V7a=this.Hf=!0;this.Gla||this.rii();this.qva.iE(this.DHa)}showTaskPane(){this.isVisible=!0;""!==this.s7&&(this.MJd=!0);this.Hf?this.Gla?this.qva.N7():this.taskPaneManager.qG(this,!0):(this.Hf=!0,this.qva.iE(this.DHa),this.Gla||this.taskPaneManager.qG(this,
!0))}hideTaskPane(){this.isVisible=this.OJd=this.Hf=!1;this.qva.GF()}Xzc(K,ob,Sb){this.ORd(K,ob);this.prd=Sb;this.SRd=!K&&!!ob||Sb;K?this.hideTaskPane():this.showTaskPane()}Mbd(){Ic.a(this.$).Sx(this.currentState.confirmationRequiredForDataOps,K=>{K&&this.expandPivotFieldListLevels(this.currentState)})}WQ(){return!1}fSg(){const K=document.getElementsByTagName("head")[0];if(K){const ob=document.createElement("link");ob.setAttribute("rel","stylesheet");ob.setAttribute("type","text/css");ob.setAttribute("href",
rb.DOMElementExtensions.OZ(this.domElement,"data-cssfile",null));K.appendChild(ob)}}rii(){const K=document.getElementById(this.$.Eb+eb.a.dXe);if(K){this.fSg();K.classList.add(pe.Fcj);var ob=this.hgh();K.appendChild(ob);ob=ec.b("div",pe.Ccj,pe.Bcj);K.appendChild(ob);this.DHa=ob}}hgh(){const K=ec.b("div",pe.Hcj,pe.Gcj);this.SIb=ec.b("span",pe.Jcj,pe.Icj);this.SIb.innerText=this.titleText;this.sAa=id.a.pb(pe.Dcj,pe.Ecj,Ma.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.sAa.classList.add(Gd.AFrameworkApplication.isRtl?
eb.a.Waa:eb.a.Xaa);La.a.instance.ta(Mb.a.click,this.sAa,this.mk);this.aEe=Tc.KeyInputManager.instance.Ms(this.sAa,this.mk,Wd.a.Sh);K.appendChild(this.SIb);K.appendChild(this.sAa);return K}rig(K){if(this.hk=K)this.currentState.FH=this.hk.FieldListVersion,this.lca=Te(this.hk.FieldListItems,-1,this.lca);if(this.hk)if(this.Hf){this.UIb=this.currentState.gA=this.hk.SelectedTab;this.MAi();K=-1;var ob=0,Sb=!1;this.SRd?(this.hk.FieldListItems&&0<this.hk.FieldListItems.length&&(K=this.hk.FieldListItems[0].ClientId,
ob=2,Sb=!0),this.SRd=!1):this.dbc&&0===this.t7&&(this.RQa||this.QIb?this.hk.FieldListItems&&0<this.hk.FieldListItems.length&&(K=this.QIb?this.hk.FieldListItems[0].ClientId:this.RQa.ClientId,ob=2,Sb=this.QIb):this.bRf&&(K=this.hk.FieldListItems[0].ClientId,ob=1),this.m4b());var kc=!1;this.$Qf!==this.hk.PivotXluid&&(this.$Qf=this.hk.PivotXluid,kc=!0,this.s7="");this.ybc(ob,K,Sb,!1,!kc&&this.MJd&&""!==this.s7,kc);this.MJd=!1}else this.m4b()}m4b(){this.t7=0;this.RQa=null;this.PIb="";this.dbc=this.QIb=
this.bRf=!1}wGj(K){return 7===K.TypeTag?!1:K.ShowFilterArrow||K.ShowCheckBox}Ywi(K){return K.IsCollapsible&&(!K.IsCollapsed||2===K.Image)&&!!K.Children&&0<K.Children.length}wyb(K,ob){const Sb=ob.length;return 2<Sb&&'"'===ob.charAt(0)&&'"'===ob.charAt(Sb-1)?Ee.a.contains(K,ob.substring(1,Sb-1),!0):Ee.a.F1a(ob,"*")||Ee.a.F1a(ob,"?")?(ob=ob.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),ob="^"+Ee.a.CRa(Ee.a.CRa(ob,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=K.search(new RegExp(ob,"i"))):Ee.a.contains(K,
ob,!0)}Ied(K,ob,Sb){let kc,yc,bd,Fd;kc=Fd=bd=yc=!1;const Nd=[];for(let $e=0;$e<K.length;$e++){const Xe=K[$e];var Rd=!1;let ig=!1,Zg=!1,Uf,uh=[];if(""===this.s7){if(this.Ywi(Xe)){var je=void 0;({wyb:ig,pua:Uf,ebf:je,isRichPivotFieldList:Rd,returnValue:uh}=this.Ied(Xe.Children,ob,!1));Xe.ShowCheckBox||(Xe.IsChecked=je)}}else 2!==Xe.Image&&this.wyb(Xe.Name,this.s7)&&(kc=Zg=!0,ob&&Xe.IsCollapsible&&Xe.IsCollapsed&&(5!==Xe.TypeTag||Xe.Children.length?Xe.IsCollapsed=!1:(this.EW.push(Xe),yc=!0))),ob&&Sb&&
Xe.IsCollapsible&&Xe.IsCollapsed&&(5!==Xe.TypeTag||Xe.Children.length?Xe.IsCollapsed=!1:(this.EW.push(Xe),yc=!0)),Xe.IsCollapsible&&Xe.Children&&0<Xe.Children.length&&({wyb:ig,pua:Uf,ebf:je,isRichPivotFieldList:Rd,returnValue:uh}=this.Ied(Xe.Children,ob,Zg||Sb),Xe.ShowCheckBox||(Xe.IsChecked=je),ig&&(kc=!0,ob&&(Xe.IsCollapsed=!1)),Uf&&(yc=!0));this.Dti&&(Rd||66===Xe.TypeTag)&&(Fd=!0);Xe.IsChecked&&(bd=!0);if(""===this.s7||Zg||ig||Sb)Rd=new Vc,Rd.id=Xe.ClientId,Rd.name=Xe.Name,Rd.type=Xe.TypeTag,Rd.isCollapsible=
Xe.IsCollapsible,Rd.showCheckBox=Xe.ShowCheckBox,Rd.isMoreFields=2===Xe.Image,Rd.canDrag=Xe.CanDrag&&7!==Xe.TypeTag,Rd.showSeparator=Xe.ShowSeparator,Rd.showMenu=this.wGj(Xe),Rd.isCollapsed=Xe.IsCollapsed,Rd.isChecked=Xe.IsChecked,Rd.isBolded=Xe.IsBolded,Rd.children=uh,Nd.push(Rd)}return{returnValue:Nd,wyb:kc,pua:yc,ebf:bd,isRichPivotFieldList:Fd}}Ebc(K){const ob=Array(K.length);for(let Sb=0;Sb<K.length;Sb++){const kc=K[Sb],yc=new ke;yc.id=kc.ClientId;yc.name=kc.Name;ob[Sb]=yc}return ob}isj(){this.$_f(this.hk.FieldListItems,
"")}MAi(){this.tqf(this.hk.FieldListItems,"")}lac(K,ob){return K.Name+"_"+K.UniqueName+"_"+K.TypeTag+"_"+(ob||this.cjh)}$_f(K,ob){if(K)for(let Sb=0,kc=K.length;Sb<kc;Sb++){const yc=K[Sb];let bd="";if(yc.IsCollapsible||yc.Children)bd=this.lac(yc,ob),yc.IsCollapsible&&(this.E8c[bd]=!!yc.IsCollapsed),yc.Children&&this.$_f(yc.Children,bd);this.RQa&&yc.ClientId===this.RQa.ClientId&&(this.PIb=bd||this.lac(yc,ob))}}tqf(K,ob){if(K)for(let Sb=0,kc=K.length;Sb<kc;Sb++){const yc=K[Sb];let bd="";if(yc.IsCollapsible||
yc.Children)bd=this.lac(yc,ob),yc.IsCollapsible&&bd in this.E8c&&(yc.IsCollapsed=Lb.a.wg(this.E8c,bd)),yc.Children&&this.tqf(yc.Children,bd);this.PIb&&Ee.a.equals(this.PIb,bd||this.lac(yc,ob),!1)&&(this.RQa=yc,this.PIb="")}}iig(K){if(this.gk=K)this.currentState.cN=this.gk.FieldWellVersion,this.lca=Te(this.gk.FilterAxis,-1,this.lca),this.lca=Te(this.gk.ColumnAxis,-1,this.lca),this.lca=Te(this.gk.RowAxis,-1,this.lca),this.lca=Te(this.gk.DataAxis,-1,this.lca);this.rva?this.rva.length=0:this.rva=[];if(this.gk)if(this.rva.push(this.gk.FilterAxis),
this.rva.push(this.gk.ColumnAxis),this.rva.push(this.gk.RowAxis),this.rva.push(this.gk.DataAxis),this.Hf){K=-1;var ob=0;if(this.dbc&&0!==this.t7){switch(this.t7){case 1:0<this.gk.RowAxis.length&&(K=this.gk.RowAxis[0].ClientId,ob=3);break;case 2:0<this.gk.ColumnAxis.length&&(K=this.gk.ColumnAxis[0].ClientId,ob=3);break;case 4:0<this.gk.FilterAxis.length&&(K=this.gk.FilterAxis[0].ClientId,ob=3);break;case 8:0<this.gk.DataAxis.length&&(K=this.gk.DataAxis[0].ClientId,ob=3)}this.m4b()}var Sb=new te;Sb.filtersWellItems=
this.Ebc(this.gk.FilterAxis);Sb.columnsWellItems=this.Ebc(this.gk.ColumnAxis);Sb.rowsWellItems=this.Ebc(this.gk.RowAxis);Sb.valuesWellItems=this.Ebc(this.gk.DataAxis);this.qva.Vu(this.DHa,1,null,Sb,!1,-1,!1,ob,K,!1,null)}else this.m4b()}NZj(){this.SIb&&(this.SIb.innerText=this.currentState.yla?Ma.a.instance.ga(1177):this.titleText)}refresh(){if(this.OJd){var K=rd.create(this.$,this.UIb);this.RSf(K)}}RSf(K,ob=!1){if(this.isVisible&&(this.Gla||this.DHa)){K=K||rd.create(this.$,this.UIb);const Sb=this.currentState;
this.hk&&this.isj();this.currentState=K;if(rd.Zvi(Sb,K)||ob){if(this.xqb=!1,this.HQ.ql=K.HNa,pe.VY(this.HQ),rd.Gmf(Sb,K)||ob)this.IQ.ql=K.HNa,pe.VY(this.IQ),this.rig(null),this.iig(null),this.NZj()}else Sb.FH<K.FH?(this.HQ.ql=!0,pe.VY(this.HQ)):this.currentState.FH=Sb.FH,Sb.cN<K.cN?(this.xqb=!1,this.IQ.ql=!0,pe.VY(this.IQ)):this.currentState.cN=Sb.cN}Bc.a.instance.create(this.Hha,0,Qa.a.mGh,!0,!0)}ORd(K,ob){this.applyPivotFieldManagerHiddenState(K,ob);this.hg=Sa.HelperMethods.KO(K,this.hg,4);this.refresh();
this.raiseEvent(pe.jvb);this.Gla&&this.$.af()}applyPivotFieldManagerHiddenState(K,ob){this.$.userOperationManager.Kc(new Od.a(144,0,(Sb,kc,yc)=>{const bd=Ea.o(Ja.h(this.$).ha.ra.activeCell,this.$);var Fd=this.$.pa.ya;const Nd=Fd.Na(9);Nd.hidden=K;Nd.activeCell=bd;return za.g(Fd,"ApplyPivotFieldManagerHiddenStateV2",Nd,Sb,kc,yc,null,0)},16),ob)}ENf(K,ob,Sb){Sb.ql=!1;if(!Sb.request||ob!==Sb.correlationId)return!1;Sb.request=null;return nd.a.Zf(K.Errors)?(this.$.ea.Qo(K.Errors),!1):!0}nBf(K,ob){const Sb=
de.a.Oe(K.data);this.$.ea.Qo(Sb);ob.request=null;10!==K.data.status&&(ob.ql=!1);this.Hha()}applyPivot(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd,je,$e){0<Rd.getRangeInformation(Rd.ha.ra.activeCell).length?this.xqb=!0:(this.HQ.ql=!0,this.IQ.ql=!0);K.qjc&&(this.mHa=K.pivotTableName);const Xe=pe.Lsb(K),ig={FieldListType:1};ig.FieldListVersion=K.FH;ig.FieldWellVersion=K.cN;ig.SourceAxis=ob;ig.SourceAxisPosition=Sb;ig.ItemType=kc;ig.ItemIndex=yc;ig.DestinationAxis=bd;ig.DestinationAxisPosition=Fd;this.J0j($e,ob,bd);ob=
new Od.a(145,0,(Zg,Uf,uh)=>{var hh=this.$.pa.ya;Zg=ab.b(Zg,this.PNi);const Lh=za.L(hh,K.lx,K.externalSourceIndex,Xe);Lh.pivotFieldApplyData=ig;return za.g(hh,"ApplyPivot",Lh,Zg,Uf,uh,null,0)},4,()=>new Yb(this.pivotName,ig,je,K.lx));this.$.userOperationManager.Kc(ob,Nd)}J0j(K,ob,Sb){if(this.hk&&this.gk)if(0===ob)this.t7=0,this.RQa=K;else if(0!==Sb)this.t7=Sb;else switch(this.t7=0,this.QIb=!0,ob){case 1:1<this.gk.RowAxis.length&&(this.t7=1);break;case 2:1<this.gk.ColumnAxis.length&&(this.t7=2);break;
case 4:1<this.gk.FilterAxis.length&&(this.t7=4);break;case 8:1<this.gk.DataAxis.length&&(this.t7=8)}}expandPivotFieldListLevels(K){const ob=pe.Lsb(K);this.R2b=!0;this.$.userOperationManager.Kc(new Od.a(146,0,(Sb,kc,yc)=>{var bd=this.$.pa.ya;Sb=ab.b(Sb,this.ERi);const Fd=za.L(bd,K.lx,K.externalSourceIndex,ob);Fd.type=1;return za.g(bd,"ExpandPivotFieldListLevels",Fd,Sb,kc,yc,null,0)}),null)}t0e(K,ob){var Sb;for(let yc=pe.Fmg;yc<=pe.Gmg;yc++){const bd=this.rva[yc];for(Sb=bd.length-1;0<=Sb;Sb--){var kc=
bd[Sb];if(kc.PivotCacheIndex===K&&(-1===ob||kc.PivotTableIndex===ob))return K=this.A0h(yc),kc=kc.PivotTableIndex,{returnValue:!0,axis:K,pos:Sb,mMf:kc}}}return{returnValue:!1,axis:0,pos:-1,mMf:-1}}Hwi(K){return K>=pe.Fmg&&K<=pe.Gmg}clear(){this.currentState=rd.i6b();this.refresh()}A0h(K){return this.Hwi(K)?this.pGh[K]:0}hJb(K,ob){K&&(this.mHa=null);this.refresh();ob&&(this.Gla?!this.Hf&&this.Es()&&this.nq()?this.showTaskPane():!this.Hf||this.nq()&&this.Es()||this.hideTaskPane():this.raiseEvent(pe.jvb))}DOh(){var K=
Ja.h(this.$);let ob=null;K=K.getRangeInformation(K.ha.ra.activeCell);for(let Sb=0,kc=K.length;Sb<kc;++Sb){const yc=K[Sb];if(Object(hb.a)(zb.PivotTableRange,yc)){ob=yc.pivotTableName;break}}return ob}sig(K){const ob=Ja.h(this.$);var Sb=ob.Ea.Dl(K);if(Sb){if(this.mHa){K=Sb.ranges;if(!K)return;for(Sb=K.length-1;0<=Sb;--Sb){var kc=K[Sb];if(Object(hb.a)(zb.PivotTableRange,kc)&&Ee.a.equals(kc.pivotTableName,this.mHa,!1)){K=this.DOh();K&&Ee.a.equals(K,this.mHa,!1)||(K=Ea.v(kc.topLeft,this.$),ob.pg(K,null,
null,null,0,"FieldManagerPane.UpdateFieldsPaneStatus"));this.mHa=null;break}}}Ja.h(this.$).Ur||this.refresh()}else ua.ULS.sendTraceTag(537162690,0,15,`Block ${K} was removd from BlockManager`)}wL(){this.clear()}static OTg(K,ob,Sb){let kc=Re.a(K);if(!kc){const yc=document.getElementById(K.Eb+eb.a.dXe);yc?kc=K.da.Ga(16,new pe(yc,K,ob,Sb)):ua.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return kc}static Lsb(K){const ob={};ob.AnchorType=K.anchorType;
7===K.anchorType&&(ob.ChartId=K.chartId,ob.AnchorValue1=ob.AnchorValue2=-1);return ob}static VY(K){K.request&&(Gd.AFrameworkApplication.Bd.Tu(K.request.nu),K.request=null)}}pe.jvb="fieldListPaneVisibilityChanged";pe.cXe="FieldListPaneChanging";pe.bXe="FieldListPaneChanged";pe.eXe="FieldManagerRemovePaneEventKey";pe.Fmg=0;pe.Gmg=3;pe.Hcj="FieldListReactPaneHeaderId";pe.Ccj="FieldListReactPaneBodyId";pe.Jcj="FieldListReactPaneTitleId";pe.Dcj="FieldListReactPaneCloseButtonId";pe.Fcj=Kd.exh;pe.Gcj=Kd.dxh;
pe.Icj="cui-taskPaneTitle "+Kd.fxh;pe.Bcj=Kd.bxh;pe.Ecj=Kd.cxh;Object(fa.a)(pe,"FieldManagerPane",fb.a,[714,305,2,263,39]);class rf extends Ke.a{constructor(K){super();this.$=K;this.Fb()}create(){const K=hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7079204_pivotTableFieldPanePain")?db.Task.Ta(null):ta.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya),ob=cc.a(this.$),Sb=[K,ob];if(!Wc.a.gd(this.$)){const kc=ta.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),yc=ta.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Ya);Sb.push(kc);Sb.push(yc)}ub.TaskExtensions.Aa(ub.TaskExtensions.Fd(Sb,this.la),()=>{const kc=pe.OTg(this.$,ob.result,K.result);kc&&(Wc.a.gd(this.$)||ob.result.yN(kc),kc.T6());this.ob(kc)},this.la,3)}dispose(){this.$=null;super.dispose()}static ka(K){K.da.Ga(74,new rf(K))}}Object(fa.a)(rf,"FieldManagerTaskPaneFactory",Ke.a,[]);var cf=a(157),wf=a(83);class Ge{constructor(){this.Z7b=this.sourceRange=this.xea=null}}Object(fa.a)(Ge,"SelectedRangeForPivot",null,[]);var Ue=a(554),gb=
a(187),Ob=a(261),rc=a(146),Oc=a(185);class ld{static get ng(){return rc.a.iq(ld.Bji,Oc.a.ga(66),Oc.a.ga(67),Oc.a.ga(68),Oc.a.ga(69),Oc.a.ga(70),Oc.a.ga(71),Oc.a.ga(72))}}ld.Bji="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(fa.a)(ld,"InsertPivotTableDialogHtml",null,[]);var Cd=a(161),Qd=a(371);class re{constructor(K,ob){this.ZYb=K;this.oCg=ob;this.ntc=null}get textBox(){return this.ZYb}get Qbb(){return this.oCg}bindAction(K){this.Qbb&&K&&(this.ntc=K,this.Qbb.bMg(this.ntc))}XWj(){this.Qbb&&this.ntc&&this.Qbb.Yij(this.ntc)}isValid(){return!!this.Qbb&&!!this.textBox}}Object(fa.a)(re,"TextBoxRadioButtonPair",null,[742]);var Ie=a(867),qf=a(285);class Pe{constructor(K,ob){this.title=K;this.ng=ob}}Object(fa.a)(Pe,"DialogData",
null,[]);const of=(K,ob,Sb,kc,yc,bd,Fd,Nd=null)=>{Nd=K.Na(41,Nd);Nd.sheetRange=ob;Nd.destinationRange=Sb;return za.g(K,"InsertPivotTable",Nd,kc,yc,bd,Fd,0)},Hb=(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd=null)=>{Rd=K.Na(41,Rd);Rd.activeCell=ob;Rd.newRange=Sb;Rd.isDataSource=kc;return za.g(K,"ChangePivotLocation",Rd,yc,bd,Fd,Nd,0)},mc=(K,ob,Sb,kc,yc,bd,Fd=null)=>{Fd=K.Na(1,Fd);Fd.activeCell=ob;return za.g(K,"GetDataSourceRangeForPivotTable",Fd,Sb,kc,yc,bd,0)};class Mc{constructor(K,ob){this.destinationRange=this.sourceRange=
null;this.sourceRange=K;this.destinationRange=ob}}Object(fa.a)(Mc,"MacroRecorderPivotTableCreatedPayload",null,[125]);var Rb=a(381),xc=a(162),ed=a(214);class xd extends Rb.a{constructor(K){super(K)}v5a(K){let ob,Sb=({gkc:ob}=super.v5a(K)).returnValue;if(!Sb){const kc=Object(sb.a)(ed.a,this.$.Cb);kc&&kc.Qk(K)&&(Sb=(K=kc.getItemByName(K))&&1!==K.type?2===K.type?xc.a(K):K.usedRange:null,ob=2===K.type)}return{returnValue:Sb,gkc:ob}}}Object(fa.a)(xd,"PivotTableRangeHighlightPolicy",Rb.a,[]);class yd extends Ob.a{constructor(K,
ob){super(K,new xd(K));this.aZd=this.destinationRange=this.Maa=this.eza=this.STa=null;this.XBa=!1;this.vv=0;this.bMe="";this.mff=(Sb,kc)=>{this.hide();if(1===Sb){let yc=Sb="";2!==this.vv&&(Sb=yd.$Fd(kc[yd.DAc],this.$.xa),this.aMj(Sb,this.$)&&ua.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==this.vv&&kc[yd.Ibd]&&(yc=yd.$Fd(kc[yd.Y7b],this.$.xa));2===this.vv&&yc===this.bMe||this.Xii(Sb,yc)}else this.NNb(!0,!0),ua.ULS.sendTraceTag(537155780,
0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.Iu=()=>{this.eQb()};this.dpc=()=>{this.destinationRange.disabled=!this.Maa.checked;this.eQb();return!1};this.tBf=()=>{this.eQb();return!1};this.DIf=()=>{this.eQb();return!1};this.IDd=Sb=>{if(na.a(Sb))this.NNb(!0,!0),ua.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");else{ua.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const kc=
Sb.Result;if(kc){if(Sb=this.$.xa.getItemByName(kc.SheetName))Sb.activate(),this.gridView.pg(kc,null,null,null,3,"InsertPivotTableDialog.OnInsertPivotTableDone"),this.NNb(!0,!1),0===this.vv&&this.uyj(),Sb=eb.a.Btc,Sb!==Cd.a(this.$).Gm.gA&&(Cd.a(this.$).otc(2),Cd.a(this.$).Gm.activateRibbonTab(Sb))}else this.NNb(!0,!1)}};this.gridView=Ja.h(this.$);this.bR=Ue.a.instance;this.cw=!1;-1128516639===ob?(this.vv=1,ua.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):
-63037693===ob?(this.vv=2,ua.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):ua.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){ua.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.oDc();super.dispose()}get pc(){return"InsertPivotTableDialog"}get arb(){return!0}get LBe(){return!0}get KBe(){return!0}Sja(){let K;return K=new gb.a,K.add(yd.DAc),K.add(yd.Y7b),K}imh(){let K=
!1;2!==this.vv&&(K=yd.kmh(this.STa.value));K||1===this.vv||(K=yd.jmh(this.Maa.checked,this.destinationRange.value));return K}get By(){return()=>{let K=this.destinationRange.value;1!==this.vv&&this.destinationRange.disabled&&(K="");this.mff(1,yd.Q3e(this.STa.value,K))}}xgc(K){ua.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const ob=this.agd();this.ng=ob.ng;var Sb="";2!==this.vv&&(Sb=yd.$Fd(K.xea,this.$.xa));Sb=yd.Q3e(Sb,K.Z7b);1!==this.vv&&2===this.vv&&(this.bMe=K.Z7b);this.NNb(!1,
!1);this.initializeAndShow(ob.title,this.mff,Sb);this.SXd();this.Fyj();this.eQb();ua.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}aMj(K,ob){let Sb=!1;K=({gkc:Sb}=(new xd(ob)).v5a(K)).returnValue;return!!K&&K.V5&&!Sb}eQb(){this.i0a.disabled=this.imh()}SXd(){this.bR.ta(Mb.a.change,this.eza,this.dpc);this.bR.ta(Mb.a.change,this.Maa,this.dpc);this.bR.ta(Mb.a.Dd,this.STa,this.DIf);this.bR.ta(Mb.a.Dd,this.destinationRange,this.tBf);this.YLg(this.Iu);this.XBa=!0}oDc(){this.XBa&&
(this.bR.Ba(Mb.a.change,this.eza,this.dpc),this.bR.Ba(Mb.a.change,this.Maa,this.dpc),this.bR.Ba(Mb.a.Dd,this.STa,this.DIf),this.bR.Ba(Mb.a.Dd,this.destinationRange,this.tBf),this.Vij(this.Iu),this.XBa=!1)}Fyj(){2===this.vv?this.destinationRange.focus():this.STa.focus()}Dbg(){const K=new qf.a(this.destinationRange),ob=new Ie.a(this.Maa,!1);this.aZd=new re(K,ob);this.UXd(this.aZd)}mhg(){this.J0d(this.aZd)}Ot(){super.Ot();ua.ULS.sendTraceTag(537155777,0,50,"InsertPivotTableDialog.InitializeDialogElements");
this.STa=document.getElementById(yd.DAc);this.eza=document.getElementById(yd.fxf);this.Maa=document.getElementById(yd.Ibd);this.destinationRange=document.getElementById(yd.Y7b);switch(this.vv){case 0:case 2:this.destinationRange.value?yd.v5f(this.Maa,this.eza):(this.destinationRange.disabled=!0,yd.v5f(this.eza,this.Maa));Ac.k(this.$.hg)&&(this.eza.checked=!1,this.eza.disabled=!0,this.destinationRange.value="",this.Maa.checked=!0);if(2===this.vv){this.STa.disabled=!0;var K=document.getElementById(yd.njh);
K.style.visibility="hidden";K.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.eza.disabled=!0,this.Maa.disabled=!0,K=document.getElementById(yd.w5i),K.style.visibility="hidden",K.style.display="none"}}Xii(K,ob){ua.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const Sb=this.$.pa.ya;let kc=1;const yc=Sb.Wb(),bd=Ea.o(Ja.h(this.$).ha.ra.activeCell,this.$);let Fd=null,Nd=null;switch(this.vv){case 0:kc=132;Fd=(Rd,je,$e)=>of(Sb,K,ob,
ab.b(Rd,this.IDd),je,$e,null,yc);Nd=()=>new Mc(K,ob);break;case 2:kc=219;Fd=(Rd,je,$e)=>Hb(Sb,bd,ob,!1,ab.b(Rd,this.IDd),je,$e,null,yc);break;case 1:kc=219,Fd=(Rd,je,$e)=>Hb(Sb,bd,K,!0,ab.b(Rd,this.IDd),je,$e,null,yc)}Qd.a(this.$.userOperationManager,Fd,Rd=>new Od.a(kc,0,Rd,void 0,Nd),null)}agd(){let K=0;switch(this.vv){case 0:K=65;break;case 1:K=2147;break;case 2:K=2143}return new Pe(Ma.a.instance.ga(K),ld.ng)}uyj(){const K=this.$.da.za(16);K&&K.Xzc(!1,null,!0)}NNb(K,ob){const Sb=!K,kc=this.$.da.za(183);
kc&&kc.P8f(Sb,ob);K&&this.gridView.Gf&&this.gridView.Gf.gm(eb.a.TQ)}set arb(K){super.arb=K}set By(K){super.By=K}static Q3e(K,ob){const Sb=!ob;return{[yd.DAc]:K,[yd.Y7b]:ob,[yd.fxf]:Sb,[yd.Ibd]:!Sb}}static v5f(K,ob){K.tabIndex=yd.gKh;ob.tabIndex=yd.mLi}static $Fd(K,ob){let Sb,kc;K=K.startsWith("=")?K.substring(1,K.length):K;({sheetName:Sb,range:kc}=Ea.Z(K,ob)).returnValue&&kc&&(Sb||(Sb=ob.na.name),K=Ea.x(kc,Sb,!1,!0));return K}static kmh(K){return Ee.a.Wq(K)}static jmh(K,ob){return K&&Ee.a.Wq(ob)}}
yd.CPe="";yd.gKh=0;yd.mLi=-1;yd.DAc="sourceRange";yd.Y7b="destinationRange";yd.fxf="newWorksheet";yd.Ibd="existingWorksheet";yd.njh="DataSourceDiv";yd.w5i="PivotDestinationDiv";Object(fa.a)(yd,"InsertPivotTableDialog",Ob.a,[]);class Zd{constructor(K){this.Xmd=!1;this.Osa=null;this.$=K;this.gridView=Ja.h(K);wf.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ob=>{this.Osa=ob;ob.isFeatureEnabled(Zd.qdf,!1).then(Sb=>this.Xmd=Sb);ob.una(Zd.qdf,Sb=>{this.Xmd=Sb.isEnabled})})}nc(){return!1}executeCommand(K,
ob,Sb){var kc;K=ub.TaskExtensions.Rj();const yc=ob.command;let bd;const Fd=new cf.a;ob=this.gridView.ha.ra;switch(yc){case 2137617149:K=null!==(kc=Sb.rrg)&&void 0!==kc?kc:ob.selectedRanges;this.N1h(K,Fd);if(Wc.a.kjf(this.$)&&this.Xmd){const je=new cf.a;Fd.task.jp($e=>{Sb.SourceSelection=vc.b($e)&&$e.result&&$e.result.xea?$e.result.xea:"";return this.$.Xc(-1444574190,0,0,Sb).continueWith(Xe=>{vc.b(Xe)&&Xe.result||(bd=new yd(this.$,yc),bd.xgc($e.result));je.setResult(!0)})});K=je.task}else bd=new yd(this.$,
yc),K=Fd.task.continueWith(()=>{bd.xgc(Fd.task.result)});break;case -1128516639:const Nd=this.$.pa.ya.Wb(),Rd=Ea.o(ob.activeCell,this.$);kc=new Od.a(554,0,(je,$e,Xe)=>mc(this.$.pa.ya,Rd,ab.b(je,ig=>{this.WCf(ig,Fd,!1)}),ab.a($e,()=>{Zd.VCf(Fd,this.$)}),Xe,null,Nd),88);kc.uBa(()=>!0);this.$.userOperationManager.Kc(kc,null);bd=new yd(this.$,yc);K=Fd.task.continueWith(()=>{bd.xgc(Fd.task.result)});break;case -63037693:kc=new Ge;if(ob=this.gridView.Bb.zp(ob.activeCell))ob=we.Range.Qc(ob.WZf+1,ob.left),
kc.Z7b=Ea.h(ob,this.$,!0,void 0,!0);Fd.setResult(kc);bd=new yd(this.$,yc);K=Fd.task.continueWith(()=>{bd.xgc(Fd.task.result)})}return K}WCf(K,ob,Sb){const kc=K.Result,yc=new Ge;if(Sb||kc){const bd=this.gridView.ha.ra.Mg;na.a(K)?bd&&(yc.xea=this.gridView.ha.e7e(!0)):(yc.xea=kc,bd&&Sb&&this.ash()&&!this.gridView.Bb.Bj(this.gridView.ha.ra.$c)&&(yc.Z7b=this.gridView.ha.Wed(!0,!0)))}else if(K=this.gridView.Bb.zp(this.gridView.ha.ra.activeCell))yc.xea=K.dataSource;ob.setResult(yc)}ash(){var K=this.gridView.ha.ra.activeCell;
K=new we.Range(K.top,K.left,K.top+1,K.left+1,!1,!1);K=this.gridView.fk("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",K);try{for(K.$$rst();K.$$mn();)if(K.$$cu().text)return!1}finally{K&&K.dispose()}return!0}N1h(K,ob){if(1!==K.length)ob.setResult(Object(Oe.a)(new Ge,{xea:""}));else{K=K[0];const Sb=this.gridView.Bb.Bj(K);if(Sb)ob.setResult(Object(Oe.a)(new Ge,{xea:Sb.name,sourceRange:Sb.usedRange}));else{const kc=this.$.pa.ya.Wb(),yc=Ea.o(K,this.$),bd=Ea.v(K,this.$);K=new Od.a(511,0,(Fd,
Nd,Rd)=>{const je=$e=>$e(this.$.pa.ya,bd,yc,ab.b(Fd,Xe=>{this.WCf(Xe,ob,!0)}),ab.a(Nd,()=>{Zd.VCf(ob,this.$)}),Rd,null,kc);return ta.GetServiceTaskFactory.Oa(this.$.da,482,483,1).jp($e=>{vc.b($e)&&je($e.result.getExpandedRangeForPivotTable)})},88);K.uBa(()=>!0);this.$.userOperationManager.Kc(K,null)}}}wc(K,ob){K=!1;switch(ob.command){case -1128516639:case -63037693:case 2137617149:K=!0}return K}Jc(){return!1}static VCf(K,ob){ua.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");
Ja.h(ob).ha.ra.Mg?K.setResult(Object(Oe.a)(new Ge,{xea:Ja.h(ob).ha.Jia})):K.setResult(Object(Oe.a)(new Ge,{xea:""}))}}Zd.qdf="ExcelIdeas";Object(fa.a)(Zd,"InsertPivotTableCommandHandler",null,[165]);class me extends Vb.a{constructor(K){super(K)}nd(){const K=ta.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Ya);ub.TaskExtensions.Aa(ub.TaskExtensions.Fd([K],this.la),()=>{this.Yc([new Zd(this.$)])},this.la,3)}static ka(K){Vb.a.Nd(91,new me(K))}}Object(fa.a)(me,"InsertPivotTableCommandHandlerFactory",
Vb.a,[]);var wb=a(284);class $b extends wb.a{constructor(K,ob,Sb){super(K);this.s$f=null;this.Cji=(kc,yc)=>{1===kc?(kc=yc.indices,ua.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${kc.length} Slicers`),0<kc.length&&this.xmh(kc)):ua.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};this.qTi=kc=>{this.s$f=kc.Result;kc={["id"]:this.pc,["singleDimFields"]:this.s$f};this.initializeAndShow(Ma.a.instance.ga(2144),this.Cji,
kc)};this.gridView=Ja.h(K);this.ra=this.gridView.ha.ra;this.ha=Ja.h(K).ha;this.pivotTableName=ob;this.JGd=Sb;Ja.h(K).Bb.zp(this.ha.ra.activeCell);ua.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");this.Yii()}get pc(){return"InsertSlicerDialog"}xmh(K){ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,103,104,0),ob=>{var Sb=ob.result,kc=Ja.h(this.$),yc=Sb.bhb(kc);if(yc){var bd=yc.ve;ob=bd.pf.top;bd=bd.pf.left;Sb=yc.lJ.x;yc=yc.lJ.y}else ob=
bd=1,yc=Sb.NLa(kc),Sb=yc.x,yc=yc.y;kc=0;for(const Fd of K)this.Dji(parseInt(Fd,10),ob,bd,Sb+kc,yc+kc),kc+=22},this.$.la,8)}Dji(K,ob,Sb,kc,yc){const bd=new Od.a(203,0,(Fd,Nd,Rd)=>{const je=this.$.pa.ya.Wb();return le.t(this.$.pa.ya,this.JGd,this.pivotTableName,K,0,ob,Sb,kc,yc,Fd,Nd,Rd,je)},void 0,()=>new We.a(this.JGd,this.pivotTableName,K,0));this.$.userOperationManager.Kc(bd,null)}Yii(){const K=new Od.a(596,0,(ob,Sb,kc)=>{const yc=this.$.pa.ya.Wb();return le.j(this.$.pa.ya,this.pivotTableName,this.JGd,
ab.b(ob,this.qTi),Sb,kc,yc)},16);this.$.userOperationManager.Kc(K,null)}}Object(fa.a)($b,"InsertSlicerDialog",wb.a,[]);class uc{constructor(K){this.activeCell=this.kc=null;this.$=K;this.ha=Ja.h(this.$).ha}nc(){return!1}executeCommand(K,ob){K=ub.TaskExtensions.Rj();ob=ob.command;this.activeCell=this.ha.ra.activeCell;switch(ob){case -1924368815:(this.kc=Ja.h(this.$).Bb.zp(this.activeCell))&&!this.kc.isOlap&&new $b(this.$,this.kc.pivotTableName,this.$.xa.na.sheetName)}return K}wc(K,ob){K=!1;switch(ob.command){case -1924368815:K=
!0}return K}Jc(){return!1}}Object(fa.a)(uc,"InsertSlicerCommandHandler",null,[165]);class Pc extends Vb.a{constructor(K){super(K)}nd(){this.Yc([new uc(this.$)])}static ka(K){Vb.a.Nd(353,new Pc(K))}}Object(fa.a)(Pc,"InsertSlicerCommandHandlerFactory",Vb.a,[]);var Ad=a(80),ba=a(374),cb=a(552),Kb=a(329),lc=a(31),Qc=a(594),Rc=a(59),zd=a(192),ae=a(118);class ze{constructor(K){this.interactiveReportView=K}executeCommand(K,ob){return db.Task.Ta(this.interactiveReportView.refreshSelectedConnection(ob))}wc(K,
ob){return 32===K&&2054778433===ob.command}Jc(){return!1}nc(K,ob){return 32===K&&(1588554917===ob||1891435765===ob||2054778433===ob&&!this.interactiveReportView.Fjc)}static ka(K,ob){K.Ka.P2(new ze(ob))}}Object(fa.a)(ze,"InteractiveReportCommandHandler",null,[165]);var Be=a(127);class xe{constructor(K,ob){this.iframe=document.createElement("iframe");this.iframe.src=ob;this.iframe.frameBorder="0";this.iframe.scrolling="no";this.iframe.id=K;this.hja=Be.a.instance.Zd(this.iframe);this.hja.ka("load",()=>
{InteractiveReportAPI.SetHost(this.contentWindow,ob)})}get eaa(){return this.iframe}get Aef(){return 1}get contentWindow(){return this.iframe.contentWindow}NSa(){}setVisible(K){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=K?"visible":"hidden")}dispose(){sa.a.Ia(this.hja);this.hja=null}}Object(fa.a)(xe,"IFrameContentElement",null,[781,2]);class Ce{constructor(K){this.D6a=document.createElement("img");rb.DOMElementExtensions.setVisible(this.D6a,!0);this.D6a.setAttribute("style","height: 80%; width: auto");
this.K8b=document.createElement("div");this.K8b.id=K;this.K8b.appendChild(this.D6a)}get eaa(){return this.K8b}get Aef(){return 7}get contentWindow(){return null}NSa(K){this.D6a&&(this.D6a.src="data:image/png;charset=utf-8;base64,"+K,rb.DOMElementExtensions.setVisible(this.D6a,!0))}setVisible(K){rb.DOMElementExtensions.setVisible(this.K8b,K)}dispose(){}}Object(fa.a)(Ce,"ImageContentElement",null,[781,2]);class ef{constructor(K,ob,Sb,kc,yc){this.interactiveReportContent=this.msc=this.TG=null;this.Cff=
!1;this.Z5i=()=>{this.interactiveReportView.Wbc(this)};this.ybe=K;this.Cyg=Sb;this.$=yc;this.TG=kc?new Ce(ob):new xe(ob,Sb);this.l_=this.TG.Aef;this.bVa()}get interactiveReportView(){return this.ybe}get mxa(){return this.Cyg}get A5j(){return this.$.workbookContext.WorkbookUri}get eaa(){return this.TG.eaa}get contentWindow(){return this.TG.contentWindow}NSa(K){this.TG.NSa(K)}bVa(){this.interactiveReportView.isVisible&&this.eaa&&this.eaa.style&&(rb.DOMElementExtensions.iJ(this.eaa,this.interactiveReportView.domElement.clientHeight),
rb.DOMElementExtensions.Xv(this.eaa,this.interactiveReportView.domElement.clientWidth))}setVisible(K){this.TG.setVisible(K)}Ish(){sa.a.Ia(this.msc);this.msc=Bc.a.instance.create(this.Z5i,2E3,Qa.a.dki)}dispose(){rb.DOMElementExtensions.tf(this.TG.eaa);sa.a.qc([this.msc,this.TG]);this.ybe=this.TG=this.msc=null}}Object(fa.a)(ef,"InteractiveReportFrameInfo",null,[2]);class Jf{constructor(K,ob){this.xAc=K;this.dac=ob}}Object(fa.a)(Jf,"InteractiveReportSheetData",null,[]);class Ia{constructor(){this.kCb=
this.aca=this.DBb=!1}}Object(fa.a)(Ia,"SheetVisibilityStateData",null,[]);const Bb=(K,ob,Sb,kc,yc,bd=null)=>{bd=K.Na(1,bd);return za.g(K,"GetSessionInformation",bd,ob,Sb,kc,yc,4)};var zc=a(44),ad=a(57),sd=a(6),Sd=a(41);class fe extends Kb.a{constructor(K,ob,Sb,kc){super(ob,K,!1);this.gj=this.L5d=null;this.czc=new Lb.a(!0);this.Y3=new Lb.a(!0);this.CKb=this.n2a=this.gua=null;this.eRb=!1;this.hashCode=this.HCb=null;this.NCc=!1;this.$Ta=null;this.MCb=Vd.a.Qa.zb;this.businessBar=null;this.SPa=(yc,bd)=>
{bd&&bd.Result&&(yc=bd.Result,yc.DataConnections&&yc.DataConnections.DataConnections&&this.ISf(yc.DataConnections))};this.sf=(yc,bd)=>{switch(bd.jd.block.state){case 1:case 3:case 5:this.mea(bd)}};this.an=()=>{};this.Mo=(yc,bd)=>{this.C$c();bd.na&&this.isVisible&&this.xzi(!Ub.j(bd.na));this.clearCache();this.dR=!1};this.bO=yc=>{switch(yc.zu){case 1:this.NCc&&this.Wbc(this.gj)}};this.ed=(yc,bd)=>{bd.NV||(this.C$c(),yc=this.$,this.cvb=Ac.d(yc.hg),yc.ea.gDa.getTime()>this.gDa.getTime()&&(this.t4b(),
this.gDa=yc.ea.gDa),this.Vxa&&this.Wbc(this.gj))};this.se=()=>{this.ZTa(!1)};this.dO=()=>{this.$.ea.Uma()};this.onKeyDown=yc=>{yc=this.$.shortcutKeyManager.xs(yc);this.executeRibbonCommand(yc)};this.ij=()=>{this.gj&&this.gj.bVa()};this.c7=()=>{this.Gfc();this.aK.aca=!0};this.b7=()=>{this.aK.DBb||this.aK.kCb||this.ZPb();this.aK.aca=!1};this.PEf=()=>{this.Gfc();this.aK.aca=!0};this.Cy=()=>{this.aK.DBb||this.aK.kCb||this.ZPb();this.aK.aca=!1};this.aHf=()=>{this.aK.DBb=this.bLb.ZK&&this.bLb.g6i;this.aK.DBb?
this.Gfc():this.aK.aca||this.aK.kCb||this.ZPb()};this.lGf=()=>{switch(zc.a(this.$).state){case 0:case 1:case 2:case 4:this.aK.DBb||this.aK.aca||this.ZPb();this.aK.kCb=!1;break;case 5:case 3:case 7:case 8:case 6:this.Gfc(),this.aK.kCb=!0}};this.KSi=(yc,bd)=>{if(this.NNa(3)||this.Vxa){var Fd=yc.Result;yc=this.Vxa;if(null===Fd||void 0===Fd?0:Fd.ReportData)this.CKb=Fd.ReportData;if(Fd&&Fd.DataConnectionsInfo)if(Fd=Fd.DataConnectionsInfo,1===Fd.DataConnections.length&&Fd.DataConnections[0].StreamingFailed)this.t4b(),
this.ZTa(!0);else{var Nd=!0;this.n2a=Fd.DataSources;for(const Rd of Fd.DataConnections)if(Rd.IsReady||0>Rd.SourceIndex){const je=Rd.ConnectionName.toLowerCase();this.Y3.getItem(je)||this.Y3.add(je,Rd)}else{bd.Ish();Nd=!1;break}Nd&&(yc?this.ISf(Fd):(this.gj.l_=4,this.Bgb(bd,null)))}else this.gj.l_=1}};this.XTi=yc=>{yc&&this.$.ea.Qo(yc.Errors)};this.Q6a=new Qc.a(K,K.ea,K.pa.Mk,4,0);this.gDa=K.ea.gDa;this.cvb=!K.dc.refreshConfirmationRequired||Ac.d(K.hg);this.nRe=!1;this.domElement.classList.add(lc.a.B$b);
this.domElement.style.overflow="hidden";this.domElement.tabIndex=0;this.ZTa(!1);this.Gc.ka("mousedown",this.dO);this.Gc.ka("keydown",this.onKeyDown);K.xa.KJ(this.Mo);K.Cb.KJ(this.Mo);K.Cb.Uf(this.se);K.xa.Uf(this.se);K.VA(this.ij);K.rb.H0b(this.c7);K.rb.G0b(this.b7);K.Ka.Qre(this.PEf);K.Ka.OZa(this.Cy);zc.a(K).Mq(this.lGf);this.Ea.mt(this.sf);this.Ea.jH(this.an);Ic.a(K).kse(this.SPa);K.nl(this.ed);this.mv(this.rza);ee.a(K).MQ(sd.a.idle).Mq(this.bO);this.bLb=Sb;this.bLb.RE(this.aHf);this.aK=new Ia;
this.P2b=kc;ze.ka(K,this)}get Ea(){return this.Q6a}get Ne(){return 32}get Fjc(){if(this.Vxa){const K=this.$6e();return!!K&&-1!==K.SourceIndex}return!1}get ENj(){this.$Ta=this.$Ta||new zd.a;return this.$Ta.token}J8a(){return!0}get que(){return this.L5d||(this.L5d=fe.tbh(this.$))}get e_b(){return this.$.na.index.toString()}get d_b(){return this.czc.getItem(this.e_b)}get hki(){if(hd.EwaSettings.ma(23)){let K=Ad.a.NT(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,fe.nki,this.$.workbookContext.FullDocumentInfo.WorkbookPath);
K=Ad.a.NT(K,fe.iki,fe.jki);K=Ad.a.NT(K,fe.$ji,this.$.va.DataCultureTag);return K=Ad.a.NT(K,fe.kki,this.$.va.UICultureTag)}return ib.a.current.mL.InteractiveReportServiceUrl}get Vxa(){return this.NNa(5)}dispose(){if(this.$){const K=this.$;K.xa.sL(this.Mo);K.Cb.sL(this.Mo);K.Cb.Bg(this.se);K.xa.Bg(this.se);zc.a(K).hr(this.lGf);K.bE(this.ij);K.rb.ovc(this.c7);K.rb.nvc(this.b7);K.Ka.PVf(this.PEf);K.Ka.fKb(this.Cy);this.bLb.nG(this.aHf);this.bLb=null}this.Q6a&&(this.Q6a.gr(this.sf),this.Q6a.HI(this.an));
this.Oy(this.rza);fe.Zka.includes(this)&&Array.remove(fe.Zka,this);this.clearCache();sa.a.qc([this.$Ta,this.Q6a,this.gj]);this.gj=this.Q6a=this.$Ta=null;rb.DOMElementExtensions.tf(this.domElement);this.czc.clear();this.Y3.clear();this.P2b=this.businessBar=this.HCb=this.gua=this.n2a=this.CKb=null;super.dispose()}refreshSelectedConnection(K){const ob=this.$6e();if(ob){const Sb=ob.IsEmbedded?-1:ob.SourceIndex;Ic.a(this.$).jcb(ob.ConnectionName,Sb,K);return!0}return!1}Wbc(K){ua.ULS.sendTraceTag(537155663,
0,15,"InteractiveReportView.GetBootstrapData()");const ob=this.$,Sb=this.CKb;ad.c(ob)?ua.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent"):ee.a(ob).fi.activityName!==sd.a.idle?this.NCc=!0:(this.NCc=!1,ob.userOperationManager.Kc(new Od.a(512,0,(kc,yc,bd)=>{var Fd=ob.pa.ya.Wb(),Nd=ob.pa.ya;kc=ab.b(kc,this.KSi);var Rd=!!Sb;Fd=Nd.Na(1,Fd);Fd.connectionsOnly=Rd;return za.g(Nd,"GetInteractiveReportBootstrapData",Fd,kc,yc,bd,K,0)},64),null))}$6e(){for(let K=
0;K<this.Y3.count;++K){const ob=this.Y3.$f(K);for(const Sb of ob.SlidesIds)if(Sb===this.gua)return ob}return null}mIg(K,ob){this.hashCode=this.Ea.tsa(K,ob,this.hashCode)}clearCache(){this.Ea.sRa(this.hashCode);this.hashCode=null}ogf(){this.C$c();const K=this.$.na;return this.isVisible=!!K&&Ub.j(K)}oJg(){fe.Zka.includes(this)||fe.Zka.push(this)}K1g(){sa.a.Ia(this.$Ta);this.$Ta=null}ZTa(K){this.ogf()&&(this.oJg(),this.K1g(),ub.TaskExtensions.Aa(this.que,()=>{const ob=6===this.que.status;ob&&!this.nRe&&
(this.Yji(),this.nRe=!0);this.ogf()&&(this.EAi(K||!ob),ob||this.Aaj(),this.$.Fba||this.focus())},this.ENj,0))}C$c(){const K=this.$.workbookContext.WorkbookFileVersionId;K&&(this.HCb||(this.HCb=K),this.HCb!==K&&this.t4b())}ISf(K){this.n2a=K.DataSources;for(const ob of K.DataConnections){K=ob.ConnectionName.toLowerCase();const Sb=this.Y3.getItem(K);Sb&&(Sb.ConnectionString!==ob.ConnectionString||new Date(Sb.RefreshTimestampUTC)<new Date(ob.RefreshTimestampUTC))&&(ob.IsEmbedded&&this.mdj(ob.SecurityToken),
this.Eej(ob.DataSourceName),this.Y3.remove(K));this.Y3.add(K,ob)}this.NNa(8)&&this.isVisible&&this.Bgb(this.gj,null)}mdj(K){if(this.Vxa){const ob=Gd.AFrameworkApplication.Bd.$8a,Sb=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.gj.contentWindow,this.gj.mxa,this.n2a,K,ob,Sb)}catch(kc){ua.ULS.sendTraceTag(537155657,0,10,`RebindInteractiveReport: Failed to call Rebind: ${kc.message}`)}}}Eej(K){if(this.Vxa){const ob=Gd.AFrameworkApplication.Bd.$8a,Sb=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.gj.contentWindow,
this.gj.mxa,0,K,ob,Sb)}catch(kc){ua.ULS.sendTraceTag(537155655,0,10,`RefreshInteractiveReport: Failed to call Refresh: ${kc.message}`)}}}mea(K){if(K.jd.block.na.active){K=K.jd.block.je;const ob=new Jf(K.SlideId,K.FallbackImage);this.czc.add(this.e_b,ob);this.gj.interactiveReportContent||(this.gj.interactiveReportContent=K);this.Bgb(this.gj,ob)}}xzi(K){if(this.Vxa)try{InteractiveReportAPI.LeaveSlide(this.gj.contentWindow,this.gj.mxa)}catch(ob){ua.ULS.sendTraceTag(537155651,0,10,`LeaveInteractiveReport(): Failed to call LeaveSlide: ${ob.message}`)}this.gua=
null;K&&(this.gj.setVisible(!1),this.$.isEditMode&&this.qJd(!0))}t4b(){sa.a.Ia(this.gj);this.gj=null;this.Y3.clear();this.czc.clear();this.CKb=this.n2a=this.gua=null;this.NCc=this.eRb=!1;this.HCb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()}ZPb(){if(this.gj&&this.eRb&&Ub.j(this.$.na))try{InteractiveReportAPI.UnHideWindowedElements(this.gj.contentWindow,this.gj.mxa),this.eRb=!1}catch(K){ua.ULS.sendTraceTag(537155618,0,10,`UnHideInteractiveReport: UnHideWindowedElements failed - ${K.message}`)}}Gfc(){if(this.gj&&
!this.eRb&&Ub.j(this.$.na))try{InteractiveReportAPI.HideWindowedElements(this.gj.contentWindow,this.gj.mxa),this.eRb=!0}catch(K){ua.ULS.sendTraceTag(537155617,0,10,`HideInteractiveReport: HideWindowedElements failed - ${K.message}`)}}EAi(K){const ob=this.$;if(this.gj)this.ZPb(),this.gj.bVa(),this.gj.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(bd){}const kc=this.domElement.id+"_irframe";var Sb=document.getElementById(kc);Sb&&this.domElement.removeChild(Sb);Sb=ob.dc;K=K||!(Sb.allowFiltering&&
Sb.allowSorting&&Sb.allowInteractivity);let yc=this.hki;yc&&(Sb.allowHyperlinks||(yc+=fe.bki),Sb.inEmbedView&&(yc+=fe.cki),Sb.isBiPreviewOverride&&(yc+=fe.Zji));this.gj=new ef(this,kc,yc,K||!this.cvb,ob);this.domElement.appendChild(this.gj.eaa);K||this.cvb||(this.gj.l_=8)}(this.Vxa||this.NNa(1)||this.NNa(7))&&this.Bgb(this.gj,this.d_b);this.mIg(ob.na,Rc.a.H7b)}$Fe(K){K.l_=2;Ic.a(this.$).Sx(!0,ob=>{K.l_=8;ob&&(this.cvb=!0,this.t4b(),this.ZTa(!1))})}s2i(K){var ob=this.Y3.count;const Sb=Array(ob);for(var kc=
0;kc<ob;++kc){var yc=this.Y3.$f(kc);const bd={};bd.Name=yc.ConnectionName;bd.W7j=yc.ConnectionString;bd.SecurityToken=yc.SecurityToken;bd.DataSourceName=yc.DataSourceName;bd.Ebk=0>yc.SourceIndex&&yc.IsEmbedded;Sb[kc]=bd}ob=Gd.AFrameworkApplication.Bd.$8a;kc=this.$.ea.sessionId;yc=this.d_b.xAc;try{InteractiveReportAPI.OpenReport(K.contentWindow,K.mxa,this.CKb,null,yc,this.n2a,Sb,K.A5j,ob,kc),this.$.isEditMode&&this.qJd()}catch(bd){ua.ULS.sendTraceTag(537155605,0,10,`OnGetBootstrapDataSuccess: Failed to call OpenReport: ${bd.message}`);
return}K.l_=5;this.gua=yc;this.Bgb(K,null)}Bgb(K,ob){switch(K.l_){case 6:this.NSa(this.gj,ob);break;case 1:this.cvb?(this.Wbc(K),K.l_=3):this.$Fe(K);break;case 4:K.Cff&&K.interactiveReportContent&&this.s2i(K);break;case 5:this.kKi(K,ob);break;case 8:this.l3f(ob);this.$Fe(K);break;case 7:this.l3f(ob)}}Yji(){try{InteractiveReportAPI.RegisterEvent("Initialized",fe.gki),InteractiveReportAPI.RegisterEvent("UserInteractivity",fe.lki),InteractiveReportAPI.RegisterEvent("GetFallbackImage",fe.eki),InteractiveReportAPI.RegisterEvent("HostKeyPressed",
fe.fki),hd.EwaSettings.ma(33)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",fe.aki)}catch(K){}}dRb(K){return!!this.gj&&!!this.gj.eaa&&this.gj.contentWindow===K}oVi(K){this.dRb(K)&&(this.gj.Cff=!0,this.NNa(5)?this.gj.l_=4:this.NNa(6)&&(this.gj.l_=1),this.isVisible&&this.Bgb(this.gj,this.d_b))}pVi(K){this.isVisible&&this.dRb(K)&&ae.a(Vd.a.Qa,this.MCb)>=fe.Nxi&&this.$.ea.Zb&&(this.MCb=Vd.a.Qa.zb,Bb(this.$.pa.ya,this.XTi,null,null,null))}mVi(K,ob){if(this.dRb(K)){const Sb=this.$,kc=ob.SessionId;
ob.d8j&&Sb.userOperationManager.Kc(new Od.a(513,0,(yc,bd,Fd)=>{var Nd=Sb.pa.ya.Wb(),Rd=Sb.pa.ya;yc=ab.b(yc);Nd=Rd.Na(9,Nd);Nd.sessionId=kc;return za.g(Rd,"InteractiveReportDataWasModified",Nd,yc,bd,Fd,null,0)},64),null)}}JUi(K,ob){if(this.dRb(K)&&ob){K=[];ob.Mck&&K.push("Control");ob.Nck&&K.push("Meta");ob.Lck&&K.push("Alt");ob.Ock&&K.push("Shift");const Sb=document.createEvent("KeyboardEvent");Sb.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(ob.Ubk),0,K.join(" "),!1);ob=new Sys.UI.DomEvent(Sb);
ob=this.$.shortcutKeyManager.xs(ob);this.executeRibbonCommand(ob)}}executeRibbonCommand(K){1461300262!==K&&(K=new Zc.a(K,1,1,6,null),this.$.Ka.Lb(K))}nVi(K){this.dRb(K)&&(this.gj.l_=6,this.NSa(this.gj,this.d_b))}l3f(K){this.isVisible&&K&&K.dac&&this.gj.NSa(K.dac)}NSa(K,ob){if(this.isVisible&&ob&&ob.dac)try{InteractiveReportAPI.SetFallbackImage(K.contentWindow,K.mxa,ob.dac)}catch(Sb){}}kKi(K,ob){if(this.isVisible){if(ob&&(!this.gua||ob.xAc!==this.gua)){const Sb=Gd.AFrameworkApplication.Bd.$8a,kc=this.$.ea.sessionId;
try{this.$.isEditMode&&this.qJd(),InteractiveReportAPI.Navigate(K.contentWindow,K.mxa,ob.xAc,Sb,kc)}catch(yc){ua.ULS.sendTraceTag(537155593,0,10,`NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: ${yc.message}`);return}this.gua=ob.xAc}this.KIb(!0)}}NNa(K){return!!this.gj&&this.gj.l_===K}qJd(K=!1){this.businessBar?K?this.businessBar.removeEntry(19):this.businessBar.kg(19,null):this.P2b&&ub.TaskExtensions.Aa(this.P2b.value,ob=>{this.businessBar=ob=ob.result;this.P2b=null;K?ob.removeEntry(19):
ob.kg(19,null)},this.$.la)}static rHa(K){if(!K.da.za(36)){const ob=new cb.a(()=>ta.GetServiceTaskFactory.Oa(K.da,5,4,1)),Sb=ta.GetServiceTaskFactory.create(K.da,168,K.la,1);ub.TaskExtensions.Aa(Sb,()=>{var kc=K.uf;kc=new fe(K,kc.appendChild(kc.ownerDocument.createElement("div")),Sb.result,ob);K.da.Ga(36,kc)},K.la)}}static aki(K,ob){fe.Zka.forEach(Sb=>{Sb.mVi(K,ob)})}static gki(K){fe.Zka.forEach(ob=>{ob.oVi(K)})}static lki(K){fe.Zka.forEach(ob=>{ob.pVi(K)})}static eki(K){fe.Zka.forEach(ob=>{ob.nVi(K)})}static fki(K,
ob){fe.Zka.forEach(Sb=>{Sb.JUi(K,ob)})}static tbh(K){K=hd.EwaSettings.ma(23)?fe.Hgh(K.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:ib.a.loadScript(80,4,1,!0);return ub.TaskExtensions.Aa(K,()=>{try{InteractiveReportAPI.InitScript(Sd.c,Sd.b)}catch(ob){throw ob;}},ib.a.la)}static Hgh(K){const ob=new cf.a;if(!K)return ua.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),ob.setException(Error.create("apiUrl is null")),
ob;ba.a.hQe(K,(Sb,kc)=>{kc.succeeded?ob.setResult(!0):(ob.setException(Error.create("Network")),ua.ULS.sendTraceTag(537155585,0,10,`InteractiveReportView.CreateApiLoadAndInitializeTask: script ${K} failed to load successfully`))},4,!0);return ob}}fe.bki="&EnableHyperlinks=false";fe.cki="&EmbeddedView=true";fe.Zji="&BIPreview=true";fe.nki="WORKBOOKURL";fe.iki="ServiceName";fe.jki="ExcelServices";fe.$ji="culture";fe.kki="uiculture";fe.Nxi=3E4;fe.Zka=[];Object(fa.a)(fe,"InteractiveReportView",Kb.a,[]);
var qe=a(114),mf=a(977),Me=a(207),Af=a(81);class Bf extends qe.a{constructor(K,ob){super(K,ob)}execute(K){const ob=Object(sb.a)(7,K.Fe),Sb=ib.a.current.mL;K.activityState[Af.a.wM]=Af.a.p$a;K.activityState[Af.a.L2]=Bf.Tch(ob,Sb.OfferPowerBiTrialUrl,Sb.OfferPowerBiTrialCompleteSignUpParameter);K.activityState[Af.a.eWc]=!0;ob.il.kz("PowerBiTrial");return 3}static Tch(K,ob,Sb){K=new Sys.StringBuilder(K.isEditMode?K.workbookContext.FullDocumentInfo.HostEditUrl:K.workbookContext.FullDocumentInfo.HostViewUrl);
Me.a.Yk(K,mf.a.K$i,"1");K=encodeURIComponent(K.toString());return`${ob}&${"ru"}=${Sb}${encodeURIComponent(`?${"returnUrl"}=${K}`)}`}}Object(fa.a)(Bf,"OfferPowerBiTrialActivity",qe.a,[]);class He extends Ke.a{constructor(){super();this.Fb()}create(){this.ob(new Bf(sd.a.bXd,sd.a.b0))}static ka(K){K.da.Ga(79,new He)}}Object(fa.a)(He,"OfferPowerBiTrialFactory",Ke.a,[]);var Cf=a(1292),Qf=a(76),Qg=a(58),ah=a(583);const ng=(K,ob,Sb,kc,yc,bd,Fd,Nd=null)=>{Nd=K.Na(41,Nd);Nd.activeCell=ob;Nd.showDrillInIndicator=
Sb;return za.g(K,"PivotTableShowExpandButton",Nd,kc,yc,bd,Fd,0)},Ya=(K,ob,Sb,kc,yc,bd,Fd=null)=>{Fd=K.Na(41,Fd);Fd.activeCell=ob;return za.g(K,"PivotTableShowDetails",Fd,Sb,kc,yc,bd,0)},yb=(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd,je=null)=>{je=K.Na(41,je);je.activeCell=ob;je.option=Sb;je.userInputText=kc;je.userInputInt=yc;return za.g(K,"PivotTableSettingsPaneOperations",je,bd,Fd,Nd,Rd,0)};class Wb{constructor(K){this.activeCell=this.kc=null;this.b_i=ob=>{na.a(ob)||(ob=this.$.xa.getItemByName(ob.Result.toString()),
hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7288763_FixGarbageSheetNameValueShowDetails")?(null===ob||void 0===ob?0:ob.name)&&ob.activate():ob&&ob.activate(),ob=document.querySelector(".ewa-stb-tabs .tab-active"),this.ZUj(ob))};this.HTi=ob=>{ob&&!nd.a.Zf(ob.Errors)&&this.Hvd(ob.Result)};this.GTi=()=>{};this.JTi=ob=>{ob&&!nd.a.Zf(ob.Errors)&&this.Ivd(ob.Result)};this.ITi=()=>{};this.FTi=(ob,Sb)=>{ob&&!nd.a.Zf(ob.Errors)&&this.Dvd(ob.Result,Sb)};this.ETi=()=>{};this.$=K;this.ha=Ja.h(this.$).ha}nc(){return!1}executeCommand(K,
ob,Sb){K=ub.TaskExtensions.Rj();const kc=ob.command,yc=this.$.pa.ya;let bd=null,Fd=1;const Nd=this.$.pa.ya.Wb();this.activeCell=Ea.o(this.ha.ra.activeCell,this.$);this.kc=Ja.h(this.$).Bb.zp(this.ha.ra.activeCell);switch(kc){case 498319061:ua.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.kc)return K;bd=(Rd,je,$e)=>ng(yc,this.activeCell,!this.kc.showDrillIndicators,Rd,je,$e,null,Nd);Fd=218;break;case 1529441790:ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,
441,442,0),Rd=>{(Rd=Rd.result)&&Rd.GIj()},this.$.la,3);break;case -1556797033:this.kc&&this.fid(this.HTi,this.GTi);break;case -1611233597:this.kc&&this.fid(this.JTi,this.ITi);break;case 786260386:this.kc&&(Sb=Number.parseInvariant(Sb.MenuItemId),this.fid(this.FTi,this.ETi,Sb));break;case 1771091375:this.showDetails();break;default:K=Jd.a(kc)}bd&&(K=Qd.a(this.$.userOperationManager,bd,Rd=>new Od.a(Fd,0,Rd,void 0,null),ob));return K}wc(K,ob){K=!1;switch(ob.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:K=
!0;break;case 1771091375:K=hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return K}Jc(){return!1}dispose(){this.$=null}showDetails(){Qd.a(this.$.userOperationManager,(K,ob,Sb)=>Ya(this.$.pa.ya,this.activeCell,ab.b(K,this.b_i),ob,Sb,null),K=>new Od.a(262,0,K,void 0,null),null)}ZUj(K){const ob=wf.a.instance.Ub("Common.ISystemInitiatedFeedback");ob&&K?(ob.execute(Sb=>{Sb.logActivity("TeachingUIForShowDetails",null)}),ua.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):
ua.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}fid(K,ob,Sb=0){this.$.userOperationManager.Kc(new Od.a(1016,0,(kc,yc,bd)=>za.q(this.$.pa.ya,this.activeCell,this.kc.externalSourceIndex,this.kc.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,ab.b(kc,K),ab.a(yc,ob),bd,0!==Sb?Sb:null,null,!0),16),null)}Hvd(K){if(this.bud(K))if(this.cud(K)){var ob=K.PivotFields[0];if(this.Ytd(ob)){var Sb={};Sb.FieldId=ob.IdString;Sb.Location=
this.activeCell;Sb.DataSourceIndex=this.kc.externalSourceIndex;Sb.SelectedFieldIndex=ob.SortByValueIndex;var kc=ob.DisplayString;kc.length>Cf.n&&(kc=kc.substring(0,Cf.n)+"...");Sb.ColumnName=ha.a.Eg(kc);Sb.SortAscend=ob.IsSortedAscending&&ob.IsSortedByValue;K=Object(Oe.a)(new ah.a,{pivotName:this.kc.pivotTableName,jOb:Sb,lua:this.Yja(K.PivotDataItems,!1),mua:this.Yja(K.PivotDataItems,!0)});this.$.Xc(-1681601147,Qf.a.Db,0,{["launchSortByValueDialogCommandData"]:K})}else this.vj(155,"AutoFilterSortByValueIncorrectSelection")}else this.vj(750,
"SortByValueNoDataFields")}Ivd(K){if(this.bud(K))if(this.cud(K)){var ob=K.PivotFields[0];if(this.Ytd(ob)){var Sb={};Sb.FilterType=Cf.e;Sb.AdvancedFilter=K.AdvancedFiltering;Sb.Location=this.activeCell;Sb.DataSourceIndex=this.kc.externalSourceIndex;Sb.MaxCount=Cf.a;Sb.Title=ob.DisplayString;Sb.IsPivotFilter=!0;Sb.FieldId=ob.IdString;Sb.AnchorType=0;(ob=ob.FilterParameter)?(Sb.Count=0<ob.FilterValue?ob.FilterValue.toString():"",Sb.Top=ob.IsTopFilter,Sb.Type=ob.FilterType,Sb.SelectedFieldIndex=Cf.g(K.PivotDataFields,
ob.DataFieldId)):(Sb.Count=Cf.b,Sb.Top=!0,Sb.Type=1,Sb.SelectedFieldIndex=Cf.o);ob=new Zc.a(856841605,Qf.a.Db,this.$.Hc,0,null);var kc={};kc.Top10FilterParameters=Sb;kc.PivotName=this.kc.pivotTableName;kc.DataFieldIds=this.Yja(K.PivotDataFields,!1);kc.DataFieldNames=this.Yja(K.PivotDataFields,!0);K={};K[Qf.a.lg]=Qg.a.hc(kc);this.$.Ka.Lb(ob,K)}}else this.vj(246,"ValueFilterNoDataFields")}bud(K){return 1===K.PivotFields.length}cud(K){return 0<K.PivotDataFields.length&&0<K.PivotDataItems.length}Ytd(K){return!K.IsDataField&&
!K.IsFieldInPageFilterArea}Dvd(K,ob){if(this.bud(K))if(Cf.m(ob)&&!this.cud(K))this.vj(246,"ValueFilterNoDataFields");else{var Sb=K.PivotFields[0];if(this.Ytd(Sb)){var kc=this.THh(Sb.PivotFilterParameters,ob),yc={};yc.ActiveCompareType=this.Mih(ob);yc.ShowDataFields=Cf.m(ob);yc.FilterType=this.MVh(ob);yc.ValueTypeText=Cf.j(ob);yc.Location=this.activeCell;yc.ColumnName=Sb.DisplayString;yc.IsPivotFilter=!0;yc.IsTimeSlicer=!1;yc.NonNumericCaptionFilteringEnabled=Sb.IsNonnumericCaptionFilteringEnabled;
yc.FieldId=Sb.IdString;yc.AnchorType=0;yc.ControlGroupOrder=Cf.h();yc.ShowWholeDays=Sb.IsDateField&&!Cf.m(ob);yc.EnabledWholeDays=Sb.IsEnabledWholeDays;yc.WholeDays=Sb.IsWholeDays;yc.MemberProperties=!1;yc.SelectedFieldIndex=Cf.o;kc&&(Cf.m(ob)||Sb.IsDataField?(yc.Value1=kc.FilterValue1.toString(),yc.Value2=kc.FilterValue2.toString(),Cf.m(ob)&&(yc.SelectedFieldIndex=Cf.g(K.PivotDataFields,kc.DataFieldId))):(yc.Value1=kc.FilterString1,yc.Value2=kc.FilterString2));ob=new Zc.a(-2042011094,Qf.a.Db,this.$.Hc,
0,null);kc={};kc.CustomFilterParameters=yc;kc.FieldId=Sb.IdString;kc.PivotName=this.kc.pivotTableName;kc.DataFieldIds=this.Yja(K.PivotDataFields,!1);kc.DataFieldNames=this.Yja(K.PivotDataFields,!0);K={};K[Qf.a.lg]=Qg.a.hc(kc);this.$.Ka.Lb(ob,K)}}}Yja(K,ob){const Sb=[];for(let kc=0;kc<K.length;++kc)ob?Sb.push(K[kc].DisplayString):Sb.push(K[kc].IdString);return Sb}Mih(K){switch(K){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;
case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}MVh(K){return Cf.j(K)?Cf.c:Cf.m(K)?Cf.f:Cf.k(K)?Cf.d:""}THh(K,ob){for(let Sb=0;Sb<K.length;++Sb)if(K[Sb].FilterType===ob)return K[Sb];return null}vj(K,ob){K=nd.a.Zc(1,0,0,K,0,0,ob);zc.a(this.$).vj(K)}}Object(fa.a)(Wb,"PivotCommandHandler",null,[165,2]);class Cc extends Vb.a{constructor(K){super(K)}nd(){const K=
ta.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Ya);this.$.ny(()=>{hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?ub.TaskExtensions.Aa(ub.TaskExtensions.Fd([K],this.la),()=>{this.Yc([new Wb(this.$)])},this.la,3):this.Yc([new Wb(this.$)])})}static ka(K){K.da.Ga(345,new Cc(K))}}Object(fa.a)(Cc,"PivotCommandHandlerFactory",Vb.a,[]);class Uc{constructor(K,ob,Sb,kc,yc){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=
0;this.activeCell=K;this.pivotTableName=ob;this.opType=Sb;this.userInputText=kc;this.userInputInt=yc}getActiveCell(){return this.activeCell}}Object(fa.a)(Uc,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[125]);class jd{constructor(){this.nMf=0;this.oMf=null}}Object(fa.a)(jd,"PivotTableSettingsPaneOperationsUserContext",null,[]);class Bd{constructor(){this.onSettingChange=this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=this.isRangeChanged=
!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}}Object(fa.a)(Bd,"PivotTableSettingsTaskPaneProps",null,[]);class he{constructor(K,ob){this.$=K;this.pivotTableSettingsPaneManager=ob}iE(K){$a.UISurfaces.ej().then(ob=>{ob.showTaskPane("PivotTableSettingsTaskPane",this.tu(null,K,!1,!1,!1,null,!1));return null})}Vu(K,ob,Sb,kc,yc,bd,Fd){$a.UISurfaces.ej().then(Nd=>{Nd.updateTaskPane("PivotTableSettingsTaskPane",this.tu(K,ob,Sb,kc,yc,bd,Fd));return null})}GF(){$a.UISurfaces.ej().then(K=>
{K.hideTaskPane("PivotTableSettingsTaskPane",2);return null})}tu(K,ob,Sb,kc,yc,bd,Fd){K=Object(Oe.a)(new Bd,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:K,isRangeChanged:Sb,isNativePivotTable:kc,expandAllByDefault:!0,hasLessThanTwoRowFields:yc,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:Fd,onSaveSectionCollapseState:(Nd,Rd)=>{this.pivotTableSettingsPaneManager.onSaveSectionCollapseState(Nd,Rd)},onSettingChange:(Nd,Rd,je)=>{this.pivotTableSettingsPaneManager.IXi(Nd,
Rd,je,bd)}});if(Wc.a.gd(this.$))return Object(Oe.a)(new Zb.a,{contentProps:K,onOpen:()=>{this.pivotTableSettingsPaneManager.Dy()},onClose:()=>{this.pivotTableSettingsPaneManager.OB()},onManualClose:()=>{this.pivotTableSettingsPaneManager.iEd()},title:Ma.a.instance.ga(1072),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});ob=Object(Oe.a)(new Da.a,{type:"ExcelLegacyTaskPaneProps",container:ob,paneProps:K});return Object(Oe.a)(new Zb.a,{contentProps:ob,onOpen:()=>{this.pivotTableSettingsPaneManager.Dy()}})}}
Object(fa.a)(he,"PivotTableSettingsReactTaskPane",null,[749]);class be{constructor(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=this.altTextSummary=this.altText=null}}Object(fa.a)(be,
"PivotTableSettingsInfo",null,[]);class pd{constructor(){this.enabled=!1;this.caption=this.sheet=this.name=null}}Object(fa.a)(pd,"SlicerConnectionItem",null,[]);class Ze{constructor(K){this.dsc=this.VHb=this.pivotTableSettingsTaskPane=null;this.Hf=!1;this.wda="";this.gAa=!1;this.TNf=0;this.S3=this.jna=this.O6b=this.SNf=null;this.ps=this.oPa=!1;this.JXi=(ob,Sb)=>{if(na.a(ob)){const kc=ob.Errors[0].Description;ob=ob.Errors[0].MessageId;const yc=Sb.nMf;Sb=Sb.oMf;let bd=this.mka();if(!bd||Sb!==bd.pda)if(this.jna&&
Sb===this.jna.pda)bd=this.jna;else{ua.ULS.sendTraceTag(537154689,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${yc}`);return}switch(yc){case 1:bd.pivotTableName=this.wda;break;case 2:bd.rwGrandTotalOn=this.gAa;break;case 3:bd.colGrandTotalOn=this.gAa;break;case 12:bd.errorString=this.wda;break;case 13:bd.nullString=this.wda;break;case 14:bd.saveSourceDataWithFile=this.gAa;break;case 15:bd.refreshOnLoad=this.gAa;break;case 16:bd.altText=this.wda;break;case 17:bd.altTextSummary=
this.wda;break;case 20:bd.indentIncrement=this.TNf}ua.ULS.sendTraceTag(537154688,0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${ob} ${kc} for opType: ${yc}`);this.updateTaskPane(this.mka())}};this.BGb=()=>{this.hideTaskPane(!0)};this.Ama=()=>{const ob=this.gridView.inRangePicker||this.gridView.ri||!!(this.ha.Ne&470);Wc.a.gd(this.$)?(this.nq()&&!ob&&this.Nhg(),this.xEc()):this.Hf&&!ob&&(this.Nhg(),this.S3!==this.jna&&this.S3&&this.updateTaskPane(this.mka(),!0))};this.dr=()=>{Wc.a.gd(this.$)?
(this.nq()&&(this.S3=this.mka()),this.xEc()):this.Hf&&(this.S3=this.mka(),this.updateTaskPane(this.S3))};this.$=K;this.gridView=Ja.h(this.$);this.lii(K);this.ha=this.gridView.ha;this.ha.iH(this.Ama);this.gridView.IC(this.Ama);this.gridView.PT(this.dr);this.sM=Array(6);for(K=0;K<this.sM.length;K++)this.sM[K]=!1}get sectionCollapseStates(){return this.sM}get l_a(){return this.$.dc.b3(4128)&&this.m_a}get m_a(){const K=new dd.a(this.$.xa);return this.$.isEditMode&&K.Td(8192)||!K.ki}GIj(){if(Wc.a.gd(this.$))this.Hf?
(this.ps=!1,this.hideTaskPane(!0)):(this.ps=!0,this.showTaskPane(!0)),this.$.af();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.vg(!this.Hf),this.Hf?this.hideTaskPane(!0):this.showTaskPane(!0);else{const K=ta.GetServiceTaskFactory.Oa(this.$.da,346,347,0),ob=cc.a(this.$);ub.TaskExtensions.Aa(ub.TaskExtensions.Fd([K,ob],this.$.la),()=>{this.pivotTableSettingsTaskPane=K.result;ob.result.yN(this.pivotTableSettingsTaskPane);this.T6();this.pivotTableSettingsTaskPane.vg(!0);this.showTaskPane(!0)},
this.$.la,3)}}onSaveSectionCollapseState(K,ob){this.sM&&0<=K&&K<this.sM.length&&(this.sM[K]=ob)}IXi(K,ob,Sb,kc){let yc=this.O6b,bd=this.S3;if(!bd||kc!==bd.pda)if(this.jna&&kc===this.jna.pda)bd=this.jna,yc=this.SNf;else{ua.ULS.sendTraceTag(537154690,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${K}`);return}switch(K){case 1:this.wda=bd.pivotTableName;ob=255<ob.length?ob.substring(0,255):ob;bd.pivotTableName=ob;break;case 2:this.gAa=bd.rwGrandTotalOn;bd.rwGrandTotalOn=!!Sb;break;
case 3:this.gAa=bd.colGrandTotalOn;bd.colGrandTotalOn=!!Sb;break;case 6:bd.autoFormatOnUpdate=!!Sb;break;case 7:bd.showDrillIndicators=!!Sb;break;case 8:bd.showItemsWithNoDataOnRw=!!Sb;break;case 9:bd.showItemsWithNoDataOnCol=!!Sb;break;case 10:bd.displayErrorString=!!Sb;break;case 11:bd.displayNullString=!!Sb;break;case 12:this.wda=bd.errorString;bd.errorString=ob;break;case 13:this.wda=bd.nullString;bd.nullString=ob;break;case 14:this.gAa=bd.saveSourceDataWithFile;bd.saveSourceDataWithFile=!!Sb;
break;case 15:this.gAa=bd.refreshOnLoad;bd.refreshOnLoad=!!Sb;break;case 16:this.wda=bd.altText;bd.altText=ob;break;case 17:this.wda=bd.altTextSummary;bd.altTextSummary=ob;break;case 20:this.TNf=bd.indentIncrement,bd.indentIncrement=Sb}ua.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${K}`);this.$.userOperationManager.Kc(new Od.a(225,0,(Fd,Nd,Rd)=>{const je=new jd;je.nMf=K;je.oMf=kc;return yb(this.$.pa.ya,yc,K,ob,Sb,ab.b(Fd,this.JXi),Nd,Rd,je)},64,()=>new Uc(yc,bd.pivotTableName,
K,ob,Sb)),null)}lii(K){this.VHb=new he(K,this)}T6(){this.dsc=this.pivotTableSettingsTaskPane.UM();this.pivotTableSettingsTaskPane.AM(this.BGb)}dispose(){this.ha.rL(this.Ama);this.gridView.cE(this.Ama);this.gridView.vO(this.dr);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.wO(this.BGb),this.pivotTableSettingsTaskPane=this.dsc=null);this.sM=this.VHb=null}Dy(){this.O6b=Ea.o(this.ha.ra.activeCell,this.$);this.S3=this.mka();this.updateTaskPane(this.mka())}OB(){this.hideTaskPane()}iEd(){this.ps=
!1;this.hideTaskPane(!0);this.$.af()}nq(){return this.l_a&&this.ps}Es(){const K=Ja.h(this.$).Bb.zp(this.ha.ra.activeCell);return!(this.ha.Ne&470)&&!!K&&!K.eOa(!0)&&this.ps}showTaskPane(K=!1){K&&(this.oPa=!0,ua.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user."));this.Hf=!0;this.VHb.iE(this.dsc)}updateTaskPane(K,ob=!1){if(this.Hf&&K&&!K.eOa(!0)){var Sb=new be;Sb.pivotTableName=K.BJd;Sb.colGrandTotalOn=K.colGrandTotalOn;Sb.rwGrandTotalOn=K.rwGrandTotalOn;Sb.indentIncrement=
K.indentIncrement;Sb.autoFormatOnUpdate=K.autoFormatOnUpdate;Sb.showDrillIndicators=K.showDrillIndicators;Sb.showItemsWithNoDataOnRw=K.showItemsWithNoDataOnRw;Sb.showItemsWithNoDataOnCol=K.showItemsWithNoDataOnCol;Sb.displayErrorString=K.displayErrorString;Sb.errorString=K.errorString;Sb.displayNullString=K.displayNullString;Sb.nullString=K.nullString;Sb.saveSourceDataWithFile=K.saveSourceDataWithFile;Sb.refreshOnLoad=K.refreshOnLoad;Sb.altText=K.altText;Sb.altTextSummary=K.altTextSummary;Sb.slicerConnections=
this.dLj(K.slicerConnections);this.VHb.Vu(Sb,this.dsc,ob,!K.isOlap,!K.yL||2>K.yL.length,K.pda,this.oPa);this.oPa=!1}}hideTaskPane(K=!1){this.Hf=!1;this.VHb.GF();K&&ua.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}dLj(K){const ob=new gb.a;if(K)for(let Sb=0;Sb<K.length;Sb++){const kc=K[Sb],yc=new pd;yc.name=kc.Name;yc.caption=kc.Caption;yc.sheet=kc.WorksheetName;yc.enabled=kc.Enabled||!1;ob.add(yc)}return ob.toArray()}mka(){return this.gridView.Bb.zp(this.ha.ra.activeCell)}xEc(){this.nq()&&
this.Es()?this.Hf?this.S3!==this.jna&&this.S3&&this.updateTaskPane(this.mka(),!0):this.showTaskPane():this.Hf&&this.hideTaskPane()}Nhg(){this.SNf=this.O6b;this.jna=this.S3;this.O6b=Ea.o(this.ha.ra.activeCell,this.$);this.S3=this.mka()}}Object(fa.a)(Ze,"PivotTableSettingsPaneManager",null,[711,2]);class hf extends Ke.a{constructor(K){super();this.$=K;this.Fb()}create(){this.ob(this.$.da.za(441)||this.$.da.Ga(441,new Ze(this.$)))}static ka(K){K.da.Ga(442,new hf(K))}}Object(fa.a)(hf,"PivotTableSettingsPaneManagerFactory",
Ke.a,[]);class k{}k.Oyh="ewa-ptsp-pane";k.Nyh="ewa-ptsp-header";k.Pyh="ewa-ptsp-title";k.Lyh="ewa-ptsp-body";k.Myh="ewa-ptsp-close-button";Object(fa.a)(k,"CssClassNames",null,[]);const Qb=k.Oyh,tc=k.Nyh,Jc="cui-taskPaneTitle "+k.Pyh,od=k.Lyh,Hd=k.Myh;class Md extends fb.a{constructor(K,ob,Sb){super(K);this.hEe=this.Qd=null;this.wq=0;this.ps=!1;this.Bc=(kc,yc)=>{yc.Lf||this.vg(!1)};this.mk=()=>{this.vg(!1);this.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};this.$=ob;this.taskPaneManager=
Sb;this.$.dk(this.Bc);this.ha=Ja.h(this.$).ha;Fa.a(ob).ai(this)}MP(K){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",K)}$R(K){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",K)}AM(K){this.addHandler("PivotTableSettingsTaskPaneClosed",K)}wO(K){this.removeHandler("PivotTableSettingsTaskPaneClosed",K)}get isVisible(){return super.isVisible}set isVisible(K){super.isVisible!==K&&(super.isVisible=K)}get Ff(){return this.isVisible}get de(){return mb.a.F5i}get ih(){return 14}get dl(){return Jb.a.WUe}get vN(){return Ma.a.instance.ga(1072)}get titleText(){return Ma.a.instance.ga(1072)}get Lp(){return 320}get isResizable(){return!0}get mc(){return this.domElement}get height(){return this.taskPaneManager.YO.offsetHeight}get l_a(){return this.$.dc.b3(4128)&&
this.m_a}get m_a(){const K=new dd.a(this.$.xa);return this.$.isEditMode&&K.Td(8192)||!K.ki}nq(){return this.l_a&&this.ps}Es(){const K=Ja.h(this.$).Bb.zp(this.ha.ra.activeCell);return!(this.ha.Ne&470)&&!!K&&!K.eOa(!0)&&this.ps}JR(){}sj(){}Wj(){}WQ(){return!1}dispose(){this.$&&this.$.Jl(this.Bc);this.Qd&&(La.a.instance.Ba(Mb.a.click,this.Qd,this.mk),Tc.KeyInputManager.instance.Vv(this.Qd,this.hEe));this.Qd=this.taskPaneManager=this.$=null;super.dispose()}gg(K,ob){if(!ob){K=rb.DOMElementExtensions.getElementById(this.domElement,
"PivotTableName");if(!K&&(K=rb.DOMElementExtensions.wm(this.domElement.querySelectorAll(rb.DOMElementExtensions.Ir)),!K))return!1;rb.DOMElementExtensions.setFocus(K)}return!ob}lh(K){return rb.DOMElementExtensions.xf(this.mc,K)}vg(K){this.ps=K;const ob=this.taskPaneManager;this.isVisible=K;this.taskPaneManager.pA();const Sb=!!this.taskPaneManager.nh&&14===this.taskPaneManager.nh.taskPane.ih;K&&0<ob.dC.length&&(!Sb||ob.isCollapsed)&&ob.qG(this,!0);this.$.af()}UM(){const K=document.getElementById(this.$.Eb+
eb.a.IGd);var ob=this.uH();K.appendChild(ob);ob=ec.b("div","PivotTableSettingsPaneBodyId",od);K.appendChild(ob);return ob}uH(){const K=ec.b("div","PivotTableSettingsPaneHeaderId",tc),ob=ec.b("span","PivotTableSettingsPaneTitleId",Jc);ob.innerText=this.titleText;this.Qd=id.a.pb("PivotTableSettingsPaneCloseButtonId",Hd,Ma.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.Qd.classList.add(Gd.AFrameworkApplication.isRtl?eb.a.Waa:eb.a.Xaa);La.a.instance.ta(Mb.a.click,this.Qd,this.mk);this.hEe=Tc.KeyInputManager.instance.Ms(this.Qd,
this.mk,Wd.a.Sh);K.appendChild(ob);K.appendChild(this.Qd);return K}static ka(K,ob){var Sb=K.Eb;let kc=document.getElementById(Sb+eb.a.IGd);kc||(kc=document.createElement("div"),kc.id=K.Eb+eb.a.IGd,kc.classList.add(Qb),document.getElementById(Sb+eb.a.BR).appendChild(kc));Sb=K.da;return Sb.za(346)||Sb.Ga(346,new Md(kc,K,ob))}}Object(fa.a)(Md,"PivotTableSettingsTaskPane",fb.a,[710,2,263,39]);class ce extends Ke.a{constructor(K){super();this.gh=this.xi=null;this.$=K;this.Fb()}get RD(){this.xi||(this.xi=
ub.TaskExtensions.Aa(cc.a(this.$),K=>{this.gh=Md.ka(this.$,K.result)},this.la,3));return this.xi}create(){const K=ta.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),ob=ta.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);ub.TaskExtensions.Aa(ub.TaskExtensions.ts(ub.TaskExtensions.Fd([K,ob],this.la),()=>this.RD,this.la),()=>{this.ob(this.gh)},this.la,3)}dispose(){this.gh=this.xi=this.$=null;super.dispose()}static ka(K){K.da.Ga(347,new ce(K))}}Object(fa.a)(ce,"PivotTableSettingsTaskPaneFactory",
Ke.a,[]);class ne extends Vb.a{constructor(K){super(K)}nd(){ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.create(this.$.da,472,this.la,this.Ya),()=>{const K=this.$.da.za(13);this.Yc([K])},this.$.la,3)}static ka(K){Vb.a.Nd(78,new ne(K))}}Object(fa.a)(ne,"BICommandHandlerFactory",Vb.a,[]);var Qe=a(640),Le=a(38),Ff=a(819),Sf=a(319),jg=a(432),Xf=a(419);class ff{constructor(K,ob){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=K;this.pivotTableName=ob}}Object(fa.a)(ff,"MacroRecorderPivotTableRefreshedPayload",
null,[125]);var Xg=a(394);class Ah extends Xg.a{constructor(K,ob,Sb,kc,yc=Xg.a.g8c,bd=null){super(K,ob,Sb,kc,yc,bd)}get Mza(){return 4}get pLb(){return!!(this.flags&64)}}Object(fa.a)(Ah,"DepartableRefreshWebMethodOperation",Xg.a,[]);var ue=a(154);class Wf extends ue.ErrorDialog{constructor(K,ob){super(K,Wf.PQ(ob))}vq(){super.vq();this.Yoa=String.format(Ma.a.instance.Ua(7),null)}static PQ(K){const ob=nd.a.Zc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");ob.Description=K;ob.HelpDescription=Ma.a.instance.ga(1313);
ob.HelpTopicId=Ff.a.p4c;return ob}}Object(fa.a)(Wf,"DataRefreshConfirmationDialog",ue.ErrorDialog,[]);const Aa=(K,ob,Sb,kc,yc,bd,Fd,Nd,Rd)=>{const je=Nd?"RefreshAllDirtyDataSources":"RefreshAll";Rd=K.Na(1,Rd);const $e=Rd.context;$e.RequestId=Sb;$e.CompleteResponseTimeout=kc;Rd.periodic=ob;return za.g(K,je,Rd,yc,bd,Fd,Nd,ob?8:0)};var Ca=a(345);class sc extends bb.a{constructor(K){super();this.Zrc=null;this.icb=!1;this.qAa=null;this.KKd=!1;this.Sa=new Le.a;this.Mx=null;this.zCg=new Map;this.uQa=new Map;
this.rXb=[];this.Wz=(Sb,kc)=>{2===kc.Mr?this.uQa.clear():1===kc.Mr&&this.uQa&&this.uQa.forEach((yc,bd)=>{kc.Qf==yc&&this.uQa.delete(bd)})};this.mki=Sb=>{this.CZc(Sb.Ea)};this.M0g=()=>{this.tSd(0);this.ESf(!0,null,!1)};this.DXi=Sb=>{Sb.RequestId||(this.ibb=null,this.$.ea.Qo(Sb.Errors))};this.EXi=Sb=>{this.ibb=null;Sb=de.a.Oe(Sb.data);this.$.ea.Qo(Sb)};this.FGf=Sb=>{this.GGf(Sb);(Sb.DepartableWebMethodOperationCompleted||Sb.Errors&&0<Sb.Errors.length)&&this.Sa.raiseEvent("refreshAllCompleted",Sb,this)};
this.WTi=Sb=>{Sb&&!na.a(Sb)&&(!(Sb=Sb.Result)||1>Sb.length||(this.Mx&&this.Mx.cancel(),this.Mx=new Qe.a,this.rfg(Sb,0,this.Mx.token)))};this.VTi=Sb=>{ua.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");Sb=de.a.Oe(Sb.data);this.$.ea.Qo(Sb)};this.Pc=()=>{this.Vod()};this.bG=()=>{hd.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.Vod()};this.N$a=(Sb,kc)=>{const yc=kc.jd.block;var bd=yc.je.PeriodicRefreshExpiryInSeconds;
void 0!==bd&&this.U4f(bd);bd=Ja.h(this.$);5===yc.state&&Sb===bd.Ea&&((Sb=(Sb=bd.MG(kc.jd.hash))?Sb.pf:null)&&!Sb.Ad(bd.ha.ra.activeCell)||this.Vod())};this.Tc=()=>{this.$.ea.Zb||this.clear()};this.$=K;this.AGd=-1;this.ibb=null;K=Ja.h(this.$);const ob=K.ha;ob.QE(this.Pc);ob.lha(this.Pc);K.Ea.mha(this.N$a);this.$.xa.zsa(this.bG);this.$.Cb.zsa(this.bG);this.$.userOperationManager.xr(this.Wz);this.CZc(K.Ea);this.CZc(Ab.a(this.$).Ea);this.$.da.$a(36,this.mki);this.$.ea.Tj(this.Tc);K=this.$.va.StartupDelayMultiplierForLabelsOnRefreshOnOpen*
this.$.va.TimeToWaitForApplyingSensitivityLabels;ua.ULS.sendTraceTag(537163332,306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${K} ms.`);Bc.a.instance.create(()=>{this.vQb()},K,Qa.a.mjh,!0,!0)}kse(K){this.Sa.addHandler("refreshCompleted",K)}Ase(K){this.Sa.addHandler("singleRefreshStarted",K)}hWf(K){this.Sa.removeHandler("singleRefreshStarted",K)}SXc(K){this.Sa.addHandler("singleRefreshCompleted",K)}OMd(K){this.Sa.removeHandler("singleRefreshCompleted",K)}get Fjc(){return!!this.CLa()||
this.jGe()||this.kti()}get TSf(){return this.rXb}get FKd(){return this.zCg}get confirmationRequired(){return this.$.dc.refreshConfirmationRequired}nc(){return!1}executeCommand(K,ob,Sb,kc){K=ob.command;switch(K){case -1193102612:this.ESf(!1,ob,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===Sb.SourceControlId);break;case 2054778433:this.refreshSelected(ob,kc);break;default:return Jd.a(K)}return db.Task.Ta(!0)}wc(K,ob){K=!1;switch(ob.command){case 2054778433:case -1193102612:K=!0}return K}Jc(){return!1}dispose(){if(this.$){const K=
Ja.h(this.$),ob=K.ha;ob.JI(this.Pc);ob.Ana(this.Pc);this.$.Cb.FAa(this.bG);this.$.xa.FAa(this.bG);this.$.userOperationManager.mo(this.Wz);K.Ea.gr(this.N$a);K.Ea.zcb(this.N$a);Ab.a(this.$).Ea.gr(this.N$a);this.$.da.za(36)&&this.$.da.za(36).Ea.gr(this.N$a);this.$.ea&&this.$.ea.qk(this.Tc)}this.clear();sa.a.qc([this.Zrc,this.Sa]);this.$=this.Sa=null;super.dispose()}lWj(K,ob,Sb,kc){this.$.ea.Zb&&this.$.userOperationManager.Kc(new Od.a(603,0,(yc,bd,Fd)=>le.f(this.$.pa.ya,K,ob,Sb,ab.b(yc,Nd=>{Nd=Nd.Result;
null===Nd||""===Nd.DataConnectionName||-1===Nd.ExternalSourceIndex?this.AVd():this.jcb(Nd.DataConnectionName,Nd.ExternalSourceIndex,kc)}),ab.a(bd,Nd=>{ua.ULS.sendTraceTag(509696077,306,15,"DataRefreshManager::onGetConnectionNameFailure");this.AVd();Nd=de.a.Oe(Nd.data);this.$.ea.Qo(Nd)}),Fd,null,null),80,()=>new Xf.a),null)}jcb(K,ob,Sb){if(this.$.ea.Zb){var kc=yc=>{var bd=null;if(this.qAa&&Object(hb.a)(zb.PivotTableRange,this.qAa)){const Fd=this.qAa;bd=()=>new ff(Fd.pda,Fd.pivotTableName)}bd=this.$.userOperationManager.Kc(new Ah(50,
0,(Fd,Nd,Rd,je)=>{var $e=this.$.pa.ya.Wb();$e.FlightHolder=this.$.va.FlightHolder;null==Fd&&this.FKd.set(K,$e.ClientRequestId);var Xe=this.$.pa.ya;Nd=ab.b(this.d2h(K),Nd);$e=Xe.Na(1,$e);const ig=$e.context;ig.RequestId=Fd;ig.CompleteResponseTimeout=2E3;$e.connectionName=K;$e.externalSourceIndex=ob;$e.userAadToken=yc;return za.g(Xe,"Refresh",$e,Nd,Rd,je,null,0)},68,250,bd),Sb);this.uQa.set(K,bd);this.j_i(K)};if(hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1)){const yc=ta.GetServiceTaskFactory.Oa(this.$.da,470,471,0);ub.TaskExtensions.Aa(yc,bd=>{bd.result.U0h(K).then(Fd=>{kc(Fd)},Fd=>{ua.ULS.sendTraceTag(520680469,0,10,`DataRefreshManager.RefreshConnection: failed to get power query aad token ${Fd}`)})},this.$.la,3)}else kc(null)}}Sx(K,ob){var Sb=null;if(this.confirmationRequired&&K)if(this.icb)ob(!0);else if(Sb=Sb||sc.mGi,hd.EwaSettings.Mz()){K=nd.a.Zc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");K.Caption=Ma.a.instance.Ua(7);K.Description=Sb;K.HelpDescription=
Ma.a.instance.ga(1313);K.HelpTopicId=Ff.a.p4c;const kc=new Ca.a(this.$,K);kc.LP(()=>{this.icb=2===kc.returnValue;ob(this.icb)})}else{const kc=new Wf(this.$,Sb);kc.LP(()=>{kc.hide();this.icb=2===kc.returnValue;ob(this.icb)});kc.ug()}else ob(!0)}CLa(){if(!this.KKd){var K=Ja.h(this.$);K=K.getRangeInformation(K.ha.ra.activeCell);for(let ob=0,Sb=K.length;ob<Sb;++ob){const kc=K[ob];if(Object(hb.a)(jg.a,kc)){this.qAa=kc;break}}this.KKd=!0}return this.qAa}vQb(){var K=this.$.pa.ya.Wb(),ob=this.$.pa.ya,Sb=
this.WTi,kc=this.VTi;K=ob.Na(1,K);za.g(ob,"GetSensitivityLabelsForPowerBIDatasets",K,Sb,kc,null,null,4)}zfg(K){return this.uQa.has(K)?(this.$.userOperationManager.tua(this.uQa.get(K)),!0):!1}jGe(){if(hd.EwaSettings.ma(130)){var K=this.$.dc;if(!K||K.inEmbedView||K.inWebPart||K.inViewerFromWebPart)return!1;K=Ja.h(this.$);const ob=K.ha.ra.selectedRanges;for(let Sb=0;Sb<ob.length;Sb++)if(K.Bb.Asd(ob[Sb]))return!0}return!1}AVd(){const K=nd.a.Zc(1,0,0,1496,0,-853845742,"ErrorConnectingToDataSource");zc.a(this.$).Rr([K])}ESf(K,
ob,Sb){if(this.$.ea.Zb){this.rhj();if(0<this.$.workbookContext.LegacyConnections.length){const kc=nd.a.Zc(32,2,1642,1655,0,-73730134,"BB_LegacyConnectionsWarning");kc.HelpDescription=Ma.a.instance.ga(1637);kc.HelpTopicId=Sf.a.Dzi;const yc=ta.GetServiceTaskFactory.Oa(this.$.da,5,4,0);ub.TaskExtensions.Aa(yc,()=>{const bd=yc.result;bd&&bd.kg(33,kc)},this.$.la,3)}K?(K=this.$.pa.ya.Wb(),this.ibb=Aa(this.$.pa.ya,!0,null,0,ab.b(this.DXi,this.FGf),this.EXi,null,null,K)):this.$.userOperationManager.Kc(new Ah(51,
0,(kc,yc,bd,Fd)=>{const Nd=this.$.pa.ya.Wb();Nd.FlightHolder=this.$.va.FlightHolder;let Rd=null;Sb&&(Rd={});return Aa(this.$.pa.ya,!1,kc,2E3,ab.b(this.FGf,yc),bd,Fd,Rd,Nd)},68,250,()=>new Xf.a),ob)}}refreshSelected(K,ob){if(this.$.ea.Zb&&Ub.i(this.$.na)&&!this.cAb()){var Sb=this.CLa();if(!this.jGe()||Sb&&Object(hb.a)(zb.PivotTableRange,Sb))Sb?this.jcb(this.qAa.g9g,this.qAa.externalSourceIndex,K):hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIQueryTablesRefreshSelectedEnabled",
!1)?this.lWj(this.$.xa.na.sheetName,this.$.xa.na.activeCell.top-1,this.$.xa.na.activeCell.left-1,K):this.AVd();else{let kc;K=ta.GetServiceTaskFactory.Oa(this.$.da,271,272,ob.N4());ub.TaskExtensions.Aa(K,yc=>{(kc=yc.result)&&kc.refreshLinkedEntitiesInRange()},this.$.la,3)}}}clear(){this.tSd(0);this.icb=!1;this.AGd=-1;sc.oPc=null;this.ibb&&(Gd.AFrameworkApplication.Bd.Tu(this.ibb.nu),this.ibb=null)}kti(){var K=!1,ob=Ja.h(this.$).ha;2===ob.Ne&&(K=ob.Ra.$b,ob=(null===K||void 0===K?0:K.floatingObject)?
K.floatingObject.Vc:null,K=K.Ry&&!!ob&&!!(ob.Attributes&4));return K}cAb(){return 2===Ja.h(this.$).ha.Ne}Vod(){this.KKd=!1;this.qAa=null}tSd(K){let ob=0<K;!ob||this.$.ea.Zb&&this.$.dc.allowPeriodicDataRefresh||(ob=!1);sa.a.Ia(this.Zrc);this.Zrc=null;ob&&(this.Zrc=Bc.a.instance.eD(this.M0g,K,Qa.a.kjh))}GGf(K){hd.EwaSettings.isChangeGateEnabled("OfficeVSO:6837645_SensitivityLabelOnRefreshCompleted")?K.RequestId||(this.Sa.raiseEvent("refreshCompleted",K,this),this.vQb()):(K.RequestId||this.Sa.raiseEvent("refreshCompleted",
K,this),this.vQb())}d2h(K){return ob=>{var Sb;this.GGf(ob);ob&&(ob.DepartableWebMethodOperationCompleted||ob.Errors&&0<ob.Errors.length)&&(Array.remove(this.rXb,K),ob.Result=null!==(Sb=ob.Result)&&void 0!==Sb?Sb:{},ob.Result.ConnectionName=K,this.Sa.raiseEvent("singleRefreshCompleted",ob,this))}}j_i(K){this.rXb.includes(K)||this.rXb.push(K);this.Sa.raiseEvent("singleRefreshStarted",K,this)}rfg(K,ob,Sb){const kc=ta.GetServiceTaskFactory.Oa(this.$.da,274,275,0);let yc=!1;Sb.IK?ua.ULS.sendTraceTag(537163297,
306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):ub.TaskExtensions.Aa(kc,()=>{if(({t7a:yc}=kc.result.QZc(K,yc)).returnValue)ua.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${ob} attempt.`);else if(yc&&3>ob)if(Sb.IK)ua.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var bd=this.$.va.TimeToWaitForApplyingSensitivityLabels;
ua.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${bd} ms on the ${bd} attempt.`);Bc.a.instance.create(()=>{this.rfg(K,ob+1,Sb)},bd,Qa.a.ljh,!0,!0)}else ua.ULS.sendTraceTag(537163294,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${ob} attempt.  Not scheduling anymore retries.`)},Sb,3)}CZc(K){K.mt(this.N$a);K=K.d5i;0<K&&this.U4f(K)}U4f(K){const ob=
this.$.ea.ye;ob>this.AGd&&(this.AGd=ob,this.tSd(1E3*K))}rhj(){const K=ta.GetServiceTaskFactory.Oa(this.$.da,5,4,0);ub.TaskExtensions.Aa(K,()=>{const ob=K.result;ob&&ob.pla(58)&&ob.removeEntry(58)},this.$.la,3)}static get mGi(){return sc.oPc||(sc.oPc=Ma.a.instance.Ua(8)+"<br /><br />"+Ma.a.instance.Ua(10))}static ka(K){K.da.Ga(13,new sc(K))}}sc.oPc=null;Object(fa.a)(sc,"DataRefreshManager",bb.a,[14,165]);class vd extends Vb.a{constructor(K){super(K)}nd(){ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,
470,471,this.Ya),K=>{this.Yc([K.result])},this.$.la,3)}static ka(K){Vb.a.Nd(472,new vd(K))}}Object(fa.a)(vd,"PowerQueryManagerCommandHandlerFactory",Vb.a,[]);const Td=(K,ob,Sb,kc,yc,bd,Fd,Nd=null)=>{Nd=K.Na(1,Nd);Nd.groupOperation=ob;Nd.groupOperationPayload=Sb;return za.g(K,"EditPowerQueryGroup",Nd,kc,yc,bd,Fd,0)},ye=(K,ob,Sb,kc,yc,bd,Fd,Nd=null)=>{Nd=K.Na(1,Nd);Nd.queryAction=ob;Nd.queryActionPayload=Sb;return za.g(K,"PowerQueryQueryAction",Nd,kc,yc,bd,Fd,0)},df=(K,ob,Sb,kc,yc,bd,Fd=null)=>{Fd=
K.Na(1,Fd);Fd.powerQueryDataSourceConnections=ob;return za.g(K,"WritePowerQueryRoaming",Fd,Sb,kc,yc,bd,4)};var Kf=a(868);class Tf{constructor(K,ob){this.stateId=0;this.IKe=!1;this.Wzg=this.jae=null;this.Lce=!1;this.X$d=null;this.$tc=Sb=>{this.Gjc(Sb)&&this.n1g(Sb)&&this.GI.lb(Sb)&&(Sb=this.GI.getItem(Sb),Ic.a(this.$).jcb(Sb.ConnectionName,Sb.ExternalSourceIndex,null))};this.yf=()=>{const Sb=this.$.ea.Ho.PowerQueryStateId;ua.ULS.sendTraceTag(537154444,0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueriesStateId: ${Sb}, this.stateId: ${this.stateId}`);
Sb>this.stateId&&this.pva().continueWith(kc=>{kc.result?this.stateId=Sb:ua.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})};this.Oo=()=>{this.pva()};this.S_j=Sb=>{if(Sb&&!na.a(Sb)){Sb=Sb.Result;if(Sb.Queries){this.Nbb.clear();for(var kc of Sb.Queries)try{this.Nbb.add(kc.Name,kc)}catch(yc){ua.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.jae=Sb.QueryGroups;
ua.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():"null"}`);if(Sb.PowerQueryConnectionsInfo){this.GI.clear();kc=[];for(const yc of Sb.PowerQueryConnectionsInfo)try{this.GI.add(yc.QueryName,yc)}catch(bd){ua.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),kc.push(yc.QueryName)}kc.forEach(yc=>{this.GI.remove(yc)})}this.X$d=Sb.Formulas;this.IKe=!0}};this.tDd=
()=>{ua.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.YEd=Sb=>{this.Sa.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",Sb)};this.O0i=Sb=>{this.Sa.raiseEvent("OnUpdatePowerQueryDataFailed",Sb)};this.SPa=(Sb,kc)=>{if(kc&&kc.Result&&kc.Result.PowerQueryRefreshChallengeResult){if(!kc.Result.ConnectionName)throw Error.argumentNull;this.$.Ka.Lb(new Zc.a(-1496653501,0,this.$.Hc,0,null),{["kind"]:kc.Result.PowerQueryRefreshChallengeResult.Kind,["path"]:kc.Result.PowerQueryRefreshChallengeResult.Path,
["queryName"]:this.i6e(kc.Result.ConnectionName)})}};this.r0e=Sb=>{ua.ULS.sendTraceTag(520734801,0,50,"PowerQueryManager:GetToken: Token requested for PQO service");try{return this.wFb.UL("PowerQueryWeb",null!==Sb&&void 0!==Sb?Sb:this.$.va.PowerQueryAudienceUri).then(kc=>{if(kc.IsSuccess)return ua.ULS.sendTraceTag(520734800,0,50,"PowerQueryManager.getAuthToken: successfully fetch token."),kc.Token;ua.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. Error code: ${kc.ErrorCode}, Error message : ${kc.ErrorMessage}`);
return Promise.resolve(null)},()=>{ua.ULS.sendTraceTag(520734798,0,15,"PowerQueryManager.getAuthToken: got rejected promise, use fallback value");return Promise.resolve(null)})}catch(kc){return ua.ULS.sendTraceTag(520734797,0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${kc}`),Promise.resolve(null)}};this.$=K;this.wFb=ob;this.Nbb=new Lb.a(!1);this.kCg=new Lb.a(!1);this.Sa=new Le.a;this.$.ea.mu(this.yf);this.$.ea.zM(this.Oo);this.$.ea.Ho&&(this.stateId=this.$.ea.Ho.PowerQueryStateId);
hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&Ic.a(this.$).SXc(this.SPa);wf.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Sb=>{Sb.isFeatureEnabled("ExcelPowerQuery",!1).then(kc=>{this.Lce=kc;return null})})}get ssi(){return this.Lce}get queries(){return this.Nbb.values}get groups(){return this.jae}get Hpf(){return this.Wzg}get formulas(){return this.X$d}get GI(){return this.kCg}oPg(K){this.Sa.addHandler("OnUpdatePowerQueryDataKeySucceeded",
K)}Glj(K){this.Sa.removeHandler("OnUpdatePowerQueryDataKeySucceeded",K)}Gjc(K){if(this.Nbb.lb(K)){const ob=this.Nbb.getItem(K);if(1!==ob.FillObjectType&&!ob.LoadedToDataModel&&this.GI.lb(K))return!0}else ua.ULS.sendTraceTag(537154446,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1}pva(){const K=new cf.a;this.$.userOperationManager.Kc(new Od.a(587,0,(ob,Sb,kc)=>Kf.c(this.$.pa.ya,ab.b(ob,this.S_j,this.YEd,()=>{K.setResult(!0)}),ab.a(Sb,this.tDd,this.O0i,()=>{K.setResult(!0)}),
kc,null),80,()=>new Xf.a),null);return K.task}eBe(K){if(this.GI.lb(K)){K=this.GI.getItem(K).ConnectionName;const ob=Ic.a(this.$).FKd;if(ob&&ob.has(K))ua.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),K=ob.get(K),za.h(this.$.pa.ya,K,null,null,null);else if(!Ic.a(this.$).zfg(K))return ua.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),!1}return!0}handleQueryGroupOperation(K,
ob){const Sb=hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7223121_EstimatePowerQueryGroupOperation")&&hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1);Sb&&this.Uth(K,ob);this.$.userOperationManager.Kc(new Od.a(1023,0,(kc,yc,bd)=>Td(this.$.pa.ya,K,ob,Sb?ab.b(Fd=>{0<Fd.Errors.length&&this.pva()},kc):kc,Sb?ab.a(()=>{this.pva()},yc):yc,bd,null),4),null)}Uth(K,ob){let Sb=this.groups.find(kc=>kc.Id===ob.Id);if(Sb){switch(K){case 3:this.Zth(ob,
Sb);break;case 2:this.Tth(ob);break;case 4:this.Wth(ob,Sb);break;default:return}this.YEd(void 0,void 0,void 0)}else ua.ULS.sendTraceTag(509752481,0,10,"PowerQueryManager.estimateGroupOperation: Group not found")}Zth(K,ob){ob.Name=K.Name}Tth(K){let ob=this.groups.findIndex(Sb=>Sb.Id===K.Id);-1===ob?ua.ULS.sendTraceTag(509752480,0,10,"PowerQueryManager.estimateDeleteGroup: Group index not found"):this.groups.splice(ob,1)}Wth(K,ob){const Sb=K.ParentId?K.ParentId:"{00000000-0000-0000-0000-000000000000}";
let kc=-1;this.groups.forEach(yc=>{yc.ParentId===Sb&&yc.Order>kc&&(kc=yc.Order)});ob.ParentId=Sb;ob.Order=kc+1}handleQueryAction(K,ob){this.Yth(K,ob);this.$.userOperationManager.Kc(new Od.a(1023,0,(Sb,kc,yc)=>ye(this.$.pa.ya,K,ob,ab.b(bd=>{0<bd.Errors.length&&this.pva()},Sb),ab.a(()=>{this.pva()},kc),yc,null),68),null)}Yth(K,ob){switch(K){case 2:this.$th(ob);break;default:return}this.YEd(void 0,void 0,void 0)}$th(K){var ob=this.queries.find(Sb=>Sb.Name===K.Name);ob.Name=K.ExtraData;ob.LoadedToDataModel||
((ob=this.GI.getItem(K.Name))?(ob.ConnectionName="Query - "+K.ExtraData,ob.QueryName=K.ExtraData,this.GI.remove(K.Name),this.GI.add(K.ExtraData,ob)):ua.ULS.sendTraceTag(512492568,0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found"))}Jc(){return!1}nc(){return!1}executeCommand(K,ob){K=ub.TaskExtensions.Rj();return-1193102612===ob.command?(this.uej(),K):Jd.a(ob.command)}wc(K,ob){switch(ob.command){case -1193102612:return!0}return!1}U0h(K){return this.i6e(K)?this.r0e():Promise.resolve(null)}dispose(){sa.a.qc([this.Sa]);
hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&Ic.a(this.$).OMd(this.SPa);this.$.ea.Ov(this.yf);this.$.ea.ZR(this.Oo);this.$=null}gIj(K,ob){let Sb=nd.a.Zc(1,2,2201,0,0,K,"PowerQueryRefreshValidationFailed");switch(K){case -1543585732:Sb.MessageIdName="PowerQueryRefreshProtectedSheetFailed";Sb.Description=String.format(Ma.a.instance.Ua(707),ob,Ma.a.instance.ga(2202));break;case 165156185:Sb.MessageIdName="PowerQueryRefreshSheetViewFailed";Sb.Description=
String.format(Ma.a.instance.Ua(707),ob,Ma.a.instance.ga(2203));break;default:ua.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${K}`)}hd.EwaSettings.Mz()?new Ca.a(this.$,Sb):(K=new ue.ErrorDialog(this.$,Sb),K.initialize(),K.ug())}n1g(K){var ob=this.Nbb.getItem(K);return ob?(ob=this.kVh(ob))?(this.gIj(ob,K),!1):!0:(ua.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)}kVh(K){if((K=
this.Y3h(K))&&K.ki)return-1543585732;if(K&&K.Ed.Iv)return 165156185}Y3h(K){let ob=void 0,Sb=void 0;if(3===K.FillObjectType||2===K.FillObjectType)ob=K.FillObjectName.split("!")[0];else if(0==K.FillObjectType){if(!K.FillObjectName)return ua.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),Sb;(K=this.$.Cb.getItemByName(K.FillObjectName))?ob=K.sheetName:ua.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}ob&&
(Sb=this.$.xa.getItemByName(ob));return Sb}uej(){this.IKe?this.FSf(this.queries):this.pva().continueWith(K=>{K.result?this.FSf(this.queries):ua.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fatch queries")})}FSf(K){for(const ob of K)this.$tc(ob.Name)}i6e(K){for(const ob of this.queries)if(this.GI.getItem(ob.Name).ConnectionName===K)return ob.Name;return null}}Object(fa.a)(Tf,"PowerQueryManager",null,[713,165,2]);var Mf=a(695);class pg extends Ke.a{constructor(K){super();
this.$=K;this.Fb()}create(){const K=this.$.da;ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(K,349,350,this.Ya),ob=>{this.ob(Object(Mf.a)(K,470,()=>new Tf(this.$,ob.result)))},this.$.la,3)}static ka(K){K.da.Ga(471,new pg(K))}}Object(fa.a)(pg,"PowerQueryManagerFactory",Ke.a,[]);var Zf;(function(K){K[K.null=-1]="null";K[K.table=0]="table";K[K.connectionOnly=1]="connectionOnly";K[K.pivotTable=2]="pivotTable";K[K.pivotChart=3]="pivotChart"})(Zf||(Zf={}));Object(fa.b)("FillObjectType",Zf);var wg=a(263),
fg=a(346),Lg=a(109);class sg{constructor(){this.name=this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.order=this.level=0;this.parentKey=null}}Object(fa.a)(sg,"GroupInfo",null,[]);class gg{constructor(){this.onLegacyConnectionRefresh=this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}}Object(fa.a)(gg,"PowerQueryTaskPaneCallbacks",null,[]);class lh{constructor(){this.callbacks=this.selectedQueryKey=
this.groups=this.connections=this.queries=this.type=null}}Object(fa.a)(lh,"PowerQueryTaskPaneProps",null,[]);class Hf{constructor(){this.name=null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.refreshEnabled=this.inRefresh=!1}}Object(fa.a)(Hf,"QueryInfo",null,[]);class Mg{constructor(K,ob,Sb){this.Iwa=new Lb.a(!1);this.Hwa=new Lb.a(!0);this.W5a=new Lb.a(!0);this.YLa=this.UR=null;
this.HSf=0;this.onCancelQueryRefresh=kc=>{this.powerQueryManager.eBe(kc)&&this.yXd([kc])};this.handleQueryGroupOperation=(kc,yc)=>{const bd={};bd.Id=yc.id;bd.Name=yc.name;bd.Description=yc.description;bd.ParentId=yc.parentId;hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7213196_PowerQueryPaneManagerCleanUp")?this.powerQueryManager.handleQueryGroupOperation(kc,bd):this.cAa.handleQueryGroupOperation(kc,bd)};this.handleQueryAction=(kc,yc)=>{const bd={};bd.Name=yc.name;bd.ExtraData=yc.extraData;bd.Formulas=
this.powerQueryManager.formulas;this.powerQueryManager.handleQueryAction(kc,bd)};this.$=K;this.cAa=Sb;this.isVisible=!1;this.lcb=new Lb.a(!0);this.OKd={};this.powerQueryManager=ob}N7(){$a.UISurfaces.ej().then(K=>{K.setSelectedTaskPane("PowerQueryTaskPane");return null})}iE(K){this.isVisible=!0;$a.UISurfaces.ej().then(ob=>{ob.showTaskPane("PowerQueryTaskPane",this.A5c(K));return null})}Vu(K,ob,Sb=null,kc=null){if(this.isVisible){var yc=this.A5c(K,ob,Sb,kc);$a.UISurfaces.ej().then(bd=>{bd.updateTaskPane("PowerQueryTaskPane",
yc||this.A5c(K,ob,Sb,kc));return null})}else this.Ejg(ob,Sb)}GF(){this.isVisible=!1;$a.UISurfaces.ej().then(K=>{K.hideTaskPane("PowerQueryTaskPane",2);return null})}jag(K){if(!wg.a.ph(K)){for(const ob of this.UR)K.includes(ob.name)&&(this.lcb.add(ob.name,ob),this.OKd[ob.name]=++this.HSf,ua.ULS.sendTraceTag(537154401,0,50,`Refresh started for query #: ${this.HSf}`));hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.Vu(null,this.powerQueryManager.queries,
this.powerQueryManager.groups):this.Vu(null,null,null)}}yXd(K){if(!wg.a.ph(K)){for(const ob of this.UR)K.includes(ob.name)&&(ob.name in this.OKd&&ua.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.OKd[ob.name]}`),this.lcb.remove(ob.name));hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.Vu(null,this.powerQueryManager.queries,this.powerQueryManager.groups):this.Vu(null,null,null)}}Ejg(K=null,ob=null){hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",
!1)?this.r1j(K,ob):this.q1j(K,ob)}r1j(K=null,ob=null){K&&(this.UR=[],null===K||void 0===K?void 0:K.forEach(Sb=>this.UR.push(this.mJe(Sb))));ob&&(this.YLa=this.Fdh(ob));this.yNf()}q1j(K=null,ob=null){hd.EwaSettings.Qkf()&&ob&&ob.length&&K?(this.Hwa.clear(),this.Iwa.clear(),this.W5a.clear(),this.UR=[],this.YLa=[],this.b8i(ob),this.j8i(K),this.YLa=this.W5c("root",-1).children,this.YLa=this.YLa.concat(this.W5c("Other Queries",0))):K&&(this.Hwa.clear(),this.Iwa.clear(),this.W5a.clear(),this.YLa=this.UR=
null,this.UR=this.nJe(K,0));this.yNf()}A5c(K,ob=null,Sb=null,kc=null){this.Ejg(ob,Sb);ob=Object(Oe.a)(new gg,{onQuerySelected:this.cAa.onQuerySelected,onQueryRefresh:hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7213196_PowerQueryPaneManagerCleanUp")?this.powerQueryManager.$tc:this.cAa.onQueryRefresh,onCancelQueryRefresh:hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7213196_PowerQueryPaneManagerCleanUp")?this.onCancelQueryRefresh:this.cAa.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,
handleQueryAction:this.handleQueryAction});kc=Object(Oe.a)(new lh,{type:"PowerQueryTaskPaneProps",callbacks:ob,queries:this.UR,groups:this.YLa,selectedQueryKey:kc});if(Wc.a.gd(this.$))return Object(Oe.a)(new Zb.a,{contentProps:kc,onOpen:()=>{this.cAa.Dy()},onClose:()=>{this.cAa.OB()},width:320,title:Ma.a.instance.ga(2191)});K=Object(Oe.a)(new Da.a,{container:K,paneProps:kc});return Object(Oe.a)(new Zb.a,{contentProps:K,onOpen:()=>{this.cAa.Dy()}})}yNf(){if(this.UR)for(let ob=0;ob<this.UR.length;ob++){var K=
!1;const Sb=this.UR[ob],kc=this.lcb.getItem(Sb.name);null!=kc&&(K=new Date(Sb.lastRefresh),(K=(new Date(kc.lastRefresh)).getTime()===K.getTime())||this.lcb.remove(kc.name));Sb.inRefresh=K;Sb.refreshEnabled=hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7213196_PowerQueryPaneManagerCleanUp")?this.powerQueryManager.GI.lb(Sb.name):this.cAa.zsd(Sb.name)}}b8i(K){for(var ob of K)K=ob.HasParent?ob.ParentId:"root",this.Iwa.add(ob.Id,ob),this.Lue(ob,K);ob={};ob.Name=Ma.a.instance.ga(2196);ob.Id="Other Queries";
ob.Order=fg.a.QS;this.Iwa.add("Other Queries",ob);this.Iwa.add("root",{Name:"root",Id:"root",Order:0})}j8i(K){for(const Sb of K){K=Sb.GroupID||"Other Queries";var ob=this.Hwa.getItem(K);if("Other Queries"!==K&&ob&&ob.length){ob="SubGroupOtherQueries-"+K;if(!this.Iwa.lb(ob)){const kc={};kc.Name=ob;kc.Id=ob;kc.Order=fg.a.QS;this.Iwa.add(ob,kc);this.Lue(kc,K)}K=ob;Sb.GroupID=ob}ob=[Sb];this.W5a.lb(K)&&(ob=ob.concat(this.W5a.getItem(K)));this.W5a.add(K,ob)}}Lue(K,ob){K=[K];this.Hwa.lb(ob)&&(K=K.concat(this.Hwa.getItem(ob)));
this.Hwa.add(ob,K)}Edh(K,ob){let Sb=[];if(this.Hwa.lb(K)){K=this.Hwa.getItem(K);K.sort((kc,yc)=>Sa.HelperMethods.LB(kc.Order,yc.Order));for(const kc of K)Sb=Sb.concat(this.W5c(kc.Id,ob+1))}return Sb}W5c(K,ob){var Sb=this.Iwa.getItem(K);const kc=this.W5a.getItem(K),yc=Object(Oe.a)(new sg,{});yc.key=Sb.Id;yc.name=Sb.Name;yc.data=Sb.Description;Sb=this.Edh(K,ob);yc.children=this.PDe(Sb);yc.level=ob;yc.count=0;yc.children.length&&(yc.startIndex=yc.children[0].startIndex,yc.count+=Lg.g(yc.children,bd=>
bd.count));kc&&(yc.startIndex=this.UR.length,yc.count+=kc.length,this.UR=this.UR.concat(this.nJe(kc,K.includes("SubGroupOtherQueries-")?ob:ob+1)));return yc}nJe(K,ob){const Sb=[];for(const kc of K)K=this.lcb.lb(kc.Name)&&!hd.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")?this.lcb.getItem(kc.Name):this.mJe(kc,ob),Sb.push(K);return Sb}mJe(K,ob=0){const Sb=new Hf;Sb.name=K.Name;Sb.rowsLoaded=K.RowsLoaded;Sb.lastRefresh=K.LastRefresh;Sb.fillObjectType=
K.FillObjectType;Sb.loadedToDataModel=K.LoadedToDataModel;Sb.queryError=K.QueryError;Sb.nestingDepth=ob;Sb.rowsWithError=K.RowsWithError;Sb.groupKey=K.GroupID;return Sb}Fdh(K){const ob=[];K.forEach(Sb=>{const kc=Object(Oe.a)(new sg,{});kc.key=Sb.Id;kc.name=Sb.Name;kc.order=Sb.Order;kc.parentKey=Sb.ParentId;kc.data=Sb.Description;ob.push(kc)});return ob}PDe(K){const ob=[];for(const Sb of K)K=Object(Oe.a)(new sg,{}),K.key=Sb.key,K.name=Sb.name,K.count=Sb.count,K.startIndex=Sb.startIndex,K.data=Sb.data,
K.children=this.PDe(Sb.children),K.level=Sb.level,ob.push(K);return ob}}Object(fa.a)(Mg,"PowerQueryReactTaskPane",null,[739]);class Rg{constructor(K,ob){this.ysc=this.sda=this.KBc=this.powerQueryTaskPane=null;this.jNf=this.aLf=this.Hf=!1;this.onQuerySelected=Sb=>{for(var kc of this.powerQueryManager.queries)if(kc.FillObjectName&&kc.Name===Sb){3!==kc.FillObjectType&&2!==kc.FillObjectType||Ee.a.contains(kc.FillObjectName,"!",!0)||ua.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${Zf[kc.FillObjectType]} and no ! on FillObjectName`);
3===kc.FillObjectType?(Sb=kc.PivotChartSheetRange,Sb.SheetName=kc.FillObjectName.split("!")[0],kc=kc.FillObjectName.split("!")[1],Ja.h(this.$).ha.Ra.cIa(Sb,kc,0).continueWith(yc=>{yc.result||ua.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(kc=2===kc.FillObjectType?kc.FillObjectName.split("!")[1]:kc.FillObjectName,(kc=this.$.Cb.getItemByName(kc))&&kc.activate());break}};this.AGb=()=>{this.hideTaskPane();this.$.Cb.Bg(this.se)};this.onCancelQueryRefresh=
Sb=>{this.powerQueryManager.eBe(Sb)&&this.sda.yXd([Sb])};this.onQueryRefresh=Sb=>{this.powerQueryManager.$tc(Sb)};this.zsd=Sb=>this.powerQueryManager.GI.lb(Sb);this.iDf=()=>{this.RTi()};this.se=(Sb,kc)=>{kc.na&&2===kc.na.type&&this.EBc.lb(kc.na.name)&&(hd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneMoveGenerateDataStructure",!1)?this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.EBc.getItem(kc.na.name)):this.updateTaskPane(null,null,
this.EBc.getItem(kc.na.name)))};this.IGf=(Sb,kc)=>{Sb=[];for(const yc of this.powerQueryManager.GI.values)if(kc===yc.ConnectionName){const bd=yc.QueryName;if(this.powerQueryManager.Gjc(bd)){Sb.push(bd);break}}this.sda.jag(Sb)};this.SPa=(Sb,kc)=>{if(kc&&kc.Result){Sb=kc.Result.ConnectionName;kc=[];for(const yc of this.powerQueryManager.GI.values)if(Sb===yc.ConnectionName){const bd=yc.QueryName;if(this.powerQueryManager.Gjc(bd)){kc.push(bd);break}}this.sda.yXd(kc)}};this.$=K;this.powerQueryManager=
ob;this.EBc=new Lb.a(!0);this.mii(K);Ic.a(this.$).SXc(this.SPa);Ic.a(this.$).Ase(this.IGf);this.powerQueryManager.oPg(this.iDf);ua.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}vJj(){if(Wc.a.gd(this.$))this.showTaskPane();else if(this.powerQueryTaskPane||this.jNf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.vg(!0),this.showTaskPane());else{this.jNf=!0;const K=ta.GetServiceTaskFactory.Oa(this.$.da,408,409,0),ob=cc.a(this.$);ub.TaskExtensions.Aa(ub.TaskExtensions.Fd([K,
ob],this.$.la),()=>{this.powerQueryTaskPane=K.result;ob.result.yN(this.powerQueryTaskPane);this.T6();this.powerQueryTaskPane.vg(!0);this.showTaskPane()},this.$.la,3)}}mii(K){this.sda=new Mg(K,this.powerQueryManager,this)}T6(){this.ysc=this.powerQueryTaskPane.UM();this.powerQueryTaskPane.AM(this.AGb)}dispose(){Ic.a(this.$).OMd(this.SPa);Ic.a(this.$).hWf(this.IGf);this.powerQueryManager.Glj(this.iDf);this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.wO(this.AGb),this.powerQueryTaskPane=
this.ysc=null);this.sda=null}Dy(){this.powerQueryManager.pva();this.$.Cb.Uf(this.se)}OB(){this.Hf=!1}handleQueryGroupOperation(K,ob){Qd.a(this.$.userOperationManager,(Sb,kc,yc)=>Td(this.$.pa.ya,K,ob,Sb,kc,yc,null),Sb=>new Od.a(1021,0,Sb),null)}showTaskPane(){this.Hf?Wc.a.gd(this.$)&&this.sda.N7():(this.KBc=this.$.Jb.Ac("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.Hf=!0,this.sda.iE(this.ysc))}updateTaskPane(K,ob,Sb){this.sda.Vu(this.ysc,K,ob,Sb);this.KBc&&(this.KBc.stop(),this.KBc=null);
for(K=0;K<this.powerQueryManager.queries.length;K++)ob=this.powerQueryManager.queries[K],0===ob.FillObjectType&&this.EBc.add(ob.FillObjectName,ob.Name),ob.LastRefresh||ua.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")}hideTaskPane(){this.Hf=!1;this.sda.GF()}RTi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,null);this.aLf||(this.DWi(Ic.a(this.$).TSf),this.aLf=!0)}DWi(K){const ob=[];for(const Sb of K)for(const kc of this.powerQueryManager.GI.values)if(Sb===
kc.ConnectionName&&(K=kc.QueryName,this.powerQueryManager.Gjc(K))){ob.push(K);break}this.sda.jag(ob)}}Object(fa.a)(Rg,"PowerQueryPaneManager",null,[730]);class Ng{constructor(K,ob){this.zsc=null;this.$=K;this.x7i=ob}Jc(){return!1}nc(){return!1}executeCommand(K,ob){this.zsc||(this.zsc=new Rg(this.$,this.x7i));K=ub.TaskExtensions.Rj();return 1156885807===ob.command?(this.zsc.vJj(),K):Jd.a(ob.command)}dispose(){this.$=this.zsc=null}wc(K,ob){K=!1;switch(ob.command){case 1156885807:K=hd.EwaSettings.isChangeGateEnabled("OfficeVSO:6320032_PowerQueryTaskPane")}return K}}
Object(fa.a)(Ng,"PowerQueryPaneCommandHandler",null,[165,2]);class Og extends Vb.a{constructor(K){super(K)}nd(){this.$.ny(()=>{hd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,470,471,1),K=>{this.Yc([new Ng(this.$,K.result)])},this.$.la,3):this.Yc([new Ng(this.$,null)])})}static ka(K){Vb.a.Nd(407,new Og(K))}}Object(fa.a)(Og,"PowerQueryPaneCommandHandlerFactory",Vb.a,[]);var Sg=a(138);class Wg{}Wg.xyh="ewa-pqtp-pane";
Wg.wyh="ewa-pqtp-header";Wg.yyh="ewa-pqtp-title";Wg.uyh="ewa-pqtp-body";Wg.vyh="ewa-pqtp-close-button";Object(fa.a)(Wg,"CssClassNames",null,[]);const mh=Wg.xyh,nh=Wg.wyh,wh=Wg.uyh,qh=Wg.yyh,rh=eb.a.yfb+Wg.vyh;class Tg extends fb.a{constructor(K,ob,Sb){super(K);this.eEe=this.Qd=null;this.Tp=!1;this.wq=0;this.Bc=(kc,yc)=>{yc.Lf||this.vg(!1)};this.mk=()=>{this.vg(!1);this.raiseEvent("PQTPC");return!0};this.$=ob;this.taskPaneManager=Sb;Fa.a(ob).ai(this);this.$.dk(this.Bc)}MP(K){this.get_events().addHandler("PQTPR",
K)}$R(K){this.get_events().removeHandler("PQTPR",K)}AM(K){this.addHandler("PQTPC",K)}wO(K){this.removeHandler("PQTPC",K)}get isVisible(){return super.isVisible}set isVisible(K){super.isVisible!==K&&(super.isVisible=K)}get Ff(){return this.isVisible}get de(){return mb.a.w7i}get ih(){return 17}get dl(){return Jb.a.DBh}get vN(){return Ma.a.instance.ga(2191)}get titleText(){return Ma.a.instance.ga(2191)}get Lp(){return 320}get mc(){return this.domElement}get height(){return this.taskPaneManager.YO.offsetHeight}get isResizable(){return!1}nq(){return this.Tp}Es(){return this.Tp}JR(){}WQ(){return!1}sj(){}Wj(){}dispose(){this.$&&
this.$.Jl(this.Bc);this.Qd&&(La.a.instance.Ba(Mb.a.click,this.Qd,this.mk),Tc.KeyInputManager.instance.Vv(this.Qd,this.eEe));this.Qd=this.taskPaneManager=this.$=null;super.dispose()}gg(K,ob){ob||(K=rb.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),K||(K=this.Qd),rb.DOMElementExtensions.setFocus(K));return!ob}lh(K){return rb.DOMElementExtensions.xf(this.mc,K)}vg(K){this.Tp=K;const ob=this.taskPaneManager;this.isVisible=K;this.taskPaneManager.pA();K&&0<ob.dC.length&&(!ob.nh||
17!==ob.nh.taskPane.ih||ob.isCollapsed)&&ob.qG(this,!0)}UM(){const K=document.getElementById(this.$.Eb+eb.a.lHd);K.setAttribute(Sg.a.ariaLabel,Ma.a.instance.ga(2191));var ob=this.uH();K.appendChild(ob);ob=ec.b("div","PowerQueryPaneBodyId",wh);K.appendChild(ob);return ob}uH(){const K=ec.b("div","PowerQueryPaneHeaderId",nh),ob=ec.b("span","PowerQueryPaneTitleId",qh);ob.innerText=this.titleText;this.Qd=id.a.pb("PowerQueryPaneCloseButtonId",rh,Ma.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.Qd.classList.add(Gd.AFrameworkApplication.isRtl?
eb.a.Waa:eb.a.Xaa);La.a.instance.ta(Mb.a.click,this.Qd,this.mk);this.eEe=Tc.KeyInputManager.instance.Ms(this.Qd,this.mk,Wd.a.Sh);K.appendChild(ob);K.appendChild(this.Qd);return K}static ka(K,ob){var Sb=K.Eb;let kc=document.getElementById(Sb+eb.a.lHd);kc||(kc=document.createElement("div"),kc.id=K.Eb+eb.a.lHd,Wc.a.gd(K)||document.getElementById(Sb+eb.a.BR).appendChild(kc));kc.classList.add(mh);Sb=K.da;return Sb.za(408)||Sb.Ga(408,new Tg(kc,K,ob))}}Object(fa.a)(Tg,"PowerQueryTaskPane",fb.a,[709,2,263,
39]);class gh extends Ke.a{constructor(K){super();this.gh=this.xi=null;this.$=K;this.Fb()}get RD(){this.xi||(this.xi=ub.TaskExtensions.Aa(cc.a(this.$),K=>{this.gh=Tg.ka(this.$,K.result)},this.la,3));return this.xi}create(){const K=ta.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),ob=ta.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);ub.TaskExtensions.Aa(ub.TaskExtensions.ts(ub.TaskExtensions.Fd([K,ob],this.la),()=>this.RD,this.la),()=>{this.ob(this.gh)},this.la,3)}dispose(){this.gh=
this.xi=this.$=null;super.dispose()}static ka(K){K.da.Ga(409,new gh(K))}}Object(fa.a)(gh,"PowerQueryTaskPaneFactory",Ke.a,[]);var sf=a(163),ma;(function(K){K[K.Q$j=0]="ExistingPersistedMashup";K[K.Ehk=1]="TransientMashup";K[K.Dhk=2]="TransientEmptyMashup"})(ma||(ma={}));var vb;(function(K){K.x6j="addQueries";K.f7j="BrowseMashup";K.h8j="CreateConnection";K.H8j="DataPreview";K.n$j="EditDataflowComputeEngineSettings";K.m$j="editCubeVariables";K.o$j="editQuery";K.p$j="EditQuickCreate";K.kbk="importMashupTemplate";
K.Rpg="incrementalRefreshSettings";K.kck="manageDataflowComputeEngine";K.gdk="navigate";K.Iqg="QuickCreate";K.Mqg="refreshSettings";K.Oqg="ResolveResourceChallenge";K.sgk="showRefreshHistory"})(vb||(vb={}));var oc;(function(K){K.h4d="Cancelled";K.gog="CombineFiles";K.m8j="CsvTextSettings";K.DataSources="DataSources";K.J8j="DataSourceSettings";K.kak="FolderPreview";K.Rpg="IncrementalRefreshSettings";K.Loading="Loading";K.mck="MappingEditor";K.Navigator="Navigator";K.gfk="QueryEditor";K.Iqg="QuickCreate";
K.Mqg="RefreshSettings";K.$gk="TemplateCredentials";K.ahk="TemplateParameters";K.bhk="TextByExample"})(oc||(oc={}));var Fc;(Fc||(Fc={})).O6j="Attach";var wd;(function(K){K.ung="Busy";K.Error="Error";K.Ready="Ready";K.Unknown="Unknown"})(wd||(wd={}));var Pd;(function(K){K.q$j="Editable";K.Hidden="Hidden";K.xfk="Readonly"})(Pd||(Pd={}));var ie;(function(K){K.S8j="Dataflow";K.Project="Project"})(ie||(ie={}));var da;(da||(da={})).Mog="DataSourceTemplateKind";var jb;(function(K){K.hdk="Navigation";K.Mog=
"DataSourceTemplateKind"})(jb||(jb={}));var Nb;(function(K){K.Definition="Definition";K.Instance="Instance"})(Nb||(Nb={}));var E;(function(K){K.ung="Busy";K.Error="Error";K.Ready="Ready";K.Unknown="Unknown"})(E||(E={}));for(var ja,Ta=new Uint8Array(16),Eb=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,jc=[],ic=0;256>ic;++ic)jc.push((ic+256).toString(16).substr(1));var gc=new Map,$c=function(){function K(ob){this.wea=ob}K.prototype.deserialize=
function(ob){ob=ob.data;return Z(ob)?Ha(ob,"data",ob):ob};K.prototype.serialize=function(ob){ob.wea=this.wea;return{id:ob.id,kind:Ha(ob,"method",K.dsh),wea:K.mLh,data:ob}};K.dsh="";K.mLh="FxFrameControl";return K}(),gd=function(){function K(){}K.prototype.sHe=function(){return"start"};K.prototype.Fdc=function(){return"ready"};return K}(),md=function(){function K(ob){this.wea=ob}K.prototype.deserialize=function(ob){return ob.data};K.prototype.serialize=function(ob){ob.wea=this.wea;return ob};return K}(),
Xd=function(){function K(){}K.prototype.sHe=function(){return"__PONG__"};K.prototype.Fdc=function(){return"__PING__"};return K}(),ge=function(){function K(){var ob=this;this.NYf=function(){};this.LTf=function(){};this.promise=new Promise(function(Sb,kc){ob.NYf=Sb;ob.LTf=kc})}K.prototype.resolve=function(ob){this.NYf(ob)};K.prototype.reject=function(ob){this.LTf(ob)};return K}(),ve=function(){function K(ob,Sb){K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(kc,yc){kc.__proto__=yc}||
function(kc,yc){for(var bd in yc)Object.prototype.hasOwnProperty.call(yc,bd)&&(kc[bd]=yc[bd])};return K(ob,Sb)}return function(ob,Sb){function kc(){this.constructor=ob}if("function"!==typeof Sb&&null!==Sb)throw new TypeError("Class extends value "+String(Sb)+" is not a constructor or null");K(ob,Sb);ob.prototype=null===Sb?Object.create(Sb):(kc.prototype=Sb.prototype,new kc)}}(),Fe=function(){function K(ob){var Sb=this;this.Spc=function(kc){kc.method?Sb.oai(kc):Sb.pai(kc)};this.options=ob;this.ready=
!1;this.AEb=new Map;this.HRa=new Map;this.gJd=[];this.options.jPd.addListener(this.Spc);this.T6a("__SUPPORTS_METHOD__",function(kc){return Sb.Kai(kc)})}K.prototype.call=function(ob,Sb){return this.Eff(K.Xnc(ob),Sb)};K.prototype.D0a=function(ob,Sb){return d(this,void 0,void 0,function(){var kc;return f(this,function(yc){switch(yc.label){case 0:return[4,this.pPj(ob)];case 1:return(kc=yc.sent())?[2,this.call(ob,Sb)]:[2,void 0]}})})};K.prototype.dispose=function(){this.Ood("__SUPPORTS_METHOD__");this.HRa.forEach(function(ob){var Sb=
ob.reject;var kc=Error("Rpc disposed");if(void 0==kc.stack)try{throw kc;}catch(yc){kc=yc}return Sb.call(ob,kc)});this.HRa.clear();this.options.jPd.removeListener(this.Spc)};K.prototype.register=function(ob,Sb){var kc=this;this.T6a(K.Xnc(ob),function(){for(var yc,bd,Fd=[],Nd=0;Nd<arguments.length;Nd++)Fd[Nd]=arguments[Nd];null===(bd=(yc=kc.options).Qjk)||void 0===bd?void 0:bd.call(yc,ob,Fd);yc=Sb.apply;var Rd;bd=void 0;if(Nd="function"===typeof Symbol&&Fd[Symbol.iterator]){Fd=Nd.call(Fd);var je=[];
try{for(;(void 0===bd||0<bd--)&&!(Rd=Fd.next()).done;)je.push(Rd.value)}catch(Xe){var $e={error:Xe}}finally{try{Rd&&!Rd.done&&(Nd=Fd["return"])&&Nd.call(Fd)}finally{if($e)throw $e.error;}}Rd=je}else Rd=Fd;return yc.call(Sb,void 0,e([],Rd,!1))})};K.prototype.pPj=function(ob){return this.Eff("__SUPPORTS_METHOD__",[ob])};K.prototype.unregister=function(ob){this.Ood(K.Xnc(ob))};K.prototype.$0c=function(){return this.ready};Object.defineProperty(K.prototype,"rpcHandshakeHandler",{get:function(){return this.options.XAa},
enumerable:!1,configurable:!0});K.prototype.Eff=function(ob,Sb){void 0===Sb&&(Sb=void 0);var kc=v();Sb={id:kc,method:ob,params:Sb};var yc=new ge;this.HRa.set(kc,yc);this.options.tub&&console.log("RpcChannel[".concat(JSON.stringify(this.options.WM),"].internalCall - method: ").concat(JSON.stringify(ob),", id: ").concat(JSON.stringify(kc)));this.$0c(Sb)?this.Xfg(Sb):this.gJd.push(Sb);return yc.promise};K.prototype.T6a=function(ob,Sb){if(this.AEb.has(ob))throw Error("Rpc method with name '".concat(ob,
"' already registered."));this.options.tub&&console.log("RpcChannel[".concat(JSON.stringify(this.options.WM),"].internalRegister - method: ").concat(JSON.stringify(ob)));this.AEb.set(ob,Sb)};K.prototype.Ood=function(ob){this.AEb.delete(ob)};K.prototype.sEd=function(){this.ready=!0;this.DJh()};K.F6e=function(ob){return ob instanceof Error?{message:ob.message,name:ob.name,stack:ob.stack}:ob};K.Xnc=function(ob){return ob.toUpperCase()};K.prototype.DJh=function(){var ob=this;this.gJd.forEach(function(Sb){return ob.Xfg(Sb)});
this.gJd=[]};K.prototype.oai=function(ob){var Sb=this;this.options.tub&&console.log("RpcChannel[".concat(JSON.stringify(this.options.WM),"].handleRequestMessageReceived - method: ").concat(JSON.stringify(ob.method),", id: ").concat(JSON.stringify(ob.id)));var kc=this.AEb.get(ob.method);if(kc){var yc={wea:ob.wea,id:ob.id};try{var bd=kc.apply(this,ob.params);Promise.resolve(bd).then(function(Fd){yc.result=Fd;Sb.postMessage(yc)}).catch(function(Fd){yc.error=K.F6e(Fd);Sb.postMessage(yc)})}catch(Fd){yc.error=
K.F6e(Fd),this.postMessage(yc)}}};K.prototype.pai=function(ob){this.options.tub&&console.log("RpcChannel[".concat(JSON.stringify(this.options.WM),"].handleResponseMessageReceived - id: ").concat(JSON.stringify(ob.id)));var Sb=ob.id,kc=this.HRa.get(Sb);kc&&(ob.error?kc.reject(ob.error):kc.resolve(ob.result),this.HRa.delete(Sb))};K.prototype.Kai=function(ob){return this.AEb.has(K.Xnc(ob))};K.prototype.postMessage=function(ob){this.options.jPd.postMessage(ob)};K.prototype.Xfg=function(ob){try{this.postMessage(ob)}catch(kc){if(kc instanceof
Error){ob=ob.id;var Sb=this.HRa.get(ob);Sb&&(Sb.reject(kc),this.HRa.delete(ob))}}};return K}(),Ve=function(K){function ob(Sb){var kc=K.call(this,Sb)||this;kc.IDe=Sb;kc.T6a(Sb.XAa.Fdc(),function(){return kc.eai()});return kc}ve(ob,K);ob.prototype.eai=function(){this.Ood(this.XAa.Fdc());this.sEd();this.IDe.lNi&&this.IDe.lNi();return this.XAa.sHe()};return ob}(Fe);(function(K){function ob(){return null!==K&&K.apply(this,arguments)||this}ve(ob,K);ob.prototype.$0c=function(Sb){return K.prototype.$0c.call(this,
Sb)||Sb.method===this.XAa.Fdc()};return ob})(Fe);var jf=function(){function K(ob){this.jFh=ob}K.prototype.Spc=function(){};return K}(),gf=function(){function K(ob,Sb,kc){this.Du=document.createElement("iframe");this.edf=this.Du.style.display;this.Du.src=ob;this.Du.title="Power Query";this.Du.allow="clipboard-read; clipboard-write";this.Du.setAttribute("data-is-focusable","true");n(Sb);this.container=Sb;kc&&(this.Du.className=kc);this.hide();this.container.appendChild(this.Du);this.dd=!1}K.prototype.addEventListener=
function(ob,Sb,kc){this.dd||(n(this.Du.contentWindow),this.Du.contentWindow.addEventListener(ob,Sb,kc))};K.prototype.removeEventListener=function(ob,Sb,kc){this.dd||(n(this.Du.contentWindow),this.Du.contentWindow.removeEventListener(ob,Sb,kc))};K.prototype.postMessage=function(ob,Sb,kc){this.dd||(n(this.Du.contentWindow),this.Du.contentWindow.postMessage(ob,Sb,kc))};K.prototype.hide=function(){this.dd||(this.edf=this.Du.style.display,this.Du.style.display="none")};K.prototype.show=function(){this.dd||
(this.Du.style.display=this.edf)};K.prototype.dispose=function(){this.container.removeChild(this.Du);this.dd=!0};return K}(),xf=function(){function K(ob,Sb,kc,yc,bd){this.yk=ob;this.A4b=Sb;this.client=kc;this.configuration=yc;this.E5g=bd;this.sgj()}K.prototype.dispose=function(){this.XXj()};K.prototype.sgj=function(){var ob=this,Sb,kc,yc,bd,Fd,Nd,Rd,je,$e,Xe,ig,Zg,Uf,uh,hh,Lh,R,Wa,qb,Xb,pc,Lc,Ec,Gc,qc,Sc,fd,Yc,Ld,$d,se,Ne,tf,Df,Yf,lf,Gf,nf,hg,qg,Ig,Jg,$g,yh,zf;this.register("acquireToken",function(af){return ob.configuration.FVc(af)});
this.register("getClientStartTime",function(){return ob.E5g});this.register("getSettings",function(){return ob.configuration.Jqh});this.register("getVersion",function(){return"17.25.1"});this.register("hasMappingCallbacks",function(){return void 0!=ob.configuration.Pmc});this.register("onAppReady",function(){return ob.A4b.INi()});this.register("onCancel",function(){return ob.A4b.yCd()});this.register("onCommit",function(){});this.register("onCommit2",function(af){return ob.A4b.MCd(af)});this.register("onFlowReady",
function(){return ob.A4b.TCd()});(null===(Sb=this.configuration.bXg)||void 0===Sb?0:Sb.cVh)&&this.register("browseMashupCallbacks.getEntityQueryScript",this.configuration.bXg.cVh);(null===(kc=this.configuration.hch)||void 0===kc?0:kc.n0)&&this.register("createConnectionFlowClientCallbacks.onStateChanged",this.configuration.hch.n0);(null===(yc=this.configuration.kJa)||void 0===yc?0:yc.xRi)&&this.register("dataPreview.onEvaluationEnded",this.configuration.kJa.xRi);(null===(bd=this.configuration.kJa)||
void 0===bd?0:bd.yRi)&&this.register("dataPreview.onEvaluationStarted",this.configuration.kJa.yRi);(null===(Fd=this.configuration.kJa)||void 0===Fd?0:Fd.YXi)&&this.register("dataPreview.onQueryScriptChange",this.configuration.kJa.YXi);(null===(Nd=this.configuration.kJa)||void 0===Nd?0:Nd.N_i)&&this.register("dataPreview.onTableSelectionChanged",this.configuration.kJa.N_i);(null===(Rd=this.configuration.yJh)||void 0===Rd?0:Rd.eQi)&&this.register("flowControlRpcMethodNames.onControlStateChanged",function(){var af;
return null===(af=ob.configuration.yJh)||void 0===af?void 0:af.eQi(ob.client)});(null===(je=this.configuration.Fmd)||void 0===je?0:je.fZh)&&this.register("hostPopupsCallbacks.getLoginSuccessRedirectUri",this.configuration.Fmd.fZh);(null===($e=this.configuration.Fmd)||void 0===$e?0:$e.Y1i)&&this.register("hostPopupsCallbacks.openHostPopup",this.configuration.Fmd.Y1i);(null===(Xe=this.configuration.t6)||void 0===Xe?0:Xe.rNh)&&this.register("mappingEditorCallbacks.generateNewEntityFieldNames",this.configuration.t6.rNh);
(null===(ig=this.configuration.t6)||void 0===ig?0:ig.sNh)&&this.register("mappingEditorCallbacks.generateNewEntityNames",this.configuration.t6.sNh);(null===(Zg=this.configuration.t6)||void 0===Zg?0:Zg.$Uh)&&this.register("mappingEditorCallbacks.getEntities",this.configuration.t6.$Uh);(null===(Uf=this.configuration.t6)||void 0===Uf?0:Uf.aVh)&&this.register("mappingEditorCallbacks.getEntityFields",this.configuration.t6.aVh);(null===(uh=this.configuration.t6)||void 0===uh?0:uh.bVh)&&this.register("mappingEditorCallbacks.getEntityKeys",
this.configuration.t6.bVh);(null===(hh=this.configuration.t6)||void 0===hh?0:hh.k3j)&&this.register("mappingEditorCallbacks.validateMappingEditorResult",this.configuration.t6.k3j);(null===(Lh=this.configuration.Pmc)||void 0===Lh?0:Lh.dVh)&&this.register("mappingCallbacks.getEntityTypeFields",this.configuration.Pmc.dVh);(null===(R=this.configuration.Pmc)||void 0===R?0:R.eVh)&&this.register("mappingCallbacks.getEntityTypes",null===(Wa=this.configuration.Pmc)||void 0===Wa?void 0:Wa.eVh);(null===(qb=
this.configuration.Lyd)||void 0===qb?0:qb.nRi)&&this.register("mashupEditorClientCallbacks.onEditingSessionMashupChanged",this.configuration.Lyd.nRi);(null===(Xb=this.configuration.Lyd)||void 0===Xb?0:Xb.Olj)&&this.register("mashupEditorClientCallbacks.renameMashup",this.configuration.Lyd.Olj);(null===(pc=this.configuration.cn)||void 0===pc?0:pc.getState)&&this.register("powerBIDataMart.getState",this.configuration.cn.getState);(null===(Lc=this.configuration.cn)||void 0===Lc?0:Lc.NRi)&&this.register("powerBIDataMart.onFieldsSelected",
this.configuration.cn.NRi);(null===(Ec=this.configuration.cn)||void 0===Ec?0:Ec.NWi)&&this.register("powerBIDataMart.onNewSqlQueryButtonClicked",this.configuration.cn.NWi);(null===(Gc=this.configuration.cn)||void 0===Gc?0:Gc.PWi)&&this.register("powerBIDataMart.onNewVisualQueryButtonClicked",this.configuration.cn.PWi);(null===(qc=this.configuration.cn)||void 0===qc?0:qc.WYi)&&this.register("powerBIDataMart.onSaveButtonClicked",this.configuration.cn.WYi);(null===(Sc=this.configuration.cn)||void 0===
Sc?0:Sc.lZi)&&this.register("powerBIDataMart.onScrollChanged",this.configuration.cn.lZi);(null===(fd=this.configuration.cn)||void 0===fd?0:fd.uZi)&&this.register("powerBIDataMart.onSearchTermChanged",this.configuration.cn.uZi);(null===(Yc=this.configuration.cn)||void 0===Yc?0:Yc.B_i)&&this.register("powerBIDataMart.onStoredProceduresSelected",this.configuration.cn.B_i);(null===(Ld=this.configuration.cn)||void 0===Ld?0:Ld.A_i)&&this.register("powerBIDataMart.onStoredProceduresGroupToggled",this.configuration.cn.A_i);
(null===($d=this.configuration.cn)||void 0===$d?0:$d.K_i)&&this.register("powerBIDataMart.onTableDragDropped",this.configuration.cn.K_i);(null===(se=this.configuration.cn)||void 0===se?0:se.R_i)&&this.register("powerBIDataMart.onTablesSelected",this.configuration.cn.R_i);(null===(Ne=this.configuration.cn)||void 0===Ne?0:Ne.Q_i)&&this.register("powerBIDataMart.onTablesGroupToggled",this.configuration.cn.Q_i);(null===(tf=this.configuration.cn)||void 0===tf?0:tf.P_i)&&this.register("powerBIDataMart.onTableToggled",
this.configuration.cn.P_i);(null===(Df=this.configuration.cn)||void 0===Df?0:Df.b1i)&&this.register("powerBIDataMart.onViewDragDropped",this.configuration.cn.b1i);(null===(Yf=this.configuration.cn)||void 0===Yf?0:Yf.i1i)&&this.register("powerBIDataMart.onViewsSelected",this.configuration.cn.i1i);(null===(lf=this.configuration.cn)||void 0===lf?0:lf.h1i)&&this.register("powerBIDataMart.onViewsGroupToggled",this.configuration.cn.h1i);(null===(Gf=this.configuration.cn)||void 0===Gf?0:Gf.g1i)&&this.register("powerBIDataMart.onViewSqlButtonClicked",
this.configuration.cn.g1i);(null===(nf=this.configuration.cn)||void 0===nf?0:nf.l1i)&&this.register("powerBIDataMart.onVisualizeResultButtonClicked",this.configuration.cn.l1i);(null===(hg=this.configuration.ona)||void 0===hg?0:hg.HPi)&&this.register("queryEditorCallbacks.onCommandBarPopupButtonClick",function(){var af;return n(null===(af=ob.configuration.ona)||void 0===af?void 0:af.HPi)(ob.client)});(null===(qg=this.configuration.ona)||void 0===qg?0:qg.HQi)&&this.register("queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick",
function(){var af;return n(null===(af=ob.configuration.ona)||void 0===af?void 0:af.HQi)(ob.client)});(null===(Ig=this.configuration.ona)||void 0===Ig?0:Ig.pXi)&&this.register("queryEditorCallbacks.onOpenInExcelButtonClick",function(af){var yf;return n(null===(yf=ob.configuration.ona)||void 0===yf?void 0:yf.pXi)(ob.client,af)});(null===(Jg=this.configuration.ona)||void 0===Jg?0:Jg.m3j)&&this.register("queryEditorCallbacks.validateQuery",function(af){var yf;return n(null===(yf=ob.configuration.ona)||
void 0===yf?void 0:yf.m3j)(ob.client,af)});(null===($g=this.configuration.ona)||void 0===$g?0:$g.n3j)&&this.register("queryEditorCallbacks.validateQueryNameInteractive",function(af){var yf;return n(null===(yf=ob.configuration.ona)||void 0===yf?void 0:yf.n3j)(ob.client,af)});(null===(yh=this.configuration.i2d)||void 0===yh?0:yh.iec)&&this.register("userSettings.getUserSettings",this.configuration.i2d.iec);(null===(zf=this.configuration.i2d)||void 0===zf?0:zf.Pyc)&&this.register("userSettings.setUserSettings",
this.configuration.i2d.Pyc)};K.prototype.XXj=function(){this.unregister("acquireToken");this.unregister("getClientStartTime");this.unregister("getSettings");this.unregister("getVersion");this.unregister("onAppReady");this.unregister("onCancel");this.unregister("onCommit");this.unregister("onFlowReady");this.unregister("browseMashupCallbacks.getEntityQueryScript");this.unregister("createConnectionFlowClientCallbacks.onStateChanged");this.unregister("dataPreview.onEvaluationEnded");this.unregister("dataPreview.onEvaluationStarted");
this.unregister("dataPreview.onQueryScriptChange");this.unregister("dataPreview.onTableSelectionChanged");this.unregister("hostPopupsCallbacks.getLoginSuccessRedirectUri");this.unregister("hostPopupsCallbacks.openHostPopup");this.unregister("mappingEditorCallbacks.generateNewEntityFieldNames");this.unregister("mappingEditorCallbacks.generateNewEntityNames");this.unregister("mappingEditorCallbacks.getEntities");this.unregister("mappingEditorCallbacks.getEntityFields");this.unregister("mappingEditorCallbacks.getEntityKeys");
this.unregister("mappingEditorCallbacks.validateMappingEditorResult");this.unregister("mappingCallbacks.getEntityTypeFields");this.unregister("mappingCallbacks.getEntityTypes");this.unregister("mashupEditorClientCallbacks.onEditingSessionMashupChanged");this.unregister("mashupEditorClientCallbacks.renameMashup");this.unregister("powerBIDataMart.getState");this.unregister("powerBIDataMart.onFieldsSelected");this.unregister("powerBIDataMart.onNewSqlQueryButtonClicked");this.unregister("powerBIDataMart.onNewVisualQueryButtonClicked");
this.unregister("powerBIDataMart.onSaveButtonClicked");this.unregister("powerBIDataMart.onStoredProceduresSelected");this.unregister("powerBIDataMart.onStoredProceduresGroupToggled");this.unregister("powerBIDataMart.onTableDragDropped");this.unregister("powerBIDataMart.onTablesSelected");this.unregister("powerBIDataMart.onTablesGroupToggled");this.unregister("powerBIDataMart.onTableToggled");this.unregister("powerBIDataMart.onViewDragDropped");this.unregister("powerBIDataMart.onViewsSelected");this.unregister("powerBIDataMart.onViewsGroupToggled");
this.unregister("powerBIDataMart.onViewSqlButtonClicked");this.unregister("powerBIDataMart.onVisualizeResultButtonClicked");this.unregister("queryEditorCallbacks.onCommandBarPopupButtonClick");this.unregister("queryEditorCallbacks.onDiagramViewCommandBarPopupButtonClick");this.unregister("queryEditorCallbacks.onOpenInExcelButtonClick");this.unregister("queryEditorCallbacks.validateQuery");this.unregister("queryEditorCallbacks.validateQueryNameInteractive");this.unregister("userSettings.getUserSettings");
this.unregister("userSettings.setUserSettings")};K.prototype.register=function(ob,Sb){this.yk.register(ob,Sb)};K.prototype.unregister=function(ob){this.yk.unregister(ob)};return K}(),Ye;(function(K){K.u6j="activateQuery";K.y6j="addQuery";K.l7j="cancelAddQueriesFlow";K.aog="clickCancelButton";K.bog="clickCommitButton";K.cog="clickCustomButton";K.dog="clickNextStageButton";K.eog="clickPreviousStageButton";K.jog="createConnectionFlow_commit";K.Kog="dataPreview_cancelCurrentQueryEvaluation";K.Log="dataPreview_selectColumns";
K.I9j="deleteAllQueries";K.Uog="disposeService";K.s$j="endFlow";K.Aak="getActiveQueryName";K.spg="getCancelButtonLabel";K.tpg="getCommitButtonLabel";K.Bak="getCommitResult";K.upg="getCurrentFlow";K.vpg="getCustomButtonLabel";K.Dak="getDataSourceQueryScript";K.wpg="getDataWizardFooter_clickCancelButton";K.xpg="getDataWizardFooter_clickCommitButton";K.ypg="getDataWizardFooter_clickCustomButton";K.zpg="getDataWizardFooter_clickNextStageButton";K.Apg="getDataWizardFooter_clickPreviousStageButton";K.Eak=
"getEditingSessionId";K.Bpg="getEditingSessionMashup";K.Fak="getFooterMessage";K.Gak="getGetDataWizardFlowStage";K.Hak="getIncrementalRefreshSettings";K.Cpg="getNextStageButtonLabel";K.Dpg="getPreviousStageButtonLabel";K.Iak="getQueriesInfo";K.Jak="getQueryEditorState";K.Kak="getQueryEditorStateOrThrow";K.Lak="getQueryNames";K.Mak="getQueryScript";K.Nak="getReadyState";K.Oak="getRefreshSettings";K.Pak="getSelectedStepName";K.Epg="getUserSettings";K.Tpg="isCancelButtonEnabled";K.Upg="isCancelButtonVisible";
K.Vpg="isCommitButtonEnabled";K.Wpg="isCommitButtonVisible";K.Ypg="isCustomButtonEnabled";K.Zpg="isCustomButtonVisible";K.Dbk="isDialogVisible";K.Fbk="isFeatureSupported";K.Gbk="isFooterOverlayVisible";K.$pg="isNextStageButtonEnabled";K.aqg="isNextStageButtonVisible";K.bqg="isPreviousStageButtonEnabled";K.cqg="isPreviousStageButtonVisible";K.tek="onHostPopupCancelled";K.Hqg="powerBIDataMart_setState";K.zfk="refreshActiveQueryResult";K.jrg="setUserSettings";K.qrg="startFlow";K.Nhk="trySetQueryScript"})(Ye||
(Ye={}));var Lf=function(){function K(ob){this.yk=ob}K.prototype.xDe=function(){return this.yk.call(Ye.aog)};K.prototype.yDe=function(){return this.yk.call(Ye.bog)};K.prototype.zDe=function(){return this.yk.call(Ye.cog)};K.prototype.FDe=function(){return this.yk.call(Ye.dog)};K.prototype.GDe=function(){return this.yk.call(Ye.eog)};K.prototype.ich=function(){return this.yk.call(Ye.jog)};K.prototype.hjh=function(){return this.yk.call(Ye.Kog)};K.prototype.ijh=function(ob){return this.yk.D0a(Ye.Log,[ob])};
K.prototype.Boh=function(){return this.yk.D0a(Ye.Uog)};K.prototype.eRh=function(){return this.yk.call(Ye.spg)};K.prototype.pSh=function(){return this.yk.call(Ye.tpg)};K.prototype.qTh=function(){return this.yk.call(Ye.vpg)};K.prototype.Sfd=function(){return this.yk.D0a(Ye.upg)};K.prototype.DTh=function(){return this.yk.call(Ye.wpg)};K.prototype.ETh=function(){return this.yk.call(Ye.xpg)};K.prototype.FTh=function(){return this.yk.call(Ye.ypg)};K.prototype.GTh=function(){return this.yk.call(Ye.zpg)};
K.prototype.HTh=function(){return this.yk.call(Ye.Apg)};K.prototype.kgd=function(ob){return this.yk.call(Ye.Bpg,[ob])};K.prototype.s_h=function(){return this.yk.call(Ye.Cpg)};K.prototype.e1h=function(){return this.yk.call(Ye.Dpg)};K.prototype.iec=function(){return this.yk.call(Ye.Epg)};K.prototype.Pmi=function(){return this.yk.call(Ye.Tpg)};K.prototype.Qmi=function(){return this.yk.call(Ye.Upg)};K.prototype.vni=function(){return this.yk.call(Ye.Vpg)};K.prototype.wni=function(){return this.yk.call(Ye.Wpg)};
K.prototype.Sni=function(){return this.yk.call(Ye.Ypg)};K.prototype.Tni=function(){return this.yk.call(Ye.Zpg)};K.prototype.Jri=function(){return this.yk.call(Ye.$pg)};K.prototype.Kri=function(){return this.yk.call(Ye.aqg)};K.prototype.Bsi=function(){return this.yk.call(Ye.bqg)};K.prototype.Csi=function(){return this.yk.call(Ye.cqg)};K.prototype.r7i=function(ob){return this.yk.D0a(Ye.Hqg,[ob])};K.prototype.Pyc=function(ob){return this.yk.D0a(Ye.jrg,[ob])};K.prototype.aXd=function(ob,Sb){return this.yk.D0a(Ye.qrg,
[ob,Sb])};return K}(),Nf=function(){function K(ob){n(ob.TOb);n(ob.GWd);this.options=ob;this.c$b=new Map}K.prototype.addListener=function(ob){function Sb(yc){return kc.v$h(yc,ob)}var kc=this;if(this.c$b.has(ob))throw Error("Duplicate rpc listener added.");this.c$b.set(ob,Sb);this.options.GWd.addEventListener(K.lRe,Sb)};K.prototype.postMessage=function(ob){var Sb=this.options.Hcg.jFh;this.options.TOb.postMessage(this.options.tdb.serialize(ob),Sb)};K.prototype.removeListener=function(ob){var Sb=this.c$b.get(ob);
Sb&&(this.options.GWd.removeEventListener(K.lRe,Sb),this.c$b.delete(ob))};K.jri=function(ob){ob=ob.data;return!(null===ob||void 0===ob)};K.prototype.m1g=function(ob){return!!ob&&ob.wea===this.options.tdb.wea};K.prototype.v$h=function(ob,Sb){if(K.jri(ob)){var kc=this.options.tdb.deserialize(ob);this.m1g(kc)&&(this.options.Lte.some(function(yc){var bd=ob.origin;return"*"===yc?!0:yc.startsWith("https://*.")&&bd.startsWith("https://")?bd.substring(8).endsWith(yc.substring(9)):bd===yc})?(this.options.Hcg.Spc(ob.origin),
Sb(kc)):console.warn("Received message was ignored. Origin: ".concat(JSON.stringify(ob.origin),". Allowed origins: ").concat(JSON.stringify(this.options.Lte))))}};K.lRe="message";return K}(),Ef=function(){function K(ob){var Sb=this,kc,yc,bd,Fd=new Date;this.instanceId=v();this.configuration=ob;var Nd=null!==(kc=this.configuration.V$.Kik)&&void 0!==kc?kc:this.Ech(this.configuration.V$.container,this.configuration.V$.className);kc=Xa(this.configuration.V$.url,"clientInstanceId",this.instanceId);this.configuration.V$.mPf&&
(kc=Xa(kc,"protocolId",this.configuration.V$.mPf));this.r_a=Nd.JRg(kc);kc=void 0!==this.configuration.V$.Kte?this.configuration.V$.Kte:"*";var Rd=la(r(this.instanceId),null!==(yc=this.configuration.V$.mPf)&&void 0!==yc?yc:"default");this.yk=new Ve({WM:"MashupEditorClient.clientRpcChannel",tub:null!==(bd=this.configuration.V$.tub)&&void 0!==bd?bd:!1,XAa:Rd.XAa,jPd:new Nf({Lte:[kc],tdb:Rd.tdb,GWd:Nd.H5g,Hcg:new jf(kc),TOb:this.r_a})});this.C5g=new xf(this.yk,{yCd:function(){return Sb.yCd()},MCd:function(je){return Sb.MCd(je)},
TCd:function(){return Sb.TCd()},INi:function(){return Sb.Aue.resolve()}},this,ob,Fd);this.jn=new Lf(this.yk);this.Aue=new ge}Object.defineProperty(K.prototype,"dataPreview",{get:function(){var ob=this;return{Eik:function(){return ob.jn.hjh()},selectColumns:function(Sb){return ob.jn.ijh(Sb)}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"getDataWizardFooterCallbacks",{get:function(){var ob=this;return{xDe:function(){return ob.jn.DTh()},yDe:function(){return ob.jn.ETh()},zDe:function(){return ob.jn.FTh()},
FDe:function(){return ob.jn.GTh()},GDe:function(){return ob.jn.HTh()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"cancelButton",{get:function(){var ob=this;return{click:function(){return ob.jn.xDe()},fka:function(){return ob.jn.eRh()},isEnabled:function(){return ob.jn.Pmi()},isVisible:function(){return ob.jn.Qmi()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"commitButton",{get:function(){var ob=this;return{click:function(){return ob.jn.yDe()},fka:function(){return ob.jn.pSh()},
isEnabled:function(){return ob.jn.vni()},isVisible:function(){return ob.jn.wni()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"customButton",{get:function(){var ob=this;return{click:function(){return ob.jn.zDe()},fka:function(){return ob.jn.qTh()},isEnabled:function(){return ob.jn.Sni()},isVisible:function(){return ob.jn.Tni()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"nextStageButton",{get:function(){var ob=this;return{click:function(){return ob.jn.FDe()},
fka:function(){return ob.jn.s_h()},isEnabled:function(){return ob.jn.Jri()},isVisible:function(){return ob.jn.Kri()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"createConnectionFlowCallbacks",{get:function(){var ob=this;return{commit:function(){return ob.jn.ich()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"powerBIDataMart",{get:function(){var ob=this;return{sS:function(Sb){return ob.jn.r7i(Sb)}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,
"previousStageButton",{get:function(){var ob=this;return{click:function(){return ob.jn.GDe()},fka:function(){return ob.jn.e1h()},isEnabled:function(){return ob.jn.Bsi()},isVisible:function(){return ob.jn.Csi()}}},enumerable:!1,configurable:!0});Object.defineProperty(K.prototype,"ready",{get:function(){return this.Aue.promise},enumerable:!1,configurable:!0});K.prototype.Sfd=function(){return this.jn.Sfd()};K.prototype.kgd=function(ob){return this.jn.kgd(ob)};K.prototype.iec=function(){return this.jn.iec()};
K.prototype.Pyc=function(ob){return this.jn.Pyc(ob)};K.prototype.aXd=function(ob,Sb,kc){return b(this,void 0,void 0,function(){var yc;return c(this,function(bd){switch(bd.label){case 0:return[4,this.ready];case 1:return bd.sent(),[4,this.Sfd()];case 2:yc=bd.sent();if(void 0!=yc)throw Error("cannot start a new flow when an existing flow is running");bd=new ge;a:switch(ob.kind){case "addQueries":case "editQuery":case "importMashupTemplate":case "BrowseMashup":case "DataPreview":case "editCubeVariables":case "EditDataflowComputeEngineSettings":case "EditQuickCreate":case "incrementalRefreshSettings":case "manageDataflowComputeEngine":case "navigate":case "QuickCreate":case "ResolveResourceChallenge":case "refreshSettings":case "showRefreshHistory":var Fd=
!0;break a;case "CreateConnection":Fd=!ob.vjk;break a;default:throw Error("Unexpected value: ".concat(ob));}this.oaa={NYe:bd,cFj:Fd,LCd:function(Nd,Rd){if(Rd.kind===ob.kind)return Sb(Nd,Rd);throw Error("The flow ".concat(ob.kind," returned the wrong type of result: ").concat(Rd.kind));},K6:kc};this.r_a.show();this.jn.aXd(ob,void 0);return[2,this.oaa.NYe.promise]}})})};K.prototype.dispose=function(){return b(this,void 0,void 0,function(){return c(this,function(ob){switch(ob.label){case 0:this.r_a.hide(),
ob.label=1;case 1:return ob.trys.push([1,,3,4]),[4,this.jn.Boh()];case 2:return ob.sent(),[3,4];case 3:return this.C5g.dispose(),this.yk.dispose(),this.r_a.dispose(),[7];case 4:return[2]}})})};K.prototype.Ech=function(ob,Sb){return{H5g:window,JRg:function(kc){return new gf(kc,ob,Sb)}}};K.prototype.yCd=function(){return b(this,void 0,void 0,function(){return c(this,function(ob){switch(ob.label){case 0:if(this.configuration.K6)return[2,this.configuration.K6(this)];n(this.oaa);return[4,this.oaa.K6(this)];
case 1:return ob.sent(),this.r_a.hide(),this.oaa=void 0,[2]}})})};K.prototype.MCd=function(ob){return b(this,void 0,void 0,function(){return c(this,function(Sb){switch(Sb.label){case 0:if(this.configuration.LCd)return[2,this.configuration.LCd(this)];n(this.oaa);return[4,this.oaa.LCd(this,ob)];case 1:return Sb.sent(),this.oaa.cFj&&(this.r_a.hide(),this.oaa=void 0),[2]}})})};K.prototype.TCd=function(){n(this.oaa);this.oaa.NYe.resolve()};return K}(),uf;(function(K){K.Success="Success";K.w$j="Error_EmptyName";
K.x$j="Error_InvalidCharacters";K.y$j="Error_NameAlreadyExists";K.z$j="Error_NameTooLong"})(uf||(uf={}));var Bg;(function(K){K.Xng="Cancel";K.M7j="Commit"})(Bg||(Bg={}));var vg;(function(K){K.C6j="AlwaysCancel";K.D6j="AlwaysCommit";K.M6j="Ask"})(vg||(vg={}));var Eg;(function(K){K.h7j="BuiltInCommand";K.fbk="HostCommand"})(Eg||(Eg={}));var Ih;(function(K){K.x4d="kusto";K.XRb="sql"})(Ih||(Ih={}));var Qh;(function(K){K.Ngk="StepLabel";K.Ogk="StepName"})(Qh||(Qh={}));var dg;(function(K){K.Vng="CalculatedEntity";
K.Default="Default";K.LinkedEntity="LinkedEntity";K.Parameter="Parameter";K.Z4d="Visual"})(dg||(dg={}));var Ug;(function(K){K.Data="Data";K.Xfk="Schema"})(Ug||(Ug={}));var Cg;(function(K){K.None="None";K.Query="Query";K.Step="Step"})(Cg||(Cg={}));var Yg;(function(K){K.mog="Critical";K.Error="Error"})(Yg||(Yg={}));var Sh;(function(K){K.h4d="Cancelled";K.Completed="Completed";K.Failed="Failed";K.NotStarted="NotStarted";K.Rfk="Running"})(Sh||(Sh={}));var Ni;(function(K){K.Access="Access";K.IRb="ActiveDirectory";
K.w6j="AddFuzzyClusterColumn";K.z6j="AddRankColumn";K.JRb="AdobeAnalytics";K.ang="AIInsights";K.Alternates="Alternates";K.I6j="AnyType";K.J6j="AppendQueries";K.K6j="AppendQueriesAsNew";K.TFc="AzureAnalysisServices";K.KRb="AzureBlobs";K.U6j="AzureHdInsightClusters";K.W3d="AzureSql";K.Y6j="AzureSynapse";K.LRb="AzureTables";K.X3d="Binary";K.d7j="Blog";K.e7j="BlueLink";K.Vng="CalculatedEntity";K.j7j="Calculator";K.Xng="Cancel";K.m7j="CancelRefresh";K.Yng="Cds";K.r7j="ChartClusteredBar";K.s7j="ChartClusteredColumn";
K.t7j="ChartLine";K.u7j="ChartPercentageStackedArea";K.v7j="ChartPercentageStackedBar";K.w7j="ChartPercentageStackedColumn";K.x7j="ChartStackedArea";K.y7j="ChartStackedBar";K.z7j="ChartStackedColumn";K.A7j="Checkmark";K.B7j="ChooseColumns";K.C7j="ClearFilter";K.D7j="Close";K.E7j="CloseAndLoad";K.F7j="CloseAndLoadTo";K.G7j="CloseRed";K.Column="Column";K.J7j="ColumnByExample";K.gog="CombineFiles";K.O7j="Community";K.U7j="ConditionalColumn";K.V7j="ConnectDatabase";K.Copy="Copy";K.f8j="CountRows";K.n8j=
"Cube";K.o8j="CubeAddAndExpandDimensionColumn";K.q8j="CubeCollapseAndRemoveColumns";K.r8j="CubeDimension";K.s8j="CubeDimensionAttribute";K.t8j="CubeDimensionHierarchy";K.v8j="CubeMeasure";K.x8j="CubeServer";K.i4d="Currency";K.z8j="CustomColumn";K.C8j="Cut";K.Database="Database";K.L8j="DatabaseClock";K.M8j="DatabaseDynamic";K.N8j="DatabaseLightning";K.O8j="DatabaseOpaque";K.P8j="DatabaseRefresh";K.R8j="Databases";K.Q8j="DatabaseUnknown";K.U8j="Dataflows";K.Nog="Dataverse";K.Date="Date";K.DateTime=
"DateTime";K.m4d="DateTimeZone";K.Delete="Delete";K.J9j="DeleteFile";K.O9j="DemoteHeaders";K.S9j="DetectDataType";K.U9j="Diagram";K.$9j="Documentation";K.a$j="DragQueries";K.b$j="DragQueryGroups";K.c$j="DuplicateColumn";K.Duration="Duration";K.o4d="Dynamics365";K.Empty="Empty";K.Entity="Entity";K.Error="Error";K.Excel="Excel";K.Exchange="Exchange";K.R$j="Expand";K.S$j="ExpandColumn";K.Feedback="Feedback";K.$$j="FeedbackExtremelyDissatisfied";K.aak="FeedbackExtremelySatisfied";K.bak="FeedbackSomewhatDissatisfied";
K.cak="FeedbackSomewhatSatisfied";K.hpg="Fhir";K.dak="FillDown";K.eak="FillUp";K.Filter="Filter";K.fak="FitToView";K.t4d="Folder";K.lak="FormatText";K.pak="FullScreen";K.Function="Function";K.xak="Gear";K.Cak="GetData";K.SRb="GoogleAnalytics";K.Qak="GoToColumn";K.Uak="GridAutoFilter";K.Vak="GridCombineFiles";K.Wak="GridEditFilter";K.Xak="GridExpandColumn";K.Yak="GridSortedAscending";K.Zak="GridSortedDescending";K.$ak="GroupBy";K.ebk="HorizontalLayout";K.mbk="IndexColumn";K.Info="Info";K.qbk="InsertColumnsLeft";
K.rbk="InsertColumnsRight";K.sbk="InsertRowsAbove";K.tbk="InsertRowsBelow";K.Cbk="InvokeCustomFunction";K.Hbk="JoinKindFullOuter";K.Ibk="JoinKindInner";K.Jbk="JoinKindLeftAnti";K.Kbk="JoinKindLeftOuter";K.Lbk="JoinKindRightAnti";K.Mbk="JoinKindRightOuter";K.Pbk="KeepBottomRows";K.Qbk="KeepDuplicates";K.Rbk="KeepErrors";K.Sbk="KeepRange";K.Tbk="KeepTopRows";K.Key="Key";K.KeyboardShortcuts="KeyboardShortcuts";K.x4d="Kusto";K.$bk="LightBulb";K.LinkedEntity="LinkedEntity";K.$Fc="List";K.ack="ListToTable";
K.Load="Load";K.A4d="Logical";K.jck="ManageDataSources";K.Map="Map";K.lck="MapToEntity";K.uck="MashupGraphCollapse";K.vck="MashupGraphExpand";K.wck="MashupGraphRelated";K.yck="MathInfo";K.Dck="MergeColumns";K.Fck="MergeQueries";K.Gck="MergeQueriesAsNew";K.Qck="MonocolorAccess";K.Rck="MonocolorExcel";K.Sck="MonocolorExchange";K.Tck="More";K.Uck="MoveColumns";K.Vck="MoveColumnsLeft";K.Wck="MoveColumnsRight";K.Xck="MoveColumnsToBeginning";K.Yck="MoveColumnsToEnd";K.Zck="MoveDown";K.$ck="MoveLeft";K.adk=
"MoveRight";K.bdk="MoveUp";K.qdk="Neutral";K.Number="Number";K.E4d="OData";K.URb="Odbc";K.Parameter="Parameter";K.dGc="Parquet";K.Aek="Parse";K.Paste="Paste";K.eGc="Pdf";K.Bek="Pencil";K.Percentage="Percentage";K.Eek="PivotColumn";K.Gek="Plus";K.Gqg="PowerBI";K.Qek="PowerBIReport";K.Wek="PowerQuery";K.Yek="PrimitiveToList";K.Zek="PrivacyBuffering";K.bfk="PromoteHeaders";K.Properties="Properties";K.rfk="QuerySettings";K.sfk="QuestionMark";K.G4d="Record";K.Reference="Reference";K.yfk="Refresh";K.Afk=
"RemoveAlternateRows";K.Bfk="RemoveBlankRows";K.Cfk="RemoveBottomRows";K.Dfk="RemoveColumns";K.Efk="RemoveDuplicates";K.Ffk="RemoveErrors";K.Gfk="RemoveOtherColumns";K.Hfk="RemoveRows";K.Ifk="RemoveTopRows";K.Jfk="Rename";K.Kfk="ReplaceErrors";K.Lfk="ReplaceValues";K.Mfk="Reset";K.Pfk="ReverseRows";K.Qfk="Rounding";K.M4d="Salesforce";K.Save="Save";K.Yfk="Scientific";K.Zfk="Script";K.fgk="Sensitivity";K.Settings="Settings";K.hgk="Share";K.O4d="SharePoint";K.igk="Sheet";K.jgk="SheetAccess";K.kgk="SheetCsv";
K.lgk="SheetDataflow";K.mgk="SheetExcel";K.ngk="SheetHtml";K.ogk="SheetJson";K.pgk="SheetSql";K.qgk="SheetText";K.rgk="SheetXml";K.zgk="SortAscending";K.Agk="SortDescending";K.P4d="Spark";K.Dgk="SplitColumn";K.org="Standard";K.Igk="StarFill";K.Jgk="StarStroke";K.Lgk="Statistics";K.Success="Success";K.Rgk="Suggestion";K.Tgk="Support";K.Table="Table";K.Zgk="TableSchema";K.Template="Template";K.Text="Text";K.dhk="TextFile";K.Time="Time";K.Ahk="ToTable";K.Fhk="Transpose";K.Mhk="Trigonometry";K.Uhk="UnknownType";
K.Vhk="UnpivotColumns";K.bsg="Vertica";K.dik="VerticalLayout";K.View="View";K.Z4d="Visual";K.Warning="Warning";K.YRb="Web";K.nik="Website";K.esg="WholeNumber";K.Worksheet="Worksheet"})(Ni||(Ni={}));var di;(function(K){K.oak="FullRefresh";K.lbk="IncrementalRefresh"})(di||(di={}));var ei;(function(K){K.Qog="Days";K.rqg="Months";K.efk="Quarters";K.qik="Years"})(ei||(ei={}));var fi;(function(K){K.Custom="Custom";K.org="Standard";K.Xgk="System"})(fi||(fi={}));var Fg;(function(K){K.C$j="EvaluateTop1000Rows";
K.B$j="EvaluateEntireDataset"})(Fg||(Fg={}));var xh;(function(K){K.Action="Action.Type";K.V3d="Any.Type";K.X3d="Binary.Type";K.i7j="Byte.Type";K.Character="Character.Type";K.i4d="Currency.Type";K.Date="Date.Type";K.DateTime="DateTime.Type";K.m4d="DateTimeZone.Type";K.Sog="Decimal.Type";K.Double="Double.Type";K.Duration="Duration.Type";K.Function="Function.Type";K.ubk="Int16.Type";K.vbk="Int32.Type";K.Int64="Int64.Type";K.wbk="Int8.Type";K.$Fc="List.Type";K.A4d="Logical.Type";K.None="None.Type";K.uqg=
"Null.Type";K.Number="Number.Type";K.Percentage="Percentage.Type";K.G4d="Record.Type";K.ugk="Single.Type";K.Table="Table.Type";K.Text="Text.Type";K.Time="Time.Type";K.Type="Type.Type"})(xh||(xh={}));var gi;(function(K){K.XRb="Sql";K.Z4d="Visual"})(gi||(gi={}));var ti;(function(K){K.ddk="MultiLine";K.SingleLine="SingleLine"})(ti||(ti={}));var ui;(function(K){K.Always="Always";K.$6j="BasedOnProjectSettings";K.C4d="Never"})(ui||(ui={}));var Oi;(function(K){K.H7j="Collapsed";K.U$j="Expanded";K.Ack="Maximized"})(Oi||
(Oi={}));var Pi;(function(K){K.Host="Host";K.obk="Initialization";K.Zhk="UserInteraction"})(Pi||(Pi={}));var Mh;(function(K){K.Action="action";K.V3d="any";K.H6j="anynonnull";K.X3d="binary";K.i4d="currency";K.Date="date";K.DateTime="datetime";K.m4d="datetimezone";K.Duration="duration";K.O$j="exception";K.Function="function";K.$Fc="list";K.A4d="logical";K.None="none";K.uqg="null";K.Number="number";K.Percentage="percentage";K.G4d="record";K.Table="table";K.Text="text";K.Time="time";K.Type="type";K.esg=
"wholenumber"})(Mh||(Mh={}));var oh;(function(K){K.Default="default";K.W6j="azureportal-v1.0.0"})(oh||(oh={}));var vi;(function(K){K.P6j="Auto";K.Cek="Percent";K.Fek="Pixels"})(vi||(vi={}));var Xh;(function(K){K.Cells="Cells";K.Columns="Columns";K.Rows="Rows"})(Xh||(Xh={}));var Bh;(function(K){K.Access="access";K.IRb="activeDirectory";K.JRb="adobeAnalytics";K.SFc="analysisServices";K.TFc="azureAnalysisServices";K.KRb="azureBlobs";K.kng="azureDataLake";K.mng="azureHdInsightHdfs";K.W3d="azureSql";K.nng=
"azureSqlDW";K.LRb="azureTables";K.sng="blank";K.Rog="db2";K.o4d="dynamics365";K.$og="enterData";K.Excel="excel";K.cpg="exchangeOnline";K.ipg="folderContents";K.kpg="folderFiles";K.SRb="googleAnalytics";K.YFc="json";K.aGc="mySql";K.xqg="odata";K.URb="odbc";K.cGc="oracle";K.dGc="parquet";K.eGc="pdf";K.Fqg="postgreSql";K.krg="sharepointFolder";K.lrg="sharepointList";K.mrg="sharepointOnlineList";K.crg="salesforceObjects";K.drg="salesforceReports";K.frg="SapBusinessWarehouseAppServer";K.grg="SapBusinessWarehouseMessageServer";
K.irg="SapHanaDatabase";K.XRb="sql";K.gGc="sybase";K.jGc="teradata";K.U4d="textCsv";K.YRb="web";K.csg="webApi";K.$4d="xml"})(Bh||(Bh={}));var hi;(hi||(hi={})).dpg="extension";var Ch;(function(K){K.jik="WaitingToStart";K.E$j="EvaluatingRelationships";K.iik="WaitingForOtherEntities";K.F$j="EvaluatingSchema";K.K9j="DeletingEntity";K.k8j="CreatingEntity";K.M9j="DeletingExistingData";K.D$j="EvaluatingData";K.cfk="ProvisioningTempStorage";K.Yhk="UploadingDataToTempStorage";K.pbk="InitializingLoadSession";
K.gik="WaitingForLoadSessionToInitialize";K.i8j="CreatingDefinitionGroup";K.j8j="CreatingDefinitionGroupDetails";K.Xhk="UploadingData";K.zak="GeneratingFieldMapping";K.R6j="AutoSequencing";K.P$j="ExecutingLoad";K.hik="WaitingForLoadToComplete";K.yak="GeneratingExecutionErrors";K.Success="Success";K.tgk="SignInRequired";K.N9j="DeletingExistingDataFailed";K.H$j="EvaluationFailed";K.l8j="CreatingEntityFailed";K.L9j="DeletingEntityFailed";K.Ofk="RetrievingEntityMetadataFailed";K.Canceled="Canceled";K.eck=
"LoadToCdsPartiallySucceeded";K.dck="LoadToCdsFailed";K.bck="LoadFailedDueToErrorInOtherEntity";K.Unknown="Unknown"})(Ch||(Ch={}));var Di;(function(K){K.S7j="Composition";K.T7j="Conditional";K.e8j="CountDistinctValues";K.g8j="CountValues";K.h9j="Date_Age";K.i9j="Date_CombineWithTime";K.j9j="Date_Day";K.k9j="Date_DayOfWeek";K.l9j="Date_DayOfWeekName";K.m9j="Date_DayOfYear";K.n9j="Date_DaysInMonth";K.o9j="Date_Earliest";K.p9j="Date_EndOfDay";K.q9j="Date_EndOfMonth";K.r9j="Date_EndOfQuarter";K.s9j="Date_EndOfWeek";
K.t9j="Date_EndOfYear";K.u9j="Date_From";K.v9j="Date_Latest";K.w9j="Date_Month";K.x9j="Date_MonthName";K.y9j="Date_QuarterOfYear";K.z9j="Date_StartOfDay";K.A9j="Date_StartOfMonth";K.B9j="Date_StartOfQuarter";K.C9j="Date_StartOfWeek";K.D9j="Date_StartOfYear";K.E9j="Date_SubtractDays";K.F9j="Date_WeekOfMonth";K.G9j="Date_WeekOfYear";K.H9j="Date_Year";K.c9j="DateTime_Earliest";K.d9j="DateTime_From";K.e9j="DateTime_Latest";K.f9j="DateTime_Subtract";K.g9j="DateTime_SubtractDays";K.X8j="DateTimeZone_Earliest";
K.Y8j="DateTimeZone_From";K.Z8j="DateTimeZone_Latest";K.$8j="DateTimeZone_Subtract";K.a9j="DateTimeZone_SubtractDays";K.b9j="DateTimeZone_ToLocal";K.Fdk="Number_Abs";K.Gdk="Number_Acos";K.Hdk="Number_Asin";K.Idk="Number_Atan";K.Jdk="Number_Average";K.Kdk="Number_Cos";K.Ldk="Number_Cube";K.Mdk="Number_Divide";K.Ndk="Number_Exp";K.Odk="Number_Factorial";K.Pdk="Number_From";K.Qdk="Number_IntegerDivide";K.Rdk="Number_IsEven";K.Sdk="Number_IsOdd";K.Tdk="Number_Ln";K.Udk="Number_Log10";K.Vdk="Number_Maximum";
K.Wdk="Number_Median";K.Xdk="Number_Minimum";K.Ydk="Number_Modulo";K.Zdk="Number_MultiplyColumnAndConstant";K.$dk="Number_MultiplyColumns";K.aek="Number_PercentOf";K.bek="Number_Power";K.cek="Number_Range";K.dek="Number_Round";K.eek="Number_RoundDown";K.fek="Number_RoundUp";K.gek="Number_Sign";K.hek="Number_Sin";K.iek="Number_Sqrt";K.jek="Number_Square";K.kek="Number_StandardDeviation";K.lek="Number_Subtract";K.mek="Number_SumColumnAndConstant";K.nek="Number_SumColumns";K.oek="Number_Tan";K.Reference=
"Reference";K.ehk="Text_AfterDelimiter";K.fhk="Text_BeforeDelimiter";K.ghk="Text_BetweenDelimiters";K.hhk="Text_Combine";K.ihk="Text_End";K.jhk="Text_Length";K.khk="Text_Literal";K.lhk="Text_Middle";K.mhk="Text_Reference";K.nhk="Text_Remove";K.ohk="Text_Replace";K.phk="Text_Select";K.qhk="Text_Start";K.rhk="Time_Earliest";K.shk="Time_EndOfHour";K.thk="Time_From";K.uhk="Time_Hour";K.vhk="Time_Latest";K.whk="Time_Minute";K.xhk="Time_Second";K.yhk="Time_StartOfHour";K.zhk="Time_Subtract"})(Di||(Di={}));
var ii;(function(K){K.Nrg="UnknownError";K.zbk="InvalidConnectionProvider"})(ii||(ii={}));var Xc;(function(K){K.hng="Adf";K.Zng="CdsA";K.Desktop="Desktop";K.W9j="DmtsPowerBi";K.Y9j="DmtsSa";K.None="None";K.Iek="PowerApps";K.$fk="SelfHosted"})(Xc||(Xc={}));var Ed;(function(K){K.Ggk="SqlDw";K.Wgk="SynapseOnDemand"})(Ed||(Ed={}));var bh;(function(K){K.G6j="Analytical";K.Chk="Transactional"})(bh||(bh={}));var Ei;(function(K){K[K.hkk=0]="sunday";K[K.Hjk=1]="monday";K[K.lkk=2]="tuesday";K[K.skk=3]="wednesday";
K[K.jkk=4]="thursday";K[K.cjk=5]="friday";K[K.akk=6]="saturday"})(Ei||(Ei={}));var wi;(function(K){K.Q6j="AutoFilterColumnValues";K.b7j="BinaryMetadata";K.b8j="ConnectorRows";K.c8j="ConnectorSchema";K.p8j="CubeAllowedValues";K.u8j="CubeDisplayFolders";K.w8j="CubeParameters";K.I8j="DataSourceQuery";K.R9j="DetailsPreview";K.T9j="DetectTableHeaderAndColumnTypes";K.N$j="ExcelTableInferenceGetInferredTables";K.T$j="ExpandColumnNames";K.qak="FunctionBrowser";K.Nbk="JsonTableInferenceGetJsonText";K.cck=
"LoadToCdsCreateEntitiesRelationships";K.fck="LoadToCdsRelationships";K.gck="LoadToCdsSchema";K.ock="MappingEditorQueryProfiling";K.pck="MappingEditorSchemaResult";K.qck="MappingEditorTypeMetadata";K.xck="MashupLoad";K.Eck="MergeMatchAnalysis";K.Hck="MergeQueriesPreview";K.Ick="MergeQueriesSuggestionsPreview";K.idk="NavigatorCubeAllowedValues";K.jdk="NavigatorCubeParameters";K.kdk="NavigatorCubePreview";K.ldk="NavigatorDiscoverRelatedTables";K.mdk="NavigatorPreview";K.ndk="NavigatorTemporaryQueryForIndirectionNode";
K.Preview="Preview";K.ffk="QueryAnalysis";K.lfk="QueryPlan";K.mfk="QuerySanitizer";K.nfk="QuerySanitizerAnalysis";K.ofk="QuerySanitizerQueryAnalysis";K.qfk="QueryScriptPreview";K.dgk="SemanticEntitySets";K.agk="SemanticDataGetData";K.bgk="SemanticDataList";K.cgk="SemanticDataSearchInDataflow";K.Egk="SplitColumnInferMultiplePositions";K.Fgk="SplitColumnNumberOfColumns";K.Mgk="StepAnalysis";K.Ygk="TableProfiler";K.chk="TextByExampleGetText";K.kik="WebByExampleExecuteSelectors";K.mik="WebByExampleGetHtml"})(wi||
(wi={}));var ji;(function(K){K.Boolean="Boolean";K.V8j="DateAndTime";K.W8j="DateOnly";K.Sog="Decimal";K.Double="Double";K.xbk="Integer";K.hck="Lookup";K.Bck="Memo";K.Pck="Money";K.String="String"})(ji||(ji={}));var Fi;(function(K){K.Nfk="Resource";K.Dek="Personal";K.eik="VirtualNetwork"})(Fi||(Fi={}));var ph;(function(K){K.mog="Critical";K.Error="Error";K.Warning="Warning";K.Informational="Informational";K.cik="Verbose"})(ph||(ph={}));var xg;(function(K){K[K.Lik=0]="connectionNotFound";K[K.Yik=1]=
"failedToRefreshConnection";K[K.mkk=2]="unauthorizedConnection"})(xg||(xg={}));var Gi;(function(K){K.V9j="DifferentUser";K.rdk="NoMatchingConnection";K.zdk="NonOAuthConnection ";K.ydk="NoToken"})(Gi||(Gi={}));var Dh;(function(K){K.v6j="ActivePowerAppsEnvironment";K.bbk="HardDeletedPowerAppsEnvironment";K.ygk="SoftDeletedPowerAppsEnvironment";K.Unknown="UnknownPowerAppsEnvironment"})(Dh||(Dh={}));var ki;(ki||(ki={})).nck="MappingEditorProperties";var li;(function(K){K[K.day=0]="day";K[K.month=1]="month";
K[K.quarter=2]="quarter";K[K.year=3]="year"})(li||(li={}));var Hi;(function(K){K.Kck="Minutes";K.gbk="Hours";K.Qog="Days";K.oik="Weeks";K.rqg="Months"})(Hi||(Hi={}));var Th;(function(K){K[K.qkk=1]="uploadFileMalformedMultipartContent";K[K.rkk=2]="uploadFileUnsupportedFileExtension";K[K.Mjk=3]="oAuthStartLoginFailed";K[K.Ljk=4]="oAuthFinishLoginFailed";K[K.Jjk=8]="normalizeResourceFailed";K[K.Rik=9]="editVersionMismatch";K[K.nkk=10]="updateGatewayVersion";K[K.Djk=11]="mashupTooLong";K[K.djk=12]="gatewayBindingMultipleMatchingGatewayError";
K[K.ejk=13]="gatewayBindingNoMatchingDataSourceError";K[K.fjk=14]="gatewayBindingNoMatchingGatewayError"})(Th||(Th={}));var mi;(function(K){K.a8j="ConnectionsAuthorizationFailed";K.f$j="DuplicateQueryId";K.g$j="DuplicateQueryName";K.h$j="DuplicateStepName";K.rck="MashupDocumentNotASectionDocument";K.F4d="ParsingError";K.Rhk="UnexpectedQueryIdFormat"})(mi||(mi={}));var Uh;(function(K){K.udk="NoTextExampleFound";K.vdk="NoTextProgramFound";K.wdk="NoTextProgramFoundBeforeCancellation";K.xdk="NoTextProgramFoundBeforeTimeout"})(Uh||
(Uh={}));var tg;(function(K){K.Qgk="Successful";K.Failed="Failed";K.ggk="SessionExpired"})(tg||(tg={}));var Dg;(function(K){K.r6j="AM";K.xek="PM"})(Dg||(Dg={}));var xi;(function(K){K[K.anonymous=1]="anonymous";K[K.basic=2]="basic";K[K.oAuth2=3]="oAuth2";K[K.windows=4]="windows";K[K.key=5]="key";K[K.$jk=6]="sas"})(xi||(xi={}));var Jh;(function(K){K.Access="access";K.IRb="activeDirectory";K.JRb="adobeAnalytics";K.SFc="analysisServices";K.TFc="azureAnalysisServices";K.KRb="azureBlobs";K.kng="azureDataLake";
K.mng="azureHdInsightHdfs";K.W3d="azureSql";K.nng="azureSqlDW";K.LRb="azureTables";K.sng="blank";K.Rog="db2";K.o4d="dynamics365";K.$og="enterData";K.Excel="excel";K.cpg="exchangeOnline";K.ipg="folderContents";K.kpg="folderFiles";K.SRb="googleAnalytics";K.YFc="json";K.aGc="mySql";K.xqg="odata";K.URb="odbc";K.cGc="oracle";K.dGc="parquet";K.eGc="pdf";K.Fqg="postgreSql";K.krg="sharepointFolder";K.lrg="sharepointList";K.mrg="sharepointOnlineList";K.crg="salesforceObjects";K.drg="salesforceReports";K.frg=
"SapBusinessWarehouseAppServer";K.grg="SapBusinessWarehouseMessageServer";K.irg="SapHanaDatabase";K.XRb="sql";K.gGc="sybase";K.jGc="teradata";K.U4d="textCsv";K.YRb="web";K.csg="webApi";K.$4d="xml"})(Jh||(Jh={}));var Ii;(function(K){K.Count="Count";K.apg="ErrorCount";K.vqg="NullCount";K.Vog="DistinctCount";K.Mrg="UniqueCount";K.Min="Min";K.Max="Max";K.asg="ValueDistribution";K.Average="Average";K.Yog="EmptyStringCount";K.Hrg="TextLengthDistribution";K.sqg="NaNCount";K.hsg="ZeroCount";K.bpg="EvenCount";
K.yqg="OddCount";K.prg="StandardDeviation";K.nrg="SignDistribution";K.Dqg="ParityDistribution";K.Irg="TrueCount";K.gpg="FalseCount";K.gsg="YearDistribution";K.qqg="MonthDistribution";K.Oog="DayDistribution";K.dsg="WeekOfYearDistribution";K.Pog="DayOfWeekDistribution";K.ing="AmPmDistribution";K.Mpg="HourDistribution"})(Ii||(Ii={}));var ni;(function(K){K.t6j="AccessPremiumConnectionNotAllowed";K.A6j="AdfConnectionEvaluationError";K.X7j="ConnectionCouldNotBeCreated";K.Y7j="ConnectionKindNotSupported";
K.Z7j="ConnectionNotFound";K.$7j="ConnectionShareNotAllowedInEnvironment";K.E8j="DataAccessError";K.T8j="DataflowDatasourceIsReadOnly";K.d$j="DuplicateDataSourceNameError";K.ppg="GatewayDetailsNotFound";K.qpg="GatewayNotAuthorized";K.sak="GatewayRequired";K.rpg="GatewayUnreachable";K.uak="GatewayUnsupportedByLicense";K.Abk="InvalidCredentials";K.Bbk="InvalidPath";K.pek="OboSignInError";K.Bhk="TooManyConnections";K.Shk="UnknownDmtsError";K.Nrg="UnknownError";K.Thk="UnknownGatewayError"})(ni||(ni={}));
var Kh;(function(K){K.vgk="Singleton";K.Database="Database";K.Uri="Uri";K.Custom="Custom"})(Kh||(Kh={}));var oi;(function(K){K.g7j="BuiltIn";K.dpg="Extension"})(oi||(oi={}));var pf;(function(K){K[K.Zik=0]="false";K[K.kkk=1]="true";K[K.notApplicable=2]="notApplicable";K[K.Wik=3]="existingConnection"})(pf||(pf={}));var Nh;(function(K){K.h4d="Cancelled";K.e$j="DuplicateEvaluationId";K.u$j="ErrorGettingPowerBIPrivateLinkConfig";K.G$j="EvaluationAgentNotFound";K.I$j="EvaluationQuotaReached";K.W$j="ExternalServiceError";
K.ppg="GatewayDetailsNotFound";K.qpg="GatewayNotAuthorized";K.rak="GatewayNotFound";K.tak="GatewayUnknownError";K.rpg="GatewayUnreachable";K.vak="GatewayUpgradeRequired";K.wak="GatewayUserError";K.tck="MashupEntityNotFound";K.zck="MaxConcurrentEvaluationsReached";K.pdk="NetworkAccessDenied";K.tdk="NoPowerBiClusterForTenant";K.zek="ParameterNotFound";K.Jek="PowerAppsEnvironmentNotFound";K.ifk="QueryNameAndQueryScriptBothSpecified";K.jfk="QueryNameAndQueryScriptNotSpecified";K.kfk="QueryNotFound";K.Pgk=
"StepNotFound";K.Phk="UnableToContactBackend";K.Unknown="Unknown";K.Whk="UnsupportedKind";K.bik="ValueTooComplex"})(Nh||(Nh={}));var ch;(function(K){K.Path="Path";K.pfk="QueryScript"})(ch||(ch={}));var Gg;(function(K){K.None="None";K.V3d="Any";K.Access="Access";K.Excel="Excel";K.YFc="Json";K.U4d="TextCsv";K.eGc="Pdf";K.$4d="Xml"})(Gg||(Gg={}));var Hg;(Hg||(Hg={})).$Fc="List";var Yh;(function(K){K.Cck="MenuItem";K.Separator="Separator"})(Yh||(Yh={}));var Zh;(function(K){K.E6j="AlwaysWhenInferringAllColumnTypes";
K.Z6j="BasedOnMetadata";K.C4d="Never"})(Zh||(Zh={}));var Eh;(function(K){K.Always="Always";K.C4d="Never";K.cbk="HasNewLoadableQueries";K.Edk="NumberOfQueries"})(Eh||(Eh={}));var sh;(function(K){K.t$j="Equals";K.Sak="GreaterThan";K.Tak="GreaterThanOrEqual";K.Ybk="LessThan";K.Zbk="LessThanOrEqual"})(sh||(sh={}));var dh;(function(K){K.hng="Adf";K.N6j="Athena";K.X6j="AzureSearch";K.c7j="BingAtWork";K.Zng="CdsA";K.o7j="CdsLite";K.p7j="CdsT";K.q7j="CdsAdHoc";K.A8j="CustomerInsights";K.B8j="CustomerInsightsPPDF";
K.D8j="D365TalentInsights";K.F8j="DataIntegration";K.P9j="DesktopBootstrap";K.Q9j="DesktopUITester";K.X9j="DmtsPowerBiExperimental";K.Z9j="DmtsSaExperimental";K.K$j="ExcelDesktop";K.L$j="ExcelOnline";K.M$j="ExcelOnlineCdsAExperimental";K.V$j="Experimental";K.gak="Flow";K.ybk="IntelligentOrderManagement";K.Spg="InternalPortal";K.Vbk="KustoViewDesigner";K.sck="MashupEditorBootstrap";K.Kek="PowerAppsTeams";K.Lek="PowerBIDataMart";K.Nek="PowerBIModeling";K.Pek="PowerBIPaginatedReports";K.Oek="PowerBIPPDF";
K.Rek="PowerBIReportView";K.Sek="PowerPlatformDataflowAdlsGen2";K.Uek="PowerPlatformDataflowsBootstrap";K.Vek="PowerPlatformExperimental";K.Xek="PowerQueryDesktop";K.afk="ProcessAdvisor";K.Sgk="SupplyChainVisibility";K.Ugk="SustainabilityCloud";K.Vgk="Synapse";K.Ihk="TridentDataflow";K.Ghk="TridentDataPipeline";K.Hhk="TridentDataWarehouse";K.Khk="TridentLakehouse";K.Jhk="TridentLakeWarehouse";K.Lhk="TridentSynapseLink"})(dh||(dh={}));var pi;(function(K){K.NaN="NaN";K.odk="NegativeInfinity";K.Hek=
"PositiveInfinity";K.mak="FormattedNumber";K.Number="Number"})(pi||(pi={}));var $h;(function(K){K.Access="Access";K.IRb="ActiveDirectory";K.B6j="AdoDotNet";K.JRb="AdobeAnalytics";K.SFc="AnalysisServices";K.KRb="AzureBlobs";K.lng="AzureDataLakeStorage";K.LRb="AzureTables";K.n7j="CDPA";K.y8j="CurrentWorkbook";K.Fog="DB2";K.Environment="Environment";K.A$j="Essbase";K.Exchange="Exchange";K.File="File";K.t4d="Folder";K.nak="Ftp";K.SRb="GoogleAnalytics";K.Fpg="HDInsight";K.dbk="Hdfs";K.nbk="Informix";K.ick=
"MQ";K.Jck="MicrosoftInformationProtection";K.aGc="MySql";K.E4d="OData";K.URb="Odbc";K.sek="OleDb";K.cGc="Oracle";K.Eqg="PostgreSQL";K.Mek="PowerBI";K.Python="Python";K.R="R";K.M4d="Salesforce";K.erg="SapBusinessWarehouse";K.hrg="SapHana";K.O4d="SharePoint";K.P4d="Spark";K.XRb="SQL";K.Hgk="Staging";K.gGc="Sybase";K.jGc="Teradata";K.YRb="Web"})($h||($h={}));var ai;(function(K){K.abk="GroupNestingLimitReached";K.Ddk="NullMashupXml";K.Unknown="Unknown"})(ai||(ai={}));var Qi;(function(K){K.P7j="CompletedSuccessfully";
K.Q7j="CompletedWithExpectedError";K.R7j="CompletedWithUnexpectedError";K.Kgk="Started"})(Qi||(Qi={}));var Ri;(function(K){K.s6j="Above";K.a7j="Below"})(Ri||(Ri={}));var Vg;(function(K){K.L6j="Ascii";K.aik="Utf8";K.$hk="Utf16";K.pik="Windows"})(Vg||(Vg={}));var Ji;(function(K){K.Excel="Excel";K.YFc="Json";K.dGc="Parquet";K.Text="Text"})(Ji||(Ji={}));var yi;(function(K){K.I7j="Colon";K.L7j="Comma";K.None="None";K.egk="Semicolon";K.Cgk="Space";K.Tab="Tab"})(yi||(yi={}));var qi;(function(K){K.J$j="Even";
K.qek="Odd"})(qi||(qi={}));var zi;(function(K){K.None="None";K.$ek="Private";K.wek="Organizational";K.dfk="Public"})(zi||(zi={}));var Fh;(function(K){K.S6j="AzureBlob";K.Database="Database"})(Fh||(Fh={}));var ri;(function(K){K.i$j="DynamicPlanFolded";K.j$j="DynamicPlanMightFold";K.k$j="DynamicPlanNotFolded";K.l$j="DynamicPlanOpaque";K.v$j="ErrorRetrievingPlan";K.hak="FoldedQueryNotImplemented";K.iak="FoldedQueryNull";K.jak="FoldedWithQuery";K.Adk="NotFolded";K.Bdk="NotFoldedPrivacyBuffering";K.Cdk=
"NotTable";K.uek="OpaqueConstant";K.Qhk="UnexpectedPlanKind"})(ri||(ri={}));var Ai;(function(K){K.IRb="ActiveDirectory";K.JRb="AdobeAnalytics";K.F6j="AmazonRedshift";K.SFc="AnalysisServices";K.TFc="AzureAnalysisServices";K.KRb="AzureBlobs";K.T6j="AzureDataExplorer";K.lng="AzureDataLakeStorage";K.LRb="AzureTables";K.j6j="AIFunctions";K.ang="AIInsights";K.V6j="AzureMLFunctions";K.k6j="AIInsightsInProc";K.Yng="Cds";K.N7j="CommonDataService";K.G8j="DataLake";K.Nog="Dataverse";K.Fog="DB2";K.r$j="ElasticSearch";
K.Exchange="Exchange";K.hpg="Fhir";K.File="File";K.t4d="Folder";K.SRb="GoogleAnalytics";K.Rak="GoogleBigQuery";K.Fpg="HDInsight";K.jbk="Impala";K.x4d="Kusto";K.Wbk="Lakehouse";K.aGc="MySql";K.E4d="OData";K.URb="Odbc";K.cGc="Oracle";K.vek="OracleERP";K.Eqg="PostgreSQL";K.Gqg="PowerBI";K.Tek="PowerPlatformDataflows";K.yek="PQGenericInvokeTestExtension";K.M4d="Salesforce";K.erg="SapBusinessWarehouse";K.Vfk="SAPERP";K.hrg="SapHana";K.O4d="SharePoint";K.xgk="Snowflake";K.P4d="Spark";K.Wfk="SQL";K.gGc=
"Sybase";K.jGc="Teradata";K.bsg="Vertica";K.YRb="Web"})(Ai||(Ai={}));var Pg;(function(K){K.hog="CompilationError";K.F4d="ParsingError";K.Success="Success";K.Lrg="UnexpectedDocumentKind"})(Pg||(Pg={}));var bi;(function(K){K[K.Uik=0]="endpointNotAvailableInRegion";K[K.pjk=1]="httpError";K[K.qjk=2]="invalidInput";K[K.Fjk=3]="maxRetriesReached";K[K.Gjk=4]="modelError"})(bi||(bi={}));var eh;(function(K){K.Error="Error";K.rek="Ok"})(eh||(eh={}));var Rh;(function(K){K.Column="Column";K.K7j="ColumnType";
K.Count="Count";K.apg="ErrorCount";K.vqg="NullCount";K.Vog="DistinctCount";K.Mrg="UniqueCount";K.Min="Min";K.Max="Max";K.asg="ValueDistribution";K.Average="Average";K.Yog="EmptyStringCount";K.Hrg="TextLengthDistribution";K.sqg="NaNCount";K.hsg="ZeroCount";K.bpg="EvenCount";K.yqg="OddCount";K.prg="StandardDeviation";K.nrg="SignDistribution";K.Dqg="ParityDistribution";K.Irg="TrueCount";K.gpg="FalseCount";K.gsg="YearDistribution";K.qqg="MonthDistribution";K.Oog="DayDistribution";K.dsg="WeekOfYearDistribution";
K.Pog="DayOfWeekDistribution";K.ing="AmPmDistribution";K.Mpg="HourDistribution"})(Rh||(Rh={}));var Bi;(function(K){K.K8j="DataSourceTag";K.hfk="QueryEditorMessageBar";K.tfk="QuickCreateForm";K.lik="WebByExampleForm"})(Bi||(Bi={}));var Oh;(function(K){K.hog="CompilationError";K.F4d="ParsingError";K.Success="Success";K.Lrg="UnexpectedDocumentKind"})(Oh||(Oh={}));var ug;(function(K){K.Link="Link";K.Text="Text"})(ug||(ug={}));const Vh=["pqo_enableDebugLogging"];class Ci{constructor(K,ob){this.D2h=(Sb,
kc,yc)=>this.mdh(this.C2h(Sb,kc),yc);this.rZh=Sb=>{const kc=this.$.va.PowerQueryEndpointUrl;return{Kte:`${kc}`,container:Sb,url:`${kc}/MashupEditor`+this.qZh(),className:"mashup-editor-frame"}};this.sZh=()=>({locale:this.$.va.UICultureTag,sessionId:this.$.va.UserSessionId});this.qZh=()=>{var Sb=new URLSearchParams;const kc=new URLSearchParams(window.location.search);for(const [yc,bd]of kc)Vh.includes(yc)&&Sb.append(yc,bd);Sb=Sb.toString();return""!==Sb?"?"+Sb:""};this.$=ob;this.CUg=K}mdh(K,ob){return(Sb,
kc)=>Object(sf.a)(this,void 0,void 0,function*(){var yc=this.rZh(Sb);yc=new Ef({V$:yc,Jqh:this.sZh(),FVc:this.CUg});yield yc.ready;yield yc.aXd(K,bd=>Object(sf.a)(this,void 0,void 0,function*(){yield ob(bd);return bd.dispose().then(kc)}),bd=>bd.dispose().then(kc))})}C2h(K,ob){return{kind:vb.Oqg,ojk:{type:hd.EwaSettings.isChangeGateEnabled("OfficeVSO:7250383_PassPQHostContextBootContext")?this.$.va.PowerQueryHostContextType:dh.Spg,details:{}},Xjk:K,Yjk:ob,settings:{ljk:!0,mjk:!0,njk:!0}}}}Object(fa.a)(Ci,
"MashupEditorFlowBuilder",null,[]);class Si extends wb.a{constructor(K,ob){super(K);this.kIa=()=>{this.hide();return Promise.resolve()};ua.ULS.sendTraceTag(512267668,0,50,"PowerQueryReactFlowDialog.PowerQueryReactFlowDialog");this.Pq=ob;this.Pq.id=this.pc;this.Pq.CloseDialogCallback=this.kIa}get pc(){return"PowerQueryFlowDialog"}dg(){this.initializeAndShow("",null,this.Pq)}}Object(fa.a)(Si,"PowerQueryReactFlowDialog",wb.a,[]);class $f{constructor(K,ob){this.lpj={["height"]:380,["width"]:600};this.$=
ob;this.EGi=new Ci(K,ob)}K5c(K,ob,Sb){let kc;switch(ob){case -1496653501:kc=this.B2h(Sb.kind,Sb.path,K)}return new Si(this.$,kc)}B2h(K,ob,Sb){const kc=this.bUh();kc.StartFlowCallback=this.EGi.D2h(K,ob,Sb);return kc}bUh(){const K={IsModal:!0};K.bodyProps=this.lpj;return K}}Object(fa.a)($f,"PowerQueryReactFlowDialogBuilder",null,[]);class Gh{constructor(K,ob){this.$=K;this.powerQueryManager=ob;this.v7i=new $f(ob.r0e,K)}Jc(){return!1}nc(){return!1}executeCommand(K,ob,Sb){K=ub.TaskExtensions.Rj();switch(ob.command){case -1496653501:return this.wNj(Sb),
K;default:return Jd.a(ob.command)}}dispose(){this.$=this.powerQueryManager=null}wc(K,ob){switch(ob.command){case -1496653501:return!0;default:return!1}}wNj(K){this.v7i.K5c(this.qSh(K.Vjk),-1496653501,K).dg()}qSh(K){return ob=>Object(sf.a)(this,void 0,void 0,function*(){const Sb=[];(yield ob.kgd()).Mik.forEach(kc=>{Sb.push({K:kc.kind,P:kc.path,ID:kc.connectionName})});df(this.$.pa.ya,Sb,kc=>{!kc||0<kc.Errors.length?ua.ULS.sendTraceTag(509743360,0,10,`PowerQueryUIFlowManager:ResolveChallenge: success callback failure: ${kc.Result}`):
(ua.ULS.sendTraceTag(509743331,0,50,"PowerQueryUIFlowManager:ResolveChallenge: Write Roaming succeeded"),this.powerQueryManager.$tc(K))},()=>{ua.ULS.sendTraceTag(509743330,0,10,"PowerQueryUIFlowManager:ResolveChallenge: Write Roaming failed")},null,null)})}}Object(fa.a)(Gh,"PowerQueryUIFlowManager",null,[165,2]);class Ki extends Vb.a{constructor(K){super(K)}nd(){this.$.ny(()=>{ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(this.$.da,470,471,this.Ya),K=>{this.Yc([new Gh(this.$,K.result)])},this.$.la,
3)})}static ka(K){Vb.a.Nd(512,new Ki(K))}}Object(fa.a)(Ki,"PowerQueryUIFlowManagerFactory",Vb.a,[]);class ci{getExpandedRangeForPivotTable(K,ob,Sb,kc,yc,bd,Fd,Nd=null){Nd=K.Na(1,Nd);Nd.sheetRange=ob;Nd.activeCell=Sb;return za.g(K,"GetExpandedRangeForPivotTable",Nd,kc,yc,bd,Fd,0)}}Object(fa.a)(ci,"ExpandRange",null,[707]);class th extends Ke.a{constructor(K){super();this.$=K;this.Fb()}static ka(K){K.da.Ga(483,new th(K))}create(){var K;this.ob(null!==(K=this.$.da.za(482))&&void 0!==K?K:this.$.da.Ga(482,
new ci))}}Object(fa.a)(th,"ExpandRangeFactory",Ke.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");xa.a.Mi(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");
xa.a.Mi('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
xa.a.Mi('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(()=>{td.a.Fa(K=>{ub.TaskExtensions.Aa(ta.GetServiceTaskFactory.Oa(K.da,12,477,1),ob=>{Pb.ka(K,ob.result)},K.la)})})();(()=>{td.a.Fa(K=>{rf.ka(K);bf.ka(K);De.ka(K)})})();td.a.Fa(me.ka);(()=>{td.a.Fa(K=>{Pc.ka(K)})})();td.a.Fa(fe.rHa);td.a.Fa(He.ka);(()=>{td.a.Fa(K=>{Cc.ka(K);ce.ka(K);hf.ka(K)})})();(()=>{td.a.Fa(K=>{sc.ka(K);ne.ka(K)})})();(()=>{td.a.Fa(K=>{Og.ka(K);vd.ka(K);gh.ka(K);pg.ka(K);Ki.ka(K)})})();(()=>{td.a.Fa(K=>{th.ka(K)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.bi.js.map/bfe88ea0f350658e0a70620d0456c173/EwaDSEsNext.bi.js.map