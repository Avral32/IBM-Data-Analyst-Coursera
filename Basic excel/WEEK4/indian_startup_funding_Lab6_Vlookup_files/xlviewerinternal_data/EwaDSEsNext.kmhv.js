'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1049:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1050:function(u,D,a){a.d(D,"a",function(){return h});u=a(0);var c=a(15),b=a(84);D=a(146);var e=a(4),f=a(45),d=a(30);class h extends D.a{constructor(m,l,v,t,z,r,n=null){super();this.vJ=null;this.La=l;this.PX=t;this.Xga=r;this.mb=m;this.dt=z;this.ef=v;this.njb=this.mb.qa("SaveToHostWithExtraCharsInFileName");this.Kh=n;this.oc(1,CommonUIStrings.l_SaveButtonLabel)}get sa(){return this.ef}QMe(m,l){this.GL(1,!!m&&m!==l);this.vJ=document.getElementById(h.kXe);f.a.addHandler(this.vJ,"change",Object(b.a)(this,
this.ppc,"onFileNameChange"));f.a.addHandler(this.vJ,"input",Object(b.a)(this,this.ppc,"onFileNameChange"));this.vJ.focus()}oac(m){return this.njb?(new RegExp("["+this.Y9b('\\/:*?"<>|')+"]")).test(m):(new RegExp("["+this.Y9b('\\/:*?"<>|#{}%~&')+"]")).test(m)}Y9b(m){return m.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Jkd(){const m=d.a.Sq(e.AFrameworkApplication.um.un);this.GL(1,!!this.vJ&&""!==this.vJ.value&&this.vJ.value!==m)}ppc(){this.vJ&&window.setTimeout(()=>{this.Jkd()},0)}nac(m,l){if(1!==
m)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{m=l[h.kXe];l=h.OKf in l?l[h.OKf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.Stc(m),l);const v=d.a.I4(e.AFrameworkApplication.fileName);(m=m?m.trim():null)&&""!==m&&""!==v||1===this.sa.state?this.oac(m)?this.dt.create().displayError(1,m,l):this.Xga.Hoa(m+v,l,this.Kh):this.dt.create().displayError(2,m,l)}}dispose(){this.vJ&&
(f.a.removeHandler(this.vJ,"change",Object(b.a)(this,this.ppc,"onFileNameChange")),f.a.removeHandler(this.vJ,"input",Object(b.a)(this,this.ppc,"onFileNameChange")),this.vJ=null);super.dispose()}}h.kXe="txtFileName";h.OKf="chkOverwrite";Object(u.a)(h,"FileNameDialogBase",D.a,[])},1051:function(u,D,a){a.d(D,"a",function(){return t});u=a(0);var c=a(15),b=a(157),e=a(84),f=a(4),d=a(641),h=a(834),m=a(374),l=a(105),v=a(25);class t{constructor(z,r,n,w){this.HXb=null;this.pDg=z;this.mb=n;this.Oge=r;this.wee=
new b.a;this.Bh=w}C8a(){return this.mb.qa("SaveToCloudStorageUIIsEnabled")}N_e(){return v.a.saveToCloudStorage}i3b(){m.a.VKd(Object(e.a)(this,this.f0f,"saveToCloudActionDispatcher"));m.a.y$c([new h.a(v.a.saveToCloudStorage,l.a.frame,0)],this.Oge.n5a())}Fg(){const z=this.Oge.n5a();z?(z.j$(()=>{this.wee.setResult(!0)}),this.i3b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}mSf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}f0f(z,
r,n,w,B){return r.contextId!==l.a.frame||z!==this.N_e()?2:this.C8a()?1===n?d.SessionStatusManager.instance.c6a||f.AFrameworkApplication.y5?8:32:2===n?(this.mSf(),B&&B.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Bh&&(this.HXb=this.Bh.Ac("DialogShown","SaveToOneDriveReponseTime")),this.wee.task.continueWith(()=>{this.HXb&&(this.HXb.stop(),this.HXb=null);this.pDg.start(B)}),32):8:8}}Object(u.a)(t,"SaveToCloudStorageActor",null,[623])},
1052:function(u,D,a){a.d(D,"a",function(){return z});u=a(0);var c=a(15),b=a(84),e=a(1053),f=a(4),d=a(41),h=a(40),m=a(240),l=a(373),v=a(164),t=a(766);class z{constructor(r,n,w,B,A){this.j9=this.Pm=this.HDa=null;this.pEa=!1;this.Kh=this.Wga=null;this.RUc=r;this.Wlb=n;this.dt=w;this.ef=B;this.Bh=A}XNb(){this.ef&&1===this.ef.state||(this.Pm=this.Wlb(),this.Pm.message=CommonUIStrings.l_CommentProgressTooltip,this.Pm.Rb=5,this.Pm.Jt=!1,this.Pm.LBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}CJa(){this.Pm&&
(this.Pm.close(),this.Pm=null)}vS(){1!==f.AFrameworkApplication.sa.state&&this.dt().displayError(e.a.default)}fRa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.lf(this.j9,h.a.FX(3),void 0,"UploadToCloudManager.RedirectToFolder")}eRa(r){let n=!1,w=!1;f.AFrameworkApplication.fa&&(n=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),w=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
r,n);if(n&&w){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const B={};B[l.a.$Qa]="1";B[l.a.documentUrl]=r;f.AFrameworkApplication.nV().execute(A=>{A.Oj(v.a.Eua,B)})}else h.a.lf(r,h.a.FX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Hoa(r,n,w=null,B=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Bh&&(this.Wga=this.Bh.Ac("DialogShown","SaveToOneDriveUploadTime"));this.XNb();this.j9=n;this.HDa=this.RUc.create(r,
w,B);this.Kh=B;this.CQ()}CQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.HDa.execute(Object(b.a)(this,this.cZi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.bZi,"onSaveToCloudUploadFailed"))}cZi(r){this.CJa();this.pEa=!1;if(r&&r.data&&r.data.te){var n;if(({At:n}=d.d(r.data.te)).returnValue)if(r=n,r.StatusCode!==m.a.mP&&r.StatusCode!==m.a.Ssb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.vS();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.eRa(r.NewDocumentUrl):this.fRa()}catch(w){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",w.toString())}this.PHb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:t.a.igb(r.data.te)}),this.vS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.vS()}bZi(r){5!==r.data.status&&12!==r.data.status||
this.pEa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.CJa(),this.vS(),this.PHb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.pEa=!0,this.CQ())}PHb(){this.Wga&&(this.Wga.stop(),this.Wga=null)}}Object(u.a)(z,"UploadToCloudManager",null,[536])},1053:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.default=0;Object(u.a)(c,"SaveToCloudErrorCodes",null,[])},1054:function(u,D,a){a.d(D,"a",
function(){return d});u=a(0);var c=a(15),b=a(84),e=a(1053),f=a(83);class d{constructor(h,m,l,v,t,z){this.Kh=null;this.hEg=h;this.v2=m;this.qnb=l;this.mb=v;this.uSb=t;this.dt=z}start(h){this.Kh=h;if("SharePointOnlineConsumer"===this.mb.Xa("FileSource")){const m=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(m){m.start(null,h);return}}this.v2.dNa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.I0g()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.hEg.create().wQ()}vj(){this.dt().displayError(e.a.default)}I0g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.uSb||2===this.uSb)h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.P6,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.vj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.qnb.Hoa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.Kh)}P6(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vj()}}Object(u.a)(d,"SaveToCloudManager",null,[624])},1055:function(u,D,a){a.d(D,"a",function(){return f});u=a(0);var c=a(15),b=a(40),e=a(80);a=a(705);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.Fya;this.Qwa=!0}get linkText(){return f.Etf}Nma(d){super.Nma(d);b.a.openWindow(4,e.a.PH(f.Dtf))}MD(d){super.MD(d);f.Rxd&&f.Rxd(null)}static initialize(d,h,m,l){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.Fya=d;f.Etf=h;f.Dtf=m;f.Rxd=l}}f.Fya=null;f.Etf=null;f.Dtf=null;f.Rxd=null;Object(u.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1056:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.xuh="ewa-bb";c.zuh="ewa-bb-entry";c.Huh="ewa-bb-react";c.Auh="ewa-bb-entry-body";c.Guh="ewa-bb-icon";c.Cuh="ewa-bb-entry-icon";c.Fuh="ewa-bb-entry-title";c.Euh="ewa-bb-entry-message";c.sRe="ewa-bb-entry-button";c.Duh="ewa-bb-entry-link";c.Buh="ewa-bb-entry-close";c.tRe="ewa-bb-entry-button-holder";c.yuh="ewa-bb-content";Object(u.a)(c,"CssClassNames",null,[])},1057:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);
a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.It=!0;this.title=c.Mpa;this.message=c.Kpa}get actionButton(){return c.Jpa}Lo(b){super.Lo(b);(b=c.Lpa)&&b(null)}static initialize(b,e,f,d){c.Mpa=b;c.Kpa=e;c.Jpa=f;c.Lpa=d}}c.Mpa=null;c.Kpa=null;c.Jpa=null;c.Lpa=null;Object(u.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1058:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.It=!0;this.title=c.Mpa;this.message=
c.Kpa}get actionButton(){return c.Jpa}Lo(b){super.Lo(b);(b=c.Lpa)&&b(null)}static initialize(b,e,f,d){c.Mpa=b;c.Kpa=e;c.Jpa=f;c.Lpa=d}}c.Mpa=null;c.Kpa=null;c.Jpa=null;c.Lpa=null;Object(u.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1059:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.It=!0;this.title=c.Mpa;this.message=c.Kpa}get actionButton(){return c.Jpa}Lo(b){super.Lo(b);(b=c.Lpa)&&b(null)}static initialize(b,
e,f,d){c.Mpa=b;c.Kpa=e;c.Jpa=f;c.Lpa=d}}c.Mpa=null;c.Kpa=null;c.Jpa=null;c.Lpa=null;Object(u.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1060:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);this.It=!0;this.title=c.gEb;this.message=c.Fya}get actionButton(){return c.J9a}Lo(b){super.Lo(b);c.Hya&&c.Hya(null)}static initialize(b,e,f,d){c.gEb=b;c.Fya=e;c.J9a=f;c.Hya=d}}c.gEb=null;c.Fya=null;c.J9a=null;c.Hya=null;Object(u.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1061:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);a=a(705);class c extends a.a{constructor(b,e){super(b,e);c.J9a&&c.Hya&&(this.It=!0);this.title=c.gEb;this.message=c.Fya}get actionButton(){return c.J9a}Lo(b){super.Lo(b);c.Hya&&c.Hya(null)}static initialize(b,e,f,d){c.gEb=b;c.Fya=e;c.J9a=f;c.Hya=d}}c.gEb=null;c.Fya=null;c.J9a=null;c.Hya=null;Object(u.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1063:function(u,
D,a){a.d(D,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.qhb=function(){function b(){return l()&&(A()||3<=(n()?y("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){ha||(ha=!0,fb=h("Windows Phone"))}function h(La){La=(new RegExp(La+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var nb=-1;return null!=La&&2<=La.length&&(nb=parseFloat(La[1]),
isNaN(nb)&&(nb=-1)),nb}function m(){return"function"==typeof navigator.msLaunchUri&&!f()&&!B()&&!v()}function l(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function t(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function z(){return t()?8==window.document.documentMode:!1}function r(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function n(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function w(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function B(){var La=window.navigator.userAgent.toLowerCase();return 0<=La.indexOf("android")&&0<=La.indexOf("chrome")}function A(){return 3<=(r()?y("firefox/"):0)}function y(La){var nb=window.navigator.userAgent.toLowerCase(),Lb=nb.indexOf(La),ac,ib;return 0<=Lb?(ac=Lb+La.length,ib=nb.length,parseInt(nb.substring(ac,ib))):0}function x(La,nb,Lb,ac,ib){if(ac&&null!=nb)nb();
else if(m())navigator.msLaunchUri(La,nb,Lb);else if(!(w()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&l())||v())I(La,nb,Lb);else if(w()&&ib)a:{try{window.open(La,"_self")}catch(Ra){null!=Lb&&Lb();break a}null!=nb&&nb()}else F(La,nb,Lb)}function F(La,nb,Lb){var ac=document.getElementById("OICLinkTag"),ib;null==ac&&(ac=document.createElement("a"),ac.id="OICLinkTag",ac.style.visibility="hidden",ac.href="",ac.target=0==(Jb.Options&
pa.SupportsTopTargetNavigation)||Jb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(ac),null!=ac.addEventListener&&ac.addEventListener("click",function(Ra){null!=Ra.stopPropagation&&Ra.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(ib=function(Ra){var ya=document.createEvent("MouseEvent");return ya.initMouseEvent(Ra,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),ya},ib.prototype=Event.prototype,window.MouseEvent=ib),ac.href=La,ac.dispatchEvent(new MouseEvent("click"))}catch(Ra){null!=
Lb&&Lb();return}null!=nb&&nb()}function I(La,nb,Lb){var ac=document.getElementById("OICFrame");null==ac&&(ac=document.createElement("iframe"),ac.className="ObjectInDialog",ac.style.visibility="hidden",ac.src="about:blank",document.body.appendChild(ac),ac.id="OICFrame");try{ac.contentWindow.location.href=La}catch(ib){null!=Lb&&Lb();return}null!=nb&&nb()}function L(La){return 0!=(La.Options&pa.SkipProtocolHandler)||z()}function X(La){return La===rb.ReadOnly||La===rb.ReadWrite}function P(La,nb,Lb,ac){var ib,
Ra;try{if(ib=new ActiveXObject(Oa),ib)return Ra=ib.ViewDocument3(window.self,La,nb,ac),Ra?(N(Ja.O14ActiveX),Ma.None):Ma.Failed}catch(ya){}if(pa.O14Only===(Lb&pa.O14Only))return Jb.DescriptiveUnattemptedEnums?Ma.O14AttemptFailure:Ma.Unattempted;try{if(ib=new ActiveXObject(wa),ib)return Ra=ib.ViewDocument3(window.self,La,nb,ac),Ra?(N(Ja.O12ActiveX),Ma.None):Ma.Failed}catch(ya){}if(pa.O12UpOnly===(Lb&pa.O12UpOnly))return Jb.DescriptiveUnattemptedEnums?Ma.O12UpOnlyFail:Ma.Unattempted;try{if(ib=new ActiveXObject(qa),
ib)return Ra=X(nb)?ib.ViewDocument2(window.self,La,ac):ib.EditDocument2(window.self,La,ac),Ra?(N(Ja.O11ActiveX),Ma.None):Ma.Failed}catch(ya){}return Jb.DescriptiveUnattemptedEnums?Ma.ActiveXUnattempted:Ma.Unattempted}function G(La,nb,Lb,ac,ib){var Ra,ya,Va;La==Ga.Visio&&Lb==rb.ReadWrite&&(Lb=rb.WriteOnly);La=ib;(ac=ac||f()&&!(d(),8<=fb))||(Ra="",Ra+=X(Lb)?fa+ua:sa,Ra+=sb,La+=H(Ra));La+=H(nb);Jb.NewTelemetryDataIsEnabled&&(ya=Jb.SessionOrigin?"|or|"+Jb.SessionOrigin:"",ya+=Jb.ClickTime?"|ct|"+Jb.ClickTime:
"",ya+=Jb.CorrelationId?"|cid|"+Jb.CorrelationId:"",La+=H(ya),Jb.CorrelationIdForWinClient&&(La+=H(Jb.CorrelationIdForWinClient)));nb=window.location.href;Lb=bb;ac=nb.toLowerCase().indexOf("&"+Lb+"=");var oa;Lb=-1==ac?void 0:(Va=ac+(Lb.length+2),oa=nb.indexOf("&",Va),-1==oa)?nb.substr(Va):nb.substring(Va,oa);if(null!=Lb&&"undefined"!=typeof Lb){Va="";try{Va=decodeURIComponent(Lb)}catch(kb){}0<Va.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Va)&&(La+=hb,La+=Va)}return La}
function C(La,nb,Lb,ac,ib,Ra){var ya=ca(La),Va;return null==ya?(ea(Jb.DescriptiveUnattemptedEnums?Ma.ProtocolHandlerIsNull:Ma.Unattempted,Jb.Application),!1):(Va=G(La,nb,Lb,ac,ya),x(Va,J,M,ib,Ra),!0)}function H(La){if(l()&&w()){var nb="";try{nb=decodeURI(La)}catch(Lb){}if(nb==La)return encodeURI(La)}return La}function J(){N(Ja.ProtocolHandler)}function M(){Jb.Options|=pa.SkipProtocolHandler;ra(Jb,Mb,dc)}function S(){null!=Cb&&Cb(Ja.RoamingProtocolHandler)}function W(){null!=Tb&&Tb(Ma.ControlNeeded)}
function O(){var La=document.getElementById(Xa),nb;if(null==La){if(nb=aa,l()&&3<=(n()?y("version/"):0)&&T(ia,!0)&&(nb=ia),!T(nb,!0))if(l()&&T(la,!0))nb=la;else return null;La=document.createElement("object");La.id=Xa;La.type=nb;La.style.width="0px";La.style.height="0px";La.style.setProperty("visibility","hidden","");document.body.appendChild(La);La=document.getElementById(Xa)}return La}function T(La,nb){var Lb=window.navigator.mimeTypes,ac;return null==Lb?!1:(ac=Lb[La],ac)?nb&&!ac.enabledPlugin?!1:
!0:!1}function Y(La){try{if(null!=new ActiveXObject(La))return!0}catch(nb){}return!1}function va(La){switch(La){case Ga.OneNote:return xa;default:return""}}function ca(La){if(La!=Ga.OneNote&&f()&&!(d(),8<=fb))return"office:";switch(La){case Ga.Excel:return"ms-excel:";case Ga.OneNote:return"onenote:";case Ga.PowerPoint:return"ms-powerpoint:";case Ga.Visio:return"ms-visio:";case Ga.Word:return"ms-word:";case Ga.Project:return"ms-project:";case Ga.Publisher:return"ms-publisher:";case Ga.Infopath:return"ms-infopath:";
case Ga.Access:return"ms-access:";default:return""}}function V(La){switch(La){case Ga.Excel:return"root\\office15\\excel.exe";case Ga.PowerPoint:return"root\\office15\\powerpnt.exe";case Ga.Visio:return"root\\office15\\visio.exe";case Ga.Word:return"root\\office15\\winword.exe";case Ga.Project:return"root\\office15\\winproj.exe";case Ga.Publisher:return"root\\office15\\mspub.exe";case Ga.Infopath:return"root\\office15\\infopath.exe";case Ga.Access:return"root\\office15\\msaccess.exe";default:return null}}
function ra(La,nb,Lb){if(Jb=La,Mb=nb,dc=Lb,La.DocumentUrl){var ac=Lb=nb=La.DocumentUrl;try{ac=decodeURIComponent(La.DocumentUrl)}catch(kb){}try{Lb=encodeURI(La.DocumentUrl)}catch(kb){}Jb.NewTelemetryDataIsEnabled||(nb=nb+""+La.CorrelationIdForWinClient,ac+=La.CorrelationIdForWinClient,Lb+=La.CorrelationIdForWinClient);La.Mode===rb.ReadWrite&&pa.CheckoutRequired===(La.Options&pa.CheckoutRequired)&&(La.Mode=rb.ForceCheckout);pa.HostIsEditOnly===(La.Options&pa.HostIsEditOnly)&&(La.Mode=rb.WriteOnly);
if(L(La)?0:l()&&(La.Application==Ga.OneNote||T(Ha,!1)||T(Z,!1))||m()||B()||!(b()||A()||"ActiveXObject"in window&&!f()||w())||15<=Ba())C(La.Application,La.EncodeUrl?Lb:nb,La.Mode,La.Application==Ga.OneNote,La.SilentExternalHandler,La.NavigateUsingWindowOpen);else{var ib;if(ib=z())a:{var Ra=La.EncodeUrl?nb:ac,ya=La.Mode,Va=va(La.Application);try{ib=(new ActiveXObject(Ka)).ViewDocument3(window.self,Ra,ya,Va);break a}catch(kb){}ib=!1}if(ib)N(Ja.O15ActiveX);else{if(b()||A()){var oa=La.EncodeUrl?nb:ac;
ac=La.Mode;ib=va(La.Application);Ra=O();if(null==Ra)oa=Jb.DescriptiveUnattemptedEnums?Ma.PluginIsNull:Ma.Unattempted;else{ya=!1;try{ya=Ra.ViewDocument3(window.self,oa,ac,ib)}catch(kb){}if(!ya)try{ya=X(ac)?Ra.ViewDocument2(window.self,oa,ib):Ra.EditDocument2(window.self,oa,ib)}catch(kb){}oa=ya?(N(Ja.NpapiPlugin),Ma.None):Ma.Failed}}else{try{oa=new ActiveXObject(Za),null!=oa&&oa.SaveSSOCreds()}catch(kb){}oa=P(La.EncodeUrl?nb:ac,La.Mode,La.Options,va(La.Application))}if(oa!=Ma.None){if(ac=La.CouldUseRoamingApps)eb||
(eb=!0,za=h("Windows NT")),ac=6.1<=za&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(t()||A()||w());if(ac&&La.Application!=Ga.OneNote){if(!c.qhb.k7j()){ea(Ma.ControlNeeded,Jb.Application);return}if(La.RoamingAppsLauncher){"undefined"==typeof La.RoamingAppsLauncher||null==La.RoamingAppsLauncher?ea(Jb.DescriptiveUnattemptedEnums?Ma.RoamingLauncherIsNull:Ma.Unattempted,Jb.Application):"undefined"==typeof La.RoamingBitsUrl||null==La.RoamingBitsUrl?c.qhb.Xbk(La.DocumentUrl,La.RoamingAppsLauncher,
La.Application,La.ApplicationParameters,Mb,dc):c.qhb.fqg(La.DocumentUrl,La.RoamingAppsLauncher,La.RoamingApplicationExe,La.ApplicationParameters,La.RoamingPlatform,La.RoamingBitsUrl,Mb,dc);return}if(!La.ContinueIfLauncherIsNull){ea(Ma.LauncherNeeded,Jb.Application);return}}pa.NoProtocolHandlerFallback==(La.Options&pa.NoProtocolHandlerFallback)||L(La)||t()||l()&&!(Jb.DescriptiveUnattemptedEnums?oa>=Ma.O14Unattempted&&oa<=Ma.DocumentUrlIsNull:oa==Ma.Unattempted)?ea(oa,Jb.Application):C(La.Application,
La.EncodeUrl?Lb:nb,La.Mode,La.Application==Ga.OneNote,La.SilentExternalHandler,La.NavigateUsingWindowOpen)}}}}else ea(Jb.DescriptiveUnattemptedEnums?Ma.DocumentUrlIsNull:Ma.Unattempted,Jb.Application)}function N(La){null!=Mb&&Mb(La)}function ea(La,nb){"undefined"==typeof nb&&(nb=null);null!=dc&&dc(La,nb)}function Ba(){var La=0;if(b()||A()||w()){var nb=O();try{null!=nb&&(La=nb.GetOfficeVersion())}catch(Lb){}}else Y(Ka)?La=15:Y(Oa)?La=14:Y(wa)?La=12:Y(qa)&&(La=11);return La}function ka(){return l()&&
(T(aa,!0)||T(ia,!0))}var Ka="SharePoint.OpenDocuments.5",Oa="SharePoint.OpenDocuments.4",wa="SharePoint.OpenDocuments.3",qa="SharePoint.OpenDocuments.2",aa="application/x-sharepoint",ia="application/x-sharepoint-webkit",Ha="application/x-sharepoint-protocolhandler",Z="application/x-sharepoint-webkit-protocolhandler",la="application/officelive",Xa="npSharePointPlugin",Za="IDBHO.IDBHOCtrl",xa="OneNote.Notebook",fa="ofv|",ua="ofc|",sa="ofe|",sb="u|",hb="|f|",bb="wdlor",lb="",Fa="",Na="",Mb,dc,Cb,Tb,
Jb,eb,za,ha,fb,rb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},pa={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ma={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
Ja={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Ga={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:rb,OpenDocumentOptions:pa,OpenDocumentFailureType:Ma,OpenDocumentControl:Ja,OfficeApplication:Ga,EditDocumentInClient:ra,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=Ga.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Ba,
IsO14MacPluginInstalled:ka,OfferOfficeInDialog:function(){return e()&&11>=Ba()},OfferOfficeNoIntrusive:function(){return e()&&15>Ba()},OfferMacOffice:function(){return l()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ka()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:Fa}}):I(Na,null,null)},CanUseRoamingControl:function(){var La,nb,Lb;if(m())return!0;if(w())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return La=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(La),nb=document.createEvent("Events"),nb.initEvent("RoamingOfficeInstalled",!0,!1),La.dispatchEvent(nb),!!La.getAttribute("installed");if(t())try{return Lb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Lb.HrExists()}catch(ac){}return!1},InitUrls:function(La,nb,Lb){lb=La;Fa=Lb;Na=nb},LaunchRoamingApps:function(La,nb,Lb,ac,ib,Ra){c.qhb.fqg(La,nb,V(Lb),ac,"x86",lb,ib,Ra)},LaunchRoamingApps2:function(La,
nb,Lb,ac,ib,Ra,ya,Va){var oa="",kb;if(null!=ac&&(oa+=" "+ac),null!=La&&(oa+=' "'+La+'"'),m()||w())Cb=ya,Tb=Va,ya='office: "'+(Ra+'" "')+(Lb+'" "ROAMING"'),ya+=' "'+nb+'"',ya+=' "'+ib+'"',ya+=" "+oa,x(ya,S,W,!1,!1);else if(r())La=document.createElement("RoamingExtensionElement"),La.setAttribute("cabUrl",Ra),La.setAttribute("app",Lb),La.setAttribute("licensingEntitlements",nb),La.setAttribute("platform",ib),La.setAttribute("args",oa),document.documentElement.appendChild(La),nb=document.createEvent("Events"),
nb.initEvent("RoamingOfficeLaunch",!0,!1),La.dispatchEvent(nb),null!=ya&&ya(Ja.RoamingFFExtension);else if(t()){if(kb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=kb)try{kb.HrConfigureSingle(Ra,Lb,nb,ib,oa),null!=ya&&ya(Ja.RoamingActiveX)}catch(Sa){}}else null!=Va&&Va(Ma.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:F,OpenDocumentWithProtocolHandler:C,OpenDocumentWithProtocolHandlerNoCallBack:function(La,nb,Lb,ac){var ib=ca(La),Ra;return null==
ib?(ea(Jb.DescriptiveUnattemptedEnums?Ma.ProtocolHandlerNoCallbackIsNull:Ma.Unattempted,Jb.Application),!1):(Ra=G(La,nb,Lb,ac,ib),x(Ra,null,null,!1,!1),!0)}}}();c.ClientUtils=c.qhb},1064:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);var c=a(40);class b{constructor(e,f){this._url=e;this.mBg=f}Pwe(){}c9c(){this.mBg?c.a.downloadFile(this._url):c.a.lf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,
[315,2])},1065:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1066:function(u,D,a){a.d(D,"a",function(){return d});u=a(0);var c=a(1194),b=a(4),e=a(54),f=a(83);class d{constructor(h,m,l,v,t,z){this.iY=h;this.jY=m;this.hMc=l;this.sE=v;this.LTb=t;this.YVa=z}get O8f(){return!this.jY&&!this.hMc}get lyf(){return 2===this.YVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get SQe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get fdf(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Vwa(){return CommonUIStrings.l_OICErrorHelpLink}get Gbf(){return"OICFailure"}get icon(){return 3}get MZb(){return 2===
this.YVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}zcj(h){this.Iyf(h)}Kzi(h){this.Iyf(h)}Iyf(h){let m=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").Alc(this.YVa),m=3):2===h&&((!this.hMc||this.hMc(this.sE))&&this.jY&&c.a.instance.afh(this.jY,this.iY,this.sE),m=5);(0===h||1===h)&&this.iY&&this.iY(this.sE);b.AFrameworkApplication.Dvc(e.a.mKf,this.LTb,m);this.dispose()}dispose(){this.sE=
this.jY=this.iY=null}}Object(u.a)(d,"AOICErrorDialogWithTrial",null,[2])},1067:function(u,D,a){a.d(D,"a",function(){return d});u=a(0);var c=a(1358),b=a(4),e=a(41),f=a(80);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}ZQd(){return e.c([this.eba(),this])}execute(h,m,l){let v="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=f.a.Ol(v,"wdEnableRoaming","1"));b.AFrameworkApplication.Bd.Rm(v,2,this.ZQd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.Axb(),h,m,l,void 0,void 0,void 0,void 0,"6")}}Object(u.a)(d,"ARoamingAppsRequest",null,[])},1068:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1069:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1070:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1076:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.Dqi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.lUa=(e.DirectPrintSupportedMimeTypes||
"").split(b.G8c);this.mUa=(e.DirectPrintSupportedPlugins||"").split(b.G8c);this.Qei=(e.DirectPrintImmersivePreviewPlugins||"").split(b.G8c);this.Yhf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.eni=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.l4g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.yzd=14;this.Fvf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.yzd=parseInt(f[0]),this.Fvf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.G8c=",";Object(u.a)(b,"DirectPrintBrsSettings",null,[])},1077:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(u.a)(c,"PrintPreviewPaneProps",null,[])},1142:function(u,D,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1341),h=a(692),m=a(50),l=a(37),v=a(1),t=a(899),z=a(64),r=a(42),n=a(183),w=a(21),B=a(372),A=a(572);class y{constructor(Ea,xb){this.jId=0;this.bbe=!1;this.wA=Ea;this.ignorePrintArea=xb}get wA(){return this.jId}set wA(Ea){0<=Ea&&2>=Ea?this.jId=Ea:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.jId=1)}get ignorePrintArea(){return this.bbe}set ignorePrintArea(Ea){Ea||!Ea?this.bbe=Ea:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(y,"PdfPrintDialogBrowserSessionState",null,[]);var x=a(7),F=a(134),I=a(170),L=a(97),X=a(1397);class P{constructor(Ea,xb){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Ea;this.addToPrintArea=xb}}Object(b.a)(P,"MacroRecorderPrintAreaSetPayload",null,[125]);var G=a(371),C=a(188),H=a(11),J=a(13),M=a(281),S=
a(67);class W{constructor(Ea){this.sharedSheetCell=null;this.sharedSheetCell=Ea}}Object(b.a)(W,"MacroRecorderPageBreakInsertedPayload",null,[125]);class O{constructor(Ea){this.sharedSheetCell=null;this.sharedSheetCell=Ea}}Object(b.a)(O,"MacroRecorderPageBreakRemovedPayload",null,[125]);class T{constructor(Ea){this.sheetName=null;this.sheetName=Ea}getSheetName(){return this.sheetName}}Object(b.a)(T,"MacroRecorderPageBreaksAllResetPayload",null,[125]);class Y{constructor(Ea){this.sheetName=null;this.sheetName=
Ea}getSheetName(){return this.sheetName}}Object(b.a)(Y,"MacroRecorderPrintAreaClearedPayload",null,[125]);var va=a(60);const ca=(Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=Ea.Na(9,Db);Db.sheetName=xb;Db.printSettings=bc;return va.g(Ea,"SetSheetPrintSettings",Db,zb,Ub,wc,mb,0)},V=(Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=Ea.Na(1,mb);mb.ConvertInParameters=xb;return va.g(Ea,"ConvertWorkbookToPrintPdf",mb,bc,zb,Ub,wc,4)},ra=(Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=Ea.Na(1,Db);Db.sheetName=xb;Db.printOptions=bc;return va.g(Ea,
"SetPrintOptions",Db,zb,Ub,wc,mb,0)},N=(Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=Ea.Na(1,Db);Db.sheetName=xb;Db.locale=bc;return va.g(Ea,"GetPrintSettings",Db,zb,Ub,wc,mb,4)},ea=(Ea,xb,bc,zb,Ub,wc,mb,Db=null)=>{Db=Ea.Na(1,Db);Db.selectedRanges=xb;Db.addToPrintArea=bc;return va.g(Ea,"SetPrintArea",Db,zb,Ub,wc,mb,0)},Ba=(Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=Ea.Na(1,mb);mb.sheetName=xb;return va.g(Ea,"ClearPrintArea",mb,bc,zb,Ub,wc,0)},ka=(Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=Ea.Na(9,mb);mb.sheetCell=xb;return va.g(Ea,
"InsertPageBreak",mb,bc,zb,Ub,wc,0)},Ka=(Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=Ea.Na(9,mb);mb.sheetCell=xb;return va.g(Ea,"RemovePageBreak",mb,bc,zb,Ub,wc,0)},Oa=(Ea,xb,bc,zb,Ub,wc,mb=null)=>{mb=Ea.Na(9,mb);mb.sheetName=xb;return va.g(Ea,"ResetAllPageBreaks",mb,bc,zb,Ub,wc,0)};var wa=a(124),qa=a(112),aa=a(51),ia=a(189);class Ha{constructor(){this.Col=this.Row=null}}Object(b.a)(Ha,"PageBreaksInformation",null,[]);class Z{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(Z,"RowColBreak",null,[]);
class la{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(la,"SharedRange",null,[]);var Xa=a(176),Za=a(55);class xa{constructor(Ea){this.ribbonCommandInfo=this.gHb=null;this.BUj=(xb,bc,zb)=>{bc=!!xb&&!!xb.RequestTelemetryData;w.h(this.$).ji&&w.h(this.$).ji.gma(this.SLa.oa(this.ribbonCommandInfo.command),xb.StateId,bc?xb.RequestTelemetryData.EcsOperationDuration:0,bc?xb.RequestTelemetryData.EcsRequestDuration:0,bc?xb.RequestTelemetryData.WfeRequestDuration:0);
H.HelperMethods.x_&&this.m3g(zb)};this.$=Ea;this.SLa=new Xa.a;this.Gwa=new Xa.a;this.Gwa.add(78661008,12);this.Gwa.add(275604654,13);this.Gwa.add(-13332329,14);this.Gwa.add(-837651977,9);this.Gwa.add(-1778266776,10);this.Gwa.add(845325699,11)}executeCommand(Ea,xb,bc,zb,Ub=null,wc=null,mb=null){this.ribbonCommandInfo=xb;this.LMj(xb.command);Ea=M.b(Ub,this.BUj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${xb.command} command execution started`);switch(xb.command){case 78661008:return this.Z$e(xb,
Ea,wc,mb,!1);case 275604654:return this.Z$e(xb,Ea,wc,mb,!0);case -13332329:return this.Y9e(xb,Ea,wc,mb);case -837651977:return this.l$h(xb,Ea,wc,mb);case -1778266776:return this.kai(xb,Ea,wc,mb);case 845325699:return this.U$e(xb,Ea,wc,mb)}return n.a(xb.command)}wc(Ea,xb){switch(xb.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Ea;case 845325699:case -13332329:return!0}return!1}b5f(Ea,xb,bc){const zb=w.h(this.$);var Ub=zb.Ea;const wc=r.r(zb.ha.ra.selectedRanges,this.$);
if((Ub=Ub.sD())&&Ub.length){for(const mb of Ub){Ub=mb;const Db=Ub.rf;if(!Db)continue;const Ic=r.j(Ub.pf),Hc=[];for(const Ab of wc.Ranges){if(Ab.FirstRow>Ic.LastRow+1||Ab.LastRow<Ic.FirstRow||Ab.FirstColumn>Ic.LastColumn+1||Ab.LastColumn<Ic.FirstColumn)continue;const db=this.i1h(Ic,Ab,Db),Pb=this.h1h(Ic,Ab,Db);Hc.push(Object(x.a)(new la,{FirstRow:db.FirstRow,FirstColumn:Pb.FirstColumn,LastRow:db.LastRow,LastColumn:Pb.LastColumn}))}0<Hc.length&&!bc?Db.setPrintArea(Hc):0<Hc.length&&bc?Db.addToPrintArea(Hc):
!bc&&Db.hasPrintArea()&&Db.clearPrintArea();!Db.isDirty()&&Db.hasPageLayout()&&Db.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Ub.Cd,4)}this.OPb(zb,Ea,xb)}}f5g(Ea,xb){const bc=w.h(this.$);var zb=w.h(this.$).Ea.sD();if(zb&&zb.length){for(const Ub of zb){zb=Ub;const wc=zb.rf;wc&&(wc.clearPrintArea(),!wc.isDirty()&&wc.hasPageLayout()&&wc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+zb.Cd,4))}this.OPb(bc,Ea,xb)}}yji(Ea,xb){const bc=w.h(this.$);var zb=bc.Ea;
const Ub=r.o(bc.ha.ra.activeCell,this.$);if(Ub){var wc=zb.sD();if(wc&&wc.length){zb=null;for(var mb of wc){let Db=mb,Ic=Db.rf;if(!Ic)continue;let Hc=r.j(Db.pf);if(!(Ub.FirstRow>Hc.LastRow||Ub.FirstRow<Hc.FirstRow||Ub.FirstColumn>Hc.LastColumn||Ub.FirstColumn<Hc.FirstColumn)&&(zb=this.nfh(Ic,Hc,Ub),Ic.insertPageBreak(zb),!Ic.isDirty()&&Ic.hasPageLayout()&&Ic.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Db.Cd,4),zb))break}if(!zb)for(const Db of wc)if(zb=Db,mb=zb.rf)zb=r.j(zb.pf),
zb=this.gJe(mb,zb,Ub),mb.insertPageBreak(zb);this.OPb(bc,Ea,xb)}}}jij(Ea,xb){const bc=w.h(this.$);var zb=bc.Ea;const Ub=r.o(bc.ha.ra.activeCell,this.$);if(Ub&&(zb=zb.sD())&&zb.length){for(const mb of zb){zb=mb;const Db=zb.rf;if(Db){var wc=r.j(zb.pf);(wc=this.gJe(Db,wc,Ub))&&Db.removePageBreak(wc);!Db.isDirty()&&Db.hasPageLayout()&&Db.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+zb.Cd,4)}}this.OPb(bc,Ea,xb)}}doj(Ea,xb){const bc=w.h(this.$);var zb=bc.Ea.sD();if(zb&&zb.length){for(const Ub of zb){zb=
Ub;const wc=zb.rf;wc&&(wc.resetAllPageBreak(),!wc.isDirty()&&wc.hasPageLayout()&&wc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+zb.Cd,4))}this.OPb(bc,Ea,xb)}}Z$e(Ea,xb,bc,zb,Ub){if(!Ub){var wc=this.$.Cb.getItemByName("PRINT_AREA");if(wc&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${wc.type}`),2===wc.type))return this.dli(),Za.Task.Ta(!0)}wc=w.h(this.$).ha.ra;const mb=r.r(wc.selectedRanges,
this.$);if(1===mb.Ranges.length&&!Ub){if(wc.gca())return this.Cai(Ea,mb,xb,bc,zb,Ub),Za.Task.Ta(!0);if(r.R(mb.Ranges[0]))return this.$.xa.na.hasPrintArea?this.Y9e(Ea,xb,bc,zb):Za.Task.Ta(!0)}this.b5f(Ea.command,zb,Ub);return this.hgf(Ea,xb,bc,mb,Ub)}Y9e(Ea,xb,bc,zb){this.f5g(Ea.command,zb);return this.Qki(Ea,xb,bc)}l$h(Ea,xb,bc,zb){this.yji(Ea.command,zb);return this.ali(Ea,xb,bc)}kai(Ea,xb,bc,zb){const Ub=r.r(w.h(this.$).ha.ra.selectedRanges,this.$);if(r.R(Ub.Ranges[0]))return this.U$e(Ea,xb,bc,
zb);this.jij(Ea.command,zb);return this.eli(Ea,xb,bc)}U$e(Ea,xb,bc,zb){this.doj(Ea.command,zb);return this.hli(Ea,xb,bc)}hgf(Ea,xb,bc,zb,Ub){const wc=this.$.pa.ya,mb=()=>new P(zb,Ub);return G.a(this.$.userOperationManager,(Db,Ic,Hc)=>ea(wc,zb,Ub,M.b(Db,xb),M.a(Ic,bc),Hc,null),Db=>new C.a(241,0,Db,64,mb),Ea)}Qki(Ea,xb,bc){const zb=this.$.xa.na.name,Ub=this.$.pa.ya,wc=()=>new Y(zb);return G.a(this.$.userOperationManager,(mb,Db,Ic)=>Ba(Ub,zb,M.b(mb,xb),M.a(Db,bc),Ic,null),mb=>new C.a(243,0,mb,64,wc),
Ea)}ali(Ea,xb,bc){const zb=w.h(this.$),Ub=r.o(zb.ha.ra.activeCell,this.$),wc=()=>new W(Ub);return G.a(this.$.userOperationManager,(mb,Db,Ic)=>ka(this.$.pa.ya,Ub,M.b(mb,xb),M.a(Db,bc),Ic,null),mb=>new C.a(244,0,mb,64,wc),Ea)}eli(Ea,xb,bc){const zb=w.h(this.$),Ub=r.o(zb.ha.ra.activeCell,this.$),wc=()=>new O(Ub);return G.a(this.$.userOperationManager,(mb,Db,Ic)=>Ka(this.$.pa.ya,Ub,M.b(mb,xb),M.a(Db,bc),Ic,null),mb=>new C.a(245,0,mb,64,wc),Ea)}hli(Ea,xb,bc){const zb=this.$.xa.na.name,Ub=()=>new T(zb);
return G.a(this.$.userOperationManager,(wc,mb,Db)=>Oa(this.$.pa.ya,zb,M.b(wc,xb),M.a(mb,bc),Db,null),wc=>new C.a(246,0,wc,64,Ub),Ea)}i1h(Ea,xb,bc){if(!Ea||!xb||!bc)return null;const zb=new la;zb.FirstRow=xb.FirstRow===Ea.LastRow+1?bc.getRowIndex(Ea.LastRow+1)+1:xb.FirstRow<Ea.FirstRow?0:bc.getRowIndex(xb.FirstRow+1);zb.LastRow=xb.FirstRow===Ea.LastRow+1||xb.LastRow>Ea.LastRow?bc.getRowIndex(Ea.LastRow+1)+1:bc.getRowIndex(xb.LastRow+1);return zb}h1h(Ea,xb,bc){if(!Ea||!xb||!bc)return null;const zb=
new la;zb.FirstColumn=xb.FirstColumn===Ea.LastColumn+1?bc.getColumnIndex(Ea.LastColumn+1)+1:xb.FirstColumn<Ea.FirstColumn?0:bc.getColumnIndex(xb.FirstColumn+1);zb.LastColumn=xb.FirstColumn===Ea.LastColumn+1||xb.LastColumn>Ea.LastColumn?bc.getColumnIndex(Ea.LastColumn+1)+1:bc.getColumnIndex(xb.LastColumn+1);return zb}nfh(Ea,xb,bc){if(!xb||!bc||!Ea)return null;const zb=Ea.getPrintArea();if(!zb||!zb.length)return null;const Ub=Ea.getRowIndex(bc.FirstRow+1),wc=Ea.getColumnIndex(bc.FirstColumn+1);let mb=
null,Db=null;for(const Ic of zb)if(Ub>=Ic.FirstRow&&Ub<=Ic.LastRow&&wc>=Ic.FirstColumn&&wc<=Ic.LastColumn){if(bc.FirstRow===Ic.FirstRow&&bc.FirstColumn===Ic.FirstColumn)return new Ha;Ub>Ic.FirstRow&&(mb=Object(x.a)(new Z,{Index:Ub-1,Min:Ic.FirstColumn-1,Max:Math.min(Ic.LastColumn,Ea.getColumnIndex(xb.LastColumn+1))}));wc>Ic.FirstColumn&&(Db=Object(x.a)(new Z,{Index:wc-1,Min:Ic.FirstRow-1,Max:Math.min(Ic.LastRow,Ea.getRowIndex(xb.LastRow+1))}));break}return mb||Db?Object(x.a)(new Ha,{Row:mb?[mb]:null,
Col:Db?[Db]:null}):null}Dgh(Ea,xb,bc){if(!xb||!bc||!Ea)return null;let zb=null;bc.FirstRow>xb.FirstRow&&bc.FirstRow<=xb.LastRow?zb=Object(x.a)(new Z,{Index:Ea.getRowIndex(bc.FirstRow+1)-1,Min:-1,Max:-1}):bc.FirstRow===xb.LastRow+1&&(zb=Object(x.a)(new Z,{Index:Ea.getRowIndex(xb.LastRow+1),Min:-1,Max:-1}));return zb}Wbh(Ea,xb,bc){if(!xb||!bc||!Ea)return null;let zb=null;bc.FirstColumn>xb.FirstColumn&&bc.FirstColumn<=xb.LastColumn?zb=Object(x.a)(new Z,{Index:Ea.getColumnIndex(bc.FirstColumn+1)-1,Min:-1,
Max:-1}):bc.FirstColumn===xb.LastColumn+1&&(zb=Object(x.a)(new Z,{Index:Ea.getColumnIndex(xb.LastColumn+1),Min:-1,Max:-1}));return zb}gJe(Ea,xb,bc){if(!bc||!Ea||!xb)return null;const zb=this.Dgh(Ea,xb,bc);Ea=this.Wbh(Ea,xb,bc);return zb||Ea?Object(x.a)(new Ha,{Row:zb?[zb]:null,Col:Ea?[Ea]:null}):null}dli(){const Ea=new F.StandardDialog;Ea.Rb=0;Ea.oc(1,J.a.instance.ga(4));Ea.$l(J.a.instance.ga(569),J.a.instance.ga(570),1,null)}LMj(Ea){if(this.Gwa.lb(Ea)&&(H.HelperMethods.x_&&(this.gHb=this.$.Jb.Ac("UserAction",
"PrintAreaPageBreaksTimeStopwatch")),this.SLa.lb(Ea)&&this.SLa.remove(Ea),this.SLa.add(Ea,I.a.create().toString()),w.h(this.$).ji)){const xb=aa.b()?aa.b().uj(Ea):"";w.h(this.$).ji.g8(this.Gwa.oa(Ea),this.SLa.oa(Ea),xb)}}m3g(Ea){if(this.gHb&&Ea){const xb=this.gHb.zc;this.gHb.stop();this.gHb=null;switch(Ea){case "SetPrintArea":this.jrb(xb,1700,Ea);break;case "ClearPrintArea":this.jrb(xb,1500,Ea);break;case "InsertPageBreak":this.jrb(xb,1500,Ea);break;case "RemovePageBreak":this.jrb(xb,1600,Ea);break;
case "ResetAllPageBreaks":this.jrb(xb,1700,Ea)}}}jrb(Ea,xb,bc){Ea>xb&&(xb=Object(x.a)(new ia.a,{extendedProperties:new Map}),xb.extendedProperties.set("OperationName",bc),xb.extendedProperties.set("OperationExecutionTime",Ea.toString()),L.Health.instance.recordQosError(wa.a.BLj,[qa.a.wLj],!1,!0,!0,!1,xb))}Cai(Ea,xb,bc,zb,Ub,wc){const mb=new F.StandardDialog,Db=new X.a(J.a.instance.ga(567),J.a.instance.ga(568),J.a.instance.ga(6),J.a.instance.ga(5));mb.Rb=1;mb.oc(1,Db.confirmButton);mb.oc(0,Db.cancelButton);
mb.$l(Db.title,Db.body,3,Ic=>{1===Ic&&(this.b5f(Ea.command,Ub,wc),this.hgf(Ea,bc,zb,xb,wc))})}OPb(Ea,xb,bc){bc();this.SLa.lb(xb)&&Ea.ji.yS(this.SLa.oa(xb),S.BasicTelemetryCalculator.cR)}}Object(b.a)(xa,"PrintAreaBreakManager",null,[799]);var fa=a(383),ua=a(87),sa=a(27);class sb{constructor(){this.margin=this.I0=this.jda=this.orientation=this.wA=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.P2a=!1;this.NoColor=null}equals(Ea){return Ea?this.orientation===Ea.orientation&&this.jda===Ea.jda&&
this.I0===Ea.I0&&this.margin===Ea.margin&&this.sheetPrintOptions===Ea.sheetPrintOptions&&this.P2a===Ea.P2a&&this.NoColor===Ea.NoColor:!1}static bHe(Ea,xb){Ea&&xb&&(xb.wA=Ea.wA,xb.orientation=Ea.orientation,xb.jda=Ea.jda,xb.I0=Ea.I0,xb.margin=Ea.margin,xb.ignorePrintArea=Ea.ignorePrintArea,xb.sheetPrintOptions=Ea.sheetPrintOptions,xb.P2a=Ea.P2a,xb.NoColor=Ea.NoColor)}}Object(b.a)(sb,"PrintSettingsContainer",null,[]);var hb=a(8),bb=a(58),lb=a(299),Fa=a(965),Na=a(207),Mb=a(116),dc=a(154),Cb=a(345),Tb=
a(38),Jb=a(29),eb=a(22),za=a(764),ha=a(782),fb=a(187),rb=a(639),pa=a(553);class Ma{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(Ma,"PrintSettingMarginOption",null,[]);class Ja{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(Ja,"PrintSettingMarginValue",null,[]);class Ga{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(Ga,"PrintSettingOption",null,[]);class La{constructor(Ea){this.oLi=
[.75,.75,.7,.7,.3,.3];this.eKi=[.75,.75,.25,.25,.3,.3];this.W4j=[1,1,1,1,.5,.5];this.Xee=this.Uje=this.nhe=this.Xge=this.Dne=this.m7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.hm=Ea;this.iii();this.oii()}get whatToPrintOptions(){return this.Dne}get orientationOptions(){return this.Xge}get paperSizeOptions(){return this.nhe}get scalingOptions(){return this.Uje}get marginDetailedOptions(){return this.Xee}dispose(){}zxb(Ea){if(!Ea)return null;const xb=new Ja;xb.left=Ea.Left;
xb.right=Ea.Right;xb.top=Ea.Top;xb.bottom=Ea.Bottom;xb.header=Ea.Header;xb.footer=Ea.Footer;return xb}s6c(Ea){e.ULS.shipAssertTag(537154186,0,6===Ea.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const xb={};xb.Top=Ea[0];xb.Bottom=Ea[1];xb.Left=Ea[2];xb.Right=Ea[3];xb.Header=Ea[4];xb.Footer=Ea[5];return xb}oii(){this.Dne=[Object(x.a)(new Ga,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1224)}),Object(x.a)(new Ga,{printSettingOptionKey:2,
printSettingOptionText:this.hm.ga(1217)}),Object(x.a)(new Ga,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1216)})];this.Xge=[Object(x.a)(new Ga,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1227)}),Object(x.a)(new Ga,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1226)})];this.nhe=[Object(x.a)(new Ga,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1229)}),Object(x.a)(new Ga,{printSettingOptionKey:5,printSettingOptionText:this.hm.ga(1230)}),Object(x.a)(new Ga,
{printSettingOptionKey:6,printSettingOptionText:this.hm.ga(1237)}),Object(x.a)(new Ga,{printSettingOptionKey:7,printSettingOptionText:this.hm.ga(1231)}),Object(x.a)(new Ga,{printSettingOptionKey:8,printSettingOptionText:this.hm.ga(1232)}),Object(x.a)(new Ga,{printSettingOptionKey:9,printSettingOptionText:this.hm.ga(1233)}),Object(x.a)(new Ga,{printSettingOptionKey:11,printSettingOptionText:this.hm.ga(1234)}),Object(x.a)(new Ga,{printSettingOptionKey:12,printSettingOptionText:this.hm.ga(1235)}),Object(x.a)(new Ga,
{printSettingOptionKey:13,printSettingOptionText:this.hm.ga(1236)}),Object(x.a)(new Ga,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1228)})];this.Uje=[Object(x.a)(new Ga,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1245)}),Object(x.a)(new Ga,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1246)}),Object(x.a)(new Ga,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1247)}),Object(x.a)(new Ga,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1248)})];
this.Xee=[Object(x.a)(new Ma,{printSettingOption:Object(x.a)(new Ga,{printSettingOptionKey:0,printSettingOptionText:this.hm.ga(1251)}),marginValue:this.zxb(this.normal)}),Object(x.a)(new Ma,{printSettingOption:Object(x.a)(new Ga,{printSettingOptionKey:1,printSettingOptionText:this.hm.ga(1252)}),marginValue:this.zxb(this.wide)}),Object(x.a)(new Ma,{printSettingOption:Object(x.a)(new Ga,{printSettingOptionKey:2,printSettingOptionText:this.hm.ga(1253)}),marginValue:this.zxb(this.narrow)}),Object(x.a)(new Ma,
{printSettingOption:Object(x.a)(new Ga,{printSettingOptionKey:3,printSettingOptionText:this.hm.ga(1254)}),marginValue:this.zxb(this.m7)})]}iii(){this.normal=this.s6c(this.oLi);this.narrow=this.s6c(this.eKi);this.wide=this.s6c(this.W4j)}}La.Lkh=1;La.wkh=1;La.f8c=9;La.Bkh=2;La.ukh=0;La.nkh=!1;La.ikh=!1;La.oJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(La,"PrintSettingsManagerBase",null,[2]);var nb=a(121),Lb=a(282);class ac{constructor(Ea,xb){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=Ea;this.sheetPrintOptions=xb}getSheetName(){return this.sheetName}}Object(b.a)(ac,"MacroRecorderSheetPrintOptionsSavedPayload",null,[125]);class ib{constructor(Ea,xb){this.printSettings=this.sheetName=null;this.sheetName=Ea;this.printSettings=xb}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(ib,"MacroRecorderSheetPrintSettingsSavedPayload",null,[125]);class Ra extends La{constructor(Ea,xb,bc,zb,Ub,wc){super(Ub);this.q$f=
this.dd=!1;this.pEd=mb=>{this.ZD.pEd(mb)};this.AEd=mb=>{this.ZD.AEd(mb)};this.aZi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.$Yi=mb=>{mb=Mb.a.Oe(mb.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${Jb.a.sc(mb)}.`)};this.Wz=(mb,Db)=>{2===Db.Mr?this.Lv.clear():1===Db.Mr&&this.Lv&&this.Lv.contains(Db.Qf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${nb.a(Db.Qf.operation.operationName)} returned, it took ${Db.Qf.dequeueUtcTime.getTime()-Db.Qf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.Lv.remove(Db.Qf))};this.ZD=Ea;this.$ab=bc;this.$=xb;this.sheetName=zb;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.va.UICultureTag;this.z3i=this.I$g();this.$.userOperationManager.xr(this.Wz);this.Lv=new fb.a;this.dI=wc}Vki(Ea){this.Wki(xb=>{Ea&&(xb=this.n1h(xb),
Ea(xb))})}IPd(Ea,xb){if(Ea){var bc=new y(Ea.wA,Ea.ignorePrintArea);this.hsj(bc);!xb||this.q$f?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${xb?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(xb=this.p1h(Ea.I0),xb.IsLandscape=2===Ea.orientation,xb.PaperSize=Ea.jda,this.dI&&(xb.NoColor=Ea.NoColor),xb.PageMargin=this.kid(Ea.margin),xb.SheetPrintOptions=La.oJa,xb.SheetPrintOptions.PrintGrid=Ea.sheetPrintOptions.PrintGrid,
xb.SheetPrintOptions.HorizontalCenter=Ea.sheetPrintOptions.HorizontalCenter,xb.SheetPrintOptions.VerticalCenter=Ea.sheetPrintOptions.VerticalCenter,xb.SheetPrintOptions.PrintHeaders=Ea.sheetPrintOptions.PrintHeaders,this.gsj(xb))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}kid(Ea){let xb={};0===Ea?xb=this.normal:1===Ea?xb=this.wide:2===Ea?xb=this.narrow:3===Ea&&(xb=this.m7);return xb}lli(Ea){if(Ea){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var xb=this.$.pa.ya,bc=this.$.pa.ya.Wb(),zb=new C.a(598,0,(Ub,wc,mb)=>ra(xb,this.$.xa.na.name,Ea,M.b(this.pEd,Ub),M.a(this.AEd,wc),mb,bc),64,()=>new ac(this.$.xa.na.name,Ea));this.$.userOperationManager.Kc(zb,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.dd||(this.dd=!0,this.$.userOperationManager.mo(this.Wz),
this.uY())}hsj(Ea){this.$ab.wA=Ea.wA;this.$ab.ignorePrintArea=Ea.ignorePrintArea}Wki(Ea){const xb=wc=>{Lb.a(wc)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Jb.a.sc(wc.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Ea(wc.Result))},bc=wc=>{wc=Mb.a.Oe(wc.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Jb.a.sc(wc)}.`);
Ea(null)},zb=this.$.pa.ya.Wb();var Ub=new C.a(247,0,(wc,mb,Db)=>N(this.$.pa.ya,this.sheetName,this.locale,M.b(wc,xb),M.a(mb,bc),Db,zb),80);Ub=this.$.userOperationManager.Kc(Ub,null);this.Lv.add(Ub)}gsj(Ea){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const xb=this.$.pa.ya.Wb();this.$.userOperationManager.Kc(new C.a(226,0,(bc,zb,Ub)=>ca(this.$.pa.ya,this.sheetName,Ea,M.b(bc,this.aZi),M.a(zb,this.$Yi),Ub,
xb),void 0,()=>new ib(this.sheetName,Ea)),null)}Esi(Ea){return this.Chf(Ea)||!this.Jkf(Ea.PaperSize)}ZIh(Ea){this.Chf(Ea)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Ea.ScalingWidth=Ra.Dkh,Ea.ScalingHeight=Ra.Ckh,Ea.ScalingPercent=Ra.vLe,Ea.FitToPage=Ra.jkh);this.Jkf(Ea.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${Ea.PaperSize.toString()} present in file which is unsupported by XLO.`),
Ea.PaperSize=Ra.f8c);return Ea}l1h(Ea){if(Ea.FitToPage){if(1===Ea.ScalingWidth&&1===Ea.ScalingHeight)return 1;if(!Ea.ScalingWidth&&1===Ea.ScalingHeight)return 3}else return 0;return 2}k1h(Ea){return this.Vrd(Ea,this.normal)?0:this.Vrd(Ea,this.wide)?1:this.Vrd(Ea,this.narrow)?2:3}Vrd(Ea,xb){return Ea.Left===xb.Left&&Ea.Right===xb.Right&&Ea.Top===xb.Top&&Ea.Bottom===xb.Bottom&&Ea.Header===xb.Header&&Ea.Footer===xb.Footer}p1h(Ea){const xb={};xb.ScalingPercent=Ra.vLe;xb.FitToPage=0!==Ea;2===Ea?(xb.ScalingWidth=
1,xb.ScalingHeight=0):3===Ea?(xb.ScalingWidth=0,xb.ScalingHeight=1):1===Ea&&(xb.ScalingWidth=1,xb.ScalingHeight=1);return xb}Jkf(Ea){return this.z3i.contains(Ea.toString())}Chf(Ea){return 100!==Ea.ScalingPercent||Ea.FitToPage&&(1<Ea.ScalingWidth||1<Ea.ScalingHeight)}I$g(){const Ea=new rb.a(pa.a.cl());for(let xb=0;xb<this.paperSizeOptions.length;xb++)Ea.add(this.paperSizeOptions[xb].printSettingOptionKey.toString());return Ea}n1h(Ea){let xb=null;if(Ea){const bc=this.$ab.wA,zb=this.$ab.ignorePrintArea;
this.Esi(Ea)&&(this.q$f=!0,Ea=this.ZIh(Ea));xb=new sb;xb.wA=bc;xb.ignorePrintArea=zb;xb.orientation=Ea.IsLandscape?2:1;xb.jda=Ea.PaperSize;xb.I0=this.l1h(Ea);xb.sheetPrintOptions=La.oJa;xb.sheetPrintOptions.PrintGrid=Ea.SheetPrintOptions.PrintGrid;xb.P2a=Ea.Draft;this.dI&&(xb.NoColor=Ea.NoColor);xb.sheetPrintOptions.HorizontalCenter=Ea.SheetPrintOptions.HorizontalCenter;xb.sheetPrintOptions.VerticalCenter=Ea.SheetPrintOptions.VerticalCenter;xb.sheetPrintOptions.PrintHeaders=Ea.SheetPrintOptions.PrintHeaders;
xb.margin=this.k1h(Ea.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${xb.margin}`);3===xb.margin&&(this.m7={},this.m7.Left=Ea.PageMargin.Left,this.m7.Right=Ea.PageMargin.Right,this.m7.Top=Ea.PageMargin.Top,this.m7.Bottom=Ea.PageMargin.Bottom,this.m7.Header=Ea.PageMargin.Header,this.m7.Footer=Ea.PageMargin.Footer)}return xb}uY(){if(this.Lv){for(let Ea of this.Lv)this.$&&this.$.userOperationManager&&(Ea.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${nb.a(Ea.operation.operationName)}.`),
this.$.userOperationManager.tua(Ea)),this.Lv.remove(Ea);this.Lv=null}}}Ra.Dkh=1;Ra.Ckh=0;Ra.vLe=100;Ra.f8c=9;Ra.jkh=!0;Object(b.a)(Ra,"PrintSettingsManager",La,[]);var ya=a(69);class Va{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Va,"PrintSettingsTaskPaneCallbacks",null,[]);class oa{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(oa,"SelectedPrintSettings",null,[]);class kb{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(kb,"PrintOperationCallbacks",null,[]);class Sa{constructor(){this.onBackToSheet=null}}Object(b.a)(Sa,"PrintPreviewPaneCallbacks",
null,[]);var U=a(1077);class ta{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(ta,"UniversalPrintAppSettings",null,[]);var ub=a(420),hc=a(33);class Bc{constructor(Ea,xb,bc,zb){this.activeCell=this.selectedRange=this.sg=this.graphServiceEndpoint=null;this.yIb=0;this.xda=this.Mv=null;this.WH=new sb;this.Nk=new sb;this.sca=0;this.Z8a=null;this.JOb=!1;this.o4a=this.xHb=null;this.osd=!1;this.Y7a=
this.nBb=!0;this.$ma=this.Qza=this.d9a=null;this.nAb=!1;this.W8a=null;this.n7a=this.ENc=!1;this.RRi=Ub=>{if(!(Ub&&Ub.data&&Ub.data.te&&Ub.data.responseHeaders&&Ub.data.te.length)){var wc=Ub?Ub.data?Ub.data.te?Ub.data.responseHeaders?Ub.data.te.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.sg&&(Ub=this.iSa(J.a.instance.ga(1205)),
this.KBa(Ub,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${wc}`);this.xNd&&(Ub=Object(x.a)(new ia.a,{extendedProperties:new Map}),Ub.extendedProperties.set("InvalidParameterName",wc),L.Health.instance.recordQosError(wa.a.lOf,[qa.a.mOf],!1,!0,!0,!1,Ub))}else if(0<this.sca&&Ub.data.id===this.sca){if(Ub.data.responseHeaders["Content-Type"]&&(eb.a.contains(Ub.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||eb.a.contains(Ub.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var mb=null;eb.a.contains(Ub.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(mb=this.Kbh(Ub));wc={};this.dBf(mb);Ub.data.responseHeaders["Total-Pdf-PageCount"]?(mb=parseInt(Ub.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.nAb||(this.mId>=mb?this.$ma=mb:this.nAb=!0),this.Y7a&&this.sg&&this.sg.setPageRangeSettings(mb,this.mId,this.nAb,
this.Qza,this.$ma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else wc=bb.a.li(Ub.data.te),Jb.a.y$(wc.Errors)||ya.a(this.$).fd.xM(wc.Errors[0].MessageId),this.$dj(wc.Errors),this.sg&&(mb=this.iSa(wc.Errors[0].Description),-1831476778===wc.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.KBa(mb,0,J.a.instance.ga(1208))):
this.KBa(mb,0)),297284985===wc.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${wc.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${wc.Errors[0].MessageId}`);Ub=Ub.data.state;Ub.ISe(wc,Ub.userContext,Ub.methodName)}};this.QRi=Ub=>{if(0<this.sca&&Ub.data.id===this.sca){var wc=Mb.a.Oe(Ub.data);this.sg&&this.KBa(this.iSa(wc[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${Jb.a.sc(wc)}]`);wc=Ub.data.state;wc.mja(Ub,wc.userContext,wc.methodName);this.$.userOperationManager.Ola.operation.uBa(()=>this.JOb)}};this.kQi=Ub=>{Ub.Errors&&0<Ub.Errors.length&&this.sg?(Jb.a.y$(Ub.Errors)||ya.a(this.$).fd.xM(Ub.Errors[0].MessageId),this.KBa(this.iSa(Ub.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Ub.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.dBf(null))};this.jQi=Ub=>{Ub=Mb.a.Oe(Ub.data);this.sg&&this.KBa(this.iSa(Ub[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${Jb.a.sc(Ub)}]`);this.$.userOperationManager.Ola.operation.uBa(()=>this.JOb)};this.yFf=(Ub,wc)=>{if(wc)switch(wc.T8i){case 1:if(this.Nk&&this.o4a)switch(Ub=this.o4a.zc,this.o4a.stop(),
this.o4a=null,this.Nk.wA){case 1:this.g2c(Ub,4800,"ActiveSheet");break;case 0:this.g2c(Ub,6100,"CurrentSelection");break;case 2:this.g2c(Ub,7500,"EntireWorkbook")}break;case 0:this.xHb&&(Ub=this.xHb.zc,this.xHb.stop(),2400<Ub&&(wc=Object(x.a)(new ia.a,{extendedProperties:new Map}),wc.extendedProperties.set("PaneLoadTime",Ub.toString()),L.Health.instance.recordQosError(wa.a.ALj,[qa.a.w$f],!1,!0,!0,!1,wc)),this.Mv.Vki(mb=>{this.yJj(mb)}))}};this.Wz=(Ub,wc)=>{(1===wc.Mr&&this.d9a===wc.Qf||2===wc.Mr)&&
this.jOd()};this.$=Ea;this.p8b=xb;this.B3=bc;this.wFb=zb;this.xNd=H.HelperMethods.x_;this.Sa=new Tb.a;this.mId=this.$.va.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.jHj();this.Rhi();this.pmi=this.r3g();this.Tvi=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);this.dI=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);if(this.isUniversalPrintEnabled=!!zb&&zb.cNa()&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.he.get(116))this.graphServiceEndpoint=this.$.va.GraphServiceEndpoint;this.isExportPdfMode=!1}get Dsi(){return this.ENc}sOg(Ea){this.Sa.addHandler("ppocek",Ea)}Skj(Ea){this.Sa.removeHandler("ppocek",Ea)}xJj(Ea,xb,bc){this.Boj();this.$.userOperationManager.xr(this.Wz);
this.xda=Ea;this.Sa.raiseEvent("ppocek");this.isExportPdfMode=bc;this.xda.SelectedRanges&&this.xda.SelectedRanges.Ranges&&0<this.xda.SelectedRanges.Ranges.length&&this.xda.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.xda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.Mv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Mv=new Ra(this,this.$,xb,this.$.xa.na.name,J.a.instance,this.dI);e.ULS.shipAssertTag(537154267,0,!this.sg,
"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.sg=new ha.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.sg.roh();this.sg.zJj(this.isExportPdfMode);this.sg.LNg(this.yFf)}pZh(){this.Mv.m7&&4<=this.Mv.marginDetailedOptions.length&&(this.Mv.marginDetailedOptions[3].marginValue=this.Mv.zxb(this.Mv.m7));return this.Mv.marginDetailedOptions}Z6f(){return!!this.xda&&!!this.xda.ObjectId||!w.h(this.$).ha.ra.Mg}q1h(){const Ea=Object(x.a)(new oa,
{selectedWhatToPrint:La.Lkh,selectedOrientation:La.wkh,selectedPaperSize:La.f8c,selectedScaling:La.Bkh,selectedMargin:La.ukh,selectedIgnorePrintArea:La.nkh,selectedPrintGridlines:La.oJa.PrintGrid,selectedDraft:La.ikh,selectedHorizontalCenter:La.oJa.HorizontalCenter,selectedVerticalCenter:La.oJa.VerticalCenter,selectedRowAndColumnHeadings:La.oJa.PrintHeaders});this.WH?(Ea.selectedWhatToPrint=this.WH.wA,Ea.selectedOrientation=this.WH.orientation,Ea.selectedPaperSize=this.WH.jda,Ea.selectedScaling=this.WH.I0,
Ea.selectedMargin=this.WH.margin,Ea.selectedIgnorePrintArea=this.WH.ignorePrintArea,Ea.selectedPrintGridlines=this.WH.sheetPrintOptions.PrintGrid,Ea.selectedDraft=this.WH.P2a,this.dI&&(Ea.selectedColor=this.WH.NoColor?0:1),Ea.selectedHorizontalCenter=this.WH.sheetPrintOptions.HorizontalCenter,Ea.selectedVerticalCenter=this.WH.sheetPrintOptions.VerticalCenter,Ea.selectedRowAndColumnHeadings=this.WH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");
return Ea}c6e(){return Object(x.a)(new Sa,{onBackToSheet:()=>{this.Dma()}})}m1h(){return Object(x.a)(new U.a,{backActionButtonText:J.a.instance.ga(1204),printPreviewPaneCallbacks:this.c6e(),logger:new fa.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(x.a)(new kb,{onClosePreviewer:()=>{this.Dma()},getGraphServiceAuthorizationToken:this.Sbc(),onLocalPrint:()=>{this.jGf()},onNotifyPrintJobStatus:(Ea,xb)=>{this.onNotifyPrintJobStatus(Ea,xb)}}),universalPrintAppSettings:Object(x.a)(new ta,
{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.wmi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}o1h(){return Object(x.a)(new Va,{onSettingChange:Ea=>{this.SXi(Ea)},onPrint:()=>{this.jGf()}})}SXi(Ea){this.yIb++;Ea?(this.sg&&this.sg.qKj(),this.Nk.wA=Ea.selectedWhatToPrint,this.Nk.I0=Ea.selectedScaling,this.Nk.orientation=Ea.selectedOrientation,this.Nk.jda=Ea.selectedPaperSize,this.Nk.margin=Ea.selectedMargin,
this.dI&&(this.Nk.NoColor=!Ea.selectedColor),this.Nk.ignorePrintArea=Ea.selectedIgnorePrintArea,this.hAj(Ea.selectedPageStart,Ea.selectedPageEnd),this.Mv&&this.Qbi(this.Nk,Ea)?(this.Nk.sheetPrintOptions=La.oJa,this.Nk.sheetPrintOptions.PrintGrid=Ea.selectedPrintGridlines,this.Nk.sheetPrintOptions.HorizontalCenter=Ea.selectedHorizontalCenter,this.Nk.sheetPrintOptions.VerticalCenter=Ea.selectedVerticalCenter,this.Nk.sheetPrintOptions.PrintHeaders=Ea.selectedRowAndColumnHeadings,this.Mv.lli(this.Nk.sheetPrintOptions)):
this.Xod()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}Dma(){this.n7a&&(this.JOb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.yIb} times before clicking on backToWorkbook icon`);this.iGf();this.RCe()}jGf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.yIb} times before clicking on print button.`);
e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Nk.margin}, Initial margin value : ${this.WH.margin}`);if(this.useMSPdfViewer)this.nOf();else if(this.Y7a)try{this.sg.printPdf(),this.m3c()}catch(Ea){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.nOf()}else this.p8b.wJj(this.o6b(!0)),this.m3c()}nOf(){const Ea=this.o6b(!0);this.m3c();H.HelperMethods.lf(Ea,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){ua.a.Ia(this.Sa)}Xod(){if(this.$.k7a)this.Ski();
else{this.uY();this.oZf();var Ea=null;this.Hhi();e.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.d9a=this.$.userOperationManager.Kc(new C.a(223,0,(xb,bc,zb)=>{xb=new lb.a(xb,null,bc,zb,null,!0,!1,"GetFileCopyFileHandler","");xb.correlationID=I.a.create().toString();Ea=xb;this.sca=this.B3.iha(this.o6b(this.Y7a?!1:!0,this.pmi?"Base64":"Pdf"),1,null,null,Bc.yGh,!1,2,this.RRi,this.QRi,Ea,void 0,void 0,void 0,12E4);xb.requestId=
this.sca;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.sca}.`);return Za.Task.Ta(!0)},80),null)}}m3c(){this.iGf();this.RCe()}pEd(Ea){Jb.a.Oq(Ea.Errors)?this.sg.showErrorMessageForPrintOptions(J.a.instance.ga(1255)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Xod(),this.sg&&this.sg.hideErrorMessageForPrintOptions())}AEd(Ea){this.sg&&this.sg.showErrorMessageForPrintOptions(J.a.instance.ga(1255));
Ea=Mb.a.Oe(Ea.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${Jb.a.sc(Ea)}.`)}Ski(){e.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.uY();const Ea=this.$.pa.ya.Wb();this.d9a=this.$.userOperationManager.Kc(new C.a(133,0,(xb,bc,zb)=>{const Ub={};Ub.WhatToPrint=this.Nk.wA;Ub.UseNamedAction=this.p8b.d8f();Ub.SelectedSheetName=this.$.xa.na.name;
Ub.ActiveCell=this.activeCell;Ub.SelectedRanges=[this.selectedRange];Ub.IsPdfDocumentRequired=!1;Ub.Orientation=this.Nk.orientation;Ub.PaperSize=this.Nk.jda;Ub.Scaling=this.Nk.I0;Ub.RichValuesEnabled=!0;Ub.IgnorePrintArea=this.Nk.ignorePrintArea;Ub.Preview=!0;this.dI&&(Ub.NoColor=this.Nk.NoColor);this.S6f()&&(Ub.PaginationStartPage=this.Qza,Ub.PaginationEndPage=this.$ma,Ub.OutputTotalPdfPageCount=!0);const wc=this.Mv.kid(this.Nk.margin);wc&&(Ub.PageMargin={},Ub.PageMargin.Top=wc.Top,Ub.PageMargin.Bottom=
wc.Bottom,Ub.PageMargin.Left=wc.Left,Ub.PageMargin.Right=wc.Right,Ub.PageMargin.Header=wc.Header,Ub.PageMargin.Footer=wc.Footer);return this.Z8a=V(this.$.pa.ya,Ub,M.b(this.kQi,xb),M.a(this.jQi,bc),zb,Ea)},80),null)}RCe(){this.$.userOperationManager.mo(this.Wz);this.uY();this.oZf();e.ULS.shipAssertTag(537154261,0,!!this.sg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.sg&&(this.sg.vkj(this.yFf),this.sg.Aoh(),this.sg=null);this.xda=
null;this.Mv&&(this.Mv.dispose(),this.Mv=null);this.o4a=this.xHb=null;this.ENc=!1;this.Sa&&this.Sa.raiseEvent("ppocek")}eFj(){return this.$.isEditMode&&!!this.WH&&!!this.Nk&&2!==this.Nk.wA&&this.Rbi()}IPd(){e.ULS.shipAssertTag(537154260,0,!!this.Mv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Mv&&this.Mv.IPd(this.Nk,this.eFj())}o6b(Ea,xb="Pdf"){const bc=new Sys.StringBuilder;bc.append(Fa.a(this.$,xb,!0));Na.a.Yk(bc,hb.a.APf,""+this.Nk.wA);Ea&&this.p8b.d8f()&&
Na.a.Yk(bc,hb.a.a2j,"1");Na.a.Yk(bc,hb.a.W$i,this.$.xa.na.name);0===this.Nk.wA&&(Na.a.Yk(bc,hb.a.V$i,this.selectedRange),Na.a.Yk(bc,hb.a.N$i,this.activeCell));Na.a.Yk(bc,hb.a.Q$i,""+this.Nk.orientation);Na.a.Yk(bc,hb.a.R$i,""+this.Nk.jda);Na.a.Yk(bc,hb.a.U$i,""+this.Nk.I0);Na.a.Yk(bc,hb.a.T$i,"1");Na.a.Yk(bc,hb.a.M$i,this.Nk.ignorePrintArea?"1":"0");Na.a.Yk(bc,hb.a.S$i,"1");this.bSg(bc);this.dI&&Na.a.Yk(bc,hb.a.P$i,this.Nk.NoColor?"1":"0");this.aSg(bc);eb.a.equals(xb,"Pdf",!0)&&(bc.append("&#toolbar=0"),
bc.append("&zoom=100"));Ea=bc.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${Ea}`);return Ea}hAj(Ea,xb){Ea||xb?(this.nAb=!0,this.Qza=Ea,this.$ma=xb):this.AYf()}bSg(Ea){this.S6f()&&(Na.a.Yk(Ea,hb.a.Y$i,""+this.Qza),Na.a.Yk(Ea,hb.a.X$i,""+this.$ma),Na.a.Yk(Ea,hb.a.Z$i,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Qza} to ${this.$ma}`))}S6f(){return null!=
this.Qza&&0<this.Qza&&null!=this.$ma&&0<this.$ma}aSg(Ea){if(this.Mv&&this.Nk){const xb=this.Mv.kid(this.Nk.margin);xb&&Na.a.Yk(Ea,hb.a.O$i,""+xb.Top+" "+xb.Bottom+" "+xb.Left+" "+xb.Right+" "+xb.Header+" "+xb.Footer)}}dBf(Ea){this.sg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.xa.na,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.na&&(this.Y7a?(Ea||(Ea=this.o6b(!1)),this.sg.LAi(Ea)):this.rJj()))}Rbi(){return!this.WH.equals(this.Nk)}iGf(){!this.JOb&&
0<this.yIb&&(this.osd?this.IPd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,0,!!this.sg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.sg&&this.sg.$ci()}vj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.sg){var Ea=this.iSa(J.a.instance.ga(1));this.KBa(Ea,1)}else Ea=Jb.a.Zc(1,0,26,
0,1,-1100324317,"GetPrintSettingsFailedError"),v.EwaSettings.Mz()?new Cb.a(this.$,Ea):(new dc.ErrorDialog(this.$,Ea)).ug()}yJj(Ea){Ea?(0===Ea.wA&&this.Z6f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.xda.ObjectId?"floatingObject":"discontinuousRange"}.`),Ea.wA=1),sb.bHe(Ea,this.WH),sb.bHe(Ea,this.Nk),e.ULS.shipAssertTag(537154248,0,!!this.sg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.sg&&(this.osd=!0,this.sg.AJj(),this.Xod())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.vj())}g2c(Ea,xb,bc){Ea>xb&&(xb=Object(x.a)(new ia.a,{extendedProperties:new Map}),xb.extendedProperties.set("WtpSelectedValue",bc),xb.extendedProperties.set("FullyRenderedPdfLoadTime",Ea.toString()),L.Health.instance.recordQosError(wa.a.zLj,[qa.a.w$f],!1,!0,!0,!1,xb))}uY(){this.d9a&&(0<this.sca||this.Z8a)&&(e.ULS.sendTraceTag(537154246,
0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.sca}.`),this.$.userOperationManager.tua(this.d9a),this.Z8a?Mb.a.Tu(this.Z8a.nu):this.B3.Tu(this.sca),this.jOd())}jOd(){this.Z8a=this.d9a=null}Hhi(){this.xNd&&this.Nk&&(this.o4a=this.$.Jb.Ac("UserAction",(1===this.Nk.wA?"ActiveSheet":0===this.Nk.wA?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}AYf(){this.nAb=!1;this.Qza=1;this.$ma=this.mId}iSa(Ea){if(Ea)return Ea.replace("&#39;",
"'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Ea}rJj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.nBb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let Ea=this.iSa(J.a.instance.ga(1210));this.KBa(Ea,3)}}KBa(Ea,xb,bc=null){this.sg.jA(Ea,xb,bc)}Rhi(){this.Y7a=this.nBb=!0;e.ULS.sendTraceTag(557061534,
0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.nBb}, isPdfPreviewSupportedInPreviewer: ${this.Y7a}`)}Boj(){this.W8a=null;this.jOd();this.AYf();this.xHb=this.$.Jb.Ac("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.na.activeCell.toString();this.yIb=0;this.osd=this.n7a=this.JOb=!1;this.ENc=!0}jHj(){const Ea=this.svi()||this.Gvi();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${Ea}`);return Ea}r3g(){let Ea=
15;sa.a.bI&&sa.a.jub&&(Ea=parseFloat(sa.a.jub));return 14<Ea&&this.nBb}svi(){var Ea;if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModifyTeamsHostCheck",!1)){const xb="teams"===(null===(Ea=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.x8])||void 0===Ea?void 0:Ea.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${sa.a.Iz} isTeamsUIHost: ${xb} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return sa.a.Iz||
xb}return sa.a.Iz||f.AFrameworkApplication.isUnifiedHostMode}Gvi(){return!this.$.he.get(111)}oZf(){this.W8a&&(URL.revokeObjectURL(this.W8a),this.W8a=null)}Kbh(Ea){var xb=Ea.data.te;Ea=this.$.Jb.Ac("UserAction","PrintPreviewBlobFileCreation");var bc=window.self.atob(xb);xb=new Uint8Array(xb.length);for(let zb=0;zb<bc.length;zb++)xb[zb]=bc.charCodeAt(zb)&255;bc=new Blob([xb],{type:"application/pdf"});this.W8a=URL.createObjectURL(bc);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${Ea.zc} ms. Blob size: ${bc.size}`);
Ea.stop();return this.W8a+"#toolbar=0&zoom=100"}$dj(Ea){if(this.xNd&&Jb.a.ah(Ea,Bc.M4i)){const xb=Object(x.a)(new ia.a,{extendedProperties:new Map});xb.extendedProperties.set("ErrorMessageIdName",Ea[0].MessageIdName);L.Health.instance.recordQosError(wa.a.lOf,[qa.a.mOf],!1,!0,!0,!1,xb)}}Qbi(Ea,xb){return Ea.sheetPrintOptions.PrintGrid!==xb.selectedPrintGridlines||Ea.sheetPrintOptions.HorizontalCenter!==xb.selectedHorizontalCenter||Ea.sheetPrintOptions.VerticalCenter!==xb.selectedVerticalCenter||Ea.sheetPrintOptions.PrintHeaders!==
xb.selectedRowAndColumnHeadings}$Uj(){this.Tvi&&this.$.Xc(1936706533,-1,0,null)}wmi(){return!!this.$.va&&!!this.$.va.DocumentHostInfo&&"TestHost"===this.$.va.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.wFb.UL("Print",this.graphServiceEndpoint).then(Ea=>Ea?(Ea.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${Ea.ErrorCode}, Error message : ${Ea.ErrorMessage}`),Ea):Object(x.a)(new za.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(Ea=>{let xb=new za.a;Object.getType(Ea)===Object.getType(xb)?xb=Ea:(xb.ErrorMessage=Ea.toString(),xb.ErrorCode="exception");return Promise.resolve(xb)})}Sbc(){return()=>{const Ea=Promise.resolve("");try{if(this.wFb&&this.wFb.cNa())return this.getToken().then(xb=>
xb.IsSuccess?Promise.resolve(xb.Token):Ea,()=>Ea)}catch(xb){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return Ea}}onNotifyPrintJobStatus(Ea,xb){Ea=ub.a.GC.notificationBar.R3(Ea,!1);"pending"==xb&&(Ea.displayTimeoutSeconds=3,this.$Uj());if(hc.a.e8a())switch(xb){case "failure":Ea.image=1;break;case "success":Ea.image=3;break;default:Ea.image=0}else Ea.image=0;ub.a.GC.notificationBar.HC(Ea)}}Bc.M4i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Bc.yGh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Bc,"PrintPreviewManager",null,[679,2,680]);class Qa{constructor(Ea,xb,bc){this.ignorePrintArea=!1;this.vUj=()=>{const zb=w.h(this.$).Ea;this.hTc=!0;zb.zBd()};this.wXi=()=>{this.Vkd()};this.vXi=(zb,Ub,wc)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${wc} failed to execute`);
this.Vkd()};this.$=Ea;this.ea=Ea.ea;this.p8b=xb;this.$ab=new y(1,this.ignorePrintArea);this.ZD=xb=new Bc(Ea,xb,f.AFrameworkApplication.Bd,bc);this.$.da.Ga(418,xb);this.jOf=new xa(Ea);this.$.da.Ga(384,this);this.hTc=!1}get b7f(){return this.hTc}nc(){return!1}executeCommand(Ea,xb,bc,zb){const Ub=xb.command;return 1588554917===Ub||1531172830===Ub||-2050819419===Ub?(xb.yAb=!0,B.a(this.$)&&this.$.da.za(423).aAc(!1),this.bph(xb)?Za.Task.Ta(!0):n.a(Ub)):this.jOf.executeCommand(Ea,xb,bc,zb,this.wXi,this.vXi,
this.vUj)}wc(Ea,xb){switch(xb.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.kla,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);default:return this.jOf.wc(Ea,xb)}}Jc(){return!1}bph(Ea){return this.$.ea.Zb?this.cph(Ea):!1}cph(Ea){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const xb=this.$.Jb.Ac("UserAction","DoPrintHtml");var bc=this.$;bc=this.j1h(bc,this.ea.isNamedObjectViewMode?bc.Cb.na.sheetName:bc.xa.na.name);if(A.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const zb=1531172830===Ea.command||-2050819419===Ea.command;
this.ZD.xJj(bc,this.$ab,zb);e.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${zb} Command: ${t.a[Ea.command]}`)}xb.stop();this.Vkd();return!0}j1h(Ea,xb){const bc={};bc.SessionId=this.ea.sessionId;bc.UsedRangeTooBig=!1;var zb=w.h(Ea),Ub=zb.ha;const wc=Ub.Ne;if(z.e(Ea.na))bc.Type=0,bc.ObjectId=Ea.na.name,bc.UseSelection=!1;else if(z.g(Ea.na))bc.Type=1,bc.ObjectId=Ea.na.GMa,bc.UseSelection=!0;else if(2===wc||4===wc||64===wc)zb=Ub.Ra.$b.floatingObject,
bc.Type=1,bc.SheetName=xb,bc.ObjectId=zb.id,bc.UseSelection=!0;else if(wc&470)bc.ObjectId=Ub.Ra.$b.floatingObject.id,bc.SheetName=xb;else if(z.i(Ea.na)){bc.Type=2;bc.SheetName=xb;if(Ub.ra.Mg)if(Ub=Ub.ra.$c,bc.SelectedRanges=r.q(Ub,Ea),20<Ub.sH)bc.UseSelection=!0;else{xb=0;zb=zb.fk("PrintCommandHandler.DoPrintHtml",Ub);try{for(zb.$$rst();zb.$$mn()&&2>xb;)zb.$$cu().text&&xb++;bc.UseSelection=2<=xb}finally{zb&&zb.dispose()}}else bc.UseSelection=!1,bc.SelectedRanges=r.q(Ub.ra.activeRange,Ea);this.ea.isNamedObjectViewMode&&
(bc.UsedRange=r.v(Ea.na.usedRange,Ea))}bc.Title=Ea.workbookContext.WorkbookFileName;return bc}Vkd(){w.h(this.$);if(!this.b7f){this.hTc=!0;const Ea=this.$.Jb.Ac("UserAction","HandlePageLayoutRendering");this.JUj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${Ea.zc} ms.`);Ea.stop()}}JUj(){const Ea=w.h(this.$).Ea,xb=Ea.sD();let bc=!1,zb=0;for(let Ub=0;Ub<xb.length;Ub++){const wc=xb[Ub],mb=wc.rf;mb&&mb.hasPageLayout()&&(bc=!0,mb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
wc.Cd,4),zb++)}bc&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${xb.length}, number of blocks that require re-rendering is ${zb}`),Ea.zBd())}}Object(b.a)(Qa,"PrintCommandHandler",null,[165,656]);var na=a(1076),ab=a(1288),Gb=a(1289);class fc extends h.a{constructor(Ea){super(Ea)}nd(){var Ea=f.AFrameworkApplication.fa.appSettings,xb=this.$.va.DirectPrintSetting;Ea.DirectPrintIsEnabled=xb.DirectPrintIsEnabled.toString();Ea.DirectPrintProbeIsEnabled=
xb.DirectPrintProbeIsEnabled.toString();Ea.DirectPrintEnabledForInternetExplorer=xb.DirectPrintEnabledForInternetExplorer.toString();Ea.DirectPrintSupportedMimeTypes=xb.DirectPrintSupportedMimeTypes;Ea.DirectPrintSupportedPlugins=xb.DirectPrintSupportedPlugins;Ea.DirectPrintImmersivePreviewPlugins=xb.DirectPrintImmersivePreviewPlugins;Ea.DirectPrintMinimalSupportedEdgeVersion=xb.DirectPrintMinimalSupportedEdgeVersion;Ea.DirectPrintEnabledForEdge=xb.DirectPrintEnabledForEdge.toString();Ea=new na.a(Ea);
let bc=null;xb=null;try{xb=window.navigator.mimeTypes}catch(Ub){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let zb=null;try{zb=window.navigator.plugins}catch(Ub){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}bc=new Gb.a(Ea,xb,zb,Gb.a.$hf,Gb.a.vmf,new ab.a(f.AFrameworkApplication.sa.uX),f.AFrameworkApplication.sa.mE,Gb.a.wmf,(Ub,wc)=>new d.a(Ub,!1,wc),!1);if(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&
v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.he.get(116)){const Ub=m.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);l.TaskExtensions.Aa(Ub,()=>{const wc=new Qa(this.$,bc,Ub.result);this.Yc([wc])},this.$.la)}else this.Yc([new Qa(this.$,bc,null)])}static ka(Ea){h.a.Nd(73,new fc(Ea))}}Object(b.a)(fc,"PrintCommandHandlerFactory",h.a,[]);a.d(D,"a",function(){return pb});const pb=()=>{c.a.Fa(fc.ka)}},1147:function(u,D,a){var c=a(9),b=
a(0),e=a(222),f=a(50),d=a(37),h=a(15),m=a(87),l=a(82),v=a(242),t=a(620),z=a(207),r=a(116),n=a(35),w=a(40),B=a(238),A=a(44),y=a(6),x=a(36),F=a(69),I=a(589);class L extends B.a{constructor(pb,Ea){super(pb);this.W1j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.hGb=()=>{const xb=this.lVh();if(xb){this.$.FI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const bc=F.a(this.$).fd.activityState;bc[x.a.vZa]=y.a.download;bc[I.a.dWc]=this.command}A.a(this.$).Rr(xb.Errors)}};
this.iframe=pb;this.$=Ea;this.Gc.ka("load",this.hGb)}get xei(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(pb,Ea){const xb={};(pb=this.CFh(pb,xb))&&w.a.vsc("dlfr",pb,xb);this.command=Ea}CFh(pb,Ea){var xb=pb.split("?");if(2!==xb.length)return pb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),pb;xb=xb[1].split("&");for(const zb of xb){var bc=
zb.split("=",2);if(2!==bc.length){pb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}xb=bc[0];this.W1j.includes(xb)&&(bc=decodeURIComponent(bc[1]),Ea[xb]=bc,pb=z.a.UJb(pb,xb))}return pb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}lVh(){try{return this.iframe.contentWindow.ewaResult}catch(pb){if(!this.$.ea.dc.isDivSyndicated){const Ea=window.document.referrer.match(RegExp("://(.[^/]+)/"));
h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<Ea.length?Ea[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.k7a}`);throw pb;}return null}}static Swe(pb){let Ea=document.createElement("iframe");Ea.id="ewaFileLoader";Ea.style.cssText="height:0;width:0;display:none";Ea.src="about:blank";Ea.setAttribute("name","dlfr");Ea=pb.domElement.appendChild(Ea);return new L(Ea,
pb)}}Object(b.a)(L,"FileLoader",B.a,[]);var X=a(143),P=a(55);class G{constructor(pb,Ea){this.Tc=()=>{n.a.wg(F.a(this.$).fd.activityState,X.a.YBd)||this.sva.reset()};this.$=Ea;this.ymc=pb;this.ea=Ea.ea;this.ea.Tj(this.Tc);this.sva=L.Swe(this.$)}Iph(){const pb=this.VZg(this.$),Ea=this.$.userOperationManager.operationCount;0<Ea&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${Ea}`);this.$.userOperationManager.z4("DownloadACopyOperation.DownloadForkedFile");this.ymc&&h.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.sva.downloadFile(pb,-21742208);d.TaskExtensions.Aa(P.Task.delay(1),()=>{this.tdf()},this.sva.la,3)}dispose(){this.ea&&this.ea.qk(this.Tc);this.$=this.ea=null}tdf(pb=null){pb||(pb=this.$.Jb.Ac("LoadResource","DownloadACopyOperation"));!this.sva.xei&&pb.zc<G.Buf?window.setTimeout(()=>{this.tdf(pb)},G.Jph):(pb.zc>=G.Buf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),F.a(this.$).fd.PM())}VZg(pb){const Ea=new Sys.StringBuilder,
xb=pb.workbookContext,bc=pb.va;Ea.append(pb.boa);Ea.append(bc.FileHandlerRelativeUri);Ea.append("?id=");Ea.append(encodeURIComponent(z.a.UJb(xb.WorkbookUri,"sc")));pb.ea.Zb&&(Ea.append("&sessionId="),Ea.append(encodeURIComponent(pb.ea.sessionId)));Ea.append("&workbookType=FullForkedWorkbook");Ea.append("&dataloss=");Ea.append(this.ymc?"true":"false");r.a.bpb(Ea,bc);return Ea.toString()}}G.Buf=1E5;G.Jph=100;Object(b.a)(G,"DownloadACopyOperation",null,[2]);class C extends v.a{constructor(pb,Ea,xb=!1){super(pb,
Ea);this.XDb=null;this.qEd=bc=>{this.unsubscribe(zb=>{bc.remove_disposing(zb)});this.hh(y.a.Uj);this.Kp()};this.ymc=xb}execute(pb){const Ea=Object(l.a)(7,pb.Fe);if(!Ea.kla)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Zod(pb),this.hh(y.a.idle),1;this.XDb||(this.XDb=new G(this.ymc,Ea));this.XDb.Iph();h.ULS.shipAssertTag(537154817,0,3!==F.a(Ea).fi.zu,"The current activity should not be closed.");return 1}Zod(pb){const Ea=
Object(l.a)(7,pb.Fe),xb=new t.a(Ea);this.subscribe(pb,this.qEd,bc=>{xb.add_disposing(bc)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");xb.initialize();xb.ug()}dispose(){m.a.Ia(this.XDb);this.XDb=null;super.dispose()}}Object(b.a)(C,"DownloadAForkedCopyActivity",v.a,[]);class H extends e.a{constructor(pb){super();this.$=pb;this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),
()=>{this.ob(new C(y.a.O2a,y.a.Uj,!0))},this.la)}}Object(b.a)(H,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class J extends e.a{constructor(pb){super();this.$=pb;this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(new C(y.a.unmergeableDownloadCopy,y.a.mpa))},this.la)}}Object(b.a)(J,"DownloadAForkedCopyActivityFactory",e.a,[]);var M=a(84),S=a(4),W=a(80),O=a(27),T=a(105),Y=a(25);class va{constructor(pb,Ea,xb){this.La=pb;this.czg=Ea;
this.k2=xb}Fg(){this.La.Mb(Y.a.tryMacOffice,T.a.frame,Object(M.a)(this,this.C0i,"onTryMacOffice"));this.La.Mb(Y.a.Sfg,T.a.frame,Object(M.a)(this,this.oJf,"onTryMacOfficeFromViewer"));this.La.Mb(Y.a.Rfg,T.a.frame,Object(M.a)(this,this.oJf,"onTryMacOfficeFromViewer"))}C0i(pb,Ea,xb,bc,zb){if(1===xb)return 32;zb?(pb=zb.SourceControlId,"btnjTryMacOfficeForWordEditor"===pb?w.a.lf(W.a.UZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===pb&&w.a.lf(W.a.UZ(22),"_blank",
void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Apf();return 32}oJf(pb,Ea,xb){if(1===xb)return 32;switch(pb){case Y.a.Sfg:w.a.lf(W.a.UZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Y.a.Rfg:w.a.lf(W.a.UZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Apf(){w.a.lf(va.zFi,"_blank",void 0,"LaunchMacTrialWindow")}get xzc(){return this.czg&&O.a.isMac&&!O.a.usi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get EFj(){return this.xzc}static get zFi(){return W.a.PH("522401")}}
Object(b.a)(va,"MacOfficeOffer",null,[593]);var ca=a(83);class V{constructor(pb,Ea,xb){this.La=pb;this.gzg=Ea;this.nHc=null;(this.oZb=S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&ca.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(bc=>{this.nHc=bc});this.k2=xb}Fg(){this.La.Mb(Y.a.tryOffice,T.a.frame,Object(M.a)(this,this.D0i,"onTryOffice"));this.La.Mb(Y.a.tryOfficeThroughTellMe,
T.a.frame,Object(M.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Mb(Y.a.Vfg,T.a.frame,Object(M.a)(this,this.Wfg,"tryOfficeThroughViewer"));this.La.Mb(Y.a.Ufg,T.a.frame,Object(M.a)(this,this.Wfg,"tryOfficeThroughViewer"))}D0i(pb,Ea,xb,bc,zb){if(this.oZb&&1===xb)return this.isFreemiumUpsellEnabled&&this.uNb?32:8;2===xb&&(zb?(pb=zb.SourceControlId,"btnjTryOfficeForWordEditor"===pb?w.a.lf(W.a.UZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
pb?w.a.lf(W.a.UZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Alc()):this.Alc());return 32}tryOfficeThroughTellMe(pb,Ea,xb,bc,zb){if(this.oZb&&1===xb)return this.isFreemiumUpsellEnabled&&this.uNb?32:8;2===xb&&(zb?(pb=zb.SourceControlId,w.a.lf(W.a.PH("862405")+this.o0h(pb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):w.a.lf(W.a.PH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}Wfg(pb,Ea,xb){if(this.oZb&&1===xb)return this.isFreemiumUpsellEnabled&&
this.uNb?32:8;if(2===xb)switch(pb){case Y.a.Vfg:w.a.lf(W.a.UZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Y.a.Ufg:w.a.lf(W.a.UZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get kyf(){return this.uNb}get OMi(){return this.uNb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get uNb(){return this.gzg&&!O.a.isMac}get isFreemiumUpsellEnabled(){let pb=!1;this.nHc&&(pb=this.nHc.isFreemiumUpsellEnabled());return pb}Alc(pb=null){let Ea=0;pb&&(Ea=pb);w.a.lf(V.VYh(Ea),"_blank",void 0,
"LaunchOfficeOffer")}o0h(pb){let Ea=0;switch(pb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Ea=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Ea=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Ea=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Ea=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Ea=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Ea=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Ea=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Ea=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Ea=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Ea=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Ea=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Ea=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Ea=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Ea=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Ea=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Ea=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Ea=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Ea=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Ea=29}return 0===Ea?"":String.format("&pc={0:D}",Ea)}static VYh(pb){if(O.a.Xg)switch(pb){case 1:return W.a.PH("393806");case 2:return W.a.PH("393810");case 3:return W.a.PH("393809");case 5:return W.a.PH("393805")}else if(O.a.Cp)switch(pb){case 1:return W.a.PH("521979");case 3:return W.a.PH("521980");case 5:return W.a.PH("521978");
case 2:return W.a.PH("522490")}else{if(2===pb)return W.a.PH("517778");if(1===pb)return W.a.UZ(30)}return W.a.PH("522402")}}Object(b.a)(V,"OfficeTrialExperience",null,[592]);class ra{Vh(pb){pb.register(V,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").xc().Fc(()=>new V(S.AFrameworkApplication.ub,S.AFrameworkApplication.jBb,S.AFrameworkApplication.lcid));pb.register(va,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").xc().Fc(()=>new va(S.AFrameworkApplication.ub,
S.AFrameworkApplication.Ric,S.AFrameworkApplication.lcid))}}Object(b.a)(ra,"OpenInClientConfiguration",null,[5]);var N=a(552),ea=a(1358),Ba=a(38),ka=a(1194),Ka=a(146),Oa=a(152),wa=a(224),qa=a(14),aa=a(85),ia=a(107),Ha=a(86);const Z=pb=>{for(let Ea=0;Ea<pb.children.length;Ea++){const xb=pb.children[Ea];xb.style.position="relative";xb.style.top=(xb.parentNode.offsetHeight-xb.offsetHeight)/2+"px"}},la=pb=>pb.Ca.keyCode===aa.a.Sh||pb.Ca.keyCode===aa.a.xpa?(pb.Gb.click(),!0):!1,Xa=(pb,Ea,xb,bc,zb,Ub,wc)=>
{const mb=document.createElement("a");mb.className="ProtocolLaunchingDialogButtonAnchor";mb.className+=" OICDialog";mb.id=pb;mb.setAttribute(Ha.a.Ld,Ha.a.ot);mb.style.padding="0";mb.style.margin="0";bc&&Za(zb,Ea,xb,bc,mb);pb=document.createElement("span");pb.className="ProtocolLaunchingDialogButtonLabel";pb.innerText=zb;mb.appendChild(pb);mb.tabIndex=0;Ub&&wa.a.instance.ta(qa.a.click,mb,Ub);wc&&ia.KeyInputManager.instance.ta(qa.a.Dd,mb,wc);return mb},Za=(pb,Ea,xb,bc,zb)=>{var Ub=document.createElement("img");
Ub.alt=pb;Ub.className=Oa.getImageClassWithCluster(xb,bc);Ub.src=Ea;Ub.setAttribute(Ha.a.Ld,Ha.a.es);pb=document.createElement("span");pb.className="ProtocolLaunchingDialogImg32Container";pb.appendChild(Ub);Ub=document.createElement("span");Ub.className="ProtocolLaunchingDialogIconContainer";Ub.appendChild(pb);zb.appendChild(Ub)};class xa{static get ng(){return Ka.a.iq(xa.pl,CommonUIStrings.l_OICLaunchDialogTitle)}}xa.pl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(xa,"OICLaunchDialogHtml",null,[]);class fa extends Ka.a{constructor(pb){super();this.cWa=this.DDa=null;this.vqa=!1;this.Fq=pb;this.ng=xa.ng;this.Rb=5;this.Ee="OICLaunchDialog";this.showDialog("",Object(M.a)(this,this.bNi,"oicLaunchDialogResultHandler"));this.v4f();this.iX("ProtocolLaunchingDialogTitle");4!==S.AFrameworkApplication.sa.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.VI(this.DDa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}$$a(){this.DDa=Xa("BtnRichClient",this.Fq.Ptb,this.Fq.nzb,this.Fq.pnd,CommonUIStrings.l_OICLaunchRichClient,Object(M.a)(this,this.cHf,"onRichClientButtonClick"),la);document.getElementById("OICLaunchRichClient").appendChild(this.DDa);Z(this.DDa);this.cWa=Xa("BtnReturn",this.Fq.Ptb,this.Fq.nzb,this.Fq.Gdf,CommonUIStrings.l_OICReturnToOnlineClient,Object(M.a)(this,this.$Gf,"onReturnButtonClick"),
la);document.getElementById("OICReturnToApp").appendChild(this.cWa);Z(this.cWa)}$Gf(){this.hide();this.Fq.idb();return!0}cHf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();S.AFrameworkApplication.ub.processAction(Y.a.URa,2);return!0}bNi(){this.Fq.idb()}dispose(){this.vqa||(this.DDa&&(wa.a.instance.Ba(qa.a.click,this.DDa,Object(M.a)(this,this.cHf,"onRichClientButtonClick")),ia.KeyInputManager.instance.Ba(qa.a.Dd,this.DDa,la)),this.cWa&&(wa.a.instance.Ba(qa.a.click,
this.cWa,Object(M.a)(this,this.$Gf,"onReturnButtonClick")),ia.KeyInputManager.instance.Ba(qa.a.Dd,this.cWa,la)),super.dispose(),this.vqa=!0)}}Object(b.a)(fa,"OICLaunchDialog",Ka.a,[]);class ua{static get ng(){return Ka.a.iq(ua.pl,CommonUIStrings.l_OICDialogTitle)}}ua.pl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ua,"ProtocolLaunchingDialogV2Html",null,[]);a(418);var sa=a(106);class sb extends Ka.a{constructor(pb){super();this.bWa=this.xfa=null;this.vqa=!1;this.$pa=null;this.Fq=pb;this.ng=ua.ng;this.Rb=5;this.Ee="ProtocolLaunchingDialog";this.tJc="OICRetryDialog";S.AFrameworkApplication.Fi.g6a&&S.AFrameworkApplication.Fi.awc();S.AFrameworkApplication.Fi.Cg(new sa.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(M.a)(this,this.SId,"protocolLaunchingDialogResultHandler"));
this.v4f();this.iX("Issues");this.YYe();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}$$a(){const pb=document.getElementById("Issues");if(pb){Za("",this.Fq.Ptb,this.Fq.nzb,this.Fq.pnd,pb);const Ea=document.createElement("span");Ea.className="WACDialogSectionTitle";Ea.innerText=5===this.Fq.gKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;pb.appendChild(Ea);Z(pb);pb.style.display="none"}S.AFrameworkApplication.sa.Pa.ikd?
(this.bWa=Xa("GiveFeedback",this.Fq.Ptb,this.Fq.nzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(M.a)(this,this.vpc,"onGiveFeedbackClick"),Object(M.a)(this,this.lDf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.bWa),Z(this.bWa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===S.AFrameworkApplication.sa.Pa.editMode||S.AFrameworkApplication.rnh?document.getElementById("ButtonEdit").style.display="none":(this.xfa=
Xa("Edit",this.Fq.Ptb,this.Fq.nzb,"",2===S.AFrameworkApplication.sa.Pa.Fj?4===S.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===S.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(M.a)(this,this.RBf,"onEditClick"),Object(M.a)(this,this.VBf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.xfa),Z(this.xfa));0===S.AFrameworkApplication.sa.Pa.editMode&&
!S.AFrameworkApplication.jBb&&pb&&(pb.style.display="none")}$Ye(){return this.$pa?(this.VI(this.$pa),!0):!1}YYe(){return this.xfa?(this.VI(this.xfa),!0):!1}VBf(pb){return this.uCd(pb,0)}lDf(pb){return this.uCd(pb,2)}ZGf(pb){return this.uCd(pb,1)}uCd(pb,Ea){let xb=!1;if(pb.Ca.keyCode===aa.a.Sh||pb.Ca.keyCode===aa.a.xpa)pb.Gb.click(),xb=!0;else if(pb.Ca.keyCode===Sys.UI.Key.down||pb.Ca.keyCode===Sys.UI.Key.up)switch(Ea){case 1:xb=this.YYe();break;case 0:xb=this.$Ye()}return xb}RBf(){this.hide();4===
S.AFrameworkApplication.sa.Pa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Fq.idb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Fq.Hkd());return!0}vpc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Fq.y$e();return!0}vqc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";S.AFrameworkApplication.ub.processAction(Y.a.URa,2);return!0}SId(){this.Fq.idb()}switchToBackupMode(){var pb=
document.getElementById("ProtocolLaunchingDialogTitle");if(pb){pb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(pb=document.getElementById("Issues"))pb.style.display="block";(pb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!pb.children.length&&(this.$pa=Xa("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(M.a)(this,this.vqc,"onRetryOICClick"),Object(M.a)(this,this.ZGf,"onRetryOICKeyUp")),pb.appendChild(this.$pa),Z(this.$pa),this.xfa||this.$Ye())}}dispose(){this.vqa||(this.xfa&&
(wa.a.instance.Ba(qa.a.click,this.xfa,Object(M.a)(this,this.RBf,"onEditClick")),ia.KeyInputManager.instance.Ba(qa.a.Dd,this.xfa,Object(M.a)(this,this.VBf,"onEditKeyUp"))),this.bWa&&(wa.a.instance.Ba(qa.a.click,this.bWa,Object(M.a)(this,this.vpc,"onGiveFeedbackClick")),ia.KeyInputManager.instance.Ba(qa.a.Dd,this.bWa,Object(M.a)(this,this.lDf,"onGiveFeedbackKeyUp"))),this.$pa&&(wa.a.instance.Ba(qa.a.click,this.$pa,Object(M.a)(this,this.vqc,"onRetryOICClick")),ia.KeyInputManager.instance.Ba(qa.a.Dd,
this.$pa,Object(M.a)(this,this.ZGf,"onRetryOICKeyUp"))),super.dispose(),this.vqa=!0)}}Object(b.a)(sb,"ProtocolLaunchingDialog",Ka.a,[]);var hb=a(134),bb=a(424);class lb extends hb.StandardDialog{constructor(pb){super();this.Fq=pb;this.Ee="ProtocolLaunchingDialog";S.AFrameworkApplication.Fi.g6a&&S.AFrameworkApplication.Fi.awc();S.AFrameworkApplication.sa.Pa.ikd&&this.Fpe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(M.a)(this,this.vpc,"onGiveFeedbackClick"));lb.waf?(this.Rb=12,this.oc(1,
CommonUIStrings.l_CloseFile),this.oc(2,CommonUIStrings.l_OICDialogContinueHere),this.oc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.oc(1,CommonUIStrings.l_OICDialogContinueHere),this.oc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.xEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Fq.gKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(M.a)(this,this.SId,"protocolLaunchingDialogResultHandler"),null)}vpc(pb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.mCf(pb)}vqc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");S.AFrameworkApplication.ub.processAction(Y.a.URa,2)}SId(pb){lb.waf?3===pb?this.gZf():2===pb||0===pb?this.continueEditing():1===pb&&this.a6g():2===pb?this.gZf():(1===pb||0===pb)&&this.continueEditing()}a6g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");S.AFrameworkApplication.ub.ae(Y.a.close,2,bb.a)}gZf(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(M.a)(this,
this.vqc,"onRetryOICClick"),0)}continueEditing(){4===S.AFrameworkApplication.sa.Pa.editMode||S.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===S.AFrameworkApplication.sa.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Fq.idb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Fq.Hkd())}static get waf(){return S.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===S.AFrameworkApplication.ub.processAction(Y.a.close,
1)}}Object(b.a)(lb,"StandardProtocolLaunchingDialog",hb.StandardDialog,[]);var Fa=a(1239);class Na{}Object(b.a)(Na,"EditDocumentInClientParams",null,[]);class Mb{static Q9c(pb,Ea,xb,bc,zb,Ub,wc=!1,mb=!1,Db="",Ic=!1,Hc=!1,Ab=!1,db="",Pb="",td="",Vb=!1){const Ac=new Na;Ac.DocumentUrl=pb;Ac.Mode=Ea;Ac.Options=xb;Ac.Application=bc;Ac.SilentExternalHandler=wc;Ac.EncodeUrl=mb;Ac.CorrelationIdForWinClient=Db;Ac.NavigateUsingWindowOpen=Ic;Ac.DescriptiveUnattemptedEnums=Hc;Ac.NoBrowserModalDialogs=Ab;Ac.SessionOrigin=
db;Ac.CorrelationId=Pb;Ac.ClickTime=td;Ac.NewTelemetryDataIsEnabled=Vb;MSOJS.ClientUtils.EditDocumentInClient(Ac,zb,Ub)}}Object(b.a)(Mb,"ClientUtils",null,[]);var dc=a(97),Cb=a(145),Tb=a(473),Jb=a(170),eb=a(820),za=a(373),ha=a(164),fb=a(72),rb=a(189);class pa{constructor(pb){this.rga=this.u9d=this.iWa=null;this.Djb=!1;this.mPc=this.xge=null;this.ZSb=this.uE=this.gYb="";this.application=this.tC=0;this.xPj=this.kYd=!1;this.$1j=pb&&S.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");S.AFrameworkApplication.ub.H4(Y.a.URa)||
S.AFrameworkApplication.ub.Mb(Y.a.URa,T.a.frame,Object(M.a)(this,this.dqj,"retryOpenInClientAction"));this.$9f=!!S.AFrameworkApplication.fa&&S.AFrameworkApplication.fa.qa("SilentExternalHandler")}get gKf(){return this.tC}Kyc(pb,Ea="",xb=""){this.uE=xb||Jb.a.create().toString();this.gYb=Ea||Tb.a.g5e();this.ZSb=pb}dqj(pb,Ea,xb){return Ea.contextId!==T.a.frame?2:1===xb?32:this.URa()}get options(){let pb=0;S.AFrameworkApplication.aoj&&(pb|=1);S.AFrameworkApplication.openInClientEditOnly&&(pb|=4);this.uPj()&&
(pb|=64);return pb}uPj(){return!(2===this.application&&S.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Ptb(){return S.AFrameworkApplication.yB}get nzb(){return S.AFrameworkApplication.C6a}get Gdf(){return""}get pnd(){return""}get dcg(){return S.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get cCc(){return this.xge||(this.xge=ca.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.kYd||this.AEh()}idb(){this.xPj||this.QEh()}QRf(pb){this.$1j&&O.a.Xg?new fa(this):
this.b5b(pb)}b5b(pb){const Ea=({uCa:pb}=this.Lyi(pb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Ea,pb);return Ea}yHa(pb,Ea,xb,bc,zb,Ub){this.iWa=pb;this.u9d=Ea;this.rga=Ub;this.application=xb;this.tC=bc;S.AFrameworkApplication.downloadCopyOnOpenInClient?this.xpf():S.AFrameworkApplication.limitedEdit&&!S.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?S.AFrameworkApplication.u9f():this.AVg(zb)}get aNi(){return!!S.AFrameworkApplication.fa&&S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}URa(){this.aNi&&this.DBi();return this.b5b(this.Djb)}U1f(){const pb=new eb.a(ha.a.openInClient);pb.Values["ui-language"]=S.AFrameworkApplication.lcid.toString();pb.Values[Fa.a.d7c]=S.AFrameworkApplication.userSessionId;return this.rga.value.send(pb)?32:8}DBi(){dc.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new rb.a,{inStaging:!0}))}Avj(pb){const Ea=new eb.a(ha.a.n4j);Ea.Values["ui-language"]=S.AFrameworkApplication.lcid.toString();
Ea.Values[Fa.a.d7c]=S.AFrameworkApplication.userSessionId;Ea.Values[za.a.m4j]=pb;this.rga.value.send(Ea)}Lyi(pb){this.Djb=pb;this.Avj(5===this.tC?pa.f2i:pa.h2i);return 5===this.tC?this.Kyi():this.Pyi()}Kyi(){this.Epf();return{returnValue:32,uCa:"HostEditUrl,"}}Pyi(){let pb;var Ea=pb="";S.AFrameworkApplication.wqe&&(Ea="|f|"+S.AFrameworkApplication.userSessionId);const xb=S.AFrameworkApplication.fa.qa("IsAssignmentMode")&&S.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
S.AFrameworkApplication.isUnifiedHostMode||O.a.aya,bc=S.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),zb=S.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(S.AFrameworkApplication.ub.Rnc){var Ub=S.AFrameworkApplication.ub.a_(3588168074);Ub&&this.Kyc(Ub.epochClickTime,Ub.sessionOrigin,Ub.correlationId);this.Hrf()}if(S.AFrameworkApplication.mNf){pb+="NewOrder,";Ub=8;this.rga&&this.rga.value&&this.rga.value.isEnabled()&&S.AFrameworkApplication.X1d&&(pb+="Post,",Ub=this.U1f());if(32===
Ub)return{returnValue:Ub,uCa:pb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return S.AFrameworkApplication.um.Dab?(h.ULS.shipAssertTag(5566816,211,!!S.AFrameworkApplication.um.Dab),pb+="HostUrl,",{returnValue:S.AFrameworkApplication.sa.o$a(S.AFrameworkApplication.um.Dab),uCa:pb}):this.iWa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",S.AFrameworkApplication.userSessionId),pb+="DocUrl,",Mb.Q9c(this.iWa,this.tC,
this.options,this.application,Object(M.a)(this,this.UBf,"onEditInClientSuccess"),Object(M.a)(this,this.TBf,"onEditInClientFailure"),this.$9f,S.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ea,xb,bc,zb,this.gYb,this.uE,this.ZSb,S.AFrameworkApplication.ub.Rnc),{returnValue:32,uCa:pb}):{returnValue:8,uCa:pb}}pb+="OldOrder,";if(!this.iWa&&S.AFrameworkApplication.um.Dab)return this.rga&&this.rga.value&&this.rga.value.isEnabled()&&S.AFrameworkApplication.X1d?(pb+="Post,",Ea=this.U1f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Ea=8),32!==Ea?(h.ULS.shipAssertTag(22595484,211,!!S.AFrameworkApplication.um.Dab),pb+="HostUrl,",{returnValue:S.AFrameworkApplication.sa.o$a(S.AFrameworkApplication.um.Dab),uCa:pb}):{returnValue:Ea,uCa:pb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",S.AFrameworkApplication.userSessionId);pb+="DocUrl,";Mb.Q9c(this.iWa,this.tC,this.options,this.application,Object(M.a)(this,this.UBf,"onEditInClientSuccess"),
Object(M.a)(this,this.TBf,"onEditInClientFailure"),this.$9f,S.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Ea,xb,bc,zb,this.gYb,this.uE,this.ZSb,S.AFrameworkApplication.ub.Rnc);return{returnValue:32,uCa:pb}}cXf(pb){S.AFrameworkApplication.Un.setDw(8981,pb)}UBf(pb){this.cXf(pb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===pb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.dcg||this.Epf(),this.Hrf()):this.kYd||this.closeApplication()}TBf(pb,Ea=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",pb,Ea);if(5===pb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const xb=!!this.u9d&&!this.Djb;let bc=0;1===pb&&(bc=2);6<=pb&&13>=pb&&(bc=1,1===Ea&&(this.kYd=!0));this.cCc.OMi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",bc),ka.a.instance.bfh(this.Djb?Object(M.a)(this,this.Gyf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Hyf,"oicErrorDialogHandlerNoCloseForced"),
xb?Object(M.a)(this,this.qEf,"onLaunchDownload"):null,this.EMe(!1)?Object(M.a)(this,this.eei,"iHaveOfficeButtonHandler"):null,bc,Ea)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",bc),ka.a.instance.$eh(this.Djb?Object(M.a)(this,this.Gyf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.Hyf,"oicErrorDialogHandlerNoCloseForced"),xb?Object(M.a)(this,this.qEf,"onLaunchDownload"):null,bc))}}Hrf(){try{const pb=[Object.assign(new fb.a,{name:"CorrelationId",string:this.uE}),
Object.assign(new fb.a,{name:"SessionOrigin",string:this.gYb}),Object.assign(new fb.a,{name:"ClickTime",string:this.ZSb}),Object.assign(new fb.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Cb.a("OpenInClientCompleted",!0,0,pb)}catch(pb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+pb.toString())}}Epf(){S.AFrameworkApplication.sa&&S.AFrameworkApplication.sa.Pa.Jv&&S.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new lb(this):new sb(this)}Gyf(){this.closeApplication()}Hyf(){this.idb()}qEf(){this.xpf()}eei(){return this.EMe(!0)}EMe(pb){const Ea=
(O.a.xjf||O.a.bI)&&!!S.AFrameworkApplication.o8b;Ea&&pb&&(w.a.lf(S.AFrameworkApplication.o8b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Ea}}pa.h2i="OpenInDesktop";pa.f2i="OpenInBrowser";Object(b.a)(pa,"AOpenInClientOperation",null,[]);var Ma=a(5),Ja=a(203),Ga=a(76),La=a(59),nb=a(326),Lb=a(47),ac=a(46),ib=a(192),Ra=a(91),ya=a(29),Va=a(11),oa=a(21),kb=a(477),Sa=a(250),U=a(253),ta=a(150),ub=a(588);class hc extends pa{constructor(pb,Ea,xb){super(!0);this.Sa=new Ba.a;this.n9c=this.jZe=
!1;this.c5b=this.Tm=this.nEe=null;this.Tc=()=>{n.a.wg(F.a(this.$).fd.activityState,X.a.YBd)||this.sva.reset()};this.kRi=bc=>{this.cXf(bc)};this.jRi=()=>{this.hIj()};this.$=pb;this.ea=pb.ea;this.wK=Ea;this.businessBar=xb;this.ea.Tj(this.Tc);this.sva=L.Swe(this.$);this.Q8g();pb.da.Ga(55,this);this.Kga=ca.a.instance.Ub("Common.ISystemInitiatedFeedback")}get Gdf(){return"EditInExcelWebApp_32x32x32"}get la(){this.Tm=this.Tm||new ib.a;return this.Tm.token}get pnd(){return"excel32"}get dcg(){return this.ea.dc.inWebPart}g8g(){this.QRf(this.jZe)}i$g(){const pb=
this.$;d.TaskExtensions.Aa(this.wK.value,Ea=>{this.yHa(pb.workbookContext.ClientUrl,S.AFrameworkApplication.yZ,1,pb.isEditMode?2:0,!0,new N.a(()=>Ea.result))},this.la,3)}Hkd(){0!==La.a.yg.editMode&&(this.$.rb.yy=!1)}y$e(){const pb={};pb[Ma.a.hac]=!1;pb[Ma.a.GQ]="OpenInExcel";this.$.Xc(802602464,Ga.a.Db,8,pb)}M4c(){if(this.ea.Zb){var pb=this.$;pb.isEditMode&&d.TaskExtensions.Aa(this.wK.value,Ea=>{this.yHa(pb.workbookContext.ClientUrl,S.AFrameworkApplication.yZ,1,2,!1,new N.a(()=>Ea.result))},this.la,
3)}}yGe(){this.ea.Zb&&d.TaskExtensions.Aa(this.wK.value,pb=>{this.yHa(this.$.workbookContext.ClientUrl,S.AFrameworkApplication.yZ,1,this.$.isEditMode?2:0,!1,new N.a(()=>pb.result))},this.la,3)}Kyc(pb){super.Kyc(pb)}openInExcelClient(){this.ea.Zb&&(this.$.isEditMode||d.TaskExtensions.Aa(this.wK.value,pb=>{this.yHa(this.$.workbookContext.ClientUrl,S.AFrameworkApplication.yZ,1,0,!1,new N.a(()=>pb.result))},this.la,3))}openInBrowser(){this.ea.Zb&&d.TaskExtensions.Aa(this.wK.value,pb=>{this.yHa(this.$.workbookContext.ClientUrl,
S.AFrameworkApplication.yZ,1,5,!1,new N.a(()=>pb.result))},this.la,3)}downloadFile(pb){const Ea=this.ize(pb);this.sva.downloadFile(Ea,pb);this.fCi()}fCi(){S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Kga&&this.Kga.execute(pb=>pb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}cKf(pb,Ea=0){if(this.ea.Zb){var xb=this.$;F.a(xb).eNa?this.dKf(pb,xb):0<Ea?this.oNj(pb,
xb,Ea):this.j8f(xb)}}yHa(pb,Ea,xb,bc,zb,Ub){this.$.rb.yy=!this.$.dc.inWebPart;this.jZe=zb;this.c5b=null;this.n9c=!1;this.FVg(pb,Ea,bc,zb,Ub)}b5b(pb){const Ea=this.$.dc;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${Ea.inEmbedView}, InWebPart:${Ea.inWebPart}, DivSyndicated:${Ea.isDivSyndicated}, Mode:${this.$.isEditMode?Ja.a.edit:Ja.a.view}`);return hc.ikf()?(this.E4b(),Mb.Q9c(this.iWa,this.tC,this.options,1,this.kRi,this.jRi,!1,S.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.b5b(pb)}AEh(){this.iYf();const pb=this.$;if(!this.ea.dc.inWebPart&&this.ea.Zb&&!pb.isEditMode){const Ea=new Ra.a(2145659238,Ga.a.Db,this.$.Hc,0,null);this.nEe=Lb.a.instance.create(()=>{pb.Ka.Lb(Ea)},0,ac.a.i2i)}}dispose(){this.ea&&this.ea.qk(this.Tc);m.a.qc([this.Sa,this.nEe,this.Tm]);this.$=this.ea=null}QEh(){this.iYf()}xpf(){Lb.a.instance.create(()=>{this.$.Ka.Lb(new Ra.a(-2028960985,Ga.a.Db,0,30,null))},0,ac.a.j2i,!0,!0)}AVg(pb){const Ea=this.$,xb=F.a(this.$).fd.activityState;xb[kb.a.Loe]=
!0;Ea.isEditMode&&this.ea.Zb?(this.E4b(),A.a(Ea).Ks(new Sa.a(y.a.hy,5,()=>{Ea.FI(!1);xb[U.a.Kq]=y.a.G4b;xb[kb.a.HHg]=pb;xb[X.a.ddd]=!0;Ea.isEditMode&&(xb[X.a.JT]=1,xb[X.a.zY]=!0,xb[ta.a.t_b]=!0,xb[ta.a.jWc]=!0);xb[kb.a.Ooe]=1455037301}))):this.QRf(pb)}W$f(){const pb=S.AFrameworkApplication.yZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.o$a(pb,!0)){const Ea=this.$.ea.dc;h.ULS.sendTraceTag(537154773,0,50,`Url:[${pb}] IsEmbedded:[${Ea.inEmbedView}] InWebPart:[${Ea.inWebPart}] DivSyndicated:[${Ea.isDivSyndicated}], Mode:[${this.$.isEditMode?
Ja.a.edit:Ja.a.view}]`)}}else this.sva.downloadFile(pb,-2028960985);this.n9c=!0;this.E4b()}izi(){this.cCc.kyf&&this.cCc.Alc(1)}jzi(){this.cCc.kyf&&Va.HelperMethods.lf(W.a.UZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}qzi(){Va.HelperMethods.lf(W.a.UZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}rzi(){Va.HelperMethods.lf(W.a.UZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}ize(pb){const Ea=new Sys.StringBuilder,xb=this.$.workbookContext,
bc=this.$.va;Ea.append(this.$.boa);Ea.append(bc.FileHandlerRelativeUri);Ea.append("?id=");Ea.append(encodeURIComponent(z.a.UJb(xb.WorkbookUri,"sc")));this.$.ea.Zb&&(Ea.append("&sessionId="),Ea.append(encodeURIComponent(this.$.ea.sessionId)));switch(pb){case -974518828:Ea.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Ea.append("&workbookType=FullWorkbook");break;case -1059172980:Ea.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:Ea.clear()}r.a.bpb(Ea,
bc);return Ea.toString()}Q8g(){ea.a.instance.Z3g();const pb=this.$.va;MSOJS.ClientUtils.InitUrls(pb.RoamingAppsX86RootUrl,pb.RoamingAppsControlInstallerUrl,pb.RoamingAppsFirefoxExtensionUrl)}iYf(){const pb=this.$;this.ea.Zb||nb.a.WId(pb,F.a(pb).fd);this.E4b();this.c5b&&this.c5b(this,this.n9c);pb.frame.Zt.tm(this.$.frame.hba());pb.frame.uX.tm(this.$.frame.hba());pb.rb.yy=!1;oa.h(pb).focus()}FVg(pb,Ea,xb,bc,zb){const Ub=this.$;S.AFrameworkApplication.sa&&!hc.ikf()&&(Ub.frame.Zt.En(Ub.frame.hba()),Ub.frame.uX.En(Ub.frame.hba()));
super.yHa(pb,Ea,1,xb,bc,zb)}E4b(){const pb=this.$;F.a(pb).fi.activityName===y.a.openInExcelClient&&F.a(pb).fd.PM()}hIj(){const pb=ya.a.Zc(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");A.a(this.$).Rr([pb])}oNj(pb,Ea,xb){let bc=null;const zb=window.setTimeout(()=>{F.a(Ea).Ouc(bc);this.j8f(Ea)},xb);bc=()=>{F.a(Ea).eNa&&(F.a(Ea).Ouc(bc),window.clearTimeout(zb),this.dKf(pb,Ea))};F.a(Ea).oXc(bc)}j8f(pb){const Ea=ya.a.Zc(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");A.a(pb).Rr([Ea])}dKf(pb,
Ea){A.a(Ea).Ks(new Sa.a(y.a.hy,5,()=>{Ea.FI(!1);const xb=F.a(Ea).fd,bc=xb.activityState;bc[U.a.Kq]=y.a.bOe;bc[ub.a.v_b]=Ea.ea.dc.hasUnsupportedFeaturesForEdit;bc[I.a.dWc]=pb;xb.tr(ya.a.v4(this.businessBar.c$c,[1437034227]))}))}static ikf(){return 1<La.a.getRegisteredEwaInstances().length}}Object(b.a)(hc,"OpenInExcelOperation",pa,[557,2]);class Bc extends e.a{constructor(pb){super();this.$=pb;this.Fb();Bc.P8g()}create(){if(this.$.da.za(55))this.ob(this.$.da.za(55));else{var pb=f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Ya),Ea=f.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);d.TaskExtensions.Aa(P.Task.mJ(pb,Ea),()=>{this.ob(new hc(this.$,new N.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya)),Ea.result))},this.la,3)}}static P8g(){Bc.Jyf||(Bc.Jyf=!0,(new ra).Vh(ca.a.instance),ca.a.instance.resolve("Common.IOfficeTrialExperience").Fg(),ca.a.instance.resolve("Common.IMacOfficeOffer").Fg())}}Bc.Jyf=!1;Object(b.a)(Bc,"OpenInClientFactory",e.a,[]);var Qa=a(114),na=a(387);class ab extends Qa.a{constructor(pb,
Ea){super(pb,Ea)}execute(pb){const Ea=Object(l.a)(7,pb.Fe);d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(Ea.da,56,Ea.la,0),xb=>{Ea.downloadCopyOnOpenInClient?(pb.activityState[na.a.Moe]=!0,xb.result.W$f()):xb.result.i$g()},Ea.la,3);return 1}}Object(b.a)(ab,"OpenInExcelClientActivity",Qa.a,[]);class Gb extends e.a{constructor(pb){super();this.$=pb;pb.da.Ga(56,new Bc(pb));this.Fb()}create(){d.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(new ab(y.a.openInExcelClient,
y.a.idle))},this.la)}}Object(b.a)(Gb,"OpenInExcelClientActivityFactory",e.a,[]);a.d(D,"a",function(){return fc});const fc=()=>{c.a.Fa(pb=>{pb.da.Ga(57,new Gb(pb));pb.da.Ga(60,new J(pb));pb.da.Ga(63,new H(pb))})}},1150:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(85),e=a(4),f=a(107),d=a(14),h=a(87),m=a(54),l=a(30),v=a(27),t=a(12),z=a(238),r=a(1056),n=a(5),w=a(259),B=a(1057),A=a(705),y=a(1262),x=a(91);class F extends A.a{constructor(Tb,Jb,eb){super(Tb,Jb);this.It=!0;this.command=eb}Lo(Tb){super.Lo(Tb);
this.businessBar.$.Ka.Lb(new x.a(this.command,Tb,this.businessBar.$.Hc,10,null))}}Object(u.a)(F,"CommandActionBusinessBarEntry",A.a,[]);class I extends F{constructor(Tb,Jb,eb){super(Tb,Jb,eb)}MD(Tb){super.MD(Tb)}}Object(u.a)(I,"EditAttemptReadOnlyBusinessBarEntry",F,[]);var L=a(44);class X extends A.a{constructor(Tb,Jb,eb,za){super(Tb,Jb);this.error=eb;this.options=za;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.It=
!(za&4)}Lo(Tb){super.Lo(Tb);this.error.Appearance&=-33;L.a(this.businessBar.$).Rr([this.error])}}Object(u.a)(X,"ErrorBusinessBarEntry",A.a,[]);class P extends X{constructor(Tb,Jb,eb,za,ha){super(Tb,Jb,eb,za);this.command=ha;this.d_=!0}f0(Tb){super.f0(Tb);this.businessBar.$.Ka.Lb(new x.a(this.command,Tb,this.businessBar.$.Hc,10,null))}}Object(u.a)(P,"ErrorAndCommandBusinessBarEntry",X,[]);var G=a(13);class C{constructor(Tb,Jb,eb,za,ha,fb,rb,pa,Ma){this.yJ=this.L8=this.oP=0;this.Ttg=Tb;this.CSj=Jb;
this.zP=eb;this.eyg=rb;this.Qjb=l.a.qw(Ma);this.hwg=Ma;this.G6d=pa;0!==za&&(this.oP=za);0!==ha&&(this.L8=ha);0!==fb&&(this.yJ=fb)}get title(){return C.ga(this.CSj)}get message(){return C.ga(this.zP)}get messageId(){return this.zP}get r0a(){return this.Ttg}get actionButton(){return C.ga(this.oP)}get iHa(){return C.ga(this.L8)}get link(){return C.ga(this.yJ)}get dl(){return this.eyg}get Q2b(){return this.G6d}get hash(){return this.Qjb}get alt(){const {BusinessBarControl:Tb}=a(1150);switch(this.dl){case Tb.dja:return C.ga(26);
case Tb.tA:return C.ga(25);case Tb.Ci:return C.ga(24);default:return C.ga(0)}}get T$c(){return this.hwg}set Q2b(Tb){this.G6d=Tb}static ga(Tb){return G.a.instance.ga(Tb)}}Object(u.a)(C,"EwaBusinessBarEntry",null,[]);class H extends C{constructor(Tb,Jb,eb,za,ha,fb,rb,pa){super(Tb,0,Jb,eb,za,ha,fb,rb,pa)}get title(){return""}}Object(u.a)(H,"EwaNoTitleBusinessBarEntry",C,[]);var J=a(71);class M extends A.a{constructor(Tb,Jb){super(Tb,Jb);this.d_=this.It=!0}Lo(Tb){super.Lo(Tb);this.set_visible(!1);this.businessBar.$.KI();
this.businessBar.$.Ka.Lb(new x.a(1038998010,Tb,this.businessBar.$.Hc,10,null))}f0(Tb){super.f0(Tb);this.businessBar.$.Ka.Lb(new x.a(-722953877,Tb,this.businessBar.$.Hc,10,null))}MD(Tb){this.businessBar.removeEntry(55);J.g(Tb)}}Object(u.a)(M,"ExternalLinksEnableContentBusinessBarEntry",A.a,[]);class S extends A.a{constructor(Tb,Jb){super(Tb,Jb);this.It=!0;this.d_=!1}Lo(Tb){super.Lo(Tb);this.businessBar.$.Ka.Lb(new x.a(-722953877,Tb,this.businessBar.$.Hc,10,null))}MD(Tb){this.businessBar.removeEntry(5);
J.g(Tb)}}Object(u.a)(S,"ExternalLinksShowErrorBusinessBarEntry",A.a,[]);var W=a(11);class O extends A.a{constructor(Tb,Jb,eb){super(Tb,Jb);this.Oyb=eb;this.It=!0}Lo(Tb){super.Lo(Tb);W.HelperMethods.hW(this.businessBar.$.JG,this.Oyb,this.businessBar.$.KS)}}Object(u.a)(O,"HelpButtonBusinessBarEntry",A.a,[]);class T extends A.a{constructor(Tb,Jb,eb){super(Tb,Jb);this.Oyb=eb;this.Qwa=!0}Nma(Tb){super.Nma(Tb);W.HelperMethods.hW(this.businessBar.$.JG,this.Oyb,this.businessBar.$.KS)}}Object(u.a)(T,"HelpTextBusinessBarEntry",
A.a,[]);var Y=a(76);class va extends A.a{constructor(Tb,Jb,eb,za){super(Tb,Jb);this.Oyb=eb;this.command=za;this.Qwa=!0;this.It=1461300262!==za}Lo(Tb){super.Lo(Tb);this.businessBar.$.Ka.Lb(new x.a(this.command,Tb,this.businessBar.$.Hc,10,null))}Nma(Tb){super.Nma(Tb);const Jb=new x.a(-859308420,Tb,this.businessBar.$.Hc,12,null);this.businessBar.$.Ka.Lb(Jb,{[Y.a.lg]:"HelpID="+this.Oyb,["InputMethod"]:Tb,[Y.a.Ic]:n.a.tV,[n.a.Uoa]:!0})}}Object(u.a)(va,"HelpTextTaskPaneAndCommandBusinessBarEntry",A.a,[]);
class ca extends A.a{constructor(Tb,Jb){super(Tb,Jb);this.d_=this.It=!0}Lo(Tb){super.Lo(Tb);this.set_visible(!1);this.businessBar.$.KI();this.businessBar.$.Ka.Lb(new x.a(-1081442996,Tb,this.businessBar.$.Hc,10,null))}f0(Tb){super.f0(Tb);this.businessBar.$.Ka.Lb(new x.a(1702917262,Tb,this.businessBar.$.Hc,10,null))}MD(Tb){this.businessBar.removeEntry(59);J.g(Tb)}}Object(u.a)(ca,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",A.a,[]);var V=a(1059);class ra extends A.a{constructor(Tb,Jb){super(Tb,
Jb);(this.policyManager=Tb.$.da.za(274))?(this.message=this.policyManager.ksc,this.title=this.policyManager.title,this.Qwa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Nma(Tb){super.Nma(Tb);(Tb=this.policyManager.$Vi)&&Tb(null)}}Object(u.a)(ra,"PolicyBusinessBarEntry",A.a,[]);var N=a(1058),ea=a(1061),Ba=a(1060);a(418);var ka=a(145),Ka=a(25);class Oa extends A.a{constructor(Tb,
Jb){super(Tb,Jb);this.It=!0;this.title=""}Lo(Tb){super.Lo(Tb);ka.c(Ka.a.IKi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(u.a)(Oa,"UnsupportedBrowserBusinessBarEntry",A.a,[]);var wa=a(1055),qa=a(1287);class aa extends A.a{constructor(Tb,Jb){super(Tb,Jb);this.eDa=qa.a.F6b();this.It=!0;this.d_=this.eDa.g2j;this.title=this.eDa.title;this.message=this.eDa.message}get actionButton(){return this.eDa.yze}get iHa(){return this.eDa.Aze}Lo(Tb){super.Lo(Tb);this.eDa.Rzf(null)}f0(Tb){super.f0(Tb);
this.eDa.Uzf(null)}MD(Tb){super.MD(Tb);this.eDa.YMe(null)}}Object(u.a)(aa,"WildFireMobileAppBusinessBarEntry",A.a,[]);var ia=a(247),Ha=a(22),Z=a(215),la=a(159),Xa=a(39),Za=a(7),xa=a(170),fa=a(1062),ua=a(72),sa=a(132),sb=a(223),hb=a(1);class bb extends A.a{constructor(Tb,Jb,eb,za){super(Tb,Jb);hb.EwaSettings.getBooleanFeatureGate(sb.a.jB,!1)?(this.officeScriptsCommandManager=eb.da.za(519),c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager)):(this.automateCommandManager=eb.da.za(352),
c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager));this.id=xa.a.create();this.$=eb;this.title=G.a.instance.ga(2272);this.message="";this.tXd=G.a.instance.ga(2268);this.slg=G.a.instance.ga(2269);this.qlg=G.a.instance.ga(2270);this.hGe=G.a.instance.ga(2271);this.update(za)}update(Tb){this.scriptLink=Tb.scriptLink;this.runStatus=Tb.runStatus;this.buttonText=Tb.buttonText||"";this.FBi(Tb.clickId);this.ioj();"preparing"===this.runStatus?(this.kBa(0),this.message=String.format(G.a.instance.nb(208),
this.buttonText),this.It=!0,this.jsa=this.tXd,this.Crb=this.Zga=this.uab):"running"===this.runStatus?(this.kBa(0),this.message=String.format(G.a.instance.nb(207),this.buttonText),this.It=!0,this.jsa=this.tXd,this.Crb=this.Zga=this.uab):"succeeded"===this.runStatus?(this.kBa(0),this.message=String.format(G.a.instance.nb(210),this.buttonText),"true"===Tb.hasLogs?(this.It=!0,this.jsa=this.qlg,this.Zga=this.BJf,this.d_=!0,this.vYc=this.slg,this.wYc=this.CJf):(this.It=!0,this.jsa=this.slg,this.Zga=this.CJf)):
"runFailed"===this.runStatus?(this.kBa(1),this.message=String.format(G.a.instance.nb(209),this.buttonText),this.v6a=Cb.dja,"true"===Tb.hasLogs?(this.It=!0,this.jsa=this.qlg,this.Zga=this.BJf,"false"===Tb.isOwner&&(this.d_=!0,this.vYc=this.hGe,this.wYc=this.WAf)):"false"===Tb.isOwner&&(this.It=!0,this.jsa=this.hGe,this.Zga=this.WAf)):"fetchFailed"===this.runStatus?(this.kBa(1),this.v6a=Cb.dja,this.message=String.format(G.a.instance.nb(211),this.buttonText)):"canceled"===this.runStatus?(this.kBa(0),
this.v6a=Cb.tA,this.message=String.format(G.a.instance.nb(213),this.buttonText)):"alreadyRunning"===this.runStatus?(this.kBa(5),this.v6a=Cb.tA,this.message=String.format(G.a.instance.nb(212),this.buttonText),this.It=!0,this.jsa=this.tXd,this.Crb=this.Zga=this.uab):"initializing"===this.runStatus&&(this.kBa(0),this.v6a=Cb.Ci,this.message=G.a.instance.ga(2273))}get dl(){return this.v6a}get actionButton(){return this.jsa}get iHa(){return this.vYc}Lo(Tb){super.Lo(Tb);this.Zga&&this.Zga()}f0(Tb){super.f0(Tb);
this.iHa&&this.wYc()}MD(Tb){super.MD(Tb);this.Crb&&this.Crb()}ioj(){this.message="";this.v6a=Cb.Ci;this.It=!1;this.jsa="";this.Zga=void 0;this.d_=!1;this.vYc="";this.wYc=void 0;this.hideCloseButton=!1;this.Crb=void 0}uab(){const Tb=xa.a.create().toString();hb.EwaSettings.getBooleanFeatureGate(sb.a.jB,!1)?this.officeScriptsCommandManager.Akd(Tb):this.automateCommandManager.Akd(Tb);this.$lc(-2186799,Tb)}BJf(){const Tb=xa.a.create().toString();hb.EwaSettings.getBooleanFeatureGate(sb.a.jB,!1)?this.officeScriptsCommandManager.zkd(Tb):
this.automateCommandManager.zkd(Tb);this.$lc(1036446140,Tb)}CJf(){const Tb=xa.a.create();if(this.scriptLink){const Jb=new fa.b(this.scriptLink);hb.EwaSettings.getBooleanFeatureGate(sb.a.jB,!1)?this.officeScriptsCommandManager.iyb(this.id.toString(),JSON.stringify(Jb),Tb):this.automateCommandManager.iyb(this.id.toString(),JSON.stringify(Jb),Tb)}this.$lc(-585097204,Tb.toString())}WAf(){const Tb=xa.a.create().toString();hb.EwaSettings.getBooleanFeatureGate(sb.a.jB,!1)?this.officeScriptsCommandManager.ykd(Tb):
this.automateCommandManager.ykd(Tb);this.$lc(-639858579,Tb)}FBi(Tb){const Jb=[];Jb.push(Object(Za.a)(new ua.a,{name:"id",string:this.id.toString()}));Jb.push(Object(Za.a)(new ua.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Jb.push(Object(Za.a)(new ua.a,{name:"runStatus",string:this.runStatus}));Jb.push(Object(Za.a)(new ua.a,{name:"clickId",string:Tb}));Jb.push(Object(Za.a)(new ua.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ka.a(sa.a.UMi,void 0,void 0,Jb)}$lc(Tb,Jb){const eb=
[];eb.push(Object(Za.a)(new ua.a,{name:"id",string:this.id.toString()}));eb.push(Object(Za.a)(new ua.a,{name:"hasScriptLink",bool:!!this.scriptLink}));eb.push(Object(Za.a)(new ua.a,{name:"runStatus",string:this.runStatus}));eb.push(Object(Za.a)(new ua.a,{name:"clickId",string:Jb}));ka.d(Tb,void 0,void 0,void 0,void 0,void 0,eb)}}Object(u.a)(bb,"OfficeScriptsRunStatusBusinessBarEntry",A.a,[]);var lb=a(47);class Fa extends F{constructor(Tb,Jb,eb,za,ha,fb){super(Tb,Jb,eb);lb.a.instance.create(()=>{this.showCallout(Jb,
za)},ha,fb,!0,!0)}showCallout(Tb,Jb){if(this.businessBar&&this.businessBar.pla(Tb.r0a)&&this.yte()){Tb=new x.a(-847286761,0,this.businessBar.$.Hc,0,null);var eb={};eb.CalloutName=Jb;hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?eb.Target=this.rK():eb.Target=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.oP.domElement;this.businessBar.$.Ka.Lb(Tb,eb)}}yte(){return!0}}
Object(u.a)(Fa,"CalloutBusinessBarEntry",F,[]);class Na extends Fa{constructor(Tb,Jb,eb,za,ha,fb){super(Tb,Jb,eb,za,ha,fb)}yte(){if(!hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Tb=this.businessBar.$.da.za(465);return Tb&&Tb.Twc?!1:!0}}Object(u.a)(Na,"OptimizeWorkbookCalloutBusinessBarEntry",Fa,[]);var Mb=a(19);class dc extends A.a{constructor(Tb,Jb,eb){super(Tb,Jb);this.update(eb)}update(Tb){this.title=
Tb.title?Tb.title:"";this.message=Tb.message?Tb.message:"";this.hideCloseButton=!!Tb.hideCloseButton}}Object(u.a)(dc,"MsFormsDataSyncStatusBusinessBarEntry",A.a,[]);a.d(D,"BusinessBarControl",function(){return Cb});class Cb extends z.a{constructor(Tb,Jb){super(Jb);this.fKh=t.DOMElementExtensions.Ir+",div";this.sQ=Array(70);this.Nm=!1;this.eW=eb=>{if(eb.Ca.keyCode===b.a.rA){var za=this.mc.querySelectorAll(this.fKh);const ha=t.DOMElementExtensions.wm(za);za=t.DOMElementExtensions.tB(za);return t.DOMElementExtensions.rBa(eb.Ca,
ha,za)}return!1};this.jb=Tb;this.set_visible(!1);this.addCssClass(r.a.xuh);hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&e.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&this.addCssClass(r.a.Huh);f.KeyInputManager.instance.ta(d.a.Ob,this.mc,this.eW);w.a(Tb).ai(this)}get de(){return ia.a.p0c}get mc(){return this.domElement}get Ff(){return this.get_visible()}get $(){return this.jb}gg(Tb,Jb){Jb||t.DOMElementExtensions.setFocus(this.domElement.firstChild);
return!Jb}lh(Tb){return t.DOMElementExtensions.xf(this.mc,Tb)}sj(){}Wj(){}dispose(){this.Nm||(f.KeyInputManager.instance.Ba(d.a.Ob,this.mc,this.eW),h.a.qc(this.sQ),this.sQ=Array(70),this.jb=null,super.dispose(),this.Nm=!0)}pla(Tb){if(!this.get_visible())return!1;Tb=this.sQ[Tb];return!!Tb&&Tb.isVisible}nfd(Tb){return this.pla(Tb)?this.sQ[Tb].rK():null}cF(Tb){return!!this.sQ[Tb]}nQb(Tb,Jb){if(Tb=this.sQ[Tb])Tb.update(Jb),Tb.ZYj()}HC(Tb,Jb,eb=null,za=null){let ha=!1;if(this.cF(Tb))eb=this.sQ[Tb].get_visible();
else{this.set_visible(!0);const rb=Cb.c9e()[Tb];this.sQ[Tb]=this.R3(Tb,Jb,eb,za);eb=!1;ha=!0;za="";let pa=0;Jb&&(za=Jb.MessageIdName,pa=Jb.MessageId);const Ma=rb.T$c;var fb=Xa.PageLoadTrackingInfo.instance.twa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Tb}, time from app interactive: ${fb}`);hb.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(fb=this.sQ.filter(Ja=>null!=Ja).length,1<fb&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${fb.toString()}`));
hb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===rb.Q2b||la.a(this.$).pNd(rb.hash,za,pa,m.a.fDc,!0,1,Jb,Ma)}eb||!y.a.pec().includes(Tb)&&!ha||(this.sQ[Tb].set_visible(!0),this.$.KI())}removeEntry(Tb){return this.Ihj(Tb)}vLd(){h.a.qc(this.sQ);this.sQ=Array(70);this.set_visible(!1)}Ihj(Tb){if(!this.cF(Tb))return!1;h.a.Ia(this.sQ[Tb]);this.sQ[Tb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.KI();return!0}R3(Tb,Jb,eb=null,za=null){const ha=
Cb.c9e()[Tb],fb=!!(this.$.rd&64);switch(Tb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:Tb=new A.a(this,ha);break;case 12:case 29:case 30:case 31:case 32:case 34:case 57:Tb=fb?new F(this,ha,-8805455):new A.a(this,ha);break;case 22:Tb=new I(this,ha,-8805455);break;case 46:case 45:Tb=fb?new P(this,ha,Jb,0,-8805455):new X(this,ha,Jb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Tb=new X(this,ha,Jb,0);break;case 19:Tb=new A.a(this,ha);break;case 47:Tb=new X(this,ha,Jb,0);break;
case 6:case 14:Tb=new O(this,ha,Jb.HelpTopicId);break;case 67:case 65:Tb=new T(this,ha,Jb.HelpTopicId);break;case 37:Tb=new T(this,ha,n.a.pjh);break;case 38:Tb=new A.a(this,ha);break;case 68:Tb=new I(this,ha,924877417);break;case 16:Tb=new A.a(this,ha);Tb.title=l.a.Eg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Tb.message=l.a.Eg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Tb=new F(this,ha,-1762562205);Tb.hideCloseButton=!0;break;case 20:Tb=new aa(this,ha);
break;case 21:case 56:Tb=new A.a(this,ha);break;case 28:Tb=new A.a(this,ha);break;case 24:Tb=new Oa(this,ha);break;case 27:Tb=new ra(this,ha);break;case 39:Tb=new wa.a(this,ha);break;case 40:Tb=new B.a(this,ha);break;case 41:Tb=new N.a(this,ha);break;case 42:Tb=new V.a(this,ha);break;case 48:Tb=new A.a(this,ha);break;case 49:Tb=new A.a(this,ha);break;case 50:Tb=new A.a(this,ha);break;case 51:Tb=new A.a(this,ha);break;case 52:Tb=new A.a(this,ha);break;case 53:Tb=new Ba.a(this,ha);break;case 54:Tb=
new ea.a(this,ha);break;case 55:Tb=new M(this,ha);break;case 5:Tb=new S(this,ha);break;case 58:Tb=new F(this,ha,-1753056834);Jb?(Jb=Jb.Directive,Ha.a.Wq(Jb)||"&nbsp;"===Jb||(Tb.message=Jb)):eb&&(Tb.message=eb);break;case 59:Tb=new ca(this,ha);break;case 60:Tb=new A.a(this,ha);break;case 63:Tb=new T(this,ha,n.a.dMi);break;case 61:Tb=new va(this,ha,n.a.rVg,-8805455);break;case 66:Tb=new va(this,ha,n.a.cdj,1461300262);break;case 62:Tb=new Na(this,ha,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");
Tb.message=eb;break;case 64:Tb=new bb(this,ha,this.$,za);break;case 69:Tb=new dc(this,ha,za);break;default:Tb=new X(this,ha,Jb,7)}Tb.C5c();return Tb}static c9e(){let Tb;Tb=Z.a.zNa()?261:260;return Cb.nze||(Cb.nze=[new C(0,276,277,278,0,0,Cb.dja,1,"BB_UnableToRefreshLock"),new C(1,276,277,278,0,0,Cb.dja,1,"BB_UnableToRefreshLockExpected"),new C(2,268,269,0,0,0,Cb.tA,5,"BB_WorkbookAlmostTooLarge"),new C(3,270,271,272,0,0,Cb.dja,1,"BB_WorkbookTooLarge"),new C(4,259,Tb,0,0,0,Cb.tA,5,"BB_ExternalWorkbookLinksDisabled"),
new C(5,263,262,264,0,0,Cb.dja,1,"BB_ExternalWorkbookLinksShowError"),new C(6,265,266,267,0,0,Cb.Ci,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new C(7,251,252,253,0,0,Cb.Ci,5,"BB_UnsupportedFeatures"),new C(8,0,0,0,0,0,Cb.Ci,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new C(9,0,0,0,0,0,Cb.Ci,0,"BB_CollabDataStringsLocaleMismatch"),new C(10,0,0,0,0,0,Cb.Ci,0,"BB_CollabDataLocaleMismatch"),new C(11,279,280,281,0,0,Cb.dja,1,"BB_LastGenericStatusError"),new C(12,282,283,284,0,0,Cb.tA,5,"BB_ScratchPadWarning"),
new C(13,285,286,287,0,0,Cb.dja,1,"BB_AuthenticationLost"),new C(14,288,289,290,0,0,Cb.tA,5,"BB_OdfCompatibilityIssues"),new C(15,0,575,0,0,0,Cb.tA,5,"BB_PivotChartInteractivityMissingWarning"),new C(16,0,0,0,0,0,Cb.Ci,2,"BB_WorkbookIsIrmProtected"),new C(17,0,0,0,0,0,Cb.Ci,0,"BB_BIFeatureNotAvailable"),new C(18,291,292,287,0,0,Cb.tA,5,"BB_AnonymousCreateMode"),new C(19,254,255,0,0,0,Cb.tA,5,"BB_UnsupportedInteractiveReportEditing"),new C(20,0,0,0,0,0,Cb.Ci,0,"BB_MobileAppCampaignBizBar"),new C(21,
297,298,0,0,0,Cb.Ci,0,"BB_TransientServerCommunicationFailures"),new C(22,1636,1647,1648,0,0,Cb.Ci,5,"BB_EditAttemptInReadOnly"),new C(23,1636,1647,0,0,0,Cb.Ci,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new C(24,0,W.HelperMethods.tYj(),1625,0,0,Cb.Ci,3,"BB_UnsupportedBrowser"),new C(25,300,301,0,0,0,Cb.Ci,2,"BB_ReadOnlyPermissions"),new C(26,302,303,0,0,0,Cb.Ci,2,"BB_DocumentIsIrmProtectedWarning"),new C(27,0,0,0,0,0,Cb.tA,5,"BB_PolicyWarningMessage"),new C(28,1279,299,0,0,0,Cb.Ci,0,"BB_WorkingOnIt"),
new C(29,1636,1634,1635,0,0,Cb.Ci,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new C(30,1649,1650,1651,0,0,Cb.Ci,5,"BB_WorkbookIsReadOnlyRecommended"),new C(31,1636,1652,1653,0,0,Cb.Ci,5,"BB_WorkbookHasPasswordToModify"),new C(32,1636,1654,1657,0,0,Cb.Ci,3,"BB_LegacySharedWorkbookEditWarning"),new C(33,1644,1655,253,0,0,Cb.Ci,5,"BB_LegacyConnectionsWarning"),new C(34,1636,1952,1648,0,0,Cb.Ci,0,"BB_TooManyLoadBlockingFloatingObjects"),new C(35,1645,1646,0,0,0,Cb.Ci,2,"BB_GroupedSlicers"),new C(36,
313,314,0,0,0,Cb.tA,5,"BB_ThirdPartyAddinDisabled"),new C(37,1778,1779,0,0,1780,Cb.Ci,5,"BB_FinanceLinkedEntityDisclaimerBar"),new C(38,1807,1808,0,0,0,Cb.tA,5,"BB_WolframDeprecationAlertBar"),new C(39,0,0,0,0,0,Cb.Ci,0,"BB_WacGdprNotice"),new C(40,0,0,0,0,0,Cb.Ci,0,"BB_AutomaticSensitivityLabel"),new C(41,0,0,0,0,0,Cb.Ci,0,"BB_RecommendedSensitivityLabel"),new C(42,0,0,0,0,0,Cb.Ci,0,"BB_MandatorySensitivityLabel"),new C(43,315,316,317,0,0,Cb.Ci,0,"BB_LocalStorageDisabled"),new C(44,632,633,0,0,0,
Cb.Ci,0,"BB_AutoRefreshDisabled"),new C(45,1009,1007,1011,1308,0,Cb.Ci,4,"BB_CorruptedFileRepaired"),new C(46,1010,1008,1011,1308,0,Cb.Ci,5,"CorruptedOdsFileRepaired"),new C(47,273,274,275,0,0,Cb.tA,5,"BB_MinorVersionLimitReached"),new C(48,304,305,0,0,0,Cb.tA,5,"BB_SensitivityApplicationGenericError"),new C(49,306,308,0,0,0,Cb.tA,5,"BB_SensitivityApplicationTooLargeFileError"),new C(50,307,308,0,0,0,Cb.tA,5,"BB_SensitivityApplicationLabelNotSupportedError"),new C(51,309,310,0,0,0,Cb.tA,5,"BB_SensitivityApplicationLabelDisabledError"),
new C(52,311,312,0,0,0,Cb.tA,5,"BB_SensitivityApplicationMandatoryConflictError"),new C(53,0,0,0,0,0,Cb.tA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new C(54,0,0,0,0,0,Cb.tA,5,"BB_SensitivityApplicationSetLabelError"),new C(55,2109,2110,2111,2114,0,Cb.Ci,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new C(56,297,298,0,0,0,Cb.Ci,0,"BB_NetworkDown"),new C(57,318,319,320,0,0,Cb.Ci,2,"BB_DefaultToViewDueToCogs"),new C(58,1804,1805,1806,0,0,Cb.Ci,1,"BB_RefreshLinkedEntityErrorBar"),
new C(59,1781,1782,1783,1784,0,Cb.Ci,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new H(60,250,0,0,0,Cb.Ci,5,"BB_CanvasHealth"),new C(61,1012,1013,1308,0,1014,Cb.Ci,5,"BB_MismatchedFileFormatConverted"),new C(62,2228,0,2230,0,0,Cb.Ci,5,"BB_OptimizeWorkbook"),new C(63,321,322,0,0,323,Cb.Ci,0,"BB_NovModePostDepreciation"),new C(64,0,0,0,0,0,Cb.Ci,0,"BB_OfficeScriptsRunning"),new C(65,2204,2205,0,0,2207,Cb.Ci,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new C(66,324,325,0,0,326,Cb.Ci,5,"BB_ReadOnlyPivotTable"),
new C(67,2204,2206,0,0,2207,Cb.Ci,0,"BB_PowerQueryRefreshHostNotSupported"),new C(68,1051,v.a.gjc?1053:1052,1050,0,0,Cb.Ci,4,"BB_RefreshPageAfterEnablingTheExtension"),new C(69,0,0,0,0,0,Cb.Ci,0,"BB_MsFormsDataSyncStatus")])}}Cb.dja=Mb.a.Sxh;Cb.tA=Mb.a.Uxh;Cb.Ci=Mb.a.Txh;Cb.nze=null;Object(u.a)(Cb,"BusinessBarControl",z.a,[39])},1153:function(u,D,a){var c=a(9);u=a(0);var b=a(692),e=a(50),f=a(37),d=a(15),h=a(1071),m=a(148),l=a(24),v=a(76),t=a(58);class z{constructor(pa){this.options=null;this.options=
pa}}Object(u.a)(z,"MacroRecorderRangeCustomSortedPayload",null,[125]);var r=a(955),n=a(956),w=a(42),B=a(371),A=a(188),y=a(283),x=a(142),F=a(29),I=a(282),L=a(1),X=a(183),P=a(22),G=a(281),C=a(21),H=a(799),J=a(749),M=a(261),S=a(208),W=a(13),O=a(134);class T{constructor(pa){this.yw=Ma=>{switch(Ma){case 0:this.POa("Cancel");break;case 1:this.POa("Expand and sort");this.fWe(!0);break;case 2:this.POa("Just sort"),this.fWe(!1)}};this.fWe=pa}show(){const pa=new O.StandardDialog;pa.Rb=11;pa.oc(1,W.a.instance.ga(2116));
pa.oc(2,W.a.instance.ga(2117));pa.q9f(W.a.instance.ga(2115),W.a.instance.Ua(657),this.yw)}POa(pa){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${pa}`)}}Object(u.a)(T,"ExpandSortSelectionDialog",null,[]);const Y=(pa,Ma)=>{pa=pa.ColumnInfo;switch(Ma){case 1:return pa.CellColors&&pa.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return pa.TextColors&&pa.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return pa.Icons&&pa.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return d.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},va=(pa,Ma,Ja,Ga)=>{pa=pa.HeaderColumnInfo;return Ga||pa?2===Ma&&Ja?pa.CellColors&&1!==pa.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):pa.TextColors&&1!==pa.TextColors.length?(d.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):pa.Icons&&1!==pa.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:pa?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${Ja} == 0.`),!1):!0:!0};var ca=a(187);class V{static isValid(pa){return V.gFh.includes(pa.Position)?
!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${pa.Position}]`),!1)}}V.gFh=[0,.5,1];Object(u.a)(V,"FillGradientStopExtension",null,[]);class ra{constructor(pa,Ma,Ja,Ga){new Sys.UI.Point(pa,Ma);new Sys.UI.Point(Ja,Ga)}}Object(u.a)(ra,"GradientLine",null,[]);class N{static isValid(pa){if(!(pa.Degree.toString()in N.eFh))return d.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${pa.Degree}]`),!1;if(!pa.GradientStops)return d.ULS.shipAssertTag(537159828,
0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(pa.GradientStops.length<N.sIi||pa.GradientStops.length>N.YGi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${pa.GradientStops.length}]`),!1;for(const Ma of pa.GradientStops)if(!V.isValid(Ma))return!1;return!0}}N.sIi=2;N.YGi=3;N.eFh={["0"]:new ra(0,0,1,0),["180"]:new ra(1,0,0,0),["90"]:new ra(0,0,0,1),["270"]:new ra(0,1,0,0),["45"]:new ra(0,0,1,1),["225"]:new ra(1,1,0,0),
["135"]:new ra(1,0,0,1),["315"]:new ra(0,1,1,0)};Object(u.a)(N,"FillGradientExtension",null,[]);const ea=pa=>pa.SortRange?4===pa.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${pa.SortRangeType}`),!1):2===pa.SortRangeType&&pa.SortTopToBottom&&(null==pa.HeaderRowSize||0>pa.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),
!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),Ba=pa=>{if(!pa.SortConditions)return!0;for(const Ma of pa.SortConditions){if(!Ka(pa,Ma.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Ma.RowColOffset}] is out of bounds. sort range: ${pa.SortRange}`),!1;if(1===Ma.SortConditionType&&Ma.FillGradient&&!N.isValid(Ma.FillGradient))return d.ULS.sendTraceTag(537151619,0,
10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ka=pa=>{if(!pa.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Ma=new ca.a;for(var Ja of pa.SortColumnInfoItems){if(!Ka(pa,Ja.ColumnOffset))return d.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${Ja.ColumnOffset}] is out of bounds. sort range: ${pa.SortRange}`),
!1;if(!Ja.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${Ja.ColumnOffset}]`),!1;if(Ja.CellColors&&!Ja.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${Ja.CellColors.length}]`),!1;if(Ja.TextColors&&!Ja.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${Ja.TextColors.length}]`),
!1;if(Ja.Icons&&!Ja.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${Ja.Icons.length}]`),!1;Ma.add(Ja.ColumnOffset)}if(pa.SortConditions)for(const Ga of pa.SortConditions)if(!Ma.contains(Ga.RowColOffset))return d.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${Ga.RowColOffset}]`),!1;if(pa.HeaderColumnInfoItems){if(pa.HeaderColumnInfoItems.length!==
pa.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Ma=0;Ma<pa.HeaderColumnInfoItems.length;++Ma){Ja=pa.HeaderColumnInfoItems[Ma];if(Ja.ColumnOffset!==pa.SortColumnInfoItems[Ma].ColumnOffset)return d.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(Ja.CellColors&&1<Ja.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Ja.TextColors&&1<Ja.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Ja.Icons&&1<Ja.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0},Ka=(pa,Ma)=>{const Ja=pa.SortRange;pa=pa.SortTopToBottom?Ja.LastColumn-Ja.FirstColumn:Ja.LastRow-Ja.FirstRow;return 0<=Ma&&Ma<=pa};var Oa=a(380),wa=a(132),qa=a(89),aa=a(133);class ia extends Oa.a{constructor(pa,Ma){super(pa,Ma);this.wEb=this.Hed();this.Sr()}get pc(){return"SortMergedCellsErrorDialog"}PO(pa,Ma){if(1===pa){var Ja=w.v(this.wEb,this.$);C.h(this.$).pg(Ja,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}Ja={["DialogButton"]:pa,["Location"]:"dialog"};aa.b(this.$).Gd(wa.a.TLj,
Ja,null,!0);super.PO(pa,Ma)}Sr(){super.Sr();const pa=this.QLj();this.Rb=1;this.oc(1,W.a.instance.ga(2235));this.$l(W.a.instance.ga(2236),qa.a.Rg(pa),1,this.h8)}QLj(){return String.format(W.a.instance.nb(174),this.wEb.toString())}Hed(){const pa=this.error.Description.split("_");return new l.Range(Number.parseInvariant(pa[1])+1,Number.parseInvariant(pa[2])+1,Number.parseInvariant(pa[3])+1,Number.parseInvariant(pa[4])+1,!0,!1)}}Object(u.a)(ia,"SortMergedCellsErrorDialog",Oa.a,[]);var Ha=a(69),Z=a(574),
la=a(608);class Xa extends H.a{constructor(pa,Ma,Ja,Ga){super(pa);this.Xhc=this.AUd=!1;this.g7=[];this.Yki=(La,nb)=>{const Lb=this.Adh(La);this.TMa(214,(ac,ib,Ra)=>y.p(this.$.pa.ya,Lb,this.R0a(ac,this.JMh(nb)),this.hU(ib),Ra,null),16,!0)};this.Xki=(La,nb,Lb)=>{La=y.o(this.$.pa.ya,nb,this.wNh(nb,Lb),this.eUi,null,La);this.g7.push(La)};this.eUi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.z8b(Xa.zsb())};
this.B8c=(La,nb)=>{if(1===La){La=nb.sortRangeType;const Lb={};Lb.SortOptions=nb.sortOptions;Lb.ShouldRestoreSelection=this.AUd;Lb.SelectedRange=this.selectedRange;Lb.OriginalActiveCell=this.frc;Lb.TopCellAddress=this.KUa;Lb.ShouldPromptNamedSheetViewTeachingDialog=0===La||3===La;Xa.lbj(this.$,Lb)}else this.AUd&&this.tpa(this.selectedRange,this.frc)};this.xdi=(La,nb)=>{this.AUd=!0;this.tpa(La,nb)};this.getColorName=La=>J.a.vLa(S.a.IH(La));d.ULS.shipAssertTag(529105669,0,!!Ma.ActiveCell);d.ULS.shipAssertTag(529105668,
0,!!Ma.SelectedRange);d.ULS.shipAssertTag(529105667,0,w.D(Ma.SelectedRange).contains(w.C(Ma.ActiveCell)));d.ULS.shipAssertTag(529105666,0,P.a.equals(Ma.SelectedRange.SheetName,Ma.ActiveCell.SheetName,!0));this.wdb=new la.a(pa,Z.a.Oih,()=>this.Xhc,1);this.selectedRange=Ma.SelectedRange;this.frc=Ma.ActiveCell;this.R0g=Ma.ExpandSelection;this.namedSheetViewPublic=Ja;this.KUa=Ga;this.initializeAndShow(W.a.instance.ga(181),this.B8c,this.Tta(Ma))}dispose(){this.Xhc||(this.Xhc=!0,this.u3b(),this.g7=null,
this.wdb.dispose(),this.wdb=null);super.dispose()}get pc(){return"CustomSortDialog"}get ha(){return C.h(this.$).ha}JMh(pa){return Ma=>{I.b(Ma,-901005882)?(Ha.a(this.$).fd.xM(-901005882),this.PId()):I.b(Ma,-569193796)?(Ha.a(this.$).fd.xM(-569193796),this.hide(),new ia(this.$,Ma.Errors[0])):I.a(Ma)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(Ma=Ma.Result,this.$.jk(Ma.SortRange),Ma&&ea(Ma)&&Ba(Ma)&&
ka(Ma)?pa(Ma):this.z8b(Xa.zsb()))}}wNh(pa,Ma){return(Ja,Ga)=>{if(this.Xhc)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Ja||I.a(Ja))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${F.a.sc(Ja.Errors)}`),this.$.ea.Qo(Ja.Errors),this.hide();else{Ja=Ja.Result;var La=pa.RangeType,nb=pa.HeaderRowSize,Lb=pa.SortTopToBottom;
Ja&&Y(Ja,pa.ConditionType)&&va(Ja,La,nb,Lb)?(Ja.ColumnInfo.ColumnOffset=Ga,void 0!==Ja.HeaderColumnInfo&&null!==Ja.HeaderColumnInfo&&(Ja.HeaderColumnInfo.ColumnOffset=Ga),Ma(Ja,pa.ConditionType,pa.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.z8b(Xa.zsb()))}}}Adh(pa){const Ma={};Ma.SelectedRange=this.selectedRange;Ma.ActiveCell=this.frc;Ma.SortInfoMode=pa;Ma.ExpandSortSelection=
this.R0g;Ma.ExpandSortSelectionSupported=!0;return Ma}Tta(pa){const Ma={};Ma[M.a.vu]=this.pc;Ma.fromAutoFilter=pa.FromAutoFilter;Ma.gridRTL=C.h(this.$).rtl;Ma.activeCell=pa.ActiveCell;Ma.selectedRange=pa.SelectedRange;Ma.invokeGetSortInfo=this.Yki;Ma.invokeGetSortConditionColorsOrIcons=this.Xki;Ma.highlightSortRange=this.xdi;Ma.getColorName=this.getColorName;return Ma}tpa(pa,Ma){pa=w.D(pa);this.ha.ra.$c.equals(pa)||this.ha.updateSelection(pa,w.C(Ma),0,void 0,void 0,void 0,!0)}PId(){(new T(pa=>{const Ma=
{};Ma.ActiveCell=this.frc;Ma.SelectedRange=this.selectedRange;Ma.ExpandSelection=pa;Ma.FromAutoFilter=!1;this.$.Xc(-207540907,v.a.Db,8,{["SortCommandData"]:Ma})})).show()}u3b(){if(void 0!==this.g7&&null!==this.g7)for(const pa of this.g7)this.$.pa.ya.jgb(pa.nu)}static lbj(pa,Ma){pa.Xc(1659552324,v.a.Db,8,{["CustomSortCommandData"]:Ma})}static zsb(){return F.a.Zc(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(u.a)(Xa,"CustomSortDialog",H.a,[]);var Za=a(1072);class xa{constructor(pa){this.selection=
null;this.selection=pa}getSelection(){return this.selection}}Object(u.a)(xa,"MacroRecorderRangeAutoFilterClearedPayload",null,[125]);class fa{constructor(pa){this.filterRange=null;this.filterRange=pa}}Object(u.a)(fa,"MacroRecorderRangeFilterReappliedPayload",null,[125]);var ua=a(60);const sa=(pa,Ma,Ja,Ga,La,nb,Lb=null)=>{Lb=pa.Na(41,Lb);Lb.options=Ma;return ua.g(pa,"Sort",Lb,Ja,Ga,La,nb,0)},sb=(pa,Ma,Ja,Ga,La,nb,Lb=null)=>{Lb=pa.Na(41,Lb);Lb.selectedRange=Ma;return ua.g(pa,"ClearAutoFilter",Lb,Ja,
Ga,La,nb,0)},hb=(pa,Ma,Ja,Ga,La,nb,Lb=null)=>{Lb=pa.Na(41,Lb);Lb.filterRange=Ma;return ua.g(pa,"ReapplyAutoFilter",Lb,Ja,Ga,La,nb,0)};var bb=a(771),lb=a(772),Fa=a(112),Na=a(55),Mb=a(1073),dc=a(198),Cb=a(33),Tb=a(343),Jb=a(64);class eb{constructor(pa,Ma){this.sortOptions=this.QTa=this.selectedRange=null;this.thf=!1;this.activeCell=this.Ae=this.vb=this.kc=null;this.onContentReady=()=>{this.cTf(!1);const Ja=this.ha();Ja.ra.Mg&&Ja.ra.$c.equals(this.QTa)&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?
Ja.updateSelection(this.selectedRange,w.C(this.activeCell),0,void 0,void 0,void 0,!0):Ja.updateSelection(this.selectedRange,Ja.ra.activeCell,0,void 0,void 0,void 0,!0))};this.NTi=(Ja,Ga)=>{Ja&&!F.a.Zf(Ja.Errors)&&this.kc&&(this.kc.fp=Ja.Result,this.vMb(),this.applyPivotSort(Ga))};this.MTi=()=>{};this.w0i=(Ja,Ga)=>{var La;((null===Ga||void 0===Ga?0:Ga.USj)||(null===(La=this.$.na)||void 0===La?0:La.hasAutoFilter))&&Ga.selection&&Cb.a.tjf()&&(Ja=Jb.d(this.$.xa.na),this.VSj(new Tb.a(w.D(Ga.selection),
Ja)))};this.$=pa;this.jpf="";this.namedSheetViewPublic=Ma;this.gridView=C.h(this.$);this.$.Jb.Ng("LoadResource","LoadDialogControlsStopwatch")}q1(pa){if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var Ma=this.$.da.za(465);Ma&&Ma.q1(5,pa)}}nc(pa,Ma){return!this.Lsd(pa,Ma)}executeCommand(pa,Ma,Ja){let Ga=null;pa=Ma.command;switch(pa){case -864298118:Ga=this.Toh(Ma,Ja);break;case -1010737776:Ga=this.h9c(!0,Ma,Ja);break;case 2123420468:Ga=
this.h9c(!1,Ma,Ja);break;case -1089513346:Ja=this.X1e(Ja);if(!this.PBb([w.D(Ja.SortOptions.SelectedRange)]))return f.TaskExtensions.Rj();Ga=this.CNe(Ma,Ja);break;case -1032691499:case -764711886:case -2016161444:Ga=this.p$i(Ma,Ja);break;case -207540907:case -1677817820:Ga=this.gridView.Bb.J5(this.ha().ra.activeCell)?this.f$i():this.c$i(Ma,Ja);break;case 1659552324:Ga=this.CNe(Ma,this.X1e(Ja));break;case 368460465:Ga=this.iph(Ma,Ja);break;case 529856798:Ga=this.Ooh(Ma);break;case 644342024:Ga=this.dph(Ma)}return Ga||
X.a(pa)}wc(pa,Ma){if(pa=1===pa)switch(Ma.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:pa=!1}return pa}Jc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}cTf(pa){pa?this.gridView.mv(this.onContentReady):this.gridView.Oy(this.onContentReady);this.thf=pa}get ra(){return this.ha().ra}UGj(pa){return!!this.sortOptions&&
P.a.equals(this.jpf,pa.Jia,!0)}Lsd(pa,Ma){const Ja=C.h(this.$).ha.ra.selectedRanges;return(new x.a(this.$.xa)).zm(pa,Ma,Ja,this.gridView)}h9c(pa,Ma,Ja){const Ga=new h.a;this.Hef(Ga,Ja,pa);return this.PBb([w.D(Ga.SelectedRange)])?this.gridView.Bb.J5(w.D(Ga.SelectedRange))?this.aph(pa):this.$od(Ga,Ma):f.TaskExtensions.Rj()}Toh(pa,Ma){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let Ja=null;const Ga=this.ha();Ga&&(this.UGj(Ga)?this.PBb(Ga.ra.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Ja=this.$od(this.sortOptions,pa)):Ja=this.h9c(!0,pa,Ma));return Ja}PBb(pa){return L.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")?this.$.isEditMode?this.$.Zp(pa,!0,1):this.$.hZc(pa,!0,1):!0}aph(pa){this.E0h(pa);return Na.Task.Ta(!0)}EYg(pa){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Ma=this.gridView.Bb.Bj(this.ra.$c,!1);if(Ma)return new n.a(Ma.name,this.ra.activeCell.left-
Ma.usedRange.left,pa.IsAscending)}return new r.a(pa)}$od(pa,Ma){this.gridView.Gf.tH(!1);const Ja=()=>this.EYg(pa);return this.z$c((Ga,La,nb)=>sa(this.$.pa.ya,pa,G.b(Ga,this.xNh(Ma)),La,nb,pa),Ga=>new A.a(141,0,Ga,void 0,Ja),Ma,this.MFj(pa))}MFj(pa){if(!this.namedSheetViewPublic)return!1;const Ma=this.ra.$c,Ja=w.v(this.ra.$c,this.$),Ga=this.gridView.Bb.K5(Ma,!0),La=this.ra.gca()&&this.gridView.Bb.alf(Ja),nb=this.gridView.Bb.Qsi(Ja);pa=(Ma.V5||Ma.E_)&&!Ma.isSingle&&(null==pa.ExpandSortSelection?!1:
pa.ExpandSortSelection)&&this.gridView.Bb.alf(Ja);return Ga||La||nb||pa}f$i(){return this.$.Xc(-1556797033,v.a.Db,8,null)}c$i(pa,Ma){pa=8===pa.$e&&Ma&&void 0!==Ma[eb.cfb]&&null!==Ma[eb.cfb]?Ma[eb.cfb]:19===pa.$e&&Ma&&void 0!==Ma[v.a.lg]&&null!==Ma[v.a.lg]?t.a.li(Ma[v.a.lg]):this.Fch();if(!this.PBb([w.D(pa.SelectedRange)]))return f.TaskExtensions.Rj();C.h(this.$).Gf.tH(!1);let Ja=null;(Ma=Ma.TopCellAddress)&&(Ja=w.o(Ma,this.$));new Xa(this.$,pa,this.namedSheetViewPublic,Ja);return Na.Task.Ta(!0)}X1e(pa){return pa[eb.Nih]}CNe(pa,
Ma){const Ja=nb=>{this.Uaf(nb)?this.I$e(nb.Errors[0]):(Ma.ShouldRestoreSelection&&this.tpa(Ma.SelectedRange,Ma.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${pa.$e}`),this.MUj(Ma),this.q1(nb))},Ga=()=>{Ma.ShouldRestoreSelection&&this.tpa(Ma.SelectedRange,Ma.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${pa.$e}`)},
La=()=>new z(Ma.SortOptions);return this.z$c((nb,Lb,ac)=>sa(this.$.pa.ya,Ma.SortOptions,G.b(nb,Ja),G.a(Lb,Ga),ac,this.sortOptions),nb=>new A.a(187,0,nb,void 0,La),null,Ma.ShouldPromptNamedSheetViewTeachingDialog)}tpa(pa,Ma){pa=w.D(pa);C.h(this.$).ha.ra.$c.equals(pa)||C.h(this.$).ha.updateSelection(pa,w.C(Ma),0,void 0,void 0,void 0,!0)}Fch(){const pa={};pa.ActiveCell=w.o(this.ra.activeCell,this.$);pa.SelectedRange=w.v(this.ra.$c,this.$);pa.FromAutoFilter=!1;pa.ExpandSelection=null;return pa}iph(pa,
Ma){const Ja=this.gba();if(!Ja)return Na.Task.Ta(!1);const Ga=this.$.pa.ya.Wb(),La=()=>new Za.a(Ja);return B.a(this.$.userOperationManager,(nb,Lb,ac)=>y.B(this.$.pa.ya,Ja,G.b(bb.a.C5a(Fa.a.Spb,lb.a.toggleAutoFilter,nb),this.w0i),Lb,ac,{selection:Ja,USj:Ma.On},Ga),nb=>new A.a(516,0,nb,64,La),pa)}Ooh(pa){const Ma=this.gba();if(!Ma)return Na.Task.Ta(!1);const Ja=this.gridView.Bb.Bj(this.ra.$c,!0);Ja&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${Ja.type.toString()}`);
const Ga=this.$.pa.ya.Wb(),La=()=>new xa(Ma);return this.z$c((nb,Lb,ac)=>sb(this.$.pa.ya,Ma,bb.a.C5a(Fa.a.vHa,lb.a.clearAutoFilter,nb),Lb,ac,null,Ga),nb=>new A.a(517,0,nb,64,La),pa)}z$c(pa,Ma,Ja,Ga=!0){return this.namedSheetViewPublic&&Ga?this.namedSheetViewPublic.yTa().continueWith(La=>{La.result&&B.a(this.$.userOperationManager,pa,Ma,Ja)}):B.a(this.$.userOperationManager,pa,Ma,Ja)}dph(pa){const Ma=this.gba();if(!Ma)return Na.Task.Ta(!1);const Ja=this.$.pa.ya.Wb(),Ga=()=>new fa(Ma);return B.a(this.$.userOperationManager,
(La,nb,Lb)=>hb(this.$.pa.ya,Ma,bb.a.C5a(Fa.a.vHa,lb.a.bcj,La),nb,Lb,null,Ja),La=>new A.a(518,0,La,64,Ga),pa)}xNh(pa){return(Ma,Ja)=>{var Ga;I.b(Ma,-901005882)?(Ha.a(this.$).fd.xM(-901005882),this.PId(Ja,pa.command)):this.Uaf(Ma)?this.I$e(Ma.Errors[0]):!I.a(Ma)&&Ma.Result&&(this.sortOptions=Ja,this.QTa=w.D(Ma.Result.ActualSortRange),this.jpf=this.ha().Jia,this.thf||(this.selectedRange=this.ra.$c,this.selectedRange.equals(this.QTa)||(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&
(this.activeCell=w.o(this.ra.activeCell,this.$)),this.ZJj())),(null===(Ga=this.sortOptions)||void 0===Ga?0:Ga.ActiveCell)&&this.a8f(this.sortOptions)&&(Ja=this.sortOptions.ActiveCell,Ja=new l.Range(Ja.FirstRow+1,Ja.FirstColumn+1,Ja.FirstRow+1,Ja.FirstColumn+1,!0,!1),this.GS(Ja),this.H_d(Ja)),this.q1(Ma))}}Uaf(pa){return I.b(pa,-569193796)}I$e(pa){Ha.a(this.$).fd.xM(-569193796);new ia(this.$,pa)}PId(pa,Ma){(new T(Ja=>{const Ga={};Ga.ActiveCell=pa.ActiveCell;Ga.SelectedRange=pa.SelectedRange;Ga.ExpandSelection=
Ja;this.$.Xc(Ma,v.a.Db,8,{[eb.cfb]:Ga})})).show()}ZJj(){const pa=this.ha();if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Ma=w.C(this.activeCell);this.QTa.Ke(Ma)||(Ma=this.QTa.topLeft);pa.updateSelection(this.QTa,Ma,0,void 0,void 0,void 0,!0)}else pa.updateSelection(this.QTa,pa.ra.activeCell,0,void 0,void 0,void 0,!0);this.cTf(!0)}gba(){const pa=this.ha();if(!pa)return d.ULS.shipAssertTag(537151573,0,!!pa,"SelectionManger is null"),null;
this.gridView.Gf.tH(!1);return w.v(pa.ra.$c,this.$)}vMb(){this.kc&&this.kc.fp&&(this.Ae=this.kc.fp,this.vb=this.kc.vcc())}E0h(pa){if(this.$.isEditMode&&(this.kc=this.gridView.Bb.zp(this.ra.activeCell))){this.activeCell=w.o(this.ra.activeCell,this.$);if(this.kc&&this.kc.fp){var Ma=this.kc.fp.CurrentCol;if(this.kc.fp.CurrentRow===this.activeCell.FirstRow&&Ma===this.activeCell.FirstColumn){this.vMb();this.applyPivotSort(pa);return}}this.$.pa.ya.Wb();Ma=new A.a(228,0,(Ja,Ga,La)=>y.l(this.$.pa.ya,this.activeCell,
G.b(Ja,this.NTi),G.a(Ga,this.MTi),La,pa),16);this.$.userOperationManager.Kc(Ma,null)}}applyPivotSort(pa){if(this.kc&&this.vb&&this.activeCell&&this.Ae){var Ma=8===this.Ae.CellArea,Ja=1===this.Ae.CellArea||2===this.Ae.CellArea;(Ma||Ja)&&8!==this.Ae.CellType&&4!==this.Ae.CellType&&(Ma?B.a(this.$.userOperationManager,(Ga,La,nb)=>y.b(this.$.pa.ya,this.activeCell,pa?1:2,this.vb.Caption,Ga,La,nb,null),Ga=>new A.a(1015,0,Ga,void 0,null),null):(Ma=1===this.Ae.CellArea?1:2,this.$.ma(682)?m.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.kc.isOlap?"":this.vb.Caption,Ma,pa):m.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),pa)))}}MUj(pa){this.a8f(pa.SortOptions)&&(pa.TopCellAddress?pa=w.C(pa.TopCellAddress):(pa=pa.OriginalActiveCell,pa=new l.Range(pa.FirstRow+1,pa.FirstColumn+1,pa.FirstRow+1,pa.FirstColumn+1,!0,!1)),this.GS(pa))}GS(pa){Cb.a.Ala(this.$)&&
f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Ma=>{Ma.result.Uea(pa);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}H_d(pa){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,476,475,0),Ma=>{Ma.result.H_d(pa,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)}p$i(pa,Ma){if(!this.PBb(this.ra.selectedRanges))return f.TaskExtensions.Rj();const Ja=new h.a;this.Hef(Ja,Ma);Ja.SortConditions=[this.Vfh(pa)];Ja.OperationType=2;return this.$od(Ja,pa)}Vfh(pa){const Ma=this.gridView.Sb(this.ra.activeCell);let Ja=new Mb.a;Ja.IsAscending=!0;switch(pa.command){case -1032691499:Ma.nyb?(pa=dc.a.xp(Ma.backgroundColor),Ja.SortColor=pa.DS(!0)):Ja.SortColor=eb.NoColor;Ja.SortConditionType=1;break;case -764711886:Ja.SortColor=Ma.w3c===eb.NoColor?eb.NoColor:dc.a.Rxe(Ma.w3c);
Ja.SortConditionType=2;break;case -2016161444:Ma.tyb?(Ja.SortIcon=Ma.cell.Okc,Ja.SortIconSet=Ma.Pkc):(Ja.SortIcon=eb.D4d,Ja.SortIconSet=eb.D4d);Ja.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Ja}VSj(pa){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Ma=>{void Ma.result.OCc(pa,"Filter")},this.$.la,3)}Hef(pa,Ma,Ja=!0){pa.OperationType=
0;pa.IsAscending=Ja;pa.HasHeader=!0;pa.GuessHeader=!0;pa.SortTopToBottom=!0;pa.ExpandSortSelectionSupported=!0;Ma&&Ma[eb.cfb]?(Ma=Ma[eb.cfb],pa.ActiveCell=Ma.ActiveCell,pa.SelectedRange=Ma.SelectedRange,pa.ExpandSortSelection=Ma.ExpandSelection):(pa.ActiveCell=w.o(this.ra.activeCell,this.$),pa.SelectedRange=w.v(this.ra.$c,this.$),pa.ExpandSortSelection=null)}a8f(pa){return!pa.SortConditions||pa.SortConditions.some(Ma=>0===Ma.SortConditionType)}}eb.Nih="CustomSortCommandData";eb.cfb="SortCommandData";
eb.D4d=-1;eb.NoColor=0;Object(u.a)(eb,"SortCommandHandler",null,[165]);class za extends b.a{constructor(pa){super(pa)}nd(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Ya),pa=>{this.Yc([new eb(this.$,pa.result)])},this.$.la,3)}static ka(pa){b.a.Nd(160,new za(pa))}}Object(u.a)(za,"SortCommandHandlerFactory",b.a,[]);H=a(222);class ha{constructor(pa){pa.da.Ga(446,this)}chh(pa,Ma){new ia(pa,Ma)}}Object(u.a)(ha,"SortUtil",null,[251]);class fb extends H.a{constructor(pa){super();
this.$=pa;this.Fb()}create(){let pa=this.$.da.za(446);pa||(pa=new ha(this.$),this.$.da.Ga(446,pa));this.ob(pa)}static ka(pa){pa.da.Ga(447,new fb(pa))}}Object(u.a)(fb,"SortUtilFactory",H.a,[]);a.d(D,"a",function(){return rb});const rb=()=>{c.a.Fa(pa=>{za.ka(pa);fb.ka(pa)})}},1157:function(u,D,a){u=a(0);var c=a(552),b=a(15),e=a(134),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(sa,sb){this.hNe(sa,sb,f.a.Xrj)}hNe(sa,sb,
hb){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",hb);this.jA(hb,sa,sb,null)}W8c(sa,sb){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.jA(f.a.Zrj,sa,sb,null,!0)}}Object(u.a)(d,"ErrorDialog",e.StandardDialog,[619]);var h=a(84);e=a(1050);var m=a(146);class l{static get ng(){return m.a.iq(l.pl,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}l.pl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(u.a)(l,"FileNameDialogHtml",null,[]);var v=a(4),t=a(14),z=a(45),r=a(85),n=a(86),w=a(30);class B extends e.a{constructor(sa,sb,hb,bb,lb,Fa,Na,Mb){super(sa,sb,hb,bb,lb,Fa,Mb);this.Qqa=this.ESc=this.iz=null;this.m_g=CommonUIStrings.l_SaveToAnotherFolder;this.ng=l.ng;this.Ee="FileNameDialog-SaveToSharePoint";this.xmb=Na;this.oBg=Mb}wQ(sa){const sb=w.a.Sq(v.AFrameworkApplication.um.un),hb=v.AFrameworkApplication.breadcrumbFolderName,bb=v.AFrameworkApplication.breadcrumbBrandName,lb={["txtFileName"]:sa||
sb};let Fa=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.sa.Pa.Fj&&(Fa=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Fa,Object(h.a)(this,this.nac,"fileNameDialogHandler"),lb);this.QMe(sa,sb);this.vJa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.iz=document.getElementById("anotherFolder"),sa=document.getElementById("folderLocation"),this.ESc=
n.a.Que(sa,this.iz,"anotherFolderDescribedBy"),this.iz.className="WACButton WACDialogButtonNormal",sa=!1,hb&&hb.length?(this.kpe(this.iz,this.ESc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,bb,hb)),sa=this.iIg(bb,hb)):this.kpe(this.iz,this.ESc,CommonUIStrings.l_CurrentOnlineFolder),this.iJg(this.iz),this.lIg(this.iz),sa?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationOne"),z.a.addHandler(this.iz,t.a.click,Object(h.a)(this,this.BEd,"onSaveToAnotherLocationClick")),z.a.addHandler(this.iz,t.a.Ob,Object(h.a)(this,this.kHf,"onSaveToAnotherLocationKeyDown")))}iIg(sa,sb){let hb;hb=!1;const bb=document.getElementById("currentLocation");bb.innerText="";const lb=this.N4e(bb,sa),Fa=this.N4e(bb,sb);let Na=255,Mb=255;255<lb+Fa&&(Na=Math.max(238,408-lb),Mb=
Math.max(170,408-Fa),hb=!0);this.IKg(bb,sa,Mb,sb,Na);return hb}N4e(sa,sb){const hb=document.createElement("div");hb.innerText=sb;hb.style.visibility="hidden";sa.appendChild(hb);sb=hb.clientWidth;sa.removeChild(hb);return sb}IKg(sa,sb,hb,bb,lb){sb&&(this.ipe(sa,sb,hb),this.zKg(sa));bb&&this.ipe(sa,bb,lb)}ipe(sa,sb,hb){const bb=document.createElement("div");bb.innerText=sb;bb.title=sb;bb.className="SaveToAnotherFolderBreadcrumb";bb.style.maxWidth=hb.toString()+"px";sa.appendChild(bb)}zKg(sa){const sb=
document.createElement("span");sb.id="FolderSeparator";const hb=document.createElementNS("http://www.w3.org/2000/svg","svg");hb.setAttribute("class","SeparatorCaret");const bb=document.createElementNS("http://www.w3.org/2000/svg","polygon");bb.setAttribute("points","1 4 1 11 5 7.5");hb.appendChild(bb);sb.appendChild(hb);sa.appendChild(sb)}kpe(sa,sb,hb){hb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,hb);sb&&(sb.innerText=hb);sa.tabIndex=0;sa.setAttribute(n.a.Ld,n.a.ot)}lIg(sa){const sb=
document.createElement("span");sb.id="anotherFolderText";sb.innerText=this.m_g;sb.className="AnotherFolderTextSpan";sa.appendChild(sb)}iJg(sa){const sb=document.createElement("span");sb.className="cui-img-cont-float cui-img-16by16 ";this.Qqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Qqa.setAttribute("class","FolderIconSVG");const hb=document.createElementNS("http://www.w3.org/2000/svg","path");hb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Qqa.appendChild(hb);sb.appendChild(this.Qqa);sa.appendChild(sb)}kHf(sa){!sa||sa.keyCode!==r.a.Sh&&sa.keyCode!==r.a.B1||this.BEd(sa)}BEd(){if(this.vJ){const sa=w.a.I4(v.AFrameworkApplication.fileName);let sb=this.vJ.value;this.hide();sb&&""!==sb&&""!==sa||1===this.sa.state?(""!==sa&&(sb+=sa),this.oac(sb)?this.dt.create().displayError(1,sb,!1):this.xmb.start(sb,this.oBg)):this.dt.create().displayError(2,sb,!1)}}V2g(sa){this.iz&&this.Qqa&&(sa?(this.iz.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.iz,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Qqa,"DisabledFolderIconSVG")):(this.iz.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.iz,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Qqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.iz,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Qqa,"DisabledFolderIconSVG"))))}Jkd(){super.Jkd();this.V2g(!!this.vJ&&""!==this.vJ.value)}dispose(){this.iz&&(z.a.removeHandler(this.iz,t.a.click,Object(h.a)(this,
this.BEd,"onSaveToAnotherLocationClick")),z.a.removeHandler(this.iz,t.a.Ob,Object(h.a)(this,this.kHf,"onSaveToAnotherLocationKeyDown")),this.iz=null);super.dispose()}}Object(u.a)(B,"FileNameDialog",e.a,[637]);var A=a(682),y=a(553),x=a(187),F=a(811),I=a(904),L=a(97),X=a(135);class P{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(u.a)(P,"SaveAsDialogInput",null,[]);class G{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(u.a)(G,"SaveLocation",null,[]);var C=a(373),H=a(189);class J{constructor(sa,sb,hb,bb,lb,Fa,Na,Mb,dc){this.OOc=null;this.JA="";this.xmb=sa;this.dt=sb;this.Kh=dc;this.Xga=hb;this.ef=lb;this.aw=bb;this.hGa=Na;this.KYa=Mb;Fa&&(this.OOc=new c.a(()=>new F.a(Fa.value,null)))}gTh(){const sa=new A.a(y.a.cl());sa.ia("type","currentHost");return Object.assign(new G,{folderName:this.aw.breadcrumbFolderName,friendlyPath:this.aw.breadcrumbBrandName,properties:sa})}vui(sa){return!!sa&&"ClassicMru"===
sa.type&&!!sa.service_info&&!!sa.service_info.service_id&&-1!==sa.service_info.service_id.indexOf("SHAREPOINT")}V3h(){if(!this.OOc||!this.hGa)return null;var sa=this.OOc.value.$Z("SaveAsToSharePointDialog",!1);if(!sa||3!==sa.state||!sa.fwf)return null;sa=sa.fwf;const sb=new x.a;let hb=0,bb=0;for(var lb=0;lb<sa.length;lb++){var Fa=sa[lb];if(!this.vui(Fa))continue;hb++;if(!Fa.sharepoint_info)continue;const Na=Fa.url,Mb=Fa.sharepoint_info.site_url,dc=Fa.title;Fa=I.b(Fa,v.AFrameworkApplication.isRtl);
if(!(Na&&Mb&&dc&&Fa))continue;bb++;const Cb=new A.a(y.a.cl());Cb.ia("type","SharePoint");Cb.ia("siteUrl",Mb);Cb.ia("folderUrl",Na);bb++;sb.add(Object.assign(new G,{folderName:dc,friendlyPath:Fa,properties:Cb}))}lb=new Map;lb.set("NumPlaces",sa.length.toString());lb.set("NumSharepointPlaces",hb.toString());lb.set("placesWithMetadata",bb.toString());L.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",lb);0<hb&&(bb?.5>1*bb/hb&&L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):L.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return sb}aUh(){const sa=new x.a;sa.add(this.gTh());const sb=this.V3h();sb&&sa.addRange(sb);return Object.assign(new P,{enableMoreLocations:!v.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.JA,extension:w.a.I4(this.aw.un),saveLocations:sa.toArray(),scenario:"SaveToSharePoint"})}ycc(){const sa=Object(h.a)(this,this.aUh,
"getDialogInput"),sb={};sb.inputPropsCallback=sa;return sb}wQ(sa){this.JA=sa;this.JA||(this.JA=String.format(CommonUIStrings.l_SaveACopy_Filename,w.a.Sq(this.aw.un)));sa={["id"]:"SaveAsDialog",["bodyControls"]:this.ycc()};let sb=CommonUIStrings.L_SaveAs;2===this.ef.Pa.Fj&&(sb=CommonUIStrings.L_SaveACopy);const hb=new m.a(!1,!1,!0);hb.Rb=1;hb.Ee="SaveAsDialog";hb.oc(1,CommonUIStrings.l_SaveButtonLabel);hb.initializeAndShow(sb,Object(h.a)(this,this.Trj,"saveAsDialogHandler"),sa)}aJj(sa,sb){sa&&""!==
sa&&""!==sb||1===this.ef.state?this.uui()?this.UAi(sa,sb):(""!==sb&&(sa+=sb),this.xmb.start(sa,this.Kh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.dt.create().displayError(2,sa,!1))}UAi(sa,sb){L.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const hb=this.KYa.tIe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.KYa.Agd(hb).then(bb=>{if(bb&&0<bb.length){const lb=
bb[0][C.a.o5i];bb=bb[0][C.a.fMf];if(""!==lb&&""!==bb)this.hGa.Hoa(bb,sa+sb,lb,this.Kh),L.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.dt.create().displayError(0,sa,!1);const Fa=X.a.hs();Fa&&(Fa.set("SiteUrlAvailable",""===lb?"false":"true"),Fa.set("FolderUrlAvailable",""===bb?"false":"true"));L.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new H.a,{extendedProperties:Fa}))}}else this.dt.create().displayError(0,sa,
!1),L.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(bb=>{"Canceled"===bb?((bb=X.a.hs())&&bb.set("IsCanceled","true"),L.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new H.a,{extendedProperties:bb}))):L.Health.instance.recordKpiFailure("SaveACopySFP",bb,!1,!1,null)})}uui(){return this.KYa?this.KYa.ftd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Trj(sa,sb){if(sb&&1===sa){sa=sb.fileName;var hb=w.a.I4(this.aw.un);
sb.moreLocationsSelected&&this.aJj(sa,hb);if(sb.locationCallback){var bb=sb.locationCallback();bb?bb.properties&&"currentHost"===bb.properties.oa("type")?this.Xga.Hoa(sa+hb,!1,this.Kh):bb.properties&&"SharePoint"===bb.properties.oa("type")?(sb=bb.properties.oa("siteUrl"),bb=bb.properties.oa("folderUrl"),this.hGa.Hoa(bb,sa+hb,sb,this.Kh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(u.a)(J,"ReactSaveAsDialog",null,[637]);class M{constructor(sa,sb,hb,bb,lb,Fa,Na,Mb=null,dc=null,Cb=null){this.La=sb;this.mb=sa;this.PX=bb;this.Xga=Fa;this.dt=lb;this.ef=hb;this.Rje=Na;this.Uzg=Mb;this.hGa=dc;this.KYa=Cb}create(sa){return this.ef&&this.ef.Pa.Jv?new J(this.Rje,this.dt,this.Xga,v.AFrameworkApplication.um,this.ef,this.Uzg,this.hGa,this.KYa,sa):new B(this.mb,this.La,this.ef,this.PX,this.dt,this.Xga,this.Rje,sa)}}Object(u.a)(M,"FileNameDialogFactory",
null,[620]);class S{constructor(sa,sb,hb,bb){this.Yo=this.vlb=null;this.ujb=sa;this.ef=hb;this.KBg=bb;this.yEa=new c.a(()=>new F.a(sb.value,Object(h.a)(this,this.jxb,"getMoreInfoEventReceived")))}get UJf(){this.vlb||(this.yEa.value.$Z("Save As",!0),this.Yo&&this.Yo.MR&&this.Yo.MR.length&&(this.vlb=this.Q_h(this.Yo.MR)));return this.vlb}start(sa){if(!this.UJf)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.vlb=v.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Yo),!1;const sb=this.KBg();sb.tJj();const hb=sb.y0h();if(!hb)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ujb.start((bb,lb)=>{sb.hide();sa(bb,lb)},()=>{this.K6(sb)},hb,this.vlb);return!0}K6(sa){sa.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}Q_h(sa){sa=
sa.toLowerCase();sa.endsWith("/")||(sa+="/");const sb=sa.indexOf("/documents/");return-1!==sb?sa.substring(0,sb+1)+"_layouts/15/onedrive.aspx":""}jxb(sa){this.Yo||3!==sa.state||(this.Yo=sa)}}Object(u.a)(S,"OneDriveFilePickerHelper",null,[617]);class W extends m.a{constructor(){super()}tJj(){this.tJc="FilePickerDialog";this.ng="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ee="PickerDialog-MsoSp";this.showDialog("",null)}y0h(){return document.getElementById("FilePickerDiv")}YI(){}rAa(){}}
Object(u.a)(W,"PickerDialog",m.a,[615]);var O=a(641),T=a(834),Y=a(374),va=a(27),ca=a(105),V=a(25);class ra{constructor(sa,sb,hb,bb,lb,Fa,Na){this.mb=sa;this.GKc=hb;this.La=sb;this.xmb=bb;this.ujb=lb;this.wQc=Fa;this.iug=Na}Fg(){const sa=this.ujb.n5a();sa?va.a.sla||this.mb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Me(V.a.saveToSharePoint,ca.a.frame,Object(h.a)(this,this.g0f,"saveToSharePointActionDispatcher"),64):(sa.v9a.continueWith(sb=>{sb.Wf&&this.ujb.ODd(sb)}),this.i3b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}i3b(){Y.a.VKd(Object(h.a)(this,this.g0f,"saveToSharePointActionDispatcher"));Y.a.y$c([new T.a(V.a.saveToSharePoint,ca.a.frame,0)],this.ujb.n5a())}get C8a(){return this.mb.qa("SaveToAnotherFolderBrsIsEnabled")}get MAe(){return this.mb.qa("UserCanWriteRelative")}g0f(sa,sb,hb,bb,lb){return sb.contextId!==ca.a.frame||sa!==V.a.saveToSharePoint?2:this.C8a&&(this.wQc.UJf||this.MAe)?1===hb?O.SessionStatusManager.instance.c6a||v.AFrameworkApplication.y5?
8:this.iug()?32:8:2===hb?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(lb&&lb.SaveEntryPoint&&"VersionHistory"===lb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.MAe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.GKc.create(lb).wQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.xmb.start(null,lb)),32):8:8}}Object(u.a)(ra,"SaveToSharePointActor",
null,[]);class N{constructor(sa,sb,hb,bb){this.Kh=this.Ufe=null;this.hGa=sa;this.dt=sb;this.wQc=hb;this.ef=bb}start(sa,sb){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Ufe=sa;this.Kh=sb;this.wQc.start((hb,bb)=>{this.K9i(hb,bb)})||this.CVd()}K9i(sa,sb){if(sa)this.onSuccess(sb);else this.P6(sb)}CVd(){1!==this.ef.state&&this.dt().W8c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(sa){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(sa&&sa.data&&sa.data.value&&sa.data.value.length&&sa.data.value[0].sharePoint){const sb=sa.data.value[0].sharePoint.url;sa=sa.data.value[0].sharePoint.listUrl;let hb=null;if(sb&&(hb=sa?this.n4h(sa):this.m4h(sb))){this.hGa.Hoa(sb,this.Ufe,hb,this.Kh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!sb,!hb)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.CVd()}m4h(sa){sa.endsWith("/")||
(sa+="/");let sb=0;for(let hb=0;hb<sa.length;hb++)if("/"===sa.charAt(hb)&&5===++sb)return sa.substr(0,hb);return null}n4h(sa){sa.endsWith("/")&&(sa=sa.substring(0,sa.length-1));const sb=sa.lastIndexOf("/");return-1!==sb?sa.substring(0,sb):null}P6(sa){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");sa&&sa.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",sa.error.errorCode,sa.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.CVd()}}Object(u.a)(N,"SaveToSharePointManager",null,[614]);var ea=a(80);class Ba{constructor(sa,sb,hb,bb,lb,Fa,Na,Mb){this.oGa=sa;this.JA=sb;this.RWa=bb;this.xRc=Fa;this.j9=hb;this.oEg=lb;this.Xfa=Na;this.Kh=Mb}execute(sa,sb){if(!v.AFrameworkApplication.Lg&&v.AFrameworkApplication.Bd){var hb=this.oGa+this.Xfa;hb=ea.a.Ol(hb,"fu",w.a.mf(this.j9));hb=ea.a.Ol(hb,"su",w.a.mf(this.oEg));hb=ea.a.Ol(hb,"fn",w.a.mf(this.JA));hb=ea.a.Ol(hb,"n",w.a.mf((new Date).getTime().toString()));
this.Kh&&this.Kh.FileDownloadUrl&&(hb=ea.a.Ol(hb,"furl",w.a.mf(this.Kh.FileDownloadUrl)));hb=hb+"&"+this.xRc;this.RWa&&this.RWa.length?hb=ea.a.Ol(hb,"fnn",w.a.mf(this.RWa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Bd.Rm(hb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,sa,sb,null,void 0,void 0,void 0,void 0,"9")}}}Object(u.a)(Ba,"SharePointSaveAsCaller",
null,[558]);class ka{constructor(sa){this.pGa=sa.appSettings.SaveAsToHostWebServiceBase;this.JA=sa.appSettings.FileName;this.Xfa=sa.Xa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(sa,sb,hb,bb){return new Ba(this.pGa,this.JA,sa,sb,hb,v.AFrameworkApplication.Zi,this.Xfa,bb)}}Object(u.a)(ka,"SharePointUploadCallerFactory",null,[538]);var Ka=a(41),Oa=a(40),wa=a(240),qa=a(685),aa=a(164),ia=a(642),Ha=a(766);class Z{constructor(sa,sb,hb,bb,lb){this.Pm=this.HDa=null;this.YGc=!1;this.ASc=
this.j9=null;this.RUc=sb;this.Wlb=hb;this.dt=bb;this.ef=lb;this.La=sa}Hoa(sa,sb,hb,bb){this.YGc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.XNb();this.j9=sa;bb&&bb.SaveEntryPoint&&(this.ASc=bb.SaveEntryPoint);this.HDa=this.RUc.create(sa,sb,hb,bb);bb&&"true"===bb.SkipSaveToHost?this.CQ():this.oKh()}oKh(){const sa=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.CQ()};32!==this.La.ae(V.a.lSa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.CQ()},sa])&&sa()}CQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.HDa.execute(Object(h.a)(this,this.eZi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.dZi,"onSaveToSharePointUploadFailed"))}eZi(sa){if(sa&&sa.data&&sa.data.te){var sb;if(({At:sb}=Ka.d(sa.data.te)).returnValue)if(sb.StatusCode!==wa.a.mP&&sb.StatusCode!==
wa.a.Ssb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",sa.data.status,sb.StatusCode),sb.StatusCode!==wa.a.UXf&&this.GNe(sa.data.status)||(this.Uda(sb.StatusCode.toString()),this.fIj(sb.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.ENd();try{sb.NewDocumentUrl?this.eRa(sb.NewDocumentUrl):this.fRa()}catch(hb){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
hb.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ha.a.igb(sa.data.te)}),this.Q8b()||(this.Uda("Failed to deserialize response"),this.VNb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Q8b()||(this.Uda("Unknown"),this.VNb())}dZi(sa){sa&&sa.data?this.GNe(sa.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Uda(qa.a[sa.data.status]),this.VNb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.Q8b()||(this.Uda("Unknown"),this.VNb()))}Q8b(){if(!this.YGc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.YGc=!0,this.CQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}GNe(sa){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",sa);return this.Q8b()}fRa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Oa.a.lf(this.j9,Oa.a.FX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}eRa(sa){let sb=
!1,hb=!1;v.AFrameworkApplication.fa&&(sb=v.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),hb=v.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",sa,sb);if(sb&&hb){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const bb={};bb[C.a.$Qa]="1";bb[C.a.documentUrl]=sa;bb[C.a.reason]=ia.a.saveAs;v.AFrameworkApplication.nV().execute(lb=>
{lb.Oj(aa.a.Eua,bb)})}else Oa.a.lf(sa,Oa.a.FX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}XNb(){this.ef&&1===this.ef.state||(this.Pm=this.Wlb(),this.Pm.message=CommonUIStrings.l_CommentProgressTooltip,this.Pm.Rb=5,this.Pm.Jt=!1,this.Pm.LBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}CJa(){this.Pm&&(this.Pm.close(),this.Pm=null)}VNb(){this.vj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}eJj(){this.vj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}nIj(){const sa=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vj(CommonUIStrings.l_SaveAsFileTooLargeTitle,sa,f.a.Urj)}vj(sa,sb,hb=f.a.Yrj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",sa,sb);this.CJa();1!==this.ef.state&&this.dt().hNe(sa,sb,hb)}fIj(sa){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",sa);switch(sa){case wa.a.ygg:this.eJj();break;case wa.a.UXf:this.nIj();break;default:this.VNb()}}ENd(){"VersionHistory"===this.ASc&&
this.La.processAction(V.a.Kvc,2)}Uda(sa){"VersionHistory"===this.ASc&&this.La.ae(V.a.GNd,2,{["FailureReason"]:sa})}}Object(u.a)(Z,"UploadToSharePointManager",null,[537]);var la=a(248),Xa=a(783),Za=a(518),xa=a(55);class fa{constructor(){this.Vra=this.PPc=this.KPc=this.gb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Vh(sa){this.gb=sa;this.KPc=Za.a.mr(sa.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.PPc=Za.a.mr(sa.Ub("Common.IEventEmitter<Common.IMruResult>"));
this.Vra=Za.a.mr(sa.Ub("Common.App.SharedFilePicker.ISharedFilePicker"));xa.Task.WAA.call(null,this.KPc,this.PPc,this.Vra).continueWith(()=>{this.Mej()})}Mej(){this.gb.register(ka,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(()=>new ka(v.AFrameworkApplication.fa)).xc();this.gb.register(Z,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(()=>new Z(v.AFrameworkApplication.ub,
this.gb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Xa.a).create(),()=>new d,v.AFrameworkApplication.sa)).xc();this.gb.register(N,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(()=>new N(this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.sa)).xc();this.gb.register(S,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(()=>
new S(this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.KPc.result),v.AFrameworkApplication.sa,()=>new W)).xc();this.gb.register(M,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(()=>new M(v.AFrameworkApplication.fa,v.AFrameworkApplication.ub,v.AFrameworkApplication.sa,v.AFrameworkApplication.sa.Pa,this.gb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.gb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.PPc.result),this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Vra?this.Vra.result:null)).xc();this.gb.register(ra,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(()=>new ra(v.AFrameworkApplication.fa,v.AFrameworkApplication.ub,this.gb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.sa.p1g)).xc();v.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.gb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Fg()}static main(){la.a.instance.Ei(new fa)}}Object(u.a)(fa,"PackageManager",null,[4,5]);a.d(D,"a",function(){return ua});const ua=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");fa.main()}},1166:function(u,D,a){var c=a(9);u=a(0);var b=a(692),
e=a(50),f=a(37),d=a(1),h=a(183);class m{constructor(fa,ua){this.$=fa;this.presentModeManager=ua}nc(){return!1}wc(fa,ua){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ua.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Lz;default:return!1}}executeCommand(fa,ua){fa=f.TaskExtensions.Rj();ua=ua.command;switch(ua){case 642419866:this.presentModeManager.aAc(!this.presentModeManager.Lz);this.presentModeManager.Zg("TogglePresentMode");
break;case 588342182:this.presentModeManager.q8a=!this.presentModeManager.q8a;this.presentModeManager.h9f(this.presentModeManager.q8a,"TogglePresentModeOverlay");this.presentModeManager.Zg("TogglePresentModeOverlay");break;default:fa=h.a(ua)}return fa}Jc(){return!1}}Object(u.a)(m,"PresentModeCommandHandler",null,[165]);class l extends b.a{constructor(fa){super(fa)}nd(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,423,424,this.Ya),fa=>{this.Yc([new m(this.$,fa.result)])},this.la,3)}static ka(fa){b.a.Nd(420,
new l(fa))}}Object(u.a)(l,"PresentModeCommandHandlerFactory",b.a,[]);var v=a(222),t=a(15),z=a(128),r=a(4),n=a(111),w=a(82);class B{}B.Ayh="ewa-presentMode-overlay";B.Byh="ewa-presentMode-panel-container";B.Cyh="ewa-presentMode-rowHdrParent-container";Object(u.a)(B,"CssClassNames",null,[]);var A=a(19),y=a(5),x=a(149),F=a(292),I=a(132),L=a(371),X=a(188);a(59);var P=a(113),G=a(435),C=a(12),H=a(11),J=a(99),M=a(347),S=a(21),W=a(133),O=a(421),T=a(107),Y=a(14),va=a(259),ca=a(247),V=a(171),ra=a(46);class N{constructor(fa){this.Jwe=
this.DQa=this.FHd=this.GHd=this.tda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.psc={};this.osc={};this.zQa=null;this.AMf=0;this.onKeyDown=ua=>{ua=ua.Ca;if(9===ua.keyCode){var sa=this.tda.querySelectorAll(C.DOMElementExtensions.Ir);const sb=C.DOMElementExtensions.wm(sa);sa=C.DOMElementExtensions.tB(sa);C.DOMElementExtensions.rBa(ua,sb,sa);return!0}return!1};this.cm=()=>{this.$.da.$a(337,ua=>{this.DQa.getPresentModeFloatieControlsMap().then(sa=>{const sb={};for(let hb=0;hb<sa.length;hb++)sb[sa[hb].controlId]=
sa[hb].modelType;sa=ua.u7.H5a(sb);0<sa.length&&appChrome.api.dispatch(sa);this.rsj()})})};this.$=fa}dispose(){this.$=this.FHd=this.GHd=this.tda=this.DQa=null}xhi(){window.requestAnimationFrame(()=>{this.tda=document.createElement("div");this.$.ru.insertBefore(this.tda,this.$.ru.lastChild);this.tda.id=this.$.Eb+y.a.Tac;this.tda.classList.add(B.Byh);this.GHd=document.getElementById(this.$.Eb+y.a.N7c);this.FHd=[this.$.dF];this.isInitialized=!0});this.DQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.DQa.initializePresentModeFloatie()}t5h(){const fa={};fa.PollingCountPerCaller=n.a.toJSON(this.osc);fa.PollingDurationPerCaller=n.a.toJSON(this.psc);return fa}BVd(fa){this.isInitialized?fa?(this.DQa.showPresentModeFloatie(this.tda,this.GHd,this.FHd),this.Zg("ShowOrHideFloatiePanel"),this.Nfj()):(this.DQa.hidePresentModeFloatie(),this.NXj()):t.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Zg(fa){this.AMf=H.HelperMethods.Tb();
this.zQa=fa;this.Jwe=V.AsyncMethodContext.Gr(this.cm,100,ra.a.w8i+fa,this.Jwe)}get mc(){return this.tda}get Ff(){this.DQa.updatePresentModeFloatieShyState(2);return!!this.tda}get de(){return ca.a.PNf}gg(fa,ua){if(ua)return!1;fa=C.DOMElementExtensions.wm(this.tda.querySelectorAll(C.DOMElementExtensions.Ir));if(!fa)return t.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;fa.focus();return!0}lh(fa){return C.DOMElementExtensions.xf(this.mc,
fa)}sj(){}Wj(){}Nfj(){va.a(this.$).ai(this);this.$.da.$a(15,fa=>{this.ewaAccessibilityManager=fa;this.ewaAccessibilityManager.mode=5});T.KeyInputManager.instance.ta(Y.a.Ob,this.mc,this.onKeyDown)}NXj(){va.a(this.$).aA(this);S.h(this.$).jX();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);T.KeyInputManager.instance.Ba(Y.a.Ob,this.mc,this.onKeyDown)}rsj(){const fa=H.HelperMethods.Tb()-this.AMf,ua=this.psc[this.zQa]?this.psc[this.zQa]:0;this.psc[this.zQa]=ua>fa?ua:fa;this.osc[this.zQa]=
this.osc[this.zQa]?this.osc[this.zQa]+1:1}}Object(u.a)(N,"PresentModeFloatieManager",null,[567,39,2]);var ea=a(7),Ba=a(61);class ka{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(u.a)(ka,"OverlayCavityInfo",null,[]);class Ka{constructor(){this.height=this.width=0}}Object(u.a)(Ka,"OverlayContainerInfo",null,[]);class Oa{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(u.a)(Oa,"PresentModeOverlayProps",
null,[]);class wa{constructor(fa){this.y0a=this.HHd=null;this.$=fa;this.gridView=S.h(this.$)}hii(){this.HHd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.y0a=Array(5);let fa,ua;for(let sa=1;4>=sa;sa++)fa=document.createElement("div"),C.DOMElementExtensions.setVisible(fa,!1),fa.id=`${"PresentModeOverlay"}-${sa}`,C.DOMElementExtensions.toggleCssClass(fa,B.Ayh,!0),ua=this.gridView.Af(sa).domElement,ua.insertBefore(fa,ua.firstChild),
this.y0a[sa]=fa})}g9f(fa){fa&&this.m0j();for(let ua=1;4>=ua;ua++)this.Ikf(ua)&&C.DOMElementExtensions.setVisible(this.y0a[ua],fa);C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-overlay",fa)}m0j(){const fa=this.u0g();let ua;for(let sa=1;4>=sa;sa++)ua=sa,fa[ua]&&this.HHd.showOverlayWithCavity(this.y0a[ua],fa[ua])}dispose(){this.HHd=this.y0a=this.gridView=this.$=null}u0g(){let fa;const ua=S.h(this.$).rtl;let sa;const sb=Array(5);for(let bb=1;4>=bb;bb++)if(fa=bb,this.Ikf(bb)){var hb=
this.gridView.Af(bb);sa=this.gridView.ha.Ra.u_?this.fWh(bb,hb,ua):this.$Wh(bb,hb,ua);hb=this.mfh(hb);sb[fa]=this.Hfh(this.y0a[fa].id,hb,sa)}return sb}Ikf(fa){return this.gridView.ib.XQ(fa)}mfh(fa){return Object(ea.a)(new Ka,{width:fa.Cm.width,height:fa.Cm.height})}Hfh(fa,ua,sa){return Object(ea.a)(new Oa,{containerId:fa,overlayContainerInfo:ua,overlayCavityInfos:sa?[sa]:null})}fWh(fa,ua,sa){var sb=S.h(this.$).ha.Ra.$b;if(!sb)return t.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let hb,bb;if(({YCa:fa,rotation:sb,translateX:hb,translateY:bb}=sb.extension.iWh(fa)).returnValue){const lb=fa.x-ua.Cm.x;return Object(ea.a)(new ka,{left:(sa?ua.Cm.width-(lb+fa.width):lb)-3+1,top:fa.y-ua.Cm.y-3+1,width:fa.width+5,height:fa.height+5,angle:sb,translateX:hb,translateY:bb})}return null}$Wh(fa,ua,sa){fa=this.gridView.qb.twb(this.gridView.ha.ra.activeRange,fa)||Ba.a.n4;if(!fa.Ke(ua.Cm))return null;const sb=fa.x-ua.Cm.x;return Object(ea.a)(new ka,{left:sa?ua.Cm.width-(sb+fa.width)-2:
sb-3,top:fa.y-ua.Cm.y-3,width:fa.width+5,height:fa.height+5})}}Object(u.a)(wa,"PresentModeOverlayRenderer",null,[566,2]);var qa=a(60);const aa=(fa,ua,sa,sb,hb,bb,lb=null)=>{lb=fa.Na(41,lb);lb.shouldEnablePresentMode=ua;return qa.g(fa,"SetPresentMode",lb,sa,sb,hb,bb,0)};var ia=a(284);class Ha extends ia.a{constructor(fa,ua){super(fa);this.x8i=()=>{this.uda.BVd(!0)};this.uda=ua;this.domElement.classList.add("ewr-presentMode-on");fa={[Ha.vu]:this.pc};this.Rb=0;this.initializeAndShow("",this.x8i,fa)}get pc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
z.a.Rv(y.a.n9f,"false",this.$.va.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(u.a)(Ha,"PresentModeWelcomeDialog",ia.a,[]);class Z{static get BLh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get CLh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(fa){fa.webkitRequestFullscreen?fa.webkitRequestFullscreen():fa.msRequestFullscreen?fa.msRequestFullscreen():fa.mozRequestFullScreen?fa.mozRequestFullScreen():fa.requestFullscreen?fa.requestFullscreen():t.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():t.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Lpi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(u.a)(Z,"FullscreenUtils",null,[]);class la{constructor(fa){this.fpa=
this.NZe=this.lIb=this.x3a=this.Jsc=this.uda=this.FQa=null;this.$sd=this.pQb=this.TOd=!1;this.BNb=!0;this.cic=!1;this.FVd=!0;this.oQb=this.f2a=this.oGe=0;this.sxc={};this.rrc={};this.qrc={};this.ONf=0;this.q8a=this.Mce=!1;this.wij=()=>{C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-transition",!1);$removeHandler(this.x3a,"transitionend",this.fpa)};this.ij=()=>{parseInt(this.$.ru.style.right,10)!==this.oGe&&window.requestAnimationFrame(()=>{this.LDc(0);this.$.oAa(F.a.VZ("PresentModeManager.OnContentAreaResized"))})};
this.Y6=()=>{var ua=Object(w.a)(J.a,this.$.na);if(ua&&this.Lz){this.gridView.Cic=!1;ua=ua.headersVisible;var sa=S.h(this.$).rtl;C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on-headers-off",!ua);C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on-rtl",sa);(12!==this.f2a&&!ua||32!==this.f2a&&ua&&!sa||0!==this.f2a&&ua&&sa)&&window.requestAnimationFrame(()=>{this.LDc(2)})}};this.ed=()=>{this.fgf();this.Zg("OnWorkbookOpened");t.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Np=()=>{this.$sd=!0;this.afa("OnSelectionStarted")};this.Ag=()=>{this.$sd=!1;this.afa("OnSelectionEnded");this.b0f()};this.rh=()=>{this.afa("OnEditStarted")};this.Nf=()=>{this.afa("OnEditEnded")};this.Xw=()=>{if(!this.cic){const ua=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.afa("OnVisibleAreaChanged",!0,ua)}};this.KFb=()=>{this.cic=!0};this.Mn=()=>{this.afa("OnCurrentSelectionModeChanged");this.b0f();this.Zg("OnCurrentSelectionModeChanged")};this.an=
()=>{this.afa("OnBlockCacheItemEvicted")};this.sf=()=>{this.afa("OnBlockCacheItemChanged")};this.bG=()=>{this.cic||this.afa("OnActiveItemPanesChanged")};this.Eh=()=>{this.cic=!1;this.uda.Zg("ActiveSheetChanged");this.Y6()};this.KGb=(ua,sa)=>{if(ua=Object(w.a)(J.a,sa.item))ua.frb(16,!0),ua.QZa(this.Y6)};this.wSi=()=>{Z.Lpi||(this.Jsc&&this.Jsc.Jn&&this.Jsc.hide(),S.h(this.$).eb&&S.h(this.$).Uo(!0),this.aAc(!1),t.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.xSi=()=>{t.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=fa;this.gridView=S.h(this.$);this.btj=fa.va.PresentModeRenderUpdateTimeout;this.initialize(fa)}get Lz(){return this.Mce}aAc(fa){this.Lz!==fa&&(this.Mce=fa,this.q8a=this.Lz,this.fgf(),this.BNb=this.U7f(),window.requestAnimationFrame(()=>{C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-transition",!0);$addHandler(this.x3a,"transitionend",this.fpa);
this.kJj(!fa);this.f3i();C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on",fa);this.jJj(fa);x.b(this.$).e9f(this.Lz);x.c(this.$).e9f(this.Lz);this.$.PAa();this.FQa.g9f(this.BNb);if(this.Lz){this.I_a();z.a.get(y.a.n9f)?this.uda.BVd(this.Lz):this.Jsc=new Ha(this.$,this.uda);var ua=O.b(this.$);ua&&(this.TOd=ua.j$c(!1));this.ONf=H.HelperMethods.Tb()}else this.uda.BVd(fa),this.TOd&&(ua=O.b(this.$))&&(ua.j$c(!0),this.TOd=!1),this.$7b(),this.BDi()}))}h9f(fa,ua){this.FVd=fa;this.afa(ua)}Zg(fa){this.uda.Zg(fa)}dispose(){this.$7b();
this.FQa&&(this.FQa.dispose(),this.FQa=null);this.gridView=this.$=null}kJj(fa){const ua=this.$.da.za(25);void 0===ua||null===ua?t.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):fa?ua.Wzc():ua.Efc()}f3i(){C.DOMElementExtensions.toggleCssClass(document.getElementById(r.AFrameworkApplication.I3a),A.a.hq,this.Lz);C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on",this.Lz);this.mJj(this.Lz);this.gridView.Cic=!this.Lz;this.C0j();this.$.da.$a(32,
fa=>{fa.Y0j(this.Lz)});P.b(this.$,fa=>{fa.vig(this.Lz)})}mJj(fa){if(this.lIb)if(fa){if(fa=Object(w.a)(J.a,this.$.na))C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on-headers-off",!fa.headersVisible),C.DOMElementExtensions.toggleCssClass(this.$.yr,"ewr-presentMode-on-rtl",S.h(this.$).rtl);this.LDc(0)}else this.$.yr.classList.remove("ewr-presentMode-on-headers-off"),this.$.yr.classList.remove("ewr-presentMode-on-rtl"),this.LDc(1)}LDc(fa){var ua=Object(w.a)(J.a,this.$.na);if(ua){var sa=
parseInt(this.$.ru.style.right,10);if(1===fa||2===fa){if(isNaN(sa)||sa<this.f2a)return;sa-=this.f2a}if(0===fa||2===fa)fa=ua.headersVisible,ua=S.h(this.$).rtl,fa=fa?ua?0:32:12,sa=isNaN(sa)?fa:sa+fa,this.f2a=fa;this.$.ru.style.right=H.HelperMethods.uc(sa);this.oGe=sa}}C0j(){const fa=document.getElementById(this.$.Eb+y.a.B7b).parentNode;C.DOMElementExtensions.toggleCssClass(fa,B.Cyh,this.Lz)}initialize(fa){this.FQa=new wa(fa);this.FQa.hii();this.uda=new N(fa);this.uda.xhi();this.x3a=document.getElementById("MainApp");
this.NZe=this.wSi;$addHandler(this.x3a,Z.BLh,this.NZe);$addHandler(this.x3a,Z.CLh,this.xSi);this.lIb||(this.lIb=document.createElement("div"),this.lIb.className="ewa-presentMode-right-frame",this.$.dF.appendChild(this.lIb));this.fpa=this.wij}I_a(){this.gridView.ha.Y2(this.Np);this.gridView.ha.HY(this.Ag);this.gridView.fc.Xk(this.rh);this.gridView.fc.sm(this.Nf);this.gridView.IC(this.Mn);this.gridView.view.nt(this.Xw);this.gridView.hXc(this.KFb);this.gridView.Ea.jH(this.an);this.gridView.Ea.mt(this.sf);
this.$.xa.Uf(this.Eh);this.$.xa.zsa(this.bG);this.$.xa.oha(this.KGb);this.$.VA(this.ij);this.$.nl(this.ed);const fa=Object(w.a)(M.a,this.$.xa);for(const ua of fa.items)ua.QZa(this.Y6)}$7b(){this.gridView&&(this.gridView.ha.A7(this.Np),this.gridView.ha.MW(this.Ag),this.gridView.fc.Fk(this.rh),this.gridView.fc.Il(this.Nf),this.gridView.cE(this.Mn),this.gridView.view.ir(this.Xw),this.gridView.dMd(this.KFb),this.gridView.Ea.HI(this.an),this.gridView.Ea.gr(this.sf));if(this.$){this.$.xa.Bg(this.Eh);this.$.xa.FAa(this.bG);
this.$.xa.Ena(this.KGb);this.$.bE(this.ij);this.$.Kl(this.ed);const fa=Object(w.a)(M.a,this.$.xa);for(const ua of fa.items)ua.jvc(this.Y6)}}U7f(){if(!this.Lz||!this.q8a)return!1;if(1===this.gridView.ha.Ne){const fa=this.$.na.activeRange.isSingle,ua=1===this.$.na.selectedRanges.length&&!fa,sa=this.gridView.eb,sb=this.$sd;ua||t.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${fa}`);return this.FVd&&ua&&!sa&&
!sb}return this.FVd}jJj(fa){fa?Z.requestFullscreen(this.x3a):Z.exitFullscreen()}afa(fa,ua=!1,sa=!1){ua||(this.BNb=this.U7f());t.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${fa}, visibility: ${this.BNb}, immediateUpdate: ${sa}`);if(this.pQb&&sa)t.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.oQb}`),window.cancelAnimationFrame(this.oQb),this.oQb=0;else if(this.pQb){t.ULS.sendTraceTag(543023558,0,50,
`PresentModeManager.UpdateLayout: Skipping update layout for ${fa}`);return}sa?this.n1d(H.HelperMethods.Tb(),fa):(this.oQb=window.requestAnimationFrame(sb=>{this.n1d(sb,fa)}),this.pQb=!0)}n1d(fa,ua){var sa=H.HelperMethods.Tb();if(sa-fa>this.btj)this.oQb=window.requestAnimationFrame(hb=>{this.n1d(hb,ua)}),this.pQb=!1,t.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${sa-fa}ms.`);else{this.FQa.g9f(this.BNb);this.pQb=!1;var sb=
H.HelperMethods.Tb();fa=H.HelperMethods.Tb()-fa;sa=sb-sa;this.dsj(fa,ua);t.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${sa}ms. rafTotalDuration = ${fa}ms`)}}fgf(){L.a(this.$.userOperationManager,(fa,ua,sa)=>aa(this.$.pa.ya,this.Lz,fa,ua,sa,null),fa=>new X.a(252,0,fa),null)}b0f(){let fa=G.a(this.gridView.Ne);1!==this.gridView.Ne||this.$.na.activeRange.isSingle||(fa="Range");this.sxc[fa]=this.sxc[fa]?this.sxc[fa]+1:1}dsj(fa,ua){const sa=this.rrc[ua]?
this.rrc[ua]:0;this.rrc[ua]=sa>fa?sa:fa;this.qrc[ua]=this.qrc[ua]?this.qrc[ua]+1:1}BDi(){const fa={};var ua=H.HelperMethods.Tb()-this.ONf;fa.PresentModeDuration=ua;fa.SelectionCountPerObject=n.a.toJSON(this.sxc);fa.OverlayCountPerCaller=n.a.toJSON(this.qrc);fa.OverlayDurationPerCaller=n.a.toJSON(this.rrc);ua=this.uda.t5h();for(let sa in ua)fa[sa]=ua[sa];W.b(this.$).Gd(I.a.v8i,fa,void 0,!0)}}Object(u.a)(la,"PresentModeManager",null,[553,2]);var Xa=a(184);class Za extends v.a{constructor(fa){super();
this.$=fa;this.Fb()}create(){const fa=e.GetServiceTaskFactory.Oa(this.$.da,283,284,1);f.TaskExtensions.Aa(fa,()=>{f.TaskExtensions.Aa(Xa.c(fa.result.pn.loadScript("presentMode")),()=>{let ua=this.$.da.za(423);ua||(ua=new la(this.$),this.$.da.Ga(423,ua));this.ob(ua)},this.$.la,3)},this.$.la,3)}static ka(fa){fa.da.Ga(424,new Za(fa))}}Object(u.a)(Za,"PresentModeManagerFactory",v.a,[]);a.d(D,"a",function(){return xa});const xa=()=>{c.a.Fa(fa=>{Za.ka(fa);l.ka(fa)})}},1170:function(u,D,a){var c=a(9);u=
a(0);var b=a(552),e=a(692),f=a(50),d=a(37),h=a(15),m=a(1239),l=a(4),v=a(164),t=a(753),z=a(97),r=a(263),n=a(642),w=a(27),B=a(157),A=a(178),y=a(290),x=a(5),F=a(148),I=a(101),L=a(76),X=a(74),P=a(371),G=a(188),C=a(59),H=a(60),J=a(326),M=a(587),S=a(1336),W=a(418),O=a(319),T=a(13);class Y extends S.a{constructor(Ra,ya){super(Ra,void 0,void 0,ya)}get fPa(){return T.a.instance.Ua(419)}get Llc(){return T.a.instance.Ua(420)}get Klc(){return"DownloadOdsLink"}get gDb(){return"#"}get q9a(){return T.a.instance.Ua(421)}get vvf(){return!0}grf(){h.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}irf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}Elc(){W.Redirect.showHelp(O.a.MMi);return!0}}Object(u.a)(Y,"DownloadACopyAsOdsDialog",S.a,[]);class va{constructor(Ra,ya){this.dialog=null;this.ABf=()=>{this.dialog&&this.dialog.hide()};this.cNi=Ra;this.rb=ya;this.rb.sob(this.ABf)}Pwe(Ra){this.dialog=Ra}c9c(){this.cNi.cKf(-1059172980)}dispose(){this.rb.aKb(this.ABf)}}
Object(u.a)(va,"DownloadACopyAsOdsDialogDownloadBehavior",null,[315,2]);const ca=(Ra,ya,Va,oa,kb,Sa,U=null)=>{U=Ra.Na(9,U);U.isReadOnlyRecommended=ya;return H.g(Ra,"SetReadOnlyRecommended",U,Va,oa,kb,Sa,0)},V=(Ra,ya,Va,oa,kb,Sa,U=null)=>{U=Ra.Na(9,U);U.calc_type=ya;return H.g(Ra,"SetCalculationOptions",U,Va,oa,kb,Sa,0)};class ra{constructor(Ra){this.calculationMode=0;this.calculationMode=Ra}}Object(u.a)(ra,"MacroRecorderWorkbookCalculationModeSetPayload",null,[125]);class N{constructor(Ra){this.calculateType=
0;this.calculateType=Ra}}Object(u.a)(N,"MacroRecorderWorkbookRecalculatedPayload",null,[125]);var ea=a(85),Ba=a(146),ka=a(177),Ka=a(14),Oa=a(107),wa=a(1);S=a(261);class qa{static get b2i(){return qa.a2i}}qa.a2i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(u.a)(qa,"OpenInAppDialogCopyHtml",null,[]);var aa=a(152);class ia extends S.a{constructor(Ra){super(Ra);this.pI=null;this.SFb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.va.IsMeetingLiveSession)return this.bGc(),!0;w.a.Cp?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Qx&&this.Qx.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Qx+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Hm+";end","_top")):9<=w.a.Vmd?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.zma,"_top"),window.setTimeout(()=>{this.openUrl(this.Hm,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.zma,
"_top"),window.setTimeout(()=>{this.openUrl(this.Hm,"_blank")},500));return!0};this.NPa=ya=>ya.Ca.keyCode===ea.a.Sh||ya.Ca.keyCode===ea.a.xpa?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),ya.Gb.click(),!0):!1;1===l.AFrameworkApplication.sa.Pa.Fj&&(this.Qx=this.$.workbookContext.ClientUrl,this.zma="ms-excel:ofe|u|"+this.Qx,this.Hm=l.AFrameworkApplication.fa.Xa("AppUrl"),w.a.Wba?this.Hm="itms-apps://"+l.AFrameworkApplication.fa.Xa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
w.a.Cp&&(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.va.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Hm=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):w.a.XAb?this.Hm=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<w.a.CYc.bPa&&(this.Hm=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get pc(){return"OpenInAppDialogCopy"}openUrl(Ra,
ya){let Va=document.getElementById("link");Va||(Va=document.createElement("a"),Va.id="link",Va.style.visibility="hidden",Va.href="",document.body.appendChild(Va));Va.target=ya;Va.href=Ra;Va.click()}bGc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ra=>{let ya={};ya.OpenInAppUrl=this.zma;ya.StoreUrl=this.Hm;Ra.result.Oj("UI_OpenInMobileApp",ya)},this.$.la)}c2i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}dg(){this.ng=
Ba.a.iq(qa.b2i,T.a.instance.ga(662),T.a.instance.ga(663),l.AFrameworkApplication.yB,aa.getImageClass(l.AFrameworkApplication.fa.Xa("AppIcon")),T.a.instance.ga(664));this.Ee="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.c2i.bind(this),null);this.VI(this.pI)}Qv(Ra){super.Qv(Ra);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.pI=document.getElementById("LinkToInstall");ka.a.instance.ta(Ka.a.click,this.pI,this.SFb);Oa.KeyInputManager.instance.ta(Ka.a.Dd,this.pI,
this.NPa)}dispose(){this.pI&&(ka.a.instance.Ba(Ka.a.click,this.pI,this.SFb),Oa.KeyInputManager.instance.Ba(Ka.a.Dd,this.pI,this.NPa),this.pI=null);super.dispose()}}Object(u.a)(ia,"OpenInAppDialogCopy",S.a,[]);var Ha=a(134),Z=a(373);class la{constructor(Ra){this.fei="itms-apps://";this.gei="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Aqg=ya=>{1==ya&&this.bGc()};this.$=Ra;this.Qx=l.AFrameworkApplication.sa.Pa.Qx;this.zma="ms-excel:ofe|u|"+this.Qx;this.Hm=l.AFrameworkApplication.fa.Xa("AppUrl");
w.a.Wba||w.a.Xg?this.Hm=this.fei+this.gei:w.a.Cp&&(l.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Hm=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):w.a.XAb?this.Hm=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<w.a.CYc.bPa&&(this.Hm=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")))}bGc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ra=>{let ya={};ya[Z.a.iKf]=this.zma;ya[Z.a.Hm]=this.Hm;Ra.result.Oj("UI_OpenInMobileApp",ya)},this.$.la)}dg(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ra=new Ha.StandardDialog;Ra.Rb=0;Ra.oc(1,T.a.instance.ga(668));Ra.$l(T.a.instance.ga(666),T.a.instance.ga(667),0,this.Aqg)}}Object(u.a)(la,"OpenInAppDialogReact",null,[]);S=a(284);class Xa extends S.a{constructor(Ra){super(Ra);
this.sessionId=Ra.va.UserSessionId;this.PYg=Ra.va.BuildVersion}get pc(){return"WACSessionIdDialog"}nN(){return{[Xa.wwj]:T.a.instance.ga(669),[Xa.xwj]:this.sessionId,[Xa.id]:"WACSessionIdDialog",[Xa.j0c]:T.a.instance.ga(670),[Xa.buildVersion]:this.PYg}}dg(){const Ra=this.nN();this.Rb=5;this.initializeAndShow(T.a.instance.ga(1021),this.x4j.bind(this),Ra)}x4j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}Xa.id="id";Xa.wwj="sessionIdLabel";Xa.xwj="sessionIdValue";Xa.j0c=
"buildLabel";Xa.buildVersion="buildVersion";Object(u.a)(Xa,"WACSessionIdDialog",S.a,[]);var Za=a(28),xa=a(29),fa=a(356),ua=a(11),sa=a(183),sb=a(281),hb=a(21),bb=a(44),lb=a(250),Fa=a(461),Na=a(377),Mb=a(51),dc=a(6),Cb=a(143),Tb=a(967),Jb=a(81),eb=a(36),za=a(302),ha=a(253);class fb{PQ(Ra,ya){Ra=xa.a.Zc(12,1,671,0,0,0,"Blank");Ra.Description=String.format(T.a.instance.ga(672),ya);return Ra}Ibc(Ra){switch(Ra){case 1:case 2:return 0;default:return 2}}}Object(u.a)(fb,"ReloadCloseConfirmation",null,[110]);
var rb=a(150),pa=a(588),Ma=a(69),Ja=a(55),Ga=a(174),La=a(33);class nb extends A.a{constructor(Ra,ya,Va,oa){super();this.$=Ra;this.businessBar=oa;this.openInExcelOperation=ya;this.wK=Va}get Zb(){return this.$.ea.Zb}get workbookContext(){return this.$.workbookContext}get S8b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return Ma.a(this.$)}get dc(){return this.$.dc}bci(){var Ra,ya;return null!==(ya=null===(Ra=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===
Ra?void 0:Ra.LoadBlockType)&&void 0!==ya?ya:!1}nc(){return!1}executeCommand(Ra,ya,Va,oa){const kb=this.S8b,Sa=this.$,U=ya.command,ta=this.openInExcelOperation,ub=this.$.Eb,hc=Va.SourceControlId;Sa.il.lqe(U);ta.Kyc(ya.startTime.getTime().toString());Ra=null;switch(U){case 1455037301:this.$.O5?ta.yGe():ta.M4c();break;case -2044628748:case 2004484710:this.$.O5?ta.yGe():ta.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===hc?(this.KDb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.KDb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const Bc=Ma.a(this.$).fd.activityState;bb.a(Sa).Ks(new lb.a(dc.a.hy,5,()=>{Bc[ha.a.Kq]=dc.a.jj}));break;case 480922297:wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new Xa(this.$)).dg();break;case -2028960985:ta.W$f();break;case -1059172980:new Y(ta.ize(U),new va(ta,Sa.rb));break;case -1285148982:this.clientWorkflow.fd.activityState[eb.a.fWc]=!0;this.PCc(!1);break;case -75280711:this.PCc(!1);break;case -455164169:this.PCc(!0);break;case -1388494670:this.$.da.$a(400,pb=>{pb.zGi();this.PCc(!1)});break;case 810888577:l.AFrameworkApplication.wk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${l.AFrameworkApplication.wk}`);
break;case -1804063550:case -974518828:ya=0;x.a.jFd in Va&&(ya=Va[x.a.jFd]);ta.cKf(U,ya);break;case -1339961039:ya=!1;Va&&x.a.aLb in Va&&(ya=Va[x.a.aLb]);this.reloadWorkbook(!1,ya);break;case -8805455:const Qa=this.workbookContext;if(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.bci()&&La.a.gd(this.$)){const pb=f.GetServiceTaskFactory.Oa(this.$.da,522,523,0);d.TaskExtensions.Aa(pb,()=>{pb.result.iE()},this.$.la,3)}else Sa.isEditMode||(nb.YDe(Sa),
Ra=d.TaskExtensions.Aa(this.wK.value,pb=>{pb=pb.result;var Ea=pb.isEnabled();Ea&&M.a(pb,v.a.copyAndEdit,C.a.yg.I1e(),this.$.ea.Vg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Ea&&l.AFrameworkApplication.Xjg?(Ea={},Ea[m.a.fId]=l.AFrameworkApplication.userSessionId,Ea[l.AFrameworkApplication.OIi]=Za.a.Qa.zb.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
pb.Oj(v.a.editMode,Ea)):kb.CopyAndEditUrl?this.mah():(this.dc.supportsEditing||Qa.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Sa.isEditMode&&(nb.YDe(Sa),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const na=Sa.pa.ya.Wb(),ab=-1355155015===U?1:0,Gb=()=>new N(ab);Ra=P.a(this.$.userOperationManager,(pb,Ea,xb)=>H.y(Sa.pa.ya,ab,null,pb,Ea,xb,null,na),pb=>new G.a(128,0,pb,void 0,Gb),ya);hb.h(Sa).Gf.tH(!1);break;case -1158102843:Ra=hb.h(Sa).Gf.recalcSheet(ya);
hb.h(Sa).Gf.tH(!1);break;case -988468372:if(wa.EwaSettings.ma(297))if(oa=parseInt(Va[L.a.Ic],10),0<=oa&&3>oa)this.setCalculationMode(ya,oa);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${Va[L.a.Ic]}`),sa.a(U);break;case 257398710:F.a.ntw(kb.ReportAbuseUrl,Sa);break;case 1800405051:this.$rj();break;case -48469327:this.saveACopy();break;case 214430355:ya=!1;Va&&x.a.K9c in Va&&(ya=Va[x.a.K9c]);if(!this.LFj(ya,Va))break;l.AFrameworkApplication.y5?this.businessBar.kg(42,
null):this.businessBar.kg(ya?22:23,null);break;case 1389557314:Ra=d.TaskExtensions.Aa(this.wK.value,pb=>{M.a(pb.result,v.a.RGh,null,this.$.ea.Vg.get(6))||F.a.ntw(kb.FileVersionUrl,Sa)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:hc===ub+x.a.bof?ta.jzi():ta.izi();break;case 512141517:hc===ub+x.a.aof?ta.rzi():ta.qzi();break;case -1224038235:const fc=t.a.On in Va?!Va[t.a.On]:I.j(Sa.ea.workbookContext.Options);Va[t.a.Description]=fc?T.a.instance.ga(571):T.a.instance.ga(572);
Ra=P.a(this.$.userOperationManager,(pb,Ea,xb)=>ca(this.$.pa.ya,!fc,pb,Ea,xb,null),pb=>new G.a(129,0,pb),ya);break;case 1118926154:if(this.$.isEditMode){const pb=new B.a;this.$.da.$a(53,Ea=>{Ea?(Ea.Gm.bzi(this.$.Eb+x.a.Cud),pb.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ra=pb.task}break;case -1698025133:ta.openInBrowser();break;case 520859864:Ra=d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,393,394,oa.N4()),
pb=>{pb.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Ra=sa.a(U)}return Ra||Ja.Task.Ta(!0)}KDb(Ra){if(ua.HelperMethods.x_){const ya=new Map;ya.set("EntryPoint",Ra);z.Health.instance.recordKpiUsage(Na.a.$1i,0,Fa.a.BIi,ya)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){l.AFrameworkApplication.isMobileMode&&
(this.$.va.IsMeetingLiveSession&&wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new la(this.$)).dg()):wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new ia(this.$)).dg()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),l.AFrameworkApplication.showOpenInAppDialog()))}LFj(Ra,ya){return l.AFrameworkApplication.isMobileMode&&!X.a(this.$.va,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.KDb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):l.AFrameworkApplication.ajc&&(Ra&&fa.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${fa.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):r.a.any([25,26,30,31,57,32,34],Va=>this.businessBar.pla(Va))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):ya&&x.a.d$i in ya&&!Ra?!1:!0}wc(Ra,ya){Ra=!1;switch(ya.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ra=
!0;break;case 480922297:case 520859864:Ra=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ra=Ga.a.mrd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ra=wa.EwaSettings.ma(108);break;case -1388494670:Ra=wa.EwaSettings.ma(108);break;case 810888577:Ra=wa.EwaSettings.ma(268);break;case -1224038235:Ra=this.$.ea.amIAlone;break;case -988468372:Ra=wa.EwaSettings.ma(297);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ra=
!0,h.ULS.shipAssertTag(537162642,0,this.$.kla,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ra}Jc(){return!1}$rj(){if(this.Zb){var Ra=this.$;bb.a(Ra).Ks(new lb.a(dc.a.hy,5,()=>{Ra.FI(!1,!0);const ya=this.clientWorkflow.fd.activityState;ya[ha.a.Kq]=dc.a.cea;ya[Cb.a.JT]=2;ya[eb.a.cs]=Ra.isEditMode;ya[Cb.a.cha]=!1}))}}saveACopy(){if(this.Zb){var Ra=this.$;bb.a(Ra).Ks(new lb.a(dc.a.hy,5,()=>{Ra.FI(!1,!1);const ya=this.clientWorkflow.fd,Va=ya.activityState;
Va[ha.a.Kq]=dc.a.F_f;Va[pa.a.v_b]=this.dc.hasUnsupportedFeaturesForEdit;Va[Cb.a.cha]=!1;ya.tr(xa.a.v4(this.businessBar.c$c,[-502303485]))}))}}PCc(Ra){bb.a(this.$).Ks(new lb.a(dc.a.foa,2,()=>{this.$.FI(!0,!0);var ya=Ma.a(this.$).fd,Va=this.$.isEditMode;Va=xa.a.Zc(1,1,0,0,0,Va?-315732528:-2087635043,Va?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Va.ForceVersionUpgrade=Ra;ya.tr([Va]);ya=Ma.a(this.$).fd.activityState;ya[ha.a.Kq]=dc.a.foa;ya[eb.a.cs]=this.$.isEditMode;ya[Cb.a.cha]=!1}))}closeWorkbook(){if(this.Zb){var Ra=
this.$;C.a.yg.ozc("2145659238")?d.TaskExtensions.Aa(this.wK.value,ya=>{ya.result.Oj(v.a.fXe,{})},this.la,3):bb.a(Ra).Ks(new lb.a(dc.a.hy,5,()=>{Ra.FI(!0,!1);const ya=this.clientWorkflow.fd.activityState;ya[Cb.a.zY]=!1;ya[Cb.a.cha]=!1;this.dc.inViewerFromWebPart?(J.a.WId(Ra,this.clientWorkflow.fd),Ra.il.kz("InViewerFromWebPart"),ya[ha.a.Kq]=dc.a.b0):(ya[ha.a.Kq]=dc.a.Uj,Ra.rd&32?ya[Cb.a.JT]=0:(ya[Cb.a.JT]=1,ya[Cb.a.k_b]=new Tb.a),ya[rb.a.Koe]=!0)}))}}mah(){const Ra=this.dc.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ra}`);const ya=this.$;Ra?bb.a(ya).Ks(new lb.a(dc.a.hy,5,()=>{const Va=xa.a.Zc(3,0,0,1259,0,1069271157,"XLSMacroFailure");this.clientWorkflow.fd.tr([Va]);this.clientWorkflow.fd.activityState[ha.a.Kq]=dc.a.cgb})):l.AFrameworkApplication.hideHeader?ua.HelperMethods.lf(this.S8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):F.a.ntw(this.S8b.CopyAndEditUrl,ya)}reloadWorkbookInEditMode(){if(this.Zb)if(C.a.yg.LV&&
C.a.yg.LKd(),l.AFrameworkApplication.ajc&&!l.AFrameworkApplication.ica)ua.HelperMethods.lf(this.$.sqb(!0),y.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ra=this.$,ya=!1,Va=this.dc.hasUnsupportedFeaturesForEdit,oa=this.workbookContext.FileWasRepaired;fa.d(this.workbookContext.WorkbookFileName)?(ya=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Va}`)):fa.a(this.workbookContext.WorkbookFileName)&&
(ya=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var kb=Ra.he.get(59);kb=!(Ra.ea.dc.supportsEditing&&kb);if(ya&&!Va||kb&&(ya||Va)){let Sa;Sa=kb?Va?-2066104278:816071846:wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&X.a(this.$.va,25)&&!this.$.HBb?765011943:-213064907;ya=()=>{const U=xa.a.n0a([Sa]);this.clientWorkflow.fd.tr(U);this.clientWorkflow.fd.activityState[ha.a.Kq]=dc.a.cgb}}else ya=()=>
{Ra.FI(!0,!1);var Sa=this.clientWorkflow.fd;const U=Sa.activityState;U[Cb.a.JT]=1;U[za.a.p_b]=n.a.onc;U[eb.a.cs]=!0;U[pa.a.v_b]=this.dc.hasUnsupportedFeaturesForEdit;U[Cb.a.cha]=!!this.workbookContext.EditUrl;U[Jb.a.L2]=this.workbookContext.EditUrl;if(!this.S8b.CopyAndEditUrl){const ta=[wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&X.a(this.$.va,25)&&!this.$.HBb?-943219229:1821390342];Sa.tr(xa.a.v4(this.businessBar.c$c,ta))}oa&&!Va?(fa.b(this.workbookContext.WorkbookFileName)&&
wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Sa=xa.a.n0a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Sa=xa.a.n0a([108482388]),this.clientWorkflow.fd.tr(Sa),U[ha.a.Kq]=dc.a.T_f):this.$.ea.Waf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Mb.b().gXd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),U[ha.a.Kq]=dc.a.GHb):U[ha.a.Kq]=this.$.ea.Nic?dc.a.kDb:dc.a.cgb};bb.a(Ra).Ks(new lb.a(dc.a.hy,5,ya))}}reloadWorkbookInViewMode(){if(this.Zb){C.a.yg.LV&&C.a.yg.LKd();var Ra=this.$;w.a.Xg&&hb.h(Ra).Vb.textBox.blur();bb.a(Ra).Ks(new lb.a(dc.a.hy,5,()=>{Ra.FI(!Ra.ea.isNamedObjectViewMode,!1);const ya=this.clientWorkflow.fd.activityState;ya[ha.a.Kq]=dc.a.lia;ya[Cb.a.JT]=1;ya[Cb.a.zY]=!0;ya[eb.a.cs]=!1;ya[eb.a.Snb]=!0;ya[za.a.p_b]=n.a.onc}))}}reloadWorkbook(Ra,ya){if(this.Zb){var Va=
this.$;Va.$U&65536&&bb.a(Va).Ks(new lb.a(dc.a.hy,5,()=>{Va.FI(Ra,!0);const oa=this.clientWorkflow.fd.activityState;oa[ha.a.Kq]=dc.a.sz;oa[eb.a.iWc]=this.workbookContext.NovMode;ya||(oa[Cb.a.JT]=1,oa[Cb.a.k_b]=new fb)}))}}setCalculationMode(Ra,ya){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${ya} `);const Va=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=ya;const oa=()=>new ra(ya);return P.a(this.$.userOperationManager,(kb,Sa,U)=>V(this.$.pa.ya,
ya,sb.b(kb,nb.HZi(this.$,Va)),sb.a(Sa,nb.GZi(this.$,Va)),U,null),kb=>new G.a(197,0,kb,void 0,oa),Ra)}static YDe(Ra){Ra.rb&&0<Ra.rb.KR&&Ra.rb.Ebd(ya=>{ya.sv()})}static HZi(Ra,ya){return Va=>{xa.a.Zf(Va.Errors)&&(Ra.ea.workbookContext.CalcMode=ya,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${ya}.  Error id names: ${xa.a.sc(Va.Errors)}`))}}static GZi(Ra,ya){return()=>{Ra.ea.workbookContext.CalcMode=ya;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${ya})`)}}}Object(u.a)(nb,"FileOperationsCommandHandler",A.a,[165]);var Lb=a(153);class ac extends e.a{constructor(Ra){super(Ra)}nd(){const Ra=this.$,ya=[],Va=f.GetServiceTaskFactory.create(Ra.da,56,this.la,this.Ya);ya.push(Va);const oa=f.GetServiceTaskFactory.Oa(Ra.da,5,4,this.Ya);ya.push(oa);d.TaskExtensions.Aa(Ja.Task.mJ(...ya),()=>{Lb.b(Va)&&this.Yc([new nb(Ra,Va.result,new b.a(()=>f.GetServiceTaskFactory.create(Ra.da,
137,this.la,this.Ya)),oa.result)])},this.la,0)}static ka(Ra){e.a.Nd(94,new ac(Ra))}}Object(u.a)(ac,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(D,"a",function(){return ib});const ib=()=>{c.a.Fa(ac.ka)}},1171:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(8),f=a(19),d=a(65),h=a(61),m=a(5),l=a(31);class v{}v.Zyh="ewa-resizehdr-row-hidden";v.Yyh="ewa-resizehdr-col-hidden";Object(u.a)(v,"CssClassNames",null,[]);var t=a(239),z=a(14),r=a(156),n=a(631),w=a(27),B=a(224),A=a(4),y=a(263),x=a(15),F=
a(76),I=a(132),L=a(42),X=a(142),P=a(24),G=a(53),C=a(12),H=a(71),J=a(1),M=a(94),S=a(11),W=a(13),O=a(251),T=a(133),Y=a(372),va=a(44),ca=a(34);class V{constructor(za,ha,fb,rb,pa,Ma,Ja){this.Swa=za;this.GEb=ha;this.yPa=fb;this.Qld=rb;this.fdb=pa;this.Ymf=Ma;this.rbi=Ja}}Object(u.a)(V,"HeaderEventCachedInfo",null,[]);class ra{constructor(za){this.C9c=za}PGe(za){za=S.HelperMethods.KGd(za);return Math.max(0,Math.min(ra.Uuf,za))}FGe(za){return this.N5i(za)}K6g(za){return Math.round(this.C9c*za+2*this.p2e()+
1)}N5i(za){return Math.max(0,Math.min(ra.zuf,(Math.max(0,Math.min(e.a.Smc,za))-2*this.p2e()-1)/this.C9c))}p2e(){return Math.floor(Math.max((this.C9c+3)/4,2))}jdc(za,ha){return ha?za?ra.Uuf:e.a.Uyd:za?ra.zuf:e.a.Smc}}ra.Uuf=409;ra.zuf=255;Object(u.a)(ra,"ResizeHeadersConverter",null,[]);var N=a(191);class ea extends M.a{constructor(za,ha){super(ha.domElement);this.fY=this.JYf=!1;this.aj=this.Y8a=this.RBa=null;this.UNd=!0;this.Pjc=!1;this.BLb=this.rl=this.offset=0;this.tN=this.XW=this.h1=null;this.uci=
"headerResizeTooltip";this.IG=this.fxd=null;this.$Zc=this.s9=this.RAa=!1;this.BKf=this.Jab=e.a.nxa;this.Igf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.nRb=!1;this.dO=fb=>{if(this.grid.lk)return!1;fb=ca.a(this.grid.$).Vd(fb);if(3===fb.tb&&!this.Zmf(fb.Ca)||!this.ANf(fb,!1))return!1;x.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const rb=this.eAc();this.Jed(fb.clientPoint,rb,!0);this.RAa||(t.a.instance.ta(z.a.Ij,
this.domElement.ownerDocument.body,this.T$a),r.a.instance.ta(z.a.Yf,this.domElement.ownerDocument.body,this.T$a),this.RAa=!0);this.Uif()&&this.fY&&this.zdf(fb);return!1};this.YFb=fb=>{fb=ca.a(this.grid.$).Vd(fb);this.Uif()&&this.$Zc&&this.zdf(fb);if(!fb.Ca.type.includes("touch")&&fb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.ABb)return!1;H.g(fb.Ca);this.YPe();fb=this.grid.lk?this.Jab:e.a.nxa;var rb=!1;if(this.grid.lk&&this.aj){var pa=fb!==this.rl||!this.Igf&&this.s9;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!pa&&this.nRb&&(this.ve.removeRowColFromModel(this.aj.xVc,this.aj.MTf),rb=!0,J.EwaSettings.ym()&&(this.ve.A8(this.grid.ha.ra.selectedRanges),this.ve.hn("HeaderResizeBehavior::onDocumentMouseUp")))}else this.aj&&(fb=this.s9?this.mgd():this.aj.J4()),pa=fb!==this.rl;this.RBa&&pa&&fb!==e.a.nxa?(fb=this.grid,pa=this.Fid(fb),rb={},rb.SheetMultiRange=L.r(pa,fb.$),ea.xSd(rb,this.isRow,this.rl),this.Lsh(rb),fb.PPj=!0):(!J.EwaSettings.ym()&&rb&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&
this.ve.A8(this.grid.ha.ra.selectedRanges),this.ve.hn("HeaderResizeBehavior::onDocumentMouseUp")),this.Ag(null,null),this.OJb());return this.nRb=this.s9=!1};this.Wca=fb=>{if(this.grid.lk)return!1;fb=n.a.create(fb.eventName,fb.Gb,fb.Ca,fb.tb);fb=ca.a(this.grid.$).Vd(fb);if(!this.ANf(fb,!0))return!1;fb=this.grid;var rb=this.Fid(fb);rb=L.r(rb,fb.$);fb.qb.Wg([this.isRow?13:14]);fb.qb.BTa();this.OJb();fb.$.Xc(this.isRow?146338636:1391094586,F.a.Db,30,{["autoFitRanges"]:rb});return!1};this.zDf=fb=>{this.fY?
(this.s9&&!this.nRb&&(this.eJg(),J.EwaSettings.ym()&&this.ve.hn("HeaderResizeBehavior::onHeaderResizeChanged")),this.Pjc||this.Ref(),fb=new Sys.UI.DomEvent(fb),fb=n.a.create(z.a.Nha,this.domElement,fb,2),fb=ca.a(this.grid.$).Vd(fb),this.yDd(fb.clientPoint)):x.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.aj?this.aj.xVc:-1}, isRow = ${this.isRow}`)};this.ADf=fb=>{fb=new Sys.UI.DomEvent(fb);fb=n.a.create(z.a.Nha,
this.domElement,fb,2);this.YFb(fb)};this.EUi=fb=>{this.wza(fb,this.aj,!1)};this.T$a=fb=>{fb=ca.a(this.grid.$).Vd(fb);H.g(fb.Ca);return this.yDd(fb.clientPoint)};this.BI=fb=>{if(this.grid.lk)return!1;fb=ca.a(this.grid.$).Vd(fb);let rb;if(!this.ulf||-1!==this.grid.ha.selectionType)return va.a(this.grid.$).oq()&&(rb=this.Ygd(fb))&&(rb.Swa.style.cursor=""),!1;if(this.fY)return this.Ref(),!1;rb=this.Ygd(fb);if(!rb)return!1;rb.Swa.style.cursor=!this.grid.eb&&this.nud(rb)?this.isRow?"row-resize":"col-resize":
"";H.g(fb.Ca);return!0};this.Np=()=>{this.OJb()};this.Ag=()=>{if((3===F.a.Db||w.a.Fp)&&this.grid.ha.ra.Mg){var fb=this.grid.ha.ra.$c;if(!(!fb.isRow&&!fb.hf||!this.domElement||fb.isRow&&this.isRow&&!this.ve.Kt.includes(fb.top)||fb.hf&&!this.isRow&&!this.ve.Kt.includes(fb.left))){var rb=this.grid.ag(fb,this.ve.$i.paneType);if(rb){if(this.grid.lk){const pa=this.isRow?fb.bottom:fb.right;this.aj=this.ve.vs(P.Range.Qc(fb.bottom,fb.right));if(!this.aj){x.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${pa}, is row ${this.isRow}`);
return}}this.IG||this.Ihh();fb.isRow&&this.isRow?(C.DOMElementExtensions.setVisible(this.IG,!0),this.IG.style.top=rb.bottomRight.y-this.IG.offsetHeight/2+"px"):fb.isRow||this.isRow||(C.DOMElementExtensions.setVisible(this.IG,!0),O.c(this.IG.style,this.grid.rtl,rb.bottomRight.x-this.IG.offsetWidth/2+"px"))}}}};this.dG=(fb,rb)=>{J.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&x.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${rb.uM}`);
rb.uM&&this.Vqb()};this.ve=ha;this.isRow=ha.isRow;this.rtl=ha.$i.rtl;this.grid=za;this.Cuf=this.isRow?e.a.Uyd:e.a.Smc;this.pci=W.a.instance.ga(436);this.yci=W.a.instance.ga(435);this.sci=W.a.instance.ga(437);T.a(this.grid.$,fb=>{this.fxd=fb.qQ(I.a.fpj,!1)});this.nfj();this.grid.ha.RT(this.Ag);this.grid.ha.Y2(this.Np);this.grid.mv(this.Ag);va.a(this.grid.$).Xf.k$(this.dG)}get ABb(){return this.fY}get ulf(){const za=(new X.a(this.grid.$.xa)).Td(this.isRow?16:8),ha=this.grid.$.rb.yy,fb=this.grid.ri,
rb=va.a(this.grid.$).oq();return za&&!ha&&!fb&&!rb}get hpj(){this.tth();return ea.gdb}wza(za,ha,fb){var rb=new Sys.UI.DomEvent(za);rb=n.a.create(z.a.Nha,this.domElement,rb,2);rb=ca.a(this.grid.$).Vd(rb);this.zNf(ha,rb.clientPoint.x,rb.clientPoint.y,!1,fb,za);za=this.eAc();this.Jed(this.RBa,za,!0);this.RAa||(za=this.domElement.ownerDocument.body,za.addEventListener(z.a.Nha,this.zDf),za.addEventListener(z.a.HHa,this.ADf),this.RAa=!0)}CUi(za,ha,fb){this.zNf(ha,za.clientX,za.clientY,!0,this.Igf?fb:!1,
za);za=this.grid;ha=this.Fid(za);ha=L.r(ha,za.$);za.qb.Wg([this.isRow?13:14]);za.qb.BTa();this.OJb();za.$.Xc(this.isRow?146338636:1391094586,F.a.Db,30,{["autoFitRanges"]:ha})}dispose(){this.K2c();this.grid.ha&&(this.grid.ha.aS(this.Ag),this.grid.ha.A7(this.Np));this.grid.Oy(this.Ag);va.a(this.grid.$)&&va.a(this.grid.$).Xf.Rda(this.dG);B.a.instance.Ba(z.a.Bk,this.domElement,this.Wca);t.a.instance.Ba(z.a.Pf,this.domElement.ownerDocument.body,this.YFb);r.a.instance.Ba(z.a.we,this.domElement.ownerDocument.body,
this.YFb);w.a.Fp||(t.a.instance.Ba(z.a.pointerDown,this.domElement,this.dO),t.a.instance.Ba(z.a.Ij,this.domElement,this.BI));this.RAa&&(t.a.instance.Ba(z.a.Ij,this.domElement.ownerDocument.body,this.T$a),r.a.instance.Ba(z.a.Yf,this.domElement.ownerDocument.body,this.T$a),this.RAa=!1);this.IG&&(t.a.instance.Ba(z.a.pointerDown,this.IG,this.dO),B.a.instance.Ba(z.a.Bk,this.IG,this.Wca),this.K2c(),this.IG=null);this.JYf&&(C.DOMElementExtensions.tf(ea.gdb),ea.gdb=null);this.ve=null;super.dispose()}nfj(){B.a.instance.ta(z.a.Bk,
this.domElement,this.Wca);t.a.instance.ta(z.a.Pf,this.domElement.ownerDocument.body,this.YFb);r.a.instance.ta(z.a.we,this.domElement.ownerDocument.body,this.YFb);w.a.Fp||(t.a.instance.ta(z.a.pointerDown,this.domElement,this.dO),t.a.instance.ta(z.a.Ij,this.domElement,this.BI))}tth(){if(!ea.gdb){document.getElementById(ea.IYf);this.JYf=!0;var za=ea.gdb=document.createElement("div");this.grid.$.frame.hba().appendChild(za);za.id=ea.IYf;za.className=l.a.$yh;C.DOMElementExtensions.setVisible(za,!1)}}YPe(){if(this.RAa){const za=
this.domElement.ownerDocument.body;this.grid.lk?(za.removeEventListener(z.a.Nha,this.zDf),za.removeEventListener(z.a.HHa,this.ADf)):(t.a.instance.Ba(z.a.Ij,za,this.T$a),r.a.instance.Ba(z.a.Yf,za,this.T$a));this.RAa=!1}this.fY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.JUf():(this.lZf(),this.XLd());Y.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}lZf(){this.grid.qb.Wg([this.isRow?13:14]);this.grid.qb.BTa()}eJg(){this.ve.addRowColToModel(this.aj.xVc-
1,this.aj.MTf);this.nRb=!0}yDd(za){if(!this.fY)return!1;const ha=this.isRow;if(!this.grid.lk&&!this.h1){this.h1=document.createElement("div");this.h1.style.cssText="position: relative; width: inherit; height: inherit;"+(ha?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var fb=this.aj.vK();fb.nextSibling;)this.h1.appendChild(fb.nextSibling);fb.parentNode.appendChild(this.h1)}fb=ha?za.y-this.Y8a.y:(this.rtl?-1:1)*(za.x-this.Y8a.x);const rb=ha?za.y-this.RBa.y:(this.rtl?-1:1)*(za.x-this.RBa.x),
pa=this.grid.lk?this.Jab:this.aj.J4();if(pa===e.a.nxa)return!1;fb&&(0<this.rl||0<pa+rb)&&pa+rb<=this.Cuf&&(this.rl=this.eAc(rb),this.Jed(za,this.rl,!1),this.grid.lk?this.rl>=ea.sbf?(this.UNd=!0,this.aj.setCellExtent(this.rl)):this.UNd&&(this.UNd=!1,this.aj.setCellExtent(ea.sbf)):(C.DOMElementExtensions.rpa(this.aj.vK(),!ha,Math.max(this.BLb+rb,0)),this.h1.style[ha?"top":this.rtl?"right":"left"]=Math.max(rb,-this.BLb)+"px"),fb=(this.grid.lk?this.BKf:ha?this.aj.ve.LC:this.aj.ve.NC)+Math.max(rb,this.grid.lk?
-this.Jab+ea.Eec:-this.BLb),C.DOMElementExtensions.rpa(this.aj.ve.domElement,!ha,fb),this.grid.lk&&this.aj.ve.dxj(fb),this.Y8a=new Sys.UI.Point(za.x,za.y),C.DOMElementExtensions.setVisible(this.IG,!1));return!0}J4(){return this.aj?this.s9?ea.Eci:this.aj.J4():e.a.nxa}Jed(za,ha,fb){this.tN&&fb&&(x.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.XLd());this.tN||fb||x.ULS.sendTraceTag(537154050,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.fxd&&this.fxd(()=>({["Location"]:"canvas"}));this.tN?this.G_e(ha):(this.tN=document.createElement("div"),this.tN.id=this.uci,this.G_e(ha),this.tN.className=l.a.Fxh,ha=document.getElementById(this.grid.$.Eb+m.a.owf),ha.insertBefore(this.tN,ha.firstChild),za=ca.a(this.grid.$).nka(za),this.tN.style.left=(this.rtl?Math.max(za.x-this.tN.offsetWidth,0):za.x-Math.max(za.x+this.tN.offsetWidth-
ha.offsetWidth,0)).toString()+"px",ha=document.getElementById(m.a.Nsa),this.tN.style.top=(za.y-(A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Pa.Ye?0:ha.offsetHeight)-this.tN.offsetHeight).toString()+"px")}XLd(){C.DOMElementExtensions.tf(this.tN);this.tN=null}G_e(za){var ha=new ra(this.grid.$.workbookContext.DxDigitNormal);ha=this.isRow?ha.PGe(za).toFixed(2):ha.FGe(za).toFixed(2);this.tN.innerText=`${this.isRow?this.pci:this.yci} ${ha} (${za.toString()} ${this.sci})`}ANf(za,ha){let fb;if(-1!==
this.grid.ha.selectionType||2===za.tb&&za.Ca.button!==Sys.UI.MouseButton.leftButton||!this.nud(fb=this.Ygd(za))||!this.ulf)return!1;H.g(za.Ca);this.RBa=this.Y8a=new Sys.UI.Point(za.clientPoint.x,za.clientPoint.y);this.P_g(fb,ha);if(!this.aj)return!1;this.fY=!0;this.uti(this.aj,fb)&&this.rgi();this.BLb=this.mgd();return this.BNf(za.Ca.rawEvent,ha)}zNf(za,ha,fb,rb,pa,Ma){this.fY=!0;this.s9=pa;this.aj=za;this.Pjc=!1;this.RBa=this.Y8a=new Sys.UI.Point(ha,fb);za=this.aj.getRange();this.XW=pa?this.hte(za):
za;this.Jab=this.J4();this.BKf=this.isRow?this.aj.ve.LC:this.aj.ve.NC;this.BNf(Ma,rb)}BNf(za,ha){T.b(this.grid.$).Gd(I.a.Xoj,{["IsResizingHiddenHeader"]:this.s9,["IsAutoFitting"]:ha,["NumberOfSelectedRanges"]:this.grid.ha.ra.zI,["Location"]:"canvas"});this.grid.WGj&&(ha=ha?"header_resize_autofit":"header_resize_start",N.b(this.grid.$).tCa(za,ha,void 0));this.offset=this.aj.sba();this.rl=this.grid.lk?this.Jab:this.aj.J4();if(this.rl===e.a.nxa)return!1;Y.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");
return!0}uti(za,ha){var fb=this.aj.vK();if(!fb)return x.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;fb=fb.nextSibling;if(!fb)return!1;za=za.getRange();fb=this.ve.Uva(fb).getRange();if(!za||!fb)return x.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;za=this.isRow?za.bottom:za.right;fb=this.isRow?fb.bottom:fb.right;return za+1!==fb&&za!==fb&&this.nud(ha,!0)}rgi(){var za=this.aj.vK();const ha=this.ve.Uva(za.nextSibling);ea.vti(ha,this.isRow)?
(this.aj=ha,this.XW=this.aj.getRange()):(this.fJg(za),this.aj=ha,za=this.aj.getRange(),this.XW=this.hte(za),this.s9=!0)}hte(za){return this.isRow?new P.Range(za.top-1,za.left,za.top-1,za.right,!1,!0):new P.Range(za.top,za.left-1,za.bottom,za.left-1,!1,!0)}fJg(za){const ha=this.ve.Uva(za.nextSibling),fb=ea.Kdh(ha,this.isRow,this.rtl);fb&&za.parentNode.insertBefore(fb,ha.vK())}Fid(za){const ha=this.XW,fb=za.ha.ra.selectedRanges;if(za.ha.ra.Utb(ha))if(this.isRow){if(y.a.all(fb,rb=>rb.isRow))return fb}else if(y.a.all(fb,
rb=>rb.hf))return fb;return[ha]}getCellExtent(){return this.aj.getCellExtent()}mgd(){const za=this.aj.vK().style;return Math.max(0,Math.min(this.Cuf,0|parseInt(this.isRow?za.height:za.width,10)))}eAc(za=0){const ha=this.grid;var fb=this.ve.$i.paneType;let rb;rb=this.isRow?3===fb?[3,2]:[1,4]:4===fb?[2,4]:[1,3];var pa=Math.max(this.grid.lk?this.Jab:this.aj.J4(),0);za=this.s9&&!this.grid.lk?Math.max(this.mgd(),0):Math.max(pa+za,0);fb=ha.tZh(fb,this.isRow);fb=this.isRow?new h.a(0,this.offset,fb,za):new h.a(this.offset,
0,za,fb);pa=[this.isRow?13:14];ha.qb.Qi(new P.Range(1,1,e.a.eh,e.a.qh,!1,!0),pa,!1);ha.qb.Tn(pa,fb,rb);return za}K2c(){this.XW=this.RBa=this.Y8a=null;if(this.h1){const za=this.h1.parentNode;if(za)for(za.removeChild(this.h1);this.h1.firstChild;)za.appendChild(this.h1.firstChild);this.h1=null}this.aj=null;this.fY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.JUf()}JUf(){this.Pjc=!1;this.XLd();C.DOMElementExtensions.setVisible(ea.gdb,!1);C.DOMElementExtensions.setVisible(this.IG,
!1);J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.lZf()}Ygd(za){if(C.DOMElementExtensions.Jz(za.Gb,"a"))return null;const ha=this.Zmf(za.Ca);if(ha&&this.grid.ha.ra.Mg){var fb=this.grid.ha.ra.$c;fb=this.ve.vs(P.Range.Qc(fb.bottom,fb.right))}else fb=this.ve.Uva(za.Gb);if(!fb)return null;const rb=fb.vK(),pa=new Sys.UI.Bounds(rb.offsetLeft,rb.offsetTop,rb.offsetWidth,rb.offsetHeight);var Ma=C.DOMElementExtensions.getBoundingClientRect(za.Gb);Ma=new Sys.UI.Point(za.clientPoint.x-
Ma.x,za.clientPoint.y-Ma.y);this.isRow&&!ha&&(Ma.y+=S.HelperMethods.tD(za.Gb,rb,this.rtl).y);return new V(rb,Ma,pa,fb.getRange(),Math.max(ea.xIi,Math.min(ea.rHi,(this.isRow?pa.height:pa.width)*ea.gpj)),ha,!this.isRow&&0<rb.getElementsByTagName("input").length)}nud(za,ha=!1){if(!za||this.grid.eb)return!1;if(za.Ymf)return!0;var fb=za.yPa;const rb=za.fdb;var pa=this.ve.$i.paneType,Ma=this.grid.Af(pa).ui,Ja=!!Ma&&Ma.top===za.Qld.top,Ga=!!Ma&&Ma.left===za.Qld.left;pa=!!Ma&&Ma.bottom===za.Qld.bottom&&(3===
pa||2===pa);this.isRow?(Ga=za.GEb.y,za=Ga<=rb&&!Ja,fb=Ga>=fb.height-rb-(pa?ea.sLh:0),ha=ha?za:fb||za):(pa=za.rbi,Ja=this.rtl,Ma=za.GEb.x,za=Ma<=rb&&(!Ga||Ja)&&(!pa||!Ja),fb=Ma>=fb.width-rb&&(!Ja||!Ga)&&(!pa||Ja),ha=ha?Ja?fb:za:za||fb);return ha}P_g(za,ha){const fb=this.isRow;if(za.Ymf)this.aj=this.ve.Uva(za.Swa);else if(fb&&za.GEb.y<=za.fdb&&za.yPa.height>za.fdb||!fb&&za.yPa.width>za.fdb&&(!this.rtl&&za.GEb.x<=za.fdb||this.rtl&&za.GEb.x>=za.yPa.width-za.fdb)){if(this.aj=za.Swa.previousSibling?this.ve.Uva(za.Swa.previousSibling):
this.DYh(),ha&&za.Swa.classList.contains(fb?l.a.CVe:l.a.BVe)&&(za=this.ve.Uva(za.Swa)))za=za.getRange(),this.XW=fb?new P.Range(za.top-1,za.left,za.top-1,za.right,!1,!0):new P.Range(za.top,za.left-1,za.bottom,za.left-1,!1,!0)}else this.aj=this.ve.Uva(za.Swa);!this.XW&&this.aj&&(this.XW=this.aj.getRange())}DYh(){var za=this.isRow?1:0;return(za=this.ve.$i.MG(this.ve.$i.Ea.Kg(this.grid.$.na,d.a.SM(this.ve.position.X+za-1,this.ve.position.Y-za,this.ve.position.PaneType))))?za.CYh():null}Ref(){this.Pjc=
!0;const za=this.hpj;C.DOMElementExtensions.setVisible(za,!0);za.style.cursor=this.isRow?l.a.LSe:l.a.zRe;this.eAc()}Lsh(za){this.grid.$.Xc(this.isRow?745189930:-445963340,F.a.Db,30,{["resizeRowColumnParameters"]:za})}Ihh(){const za=document.createElement("div");za.className=l.a.Zzh;const ha=document.createElement("div");ha.className=f.a.Rx;za.appendChild(ha);const fb=document.createElement("img");fb.src=G.a.Ge(0);fb.className=this.isRow?f.a.Xyh:f.a.Syh;ha.appendChild(fb);this.ve.$A.domElement.parentNode.insertBefore(za,
this.ve.$A.domElement);this.grid.lk?za.addEventListener(z.a.I$,this.EUi):(t.a.instance.ta(z.a.pointerDown,za,this.dO),B.a.instance.ta(z.a.Bk,za,this.Wca));C.DOMElementExtensions.setVisible(za,!1);this.IG=za}OJb(){this.K2c();this.IG&&(this.ve.$A.domElement.parentNode.removeChild(this.IG),this.IG=null)}Zmf(za){return C.DOMElementExtensions.xf(this.IG,za.target)}Vqb(){this.fY&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.lk&&this.yDd(this.RBa),this.YPe(),this.grid.lk||
C.DOMElementExtensions.rpa(this.aj.vK(),!this.isRow,this.BLb),this.OJb(),this.nRb=this.s9=!1)}Uif(){return J.EwaSettings.ma(666)}zdf(za){(za=za.Ca.rawEvent)&&za.detail===ea.Mtj&&(za.type===z.a.rq?(this.fY=!1,this.$Zc=!0):za.type===z.a.wI&&(this.fY=!0,this.$Zc=!1))}static Gdh(za,ha){return new ea(za,ha)}static xSd(za,ha,fb){if(ha){za.ColumnWidth=-1;za.RowHeight=fb;for(const rb of za.SheetMultiRange.Ranges)rb.FirstColumn=0,rb.LastColumn=0}else{za.RowHeight=-1;za.ColumnWidth=fb;for(const rb of za.SheetMultiRange.Ranges)rb.FirstRow=
0,rb.LastRow=0}}static vti(za,ha){if(!za||!za.vK())return x.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const fb=za.getRange();za=za.vK().style;if(!fb||!za)return x.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;za=ha?za.height:za.width;return(ha?fb.top:fb.left)===(ha?e.a.eh:e.a.qh)&&za===ea.Emg}static Kdh(za,ha,fb){if(!za)return x.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var rb=za.vK();if(!rb||!rb.style)return x.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;za=document.createElement("div");const pa=rb.style;za.style.top=ha?pa.top:ea.Emg;ha||(fb?za.style.right=pa.right:za.style.left=pa.left);za.classList.add(ha?v.Zyh:v.Yyh);za.classList.add(ha?l.a.Yub:l.a.Xub);fb=document.createElement("div");fb.classList.add(ha?l.a.pVe:l.a.pbd);rb=ha?Number.parseInvariant(rb.innerText):P.Range.n1a(rb.innerText);fb.innerText=ha?(rb-1).toString():P.Range.QM(rb-1);za.appendChild(fb);return za}}ea.xIi=0;ea.rHi=5;
ea.Eec=1;ea.sbf=1;ea.Eci=0;ea.sLh=3;ea.gpj=.1;ea.IYf="ewa-rszrbg";ea.Emg="0px";ea.Mtj=2;ea.gdb=null;Object(u.a)(ea,"HeaderResizeBehavior",M.a,[554]);class Ba extends b.a{constructor(){super();this.Fb()}create(){this.ob(ea.Gdh)}static ka(za){za.da.Ga(136,new Ba)}}Object(u.a)(Ba,"HeaderResizeBehaviorFactory",b.a,[]);var ka=a(55),Ka=a(692),Oa=a(50),wa=a(37),qa=a(170),aa=a(423),ia=a(371),Ha=a(188),Z=a(282),la=a(281),Xa=a(67),Za=a(21);class xa{constructor(za,ha){this.isRow=!1;this.autoFitRange=null;this.isRow=
za;this.autoFitRange=ha}}Object(u.a)(xa,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[125]);class fa{constructor(za){this.resizeParameters=null;this.resizeParameters=za}}Object(u.a)(fa,"MacroRecorderSheetRowsColumnsResizedPayload",null,[125]);var ua=a(82);b=a(284);var sa=a(22);class sb extends b.a{constructor(za,ha){super(za);this.dxb=fb=>{fb=this.lhd(fb);return this.Bed(fb)};this.Yoj=(fb,rb)=>{var pa=this.u8a=rb[sb.eoi];1===fb?(fb=rb[sb.EKj],pa=this.F8e(fb,pa),x.ULS.shipAssertTag(537153996,
0,pa!==sb.Rba,`ResizeHeadersDialogHandler - invalid size input, size = ${fb}`),fb=pa!==this.Xnd,x.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.u8a,pa,fb),fb&&this.jbh(pa)):x.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===ha.command;this.gridView=Za.h(this.$);this.Wvc=new ra(this.$.workbookContext.DxDigitNormal);
this.Xnd=this.p0g();za=this.T$g(this.Xnd);ha=this.V$g(this.Xnd);this.Ql=W.a.instance.ga(this.isRow?477:478);za=this.nN(za,ha);this.initializeAndShow(this.Ql,this.Yoj,za);x.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get pc(){return"ResizeHeadersDialog"}get u8a(){return sb.ade}set u8a(za){sb.ade=za}nN(za,ha){return{[sb.vV]:this.pc,[sb.Jti]:this.isRow,[sb.Qgi]:za,[sb.Pgi]:ha,[sb.vqi]:this.u8a,[sb.khd]:this.dxb}}p0g(){const za=this.EOh();try{return this.iTh(za)}finally{za&&
za.dispose()}}jbh(za){const ha={};ha.SheetMultiRange=L.r(this.gridView.ha.ra.selectedRanges,this.$);sb.xSd(ha,this.isRow,za);this.$.Xc(this.isRow?745189930:-445963340,F.a.Db,8,{["resizeRowColumnParameters"]:ha})}F8e(za,ha){return sa.a.E5(za)?ha?this.S$g(za):this.U$g(za):sb.Rba}U$g(za){return Math.floor(parseFloat(za))}S$g(za){za=parseFloat(za);return 0>za?sb.Rba:za?this.isRow?S.HelperMethods.V5i(za):this.Wvc.K6g(za):0}V$g(za){return za===sb.Rba?"":this.isRow?this.Wvc.PGe(za).toString():this.Wvc.FGe(za).toFixed(2)}T$g(za){return za===
sb.Rba?"":za.toString()}iTh(za){if(!za||!za.$$mn()||!za.ao)return sb.Rba;var ha=Object(ua.a)(216,za.ao);if(!ha)return sb.Rba;for(ha=this.isRow?ha.Dzb:ha.Vnd;za.$$mn();){const fb=Object(ua.a)(216,za.ao);if(fb&&(this.isRow?fb.Dzb:fb.Vnd)!==ha)return sb.Rba}return ha}EOh(){const za=[];for(const fb of this.gridView.ha.ra.selectedRanges){const rb=fb.clone();var ha=this.gridView.Af(this.gridView.ib.Li(rb));ha=rb.Ke(ha.ui);if(!ha)return null;this.isRow?rb.right=rb.left=ha.left:rb.top=rb.bottom=ha.top;za.push(rb)}return za.length?
this.gridView.laa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",za):null}lhd(za){if(!sa.a.E5(za))return 1;za=this.F8e(za,this.u8a);if(0===za)if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const ha=this.gridView.ha.ra.selectedRanges;if(this.gridView.Xd){if(!this.gridView.Xd.yAe(ha,this.isRow))return 3}else if(this.vlf())return 3}else if(this.vlf())return 3;return this.wwi(za)?0:2}vlf(){const za=this.gridView.ha.ra.selectedRanges;return this.isRow&&
L.P(za)||!this.isRow&&L.O(za)}Bed(za){let ha="";switch(za){case 0:ha="";break;case 1:ha=W.a.instance.ga(767);break;case 2:ha=String.format(W.a.instance.nb(99),0,this.jdc(this.u8a));break;case 3:ha=W.a.instance.ga(768)}return ha}wwi(za){return 0<=za&&za<=this.jdc(!1)}jdc(za){return this.Wvc.jdc(za,this.isRow)}static xSd(za,ha,fb){if(ha){za.ColumnWidth=sb.Rba;za.RowHeight=fb;for(const rb of za.SheetMultiRange.Ranges)rb.FirstColumn=0,rb.LastColumn=0}else{za.RowHeight=sb.Rba;za.ColumnWidth=fb;for(const rb of za.SheetMultiRange.Ranges)rb.FirstRow=
0,rb.LastRow=0}}}sb.vV="id";sb.Jti="isRow";sb.Qgi="initialSizeInPx";sb.Pgi="initialSizeInDefaultUnits";sb.vqi="isInitialUnitsDefaultUnits";sb.khd="getInputErrorIfInvalid";sb.EKj="size";sb.eoi="isDefaultUnits";sb.Rba=-1;sb.ade=!0;Object(u.a)(sb,"ResizeHeadersDialog",b.a,[]);var hb=a(60);const bb=(za,ha,fb,rb,pa,Ma,Ja=null)=>{Ja=za.Na(41,Ja);Ja.resizeRowColumnParameters=ha;return hb.g(za,"ResizeRowsColumns",Ja,fb,rb,pa,Ma,0)};var lb=a(343),Fa=a(288),Na=a(64),Mb=a(190),dc=a(29),Cb=a(345);class Tb{constructor(za,
ha,fb){this.yYi=(rb,pa)=>{if(!Z.a(rb)&&pa){const Ma=!!rb&&!!rb.RequestTelemetryData;Za.h(this.$).ji.gma(pa,rb.StateId,Ma?rb.RequestTelemetryData.EcsOperationDuration:0,Ma?rb.RequestTelemetryData.EcsRequestDuration:0,Ma?rb.RequestTelemetryData.WfeRequestDuration:0)}};this.EPi=(rb,pa)=>{pa&&pa.a2b&&pa.a2b.SheetName&&pa.a2b.Ranges.length&&pa.pni&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.bYd=pa.a2b.Ranges[0],this.HV()?this.SEe(this.bYd):
this.grid.LZa(this.R6))};this.R6=()=>{this.HV()&&(this.grid.Fcb(this.R6),this.SEe(this.bYd))};this.$=za;this.zg=ha;this.gridInstantaneousAction=fb;this.grid=Za.h(this.$);this.bYd=null}nc(za,ha){za=!0;switch(ha){case -445963340:case 1391094586:za=this.Td(8);break;case 745189930:case 146338636:za=this.Td(16)}return!za}executeCommand(za,ha,fb){var rb=Za.h(this.$);const pa=ha.command;var Ma=qa.a.create().toString();let Ja=wa.TaskExtensions.Rj();switch(pa){case 1391094586:case 146338636:za=1391094586===
pa;(Ma=fb.autoFitRanges)&&Ma.Ranges&&Ma.Ranges.length||(Ma=L.r(rb.ha.ra.selectedRanges,this.$));Ja=this.Noh(za?1:0,Ma,ha);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:za=-445963340===pa||-706918724===pa||369708605===pa;if(-445963340===pa||745189930===pa){var Ga=aa.a(ha.command);rb.ji.g8(16,Ma,Ga);rb=fb.resizeRowColumnParameters}else{fb=rb.ha.ra.selectedRanges;let nb=0;for(var La of fb)if(-706918724===pa||369708605===pa){const Lb=La.right-La.left+
1;nb+=0<Lb?Lb:-1*Lb}else if(1542466017===pa||1051390410===pa)nb+=La.bottom-La.top+1;369708605===pa||1542466017===pa?x.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${nb}`):(-706918724===pa||1051390410===pa)&&x.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${nb}`);if(!J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)||!rb.Xd){if(-706918724===pa&&6===ha.$e&&L.O(fb)){x.ULS.sendTraceTag(537154007,
0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===pa&&6===ha.$e&&L.P(fb)){x.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}La=369708605===pa||1542466017===pa?-2:0;rb={};rb.SheetMultiRange=L.r(fb,this.$);if(za)for(Ga of rb.SheetMultiRange.Ranges)Ga.FirstRow=0,Ga.LastRow=0;else for(const Lb of rb.SheetMultiRange.Ranges)Lb.FirstColumn=
0,Lb.LastColumn=0;rb.RowHeight=za?-1:La;rb.ColumnWidth=za?La:-1}Ja=this.gph(rb,ha,Ma,za);break;case 957527587:case 2040891415:new sb(this.$,ha)}return Ja}SEe(za){if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const ha=Na.d(this.$.xa.na),fb=new lb.a(L.B(za),ha);wa.TaskExtensions.Aa(Oa.GetServiceTaskFactory.Oa(this.$.da,426,427,1),rb=>{void rb.result.OCc(fb,"ColumnAutoFit")},this.$.la,3)}}wc(za,ha,fb,rb){if(za=!!fb&&!!rb&&1===rb.pz)switch(ha.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:za=!1}return za}Jc(){return!1}PCi(za){x.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Fa.c)(za)}. Reason: ${Object(Fa.c)(za)?void 0:za.reason}.`)}Td(za){return(new X.a(this.$.xa)).Td(za)}HV(){return this.grid.Ea.HN(4,this.$.na)}Noh(za,ha,fb){const rb=this.$.pa.ya.Wb(),pa=0===za,Ma=()=>new xa(pa,ha);return ia.a(this.$.userOperationManager,(Ja,Ga,La)=>{var nb=this.$.pa.ya;Ja=la.b(Ja,this.EPi);var Lb={pni:!pa,a2b:ha};const ac=
nb.Na(41,rb);ac.isRow=pa;ac.autoFitRanges=ha;return hb.g(nb,"AutoFit",ac,Ja,Ga,La,Lb,0)},Ja=>new Ha.a(135,0,Ja,void 0,Ma),fb)}gph(za,ha,fb,rb){const pa=ha.command,Ma=Za.h(this.$),Ja=L.g(za.SheetMultiRange.Ranges);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){var Ga=-706918724===pa||-445963340===pa&&0===za.ColumnWidth;if((1051390410===pa||745189930===pa&&0===za.RowHeight||Ga)&&null!=Ma.Xd&&!Ma.Xd.yAe(Ja,!rb))return this.Wnh(rb),wa.TaskExtensions.Rj()}let La;Ga=
J.EwaSettings.$if()&&-706918724===pa;if(745189930===pa||-445963340===pa||Ga)x.ULS.shipAssertTag(537154002,0,this.$.activeItemName===za.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Ga?Object(Mb.c)(()=>{},this.$.la,0):(La=this.zg.SIj(Ma,Ja,rb?za.ColumnWidth:za.RowHeight,!rb),this.PCi(La),Object(Fa.c)(La)&&Ma.ji.yS(fb,Xa.BasicTelemetryCalculator.cR));const nb=this.$.pa.ya.Wb({Dca:!0,Nba:3});rb=(ac,ib,Ra)=>{this.$.Qy();L.i(Ja,",",this.$,!1);return bb(this.$.pa.ya,
za,la.b(ac,this.yYi),ib,Ra,fb,nb)};const Lb=()=>new fa(za);return La&&Object(Fa.c)(La)?ia.a(this.$.userOperationManager,rb,ac=>new Ha.a(136,0,ac,64,Lb),ha):ia.a(this.$.userOperationManager,rb,ac=>new Ha.a(136,0,ac,void 0,Lb),ha)}Wnh(za){za=dc.a.Zc(1,0,za?769:771,za?770:772,0,za?-2037763134:503471870,za?"HideAllColumnsError":"HideAllRowsError");new Cb.a(this.$,za)}}Object(u.a)(Tb,"ResizeCommandHandler",null,[165]);class Jb extends Ka.a{constructor(za){super(za)}nd(){const za=Oa.GetServiceTaskFactory.create(this.$.da,
18,this.la,this.Ya);let ha;ha=J.EwaSettings.$if?Oa.GetServiceTaskFactory.Oa(this.$.da,528,529,this.Ya):ka.Task.Ta(null);wa.TaskExtensions.Aa(za,()=>{this.Yc([new Tb(this.$,za.result,ha.result)])},this.la,3)}static ka(za){Ka.a.Nd(113,new Jb(za))}}Object(u.a)(Jb,"ResizeCommandHandlerFactory",Ka.a,[]);a.d(D,"a",function(){return eb});const eb=()=>{c.a.Fa(za=>{Ba.ka(za);Jb.ka(za)})}},1177:function(u,D,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.jA(P,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}W8c(P){this.jA(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[241]);var e=a(15),f=a(157);class d{h0e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const P=new f.a;P.setResult("api.onedrive.com");return P.task}}Object(u.a)(d,"OneDriveConsumerEndpointHelper",null,[226]);var h=a(84),m=a(54),l=a(374),v=a(228);class t{constructor(P,
G,C,H){this.pFa=this.Q6=null;this.XSc=this.ZSc=!1;this.ZXa=null;this.mb=P;this.uSb=G;this.WEa=C;this.dt=H}get vue(){return this.uSb}get fa(){return this.mb}n5a(){this.ZXa||(this.ZXa=this.Cab?v.a.create(this.Cab,null,null,null,!1):null);return this.ZXa}setup(P){this.pFa=P;this.ZSc||this.XSc?this.ZSc&&this.pFa&&this.pFa(!0):(P=this.n5a())?(this.XSc=!0,P.v9a.continueWith(G=>{this.oXi(G)}),l.a.bja(P)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),
this.pFa(!1))}ODd(P){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.")}oXi(P){this.XSc=!1;if(P.Wf)this.ODd(P),this.pFa(!1);else try{this.ZSc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.bod(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.pFa(!0)}catch(G){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",G.toString()),this.pFa(!1)}}startPicker(P){this.Q6=
P;this.WEa?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.iCd,"onApiReady")))}iCd(P){P?this.zlc():this.vj()}vj(){this.dt().displayError(m.a.N1i)}onSuccess(P){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Q6&&this.Q6(!0,P)}dispose(){this.ZXa&&this.ZXa.dispose()}}Object(u.a)(t,"AOneDriveFilePickerApiManager",
null,[67,2]);class z extends t{constructor(P,G,C,H,J,M){super(G,C,H,M);this.Kh=null;this.v2=P;this.bEg=J}get Cab(){return this.fa.Xa("OneDriveApiUrl")}start(P,G){this.Kh=P;this.startPicker(G)}bod(){WL.init(1===this.vue||2===this.vue?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(P){this.Q6=P;!this.WEa&&this.v2.dNa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),
this.setup(Object(h.a)(this,this.iCd,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.bEg())}zlc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Kh).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.P6,"onFailure"))}catch(P){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",P,P.stack),this.vj()}}P6(P){if(P&&P.error){if("user_canceled"===P.error.code){e.ULS.sendTraceTag(17909058,
352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",P.error.code,P.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.Q6&&this.Q6(!1,P);this.vj()}}Object(u.a)(z,"OneDriveFilePickerApiManagerV5",t,[]);class r extends t{constructor(P,G,C,H,J){super(P,G,C,H);this.PUb=this.Nge=null;this.ewg=J;this.options={};this.options.clientId=this.fa.Xa("OneDriveApiV7ClientId");this.options.cancel=
Object(h.a)(this,this.uCc,"toggleHostDivVisibility")}get Cab(){return this.fa.Xa("OneDriveApiV72Url")}start(P,G){this.PUb=G;const C=this.ewg.h0e();C.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Nge=C.result;this.startPicker((H,J)=>{this.uCc();P(H,J)})},3);C.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,C.exception.message);this.uCc()},5)}bod(){this.options.success=P=>{const G={};G.data=P;this.onSuccess(G)};this.options.error=
P=>{const G={};G.error=P;this.P6(G)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Nge;this.options.advanced.iframeParentDiv=this.PUb}zlc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.uCc(),OneDrive.open(this.options)}catch(P){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",P.message),this.vj()}}P6(P){this.Q6&&this.Q6(!1,P);this.vj()}uCc(){this.PUb.style.visibility=
"hidden"===this.PUb.style.visibility?"":"hidden"}}Object(u.a)(r,"OneDriveFilePickerApiManagerV7",t,[]);class n extends t{constructor(P,G,C,H){super(P,G,C,H);this.Zsg=P;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Xa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Cab(){return this.fa.Xa("OneDriveApiV72Url")}start(P,G,C,H){this.options.advanced.iframeParentDiv=C;this.options.advanced.endpointHint=H;this.options.cancel=G;this.Zsg.qa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(P)}startPicker(P){this.Q6=P;this.WEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.iCd,"onApiReady")))}bod(){this.options.success=
P=>{const G={};G.data=P;this.onSuccess(G)};this.options.error=P=>{const G={};G.error=P;this.P6(G)}}zlc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(P){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,P.stack),this.vj()}}ODd(P){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",P.exception?P.exception.toString():"No error detail.");l.a.pij(this.Cab);
this.ZXa=null}vj(){this.dt().W8c(m.a.Wrj)}P6(P){this.Q6&&this.Q6(!1,P)}}Object(u.a)(n,"OneDriveFilePickerApiManagerV72",t,[]);class w{constructor(P){this.olsSessionId=this.value=this.key=null;this.olsSessionId=P}}Object(u.a)(w,"IExtraData",null,[]);var B=a(4);class A extends n{constructor(P,G,C,H){super(P,G,C,H);this.options.advanced.filter=P.Xa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=B.AFrameworkApplication.Eue;P.qa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=P.Xa("OneDriveApiV72CommandMode")||"none");P.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new w(B.AFrameworkApplication.userSessionId))}get Cab(){return this.fa.Xa("OneDriveApiV72Url")}zlc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",B.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(P){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",P.message,P.stack),this.vj()}}}Object(u.a)(A,"OneDriveFilePickerApiOpenManagerV72",n,[]);var y=a(240);class x{constructor(P){this.vk=null;this.yh=P;this.$Rc=3}h0e(){this.vk=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.MQd();return this.vk.task}MQd(P=null){const G=
String.format("GetMoreInfoHandler.ashx?{0}",B.AFrameworkApplication.XIa);this.yh.iha(G,1,null,P,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.QZh,"getMoreInfoSucceeded"),Object(h.a)(this,this.OZh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}OZh(P){if(P.data.httpStatus===y.a.hIb&&"X-NewKey"in P.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const G={};G["X-Key"]=P.data.responseHeaders["X-NewKey"];
this.MQd(G)}else 0<this.$Rc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.$Rc),this.$Rc--,this.MQd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.vk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}QZh(P){"PersonalFileStorageUrl"in P.data.responseHeaders&&""!==P.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.vk.setResult(P.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.vk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(u.a)(x,"OneDriveForBusinessEndpointHelper",null,[226]);var F=a(248),I=a(559);class L{constructor(){this.gb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Vh(P){this.gb=
P;this.gb.register(z,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").xc().Fc(()=>new z(I.a.instance,B.AFrameworkApplication.fa,B.AFrameworkApplication.l3a,B.AFrameworkApplication.limitedEdit,B.AFrameworkApplication.u9f,()=>new b));B.AFrameworkApplication.lmf?this.gb.register(226,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>new d):this.gb.register(226,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").xc().Fc(()=>
new x(B.AFrameworkApplication.Bd));this.gb.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").xc().Fc(()=>new r(B.AFrameworkApplication.fa,B.AFrameworkApplication.l3a,B.AFrameworkApplication.limitedEdit,()=>new b,this.gb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.gb.register(n,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").xc().Fc(()=>new n(B.AFrameworkApplication.fa,B.AFrameworkApplication.l3a,B.AFrameworkApplication.limitedEdit,
()=>new b));this.gb.register(A,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").xc().Fc(()=>new A(B.AFrameworkApplication.fa,B.AFrameworkApplication.l3a,B.AFrameworkApplication.limitedEdit,()=>new b))}static main(){F.a.instance.Ei(new L)}}Object(u.a)(L,"PackageManager",null,[4,5]);a.d(D,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");L.main()}},1184:function(u,D,a){u=a(0);var c=a(84),b=a(15),e=a(134),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(W,
O){super();this.$Xa=!1;this.JA=null;this.La=W;this.njb=O;this.CTa=!1}displayError(W,O,T){this.JA=O;this.$Xa=T;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",W,T);W=this.k2c(W);0===W?(this.Rb=6,this.oc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.oc(1,CommonUIStrings.l_DialogClose));0===W&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.jA(f.a.Vrj,this.bgd(W),this.cUh(W,O),Object(c.a)(this,this.ROd,"retryDialogHandler"),!0)}ROd(W){1===
W?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.JA?this.La.ae(d.a.wLb,2,[this.JA,this.$Xa]):this.La.processAction(d.a.wLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}k2c(W){return 0>W||6<W?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",W),0):W}cUh(W,O){W=this.k2c(W);return this.njb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][W]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][W]}bgd(W){W=this.k2c(W);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][W]}}Object(u.a)(h,"ErrorRetryDialog",e.StandardDialog,[632]);class m{constructor(W,O){this.mb=W;this.La=O;this.njb=this.mb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.La,this.njb)}}Object(u.a)(m,"ErrorRetryDialogFactory",null,[612]);e=a(1050);var l=a(146);class v{static get ng(){return l.a.iq(v.pl,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}v.pl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(u.a)(v,"FileNameDialogHtml",null,[]);var t=a(4),z=a(30);class r extends e.a{constructor(W,O,T,Y,va,ca){super(W,O,T,Y,va,ca);this.ng=v.ng;this.Ee="FileNameDialog-SaveAsToHost"}wQ(W,O){const T=z.a.Sq(t.AFrameworkApplication.um.un);O={["txtFileName"]:W||T,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:O};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.nac,"fileNameDialogHandler"),O);this.QMe(W,T)}}Object(u.a)(r,"FileNameDialog",e.a,[631]);class n{constructor(W,
O,T,Y,va,ca){this.La=O;this.mb=W;this.PX=Y;this.Xga=ca;this.dt=va;this.ef=T}create(){return new r(this.mb,this.La,this.ef,this.PX,this.dt,this.Xga)}}Object(u.a)(n,"FileNameDialogFactory",null,[611]);var w=a(641),B=a(105);class A{constructor(W,O,T){this.Xga=T;this.GKc=O;this.mb=W}Fg(){2===t.AFrameworkApplication.sa.Pa.Fj?t.AFrameworkApplication.ub.Me(d.a.wLb,B.a.frame,Object(c.a)(this,this.O_f,"saveAsToHostActionDispatcher"),4):t.AFrameworkApplication.ub.Mb(d.a.wLb,B.a.frame,Object(c.a)(this,this.O_f,
"saveAsToHostActionDispatcher"))}O_f(W,O,T,Y,va){return O.contextId!==B.a.frame||W!==d.a.wLb?2:this.mb.qa("SaveAsToHostBrsIsEnabled")?1===T?w.SessionStatusManager.instance.c6a||t.AFrameworkApplication.y5?8:32:2===T?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),W=this.GKc.create(),va&&Object.getType(va)===Array&&2===va.length?W.wQ(va[0],!!va[1]):W.wQ(null,!1),32):8:8}}Object(u.a)(A,"SaveAsToHostActor",null,[]);var y=a(41),x=a(80),F=a(40),I=a(240),L=a(373),
X=a(164),P=a(642),G=a(766);class C{constructor(W,O,T,Y,va,ca,V,ra){this.Pm=null;this.$Xa=this.pEa=!1;this.Wga=this.Kh=this.JA=null;this.mb=O;this.oGa=this.mb.appSettings.SaveAsToHostWebServiceBase;this.Nbe=Y;this.Wlb=va;this.yh=T;this.dt=ca;this.Bh=ra;this.ef=V;this.La=W;this.Xfa=O.Xa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}XNb(){1!==this.ef.state&&(this.Pm=this.Wlb(),this.Pm.message=CommonUIStrings.l_CommentProgressTooltip,this.Pm.Rb=5,this.Pm.Jt=!1,this.Pm.LBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}vS(W=0){1!==this.ef.state&&this.dt.create().displayError(W,z.a.Sq(this.JA),this.$Xa)}fRa(){const W=this.mb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");F.a.lf(W,F.a.FX(3),void 0,"UploadToHostManager.RedirectToFolder")}eRa(W){let O=!1,T=!1;this.mb&&(O=this.mb.qa("SaveACopyIsEnabledForUiHost"),T=this.mb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
W,O,T);if(O&&T){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Y={};Y[L.a.$Qa]="1";Y[L.a.documentUrl]=W;Y[L.a.reason]=P.a.saveAs;t.AFrameworkApplication.nV().execute(va=>{va.Oj(X.a.Eua,Y)})}else O&&!T&&t.AFrameworkApplication.$ba?F.a.lf(W,F.a.FX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):F.a.lf(W,F.a.FX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Hoa(W,O,T=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.Nbe&&!this.Nbe()&&this.yh&&(this.Bh&&(this.Wga=this.Bh.Ac("DialogShown","SaveAsToHostUploadTime")),this.XNb(),this.$Xa=O,this.JA=W,(this.Kh=T)&&"true"===this.Kh.SkipSaveToHost?this.L$b():this.CQ())}CQ(){32!==this.La.processAction(d.a.lSa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.L$b()):this.La.ae(d.a.lSa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.L$b()},(W,
O)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.vS(O)}])}U0i(W){this.CJa();this.pEa=!1;if(W&&W.data&&W.data.te)if(({At:O}=y.d(W.data.te)).returnValue)if(W=O,W.StatusCode!==I.a.mP&&W.StatusCode!==I.a.Ssb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var O={};O.FailureReason=W.StatusCode.toString();O.ExtraInfo=W.ExtraInfo;this.Uda(O);this.vS(parseInt(W.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.ENd();try{W.NewDocumentUrl&&""!==W.NewDocumentUrl?this.eRa(W.NewDocumentUrl):this.fRa()}catch(T){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",T.toString())}this.PHb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:G.a.igb(W.data.te)}),this.Uda({["FailureReason"]:"Failed to deserialize response"}),this.vS();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Uda({["FailureReason"]:"null response"}),this.vS()}T0i(W){5!==W.data.status&&12!==W.data.status||this.pEa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:W.data.status,["HttpStatus"]:W.data.httpStatus}),this.Uda({["FailureReason"]:W.data.httpStatus.toString()}),this.CJa(),this.vS(),this.PHb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.pEa=!0,this.Kh&&"true"===this.Kh.SkipSaveToHost?this.L$b():
this.CQ())}CJa(){this.Pm&&(this.Pm.close(),this.Pm=null)}PHb(){this.Wga&&(this.Wga.stop(),this.Wga=null)}ENd(){this.Kh&&"VersionHistory"===this.Kh.SaveEntryPoint&&this.La.processAction(d.a.Kvc,2)}Uda(W){this.Kh&&"VersionHistory"===this.Kh.SaveEntryPoint&&this.La.ae(d.a.GNd,2,W)}L$b(){let W=this.oGa+this.Xfa;W=x.a.Ol(W,"qs",z.a.mf(t.AFrameworkApplication.Zi));W=x.a.Ol(W,"n",z.a.mf((new Date).getTime().toString()));W=x.a.Ol(W,"ov",z.a.mf(this.$Xa.toString()));W=x.a.Ol(W,"fn",z.a.mf(this.JA));this.Kh&&
this.Kh.FileDownloadUrl&&(W=x.a.Ol(W,"furl",z.a.mf(this.Kh.FileDownloadUrl)));this.yh.Rm(W,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.U0i,"onUploadFinished"),Object(c.a)(this,this.T0i,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(u.a)(C,"UploadToHostManager",null,[539]);var H=a(248),J=a(783);class M{constructor(){this.gb=null}get name(){return"Common.App.SaveAsToHost"}init(){t.AFrameworkApplication.fa.Fv(Object(c.a)(this,this.NB,"onFullAppSettingsReady"))}NB(){t.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.gb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Fg()}Vh(W){this.gb=W;this.gb.register(m,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(()=>new m(t.AFrameworkApplication.fa,t.AFrameworkApplication.ub)).xc();this.gb.register(C,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(()=>new C(t.AFrameworkApplication.ub,t.AFrameworkApplication.fa,t.AFrameworkApplication.Bd,()=>t.AFrameworkApplication.Lg,
()=>(new J.a).create(),W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.AFrameworkApplication.sa,t.AFrameworkApplication.sa.mE)).xc();this.gb.register(n,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(()=>new n(t.AFrameworkApplication.fa,t.AFrameworkApplication.ub,t.AFrameworkApplication.sa,t.AFrameworkApplication.sa.Pa,W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),W.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc();
this.gb.register(A,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(()=>new A(t.AFrameworkApplication.fa,W.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),W.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).xc()}dispose(){}static main(){H.a.instance.Ei(new M)}}Object(u.a)(M,"SaveAsToHostPackage",null,[4,5]);a.d(D,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveAsToHost");M.main()}},1185:function(u,D,a){u=a(0);var c=a(84),b=a(15),e=a(146);class f{static get ng(){return e.a.iq(f.pl,
CommonUIStrings.l_SaveACopyFileName)}}f.pl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(u.a)(f,"FileNameDialogHtml",null,[]);var d=a(4),h=a(30);class m extends e.a{constructor(G,C,H,J){super();this.CUb=
this.j9=null;this.La=G;this.PX=C;this.qnb=H;this.oc(1,CommonUIStrings.l_SaveButtonLabel);this.ng=f.ng;this.Ee="FileNameDialog-SaveACopy";this.Kh=J}wQ(G,C,H){this.CUb=G;this.j9=H;G={["txtFileName"]:h.a.Sq(d.AFrameworkApplication.um.un),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,C)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.nac,"fileNameDialogHandler"),G);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}nac(G,C){1!==G?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=C.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),C=h.a.I4(d.AFrameworkApplication.fileName),G&&""!==G&&""!==C&&(G+=C),this.qnb.Hoa(this.CUb,this.j9,G,this.Kh))}}Object(u.a)(m,"FileNameDialog",e.a,[641]);class l{constructor(G,C,H){this.La=G;this.PX=C;this.qnb=H}create(G){return new m(this.La,
this.PX,this.qnb,G)}}Object(u.a)(l,"FileNameDialogFactory",null,[626]);var v=a(134),t=a(25);class z extends v.StandardDialog{constructor(G){super();this.Rb=1;this.oc(1,CommonUIStrings.l_RetryButtonLabel);this.oc(0,CommonUIStrings.l_DialogClose);this.La=G}displayError(G){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.jA(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.ROd,"retryDialogHandler"))}ROd(G){1===G?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(t.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(u.a)(z,"RetryDialog",v.StandardDialog,[625]);v=a(1051);var r=a(834),n=a(374),w=a(105);class B extends v.a{constructor(G,C,H,J){super(G,C,H,J);this.hBg=C}C8a(){return this.mb.qa("SaveACopyBrsIsEnabled")}N_e(){return t.a.saveACopy}i3b(){n.a.VKd(Object(c.a)(this,this.f0f,"saveToCloudActionDispatcher"));n.a.y$c([new r.a(t.a.saveACopy,w.a.frame,0)],
this.hBg.n5a())}mSf(){b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(u.a)(B,"SaveACopyActor",v.a,[]);v=a(1054);class A extends v.a{constructor(G,C,H,J,M,S,W){super(C,H,J,M,S,W);this.Fwg=G}onSuccess(G){G&&G.data&&G.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Fwg.create(this.Kh).wQ(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,
10,"Fail to select folder to upload file."),this.vj())}P6(G){G&&G.error&&"user_canceled"===G.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.P6(G)}vj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.vj()}}Object(u.a)(A,"SaveACopyManager",v.a,[]);var y=a(1052);class x extends y.a{constructor(G,C,H,J,M,S){super(C,H,J,M,S);this.La=G}Rsd(){return!!this.Kh&&!!this.Kh.SaveEntryPoint&&"VersionHistory"===this.Kh.SaveEntryPoint.toString()}vS(){b.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.Rsd()&&this.La.ae(t.a.GNd,2,{["FailureReason"]:"Unknown"});super.vS()}fRa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Rsd()&&this.La.processAction(t.a.Kvc,2);super.fRa()}eRa(G){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",G);this.Rsd()&&this.La.processAction(t.a.Kvc,2);super.eRa(G)}CQ(){this.Kh&&"true"===this.Kh.SkipSaveToHost?super.CQ():32!==this.La.processAction(t.a.lSa,
1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.CQ()):this.La.ae(t.a.lSa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");y.a.prototype.CQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.vS()}])}}Object(u.a)(x,"SaveACopyUploadToCloudManager",y.a,[]);var F=a(248),I=a(559),L=a(783);class X{constructor(){this.gb=
null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.Fv(Object(c.a)(this,this.NB,"onFullAppSettingsReady"))}NB(){d.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.gb.resolve("Common.App.SaveACopy.SaveACopyActor").Fg()}dispose(){}Vh(G){this.gb=G;this.gb.register(x,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(()=>new x(d.AFrameworkApplication.ub,G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new L.a).create(),()=>new z(d.AFrameworkApplication.ub),
d.AFrameworkApplication.sa,d.AFrameworkApplication.sa.mE)).xc();this.gb.register(l,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(()=>new l(d.AFrameworkApplication.ub,d.AFrameworkApplication.sa.Pa,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).xc();this.gb.register(B,"Common.App.SaveACopy.SaveACopyActor").Fc(()=>new B(G.resolve("Common.App.SaveACopy.SaveACopyManager"),G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.mE)).xc();this.gb.register(A,"Common.App.SaveACopy.SaveACopyManager").Fc(()=>new A(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),I.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.l3a,()=>new z(d.AFrameworkApplication.ub))).xc()}static main(){F.a.instance.Ei(new X)}}Object(u.a)(X,"PackageManager",
null,[4,5]);a.d(D,"a",function(){return P});const P=()=>{Type.registerNamespace("Common.App.SaveACopy");X.main()}},1186:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(30),d=a(82),h=a(242),m=a(36);class l extends h.a{constructor(H,J,M){super(H,J);this.hGd=this.executionContext=null;this.w4i=(S,W)=>{this.HHb(S,W)};this.lK=M}initialize(H){super.initialize(H)}execute(H){this.executionContext=H;H=Object(d.a)(7,this.executionContext.Fe);this.Jsb(H);return 1}hJ(H){super.hJ(H)}Jsb(){this.subscribe(this.executionContext,
this.w4i,H=>{this.hGd.add_disposing(H)})}HHb(H){this.unsubscribe(J=>{H.remove_disposing(J)});this.executionContext.activityState[m.a.N2]=0}}Object(u.a)(l,"PasswordProtectedFileActivity",h.a,[]);var v=a(284),t=a(261),z=a(13);class r extends v.a{constructor(H){super(H);this.tqa=0;this.Kcj=(J,M)=>{this.Zbb(J,M)};this.A2d=(J,M)=>{this.nVa(J,M)}}get pc(){return"PasswordDialog"}get Etb(){return this.tqa}get Ql(){return z.a.instance.ga(1972)}Zbb(H){this.tqa=H}P3(){const H={};H[v.a.description]=z.a.instance.ga(1973);
H[v.a.i7]=z.a.instance.ga(1969);H[v.a.BLf]=z.a.instance.ga(1991);H[v.a.zLf]=z.a.instance.ga(1992);H[v.a.ALf]=z.a.instance.ga(1970);H[v.a.Cnd]=z.a.instance.ga(1976);H[v.a.cxe]=z.a.instance.ga(1659);H[v.a.D3j]=z.a.instance.Ua(25);H[v.a.clg]=this.A2d;return H}Tta(){const H={};H[t.a.vu]=this.pc;H[v.a.c0a]=this.P3();return H}dg(){this.Rb=1;this.initializeAndShow(this.Ql,this.Kcj,this.Tta())}}Object(u.a)(r,"PasswordProtectedFilePasswordInputDialog",v.a,[]);var n=a(60),w=a(29),B=a(282),A=a(51);class y extends r{constructor(H){super(H);
this.MOd=5;this.Jce=!1;this.passwordToModify=null;this.CLf=()=>{this.$.isEditMode&&this.ljc&&(A.b().w$c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Kl(this.CLf))};this.dg();this.$.nl(this.CLf)}get ljc(){return this.Jce}get Ql(){return z.a.instance.ga(1974)}Zbb(H,J){super.Zbb(H,J);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${H}`)}nVa(H,J){this.passwordToModify=H;const M={};M.FileModifyPassword=
f.a.mf(H);n.M(this.$.pa.ya,M,this.Z0i(J),this.Y0i(J),null,null)}P3(){const H=super.P3();H[v.a.Cnd]=z.a.instance.ga(1977);H[v.a.description]=z.a.instance.Ua(24);return H}dg(){A.b().w$c("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.dg()}Z0i(H){return J=>{w.a.ah(J.Errors,[-2019873242])&&this.z8b(this.zsb());if(!J||B.a(J))if(0<this.MOd)this.QQf(H);else{e.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${w.a.sc(J.Errors)}`);this.$.ea.Qo(J.Errors);this.hide();return}this.Jce=J.Result;this.ljc&&(A.b().gXd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
H(this.ljc?0:1)}}Y0i(H){return()=>{0<this.MOd?this.QQf(H):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),H(3))}}QQf(H){--this.MOd;this.nVa(this.passwordToModify,H)}zsb(){return w.a.Zc(1,0,1658,1659,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(u.a)(y,"PasswordProtectedFileModifyPasswordInputDialog",r,[]);var x=a(6);class F extends l{constructor(H,J,M){super(H,J,M)}Jsb(H){this.hGd=
new y(H);super.Jsb(H)}HHb(H,J){const M=H.Etb,S=H.ljc,W=H.passwordToModify;super.HHb(H,J);this.executionContext.Qya([2001366804]);switch(M){case 1:S?(J=Object(d.a)(7,this.executionContext.Fe),this.executionContext.activityState[m.a.bpe]=f.a.mf(W),this.executionContext.activityState[m.a.zGa]=!0,H.passwordToModify="",this.hh(J.isEditMode?x.a.Hj:this.dK)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Kp();break;case 0:this.executionContext.activityState[m.a.cs]=!1;this.hh(this.lK);this.Kp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${M}'`)}}}Object(u.a)(F,"PasswordProtectedFileModifyActivity",l,[]);class I extends b.a{constructor(H,J,M,S){super();this.activityName=H;this.dK=J;this.lK=M;this.$=S;this.Fb()}create(){this.ob(new F(this.activityName,this.dK,this.lK))}static ka(H){H.da.Ga(434,new I(x.a.GHb,
x.a.cgb,x.a.Brb,H))}}Object(u.a)(I,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var L=a(44);class X extends r{constructor(H,J){super(H);this.password=null;this.xnf=J;this.dg()}nVa(H,J){this.password=H;J(0)}P3(){const H=super.P3();this.xnf&&(H[v.a.Nth]=1);return H}dg(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.xnf}`);super.dg();L.a(this.$).kte()}}Object(u.a)(X,"PasswordProtectedFileOpenPasswordInputDialog",
r,[]);class P extends l{constructor(H,J,M){super(H,J,M)}Jsb(H){const J=w.a.ah(this.executionContext.errors,[1217361942]);this.hGd=new X(H,J);H.nhc||H.wMe();super.Jsb(H)}HHb(H,J){let M,S;M=H.password;H.password="";S=H.Etb;super.HHb(H,J);this.executionContext.activityState[m.a.nWc]=f.a.mf(M);this.executionContext.activityState[m.a.zGa]=!0;this.executionContext.Qya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${S}`);
switch(S){case 1:this.hh(this.dK);this.Kp();break;case 0:this.hh(this.lK),this.Kp()}}}Object(u.a)(P,"PasswordProtectedFileOpenActivity",l,[]);class G extends b.a{constructor(H,J,M,S){super();this.activityName=H;this.dK=J;this.lK=M;this.$=S;this.Fb()}create(){this.ob(new P(this.activityName,this.dK,this.lK))}static ka(H){H.da.Ga(386,new G(x.a.Hrc,x.a.Hj,x.a.Uj,H))}}Object(u.a)(G,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(D,"a",function(){return C});const C=()=>{c.a.Fa(G.ka);c.a.Fa(I.ka)}},
1193:function(u,D,a){u=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose)}displayError(P){this.jA(P,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(u.a)(b,"ErrorDialog",c.StandardDialog,[625]);var e=a(1054),f=a(1051),d=a(15),h=a(84),m=a(4),l=a(252),v=a(40),t=a(25);class z extends c.StandardDialog{constructor(P,G,C){super();this.La=P;this.v2=G;this.PX=C;this.cw=!1;this.Rb=1;this.V0(1);
this.oc(1,CommonUIStrings.l_SignIn);this.oc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}wQ(){this.v2.GZa(Object(h.a)(this,this.qIf,"onSignIn"));this.$l(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.gji,"inputHandler"))}gji(P){0===P?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.h7()}q3g(){let P="2";if(this.PX)switch(this.PX.Fj){case 3:P="0";break;case 2:P="3";break;case 1:P="1"}return P}hide(){this.v2.XJb(Object(h.a)(this,
this.qIf,"onSignIn"));super.hide()}h7(){const P=new l.QueryStringBuilder("Signin.aspx");P.Xi("prompt","1");P.Xi("cbcxt",this.q3g());m.AFrameworkApplication.xZa(P);v.a.lf(P.toString(),"LoginWindow",void 0,"SignInDialog")}qIf(){this.Jn&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(t.a.saveToCloudStorage,2)}}Object(u.a)(z,"SignInDialog",c.StandardDialog,[639]);class r{constructor(P,G,C){this.La=P;this.v2=
G;this.PX=C}create(){return new z(this.La,this.v2,this.PX)}}Object(u.a)(r,"SignInDialogFactory",null,[622]);var n=a(80),w=a(30);class B{constructor(P,G,C,H,J,M,S){this.oGa=P;this.JA=G;this.RWa=C;this.CUb=H;this.xRc=J;this.Xfa=M;this.Kh=S}execute(P,G){if(!m.AFrameworkApplication.Lg&&m.AFrameworkApplication.Bd){var C=this.oGa+this.Xfa;C=n.a.Ol(C,"fo",w.a.mf(this.CUb));C=n.a.Ol(C,"fn",w.a.mf(this.JA));C=n.a.Ol(C,"qs",w.a.mf(this.xRc));C=n.a.Ol(C,"n",w.a.mf((new Date).getTime().toString()));this.Kh&&
this.Kh.FileDownloadUrl&&(C=n.a.Ol(C,"furl",w.a.mf(this.Kh.FileDownloadUrl)));this.RWa&&(C=n.a.Ol(C,"fnn",w.a.mf(this.RWa)));m.AFrameworkApplication.Bd.Rm(C,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,P,G,null)}}}Object(u.a)(B,"SkyDriveUploadCaller",null,[638]);class A{constructor(P){this.mb=P;this.pGa=P.appSettings.SkyDriveUploadWebServiceBase;this.JA=P.appSettings.FileName;this.Xfa=P.Xa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(P,G,C){return new B(this.pGa,this.JA,
G,P,m.AFrameworkApplication.Zi,this.Xfa,C)}}Object(u.a)(A,"SkydriveUploadCallerFactory",null,[621]);var y=a(1052),x=a(248),F=a(559),I=a(783);class L{constructor(){this.gb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.gb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fg()}dispose(){}Vh(P){this.gb=P;this.gb.register(r,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(()=>
new r(m.AFrameworkApplication.ub,F.a.instance,m.AFrameworkApplication.sa.Pa)).xc();this.gb.register(A,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(()=>new A(m.AFrameworkApplication.fa)).xc();this.gb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(()=>new f.a(P.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),P.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.sa.mE)).xc();this.gb.register(y.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(()=>new y.a(P.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new I.a).create(),()=>new b,m.AFrameworkApplication.sa,m.AFrameworkApplication.sa.mE)).xc();this.gb.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(()=>new e.a(P.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),F.a.instance,P.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.l3a,()=>new b)).xc()}static main(){x.a.instance.Ei(new L)}}Object(u.a)(L,"PackageManager",null,[4,5]);a.d(D,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");L.main()}},1194:function(u,D,a){u=a(0);var c=a(84),b=a(15),e=a(4),f=a(54),d=a(418),h=a(83);class m{constructor(y,x,F,I){this.mPc=null;this.LTb=I;this.iY=y;this.jY=x;this.sE=F;this.Wke=this.buf.EFj;y=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.qAg=y[0];this.pAg=y[1]}get buf(){return this.mPc||(this.mPc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Vwa(){return CommonUIStrings.l_OICErrorHelpLink}get xzc(){return this.Wke}get duf(){return this.qAg}get cuf(){return this.pAg}get auf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Wke?3:2}get Hub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get u5b(){return!!this.jY}get Iub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}NJd(y){this.DFb(y)}Rvd(y){this.DFb(y)}DFb(y){let x=
10;this.jY&&1===y&&(this.jY(this.sE),x=1);this.iY&&this.iY(this.sE);this.oG(x)}zPa(){d.Redirect.showHelp("OICFailure");this.oG(2)}ZBd(){this.buf.Apf();this.oG(4)}oG(y){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.LTb,y);e.AFrameworkApplication.Dvc(f.a.kKf,this.LTb,y)}dispose(){this.sE=this.iY=this.jY=null}}Object(u.a)(m,"AOICErrorDialog",null,[2]);var l=a(45),v=a(134);class t extends m{constructor(y,x,F,I){super(y,x,F,I);this.nra=this.om=null;y=
document.createElement("span");y.id="errorMessageText";y.innerText=this.errorMessage;y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));this.om=document.createElement("a");this.om.href="#";this.om.innerText=this.Vwa;y.appendChild(this.om);l.a.addHandler(this.om,"click",Object(c.a)(this,this.zPa,"oicErrorHelpLinkHandler"));x=new v.StandardDialog;x.Ee=this.id;this.xzc?(F=document.createElement("span"),I=document.createElement("span"),F.innerText=this.duf,I.innerText=
this.cuf,this.nra=document.createElement("a"),this.nra.href="#",this.nra.innerText=this.auf,y.appendChild(document.createElement("br")),y.appendChild(F),y.appendChild(this.nra),y.appendChild(I),l.a.addHandler(this.nra,"click",Object(c.a)(this,this.ZBd,"oicErrorMacOfferLinkHandler"))):this.u5b&&(y.appendChild(document.createElement("br")),y.appendChild(document.createElement("br")),F=document.createElement("span"),F.innerText=this.Hub,y.appendChild(F));this.u5b?(x.Rb=1,x.oc(1,this.Iub)):x.Rb=0;x.$l(this.Ql,
null,this.icon,Object(c.a)(this,this.Rvd,"legacyOICErrorDialogHandler"),y);x.iX("errorMessageText")}dispose(){this.om&&(l.a.removeHandler(this.om,"click",Object(c.a)(this,this.zPa,"oicErrorHelpLinkHandler")),this.om=null);this.nra&&(l.a.removeHandler(this.nra,"click",Object(c.a)(this,this.ZBd,"oicErrorMacOfferLinkHandler")),this.nra=null);super.dispose()}}Object(u.a)(t,"OICErrorDialog",m,[]);class z{constructor(y,x,F){this.iY=x;this.jY=y;this.sE=F}get id(){return"OICErrorDialogWithDownload"}get TQe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Vwa(){return CommonUIStrings.l_OICErrorHelpLink}get Hub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Iub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}NJd(y){this.DFb(y)}Rvd(y){this.DFb(y)}DFb(y){let x=
10;1===y&&(this.jY(this.sE),x=1);this.iY&&this.iY(this.sE);this.oG(x)}zPa(){d.Redirect.showHelp("OICFailure");this.oG(2)}oG(y){e.AFrameworkApplication.Dvc(f.a.lKf,3,y)}dispose(){this.sE=this.jY=this.iY=null}}Object(u.a)(z,"AOICErrorDialogWithDownload",null,[2]);class r extends z{constructor(y,x,F){super(y,x,F);this.om=null;y=document.createElement("span");y.id="errorMessageText";y.innerText=this.TQe;y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));this.om=document.createElement("a");
this.om.href="#";this.om.innerText=this.Vwa;y.appendChild(this.om);l.a.addHandler(this.om,"click",Object(c.a)(this,this.zPa,"oicErrorHelpLinkHandler"));y.appendChild(document.createElement("br"));y.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.Hub;y.appendChild(x);x=new v.StandardDialog;x.Ee=this.id;x.Rb=1;x.oc(1,this.Iub);x.$l(this.Ql,null,this.icon,Object(c.a)(this,this.Rvd,"legacyOICErrorDialogHandler"),y);x.iX("errorMessageText")}dispose(){this.om&&
(l.a.removeHandler(this.om,"click",Object(c.a)(this,this.zPa,"oicErrorHelpLinkHandler")),this.om=null);super.dispose()}}Object(u.a)(r,"OICErrorDialogWithDownload",z,[]);var n=a(146);class w extends m{constructor(y,x,F,I){super(y,x,F,I);x={["errorMessage"]:this.errorMessage};x.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Vwa,["onExecute"]:L=>{this.zPa(L)}};this.xzc?(x.macOfficePreLinkText=this.duf,x.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.auf,
["onExecute"]:L=>{this.ZBd(L)}},x.macOfficePostText=this.cuf):this.u5b&&(x.errorFileDownloadOffer=this.Hub);y=new n.a(!1,!1,!0);this.u5b?(y.Rb=1,y.oc(1,this.Iub)):y.Rb=0;y.Ee=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};y.initializeAndShow(this.Ql,Object(c.a)(this,this.NJd,"reactOICErrorDialogHandler"),x)}}Object(u.a)(w,"ReactOICErrorDialog",m,[]);class B extends z{constructor(y,x,F){super(y,x,F);x={["errorMessage"]:this.TQe,["errorFileDownloadOffer"]:this.Hub};x.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Vwa,["onExecute"]:I=>{this.zPa(I)}};y=new n.a(!1,!1,!0);y.Rb=1;y.oc(1,this.Iub);y.Ee=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};y.initializeAndShow(this.Ql,Object(c.a)(this,this.NJd,"reactOICErrorDialogHandler"),x)}}Object(u.a)(B,"ReactOICErrorDialogWithDownload",z,[]);a.d(D,"a",function(){return A});class A{constructor(){this.okb=!!e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Pa.Jv}$eh(y,x,F){this.okb?
new w(y,x,null,F):new t(y,x,null,F)}afh(y,x,F){this.okb?new B(y,x,F):new r(y,x,F)}bfh(y,x,F,I,L){const {ReactOICErrorDialogWithTrial:X}=a(1337),{OICErrorDialogWithTrial:P}=a(1338);this.okb?new X(y,x,F,null,I,L):new P(y,x,F,null,I,L)}static get instance(){return A.Ma||(A.Ma=new A)}}A.Ma=null;Object(u.a)(A,"OICErrorDialogFactory",null,[594])},1211:function(u,D,a){var c=a(9);u=a(0);var b=a(692),e=a(21),f=a(42),d=a(1),h=a(15),m=a(30),l;(function(I){I[I.url=0]="url";I[I.ref=1]="ref";I[I.mailto=2]="mailto"})(l||
(l={}));Object(u.b)("HyperlinkSelectionState",l);var v=a(770),t=a(8),z=a(584),r=a(60),n=a(89),w=a(13);class B extends v.a{constructor(I,L,X){super(I);this.Nnb=0;this.zAb=!1;this.I2a=null;this.JMe=!1;this.msb=!0;this.Ql=this.XVc=null;this.LAd=0;this.KAd=this.MAd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.bei=(P,G)=>{1===P||2===P?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===P?"OK":"Remove"} pressed`),this.MAd=G[B.fAi],this.LAd=G[B.puj],this.KAd=G[B.hoh],2===P&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.i3j=(P,G)=>0!==G&&P.length?1===G?this.A2e(f.y(P,this.ea.xa)||this.SJi(P),760):this.A2e(m.a.wqd(P),762):null;this.selectedRange=L;this.vM=X;this.ea=I.ea;this.sheetName=L.SheetName;this.NMa();this.vq();this.Rb=this.zAb?9:1;this.oc(1,w.a.instance.ga(4));this.zAb&&this.oc(2,w.a.instance.ga(763));this.initializeAndShow(this.Ql,this.bei,{[B.vu]:this.pc,[B.j3j]:this.i3j,[B.xWg]:{[B.qnh]:this.JMe,[B.ioh]:this.I2a,[B.xHg]:this.Nnb,
[B.yHg]:this.XVc,[B.tah]:this.msb}})}get pc(){return"HyperLinkDialog"}p4e(I,L){switch(L){case 2:return I.startsWith("mailto:")?I:"mailto:"+I;case 1:return`${t.a.gNf}${this.UYh(I)}`;default:return I}}get iC(){return 526}pH(){const I=this.$;this.location=this.p4e(this.MAd,this.LAd);try{this.location=n.a.Rg(this.location)}catch(P){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,50,`Committing ${l[this.LAd]} link`);this.cellValue=this.KAd.length?this.KAd:
this.MAd;I.Qy();const L=I.pa.ya.Wb(),X=f.s(this.selectedRange);return(P,G,C)=>r.b(I.pa.ya,X,this.cellValue,this.location,this.removeHyperLink,!1,123,P,G,C,this.vM.range,L)}ek(){const I=f.s(this.selectedRange);return()=>new z.a(I,this.cellValue,this.location)}BFh(){let I=this.vM.cell.t6a;this.vM.cell.Owa?I&&I.startsWith("mailto:")?(this.Nnb=2,I=I.substr(7)):this.Nnb=0:this.Nnb=1;return I}NMa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.zAb=this.vM.xba:this.zAb=!!this.vM.sLa(64)||
!!this.vM.sLa(128)}vq(){if(this.zAb){this.I2a=this.vM.text;const I=this.BFh();I&&(this.XVc=I);this.Ql=w.a.instance.ga(827);this.msb=this.XVc===this.I2a}else this.vM.text?(this.I2a=this.vM.text,this.msb=!1):(this.I2a="",this.msb=!0),this.Nnb=0,this.Ql=w.a.instance.ga(826);this.vM.wB&&(this.msb=!1,this.JMe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.I2a=this.vM.formulaBarText))}SJi(I){return this.ea.Cb.Qk(I)}A2e(I,L){return I?null:w.a.instance.ga(L)}UYh(I){let L,
X;({sheetName:L,range:X}=f.Z(I,this.ea.xa)).returnValue&&X&&(I=f.x(X,L||this.sheetName,!1));return I}}B.j3j="validateLinkValues";B.xWg="bodyProps";B.qnh="disableDisplayText";B.ioh="displayTextValue";B.xHg="activeLinkOption";B.yHg="activeLinkValue";B.tah="copyLinkValueToDisplay";B.fAi="linkValue";B.puj="selectedLink";B.hoh="displayText";Object(u.a)(B,"HyperlinkDialog",v.a,[]);var A=a(55);class y{constructor(I,L){this.$=I;this.gridView=L}nc(){return!1}wc(I,L){return 1===I&&-1583422759===L.command}Jc(){return!1}executeCommand(){this.LIj();
return A.Task.Ta(!0)}LIj(){const I=f.v(this.gridView.ha.ra.$c,this.$),L=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Zp([this.gridView.ha.ra.$c],!0))&&L&&new B(this.$,I,L)}}Object(u.a)(y,"ShowHyperlinkCommandHandler",null,[165]);class x extends b.a{constructor(I){super(I)}nd(){this.Yc([new y(this.$,e.h(this.$))])}static ka(I){b.a.Nd(105,new x(I))}}Object(u.a)(x,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(D,
"a",function(){return F});const F=()=>{c.a.Fa(x.ka)}},1212:function(u,D,a){var c=a(9);u=a(0);var b=a(4),e=a(105),f=a(692),d=a(60),h=a(50),m=a(37),l=a(15),v=a(183),t=a(25),z=a(55);class r{constructor(x,F){this.$=x;this.Th=F}nc(){return!1}executeCommand(x,F,I){x=2;switch(F.command){case -309686558:x=this.Th.ae(t.a.saveACopy,2,I);break;case 617689800:x=this.Th.ae(t.a.saveToCloudStorage,2,I);break;case -1244760097:x=this.Th.ae(t.a.saveToSharePoint,2,I)}return 2===x&&F?v.a(F.command):z.Task.Ta(!0)}wc(x,
F){x=!1;switch(F.command){case -1244760097:case -309686558:case 617689800:x=!0,l.ULS.shipAssertTag(537153984,0,this.$.kla,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return x}Jc(){return!1}}Object(u.a)(r,"SaveToHostCommandHandler",null,[165]);class n extends f.a{constructor(x){super(x);this.nKh=(F,I,L,X,P)=>1===L?32:F===t.a.lSa&&2===L?(F=this.$.pa.ya.Wb(),d.C(this.$.pa.ya,P[0],P[1],null,null,F),32):8}nd(){m.TaskExtensions.Aa(h.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Ya),()=>{this.Yc([new r(this.$,b.AFrameworkApplication.ub)])},this.la,3);b.AFrameworkApplication.ub.Mb(t.a.lSa,e.a.frame,this.nKh)}static ka(x){f.a.Nd(267,new n(x))}}Object(u.a)(n,"SaveToHostCommandHandlerFactory",f.a,[]);var w=a(222);class B{constructor(x,F){this.$=x;this.Th=F;this.$.da.Ga(393,this)}nc(x){switch(x){case -309686558:return 8===this.Th.processAction(t.a.saveACopy,1,null);case 617689800:return 8===this.Th.ae(t.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.Th.ae(t.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(u.a)(B,"SaveToHostManager",null,[243,2]);class A extends w.a{constructor(x){super();this.$=x;this.Fb()}create(){this.ob(this.$.da.za(393)||new B(this.$,b.AFrameworkApplication.ub))}static ka(x){x.da.Ga(394,new A(x))}}Object(u.a)(A,"SaveToHostManagerFactory",w.a,[]);a.d(D,"a",function(){return y});const y=()=>{c.a.Fa(n.ka);c.a.Fa(A.ka)}},1213:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(82),d=a(114),h=a(29),
m=a(36);class l extends d.a{constructor(G,C){super(G,C)}execute(G){const C=Object(f.a)(7,G.Fe);e.ULS.shipAssertTag(537153921,0,h.a.mpb(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");C.FI(!0,!0);G.activityState[m.a.o_b]=C.ea.sessionId;G.activityState[m.a.Rnb]=!0;G.activityState[m.a.u_b]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(u.a)(l,"SessionReloadActivity",d.a,
[]);var v=a(6);class t extends b.a{constructor(){super();this.Fb()}create(){this.ob(new l(v.a.Odb,v.a.sz))}static ka(G){G.da.Ga(142,new t)}}Object(u.a)(t,"SessionReloadActivityFactory",b.a,[]);var z=a(58),r=a(265),n=a(109),w=a(47),B=a(46),A=a(35),y=a(1),x=a(39),F=a(246),I=a(115);class L extends d.a{constructor(G,C,H,J,M){super(G,C);L.lyd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];L.kyd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
L.Wtf=[-1468309555,611268539,-1750576502,61029505];L.Vtf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.kAc=H;this.yKj=J;this.zTj=M}execute(G){var C=Object(f.a)(7,G.Fe);G.activityState[m.a.qsa]=!0;var H=L.k4h(G);if(L.tEj(G,H))return L.BGi(G),H=50,0<G.errors.length&&(H=15),e.ULS.sendTraceTag(537153891,0,H,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.sc(G.errors)}`),G.activityState[m.a.qsa]=!1,this.hh(v.a.idle),
3;switch(H){case 1:case 3:this.aji(G,H);break;case 2:this.$ii(G);break;case 0:G.activityState[m.a.vZa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${H}. activityName:${this.activityName}. NextActivityName:${this.d0}. TimeFromLastStatefulResponse:${C.ea.n1}.`);var J=A.a.wg(G.activityState,I.a.fgb);e.ULS.shipAssertTag(40502925,0,!J||J&&(1===H||3===H),`triggerSilentReloadAfterTokenRefresh: ${J}, silentReloadType: ${H}`);C=C.il.reloadCount;return 0!==H&&
0<C?(J=r.a.uwa(C,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${H}] retryNum [${C}] delayInMs [${J}] activityName [${this.activityName}]`),w.a.instance.create(()=>{L.PM(G)},J,B.a.zwj),1):3}aji(G,C){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const H=Object(f.a)(7,G.Fe);G.activityState[m.a.Rnb]=!0;H.nhc||x.PageLoadTrackingInfo.instance.xj("ReopenOnLoad");!L.isEditMode(G)&&h.a.mpb(G.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[m.a.o_b]=H.ea.sessionId,G.activityState[m.a.u_b]=!0);G.Fyd();3===C?(H.ea.Lf()||H.ea.ZLi(),H.FI(!0,!0),this.hh(this.zTj),G.activityState[m.a.Soe]=H.workbookContext.CalcMode):(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===C&&H.FI(!0,!0),G.activityState[m.a.fWc]=!1,this.hh(this.kAc))}$ii(G){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[m.a.vZa]=null;G.Fyd();this.hh(this.yKj);G=Object(f.a)(7,G.Fe);G.nhc||(x.PageLoadTrackingInfo.instance.xj("RefreshOnLoad"),G.BKb())}static PM(G){G.PM()}static k4h(G){const C=Object(f.a)(7,G.Fe),H=C.ea,J=L.isEditMode(G);var M=h.a.ah(G.errors,J?L.kyd:L.lyd);const S=h.a.ah(G.errors,J?L.Vtf:L.Wtf),W=C.zN,O=C.il.reloadCount,T=C.va.MaxConsecutiveSilentReloadAllowed,Y=C.il.Taf(),va=h.a.sc(G.errors),ca=h.a.sc(G.jAa),
V=0<h.a.dN(Ba=>!Ba.triggerSilentReopenOnly,G.errors).length;let ra=M;const N=A.a.wg(G.activityState,I.a.fgb);N&&(ra=!0);const ea={name:"SessionReloadSilentActivity.GetSilentReloadType"};ea.editMode=J;ea.isSilentReopenError=M;ea.isSilentRefreshError=S;ea.reloadSequenceCount=C.il.oRa;ea.reloadCount=O;ea.maxReloads=T;ea.stopSilentReloads=Y;ea.errorNames=va;ea.processedErrorNames=ca;ea.isClientDirty=W;ea.errorsForSilentReopenOnly=V;ea.triggerSilentReloadAfterTokenRefresh=N;ea.IsReopenDisabled=C.MNa;M=
z.a.hc(ea);e.ULS.sendTraceTag(21837004,0,50,M);if(!Y){if(ra&&(J?L.kEj(G):L.mEj(G)))return F.a.U6f(G,C)?3:C.MNa?2:1;if(S&&(J||!H.bcb))return 2}return 0}static tEj(G,C){for(const H of G.errors)if(-1337545025===H.MessageId||-238814601===H.MessageId)return!1;return h.a.dN(H=>!H.triggerSilentReopenOnly,G.errors).length?3!==C:!1}static BGi(G){const C=h.a.dN(H=>!H.triggerSilentReopenOnly,G.errors);for(const H of C)G.Fca(H)}static isEditMode(G){const C=Object(f.a)(7,G.Fe);return C.ea.Zb?C.Pt&&!!(C.rd&64):
A.a.wg(G.activityState,m.a.cs)}static mEj(G){const C=Object(f.a)(7,G.Fe),H=h.a.v4(G.errors,L.lyd);if(n.b(H,J=>J.ForceVersionUpgrade))return!1;G=h.a.mpb(G.errors);return!C.ea.bcb||G?!0:!1}static kEj(G){G=h.a.v4(G.errors,L.kyd);return!n.b(G,C=>C.ForceVersionUpgrade)}}L.lyd=null;L.kyd=null;L.Wtf=null;L.Vtf=null;Object(u.a)(L,"SessionReloadSilentActivity",d.a,[]);class X extends b.a{constructor(G,C){super();this.activityName=G;this.dK=C;this.Fb()}create(){this.ob(new L(this.activityName,this.dK,v.a.sz,
v.a.jj,v.a.GPb))}static ka(G){G.da.Ga(143,new X(v.a.foa,v.a.e2b));G.da.Ga(144,new X(v.a.Sxc,v.a.eQa));G.da.Ga(145,new X(v.a.Txc,v.a.lFd));G.da.Ga(154,new X(v.a.Pdb,v.a.hP))}}Object(u.a)(X,"SessionReloadSilentActivityFactory",b.a,[]);a.d(D,"a",function(){return P});const P=()=>{c.a.Fa(G=>{t.ka(G);X.ka(G)})}},1225:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(15),f=a(82),d=a(242),h=a(319),m=a(29),l=a(13),v=a(380),t=a(89);class z extends v.a{constructor(y,x){super(y,x);this.tqa=0;this.Sr()}get pc(){return"SharedWorkbookDialog"}get Etb(){return this.tqa}PO(y,
x){this.tqa=y;super.PO(y,x)}Sr(){super.Sr();this.Rb=9;const y=this.MYh();this.oc(1,l.a.instance.ga(1657));this.oc(2,l.a.instance.ga(989));this.$l(l.a.instance.ga(702),t.a.Rg(y),this.icon,this.h8)}MYh(){return String.format(l.a.instance.ga(703))}}Object(u.a)(z,"LegacySharedWorkbookDialog",v.a,[]);var r=a(6),n=a(36);class w extends d.a{constructor(y,x,F){super(y,x);this.executionContext=null;this.Ozi=I=>{const L=this.$s.fd,X=Object(f.a)(7,L.Fe);let P;P=I.Etb;this.unsubscribe(G=>{I.remove_disposing(G)});
for(let G=0,C=L.errors.length;G<C;G++)-573864504===L.errors[G].MessageId&&L.Fca(L.errors[G]);switch(P){case 1:X.ea.$Cc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.hh(X.isEditMode?r.a.GPb:this.vkh);this.Kp();break;case 2:this.hh(r.a.openInExcelClient);this.Kp();break;case 0:L.activityState[n.a.cs]=!1,this.hh(this.lK),this.Kp()}};this.vkh=x;this.lK=F}initialize(y){super.initialize(y)}execute(y){this.executionContext=
y;this.K5c();return 1}hJ(y){super.hJ(y)}K5c(){const y=Object(f.a)(7,this.executionContext.Fe),x=m.a.n0a([-573864504]);x[0].HelpDescription=l.a.instance.ga(705);x[0].HelpTopicId=h.a.Pzi;const F=new z(y,x[0]);this.subscribe(this.executionContext,this.Ozi,I=>{F.add_disposing(I)})}}Object(u.a)(w,"LegacySharedWorkbookActivity",d.a,[]);class B extends b.a{constructor(y,x,F,I){super();this.activityName=y;this.dK=x;this.lK=F;this.$=I;this.Fb()}create(){this.ob(new w(this.activityName,this.dK,this.lK))}static ka(y){y.da.Ga(460,
new B(r.a.kDb,r.a.cgb,y.fCb?r.a.Uj:r.a.Brb,y))}}Object(u.a)(B,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(D,"a",function(){return A});const A=()=>{c.a.Fa(B.ka)}},1248:function(u,D,a){var c=a(9);u=a(0);var b=a(222);class e{constructor(){}dispose(){}}Object(u.a)(e,"GridInstantaneousAction",null,[552]);var f=a(695);class d extends b.a{constructor(m){super();this.$=m;this.Fb()}create(){this.ob(Object(f.a)(this.$.da,528,()=>new e))}static ka(m){m.da.Ga(529,new d(m))}}Object(u.a)(d,"GridInstantaneousActionFactory",
b.a,[]);a.d(D,"a",function(){return h});const h=()=>{c.a.Fa(m=>{d.ka(m)})}},1249:function(u,D,a){u=a(0);var c=a(1288),b=a(1289),e=a(4);class f{constructor(){this.f9d=this.gb=null}get name(){return"Common.App.DirectPrint"}Vh(m){this.gb=m;m.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").xc().Fc(()=>new c.a(e.AFrameworkApplication.sa.uX));m.register(654,"Common.App.DirectPrint.IDirectPrintManager").xc().Fc(()=>b.a.create(this.gb))}init(){this.f9d=this.gb.resolve("Common.App.DirectPrint.IDirectPrintManager");
this.f9d.start()}dispose(){}}Object(u.a)(f,"PackageManager",null,[4,5]);var d=a(248);a.d(D,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.Ei(new f)}},1262:function(u,D,a){u=a(0);var c=a(15),b=a(4),e=a(87),f=a(27),d=a(38),h=a(78),m;(function(J){J[J.unableToRefreshLock=0]="unableToRefreshLock";J[J.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";J[J.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";J[J.workbookTooLarge=3]="workbookTooLarge";
J[J.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";J[J.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";J[J.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";J[J.unsupportedFeatures=7]="unsupportedFeatures";J[J.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";J[J.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";J[J.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";J[J.lastGenericStatusError=
11]="lastGenericStatusError";J[J.scratchPadWarning=12]="scratchPadWarning";J[J.authenticationLost=13]="authenticationLost";J[J.odfCompatibilityIssues=14]="odfCompatibilityIssues";J[J.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";J[J.workbookIsIrmProtected=16]="workbookIsIrmProtected";J[J.biFeatureNotAvailable=17]="biFeatureNotAvailable";J[J.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";J[J.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";
J[J.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";J[J.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";J[J.editAttemptInReadOnly=22]="editAttemptInReadOnly";J[J.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";J[J.unsupportedBrowser=24]="unsupportedBrowser";J[J.readOnlyPermissions=25]="readOnlyPermissions";J[J.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";J[J.policyWarningMessage=27]="policyWarningMessage";
J[J.workingOnIt=28]="workingOnIt";J[J.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";J[J.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";J[J.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";J[J.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";J[J.legacyConnectionsBB=33]="legacyConnectionsBB";J[J.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";J[J.groupedSlicersBB=35]="groupedSlicersBB";
J[J.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";J[J.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";J[J.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";J[J.wacGdprNotice=39]="wacGdprNotice";J[J.automaticSensitivityLabel=40]="automaticSensitivityLabel";J[J.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";J[J.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";J[J.localStorageDisabled=43]="localStorageDisabled";J[J.autoRefreshDisabled=
44]="autoRefreshDisabled";J[J.corruptedFileRepaired=45]="corruptedFileRepaired";J[J.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";J[J.minorVersionLimitReached=47]="minorVersionLimitReached";J[J.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";J[J.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";J[J.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";J[J.sensitivityApplicationLabelDisabledError=
51]="sensitivityApplicationLabelDisabledError";J[J.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";J[J.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";J[J.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";J[J.promptEnableExternalLinks=55]="promptEnableExternalLinks";J[J.networkDown=56]="networkDown";J[J.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";J[J.refreshLinkedEntityErrorBar=
58]="refreshLinkedEntityErrorBar";J[J.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";J[J.canvasHealth=60]="canvasHealth";J[J.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";J[J.optimizeWorkbook=62]="optimizeWorkbook";J[J.novModePostDepreciation=63]="novModePostDepreciation";J[J.officeScriptsRunning=64]="officeScriptsRunning";J[J.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";J[J.readOnlyPivotTable=
66]="readOnlyPivotTable";J[J.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";J[J.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";J[J.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";J[J.count=70]="count"})(m||(m={}));Object(u.b)("EwaBusinessBarEntryType",m);var l=a(5),v=a(1057);class t extends Sys.EventArgs{constructor(J,M,S=null){super();this.r0a=J;this.X8c=M;this.data=S}}Object(u.a)(t,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,
[]);var z=a(1059),r=a(1058),n=a(1061),w=a(1060),B=a(1055),A=a(476),y=a(50),x=a(37),F=a(644),I=a(29),L=a(1),X=a(21),P=a(57),G=a(69),C=a(835);a.d(D,"a",function(){return H});class H extends h.a{constructor(J,M){super();this.Sa=new d.a;this.$P=null;this.fKc=[];this.Joc=()=>{this.$.pa.dNa?this.removeEntry(13):this.kg(13,null)};this.fh=(S,W)=>{for(let O=0,T=H.pec().length;O<T;O++)S=H.pec()[O],this.removeEntry(S);W.context&&0<W.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.removeEntry(21));this.Gmj()};this.Bm=(S,W)=>{var O;S=this.kHh(W.errors);let T=[];for(let va=0,ca=S.length;va<ca;++va){const V=S[va];if(1===V.Type&&V.Appearance&32)T=this.zai(V,T);else if(W.jwj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var Y=(null===(O=W.context)||void 0===O?0:O.stopwatch)?W.context.stopwatch.zc:-1;5E3>Y?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${Y}ms).`):
b.AFrameworkApplication.Qui()||this.oLg(V,W.context.methodName)}Y=[...H.pec()];for(let ra=0,N=T.length;ra<N;++ra){const ea=T[ra];this.kg(ea,V);Array.remove(Y,ea)}for(let ra=0,N=Y.length;ra<N;++ra)this.removeEntry(Y[ra])}};this.Tc=(S,W)=>{this.Bc(S,W)};this.Bc=()=>{const S=this.$.ea;S.Zb||S.Lf()||(this.vLd(),this.fKc.length=0)};this.ed=(S,W)=>{this.$.ea.Lf()&&!W.NV||this.fef(W.NV)};this.aHb=()=>{const S=this.$.userOperationManager.aec();S&&S.operation.flags&1&&this.N8f()};this.rDf=()=>{this.N8f()};
this.yf=()=>{this.kCe();this.W8f()};this.cO=()=>{if(this.$.O5&&this.$.ea.Lf()&&this.$.ea.Zb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const S=this.$.da.za(331);S&&S.pKa||this.removeEntry(55);this.removeEntry(5)}};this.$=J;this.j_a=M;this.GTg();b.AFrameworkApplication.Bd&&b.AFrameworkApplication.Bd.MWc(this);this.sZa=Array(70);
for(let S=0;70>S;S++)this.sZa[S]=null;this.Mh=F.EcmaDateClock.instance;this.tof=this.Mh.zb.getTime();M&&(M=J.pa,M.kw(this.Bm),M.Nq(this.fh),M.pob(this.Joc),M.GZa(this.Joc),J.ea.Tj(this.Tc),J.ea.mu(this.yf),J.nl(this.ed),J.dk(this.Bc),J.ea.FY(this.cO),J.userOperationManager.xr(this.aHb),L.EwaSettings.ma(167)&&J.ea.Vg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.M$e(),this.fef(P.c(J)));J.da.Ga(5,this)}M$e(){I.a.Oq(this.$.ea.fG)&&this.Bm(this,new A.a(this.$.ea.fG,null,!1,-1,-1,-1,
-1,"",-1,"",-1))}RLg(J){this.Sa.addHandler("bBarAttachedOrDetached",J)}get c$c(){return this.fKc}get domElement(){return this.$P?this.$P.domElement:null}dispose(){if(this.$){const J=this.$,M=J.pa;M.jx(this.Bm);M.Nr(this.fh);M.Luc(this.Joc);M.XJb(this.Joc);J.ea.qk(this.Tc);J.ea.Ov(this.yf);J.Kl(this.ed);J.Jl(this.Bc);J.ea.C0(this.cO);J.userOperationManager.mo(this.aHb);X.h(J).Vb.Fk(this.rDf)}e.a.Ia(this.$P);this.$=this.$P=null;super.dispose()}Emi(J){switch(J){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;
case 59:return L.EwaSettings.ma(644);default:return!1}}kg(J,M,S=null,W=null,O=null){if(!this.$.isMobileMode||this.Emi(J))this.j_a&&!this.cF(J)&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,`Adding entry to BB: ${Enum.toString(m,J)}`),this.sZa[J]=this.Mh.gfa,this.$P.HC(J,M,W,O),this.Sa.raiseEvent("bBarAttachedOrDetached",new t(J,!0,S))),M&&32===M.Appearance&&G.a(this.$).fd.Fca(M)}AIj(J,M,S,W){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
B.a.initialize(J,M,S,W);this.kg(39,null)}AHj(J,M,S,W){v.a.initialize(J,M,S,W);this.kg(40,null)}IJj(J,M,S,W){r.a.initialize(J,M,S,W);this.kg(41,null)}ZIj(J,M,S,W){z.a.initialize(J,M,S,W);this.kg(42,null)}RJj(J,M,S,W){w.a.initialize(J,M,S,W);this.kg(53,null)}QJj(J,M,S,W){n.a.initialize(J,M,S,W);this.kg(54,null)}removeEntry(J){this.j_a&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(m,J)}`),this.sZa[J]=
null,this.$P.removeEntry(J)&&this.Sa.raiseEvent("bBarAttachedOrDetached",new t(J,!1)))}pla(J){return this.j_a?this.$P.pla(J):!1}cF(J){return this.j_a?this.$P.cF(J):!1}$Eb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Mnc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}GTg(){const {BusinessBarControl:J}=a(1150);if(this.j_a&&
!this.$P){X.h(this.$).Vb.Xk(this.rDf);var M=document.getElementById(this.$.Eb+l.a.pze);this.$P=new J(this.$,M)}}vLd(){this.j_a&&this.$P.vLd()}Gmj(){if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const M=this.Mh.gfa;if(3E5<=M-this.tof){this.tof=M;for(let S=0;70>S;S++){var J=this.sZa[S];if(J&&(J=M-J,3E5<=J)){const W=Enum.toString(m,S);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${W}] was activated but not turned off for ${J} Millis`)}}}}}kHh(J){const M=
[];for(const S of J)switch(S.MessageId){case -113742550:const W=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||I.a.ah(J,W))&&M.push(-113742550)}return I.a.VB(J,M)}zai(J,M){switch(J.MessageId){case 2113407564:const S=I.a.n0a([1821390342,-943219229,-502303485,1437034227]);for(let W=0;W<S.length;W++)S[W].HelpTopicId=J.HelpTopicId,S[W].HelpDescription=J.HelpDescription,this.fKc.push(S[W])}switch(J.MessageId){case -395951567:this.kg(6,
J);break;case 1643490758:this.kg(4,J);break;case -907264831:this.kg(5,J);break;case 757111532:case 2113407564:this.kg(7,J);break;case 2010656511:this.kg(15,J);break;case 1321660996:this.$.C7c=!0;this.kg(8,J);break;case 526339737:this.$.C7c=!0;this.kg(9,J);break;case -407088521:this.kg(10,J);break;case 1756116017:this.kg(14,J);break;case -1703455218:this.kg(17,J);break;case 1393475740:this.kg(25,J);break;case -949523941:this.kg(26,J);break;case 1779381952:this.kg(44,J);break;case 1421575100:this.kg(45,
J);break;case 613676060:this.kg(46,J);break;case 1233668252:this.kg(61,J);break;case 1911608588:J=!!(this.$.rd&64);!this.$.ea.Lf()&&J&&M.push(29);break;case 1544494907:break;case -655555355:M.push(this.Ktd()?1:0);break;case -1221382671:M.push(2);break;case 1662282929:M.push(3);break;case 104919273:this.$.ea.Lf()||M.push(30);break;case -689453604:J=!!(this.$.rd&64);this.$.ea.Waf=!0;!this.$.ea.Lf()&&J&&M.push(31);break;case 157762400:this.$.ea.Nic=!0;!this.$.ea.Lf()&&this.$.rd&64&&!this.$.isEditMode&&
M.push(32);break;case -1125398042:L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Lf()&&this.$.rd&64&&!this.$.isEditMode&&M.push(34);break;case -73730134:!this.$.ea.Lf()&&this.$.rd&64&&M.push(33);break;case -293349236:M.push(65);break;case 1580811823:M.push(67);break;case -37299333:break;case 136737622:M.push(47);break;case -1780327030:this.kg(55,J);break;case -113742550:this.kg(57,J);break;case -260312420:this.$.ea.Lf()||M.push(66);break;
default:this.kg(11,J)}return M}Lgi(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!C.a.zrd(C.a.jfd(1))&&(f.a.Cp||f.a.Xg)){const J=y.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);x.TaskExtensions.Aa(J,()=>{this.kg(20,null)},this.la,3)}}dgi(J){J||3!==this.$.workbookContext.WorkbookNovType||this.kg(63,null)}fef(J){(!J&&!this.$.printingEnabled||this.$.he.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.kg(16,null));this.Lgi();this.kCe();this.W8f();this.dgi(J)}kCe(){this.$.workbookContext.Options&32768&&this.pIj()}pIj(){this.sZa[37]||this.kg(37,null)}sKj(){this.sZa[38]||this.kg(38,null)}W8f(){L.EwaSettings.ma(644)&&this.$.workbookContext.Options&524288&&this.kg(59,null)}s9f(J,M){this.kg(58,J,null,M)}TWc(J,M=null){this.$P.cF(J)?this.$P.nQb(J,M):this.kg(J,null,null,null,M)}N8f(){this.$.rd&8&&this.kg(12,null)}Ktd(){const J=this.$.da.za(38);return J?J.tokenExpired:!1}oLg(J,M){if(!this.cF(21)&&-1387426400!==
J.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const S={};S.FailedMethod=M;this.kg(21,J,S)}}static pec(){return H.wte||(H.wte=[0,1,2,3])}nfd(J){return this.$P.nfd(J)}}H.wte=null;Object(u.a)(H,"BusinessBarManager",h.a,[369,2,72])},1275:function(u,D,a){u=a(0);var c=a(222),b=a(1262);class e extends c.a{constructor(h){super();this.$=h;this.Fb()}create(){this.ob(this.$.da.za(5)||new b.a(this.$,!this.$.Fba))}static ka(h){h.da.Ga(4,
new e(h))}}Object(u.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(D,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1287:function(u,D,a){u=a(0);var c=a(15),b=a(84),e=a(848),f=a(835),d=a(1205);class h{constructor(){this.fHc=new d.a;this.dHc=new d.a;this.cHc=new d.a;this.AXg(this.fHc);this.zXg(this.dHc);this.yXg(this.cHc);this.kMc=new d.a;this.jMc=new d.a;this.iMc=new d.a;this.YZg(this.kMc);this.XZg(this.jMc);this.WZg(this.iMc);this.wIc=new d.a;this.TXg(this.wIc);this.EGa(this.wIc);
this.EGa(this.cHc);this.EGa(this.dHc);this.EGa(this.fHc);this.EGa(this.jMc);this.EGa(this.kMc);this.EGa(this.iMc)}O4h(z,r){switch(z){case 1:return this.f8h(r);case 2:return this.oPh(r)}return f.a.Jzc?this.wIc:null}AXg(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}zXg(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}yXg(z){z.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}YZg(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);z.add("OverlayBig","Get the Word app");z.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");z.add("OverlaySmallSplit1","Discover Word");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")}TXg(z){z.add("Headline",
"Get the Office Online extension for Chrome");z.add("UseAppButton","Get the extension");z.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}XZg(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);
z.add("OverlayBig","Get the PowerPoint app");z.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");z.add("OverlaySmallSplit1","Discover PowerPoint");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")}WZg(z){z.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",
CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}EGa(z){z.add("Corporation","Microsoft Corporation")}f8h(z){switch(z){case 3:return this.kMc;case 2:return this.jMc;case 1:return this.iMc}return null}oPh(z){switch(z){case 3:return this.fHc;case 2:return this.dHc;case 1:return this.cHc}return null}static get instance(){h.Ma||(h.Ma=new h);return h.Ma}}h.Ma=null;Object(u.a)(h,"WildFireStringFactory",null,[]);var m=a(4),l=a(40),
v=a(27);a.d(D,"a",function(){return t});class t{constructor(z,r,n,w,B=null,A=null){this.yQc=null;this._id=z;this.gRc=r;this.wxg=B;this.ikb=w;this.umb=A;this.Upa=null;this.dZa=n;this.Smb=h.instance.O4h(r,z)}C5c(){this.Upa=new e.a(this.title,this.message,null);this.Upa.addButton(this.yze,Object(b.a)(this,this.Rzf,"onButtonOneClick"),"");this.dZa&&this.Upa.xKg(this.Aze,Object(b.a)(this,this.Uzf,"onButtonTwoClick"));this.Upa.X$=Object(b.a)(this,this.YMe,"dismissBar");this.Upa.image=3;this.Upa.id=16;this.Upa.closeable=
!0}get title(){return this.Smb.oa("Headline")}get message(){return this.Smb.oa("CallToAction")}get g2j(){return this.dZa}get yze(){return this.dZa?this.Smb.oa("InstallButton"):this.Smb.oa("UseAppButton")}get Aze(){return this.dZa?this.Smb.oa("OpenAppButton"):""}Rzf(){this.dZa?this.Iji():this.X1j()}Uzf(){this.dZa&&this.S1i()}get a_g(){return this.Upa}get openUrl(){this.yQc||(this.yQc=this.wxg());return this.yQc}Iji(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.ikb&&
this.umb&&this.umb();f.a.ySf(this._id,this.gRc)}S1i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.ikb&&this.umb&&this.umb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Gue(this._id),this.openUrl,0,!1))}X1j(){f.a.Jzc?this.d_g():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.PSd("BizBarClicked"),1!==this.gRc&&2!==this.gRc||f.a.B5g(this.openUrl,this.ikb,this._id,this.umb))}d_g(){this.ikb?c.ULS.sendTraceTag(17571974,
323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");l.a.bV(m.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Gnh(){this.ikb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.PSd(f.a.HCe)}YMe(){f.a.Jzc?this.Gnh():(f.a.PSd(f.a.jfd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static F6b(){const z=m.AFrameworkApplication.sa.Pa,
r=new t(z.Fj,f.a.nec(),8<v.a.u6a,1===z.H6,()=>z.Qx,z.H_f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r}}Object(u.a)(t,"WildFireBusinessBar",null,[])},1288:function(u,D,a){u=a(0);var c=a(15),b=a(84),e=a(134),f=a(4),d=a(14),h=a(95),m=a(45),l=a(180),v=a(1075),t=a(86),z=a(56),r=a(80),n=a(937);class w extends e.StandardDialog{constructor(A,y,x,F=null){super();this.HP=this.qm=this.Hqa=null;this.sn=[];this.PWb=y;this.AP=A;this.Rxg=x;this.$Xb=F;this.Rmb=new n.a("LoadResource","LoadPrintablePdf")}wQ(){this.Rb=
5;this.width=40;const A=document.createElement("span");A.id=this.mi("DirectPrintHeaderContent");const y=document.createElement("span");y.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(y,"DirectPrintHeader");this.HP=document.createElement("iframe");this.HP.name="pdfObjectFrame";this.HP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.HP.onload=Object(b.a)(this,this.W8i,"printablePdfLoaded");if(this.$Xb&&0<this.$Xb.count){var x=r.a.aid(this.PWb,this.$Xb);const F=
r.a.TLd(this.PWb,this.$Xb);this.qm=document.createElement("form");this.qm.id="printPreviewPostForm";this.qm.method="POST";this.qm.target=this.HP.name;this.qm.action=F;for(let I of x)x=document.createElement("input"),x.type="hidden",x.name=I.key,x.value=I.value,this.qm.appendChild(x)}else this.HP.setAttribute("src",this.PWb);Sys.UI.DomElement.addCssClass(this.HP,l.a.rge);this.Rxg?(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObjectHidden"),y.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
t.a.wh(this.HP,t.a.JC,t.a.xk)):(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObject"),this.sn.push(this.HP));A.appendChild(y);A.appendChild(document.createElement("br"));A.appendChild(this.HP);this.qm&&A.appendChild(this.qm);A.appendChild(document.createElement("br"));A.appendChild(this.n9g(this.qm?"#":this.PWb));this.Rmb.start();this.xEb(CommonUIStrings.l_AppTitle,null,null,null,null,A);this.iX(this.mi("DirectPrintHeaderContent"));this.qm&&this.qm.submit();this.pdh();c.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}n9g(A){const y=document.createElement("span");var x=document.createElement("span");x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;y.appendChild(x);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.sa.Pa.Fj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.sa.Pa.Fj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(A=document.createElement("span"),2===f.AFrameworkApplication.sa.Pa.Fj?
A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.sa.Pa.Fj&&(A.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Hqa=A,y.appendChild(document.createElement("br")),y.appendChild(A)):(x=document.createElement("a"),x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,x.href=A,x.target="_blank",x.id="PrintPDFLink",x.className="AllowBrowserClick",this.Hqa=
x,y.appendChild(document.createElement("br")),y.appendChild(x),this.qm&&m.a.addHandler(x,"click",Object(b.a)(this,this.Iqc,"onSubmit")),this.AP.ta(d.a.click,this.Hqa,Object(b.a)(this,this.eOe,"downloadPDFLinkClicked"),null));this.sn.push(this.Hqa);return y}Iqc(A){this.qm&&(this.qm.target="_blank",this.qm.submit());A.preventDefault()}pdh(){if(0<this.sn.length){const A=new v.a(this.sn),y=h.FocusManager.instance().OQ();y&&(this.Hqa.focus(),y.jf=A,y.S_=!0)}}eOe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1}Fwd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}W8i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Rmb&&this.Rmb.stop()}dispose(){this.Hqa&&(this.AP.Ba(d.a.click,this.Hqa,Object(b.a)(this,this.eOe,"downloadPDFLinkClicked")),this.Hqa=null);z.a.B0(this.HP);this.HP=null;super.dispose()}}Object(u.a)(w,"DirectPrintDialog",e.StandardDialog,[678]);a.d(D,"a",function(){return B});class B{constructor(A){this.AP=A}iUh(A,
y){return new w(this.AP,A,y,null)}}Object(u.a)(B,"DirectPrintDialogFactory",null,[655])},1289:function(u,D,a){u=a(0);var c=a(15),b=a(552),e=a(84),f=a(1341),d=a(1076);class h{constructor(r,n){this.Vbg=r;this.mUa=n}}Object(u.a)(h,"DirectPrintProbeResults",null,[]);var m=a(4),l=a(263),v=a(27),t=a(111);a.d(D,"a",function(){return z});class z{constructor(r,n,w,B,A,y,x,F,I,L){this.rZb=null;this.Nvg=r;this.mlb=n;this.$Pc=w;this.Uyg=B;this.zzg=A;this.qRc=new b.a(Object(e.a)(this,this.t1h,"getProbeResults"));
this.AWa=y;this.mee=I;this.DEg=x;this.Azg=F;this.Hzg=L}get jD(){return this.Nvg}start(){}baj(){const r=Array(this.jD.lUa.length);if(void 0!==this.mlb&&null!==this.mlb)for(let n=0;n<this.jD.lUa.length;n++)r[n]=this.jD.lUa[n]in this.mlb&&this.Uyg(this.mlb[this.jD.lUa[n]]);return r}caj(){const r=Array(this.jD.mUa.length),n=!(void 0===this.$Pc||null===this.$Pc);for(let w=0;w<this.jD.mUa.length;w++){const B=this.jD.mUa[w];r[w]=n&&B in this.$Pc?!0:this.zzg(B)}return r}c5h(){const r=this.baj(),n=Array(r.length);
for(let w=0;w<r.length;w++)n[w]=r[w]?this.EFh(this.mlb[this.jD.lUa[w]]):null;return n}EFh(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}t1h(){var r=this.c5h();const n=this.caj(),w={},B={};for(let A=0;A<this.jD.lUa.length;A++)w[this.jD.lUa[A]]=r[A];for(r=0;r<this.jD.mUa.length;r++)B[this.jD.mUa[r]]=n[r];return new h(w,B)}gHj(){return this.Hzg||!this.jD.isEnabled||m.AFrameworkApplication.isUnifiedHostMode?!1:this.jPj()}d8f(){if(null!=this.rZb)return this.rZb;
const r=z.Xhf(this.jD);return this.rZb=this.jD.Yhf&&r||this.cni()}cni(){return v.a.Dp&&this.jD.eni&&v.a.JCe>=this.jD.l4g?!0:!1}jPj(){if(!this.Azg(this.jD))return!1;var r=t.a.Ujd(this.qRc.value.Vbg);for(const n of r)if(void 0!==n&&null!==n)return!0;r=t.a.Ujd(this.qRc.value.mUa);for(const n of r)if(n)return!0;return!1}Fbi(){const r=t.a.Ujd(this.qRc.value.Vbg);for(const n of r)if(l.a.contains(this.jD.Qei,n))return!0;return!1}wJj(r){m.AFrameworkApplication.sa&&m.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?
this.mee(r,null):this.gHj()?this.Znh(r,this.Fbi()&&!0):this.mee(r,null)}Znh(r,n){const w=this.DEg.Ac("UserAction","OpenDirectPrintDialog");this.AWa.iUh(r,n).wQ();w.stop()}static vmf(r){try{return new ActiveXObject(r),!0}catch(n){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static $hf(r){return void 0===r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const n=new d.a(m.AFrameworkApplication.fa.appSettings);let w=
null;try{w=window.navigator.mimeTypes}catch(L){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(L){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const A=z.$hf,y=z.vmf;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const x=m.AFrameworkApplication.sa.mE,F=z.wmf,I=!!m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Jv&&!m.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");
return new z(n,w,B,A,y,r,x,F,(L,X)=>new f.a(L,!1,X,!0,I),m.AFrameworkApplication.nla)}static wmf(r){return v.a.Dp||v.a.Hv&&r.Dqi||r.Yhf&&z.Xhf(r)?!0:!1}static Xhf(r){var n=v.a.jub;if(n){var w=n.split(".");if(2===w.length)return n=parseInt(w[0]),w=parseInt(w[1]),n>r.yzd||n===r.yzd&&w>=r.Fvf}return!1}}Object(u.a)(z,"DirectPrintManager",null,[654])},1336:function(u,D,a){a.d(D,"a",function(){return l});u=a(0);var c=a(84);D=a(134);var b=a(1064),e=a(260),f=a(4),d=a(14),h=a(80),m=a(27);class l extends D.StandardDialog{constructor(v,
t=!0,z=!1,r=null,n=null,w=!1){super();this.XWa=this.WWa=this.qm=this.gY=null;var B=this.BZd?this.BZd:CommonUIStrings.l_DefaultDialogTitle;l.l6a=w;this.TTb=r||new b.a(v,!0);this.TTb.Pwe(this);const A=[],y=[];l.Wu&&(this.cYc&&this.cYc.forEach(I=>{Array.add(A,I)}),this.Tse&&this.Tse.forEach(I=>{Array.add(y,I)}));t?z?(this.Rb=4,this.oc(1,this.buttonText),this.oc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.oc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;w=document.createElement("span");this.U6c&&
(w.className=this.U6c);r=document.createElement("a");r.innerText=this.Llc;r.href=v;r.target="_blank";r.id=this.Klc;r.className=e.AFrame.zte;var x=!m.a.Iz&&!!n&&0<n.count;if(x){const I=h.a.aid(v,n);n=h.a.TLd(v,n);r.href="#";r.target="_self";this.qm=document.createElement("form");this.qm.id="printPreviewPostForm1";this.qm.method="post";this.qm.target="_blank";this.qm.action=n;for(var F of I)n=document.createElement("input"),n.type="hidden",n.name=F.key,n.value=F.value,this.qm.appendChild(n)}else this.qm=
null;this.qm||l.l6a?l.l6a||Array.add(y,{["type"]:"AppLinkProps",["id"]:this.Klc,["text"]:this.Llc,["onExecute"]:()=>{this.XQf()}}):Array.add(y,{["type"]:"AppLinkProps",["id"]:this.Klc,["text"]:this.Llc,["handler"]:{["href"]:x?"#":v,["target"]:x?"_self":"_blank"}});this.fPa&&Array.add(A,this.fPa);z?(v=document.createElement("span"),v.innerText=this.fPa.replace("{0}",""),w.appendChild(v)):this.vvf?(v=document.createElement("span"),v.id=this.mi("message"),F=document.createElement("span"),n=document.createElement("span"),
x=this.fPa.split("{0}"),F.innerText=x[0],n.innerText=x[1],v.appendChild(F),v.appendChild(r),v.appendChild(n),w.appendChild(v)):(v=document.createElement("span"),v.innerText=this.fPa,w.appendChild(v),w.appendChild(document.createElement("br")),w.appendChild(document.createElement("br")),w.appendChild(r),l.l6a||Array.add(A,"{0}"));this.qm&&w.appendChild(this.qm);l.Wu&&(this.q9a&&(this.gDb?this.Dpe(this.q9a,this.gDb):(Array.add(A,"{0}"),Array.add(y,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.q9a,
["onExecute"]:()=>{this.Elc()}}))),this.rsa(A,y));this.xEb(B,null,this.ldf,null,Object(c.a)(this,this.yw,"dialogHandler"),l.Wu?null:w);this.iX(this.mi("message"));!l.Wu&&this.gDb&&this.q9a&&(B=document.createElement("div"),B.className="WACDialogLearnMoreLinkContainer",this.gY=document.createElement("a"),this.gY.innerText=this.q9a,this.gY.href=this.gDb,this.gY.target="_blank",this.gY.id=this.mi("LearnMoreLinkId"),this.gY.className=e.AFrame.zte,B.appendChild(this.gY),t?this.wb.insertBefore(B,this.wb.lastChild):
this.wb.appendChild(B),this.iX(String.format("{0} {1}",this.mi("message"),this.mi("LearnMoreLinkId"))));this.Wib=r;z?this.VI(this.nC):this.VI(this.Wib);this.grf();f.AFrameworkApplication.sa.uX.ta(d.a.click,this.Wib,Object(c.a)(this,this.cOe,"downloadLinkClicked"),null);this.gY&&f.AFrameworkApplication.sa.uX.ta(d.a.click,this.gY,Object(c.a)(this,this.Elc,"learnMoreLinkClicked"),null);this.RTb=!1}get ldf(){return null}get BZd(){return null}get fPa(){return null}get gDb(){return null}get q9a(){return null}get vvf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get U6c(){return null}get cYc(){return null}get Tse(){return null}FZc(){this.qm&&
(this.WWa||(this.WWa=Object(c.a)(this,this.mNi,"onActionButtonClicked"),this.cz.ta(d.a.click,this.nC,this.WWa)),this.XWa||(this.XWa=Object(c.a)(this,this.nNi,"onActionButtonKeyUp"),this.Yd.ta(d.a.Dd,this.nC,this.XWa)));super.FZc()}mNi(v){this.WVe(v);return!0}nNi(v){return this.lof(v,Object(c.a)(this,this.WVe,"executeDismissActionButtonFromArgs"))}WVe(v){this.qm&&this.qm.submit();this.lva(v.Gb)}Fwd(){}cOe(){this.irf();this.qm?this.qm.submit():this.TTb.c9c();return!0}Elc(){return!1}dispose(){this.TTb.dispose();
this.Wib&&(f.AFrameworkApplication.sa.uX.Ba(d.a.click,this.Wib,Object(c.a)(this,this.cOe,"downloadLinkClicked")),this.Wib=null);this.gY&&(f.AFrameworkApplication.sa.uX.Ba(d.a.click,this.gY,Object(c.a)(this,this.Elc,"learnMoreLinkClicked")),this.gY=null);this.cz&&this.WWa&&(this.cz.Ba(d.a.click,this.nC,this.WWa),this.WWa=null);this.Yd&&this.XWa&&(this.Yd.Ba(d.a.Dd,this.nC,this.XWa),this.XWa=null);super.dispose()}XQf(){this.qm&&(document.body.appendChild(this.qm),this.qm.submit(),document.body.removeChild(this.qm))}yw(v){1===
v&&(this.Fwd(),this.qm?l.Wu&&this.XQf():this.TTb.c9c());this.dispose()}static get Wu(){return f.AFrameworkApplication.sa.Pa.Jv&&f.AFrameworkApplication.sa.Pa.dlf}static get l6a(){return l.Jae}static set l6a(v){l.Jae=v}}l.Jae=!1;Object(u.a)(l,"ADialogWithLinkToResource",D.StandardDialog,[])},1337:function(u,D,a){a.r(D);a.d(D,"ReactOICErrorDialogWithTrial",function(){return f});u=a(0);var c=a(84);D=a(1066);var b=a(418),e=a(146);class f extends D.a{constructor(d,h,m,l,v,t){super(d,h,m,l,v,t);h={["errorMessage"]:this.SQe,
["offerString"]:this.lyf};d=new e.a(!1,!1,!0);this.O8f?(d.Rb=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Vwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Gbf)}}):(d.Rb=4,d.oc(2,this.fdf));d.oc(1,this.MZb);d.Ee=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.Ql,Object(c.a)(this,this.zcj,"reactOICErrorDialogWithTrialHandler"),h)}}Object(u.a)(f,"ReactOICErrorDialogWithTrial",D.a,[])},1338:function(u,D,a){a.r(D);a.d(D,"OICErrorDialogWithTrial",
function(){return e});u=a(0);var c=a(84);D=a(1066);var b=a(134);class e extends D.a{constructor(f,d,h,m,l,v){super(f,d,h,m,l,v);f=document.createElement("span");f.innerText=this.SQe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.lyf;f.appendChild(d);d=new b.StandardDialog;this.O8f?(d.Rb=1,d.Mpe(this.Vwa,this.Gbf)):(d.Rb=4,d.oc(2,this.fdf));d.oc(1,this.MZb);d.Ee=this.id;d.$l(this.Ql,null,this.icon,Object(c.a)(this,
this.Kzi,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(u.a)(e,"OICErrorDialogWithTrial",D.a,[])},1339:function(u,D,a){a.r(D);a.d(D,"CheckRoamingRightsRequest",function(){return c});u=a(0);a=a(1067);class c extends a.a{constructor(){super()}Axb(){return 2}eba(){return 1}}Object(u.a)(c,"CheckRoamingRightsRequest",a.a,[])},1340:function(u,D,a){a.r(D);a.d(D,"GetRoamingLauncherRequest",function(){return c});u=a(0);a=a(1067);class c extends a.a{constructor(){super()}Axb(){return 0}eba(){return 2}}
Object(u.a)(c,"GetRoamingLauncherRequest",a.a,[])},1341:function(u,D,a){a.d(D,"a",function(){return l});u=a(0);var c=a(15),b=a(1336),e=a(1064),f=a(4),d=a(86),h=a(80),m=a(27);class l extends b.a{constructor(v,t,z=null,r=!0,n=!1){super(v,!0,!(l.JCa&&r),new e.a(v,t),z,n);l.JCa=l.JCa&&r;if(l.JCa){t=document.createElement("iframe");r=null;n=this.Umh;t.name="pdfObjectFrame";t.id="pdfObjectIFrame";if(z&&0<z.count){const w=h.a.aid(v,z);v=h.a.TLd(v,z);r=document.createElement("form");r.id="printPreviewPostForm";
r.method="POST";r.target=t.name;r.action=v;for(let B of w)v=document.createElement("input"),v.type="hidden",v.name=B.key,v.value=B.value,r.appendChild(v)}else t.src=v;n.appendChild(t);r&&(n.appendChild(r),r.submit());Sys.UI.DomElement.addCssClass(t,"DirectPrintPdfObjectHidden");d.a.wh(t,d.a.JC,d.a.xk)}}get ldf(){return"Print_32x32x32"}get BZd(){return l.JCa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get fPa(){return l.JCa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get cYc(){const v=
[];Array.add(v,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.l6a){let t=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.sa.Pa.yKe&&(t=f.AFrameworkApplication.sa.Pa.yKe);Array.add(v,t)}return l.JCa?v:null}get Llc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Klc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get U6c(){return f.AFrameworkApplication.pMe?"UIFontDialogTextLarge":null}grf(){c.ULS.sendTraceTag(7690390,
324,50,"Legacy print dialog displayed")}irf(){f.AFrameworkApplication.Un.uzb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Fwd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get JCa(){return!!f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Pa.Jv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(m.a.Iz||m.a.Hv||m.a.fg||m.a.PNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set JCa(v){}}
Object(u.a)(l,"PrintDialogWithLinkToPdf",b.a,[])},1358:function(u,D,a){u=a(0);var c=a(84),b=a(41);class e{constructor(){this.classId=0}static sJa(l){try{return b.a(l)}catch(v){}return null}}Object(u.a)(e,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.Oqd=!1}}Object(u.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(106);a.d(D,"a",function(){return m});class m{constructor(l){this.uIc=!1;this.tYa=m.Egc;this.hSc=this.lQc=0;this.platform=null;this.dDg=
l;this.ene=this.iSc=!1}get roamingAppsAreEnabled(){return this.dDg}get s2j(){return this.roamingAppsAreEnabled&&this.iSc?this.ene:!1}Z3g(){d.AFrameworkApplication.fjc&&this.roamingAppsAreEnabled&&!this.iSc&&!this.uIc&&(this.hSc=1,this.uIc=!0,this.Foj(),this.TVe())}Foj(){this.tYa=m.Egc;this.lQc=0}getRoamingAppsLauncher(l,v,t){this.s2j?(l=new f,l.callback=v,l.state=t,l.Oqd=!0,this.YVe(l)):v(!1,"",t)}TVe(){const l=new (a(1339).CheckRoamingRightsRequest);l.RoamingApp=this.hSc;l.BaseDocQuerySignature=
d.AFrameworkApplication.Zi;l.execute(Object(c.a)(this,this.a4g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.$3g,"checkUserRoamingRightsFailed"),null)}a4g(l){d.AFrameworkApplication.Lg||((l=e.sJa(l.data.te))?this.RSd(l.HasRights):this.RSd(!1))}$3g(){if(!d.AFrameworkApplication.Lg)if(this.lQc>=m.iHi)this.RSd(!1);else{var l=new h.a(2,1,this.tYa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.Fi.Cg(l);this.lQc++;this.tYa*=m.aqj;
this.tYa>m.Ruf&&(this.tYa=m.Ruf)}}RSd(l){this.ene=l;this.iSc=!0;this.uIc=!1}retryCheckUserRoamingRights(){this.TVe()}YVe(l){const v=new (a(1340).GetRoamingLauncherRequest);v.RoamingApp=this.hSc;v.BaseDocQuerySignature=d.AFrameworkApplication.Zi;v.execute(Object(c.a)(this,this.W2h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.V2h,"getRoamingAppsLauncherFailed"),l)}W2h(l){if(!d.AFrameworkApplication.Lg){var v=e.sJa(l.data.te);l=l.data.state;v?(this.platform=v.Platform,l.callback(!0,v.Launcher,
l.state)):l.callback(!1,"",l.state)}}V2h(l){if(!d.AFrameworkApplication.Lg){var v=l.data.state;5===l.data.status&&v.Oqd?(v.Oqd=!1,this.YVe(v)):v.callback(!1,"",v.state)}}static get instance(){return m.zC||(m.zC=new m(d.AFrameworkApplication.aTg))}}m.Egc=1E3;m.aqj=5;m.Ruf=12E5;m.iHi=5;m.zC=null;Object(u.a)(m,"RoamingAppsManager",null,[])},1433:function(u,D,a){a.r(D);var c=a(1049),b=a(0),e=a(248);class f{get name(){return"Common.App.DialogWithLinkToResource"}Vh(){}init(){}dispose(){}static main(){e.a.instance.Ei(new f)}}
Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var d=a(552),h=a(15),m=a(84),l=a(811),v=a(30),t=a(131);class z{static psh(Rb){return z.jze("New",Rb)}static qsh(Rb){return z.jze("Open",Rb)}static Uye(Rb,xc){return z.Pha("LoadingMenuSection",z.dBi,Rb,z.tqb("lblLoading",xc))}static uqb(Rb,xc,ed=null,xd=null){return z.Pha("MessageMenuSection",z.ewf,xc,z.tqb("lblMessage",Rb,ed,xd))}static NYg(Rb){return z.Uye(Rb,CommonUIStrings.l_VoicedLoadingText)}static OYg(Rb,xc){return z.uqb(CommonUIStrings.l_NewCreationLocationMessage,
Rb.ti,xc.MR,xc.Moa)}static MYg(Rb,xc){return z.uqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,xc.Moa,"\n\n"),Rb.ti)}static Wye(Rb){return z.uqb(CommonUIStrings.l_NewGenericErrorMessage,Rb.ti)}static KYg(Rb,xc,ed){return z.Pha("menuNewBlank",z.mci,ed?Rb.ti:null,z.oqb(Rb.pbf,Rb.qbf,Rb.rbf,null,Rb.Oka,Rb.izb,xc,"blank"))}static JZg(){return z.tqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static gze(){return z.tqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static KZg(Rb,
xc){return z.Pha("menuNewTemplates",Rb,null,xc)}static IYg(Rb,xc){return z.Pha("menuNewMoreTemplates",z.iZe,null,z.oqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,Rb,xc))}static LXg(Rb,xc,ed){let xd="";ed&&xc&&(xd=z.Pha("BrowseMoreMenuSection",z.iZe,null,z.oqb("btnBrowseMore",xc,xc,null,null,null,Rb||"1959943459",ed)));return xd}static tqb(Rb,xc,ed=null,xd=null){let yd=xd;xc&&0<xc.length&&(yd=z.axf.Yrc(xc).trimEnd(),yd=0<=yd.indexOf("{0}")?
String.format(yd,xd):String.format("{0} {1}",yd,xd));ed=ed&&xd?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',v.a.df(ed),v.a.df(xd),v.a.df(yd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',v.a.df(Rb||""),z.axf.Yrc(v.a.df(xc||"")),ed)}static oqb(Rb,xc,ed,xd,yd,Zd,me,wb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
v.a.df(Rb||""),v.a.df(xc||""),v.a.df(ed||""),xd||"32by32",v.a.df(yd||""),v.a.df(Zd||""),me,v.a.df(wb||""))}static jze(Rb,xc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Rb,xc)}static Pha(Rb,xc,ed,xd){ed=ed?String.format('Title="{0}"',v.a.df(ed)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
v.a.df(Rb||""),v.a.df(xc||""),ed,xd)}}z.ewf="MenuMru";z.dBi="MenuLoading";z.mci="MenuHeader";z.iZe="MenuFooter";z.axf=t.a.Vx("\n","&#10;");Object(b.a)(z,"NewAndOpenXmlUtilities",null,[]);var r=a(4),n=a(97),w=a(145),B=a(136);class A{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(A,"HostInformation",null,[]);var y=a(106),x=a(40),F=a(373),I=a(164),L=a(642),X=a(575),P=a(105),G=a(25);class C{constructor(Rb,xc,ed,xd,yd,Zd){this.kUc=this.Yo=this.LSb=null;this.xYb=
this.uTc=!1;this.jfe=0;this.iTc=this.FNc=!1;this.o2=Rb;this.tjb=xc;this.yEa=new d.a(()=>new l.a(ed.value,Object(m.a)(this,this.jxb,"getMoreInfoEventReceived")));this.GAg=xd;this.tra=yd;this.UDg=Zd;this.Imb=this.Hzc;2===this.dL.Mca&&(this.iTc=!0)}get PP(){switch(this.dL.Mca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Fg(){const Rb=this.dL.s$a;Rb.Mb(G.a.newDocument,P.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));Rb.Me(G.a.ssc,
P.a.frame,Object(m.a)(this,this.ssc,"populateNewMenu"),96)}newDocument(Rb,xc,ed,xd,yd){if(1===ed)return 32;if(2===ed&&yd){if(r.AFrameworkApplication.fa.qa("BackstagePremiumTemplateExperienceEnabled")&&yd.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),r.AFrameworkApplication.ub.processAction(G.a.L7i,2);if(yd.MenuItemId&&yd.SourceControlId)return"NewDocumentHome"===yd.SourceControlId&&w.a("NewDocumentFromHomeTab"),this.T1a(yd.MenuItemId,yd.SourceControlId)}return 8}T1a(Rb,
xc){var ed=this.Pnc.n6c;if(null===ed)return 8;var xd=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.ica&&xd){h.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const yd={};yd[F.a.ddg]=Rb;yd[F.a.PP]=this.PP;yd[F.a.lcid]=r.AFrameworkApplication.lcid.toString();yd[F.a.reason]=L.a.createNew;r.AFrameworkApplication.nV().execute(Zd=>{Zd.Oj(I.a.T1a,yd)})}else xd=(new Date).getTime(),
xc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ed,v.a.mf(this.oma),v.a.mf(Rb),v.a.mf(this.PP),v.a.mf(r.AFrameworkApplication.lcid.toString()),v.a.mf(xd.toString()),v.a.mf(xc),v.a.mf(r.AFrameworkApplication.canary),r.AFrameworkApplication.Zi),(ed=r.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==ed&&(xc+="&wdscenarioid="+v.a.mf(ed)),xc+="&"+r.AFrameworkApplication.Pdc(),r.AFrameworkApplication.Mxa&&(xc+="&"+r.AFrameworkApplication.edc()),
(ed=this.Yo?this.Yo.MR:null)&&(xc+="&DestinationUrl="+v.a.mf(ed)),x.a.lf(xc,"_blank",void 0,"CreateNewDocument");2===this.dL.Mca&&h.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:X.a[this.dL.Mca],["Template"]:Rb});return 32}pEi(Rb){let xc=Number.MAX_VALUE,ed=Number.MIN_VALUE;const xd=window.performance;if(xd&&"undefined"!==typeof xd.getEntriesByName){for(let Zd=0;Zd<Rb.length;Zd++){var yd=xd.getEntriesByName(Rb[Zd]);yd&&0<yd.length&&(yd=yd[0],xc=Math.min(parseInt(String(yd.fetchStart)),
xc),ed=Math.max(parseInt(String(yd.responseEnd)),ed))}ed>xc&&h.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ed-xc,["MinFetchStart"]:xc,["MaxResponseEnd"]:ed})}}ssc(Rb,xc,ed,xd,yd){if(1===ed)return this.iTc&&(r.AFrameworkApplication.ON("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.iTc=!1),32;2!==ed||this.FNc||(this.jfe=(new Date).getTime(),h.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.Hzc,["CachedNewMenuXmlExists"]:!!this.LSb,["ShouldCallGetMoreInfo"]:this.dL.supportsGetMoreInfoForPersonalStorage}));return this.B6i(yd)}B6i(Rb){Rb&&(this.LSb?Rb.PopulationXML=this.LSb:(this.dL.supportsGetMoreInfoForPersonalStorage&&!this.Yo&&this.SKi.$Z("Opened New menu",!0),Rb.PopulationXML=this.kOh(this.getTemplateListJson())));return 32}ilf(){return!this.dL.supportsGetMoreInfoForPersonalStorage||!!this.Yo&&3===this.Yo.state&&!!this.Yo.Moa&&!!this.Yo.MR}fti(){return r.AFrameworkApplication.sa&&
r.AFrameworkApplication.sa.Pa.C_?!0:this.ilf()}getTemplateListJson(){if(!this.Hzc||!this.fti())return null;if(this.Imb&&!this.xYb){var Rb="9";const xc=r.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in xc&&(Rb=xc.NumberOfTemplatesInBackstage);let ed=this.PP;"TemplateCollectionId"in xc&&(ed=xc.TemplateCollectionId);Rb=String.format(this.dL.$V+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",v.a.mf(r.AFrameworkApplication.lcid.toString()),v.a.mf(ed),Rb);Boolean.parse(xc.AppendOriginQueryParam||
"false")&&(Rb+="&org=backstage");Boolean.parse(xc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in xc&&(Rb+="&templateTier="+xc.TemplateTier);Rb+="&"+r.AFrameworkApplication.Pdc();r.AFrameworkApplication.Mxa&&(Rb+="&"+r.AFrameworkApplication.edc());this.dL.aFb.Rm(Rb,1,null,null,!1,2,xd=>{this.dL.xca("CreateNewActor.GetTemplateListJson",xd.data);this.NQj(xd.data.te)},xd=>{this.dL.xca("CreateNewActor.GetTemplateListJson",xd.data);this.MQj()},null,void 0,void 0,void 0,void 0,"5");
this.Imb=!1}return this.kUc}NQj(Rb){this.kUc=Rb;this.Imb=!1;this.jJb();if(r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Pa.C_&&B.c()){Rb=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const xc=r.AFrameworkApplication.ica;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.kUc,!0,Rb&&xc))}}MQj(){this.xYb=this.Imb=!0;this.jJb();r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Pa.C_&&B.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",
!1,!1));n.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}K5h(Rb){var xc=0;for(var ed=0;ed<Rb.length;ed++)if("ST"===Rb[ed].ImageType){xc=ed;break}const xd=Rb.length?Rb[xc]:null;Rb=xd?xd.Url||"":"";var yd;let Zd=ed=xc=!1;if(xd&&(yd=xd.AspectRatio))yd=parseFloat(yd),1>yd?xc=!0:1.5<yd?ed=!0:1===yd&&(Zd=!0);else switch(h.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Rb}),this.dL.Mca){case 3:xc=!0;break;case 2:ed=
!0;break;case 5:Zd=!0}return{returnValue:Rb,Mei:xc?"95by123":ed?"123by69":Zd?"100by100":"123by95"}}kOh(Rb){Rb=({mzc:xc}=this.LYg(Rb,this.Pnc,this.Pnc.JHa||"1056925771")).returnValue;if(xc){this.LSb=Rb;var xc=(new Date).getTime()-this.jfe;h.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:xc})}return Rb}jxb(Rb,xc){h.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Yo||3!==Rb.state?2===Rb.state&&(h.ULS.sendTraceTag(590964759,
202,50,"GetMoreInfoResult was bad, need to retry"),this.uTc=!0,this.jJb()):(this.Yo=Rb,xc||this.jJb(),r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Pa.C_&&B.c()&&B.d("setFileMenuHostInformation")&&(Rb=Object.assign(new A,{hostUrl:this.Yo.MR,hostName:this.Yo.Moa,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,folderName:r.AFrameworkApplication.breadcrumbFolderName}),h.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Rb))))}LYg(Rb,
xc,ed){let xd;xd=!1;const yd=this.ilf();let Zd="";this.dL.supportsGetMoreInfoForPersonalStorage&&(this.uTc?(Zd=z.Wye(xc),this.uTc=!1,h.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Yo?yd?Zd=z.OYg(xc,this.Yo):this.Yo.Sji?(xd=!0,this.Imb=!1,Zd=z.MYg(xc,this.Yo),h.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(xd=!0,Zd=z.Wye(xc),h.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Yo.MR,["StorageServiceDisplayNameIsSet"]:!!this.Yo.Moa})):(Zd=z.NYg(xc.ti),h.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));yd&&(Zd+=z.KYg(xc,ed,!Zd)+({mzc:xd}=this.IZg(Rb,ed)).returnValue);return{returnValue:z.psh(Zd),mzc:xd}}IZg(Rb,xc){let ed;ed=!1;if(!this.Hzc)return ed=!0,h.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",mzc:ed};let xd="",yd="",Zd="MenuTemplate";if(this.xYb)xd=
z.gze(),this.xYb=!1,h.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Rb){try{const me=Sys.Serialization.JavaScriptSerializer.deserialize(Rb,!0);xd=this.HZg(me,xc);h.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.bxf&&"OneDrive"===this.oma&&(yd=z.IYg(this.TKi,r.AFrameworkApplication.bxf))}catch(me){h.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:Rb}),
xd=z.gze()}ed=!0}else Zd="MenuLoading",xd=z.JZg(),h.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:z.KZg(Zd,xd)+yd,mzc:ed}}HZg(Rb,xc){let ed="";const xd=[];for(let Zd=0;Zd<Rb.length;Zd++){var yd=Rb[Zd];let me="";if(yd){const wb=yd.Title,$b=yd.AssetId;yd=yd.Thumbnails;$b&&wb&&yd&&({Mei:yd,returnValue:me}=this.K5h(yd),ed+=z.oqb("jbtnNewTemplate"+Zd,wb,null,yd,null,me,xc,$b))}xd[Zd]=me}Rb=new y.a(4,1,5E3,()=>{this.pEi(xd)},106);this.dL.Nnc.Cg(Rb);
return ed}jJb(){this.FNc=!0;this.dL.Uwf.rx(this.Pnc.Hvb);this.FNc=!1}get dL(){return this.o2.value}get Pnc(){return this.tjb.value}get SKi(){return this.yEa.value}get TKi(){return this.GAg.value}get oma(){return this.tra.value}get Hzc(){return this.UDg.value}}Object(b.a)(C,"CreateNewActor",null,[]);var H=a(1335);class J extends H.a{constructor(){super()}Aqe(){this.OT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.OT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.OT(2,CommonUIStrings.l_Open);
this.OT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.OT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.OT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return J.Ma||(J.Ma=new J)}static p2i(Rb){return J.instance.ga(Rb)}}J.Ma=null;Object(b.a)(J,"MruActorIntlHelper",H.a,[]);var M;(function(Rb){Rb[Rb.success=0]="success";Rb[Rb.failure=1]="failure";Rb[Rb.spinner=2]="spinner";Rb[Rb.none=3]="none"})(M||(M={}));Object(b.b)("DisplayState",M);var S=a(41);class W{constructor(Rb,xc,ed,xd,yd,
Zd,me,wb){this.cIc=null;this.hVc=!0;this.KSb="";this.AFg=0;this.FXa=null;this.zOc=3;this.mb=wb;this.o2=Rb;this.qj=xc;this.Gwg=ed;this.Mtg=xd;this.Ltg=yd;this.yEa=new d.a(()=>new l.a(Zd.value,null));this.qxg=new d.a(()=>new l.a(me.value,Object(m.a)(this,this.CJi,"mruEventResultReceived")));this.mb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.mb.qa("UiHostSupportsDocRebootFeatures")}CJi(Rb,xc){this.FXa=Rb;xc||this.PSf()}mgj(){this.Yw.s$a.Me(G.a.rsc,P.a.frame,Object(m.a)(this,this.rsc,"populateMruMenu"),
96)}rsc(Rb,xc,ed,xd,yd){return 1!==ed&&yd?this.y6i(yd):32}y6i(Rb){this.Ush();this.Tsh();Rb.PopulationXML=z.qsh(this.KSb+this.cIc);return 32}Ush(){var Rb=3;let xc=!1;if(this.KSb&&this.AFg===this.FXa.ySj)h.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),Rb=this.zOc;else{h.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ed=this.Yw.Ew();this.FXa=this.BJi.$Z("File Open opened",
!0);this.KSb&&2!==this.zOc&&3!==this.FXa.state?xc=!0:(Rb=this.F3h(this.FXa),r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Pa.C_&&B.c()&&Rb&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Rb,!0)),this.KSb=({KKi:Rb}=this.lOh(this.FXa)).returnValue);ed=this.Yw.Ew()-ed;h.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ed})}2!==Rb&&(ed={["DisplayState"]:M[Rb]},1!==Rb&&(ed.IsStale=xc),h.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",ed));this.zOc=Rb}F3h(Rb){let xc;try{xc=S.c(Rb.Xzd)}catch(ed){xc=null,h.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ed)}return xc}Tsh(){this.hVc?(h.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.cIc=({G4j:this.hVc}=this.JFi()).returnValue):h.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");h.ULS.sendTraceTag(5849633,202,
50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.hVc,["NotDisplayingLink"]:!this.cIc})}lOh(Rb){let xc;1===Rb.state||0===Rb.state?(h.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Rb=2,xc=z.Uye(this.tka(2),this.tka(5))):3===Rb.state&&Rb.Xzd?(xc=this.JYg(Rb.Xzd),Rb=0):(h.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),xc=z.uqb(this.tka(1),this.tka(2)),Rb=1);return{returnValue:xc,KKi:Rb}}JYg(Rb){let xc;const ed=
this.tEb.JHa||"2155708348";if(Rb.length){xc=z.tqb("lblRecentDocuments",this.tka(3));let xd=0;for(let yd=0;yd<Rb.length;yd++){const Zd=Rb[yd];"FileName"in Zd&&"DocumentUrl"in Zd&&"Path"in Zd&&(xc+=z.oqb("MruButton"+yd,Zd.FileName.toString(),Zd.Path.toString(),null,this.tEb.Oka,this.tEb.izb,ed,Zd.DocumentUrl.toString()),Zd.IsPinned&&xd++)}xc=z.Pha("RecentDocumentsMenuSection",z.ewf,this.tka(2),xc);h.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:Rb.length,
["NumPinnedDocuments"]:xd})}else xc=z.uqb(this.tka(0),this.tka(2)),h.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return xc}JFi(){let Rb;Rb=!0;let xc=this.dXg;var ed=this.cXg;if(xc&&ed||!this.Yw.supportsGetMoreInfoForPersonalStorage)Rb=!1;else{const xd=this.ldc.$Z("File Open",!1);3===xd.state&&(xc=xd.MR,ed=xd.Moa,Rb=!1)}ed=ed?String.format(this.tka(4),ed):null;return{returnValue:z.LXg(this.tEb.JHa,ed,xc),G4j:Rb}}PSf(){this.Yw.Uwf.rx(this.tEb.Hvb)}get Yw(){return this.o2.value}get tka(){return this.qj.value}get tEb(){return this.Gwg.value}get dXg(){return this.Mtg.value}get cXg(){return this.Ltg.value}get ldc(){return this.yEa.value}get BJi(){return this.qxg.value}}
Object(b.a)(W,"MruRenderer",null,[]);var O=a(240),T=a(766);class Y{constructor(Rb,xc,ed,xd,yd,Zd,me){this.Yo=null;this.bke=!1;this.Jqa=this.P6d=0;this.NAg=Rb;this.WXa=xc;this.pWb=ed;this.tjb=xd;this.tra=yd;this.o2=Zd;this.yEa=new d.a(()=>new l.a(me.value,Object(m.a)(this,this.jxb,"getMoreInfoEventReceived")))}T1a(){!this.Yo&&this.IAd.supportsGetMoreInfoForPersonalStorage?this.ldc.$Z("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}jxb(Rb){if(!this.Yo&&3===Rb.state)this.Yo=Rb;else if(2===
Rb.state){this.bke?h.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.ldc.$Z("NewDocumentFromStream",!0),this.bke=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.P6d=(new Date).getTime();var Rb=this.EGh.n6c;if(null===Rb)this.WXa(null);else{var xc=this.pWb.menuItemId,ed=this.pWb.xG,xd=this.pWb.zOj,yd=this.pWb.JGh;this.Jqa="streamBase64"===xd?yd.length/1024:0;h.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.PP,
this.Jqa);var Zd=(new Date).getTime();Rb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Rb,v.a.mf(this.oma),v.a.mf(xc),v.a.mf(this.PP),v.a.mf(r.AFrameworkApplication.lcid.toString()),v.a.mf(Zd.toString()),v.a.mf(ed),v.a.mf(r.AFrameworkApplication.canary),r.AFrameworkApplication.Zi,v.a.mf(xd));Rb+="&"+r.AFrameworkApplication.Pdc();r.AFrameworkApplication.Mxa&&(Rb+="&"+r.AFrameworkApplication.edc());(xc=this.Yo?this.Yo.MR:null)&&
(Rb+="&DestinationUrl="+v.a.mf(xc));this.IAd.aFb.Rm(Rb,2,yd,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.NKi,"newDocumentFromStreamSuccessHandler"),Object(m.a)(this,this.MKi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}NKi(Rb){if(Rb&&Rb.data&&Rb.data.te)if(({At:xc}=S.d(Rb.data.te)).returnValue)if(Rb=xc,Rb.StatusCode!==O.a.mP&&Rb.StatusCode!==O.a.Ssb)h.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.PP,this.Jqa,Rb.StatusCode),this.WXa(null);else if(Rb.NewDocumentUrl&&""!==Rb.NewDocumentUrl){var xc=(new Date).getTime()-this.P6d;h.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.PP,this.Jqa,xc);this.NAg(Rb.NewDocumentUrl)}else h.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.PP,this.Jqa),this.WXa(null);else h.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.PP,this.Jqa,{["ResponseData"]:T.a.igb(Rb.data.te)}),this.WXa(null);else h.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.PP,this.Jqa),this.WXa(null)}MKi(Rb){Rb&&Rb.data&&h.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.PP,this.Jqa,Rb.data.status);this.WXa(null)}get PP(){switch(this.IAd.Mca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get EGh(){return this.tjb.value}get oma(){return this.tra.value}get IAd(){return this.o2.value}get ldc(){return this.yEa.value}}Object(b.a)(Y,"NewDocumentFromStreamOperation",null,[]);class va{constructor(Rb,xc,ed,xd){this.tjb=Rb;this.tra=xc;this.o2=ed;this.pxg=xd}create(Rb,xc,ed){return new Y(Rb,xc,ed,this.tjb,this.tra,this.o2,this.pxg)}}Object(b.a)(va,"NewDocumentFromStreamOperationFactory",null,[866]);var ca=a(83),V=a(518),ra=a(55);
class N{get name(){return"Common.App.NewAndOpen.UX"}Vh(Rb){Rb.register(va,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").xc().Fc(()=>new va(new d.a(()=>r.AFrameworkApplication.sa.Pa.ygd()),new d.a(()=>r.AFrameworkApplication.oma),new d.a(()=>Rb.Jh("Common.INewAndOpenCommonHelpers")),new d.a(()=>Rb.Jh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.fa.Fv(()=>{this.zzb()})}zzb(){const Rb=
V.a.mr(ca.a.instance.Ub("Common.INewAndOpenCommonHelpers")),xc=V.a.mr(ca.a.instance.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.oma&&ra.Task.WAA.call(null,Rb,xc).continueWith(()=>{const ed=new C(new d.a(()=>Rb.result),new d.a(()=>r.AFrameworkApplication.sa.Pa.ygd()),new d.a(()=>xc.result),new d.a(()=>r.AFrameworkApplication.sa.Pa.zgd().JHa||"1959943459"),new d.a(()=>r.AFrameworkApplication.oma),new d.a(()=>r.AFrameworkApplication.Hri));ed.Fg();ed.jJb()});if(r.AFrameworkApplication.sRf){const ed=
V.a.mr(ca.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>"));ra.Task.WAA.call(null,Rb,xc,ed).continueWith(()=>{const xd=new W(new d.a(()=>Rb.result),new d.a(()=>J.p2i),new d.a(()=>r.AFrameworkApplication.sa.Pa.zgd()),new d.a(()=>r.AFrameworkApplication.o2i),new d.a(()=>r.AFrameworkApplication.n2i),new d.a(()=>xc.result),new d.a(()=>ed.result),r.AFrameworkApplication.fa);xd.mgj();xd.PSf()})}}dispose(){}}Object(b.a)(N,"UXPackageManager",null,[4,5,2]);var ea=a(1177),Ba=a(1184),ka=a(1157),Ka=a(1193),
Oa=a(1185),wa;(function(Rb){Rb[Rb.myFiles=0]="myFiles";Rb[Rb.recent=1]="recent";Rb[Rb.currentFolder=2]="currentFolder";Rb[Rb.yourPhone=3]="yourPhone"})(wa||(wa={}));Object(b.b)("SharedFilePickerLandingLocation",wa);class qa{constructor(Rb){this.zMa=this.Ibb=null;this._initialized=!1;this.Gmd=Rb}g3a(Rb){this._initialized||(Rb.uo(I.a.VRf),Rb.em(I.a.VRf,Object(m.a)(this,this.mYi,"onReceivedPickerResponse")),this._initialized=!0)}Agd(Rb){return this.zMa=new Promise((xc,ed)=>{const xd={};xd[F.a.n5i]=Rb;
this.Ibb=(yd,Zd)=>{""===Zd?(h.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),xc(yd)):("Canceled"===Zd?h.ULS.sendTraceTag(572548164,306,50,Zd):h.ULS.sendTraceTag(556901065,306,10,Zd),ed(Zd))};this.Gmd.execute(yd=>{this.g3a(yd);yd.Oj(I.a.t2i,xd)})})}mYi(Rb){this.Ibb(Rb.Values[F.a.ruj],void 0===Rb.Values[F.a.EGd]||null===Rb.Values[F.a.EGd]?"":Rb.Values[F.a.EGd])}ftd(){return r.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}tIe(Rb,xc,ed,xd,yd,Zd,me){const wb={};wb[F.a.duj]=
Rb;wb[F.a.titleText]=xc;wb[F.a.SQg]=ed;wb[F.a.TQg]=xd;wb[F.a.UQg]=!1;wb[F.a.Ynh]=!0;wb[F.a.QGh]=yd;wb[F.a.r5i]=Zd;wb[F.a.q5i]=wa[me];B.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(wb[F.a.s5i]="Dark");return wb}}Object(b.a)(qa,"SharedFilePickerManager",null,[304]);class aa{constructor(){this.gb=null}get name(){return"Common.App.SharedFilePicker"}Vh(Rb){this.gb=Rb;Rb.register(qa,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").xc().Fc(()=>
new qa(Rb.Ub("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.fa.Fv(()=>{this.zzb()})}zzb(){this.gb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Ei(new aa)}}Object(b.a)(aa,"SharedFilePickerPackage",null,[4,5]);var ia=a(1287),Ha=a(835),Z=a(27);class la{get name(){return"Common.App.WildFire"}jpe(Rb){let xc=!1;Rb&&(Rb.C5c(),Rb.a_g&&(xc=!1));return xc}Sbh(){var Rb=r.AFrameworkApplication.sa.Pa;Rb=new ia.a(Rb.Fj,Ha.a.nec(),!1,1===Rb.H6);
this.jpe(Rb)&&h.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}F6b(Rb,xc,ed,xd,yd,Zd){Rb=new ia.a(Rb,ed,xd,xc,yd,Zd);this.jpe(Rb)&&h.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}bih(){const Rb=r.AFrameworkApplication.sa.Pa;var xc=r.AFrameworkApplication.fa;const ed=Rb.Fj,xd=1===Rb.H6;if(xc.qa(Ha.a.u7h(ed))){var yd=Ha.a.nec(),Zd=8<Z.a.u6a;if(2!==ed||2!==yd||!xd){xc=xc.qa(Ha.a.v7h(ed));var me=Rb.H_f(),wb=()=>Rb.Qx;xc&&!Ha.a.zrd(Ha.a.jfd(ed))&&this.F6b(ed,xd,yd,Zd,wb,me)}}}init(){var Rb=
r.AFrameworkApplication.fa;const xc=Rb.qa("WildFireChromeExtensionEnabled");Rb=Rb.qa("WildFireChromeExtensionBar")&&xc;Ha.a.Jzc&&Rb&&!Ha.a.zrd(Ha.a.HCe)?this.Sbh():(document.body&&Ha.a.EGj&&this.bih(),r.AFrameworkApplication.ub.Mb(G.a.Jvd,P.a.frame,Object(m.a)(this,this.Jvd,"launchWildFireBusinessBar")))}Jvd(Rb,xc,ed,xd,yd){if(1===ed)return 32;if(!yd)return 8;this.F6b(yd.app,yd.mode,yd.platform,yd.useTwoButton,null,null);return 32}dispose(){}Vh(){}static main(){e.a.instance.Ei(new la)}}Object(b.a)(la,
"PackageManager",null,[4,5]);var Xa=a(1275);a(1063);var Za=a(9),xa=a(692),fa=a(50),ua=a(37),sa=a(183),sb=a(1);class hb{constructor(Rb){this.Th=Rb}nc(){return!1}executeCommand(Rb,xc,ed){return 2!==this.Th.ae(G.a.newDocument,2,ed)?ra.Task.Ta(!0):sa.a(xc.command)}wc(Rb,xc){return 1056925771===xc.command}Jc(Rb,xc,ed){Rb=!0;switch(xc){case "PopulateNewMenu":this.Th&&(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&r.AFrameworkApplication.Rt("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(r.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",r.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Th.ae(G.a.ssc,2,ed));break;default:Rb=!1}return Rb}}Object(b.a)(hb,"CreateNewCommandHandler",null,[165]);class bb extends xa.a{constructor(Rb){super(Rb)}nd(){const Rb=fa.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),xc=fa.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.Ya);ua.TaskExtensions.Aa(ua.TaskExtensions.Fd([Rb,xc],this.la),()=>{this.Yc([new hb(r.AFrameworkApplication.ub)])},this.la,3)}static ka(Rb){xa.a.Nd(87,new bb(Rb))}}Object(b.a)(bb,"CreateNewCommandHandlerFactory",xa.a,[]);var lb=a(1170),Fa=a(1065),Na=a(1211),Mb=a(511),dc=a(101),Cb=a(188),Tb=a(11),Jb=a(22),eb=a(281),za=a(992);class ha{}ha.create="Create";ha.activate="Activate";ha.close="Close";ha.remove="Delete";ha.duplicate="Duplicate";Object(b.a)(ha,"Actions",null,[]);var fb=a(29),
rb=a(44);class pa extends ra.Task{constructor(Rb){super();this.Q3d=null;this.S3d=0;this.ASb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.XXa=this.XXa()}catch(xc){this.dispose(),this.wBa(xc),this._state=3}};this.du=Rb;this.XXa=this.OFc;this.moveNext()}OFc(){this.Q3d=fb.a.Zc(3,2,0,1660,0,-1244327602,"MsFormDeleteConfirmation");this.ASb=rb.a(this.du.$).vj(this.Q3d).G();this.ASb.isCompleted||(this._state=2,this.ASb.Q$a(this.moveNext));return this.Umg}Umg(){this.S3d=
this.ASb.$Z();0===this.S3d&&(this.du.$.workbookContext.Options=Tb.HelperMethods.KO(!1,this.du.$.workbookContext.Options,2048),this.du.deleteMsFormMetaDataSheet());this._state=3;this.sMb(!0)}dispose(){}}Object(b.a)(pa,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",ra.Task,[2]);class Ma{}Ma.action="Action";Ma.cJh="FlexPane";Ma.jbc="formId";Ma.id="id";Ma.title="Title";Ma.ARb="XlWorkbookId";Ma.ZKh="Fragment";Ma.host="Host";Ma.xTj="TopView";Ma.I2="auth_pvr";Object(b.a)(Ma,
"Parameters",null,[]);var Ja=a(60);const Ga=(Rb,xc,ed,xd,yd,Zd,me=null)=>{me=Rb.Na(9,me);me.sheetName=xc;me.confirmationChoice=!0;return Ja.g(Rb,"DeleteSheet",me,ed,xd,yd,Zd,0)};class La{constructor(Rb){this.Bo="Excel";this.$=Rb;this.cV=za.a.current}get hasMsForm(){return dc.c(this.$.hg)}get Bnc(){return this.$.workbookContext.MsFormId}get wRb(){return this.$.workbookContext.MsFormDocUrl}get I2(){return Jb.a.contains(this.$.pv.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}nc(Rb,xc){switch(xc){case -105284469:return!dc.i(this.$.hg)||
this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(Rb,xc){Rb=ua.TaskExtensions.Rj();xc=xc.command;switch(xc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Rb=this.deleteMsForm();break;default:Rb=sa.a(xc)}return Rb}wc(Rb,xc){if(!this.$.ea.Vg.get(61))return!1;Rb=!1;switch(xc.command){case -105284469:Rb=
dc.i(this.$.hg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Rb=this.hasMsForm}return Rb}Jc(){return!1}insertMsForm(){const Rb=v.a.Sq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),xc={},ed={};xc[Ma.action]=ha.create;xc[Ma.I2]=this.I2;ed[Ma.action]=ha.create;ed[Ma.ARb]=encodeURIComponent(this.wRb);ed[Ma.host]=this.Bo;ed[Ma.title]=encodeURIComponent(Rb);this.kEb(xc,ed);this.$.workbookContext.Options=Tb.HelperMethods.KO(!1,this.$.workbookContext.Options,
2048)}editMsForm(){const Rb={},xc={};Rb[Ma.I2]=this.I2;xc[Ma.jbc]=this.Bnc;xc[Ma.ARb]=encodeURIComponent(this.wRb);xc[Ma.host]=this.Bo;this.kEb(Rb,xc)}previewMsForm(){const Rb={},xc={};Rb[Ma.I2]=this.I2;xc[Ma.jbc]=this.Bnc;xc[Ma.ARb]=encodeURIComponent(this.wRb);xc[Ma.host]=this.Bo;xc[Ma.xTj]="Preview";this.kEb(Rb,xc)}sendMsForm(){const Rb={},xc={};Rb[Ma.I2]=this.I2;xc[Ma.jbc]=this.Bnc;xc[Ma.cJh]="SendForm";xc[Ma.ARb]=encodeURIComponent(this.wRb);xc[Ma.host]=this.Bo;this.kEb(Rb,xc)}deleteMsForm(){return new pa(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.pD(new Cb.a(158,
0,(Rb,xc,ed)=>Ga(this.$.pa.Vw,this.cV.Ovb,eb.b(Rb,()=>{this.nlh()}),xc,ed,null)))}nlh(){const Rb={},xc={};Rb[Ma.action]=ha.remove;Rb[Ma.I2]=this.I2;xc[Ma.action]=ha.remove;xc[Ma.host]=this.Bo;xc[Ma.jbc]=encodeURIComponent(this.Bnc);xc[Ma.ARb]=encodeURIComponent(this.wRb);this.kEb(Rb,xc)}kEb(Rb,xc){const ed=this.$.va.MsFormBaseUrl+"/Pages/DesignPage.aspx";let xd="";var yd="";if(xc){for(let wb in xc){var Zd=wb,me=xc[wb];yd+=yd.length?"&":"";yd+=Zd+"="+me}Rb||(Rb={});Rb[Ma.ZKh]=encodeURIComponent(yd)}if(Rb)for(let wb in Rb)xc=
wb,yd=Rb[wb],xd+=xd.length?"&":"?",xd+=xc+"="+yd;window.open(ed+xd,"_blank")}}Object(b.a)(La,"MsFormCommandHandler",null,[165]);class nb extends xa.a{constructor(Rb){super(Rb)}nd(){const Rb=fa.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya);ua.TaskExtensions.Aa(ua.TaskExtensions.Fd([Rb],this.la),()=>{this.Yc([new La(this.$)])},this.la,3)}static ka(Rb){Rb.ea.Vg.get(61)&&xa.a.Nd(215,new nb(Rb))}}Object(b.a)(nb,"MsFormCommandHandlerFactory",xa.a,[]);var Lb=a(222);class ac extends Lb.a{constructor(Rb){super();
this.$=Rb;this.Fb()}create(){ua.TaskExtensions.Aa(fa.GetServiceTaskFactory.create(this.$.da,164,this.la,this.Ya),()=>{this.ob(new N)},this.la,3)}}Object(b.a)(ac,"NewAndOpenUXFactory",Lb.a,[]);class ib{constructor(Rb,xc){this.Th=xc;this.$=Rb}executeCommand(Rb,xc,ed){Rb=2;switch(xc.command){case G.a.openUrlInNewTab:Rb=this.Th.ae(G.a.openUrlInNewTab,2,ed);break;case G.a.dQa:Rb=this.Th.ae(G.a.dQa,2,ed)}return 2!==Rb?ra.Task.Ta(!0):sa.a(xc.command)}wc(Rb,xc){return xc.command===G.a.openUrlInNewTab||xc.command===
G.a.dQa}Jc(Rb,xc,ed){return"PopulateMruMenu"===xc?(this.Th.ae(G.a.rsc,2,ed),!0):!1}nc(){return!1}}Object(b.a)(ib,"OpenFromMruCommandHandler",null,[165]);class Ra extends xa.a{constructor(Rb){super(Rb)}nd(){const Rb=fa.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),xc=fa.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Ya);ua.TaskExtensions.Aa(ua.TaskExtensions.Fd([Rb,xc],this.la),()=>{this.Yc([new ib(this.$,r.AFrameworkApplication.ub)])},this.la,3)}static ka(Rb){xa.a.Nd(88,new Ra(Rb))}}
Object(b.a)(Ra,"OpenFromMruCommandHandlerFactory",xa.a,[]);var ya=a(1147),Va=a(1186),oa=a(1225),kb=a(1068),Sa=a(1166),U=a(1069),ta=a(1070),ub=a(1171),hc=a(1212),Bc=a(1213),Qa=a(82),na=a(371),ab=a(99),Gb=a(21),fc=a(372);class pb{constructor(Rb,xc){this.sheetName=null;this.value=!1;this.sheetName=Rb;this.value=xc}getSheetName(){return this.sheetName}Bwa(){return this.value}}Object(b.a)(pb,"MacroRecorderSheetOptionToggledPayload",null,[125]);const Ea=(Rb,xc,ed,xd,yd,Zd,me,wb=null)=>{wb=Rb.Na(9,wb);wb.sheetName=
xc;wb.show=ed;return Ja.g(Rb,"ShowGridlines",wb,xd,yd,Zd,me,0)},xb=(Rb,xc,ed,xd,yd,Zd,me,wb=null)=>{wb=Rb.Na(9,wb);wb.sheetName=xc;wb.show=ed;return Ja.g(Rb,"ShowHeadings",wb,xd,yd,Zd,me,0)},bc=(Rb,xc,ed,xd,yd,Zd,me,wb=null)=>{wb=Rb.Na(9,wb);wb.sheetName=xc;wb.directionRtl=ed;return Ja.g(Rb,"ChangeSheetDirection",wb,xd,yd,Zd,me,0)};class zb{constructor(Rb){this.$=Rb}nc(){return!1}executeCommand(Rb,xc){const ed={};this.$.jk(ed);Rb=xc.command;const xd=Object(Qa.a)(ab.a,this.$.xa.getItemByName(ed.SheetName));
if(!xd)return sa.a(Rb);let yd,Zd,me,wb,$b;switch(Rb){case 705559150:case -1411193626:yd=16;Zd=!xd.hideGridLines;me=Ea;$b=183;wb=xd.hideGridLines;break;case -2052321504:case 515737500:yd=4;Zd=!xd.headersVisible;me=xb;$b=184;wb=!xd.headersVisible;break;case -1478455630:yd=2;Zd=!xd.displayRtl;me=bc;$b=185;wb=!xd.displayRtl;Gb.h(this.$).Ea.UYj(Zd);break;default:return sa.a(Rb)}xd.frb(yd,Zd);const uc=()=>new pb(ed.SheetName,wb),Pc=this.$.pa.ya;return na.a(this.$.userOperationManager,(Ad,ba,cb)=>me(Pc,
ed.SheetName,wb,eb.b(Ad,Kb=>{zb.QGb(Kb,xd,yd,Zd)}),eb.a(ba,()=>{zb.cGb(xd,yd,Zd)}),cb,null),Ad=>new Cb.a($b,0,Ad,void 0,uc),xc)}wc(Rb,xc){Rb=!1;switch(xc.command){case -1411193626:case 515737500:case -1478455630:Rb=!0;break;case 705559150:case -2052321504:Rb=fc.a(this.$)}return Rb}Jc(){return!1}static QGb(Rb,xc,ed,xd){fb.a.Oq(Rb.Errors)&&xc.frb(ed,!xd)}static cGb(Rb,xc,ed){Rb.frb(xc,!ed)}}Object(b.a)(zb,"SheetOptionsToggleCommandHandler",null,[165]);class Ub extends xa.a{constructor(Rb){super(Rb)}nd(){this.Yc([new zb(this.$)])}static ka(Rb){xa.a.Nd(100,
new Ub(Rb))}}Object(b.a)(Ub,"SheetOptionsToggleCommandHandlerFactory",xa.a,[]);var wc=a(170),mb=a(178),Db=a(148),Ic=a(64),Hc=a(59),Ab=a(207),db=a(587),Pb=a(91),td=a(250),Vb=a(210),Ac=a(12);class Kc extends Vb.a{constructor(Rb,xc,ed,xd=null){super(Rb,ed,2,xd);this.fMc=null;this.onResize=()=>{const yd=this.EXh();this.Du.setAttribute("width",yd.x.toString());this.Du.setAttribute("height",yd.y.toString());this.GZj(yd);this.DDd()};this.xLe=xc;this.$.VA(this.onResize);this.Bfc()}get Du(){return this.fMc}initialize(){const Rb=
this.$.Eb+"iframeDialog_frame",xc=this.$.Eb+"iframeDialog";this.Qb.style.margin=Tb.HelperMethods.uc(0);this.Qb.style.marginBottom=Tb.HelperMethods.uc(-2);if(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var ed=document.createElement("iframe");ed.id=Rb;ed.frameBorder="0";ed.scrolling="auto";ed.src=this.Pgd(xc);this.Qb.appendChild(ed)}else ed=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',Rb,this.Pgd(xc)),this.Qb.innerHTML=
ed;this.fMc=document.getElementById(Rb);this.domElement.id=xc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.bE(this.onResize);super.dispose()}setFocus(){Ac.DOMElementExtensions.setFocus(this.Du)}onHide(){this.Du.contentWindow.close();Ac.DOMElementExtensions.tf(this.Du);this.fMc=null;super.onHide()}GZj(Rb){const xc=this.domElement.style;xc.width=Tb.HelperMethods.uc(Rb.x);xc.marginLeft=Tb.HelperMethods.uc(-Rb.x/2)}EXh(){const Rb=Ac.DOMElementExtensions.getBounds(document.body);
return new Sys.UI.Point(Math.min(Math.floor(.9*Rb.width),this.xLe.x),Math.min(Math.floor(.9*Rb.height),this.xLe.y))}}Object(b.a)(Kc,"IFrameDialog",Vb.a,[]);var dd=a(5),Vd=a(74),Jd=a(13);class oe extends Kc{constructor(Rb){super(Rb,new Sys.UI.Point(960,680),Jd.a.instance.ga(1258));this.name=dd.a.xPe}get pc(){return"EmbeddingDialog"}Pgd(Rb){const xc=new Sys.StringBuilder(this.$.va.EmbedConfiguratorUrl);Ab.a.Yk(xc,dd.a.lvh,Rb);Vd.a(this.$.va,33)&&Ab.a.Yk(xc,dd.a.ARe,"1");Vd.a(this.$.va,34)&&Ab.a.Yk(xc,
dd.a.CRe,"1");Vd.a(this.$.va,35)&&Ab.a.Yk(xc,dd.a.BRe,"1");return xc.toString()}onShow(){h.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)(oe,"EmbeddingDialog",Kc,[]);var De=a(1239),Ke=a(87),rd=a(80),bf=a(820);class cc{}cc.q6f="FrameDialog_ShareFromEdit";cc.view="FrameDialog_View";cc.UDe="FrameDialog_CloseAndRefresh";cc.sDj="FrameDialog_ShareFromView";cc.edit="FrameDialog_Edit";cc.Cej="FrameDialog_RefreshGrid";cc.e6g="FrameDialog_CloseMe";
cc.dEe="FrameDialog_CloseMeError";cc.ready="FrameDialog_Ready";cc.U5i="FrameDialog_PleaseClose";cc.BK="GotoRange";Object(b.a)(cc,"PostMessageConstants",null,[]);var Wc=a(283),id=a(116),Tc=a(282);class Gd{constructor(){this.BK=null;this.iHd=1461300262}}Object(b.a)(Gd,"SessionUpdateContext",null,[]);class Wd extends Kc{constructor(Rb,xc,ed){super(Rb,new Sys.UI.Point(Wd.Mkh,Wd.mkh),Jd.a.instance.ga(xc?1263:1262));this.$1a=null;this.vNc=!1;this.Qqc=xd=>{const yd=this.$,Zd=new Gd;Zd.BK=xd.Values[cc.BK];
let me=!1;switch(xd.MessageId){case cc.q6f:this.sv();me=!0;Zd.iHd=1334518759;break;case cc.view:this.Yoa=Jd.a.instance.ga(1263);this.zjg(!0);break;case cc.UDe:this.sv(),me=!0}xd=new Cb.a(140,0,(wb,$b,uc)=>Wc.n(yd.pa.ya,eb.b(wb,this.FZi),$b,uc,Zd));xd.flags=me?16:80;yd.userOperationManager.Kc(xd,this.Wd)};this.lRi=()=>{const xd=this.$;xd.va.SurveyRedirectUrl?(this.sv(),xd.Xc(1305810481,0,8,null)):(this.Yoa=Jd.a.instance.ga(1262),this.zjg(!1))};this.TZi=()=>{const xd=this.$;this.sv();xd.Xc(1334518759,
0,8,null)};this.Woc=xd=>{const yd=this.$;this.sv();xd.MessageId===cc.dEe&&yd.ea.Odd()};this.iYi=()=>{this.vNc=!0;this.raiseEvent(Wd.Svd)};this.FZi=(xd,yd)=>{if(!Tc.a(xd)){xd=this.$;if(yd.BK){const Zd=xd.ea.xa;if(Zd.contains(yd.BK.SheetName))this.Hpc(yd);else{let me=null;me=()=>{Zd.Ena(me);this.Hpc(yd)};Zd.oha(me)}}1461300262!==yd.iHd&&xd.Xc(yd.iHd,0,8,null)}};this.Nce=xc;this.Wd=ed}wNg(Rb){this.addHandler(Wd.Svd,Rb)}hkj(Rb){this.removeHandler(Wd.Svd,Rb)}get pc(){return"FormDialog"}get Kjf(){return this.vNc}get c8a(){return this.Nce}dispose(){Ke.a.Ia(this.$1a);
this.$1a=null;super.dispose()}initialize(){super.initialize();const Rb=rd.a.oba(this.$.va.FormLightBoxUrl),xc=this.$1a=new De.a(this.Du.contentWindow,Rb);xc.isEnabled()&&xc.CGa(Rb)&&(this.vna(cc.q6f,this.Qqc),this.vna(cc.view,this.Qqc),this.vna(cc.UDe,this.Qqc),this.vna(cc.sDj,this.TZi),this.vna(cc.edit,this.lRi),this.vna(cc.Cej,this.Qqc),this.vna(cc.ready,this.iYi),this.vna(cc.e6g,this.Woc),this.vna(cc.dEe,this.Woc))}close(Rb){Rb===this.OM&&this.Kjf&&this.$1a.send(new bf.a(cc.U5i))||super.close(Rb)}Pgd(){return this.rIe(this.c8a)}rIe(Rb){const xc=
this.$.va,ed=new Sys.StringBuilder(xc.FormLightBoxUrl);Ab.a.Yk(ed,dd.a.HKh,this.$.ea.sessionId);Ab.a.Yk(ed,dd.a.FKh,Rb?dd.a.GKh:dd.a.EKh);id.a.bpb(ed,xc);return ed.toString()}zjg(Rb){this.vNc=!1;this.Du.src=this.rIe(Rb);this.Nce=Rb}vna(Rb,xc){this.$1a.uo(Rb);this.$1a.em(Rb,xc)}Hpc(Rb){const xc=this.$.ea.xa.getItemByName(Rb.BK.SheetName);xc&&0===xc.ZB&&Gb.h(this.$).pg(Rb.BK,null,null,null,20,"FormDialog.OnItemInserted")}}Wd.Mkh=900;Wd.mkh=1200;Wd.Svd="lightBoxReady";Object(b.a)(Wd,"FormDialog",Kc,
[220]);var Dd;(function(Rb){Rb[Rb.comment=10]="comment";Rb[Rb.range=12]="range";Rb[Rb.table=13]="table";Rb[Rb.chart=14]="chart";Rb[Rb.sheet=15]="sheet"})(Dd||(Dd={}));Object(b.b)("NavigationType",Dd);var Kd=a(975),we=a(108),We=a(19),Od=a(557),le=a(941),de=a(285),Re=a(752),Ee=a(53);class Te extends Re.a{constructor(Rb,xc,ed,xd,yd,Zd=0,me){super(Rb,Jd.a.instance.ga(xc),!1);this.htmlSanitizationHelper=null;this.message=ed;this.dNi=xd;this.f3d=yd;this.operationFlags=Zd;this.htmlSanitizationHelper=me}get pc(){return"WebMethodConfirmationDialog"}get iC(){return 1005}get vIa(){return this.operationFlags}initialize(){let Rb=
"<div class='"+we.a.qp+"'>\r\n\t<div class='"+we.a.ORe+"'>\r\n\t\t<div class='"+We.a.LDe+"'>\r\n\t\t\t<img src='{0}' class='"+We.a.JUe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+we.a.QRe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";Rb=String.format(Rb,Ee.a.Ge(13),Jd.a.instance.ga(25),Jd.a.instance.ga(this.message));this.htmlSanitizationHelper&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
this.htmlSanitizationHelper.sk(this.Qb,Rb):this.Qb.innerHTML=Rb;this.addButton(0,this.dNi);this.addButton(1);super.initialize()}pH(){return this.f3d}}Object(b.a)(Te,"WebMethodConfirmationDialog",Re.a,[]);class Ae extends Kd.a{constructor(Rb,xc){super(Rb,Jd.a.instance.ga(1265));this.htmlSanitizationHelper=this.VUa=this.tSa=this.textBox=null;this.sJf=()=>{const ed=this.$;this.sv();const xd=new Te(ed,1268,1269,1270,(yd,Zd,me)=>{var wb=ed.pa.ya.Wb(),$b=ed.pa.ya;wb=$b.Na(1,wb);return Ja.g($b,"UnshareForm",
wb,yd,Zd,me,null,0)},16,this.htmlSanitizationHelper);xd.initialize();xd.ug()};this.htmlSanitizationHelper=xc}get pc(){return"ShareFormDialog"}dispose(){this.VUa&&this.VUa.Pda(this.sJf);Ke.a.qc([this.textBox,this.tSa,this.VUa]);this.VUa=this.tSa=this.textBox=null;super.dispose()}initialize(){let Rb="<div class='"+we.a.qp+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+we.a.v3a+"'>\r\n\t<input type='text' id='{1}' class='"+we.a.sF+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
Rb=String.format(Rb,Jd.a.instance.ga(1266),"sfd_input","sfd_unshare",We.a.hq,Jd.a.instance.ga(1267));this.htmlSanitizationHelper&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.sk(this.Qb,Rb):this.Qb.innerHTML=Rb;this.textBox=new de.a(this.getElementById("sfd_input"));this.tSa=new le.a(this.textBox.domElement);this.VUa=Od.a.create(this.getElementById("sfd_unshare"));
this.VUa.V2(this.sJf);this.textBox.text=Jd.a.instance.ga(736);this.textBox.enabled=!1;this.textBox.readOnly=!Z.a.Xg;this.addButton(1,10);super.initialize()}o0a(){return(Rb,xc,ed)=>{var xd=this.$.pa.ya.Wb(),yd=this.$.pa.ya;Rb=this.O4a(Rb);xc=this.aLa(xc);xd=yd.Na(1,xd);return Ja.g(yd,"ShareForm",xd,Rb,xc,ed,null,0)}}i0(Rb,xc,ed){this.textBox.text=Rb.Result;this.textBox.enabled=!0;Ac.DOMElementExtensions.setVisible(this.VUa.domElement,!0);super.i0(Rb,xc,ed)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(Rb){}super.setFocus()}}Object(b.a)(Ae,"ShareFormDialog",Kd.a,[]);var kf=a(246),Oe=a(6),$a=a(81),Zb=a(253),Da=a(69),Pa=a(621),tb=a(140),Ib=a(424),Yb=a(255),vc=a(17),Zc=a(252);class nd extends mb.a{constructor(Rb,xc,ed){super();this.vAe=this.wAe=!1;this.L3a=0;this.lja=!1;this.BOi=()=>{this.wAe=!0;this.r8f()};this.$=Rb;this.Va=xc;this.wK=ed;Da.a(this.$).RKd(new tb.a(Oe.a.uhg,Oe.a.idle,nd.O2g),new kf.a(Oe.a.bEe,Oe.a.b0,null,Oe.a.hP,Oe.a.idle))}get CFc(){return dc.b(this.$.hg)}get GPd(){return this.$.isEditMode&&
(this.$.ea.Cqh||this.$.zN)}nc(Rb,xc){switch(xc){case 353606613:case -1099009678:case 192430811:return!sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$6f();case 783415632:return!sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.$6f();case 869186573:return this.a7f();case -1570751769:case 1986648902:return 131072!==(this.$.$U&131072);case 330035228:return!(this.j4a(!0)&&this.CFc);case -509039657:return!(this.j4a()&&this.CFc);
case 1334518759:return!(this.j4a()&&this.CFc&&this.HAe())}return!1}$6f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.a7f()}a7f(){const Rb=this.$.workbookContext.FullDocumentInfo,xc=Yb.a()&&this.$.ea.Vg.get(5);return!Rb.FileSharingUrl&&!xc}executeCommand(Rb,xc,ed){Rb=this.$.workbookContext.FullDocumentInfo;var xd=G.a.workflow,yd=ua.TaskExtensions.Rj();const Zd=xc.command;if(Zd===xd||-266099===Zd)return this.bbi(xc,xd,Rb);switch(Zd){case 1986648902:this.F5f();break;case -1570751769:this.F9h(xc);
break;case 869186573:xc=G.a.rDj;yd=r.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");xd=null;(sb.EwaSettings.ma(545)||yd)&&ed&&"CopyLink"===ed.SourceControlId?(xd={},xd[F.a.aNb]="copy",xc=G.a.p6f):yd&&ed&&"ManageAccess"===ed.SourceControlId?(xd={},xd[F.a.aNb]="manageAccess",xc=G.a.tDj):ed&&"LinkToComment"===ed.SourceControlId&&(xd={},xd[F.a.aNb]="copy",xd[F.a.lTd]=ed.navId,xc=G.a.p6f);yd=this.z9f(Rb,xd);w.c(xc);break;case -1099009678:yd=this.Vyc(12,Rb);break;case 192430811:yd=this.Vyc(13,Rb);break;
case 353606613:yd=this.Vyc(14,Rb);break;case 783415632:yd=this.Vyc(15,Rb);break;case -59906385:case 1197060601:this.mai(xc,Rb);break;case 1305810481:this.u$e(!1,xc);break;case 330035228:this.u$e(!0,xc);break;case -509039657:sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?ua.TaskExtensions.Aa(fa.GetServiceTaskFactory.Oa(this.$.da,498,499,0),me=>{this.deleteForm(me.result)},this.$.la,
3):this.deleteForm(null);break;case 1334518759:xc.yAb=!0;sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?ua.TaskExtensions.Aa(fa.GetServiceTaskFactory.Oa(this.$.da,498,499,0),me=>{this.shareForm(me.result)},this.$.la,3):this.shareForm(null);break;case 710925581:Hc.a.yg.ozc("710925581")&&(yd=ua.TaskExtensions.Aa(this.wK.value,me=>{me.result.Oj(I.a.conversation,{})},this.la,3));break;
case 327119921:this.s9h();break;default:yd=sa.a(Zd)}return yd}wc(Rb,xc){Rb=!1;xc=xc.command;if(xc===G.a.workflow)return!0;switch(xc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Rb=!0;break;case 353606613:case -1099009678:case 192430811:Rb=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;
case 783415632:Rb=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return Rb}Jc(Rb,xc,ed){if("PopulateFormMenu"===xc){xc=this.CFc?this.HAe()?nd.VEh:nd.WEh:nd.RKi;Rb=this.Va.Ec();for(let xd=0;xd<xc.length;xd++)Rb.buttons.push(this.Va.pb(xc[xd]));xc=this.Va.cq("Forms.Flyout");xc.tc.push(Rb);ed.MenuItems=xc.QC();return!0}return!1}bbi(Rb,xc,ed){return this.GPd&&Rb.command===xc?(this.EPd(Rb,-266099),ua.TaskExtensions.tba()):ua.TaskExtensions.Aa(this.wK.value,
xd=>{db.a(xd.result,I.a.workflow,null,ed.WorkflowPostMessage)||Tb.HelperMethods.lf(ed.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}HAe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Vg.get(26)}s9h(){var Rb=wc.a.create().toString();h.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${Rb}`);var xc=this.$.frame,ed=xc.o$a,xd=this.$;const yd=new Zc.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));
yd.Xi("deeplinkId",Rb);yd.Xi("lm","deeplink");Rb=yd.Xi;var Zd={};const me=new Zc.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));me.Xi("auth","2");me.Xi("flight","officeunihost");me.Xi("source","TEAMS-ELECTRON.meetingStage.deeplink");var wb={};wb.fileType=v.a.I4(xd.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);wb.objectUrl=xd.workbookContext.FullDocumentInfo.WorkbookPath;wb.baseUrl=xd.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{xd=xd.workbookContext.WorkbookFileVersionId;
let $b=decodeURIComponent(xd);for(;xd!=$b;)xd=$b,$b=decodeURIComponent(xd);0>xd.indexOf("{")||0>xd.indexOf("}")?(h.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${xd}`),xd=""):xd=xd.substring(xd.indexOf("{")+1,xd.indexOf("}")).toLowerCase()}wb.fileId=xd;wb=S.c(S.c(wb));me.Xi("subEntityId",wb.substring(1,wb.length-1));Zd.appSharingUrl=me.toString();Zd.appId=r.AFrameworkApplication.fa.Xa("TeamsAppId");Zd=JSON.stringify(Zd);Rb.call(yd,"appContext",Zd);
ed.call(xc,yd.toString(),!0)}F9h(Rb){this.GPd?this.EPd(Rb,1986648902):this.F5f()}u$e(Rb,xc){!Rb&&this.$.va.SurveyRedirectUrl?this.e$i():(Rb=new Wd(this.$,Rb,xc),Rb.initialize(),Rb.ug())}mai(Rb,xc){this.GPd&&1197060601===Rb.command?this.EPd(Rb,-59906385):ua.TaskExtensions.Aa(this.wK.value,ed=>{ed=ed.result;ed&&db.a(ed,I.a.replyWithChanges,null,this.$.ea.Vg.get(8))||(ed=new Sys.StringBuilder(xc.ReplyWithChangesUrl),Ab.a.Yk(ed,Ib.e,Ib.d),Db.a.ntw(ed.toString(),this.$))},this.la,3)}EPd(Rb,xc){const ed=
Da.a(this.$).fd.activityState,xd=new Pb.a(xc,Rb.method,Rb.mode,Rb.$e,Rb.tabName);rb.a(this.$).Ks(new td.a(Oe.a.hy,5,()=>{ed[Zb.a.Kq]=Oe.a.I_f;ed[Pa.a.bWc]=xd;this.$.il.kz("SocialSharingSaveBeforeCommand");this.$.il.lqe(xd.command)}))}F5f(){const Rb=this.$.va.DocumentHostInfo;Rb.HostEmbeddedViewUrl||this.wAe?this.r8f():this.$.he.get(53)&&ua.TaskExtensions.Aa(this.wK.value,xc=>{this.uWj(xc.result)||Db.a.ntw(Rb.FileEmbedCommandUrl,this.$)},this.la,3)}uWj(Rb){return Rb.isEnabled()&&(this.vAe||(this.vAe=
Rb.em(I.a.uAe,this.BOi)))?Rb.Oj(I.a.sGh,null):!1}r8f(){if(Z.a.Fp)Db.a.ntw(this.$.va.EmbedConfiguratorUrl,this.$);else{const Rb=new oe(this.$);Rb.initialize();Rb.ug()}}deleteForm(Rb){const xc=this.$;Rb=new Te(xc,1271,1272,1264,(ed,xd,yd)=>{var Zd=xc.pa.ya.Wb(),me=xc.pa.ya;Zd=me.Na(9,Zd);Zd.surveyId=null;return Ja.g(me,"DeleteSurvey",Zd,ed,xd,yd,null,0)},0,Rb);Rb.initialize();Rb.ug()}shareForm(Rb){const xc=this.$.workbookContext.FullDocumentInfo;this.$.ea.Vg.get(26)?(Rb=new Ae(this.$,Rb),Rb.initialize(),
Rb.ug()):ua.TaskExtensions.Aa(this.wK.value,ed=>{db.a(ed.result,I.a.shareForm,{[F.a.APj]:this.$.workbookContext.SurveyTitle},this.$.ea.Vg.get(10))||Db.a.ntw(xc.ShareFormCommandUrl,this.$)},this.la,3)}e$i(){const Rb=this.$;Rb.va.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const xc=new Sys.StringBuilder(Rb.va.SurveyRedirectUrl);Ab.a.Yk(xc,"startupDialog","FormEdit");const ed=Da.a(this.$),xd=ed.fd.activityState;xd[$a.a.L2]=xc.toString();xd[$a.a.wM]=$a.a.sAd;this.$.il.kz("SocialSharingEnvironmentChange");
rb.a(Rb).Ks(new td.a(Oe.a.hy,5,()=>{const yd=fb.a.Zc(3,2,1316,1317,1318,554412057,"FossEnvironmentUnsupported");ed.fd.tr([yd]);xd[Zb.a.Kq]=Oe.a.uhg}))}j4a(Rb=!1){return(this.$.ea.isEditMode||Rb)&&this.$.ea.Vg.get(25)&&Yb.a()}W3h(Rb){var xc=Gb.h(this.$).ha;const ed=this.$.xa.na?Ic.d(this.$.xa.na):null;if(!ed)return h.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Dd[Rb]}.`),null;var xd=null;14===Rb?xd=this.w3h(xc):12===
Rb?(xd=xc.Jia,xd=Jb.a.contains(xd,"!",!0)?xd.split("!")[1]:xd):13===Rb&&(xc=xc.ra.selectedRanges,xc[0]&&(xc=Gb.h(this.$).Bb.Bj(xc[0])))&&(xd=xc.nj);if(!xd&&15!==Rb)return h.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Dd[Rb]}`),null;xc={};xc[F.a.aNb]="copy";xc[F.a.lTd]=this.VUh(Rb,xd,ed);xc[F.a.uDj]="deepLinkShare";h.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Dd[Rb]} and sectionNameOrId: ${xd} and SheetId: ${ed}`);
return xc}w3h(Rb){if(Rb.Ra.u_&&(Rb=Rb.Ra.$b.floatingObject)&&0===Rb.type){const xc=Rb.id.split(".");if(1<xc.length)return xc[1];h.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Rb.id}`)}return null}VUh(Rb,xc,ed){let xd=Rb+"_";xd=btoa(15===Rb?xd+ed:xd+(xc+"_"+ed));xd=xd.replace(RegExp("\\+","g"),"-");xd=xd.replace(RegExp("\\/","g"),"_");return xd=xd.replace(RegExp("\\=+$","g"),"")}z9f(Rb,xc,ed=!1){return ua.TaskExtensions.Aa(this.wK.value,
xd=>{db.a(xd.result,I.a.sharing,xc,this.$.ea.Vg.get(5))?(h.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${xc?xc[F.a.aNb]:""}`),ed&&sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.lja&&(this.L3a=window.setInterval(()=>{this.wUj()},6E4),this.lja=!0)):Tb.HelperMethods.lf(Rb.FileSharingUrl,"_blank",
void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)}Vyc(Rb,xc){if(15===Rb&&!sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==Rb&&!sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const ed=this.W3h(Rb);if(ed)return h.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${ed[F.a.lTd]}`),this.z9f(xc,ed,!0);h.ULS.sendTraceTag(537151643,
0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Dd[Rb]}`);return null}wUj(){this.lja&&window.clearInterval(this.L3a);sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Xc(638984051,0,0,null),h.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}nd.RKi=[103];nd.VEh=[107,104,105,106];nd.WEh=[104,105];nd.O2g=[new vc.a(Oe.a.bEe,554412057,
0,0,1319),new vc.a(Oe.a.idle,554412057,0,1)];Object(b.a)(nd,"SocialSharingCommandHandler",mb.a,[165]);class hd extends xa.a{constructor(Rb){super(Rb)}nd(){const Rb=new d.a(()=>fa.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya));ua.TaskExtensions.Aa(fa.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),xc=>{this.Yc([new nd(this.$,xc.result,Rb)])},this.la,3)}static ka(Rb){xa.a.Nd(114,new hd(Rb))}}Object(b.a)(hd,"SocialSharingCommandHandlerFactory",xa.a,[]);var Ud=a(1153);class ee{constructor(Rb){this.Th=
Rb}executeCommand(Rb,xc,ed){return 2!==this.Th.ae(G.a.tryOfficeThroughTellMe,2,ed)?ra.Task.Ta(!0):sa.a(xc.command)}wc(Rb,xc){return 215809929===xc.command}Jc(){return!1}nc(){return!1}}Object(b.a)(ee,"TryOfficeThroughTellMeCommandHandler",null,[165]);class ec extends xa.a{constructor(Rb){super(Rb)}nd(){this.Yc([new ee(r.AFrameworkApplication.ub)])}static ka(Rb){xa.a.Nd(207,new ec(Rb))}}Object(b.a)(ec,"TryOfficeThroughTellMeCommandHandlerFactory",xa.a,[]);var Vc=a(157),ud=a(76),ke=a(153),te=a(261),
pe=a(146),rf=a(185);class cf{static jN(){return pe.a.iq(cf.pl,rf.a.Ua(442))}}cf.pl="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(b.a)(cf,"NamedSheetViewTeachingDialogHtml",null,[]);var wf=a(51);class Ge extends te.a{constructor(Rb){super(Rb);
this.stopwatch=this.pp=null;this.$Ji=xc=>{if(1===xc)this.$.Ka.Lb(new Pb.a(-2050946363,ud.a.Db,2,8,null)).continueWith(ed=>{this.pp.setResult(!ke.a(ed)&&ed.result)}),xc="Yes";else{const ed=2===xc;this.pp.setResult(ed);xc=2===xc?"No":"Close";ed&&this.E8i()}this.hDi(xc);this.hide()}}get pc(){return"ShowNamedSheetViewTeachingDialog"}dg(){this.Rb=4;this.stopwatch=this.$.Jb.Ac("UserAction",this.pc);const Rb=Jd.a.instance.ga(1902);this.ng=cf.jN();this.pp=new Vc.a;this.initializeAndShow(Rb,this.$Ji,{});return this.pp.task}Qv(Rb){super.Qv(Rb);
this.oc(1,Jd.a.instance.ga(1904));this.oc(2,Jd.a.instance.Ua(455))}E8i(){this.$.ea.Jnc=!1}hDi(Rb){const xc={};xc.a=this.$.va.UserSessionId;xc.b="NamedSheetViewTeachingDialogClose";xc.c=Rb;xc.e=!0;this.stopwatch&&(this.stopwatch.stop(),xc.d=this.stopwatch.zc);wf.b().Pe(53,xc,!0)}}Object(b.a)(Ge,"NamedSheetViewTeachingDialog",te.a,[]);var Ue=a(155);class gb{constructor(Rb){this.$=Rb;Rb.da.Ga(309,this)}yTa(){if(this.nGj()){if(sb.EwaSettings.ma(569)){this.$.xa.na.Ed.EUd=!0;const Rb=new Vc.a;this.$.Ka.Lb(new Pb.a(-2050946363,
ud.a.Db,2,0,null)).continueWith(xc=>{Rb.setResult(!ke.a(xc)&&xc.result)});return Rb.task}return(new Ge(this.$)).dg()}return ra.Task.Ta(!0)}nGj(){const Rb=this.$.xa.na;return this.$.ea.B$a&&this.$.ea.Jnc&&!Rb.Ed.Iv&&this.$.ea.ZM&&!Ue.g(this.$)}}Object(b.a)(gb,"NamedSheetViewPublic",null,[703]);class Ob extends Lb.a{constructor(Rb){super();this.$=Rb;this.Fb()}create(){this.ob(this.$.da.za(309)||new gb(this.$))}static ka(Rb){Rb.da.Ga(310,new Ob(Rb))}}Object(b.a)(Ob,"NamedSheetViewPublicFactory",Lb.a,
[]);var rc=a(7),Oc=a(187),ld=a(1334),Cd=a(859),Qd=a(462);class re{constructor(Rb,xc,ed,xd,yd,Zd,me){this.title=Rb;this.body=xc;this.P8i=ed;this.primaryButtonAction=xd;this.secondaryButtonAction=Zd;this.h1f=yd;this.targetObject=me}}Object(b.a)(re,"NamedSheetViewTeachingCalloutContent",null,[]);class Ie{constructor(Rb){this.lme=0;this.Scg=Rb}get Qcg(){return this.lme}get n$i(){return this.Qcg<this.Scg.count?this.Scg.oa(this.lme++):null}}Object(b.a)(Ie,"NamedSheetViewTeachingCalloutList",null,[]);var qf=
a(1074);class Pe{constructor(Rb){this.stopwatch=this.k1b=this.UBc=this.SYd=null;this.Rcg=0;this.$=Rb}Dgi(Rb){this.Rcg=Rb;const xc=Object(rc.a)(new Oc.a,{});Pe.fpi(Rb)?(xc.add(new re(Jd.a.instance.Ua(444),Jd.a.instance.Ua(445),Jd.a.instance.ga(1932),()=>{this.qI(2,"Continue");this.fK(!0)},Jd.a.instance.ga(1933),()=>{this.fK();this.qI(1,"ExitGuide")},qf.a())),1===Rb&&xc.add(new re(Jd.a.instance.ga(1934),Jd.a.instance.Ua(447),Jd.a.instance.ga(1932),()=>{this.qI(2,"FirstEnterTempViewContinueSecond");
this.fK(!0)},Jd.a.instance.ga(1933),()=>{this.fK();this.qI(1,"FirstEnterTempViewExitGuideSecond")},qf.a())),xc.add(new re(Jd.a.instance.Ua(448),Jd.a.instance.Ua(449),Jd.a.instance.ga(1932),()=>{this.qI(2,"FirstEnterExitCalloutContinue");this.fK(!0)},Jd.a.instance.ga(1933),()=>{this.fK();this.qI(1,"FirstEnterExitCalloutGuide")},Pe.S4e())),xc.add(new re(Jd.a.instance.ga(1935),Jd.a.instance.Ua(446),Jd.a.instance.ga(1936),()=>{this.a9f();this.fK();this.qI(1,"LearnMore")},Jd.a.instance.ga(1937),()=>{this.fK();
this.qI(1,"Done")},Pe.R4e()))):2===Rb?xc.add(new re(Jd.a.instance.ga(1934),Jd.a.instance.Ua(447),Jd.a.instance.ga(1931),()=>{this.fK();this.qI(1,"EnterTempViewAfterPersistedView")},null,null,qf.a())):3===Rb&&(xc.add(new re(Jd.a.instance.Ua(444),Jd.a.instance.ga(1943),Jd.a.instance.ga(1932),()=>{this.qI(2,"AutoOptInExitCalloutContinue");this.fK(!0)},Jd.a.instance.ga(1933),()=>{this.fK();this.qI(1,"AutoOptInExitGuide")},Pe.S4e())),xc.add(new re(Jd.a.instance.ga(1934),Jd.a.instance.Ua(447),Jd.a.instance.ga(1932),
()=>{this.qI(2,"Continue");this.fK(!0)},Jd.a.instance.ga(1933),()=>{this.fK();this.qI(1,"ExitGuide")},qf.a())),xc.add(new re(Jd.a.instance.ga(1935),Jd.a.instance.Ua(446),Jd.a.instance.ga(1936),()=>{this.a9f();this.fK();this.qI(1,"LearnMore")},Jd.a.instance.ga(1937),()=>{this.fK();this.qI(1,"Done")},Pe.R4e())));this.SYd=new Ie(xc)}a9f(){const Rb=new Pb.a(-859308420,ud.a.Db,this.$.Hc,9,null);this.$.Ka.Lb(Rb,{[ud.a.lg]:"HelpID=SheetViews",["InputMethod"]:ud.a.Db,[ud.a.Ic]:dd.a.tV,["ShouldCanvasTakeFocus"]:!0})}show(Rb){this.Dgi(Rb);
this.Neb()}Wzj(Rb){this.k1b=Rb}Neb(){var Rb=this.SYd.n$i;if(Rb){var xc=Object(rc.a)(new ld.a,{label:Rb.P8i,onExecute:Rb.primaryButtonAction}),ed=null;Rb.h1f&&(ed=Object(rc.a)(new ld.a,{label:Rb.h1f,onExecute:Rb.secondaryButtonAction}));Rb=Object(rc.a)(new Cd.a,{target:Rb.targetObject,content:Rb.body,title:Rb.title,showCloseIcon:!0,primaryButtonProps:xc,secondaryButtonProps:ed,useTeachingStyles:!0});Rb=this.k1b.callout(Rb);xc=Object(rc.a)(new Qd.a,{onShow:()=>{this.qI(0)}});this.UBc=this.k1b.addNotification(Rb,
xc)}}dismiss(){this.fK();this.qI(1,"DismissedByOthers")}fK(Rb=!1){this.UBc&&(this.k1b.removeNotification(this.UBc),this.UBc=null);Rb&&this.Neb()}qI(Rb,xc=null){const ed={};ed.a=this.$.va.UserSessionId;ed.b=this.Rcg;ed.c=this.SYd.Qcg;ed.d=Rb;ed.e=xc;0===Rb?this.stopwatch=this.$.Jb.Ac("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),ed.f=this.stopwatch.zc,this.stopwatch=null),2===Rb&&(this.stopwatch=this.$.Jb.Ac("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
wf.b().Pe(52,ed,!0)}static R4e(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static S4e(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static fpi(Rb){return 0===Rb||1===Rb}}Object(b.a)(Pe,"NamedSheetViewTeachingCallout",null,[690]);class of extends Lb.a{constructor(Rb){super();this.$=Rb;this.Fb()}create(){let Rb=this.$.da.za(322);Rb||(Rb=new Pe(this.$),this.$.da.Ga(322,Rb));this.ob(Rb)}static ka(Rb){Rb.da.Ga(323,new of(Rb))}}Object(b.a)(of,
"NamedSheetViewTeachingCalloutFactory",Lb.a,[]);var Hb=a(1249),mc=a(1142),Mc=a(1248);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");
Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Ei(new N);Object(ea.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(Ba.a)();Object(ka.a)();Object(Ka.a)();Object(Oa.a)();Type.registerNamespace("Common.App.SharedFilePicker");aa.main();Type.registerNamespace("Common.App.WildFire");la.main();Object(Xa.a)();Za.a.Fa(bb.ka);Object(lb.a)();Object(Fa.a)();Object(Na.a)();
Mb.a.Mi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Za.a.Fa(Rb=>{nb.ka(Rb)})})();(()=>{Za.a.Fa(Rb=>{Rb.da.Ga(165,new ac(Rb))})})();Za.a.Fa(Ra.ka);Object(ya.a)();Object(Va.a)();Object(oa.a)();Object(kb.a)();Object(Sa.a)();Object(U.a)();Object(ta.a)();Object(ub.a)();Object(hc.a)();Object(Bc.a)();Object(Mc.a)();Za.a.Fa(Ub.ka);Za.a.Fa(hd.ka);
Object(Ud.a)();Za.a.Fa(ec.ka);(()=>{Za.a.Fa(Rb=>{Ob.ka(Rb);of.ka(Rb)})})();Object(Hb.a)();Object(mc.a)()},705:function(u,D,a){a.d(D,"a",function(){return X});u=a(0);var c=a(7),b=a(15),e=a(87),f=a(224),d=a(14),h=a(107),m=a(172),l=a(4),v=a(85);D=a(238);var t=a(1056),z=a(19),r=a(5),n=a(324),w=a(53),B=a(12),A=a(71),y=a(13),x=a(21),F=a(89),I=a(897),L=a(1);class X extends D.a{constructor(P,G){super(document.createElement("div"));this.Wpf=this.Qte=this.coe=this.D4b=this.uca=this.L8=this.oP=this.rz=null;
this.Qwa=this.d_=this.It=this.hideCloseButton=!1;this.vPi=C=>{this.MD(C)};this.BPi=C=>{13===C.keyCode&&this.MD(C)};this.bCd=C=>{this.Lo(C.tb);return!0};this.gCd=C=>{this.f0(C.tb);return!0};this.Lpc=C=>{this.Nma(C.tb?C.tb:0);return!0};this.wPi=C=>{this.MD(C.Ca);return!0};this.Kqg=(C=null)=>{this.Lo(C.inputMethod?C.inputMethod:0);return!0};this.Lqg=(C=null)=>{this.f0(C.inputMethod?C.inputMethod:0);return!0};this.L1=P;this.qD=G;this.b_c=G.r0a.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get c_g(){return this.qD.r0a}get businessBar(){return this.L1}get actionButton(){return this.qD?
this.qD.actionButton:""}get iHa(){return this.qD?this.qD.iHa:""}get linkText(){return this.qD?this.qD.link:""}get dl(){return this.qD?this.qD.dl:""}get alt(){return this.qD?this.qD.alt:""}kBa(P){this.qD.Q2b=P}dispose(){e.a.qc([this.D4b,this.oP,this.L8]);this.It&&this.oP&&(f.a.instance.Ba(d.a.click,this.oP.domElement,this.bCd),h.KeyInputManager.instance.Vv(this.domElement,this.coe));this.d_&&this.L8&&(f.a.instance.Ba(d.a.click,this.L8.domElement,this.gCd),h.KeyInputManager.instance.Vv(this.domElement,
this.Qte));this.Qwa&&this.uca&&(f.a.instance.Ba(d.a.click,this.uca,this.Lpc),h.KeyInputManager.instance.Vv(this.domElement,this.Wpf));this.uca=this.rz=this.L1=this.L8=this.oP=null;super.dispose()}update(){}ZYj(){this.eJe(!0)}C5c(){this.eJe(!1)}agh(){this.message=F.a.Rg(this.message);this.title=F.a.Rg(this.title);m.UISurfaces.Chd().then(P=>{P.initializeMessageBarInStore();let G=Object(c.a)(new I.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.qD.Q2b,dismissButtonAriaLabel:y.a.instance.ga(10)});
this.hideCloseButton||(G.onDismiss=this.wPi);this.Qwa&&(G.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Lpc});this.It&&(G.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Kqg});this.d_&&(G.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.iHa,["onExecute"]:this.Lqg});P.createNewMessageBar(this.domElement,G);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});
l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}kfh(P){let G="<div class='"+t.a.Auh+"' id='{0}'><div class='"+t.a.yuh+"'><a class='"+t.a.Guh+"' title='{1}'><span class='"+z.a.B4b+" "+t.a.Cuh+"' id='{2}'>";this.dl.length&&(G+="<img class='{3}' src='{4}'/>");
G+="</span></a><span class='"+t.a.Fuh+"' id='{5}'>{6}</span><span class='"+t.a.Euh+"' id='message'>{7}</span><a id='link' href='#' class='"+t.a.Duh+"'>{8}</a><span class='"+t.a.tRe+"'><button type='button' id='action' class='"+t.a.sRe+"'>{9}</button></span><span class='"+t.a.tRe+"'><button type='button' id='altAction' class='"+t.a.sRe+"'>{10}</button></span></div><a class='"+t.a.Buh+"' tabindex='0' role='button'><span id='close' class='"+z.a.Rx+"'><img class='"+z.a.$ad+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";
P||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var C=this.businessBar.$.Eb;P=C+"ewaBusinessBarEntryBody"+this.b_c;const H=C+"ewaBusinessBarEntryTitle"+this.b_c;C=C+"ewaBusinessBarEntryIcon"+this.b_c;this.domElement.className=t.a.zuh;this.domElement.innerHTML=String.format(G,P,this.alt,C,this.dl,w.a.Ge(0),H,this.title,this.message,this.linkText,this.actionButton,this.iHa,w.a.Ge(13),y.a.instance.ga(793));B.DOMElementExtensions.Pu(this.domElement,r.a.Ssa,H,P);
this.uca=$get("link",this.domElement);B.DOMElementExtensions.setVisible(this.uca,this.Qwa);this.Qwa&&(f.a.instance.ta(d.a.click,this.uca,this.Lpc),this.Wpf=h.KeyInputManager.instance.Ms(this.uca,this.Lpc,v.a.Sh,v.a.B1));this.oP=new n.a(B.DOMElementExtensions.getElementById(this.domElement,"action"));this.oP.isVisible=this.It;this.L8=new n.a(B.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.L8.isVisible=this.d_;this.It&&(f.a.instance.ta(d.a.click,this.oP.domElement,this.bCd),
this.coe=h.KeyInputManager.instance.Ms(this.oP.domElement,this.bCd,v.a.Sh,v.a.B1),this.d_&&(f.a.instance.ta(d.a.click,this.L8.domElement,this.gCd),this.Qte=h.KeyInputManager.instance.Ms(this.oP.domElement,this.gCd,v.a.Sh,v.a.B1)));this.rz=$get("close",this.domElement);this.D4b=this.Be.Zd(this.rz);this.D4b.ka("click",this.vPi);this.D4b.ka("keydown",this.BPi);B.DOMElementExtensions.setVisible(this.rz,!this.hideCloseButton)}eJe(P){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.agh():this.kfh(P)}Lo(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.qD.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.qD.T$c}`);x.h(this.businessBar.$).Uo(!0)}f0(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.qD.hash}]: BusinessBarEntry.OnAltActionClick()`);x.h(this.businessBar.$).Uo(!0)}Nma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.qD.hash}]: BusinessBarEntry.OnLinkClick()`);x.h(this.businessBar.$).Uo(!0)}MD(P){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.qD.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.qD.T$c}`);this.set_visible(!1);this.businessBar.removeEntry(this.c_g);A.g(P)}rK(){return L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.domElement.getElementsByTagName("button")[0]:this.oP.domElement}}Object(u.a)(X,"BusinessBarEntry",D.a,[])},782:function(u,D,a){a.r(D);u=a(0);var c=a(7),b=a(15),e=a(4);a(27);var f=
a(383),d=a(38),h=a(50),m=a(12),l=a(127),v=a(1),t=a(13),z=a(21);class r extends Sys.EventArgs{constructor(H){super();this.T8i=H}}Object(u.a)(r,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var n=a(259),w=a(247);class B{constructor(H){this.sg=H}ai(){n.a(this.sg.$).vB(this.de)||n.a(this.sg.$).ai(this)}z8(){n.a(this.sg.$).vB(this.de)&&n.a(this.sg.$).aA(this)}get de(){return w.a.oOf}get mc(){const {PrintPreviewPane:H}=a(782);return document.getElementById(H.R8i)}get Ff(){return!0}lh(H){return m.DOMElementExtensions.xf(this.mc,
H)}sj(){this.sg.$.frame.Le.tk(this.sg.$.frame.Le.qF)}Wj(){}gg(H,J){return J?!1:(this.sg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(u.a)(B,"PrintPreviewHeaderKeyboardAccessibleSection",null,[39]);class A{constructor(H){this.sg=H}ai(){n.a(this.sg.$).vB(this.de)||n.a(this.sg.$).ai(this)}z8(){n.a(this.sg.$).vB(this.de)&&n.a(this.sg.$).aA(this)}get de(){return w.a.pOf}get mc(){const {PrintPreviewPane:H}=a(782);return this.sg.useMSPdfViewer?document.getElementById(a(782).PrintPreviewPane.jGd):document.getElementById(H.MLf)}get Ff(){return!0}lh(H){return m.DOMElementExtensions.xf(this.mc,
H)}sj(){this.sg.$.frame.Le.tk(this.sg.$.frame.Le.qF)}Wj(){}gg(H,J){return J?!1:(this.sg.useMSPdfViewer?(H=document.getElementById(a(782).PrintPreviewPane.jGd))&&m.DOMElementExtensions.setFocus(H,!0):m.DOMElementExtensions.setFocus(this.sg.kL),!0)}}Object(u.a)(A,"PrintPreviewKeyboardAccessibleSection",null,[39]);class y{constructor(H){this.sg=H}ai(){n.a(this.sg.$).vB(this.de)||n.a(this.sg.$).ai(this)}z8(){n.a(this.sg.$).vB(this.de)&&n.a(this.sg.$).aA(this)}get de(){return w.a.rOf}get mc(){const {PrintPreviewPane:H}=
a(782);return document.getElementById(H.nId)}get Ff(){return!0}lh(H){return m.DOMElementExtensions.xf(this.mc,H)}sj(){this.sg.$.frame.Le.tk(this.sg.$.frame.Le.qF)}Wj(){}gg(H,J){return J?!1:(this.sg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)}}Object(u.a)(y,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[39]);class x{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(u.a)(x,"MSPdfViewerFileUrl",null,[]);class F{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=
this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(u.a)(F,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(u.a)(I,"ViewerPaneProps",
null,[]);var L=a(1077),X=a(378),P=a(5);class G{}G.printDialogTitle="PrintDialogTitle";G.g$b="ewa-dlg-elements-container-rtl";G.cx="PrintPreviewerContainer";Object(u.a)(G,"CssClassNames",null,[]);a.d(D,"PrintPreviewPane",function(){return C});class C extends d.a{constructor(H,J,M,S){super();this.xDb=this.Slc=this.kL=this.xIb=this.cx=this.nW=this.$D=this.iG=null;this.wDb=!1;this.Exa=!0;this.oId=this.kId=this.lId=this.ewaAccessibilityManager=this.Mrc=null;this.iqd=!1;this.VDf=()=>{b.ULS.sendTraceTag(537154206,
0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.wDb}`);this.wDb&&(this.kdi(),this.kL.style.visibility="visible",this.Slc?this.Slc.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(C.nFb,new r(1)),this.URd(),this.wDb=!1)};this.$=H;this.ZD=J;this.Nfh();this.useMSPdfViewer=M;this.isUniversalPrintEnabled=S;this.dI=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);this.isExportPdfMode=!1}LNg(H){this.addHandler(C.nFb,H)}vkj(H){this.removeHandler(C.nFb,H)}zJj(H){this.isExportPdfMode=H;this.Ifh()}AJj(){var H=this.$.Jb.Ac("UserAction","createSettingsPaneStopwatch");const J=document.getElementById(C.nId);this.Pfh();const M=this.Qfh();this.$D.createPrintSettingsTaskPane(J,M);H.stop();this.wDb=!1;if(this.isUniversalPrintEnabled&&this.cx){H="A4";switch(M.selectedPrintSettingsValues.selectedPaperSize){case 8:H="A3";break;case 9:H="A4";break;case 11:H="A5";break;
case 12:H="JIS B4";break;case 13:H="JIS B5";break;case 5:H="North America Legal";break;case 1:H="North America Letter";break;case 6:H="North America Invoice";break;case 7:H="North America Executive";break;case 3:H="North America Ledger"}this.iG.setDocumentSettings({mediaSize:H,orientation:2===M.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===M.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.cLd()}setPageRangeSettings(H,J,M,S,W){this.$D&&
(this.$D.setPageRangeSettings(H,J,M,S,W),this.P4f(String.format(t.a.instance.nb(205),S,W,H)))}$ci(){this.cx&&(this.cx.style.display="none")}Aoh(){this.dispose();this.D0d();this.RWj();this.iG&&this.iG.closePrintPreviewPane();this.nW=this.$D=this.iG=this.cx=null}LAi(H){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.xDb=this.$.Jb.Ac("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),
this.nW.renderPdf(H)):this.kL&&((this.Slc=this.$.Jb.Ac("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.wDb=!0,this.kL.src&&this.kL.src===H?this.VDf(null):this.kL.src=H);if(this.dI&&this.cx){const J=X.b(this.$.workbookContext);this.iG.setFileUrl(H,J)}}onPdfLoad(){this.xDb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.xDb.zc} ms, isFirstTimeLoad: ${this.Exa}`),this.xDb.stop()):
b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(C.nFb,new r(1));this.hideWaitCursor();this.URd()}printPdf(){m.DOMElementExtensions.setFocus(this.kL);this.kL.contentWindow.print()}qKj(){this.showSpinner();this.showWaitCursor();this.P4f("")}kdi(){this.hideSpinner();this.hideWaitCursor()}jA(H,J,M=null){this.cx&&this.nW&&(this.iqd=!1,this.nW.showErrorDetails(J,H,M),this.ZD.n7a=!0,this.kL&&(this.kL.src=""),this.disablePrintButton(),
this.hideWaitCursor(),C.jsi(J)&&(this.iqd=!0,this.AXi()))}hidePreviewError(){this.ZD.n7a=!1;this.nW.hidePreviewError();this.enablePrintButton()}roh(){(this.xIb=document.getElementById(C.qOf))&&this.xIb.parentNode&&this.xIb.parentNode.removeChild(this.xIb)}hideErrorMessageForPrintOptions(){this.$D&&this.$D.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(H){this.$D&&this.$D.showErrorMessageForPrintOptions(H)}showSpinner(){this.ZD.n7a||this.iqd?this.hidePreviewError():this.kL&&(this.kL.style.visibility=
"hidden");this.nW&&this.nW.showSpinner()}hideSpinner(){this.nW&&this.nW.hideSpinner()}enablePrintButton(){this.$D&&this.$D.enablePrintButton();this.dI&&this.cx&&this.iG.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.$D&&this.$D.disablePrintButton();this.dI&&this.cx&&this.iG.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.$D&&this.$D.showWaitCursor();this.dI&&this.cx&&this.iG.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.$D&&this.$D.hideWaitCursor();
this.dI&&this.cx&&this.iG.updatePrintButtonEnableDisableState(!0)}Lfh(){if(this.cx)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.cx=document.createElement("div"),this.cx.id=C.qOf,this.cx.classList.add(C.U8i),this.$.yr.insertBefore(this.cx,this.$.yr.firstChild),e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Pa.Ye){const H=document.getElementById(P.a.Nsa);H&&(this.cx.style.top=`${H.clientHeight}px`,
this.cx.style.height=`calc(100vh - ${H.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.iG.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.iG.enterPrintSettingsTaskPaneFocusTrapZone()}F6i(){this.$.da.$a(15,H=>{this.ewaAccessibilityManager=H;this.ewaAccessibilityManager.mode=3})}Nfh(){this.oId=new y(this);this.lId=new A(this);this.kId=new B(this)}cLd(){this.oId.ai();this.lId.ai();this.kId.ai();this.F6i()}D0d(){this.oId.z8();this.lId.z8();this.kId.z8();
z.h(this.$).jX();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}uO(){this.Mrc=l.a.instance.Zd(this.kL);this.Mrc.ka("load",this.VDf)}RWj(){this.Mrc&&this.kL&&this.Mrc.detach("load")}URd(){this.dI?this.U3f(C.S8i,C.VKi):this.U3f(C.nId,C.kOf)}U3f(H,J){this.Exa&&(H=document.getElementById(H))&&(J=m.DOMElementExtensions.getElementById(H,J))&&(this.Exa=!1,J.focus())}AXi(){this.ZD.n7a=!1;this.enablePrintButton();this.URd()}Ifh(){const H=h.GetServiceTaskFactory.Oa(this.$.da,283,284,0).result.pn;
H.loadScript("excel-print-preview-sprite").then(()=>{H.loadScript("printPreviewer").then(()=>{H.loadScript("excelPrintPreviewer").then(()=>{this.Ofh()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}Ofh(){const H=this.$.Jb.Ac("UserAction",
"createEmptyPreviewerStopwatch");this.Lfh();this.Mfh();this.dI?this.iG.createEmptyPrintPreviewPaneAsync(this.cx,this.kJe()).then(()=>{H.stop();this.WFe();this.iG.updatePrintButtonEnableDisableState(!1)}):(this.iG.createEmptyPrintPreviewPane(this.cx,this.kJe()),H.stop(),this.WFe())}WFe(){const H=this.$.Jb.Ac("UserAction","createPdfPreviewPaneStopwatch"),J=document.getElementById(C.jGd);this.useMSPdfViewer&&(J.tabIndex=0);this.ufh();this.tfh(J);H.stop();this.raiseEvent(C.nFb,new r(0))}Mfh(){this.iG||
(this.iG=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.iG||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}Pfh(){this.$D||(this.$D=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.$D||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}ufh(){this.nW||
(this.nW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.nW||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}tfh(H){this.nW.createPrintPreviewPane(H,this.Zhh());this.useMSPdfViewer||(this.kL=m.DOMElementExtensions.getElementById(this.cx,C.MLf),this.kL.title=t.a.instance.ga(1206),this.uO())}Qfh(){let H,J="en-US";H=this.$.va.IsMetricMeasurementUnit;this.$.va.DataCultureTag?
J=this.$.va.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new F,{whatToPrintOptions:this.ZD.Mv.whatToPrintOptions,orientationOptions:this.ZD.Mv.orientationOptions,paperSizeOptions:this.ZD.Mv.paperSizeOptions,scalingOptions:this.ZD.Mv.scalingOptions,marginDetailedOptions:this.ZD.pZh(),selectedPrintSettingsValues:this.ZD.q1h(),printSettingsTaskPaneCallbacks:this.ZD.o1h(),
logger:new f.a,shouldDisableCurrentSelection:this.ZD.Z6f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:H,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}kJe(){return this.dI?this.ZD.m1h():Object(c.a)(new L.a,{backActionButtonText:t.a.instance.ga(1204),printPreviewPaneCallbacks:this.ZD.c6e(),logger:new f.a,disableTellMeControl:!0,isExportPdfMode:!1})}Zhh(){return this.useMSPdfViewer?Object(c.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.Heh(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(c.a)(new I,{useMSPdfViewer:!1})}Heh(){return Object(c.a)(new x,{pdfViewerWorkerUrl:this.$.va.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.va.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.va.PrintPreviewerMSPdfKitWasmUrl})}P4f(H){this.cx&&this.iG.setAdditionalHeaderText(H)}static jsi(H){return 3===H||2===H}}C.qOf="PrintPreviewerContainer";C.nId="printSettingsTaskPaneId";C.jGd="previewId";C.MLf="printpreviewiframe";C.R8i="printPreviewHeaderId";C.kOf="printButton";
C.S8i="printPreviewPaneId";C.VKi="printButtonId";C.U8i=G.cx;C.nFb="pppnosu";Object(u.a)(C,"PrintPreviewPane",d.a,[753])},835:function(u,D,a){a.d(D,"a",function(){return d});u=a(0);var c=a(15),b=a(4),e=a(40),f=a(27);class d{static l0e(h,m){switch(h){case 3:return d.y7h(m);case 2:return d.k0h(m);case 1:return d.oVh(m)}return""}static y7h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static k0h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static oVh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,m,l){if(f.a.Xg||f.a.Cp)window.setTimeout(()=>{d.ySf(l,d.nec())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.Gue(l),h,0,!1)}static B5g(h,m,l,v){m&&
v&&v();d.openInClient(h,m,l)}static nec(){return f.a.Xg?1:f.a.Cp?2:f.a.O8a?3:f.a.isMac?4:0}static u7h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static v7h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get XAb(){return"zh-CN"===window.navigator.language}static ySf(h,m){1===m?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),h=d.l0e(h,m),8<f.a.u6a?e.a.lf(h,void 0,void 0,"RedirectToAppStore"):e.a.bV(h)):document.hidden||(d.XAb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.bV(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.l0e(h,
m),null,null)))}static Gue(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Jzc(){return(f.a.O8a||f.a.isMac)&&f.a.Dp}static get EGj(){return f.a.Xg||f.a.Cp}static jfd(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static zrd(h){return(h=d.lYh(h))&&""!==h?Boolean.parse(h):!1}static PSd(h){d.tzj(h)}static lYh(h){try{return localStorage.getItem(h)}catch(m){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}}static tzj(h){try{localStorage.setItem(h,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}}}d.HCe="ChromeExtensionBarDismiss";Object(u.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/2e561b39647d092ae8ba164e328a9a50/EwaDSEsNext.kmhv.js.map