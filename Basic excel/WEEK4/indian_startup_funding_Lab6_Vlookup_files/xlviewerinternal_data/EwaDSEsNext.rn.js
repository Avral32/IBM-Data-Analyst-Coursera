'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1143:function(u,D,a){u=a(0);var c=a(84),b=a(552),e=a(15),f=a(134);class d{constructor(bb,lb,Fa){this.vVd=this.wVd=this.xVd=!1;this.MVd=!bb&&!lb;this.NVd=!bb&&!Fa;this.MVd||this.NVd||(this.xVd=!bb,this.wVd=!lb,this.vVd=!Fa)}}Object(u.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(bb,lb,Fa,Na,Mb){super();this.$Yd=[];this.h2=new d(bb,lb,Fa);this.esa=Na;this.Xqa=Mb;this.Ee=
"RenameDisabledDialog";this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose);this.RBj();this.Xlj()}RBj(){this.h2.MVd?this.TNb(this.esa?this.Xqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.h2.NVd?this.TNb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.tJg();this.rsa(this.$Yd)}TNb(bb){Array.add(this.$Yd,bb)}tJg(){const bb=[];this.h2.xVd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.h2.wVd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.h2.vVd||Array.add(bb,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<bb.length&&Array.add(this.$Yd,bb)}}Object(u.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class m extends h{constructor(bb,lb,Fa,Na,Mb){super(bb,lb,Fa,Na,Mb)}Xlj(){this.xEb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(u.a)(m,"ReactRenameDisabledDialog",h,[]);var l=a(146);class v{static get ng(){return l.a.iq(v.pl,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}v.pl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(u.a)(v,"RenameDisabledDialogHtml",null,[]);class t extends l.a{constructor(bb,lb,Fa,Na,Mb){super();this.h2=new d(bb,lb,Fa);this.esa=Na;this.Xqa=Mb;this.Ee="RenameDisabledDialog";this.Rb=0;this.oc(1,CommonUIStrings.l_DialogClose);this.ng=v.ng;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.iX("RenameRow")}$$a(){if(this.h2.MVd){let bb;bb=this.esa?this.Xqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;t.TNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),bb)}else this.h2.NVd?t.TNb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.jdi()}jdi(){this.h2.xVd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.h2.wVd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.h2.vVd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static TNb(bb,lb,Fa){bb.style.display="none";lb.innerText=Fa}}Object(u.a)(t,"RenameDisabledDialog",l.a,[]);var z=a(4),r=a(30),n=a(105),w=a(25);class B{constructor(bb,lb){this.cFa=0;this.La=bb;this.d9=lb}initialize(bb){if(!this.La||!this.d9)return!1;this.cFa=bb;this.Fg();return!0}Fg(){this.La.Mb(w.a.ria,n.a.frame,Object(c.a)(this,this.ria,"commitNewDocumentTitle"))}ria(bb,lb,Fa,Na,Mb){if(1===Fa)return this.La.processAction(w.a.renameFile,
1);bb=r.a.Sq(this.d9.un);Mb=(0,Mb.getNewDocumentTitle)();Mb.length>this.cFa&&(Mb=Mb.substr(0,this.cFa));if(32!==this.La.ae(w.a.renameFile,2,Mb))return this.DX(bb),8;this.DX(Mb);return 32}DX(bb){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(bb))}static mhd(){return new B(z.AFrameworkApplication.ub,z.AFrameworkApplication.um)}}Object(u.a)(B,"ReactRenameUIHandler",null,[301]);var A=a(93),y=a(520),x=a(554),F=a(14),I=a(107),L=a(239),X=a(86),P=a(40),G=a(27),C=a(83);class H{constructor(bb,
lb,Fa,Na,Mb,dc,Cb,Tb,Jb,eb,za,ha){this._initialized=!1;this._element=null;this.cFa=0;this.OSc=this.pMc=!1;this.La=bb;this.DHc=lb;this.Yd=Fa;this.MA=Na;this.d9=Mb;this.Tje=dc;this.VXb=Cb;this.zIc=Tb;this.p9=Jb;this.Ece=eb;this.rXa=za;this.kNc=ha}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(bb,lb,Fa){if(!(this.La&&this.d9&&this.Tje&&this.VXb&&this.zIc&&lb)||0>=bb)return!1;this._element=lb;this._element.title=Fa;this._element.setAttribute(X.a.Ld,X.a.ot);this._element.setAttribute("Unselectable",
"on");this.cFa=bb;this.Ps();return this._initialized=!0}Ps(){this.DHc&&(this.DHc.ta(F.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.DHc.ta(F.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.ta(F.a.Ob,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.MA.ta(F.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.MA.ta(F.a.Pf,this._element,Object(c.a)(this,this.Of,"onPointerUp"))}onBlur(){this.isActive&&!this.pMc&&
(this.Ece||this.zIc(this._element),this.sFe(),this.R7c(!1));return this.pMc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(bb){return this.isActive?this.JVi(bb):this.KVi(bb)}JVi(bb){let lb=!1;switch(bb.Ca.keyCode){case Sys.UI.Key.enter:this.sFe();this.R7c(this.rXa||this.kNc);lb=!0;break;case Sys.UI.Key.tab:this.Ece&&this.zIc(this._element);break;case Sys.UI.Key.esc:this.DOd(),this.R7c(this.rXa||this.kNc),lb=!0}return lb}KVi(bb){let lb=
!1;switch(bb.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.qfg(this.kNc),this.isActive&&this.VXb(this._element),lb=!0}return lb}onPointerDown(){this.isActive||(this.qfg(!1),this.isActive&&(this._element.focus(),this.VXb(this._element),this.OSc=!0));return!1}Of(){return this.OSc?(this.VXb(this._element),this.OSc=!1,!0):!1}g8a(){return 32===this.La.processAction(w.a.renameFile,1)}sFe(){const bb=r.a.Sq(this.d9.un);let lb=this._element.innerText.trim();lb.length>this.cFa&&(lb=lb.substr(0,
this.cFa));lb!==bb&&""!==lb?32!==this.La.ae(w.a.renameFile,2,lb)?this.DOd():this.DX(lb):this.DOd()}DOd(){this.DX(r.a.Sq(this.d9.un))}DX(bb){this._initialized&&(this._element.innerText=bb,this.Tje())}qfg(bb){this.g8a()?this.isActive||(bb&&(this.pMc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(X.a.Ld,X.a.sZc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,A.CuiHelper.MOe),
this.p9&&this.p9.execute(lb=>{lb.qQf(!0)}),bb&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(w.a.Seb,2)}R7c(bb){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(X.a.Ld,X.a.ot);Sys.UI.DomElement.removeCssClass(this._element,A.CuiHelper.MOe);this.p9&&this.p9.execute(lb=>{lb.qQf(!1)});bb&&(this._element.blur(),this._element.focus())}static eA(){y.a.eA(z.AFrameworkApplication.isRtl)}static mhd(){return new H(z.AFrameworkApplication.ub,
x.a.instance,I.KeyInputManager.instance,L.a.instance,z.AFrameworkApplication.um,H.eA,P.a.buj,P.a.j5g,C.a.instance.Ub("Common.App.Header.HeaderEventSource"),G.a.xla,G.a.Xg,G.a.fg)}}Object(u.a)(H,"RenameUIHandler",null,[301]);class J{static get instance(){return z.AFrameworkApplication.sa.Pa.Fs?J.Ma||(J.Ma=B.mhd()):J.Ma||(J.Ma=H.mhd())}}J.Ma=null;Object(u.a)(J,"RenameUIHandlerFactory",null,[]);var M=a(97),S=a(135);class W{constructor(){this.PKi=this.LKi=this.Aih=null}}Object(u.a)(W,"RenameMruEntryProperties",
null,[]);var O=a(373),T=a(164),Y=a(642),va;(function(bb){bb[bb.unknown=-1]="unknown";bb[bb.success=0]="success";bb[bb.renameInvalidFileName=1]="renameInvalidFileName";bb[bb.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";bb[bb.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";bb[bb.permissionDenied=4]="permissionDenied";bb[bb.serverCommunicationFailure=5]="serverCommunicationFailure";bb[bb.fileNameTooLong=6]="fileNameTooLong"})(va||(va={}));Object(u.b)("CommonOperationResult",
va);class ca{constructor(bb,lb,Fa,Na,Mb,dc,Cb,Tb,Jb,eb,za,ha){this.Qce=bb;this.La=lb;this.JIc=Fa;this.aw=Na;this.WEa=Mb;this.bGg=dc;this.esa=Cb;this.Tme=Tb;this.GCg=Jb;this.Xqa=eb;this.mb=za;this.FCg=ha}Fg(){z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Pa.Fs||this.Th.Mb(w.a.Izb,n.a.frame,Object(c.a)(this,this.Izb,"initializeRenameUIHandler"));this.Th.Mb(w.a.Seb,n.a.frame,Object(c.a)(this,this.Seb,"showRenameDisabledDialog"));this.Th.Mb(w.a.renameFile,n.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.Th.Me(w.a.fileNameUpdate,n.a.frame,Object(c.a)(this,this.Bej,"refreshFilename"),64);this.Th.Me(w.a.znc,n.a.frame,Object(c.a)(this,this.znc,"moveToFolderCompleteByHost"),64);this.Th.Mb(w.a.lPa,n.a.frame,Object(c.a)(this,this.lPa,"moveToFolder"));z.AFrameworkApplication.sa&&(z.AFrameworkApplication.fa.qa("PostMessageEmbedded")||z.AFrameworkApplication.fa.qa("IsJsApi"))&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&z.AFrameworkApplication.nV().execute(bb=>
{bb.uo(T.a.cwf);bb.em(T.a.cwf,ca.rdj);bb.uo(T.a.wcd);bb.em(T.a.wcd,ca.pdj)})}g8a(){return 0===this.FCg.w6e()?32:8}m2j(){return this.uz?this.esa?this.uz.NNe:this.uz.mwb:!0}Izb(){return J.instance.initialize(z.AFrameworkApplication.pac,z.AFrameworkApplication.K2a,z.AFrameworkApplication.UMd||CommonUIStrings.l_RenameFileTooltip)?32:8}Seb(){const bb=this.m2j(),lb=this.bGg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.WEa,lb,bb,this.esa);z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Pa.Jv&&z.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new m(this.WEa,!lb,!bb,this.esa,this.Xqa()):new t(this.WEa,!lb,!bb,this.esa,this.Xqa());return 32}renameFile(bb,lb,Fa,Na,Mb){if(1===Fa)return this.g8a();if(!z.AFrameworkApplication.P$b)return 8;if(8===this.g8a())return this.Th.processAction(w.a.Seb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");z.AFrameworkApplication.P$b(Mb,Object(c.a)(this,
this.FGb,"onRenameFileSuccess"),Object(c.a)(this,this.sYi,"onRenameFileFailure"));return 32}FGb(bb,lb){bb?0!==bb.OperationResult?this.n$e(bb.OperationResult):(this.nvj(lb,bb.NewName),this.KYj(bb,Object(c.a)(z.AFrameworkApplication.sa.Pa,z.AFrameworkApplication.sa.Pa.Uig,"updateOpenInClientDocumentUrl")),z.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&z.AFrameworkApplication.sa.updateCommandUI(),this.GCg.xhg()):this.n$e(5)}nvj(bb,lb){const Fa={};Fa[O.a.IGh]=lb;bb.Oj(T.a.wcd,
Fa)}KYj(bb,lb){this.YYj(bb);z.AFrameworkApplication.o8b=bb.DirectInvokeDavUrl;lb=lb(bb.EditDocInClientUrl);const Fa=new W;Fa.PKi=this.aw.un;Fa.Aih=lb;Fa.LKi=bb.EditDocInClientUrl;this.Th.ae(w.a.renameMostRecentlyUsedFileEntry,2,Fa)}n$e(bb){switch(bb){case 1:bb=new f.StandardDialog,bb.Rb=0,bb.oX(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.bZf()}}YYj(bb){this.aw.un=ca.RRg(this.aw.un,bb.NewName);bb.BreadcrumbFolderName&&(this.aw.breadcrumbFolderName=
bb.BreadcrumbFolderName);bb.BreadcrumbFolderUrl&&(this.aw.breadcrumbFolderUrl=bb.BreadcrumbFolderUrl);this.Tme(bb.NewName)}sYi(bb){const lb=new f.StandardDialog;lb.Rb=0;switch(bb){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");lb.JBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");lb.JBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:bb}),lb.JBa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}z.AFrameworkApplication.nV().execute(Fa=>{Fa.Oj(T.a.HGh,{["FailureMessage"]:va[bb]})});this.bZf()}Bej(bb,lb,Fa){if(1===Fa)return this.g8a();if(!z.AFrameworkApplication.jKa)return 8;z.AFrameworkApplication.jKa(Object(c.a)(this,this.qqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.pqc,"onRefreshFilenameFailure"),
!1);return 32}lPa(bb,lb,Fa,Na,Mb){if(1===Fa)return z.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Fa){const dc={};bb=z.AFrameworkApplication.ica;lb=z.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");bb=(!bb||bb&&lb)&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);dc[O.a.iPj]=bb;Mb&&Mb.MoveButtonClickedTime&&(dc[O.a.lJi]=Mb.MoveButtonClickedTime.getTime());z.AFrameworkApplication.nV().execute(Cb=>{Cb.Oj(T.a.lPa,
dc)});if(Mb&&Mb.MoveButtonClickedTime){if(bb=S.a.hs())Mb=(new Date).getTime()-Mb.MoveButtonClickedTime.getTime(),bb.set("MovePostDuration",Mb.toString());M.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",bb)}return 32}return 8}znc(bb,lb,Fa,Na,Mb){if(1===Fa)return z.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.g8a():8;if(2===Fa){if(!z.AFrameworkApplication.M1f)return M.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,
null),8;if(!Mb)return M.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Mb[O.a.Nni])if(Mb[O.a.Sjg])if(bb=Mb[O.a.Sjg].toLowerCase(),lb=z.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Fa=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),lb&&z.AFrameworkApplication.ica&&Fa){const dc={};dc[O.a.$Qa]="1";dc[O.a.documentUrl]=bb;dc[O.a.reason]=Y.a.saveAs;M.Health.instance.recordKpiSuccess("MoveToFolder",null);
z.AFrameworkApplication.nV().execute(Cb=>{Cb.Oj(T.a.Eua,dc)})}else if(!z.AFrameworkApplication.ica&&Fa)M.Health.instance.recordKpiSuccess("MoveToFolder",null),P.a.lf(bb,P.a.FX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return M.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else M.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else z.AFrameworkApplication.jKa(Object(c.a)(this,this.qqc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.pqc,"onRefreshFilenameFailure"),!1),z.AFrameworkApplication.M1f(),M.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}dHj(bb,lb){return bb&&lb?bb!==this.aw.breadcrumbFolderName||lb!==this.aw.breadcrumbFolderUrl:!1}qqc(bb,lb){bb&&(bb.NewName!==r.a.Sq(this.aw.un)||this.dHj(bb.BreadcrumbFolderName,bb.BreadcrumbFolderUrl))&&this.FGb(bb,lb)}pqc(){}bZf(){this.Tme(r.a.Sq(this.aw.un))}get Th(){return this.La.value}get uz(){return this.JIc.value}static get instance(){return ca.Ma||(ca.Ma=
ca.nwb())}static nwb(){return new ca(z.AFrameworkApplication.h8a,new b.a(()=>z.AFrameworkApplication.ub),new b.a(()=>z.AFrameworkApplication.uz),z.AFrameworkApplication.um,z.AFrameworkApplication.limitedEdit,()=>z.AFrameworkApplication.userCanRename,z.AFrameworkApplication.pvc,Object(c.a)(J.instance,J.instance.DX,"updateTitle"),C.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>z.AFrameworkApplication.isReadOnlyRecommended,z.AFrameworkApplication.fa,C.a.instance.resolve("Common.IRenameProps"))}static RRg(bb,
lb){bb=r.a.I4(bb);return lb+bb}static rdj(bb){const lb=bb.Values[O.a.yri];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",lb);lb?z.AFrameworkApplication.ub.ae(w.a.znc,2,bb.Values):M.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static pdj(bb){z.AFrameworkApplication.ub.ae(w.a.renameFile,2,bb.Values.NewName)}}ca.Ma=null;Object(u.a)(ca,"RenameActor",null,[]);a(567);class V{}Object(u.a)(V,"ActivityEventName",null,[]);class ra{}
ra.compatMode="CompatMode";ra.noSelection="NoSelection";Object(u.a)(ra,"ActivityEventReason",null,[]);var N=a(641);class ea{constructor(bb,lb){this.La=bb;this.AWa=lb}Fg(){this.La.Mb(w.a.t9f,n.a.frame,Object(c.a)(this,this.LJj,"showRenameDialogAction"))}LJj(bb,lb,Fa){bb=32;if(1===Fa)return N.SessionStatusManager.instance.c6a||z.AFrameworkApplication.y5?8:32;2===Fa&&(32!==this.La.processAction(w.a.renameFile,1)?(this.La.processAction(w.a.Seb,2),bb=8):32===this.La.processAction(w.a.SNb,1)?this.La.processAction(w.a.SNb,
2):this.AWa.value.create().Nzc());return bb}}Object(u.a)(ea,"RenameDialogActor",null,[285]);class Ba{constructor(bb,lb,Fa){this.dialog=null;this.La=bb;this.aw=lb;this.Iqa=Fa}l2h(){const bb={};bb.nameInputProps={["type"]:"AppInputProps",["id"]:Ba.J2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:r.a.Sq(this.aw.un),["maxLength"]:this.Iqa};return bb}Nzc(){const bb={["id"]:"RenameDialog",["bodyControls"]:this.l2h()};this.dialog=new l.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.Ee="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.SMd,"renameDialogHandler"),bb)}SMd(bb,lb){lb&&1===bb&&lb[Ba.J2a]&&(bb=r.a.Sq(this.aw.un),lb=(lb[Ba.J2a]||"").trim(),lb!==bb&&""!==lb&&this.La.ae(w.a.renameFile,2,lb))}}Ba.J2a="txtDocumentName";Object(u.a)(Ba,"ReactRenameDialog",null,[303]);class ka{static get ng(){return l.a.iq(ka.pl,CommonUIStrings.l_RenameDialogLabel)}}ka.pl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(ka,"RenameDialogHtml",null,[]);class Ka extends l.a{constructor(bb,lb,Fa){super();this.La=bb;this.aw=lb;this.Iqa=Fa;this.Ee="RenameDialog";this.ng=ka.ng}Nzc(){var bb={["txtDocumentName"]:r.a.Sq(this.aw.un)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.SMd,"renameDialogHandler"),bb);bb=document.getElementById(Ka.J2a);0<this.Iqa&&(bb.maxLength=this.Iqa);bb.focus()}SMd(bb,lb){1===bb&&(bb=r.a.Sq(this.aw.un),lb=(lb[Ka.J2a]||"").trim(),lb!==bb&&""!==lb&&this.La.ae(w.a.renameFile,
2,lb))}}Ka.J2a="txtDocumentName";Object(u.a)(Ka,"RenameDialog",l.a,[303]);class Oa{constructor(bb){this.d9=null;this.Iqa=0;this.La=bb;this._initialized=!1}initialize(bb,lb){this.d9=bb;this.Iqa=lb;this._initialized=!0}create(){return this._initialized?z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Pa.Jv&&z.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new Ba(this.La,this.d9,this.Iqa):new Ka(this.La,this.d9,this.Iqa):null}}Object(u.a)(Oa,"RenameDialogFactory",null,[284]);var wa=
a(260),qa=a(145),aa=a(136),ia=a(106),Ha=a(102);class Z{constructor(bb,lb){this.La=bb;this.Yb=lb}Fg(){this.La.Mb(w.a.SNb,n.a.frame,Object(c.a)(this,this.MJj,"showRenameFlyoutAction"))}j1g(){return aa.d("setDocumentTitleFlyoutOpened")&&z.AFrameworkApplication.sa.Pa.Fs}MJj(bb,lb,Fa){if(1===Fa)return this.j1g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}FKg(){Z.yui&&z.AFrameworkApplication.T7a&&Ha.a.instance.Cg(new ia.a(5,1,5E3,()=>{32===this.La.processAction(w.a.SNb,
1)&&this.Yb&&this.Yb.gi.name===wa.AFrame.xaa&&(qa.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(w.a.SNb,2))}))}static get yui(){Z.CVb&&null!=Z.CVb||(z.AFrameworkApplication.JDb("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Z.CVb=z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Z.CVb}}Z.CVb=null;Object(u.a)(Z,"RenameFlyoutActor",null,[286]);
class la{constructor(bb,lb,Fa,Na,Mb){this.JIc=Mb;this.Rce=Fa;this.Qce=Na;this.fGg=bb;this.Xqa=lb}get uz(){return this.JIc.value}w6e(){if(!this.Qce())return 5;if(this.Xqa())return 1;if(this.uz){if(this.Rce&&!this.uz.NNe)return 3;if(!this.Rce&&!this.uz.mwb)return 4}return this.fGg()?0:2}}Object(u.a)(la,"RenameProps",null,[283]);a(187);var Xa=a(98);class Za{constructor(bb,lb,Fa,Na,Mb,dc){this.qn=!1;this.IOc=new Xa.a;this.GWa=lb;this.fM=Fa;this.uug=Na;this.mb=Mb;this.Ele=dc}enable(){this.qn||(this.xhg(),
this.lXd(),this.qn=!0)}generateKey(bb,lb,Fa){return String.format("{0}/{1}/{2}",Fa,bb,lb)}qYh(){const bb=r.a.Sq(this.GWa().un);return this.generateKey(this.GWa().breadcrumbFolderName,this.GWa().breadcrumbFolderUrl,bb)}rYh(bb,lb,Fa){return bb&&lb?this.generateKey(bb,lb,Fa):Fa}bnh(bb,lb,Fa){return bb&&bb!==this.GWa().breadcrumbFolderName||lb&&lb!==this.GWa().breadcrumbFolderUrl?!0:Fa!==r.a.Sq(this.GWa().un)}xhg(){const bb=this.qYh();this.IOc.ia(bb,new Date)}zGd(bb){this.HFj(bb)&&this.aoe(bb)}HFj(bb){const lb=
this.uug();return lb?this.Ele&&this.Ele.VAb||!lb.sif||!z.AFrameworkApplication.jKa?(this.Xag(bb),this.qn=!1):!0:!1}BIf(bb,lb,Fa,Na){const Mb=this.bnh(bb,lb,Fa);bb=this.rYh(bb,lb,Fa);lb=this.IOc.Dc(bb).returnValue;Mb&&!lb&&(this.o$e(Na),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Xwd));Mb||this.IOc.ia(bb,this.fM())}}Object(u.a)(Za,"ARenamedFileChecker",null,[270]);class xa extends Za{constructor(bb,lb,Fa,Na,Mb,dc,Cb,Tb){super(bb,lb,Fa,Na,Mb,dc);this.Nie=Mb;this.ECg=Cb;this.cyg=
Tb}get Xwd(){return"RenamedFileCheckerUsingSettingsRefresh"}lXd(){this.Nie.DXc(Object(c.a)(this,this.$$e,"handleSettingsRefresh"))}$$e(bb,lb){lb&&lb.cFb&&lb.fNi&&(lb.o8a("BreadcrumbDocName")||lb.o8a("BreadcrumbFolderName")||lb.o8a("BreadcrumbFolderUrl")||lb.o8a("DirectInvokeDAVUrl")||lb.o8a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Xwd),this.zGd(lb))}Xag(){this.Nie.Ekj(Object(c.a)(this,this.$$e,"handleSettingsRefresh"))}aoe(bb){if(bb&&bb.cFb){const lb=
bb.cFb;this.BIf(lb.Xa("BreadcrumbFolderName"),lb.Xa("BreadcrumbFolderUrl"),lb.Xa("BreadcrumbDocName"),bb)}}o$e(bb){const lb={OperationResult:0,classId:1};bb=bb.cFb;lb.BreadcrumbFolderName=bb.Xa("BreadcrumbFolderName");lb.BreadcrumbFolderUrl=bb.Xa("BreadcrumbFolderUrl");lb.DirectInvokeDavUrl=bb.Xa("DirectInvokeDAVUrl");lb.EditDocInClientUrl=bb.Xa("EditDocInClientUrl");bb=bb.Xa("BreadcrumbDocName");lb.NewName=z.AFrameworkApplication.Dua?bb:r.a.Sq(bb);this.cyg.execute(Fa=>{this.fli(lb,Fa)})}fli(bb,lb){this.ECg().FGb(bb,
lb)}}Object(u.a)(xa,"RenamedFileCheckerUsingSettingsRefresh",Za,[]);class fa extends Za{constructor(bb,lb,Fa,Na,Mb,dc,Cb,Tb,Jb,eb){super(bb,Fa,Na,Mb,dc,Jb);this.imb=this.yZb=null;this.LBg=lb;this.La=Cb;this.fe=Tb;eb&&eb.execute(za=>{this.Rgj(za)})}get Xwd(){return"RenamedFileCheckerUsingTask"}Rgj(bb){this.yZb=bb;this.yZb.jOg(Object(c.a)(this,this.hld,"handleVisibilityChange"))}hld(bb,lb){!this.qn||0!==lb.newState&&1!==lb.newState||this.imb||(this.lXd(),this.zGd(this.imb))}lXd(){this.imb=new ia.a(3,
2,this.LBg(),Object(c.a)(this,this.zGd,"performRenameFileCheckTick"),89);this.fe.Cg(this.imb)}Xag(bb){this.fe.np(bb)}aoe(bb){this.yZb&&2===this.yZb.Cik?this.Rhj(bb):z.AFrameworkApplication.jKa(Object(c.a)(this,this.qqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.pqc,"onRefreshFilenameFailure"),!0)}Rhj(bb){this.fe.np(bb);this.imb=null}qqc(bb){bb&&this.BIf(bb.BreadcrumbFolderName,bb.BreadcrumbFolderUrl,bb.NewName,null)}o$e(){this.La.processAction(w.a.fileNameUpdate,2)}pqc(){}}Object(u.a)(fa,"RenamedFileCheckerUsingTask",
Za,[]);var ua=a(95);class sa{constructor(){this.mb=this.gb=null}get name(){return"Common.App.RenameFile"}Vh(bb){this.gb=bb;this.mb=z.AFrameworkApplication.fa;this.gb.register(ea,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Fc(()=>new ea(z.AFrameworkApplication.ub,this.gb.wOd("Common.App.Rename.IRenameDialogFactory"))).xc();this.gb.register(Oa,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Fc(()=>new Oa(z.AFrameworkApplication.ub)).xc();
this.gb.register(270,"Common.App.Rename.IRenamedFileChecker").Fc(()=>this.lgh()).xc();this.gb.register(Z,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Fc(()=>new Z(z.AFrameworkApplication.ub,ua.FocusManager.instance())).xc()}lgh(){if(this.mb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const bb=this.gb.Jh("Common.IRefreshableAppSettings");if(bb&&bb.zsd)return new xa(()=>bb.ud("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>z.AFrameworkApplication.um,()=>
new Date,()=>z.AFrameworkApplication.uz,bb,this.gb.Jh("Common.ISessionStatus"),()=>ca.instance,this.gb.Ub("Postmessage.IHostPostmessenger"))}return new fa(()=>this.mb.ud("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.mb.ud("RenamedFileCheckerPingIntervalInMs",12E4),()=>z.AFrameworkApplication.um,()=>new Date,()=>z.AFrameworkApplication.uz,z.AFrameworkApplication.fa,z.AFrameworkApplication.ub,z.AFrameworkApplication.Fi,this.gb.Jh("Common.ISessionStatus"),this.gb.Ub("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.mb.Fv(Object(c.a)(this,
this.NB,"onFullAppSettingsReady"))}NB(){const bb=z.AFrameworkApplication.sa.Pa.Fs;z.AFrameworkApplication.h8a()&&J.instance.initialize(z.AFrameworkApplication.pac,bb?null:z.AFrameworkApplication.K2a,bb?null:z.AFrameworkApplication.UMd||CommonUIStrings.l_RenameFileTooltip)&&(this.gb.register(la,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Fc(()=>new la(()=>z.AFrameworkApplication.userCanRename,()=>z.AFrameworkApplication.isReadOnlyRecommended,z.AFrameworkApplication.pvc,z.AFrameworkApplication.h8a,
new b.a(()=>z.AFrameworkApplication.uz))).xc(),ca.instance.Fg(),this.mb.qa("RenameDialogIsEnabled")&&(this.gb.resolve("Common.App.Rename.RenameDialogFactory").initialize(z.AFrameworkApplication.um,z.AFrameworkApplication.pac),this.gb.resolve("Common.App.Rename.IRenameDialogActor").Fg()),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").Fg(),z.AFrameworkApplication.pvc&&this.gb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").FKg())}dispose(){}}
Object(u.a)(sa,"PackageManager",null,[4,5]);var sb=a(248);a.d(D,"a",function(){return hb});const hb=()=>{Type.registerNamespace("Common.App.Rename");sb.a.instance.Ei(new sa,7)}},1450:function(u,D,a){a.r(D);u=a(1143);var c=a(9);D=a(0);var b=a(692),e=a(50),f=a(37),d=a(4),h=a(59),m=a(183),l=a(25),v=a(55);class t{constructor(ca){this.renameFileManager=ca}executeCommand(ca,V,ra){switch(V.command){case l.a.ria:return h.a.yg.Fs?2!==d.AFrameworkApplication.ub.ae(l.a.ria,2,ra)?v.Task.Ta(!0):m.a(V.command):
m.a(V.command);case 1897077126:return this.renameFileManager.renameFile(ra,V),v.Task.Ta(!0);default:return m.a(V.command)}}wc(ca,V,ra,N){switch(V.command){case l.a.ria:return h.a.yg.Fs;case 1897077126:return!!N&&2===N.pz}return!1}Jc(){return!1}nc(){return!1}dispose(){this.renameFileManager=null}}Object(D.a)(t,"RenameFileCommandHandler",null,[165,2]);class z extends b.a{constructor(ca){super(ca)}nd(){const ca=e.GetServiceTaskFactory.create(this.$.da,119,this.la,this.Ya);f.TaskExtensions.Aa(ca,()=>
{this.Yc([new t(ca.result)])},this.la,3)}static ka(ca){b.a.Nd(118,new z(ca))}}Object(D.a)(z,"RenameFileCommandHandlerFactory",b.a,[]);var r=a(87),n=a(222),w=a(227),B=a(15),A=a(30),y=a(78),x=a(378),F=a(76),I=a(371),L=a(188),X=a(91),P=a(282),G=a(1),C=a(22),H=a(281);class J{constructor(ca){this.$=ca}get sif(){return this.$.workbookContext.FileCoauthorable}get VAb(){return!1}get mwb(){return this.$.ea.amIAlone}get NNe(){if(this.mwb)return!0;for(const ca of this.$.ea.Ym)if(!ca.SupportsRename)return!1;
return!0}}Object(D.a)(J,"EwaCoauthManager",null,[401]);var M=a(60),S=a(69);class W extends y.a{constructor(ca,V){super();this.Ida=this.TMd=this.qWf=this.Y7c=null;this.Dka=()=>{var ra=this.$.ea.Ho;if(ra&&ra.WorkbookFileName){var N=A.a.Sq(ra.WorkbookFileName),ea=!!C.a.compare(this.$.workbookContext.WorkbookFileName,ra.WorkbookFileName,!1),Ba=G.EwaSettings.ma(531)&&!!ra.BreadcrumbFolderUrl&&!!C.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,ra.BreadcrumbFolderUrl,!1);if(ea||Ba)this.Ida=
{},this.Ida.NewFileName=N,this.Ida.EditDocInClientUrl=ra.EditDocInClientUrl,this.Ida.DirectInvokeDAVUrl=ra.DirectInvokeDAVUrl,this.Ida.DownloadACopyUrl=ra.DownloadACopyUrl,G.EwaSettings.ma(531)&&ra.BreadcrumbFolderUrl&&(this.Ida.BreadcrumbFolderName=ra.BreadcrumbFolderName,this.Ida.BreadcrumbFolderUrl=ra.BreadcrumbFolderUrl),ra=d.AFrameworkApplication.ub.ae(l.a.fileNameUpdate,2,N),this.Ida=null,B.ULS.shipAssertTag(537154064,0,32===ra,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.CRi=(ra,N,ea)=>{this.qWf=N;this.TMd=ea;this.$.Ka.Lb(new X.a(1897077126,F.a.Db,2,3,null),{["newFileName"]:ra})};this.BRi=ra=>{this.Ida&&ra(this.x6e(this.Ida),this.Bs)};this.FGb=ra=>{P.a(ra)||!ra.Result?(ra=W.JNh(ra),S.a(this.$).fd.xM([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.TMd(ra)):this.qWf(this.x6e(ra.Result),this.Bs)};this.rYi=()=>{this.TMd(5)};this.$=ca;this.Bs=V;this.$.ea.mu(this.Dka)}initialize(){d.AFrameworkApplication.P$b=this.CRi;d.AFrameworkApplication.jKa=
this.BRi;this.Y7c=d.AFrameworkApplication.uz;d.AFrameworkApplication.uz=new J(this.$)}dispose(){d.AFrameworkApplication.P$b=null;d.AFrameworkApplication.jKa=null;this.$.ea.Ov(this.Dka);d.AFrameworkApplication.uz=this.Y7c;this.$=this.Y7c=null;super.dispose()}renameFile(ca,V){const ra=ca.newFileName;if(ra){const N=this.$.pa.ya.Wb();I.a(this.$.userOperationManager,(ea,Ba,ka)=>{var Ka=this.$.pa.ya;ea=H.b(ea,this.FGb);Ba=H.a(Ba,this.rYi);const Oa=Ka.Na(9,N);Oa.newFileName=ra;return M.g(Ka,"RenameFile",
Oa,ea,Ba,ka,null,0)},ea=>new L.a(134,0,ea),V)}}xni(){return 32===d.AFrameworkApplication.ub.processAction(l.a.ria,1)}x6e(ca){var V=this.$.workbookContext;d.AFrameworkApplication.yZ=ca.DownloadACopyUrl;const ra=G.EwaSettings.ma(531)&&!!ca.BreadcrumbFolderUrl;ra&&(d.AFrameworkApplication.um.breadcrumbFolderName=ca.BreadcrumbFolderName,d.AFrameworkApplication.um.breadcrumbFolderUrl=ca.BreadcrumbFolderUrl,V.FullDocumentInfo.BreadcrumbFolderUrl=ca.BreadcrumbFolderUrl,V.FullDocumentInfo.BreadcrumbFolderName=
ca.BreadcrumbFolderName);V.FullDocumentInfo.BreadcrumbDocName=ca.NewFileName;x.d(V,ca.NewFileName);V={};V.NewName=ca.NewFileName;V.DirectInvokeDavUrl=ca.DirectInvokeDAVUrl;V.EditDocInClientUrl=ca.EditDocInClientUrl;ra&&(V.BreadcrumbFolderName=ca.BreadcrumbFolderName,V.BreadcrumbFolderUrl=ca.BreadcrumbFolderUrl);V.OperationResult=0;return V}static JNh(ca){switch(ca.Errors[0].MessageId){case -414480287:ca=2;break;case 650565124:ca=1;break;case 1636785843:ca=6;break;case -782844485:ca=4;break;default:ca=
5}return ca}}Object(D.a)(W,"RenameFileManager",y.a,[359,2]);var O=a(51);class T extends n.a{constructor(ca){super();this.mZ=this.renameFileManager=null;this.$=ca;this.Fb()}create(){if(!this.mZ){const ca=w.a.Y1a(O.b(),this.la,"Task","IRenameFileManager");this.mZ=ca.task;const V=e.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Ya),ra=e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([ra,V],this.la),()=>{const N=new W(this.$,V.result);this.$.da.Ga(120,
N);ca.setResult(N)},this.la,3)}this.mZ.continueWith(ca=>{this.ob(ca.result)})}dispose(){r.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(ca){ca.da.Ga(119,new T(ca))}}Object(D.a)(T,"RenameFileManagerServiceFactory",n.a,[]);class Y{constructor(ca){this.Th=ca}nc(){return!1}executeCommand(ca,V,ra){return 2!==this.Th.ae(l.a.t9f,2,ra)?v.Task.Ta(!0):m.a(V.command)}wc(ca,V){return 1204860550===V.command}Jc(){return!1}}Object(D.a)(Y,"RenameFileDialogCommandHandler",
null,[165]);class va extends b.a{constructor(ca){super(ca)}nd(){f.TaskExtensions.Aa(e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.Yc([new Y(d.AFrameworkApplication.ub)])},this.la,3)}static ka(ca){b.a.Nd(131,new va(ca))}}Object(D.a)(va,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(u.a)();(()=>{c.a.Fa(ca=>{T.ka(ca);z.ka(ca)})})();c.a.Fa(va.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/d0ab93e0661c0eacfc4be71cd3e31d7e/EwaDSEsNext.rn.js.map