/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1146:function(u,D,a){u=a(0);var c=a(15),b=a(692),e=a(76),f=a(37);class d{constructor(na,ab){this.automateCommandManager=na;this.$=ab}nc(){return!1}executeCommand(na,ab,Gb){na=f.TaskExtensions.Rj();ab=ab.command;switch(ab){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Xc(2045014907,-1,0,null),this.automateCommandManager.Blc(ab,
1904816141===ab?Gb[e.a.Ic].toString():null)}return na}wc(na,ab){na=!1;switch(ab.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:na=this.$.JV}return na}Jc(na,ab,Gb){return"PopulateAutomateGalleryMenu"===ab&&this.$.JV?(this.automateCommandManager.Jc(ab,Gb),!0):!1}}Object(u.a)(d,"AutomateCommandHandler",null,[165]);var h=a(460);class m extends b.a{constructor(na){super(na)}nd(){h.a(this.$,374,375,
this.Ya,()=>{const na=this.$.da.za(352);na?this.Yc([new d(na,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static ka(na){na.da.Ga(308,new m(na))}}Object(u.a)(m,"AutomateCommandHandlerFactory",b.a,[]);b=a(222);var l=a(7),v=a(4);class t{constructor(){this.token=null;this.timeStamp=0}}Object(u.a)(t,"AuthContext",null,[]);var z=a(721),r=a(132),n=a(110),w=a(28),B=a(764),A=a(145),y=a(72);class x{constructor(na,ab,Gb){var fc,
pb;this.$=na;this.oAuthManager=ab;this.ov=Gb;this.f3=new t;this.Ppb=null!==(pb=null===(fc=this.oAuthManager)||void 0===fc?void 0:fc.cNa())&&void 0!==pb?pb:!1}getAuthContext(){return this.f3}mba(){const na=w.a.Qa.zb,ab=[];if(this.oAuthManager)ab.push(Object(l.a)(new y.a,{name:"IsAuthSupported",bool:this.Ppb}));else return this.mva(ab,na,"need_OAuthManager","No OAuthManager");if(!this.ov.Io||!this.ov.Io.value)return this.mva(ab,na,"need_license","No License");if(v.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.mva(ab,
na,"need_user","Anonymous User");if(33E5>Date.now()-this.f3.timeStamp)return ab.push(Object(l.a)(new y.a,{name:"UsedCachedToken",bool:!0})),A.a(r.a.H$a,!0,0,ab),Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!0,Token:this.f3.token}));ab.push(Object(l.a)(new y.a,{name:"UsedCachedToken",bool:!1}));let Gb=1;const fc=(pb,Ea)=>(new Promise(xb=>{window.setTimeout(()=>{xb(pb)},Ea)})).then(xb=>{ab.push(Object(l.a)(new y.a,{name:"Error"+Gb,string:xb.ErrorMessage}));ab.push(Object(l.a)(new y.a,{name:"ErrorCode"+
Gb,string:xb.ErrorCode}));Gb++;return this.TPb()});return this.TPb().catch(pb=>fc(pb,200)).catch(pb=>fc(pb,400)).then(pb=>{pb.IsSuccess?(this.f3.token=pb.Token,this.f3.timeStamp=Date.now()):(ab.push(Object(l.a)(new y.a,{name:"Error"+Gb,string:pb.ErrorMessage})),ab.push(Object(l.a)(new y.a,{name:"ErrorCode"+Gb,string:pb.ErrorCode})));ab.push(Object(l.a)(new y.a,{name:"Attempts",int64:Gb}));ab.push(Object(l.a)(new y.a,{name:"Error",string:pb.ErrorMessage}));ab.push(Object(l.a)(new y.a,{name:"ErrorCode",
string:pb.ErrorCode}));A.a(r.a.H$a,pb.IsSuccess,n.getElapsedMilliseconds(na,w.a.Qa.zb),ab);return Promise.resolve(pb)}).catch(pb=>{ab.push(Object(l.a)(new y.a,{name:"Error"+Gb,string:pb.ErrorMessage}));ab.push(Object(l.a)(new y.a,{name:"ErrorCode"+Gb,string:pb.ErrorCode}));ab.push(Object(l.a)(new y.a,{name:"Attempts",int64:Gb}));return this.mva(ab,na,pb.ErrorCode,pb.ErrorMessage)})}mva(na,ab,Gb,fc){na.push(Object(l.a)(new y.a,{name:"Error",string:fc}));na.push(Object(l.a)(new y.a,{name:"ErrorCode",
string:Gb}));A.a(r.a.H$a,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),na);return Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:fc,ErrorCode:Gb}))}TPb(){var na=z.a.Fjd();let ab=0;na=this.oAuthManager.UL("Maker",na).then(Gb=>{if(Gb)return!Gb.IsSuccess&&this.CUd(Gb)?Promise.reject(Gb):Promise.resolve(Gb);Gb=Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Gb)}).catch(Gb=>{let fc=new B.a;Object.getType(Gb)===Object.getType(fc)?
fc=Gb:(fc.ErrorMessage=Gb.toString(),fc.ErrorCode="exception");return Promise.reject(fc)});return Promise.race([na,new Promise((Gb,fc)=>{ab=window.setTimeout(()=>{fc(Object(l.a)(new B.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(Gb=>{window.clearTimeout(ab);return Gb})}CUd(na){return"interaction_required"===na.ErrorCode||"InitFailed"===na.ErrorCode||"invalid_resource"===na.ErrorCode||"login_required"===na.ErrorCode&&na.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(u.a)(x,"AutomateCommandAuth",null,[802]);var F=a(815);class I{constructor(){this.Mu=null}}Object(u.a)(I,"AutomateCommandGalleryBase",null,[]);var L=a(375),X=a(30),P=a(558),G=a(1393),C=a(19),H=a(53),J=a(13);a(313);var M=a(576);class S{constructor(na,ab){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=na;this.currentUserMlapiToken=ab}}Object(u.a)(S,"UserInfo",null,[]);var W=a(188),O=a(60),T=a(33),Y=a(1),va=a(281);const ca=na=>"TestHost"===na.va.DocumentHostInfo.HostTier,
V=(na,ab)=>{ab.WacTaskPaneInfra=T.a.gd(na);ab.TaskpanelessRFB=!0;ab.OfficeScriptsAutomateTask=z.a.Cyf;ab.DeferAdminCheck=z.a.oua;ab.SharedScriptsButton=ra()},ra=()=>Y.EwaSettings.getBooleanFeatureGate(z.a.ETd,!1),N=(na,ab)=>{ca(na)&&(Y.EwaSettings.getBooleanFeatureGate(z.a.ema,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(na.va.UserSessionId);makerstorage.setUserAccessInfo(new S(ab,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")},ea=na=>{if(ca(na))return Y.EwaSettings.getBooleanFeatureGate(z.a.ema,!1)?"makerservicelocal":"localstorage";na=z.a.wLa();return z.a.Mxb(na)},Ba=(na,ab,Gb,fc,pb)=>{const Ea=na.userOperationManager,xb=na.pa;let bc=null,zb=null,Ub=null;const wc=()=>{if(Ea.Hta()||0<xb.ya.XU||0<xb.Mk.XU)return!1;bc&&Ea.mo(bc);zb&&xb.Nr(zb);Ub&&xb.jx(Ub);Ea.pD(new W.a(507,0,(mb,Db,Ic)=>O.g(xb.ya,"ExecuteRichApiRequest",fc,va.b(mb,ab),va.a(Db,Gb),Ic,null,0),80));return!0};wc()||(bc=()=>{wc()},zb=()=>{wc()},Ub=()=>
{wc()},Ea.xr(bc),xb.Nq(zb),xb.kw(Ub));return pb.task},ka=na=>{na=na.pa.ya.Na(1);na.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return na},Ka=na=>T.a.gd(na)?na.isChromeRtl?C.a.DSe:C.a.CSe:C.a.bKa,Oa=na=>T.a.gd(na)?C.a.Had:C.a.Gad;class wa{constructor(na,ab){this.automateCommandManager=na;this.$=ab}Led(na){const ab=this.automateCommandManager.Va.cq().QC();
if(!ra()){var Gb=wa.jF(na,J.a.instance.ga(2129));this.IGa(Gb,z.a.UEd,this.automateCommandManager.Od,z.a.IBd,J.a.instance.ga(2125),this.automateCommandManager.Va);ab.MenuSectionList.push(Gb)}Gb=wa.jF(na,J.a.instance.ga(2130));this.IGa(Gb,z.a.hAd,z.a.Uw?this.automateCommandManager.Qh.nvb(this.automateCommandManager.Od):this.automateCommandManager.tg.nvb(this.automateCommandManager.Od),z.a.rFb,J.a.instance.ga(2126),this.automateCommandManager.Va);ab.MenuSectionList.push(Gb);Gb=wa.jF(na,J.a.instance.ga(2131));
this.IGa(Gb,z.a.APd,this.automateCommandManager.Tk,z.a.rFb,"",this.automateCommandManager.Va);ab.MenuSectionList.push(Gb);Gb=Object(l.a)(new L.a,{Id:z.a.Rob,ExternalId:z.a.Rob,Command:"1606046412",LabelText:J.a.instance.ga(2122),Alt:J.a.instance.ga(2123),Image16by16:H.a.Ge(16),Image16by16Class:C.a.Kad,Visible:!0});na=wa.jF(na,null);na.ControlsId="myScriptsSection.Controls";if(ra()){const fc=Object(l.a)(new L.a,{Id:z.a.bNb,ExternalId:z.a.bNb,Command:"1043696663",LabelText:J.a.instance.ga(2132),Alt:J.a.instance.ga(2132),
ExternalImageId:"PeopleSharedIcon_16",Visible:!0});na.ControlList.push(fc)}na.ControlList.push(Gb);ab.MenuSectionList.push(na);return ab}IGa(na,ab,Gb,fc,pb,Ea){if(Gb&&0<Gb.length){ab=Ea.gB(ab,1,"Size150by20").rqb();pb={};Ea={};Ea.root=wa.lZ(320,30);Ea.flexContainer=wa.Q5c(!1);Ea.label=wa.i6c(!1);pb.galleryButtonInExpanded=Ea;ab.GalleryStyle=pb;for(pb=0;pb<Gb.length&&pb<fc;pb++)Ea=Gb.Hw(pb),ab.GalleryItems.push(wa.RIa(Ea.id,Ea));na.ControlList.push(ab)}else Gb=Object(l.a)(new M.a,{Id:ab,ExternalId:ab,
LabelText:pb}),na.ControlsId=Gb.Id+".Controls",na.ControlList.push(Gb)}static IMh(na){if(na){const ab=String.format(z.a.dff,na.isShared?z.a.cfg:z.a.J0f,H.a.Ge(16));na=String.format(z.a.eff,X.a.Eg(na.name));return String.format(z.a.cff,ab,na)}return""}static jF(na,ab){return Object(l.a)(new P.a,{Id:na,Title:ab,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})}static RIa(na,ab){const Gb=z.a.D_d,fc=z.a.UPd,pb=z.a.E_d,Ea=z.a.VPd;return ab?wa.Dsb(ab.shareId||
ab.id,"1904816141",ab.name,ab.isShared&&!ra()?Gb:fc,na,na,ab.isShared&&!ra()?pb:Ea):wa.Dsb("","1904816141","","",na,na)}static Dsb(na,ab,Gb,fc,pb=null,Ea=null,xb=null){const bc={},zb={};bc.root=wa.lZ(20,20);zb.root=wa.lZ(20,20);return Object(l.a)(new G.a,{Id:na,ExternalId:pb||na,MenuItemId:Ea||na,Command:ab,Icon:fc,Image:H.a.Ge(16),ImageClass:xb,LabelText:Gb,FullIconStyle:bc,PreviewIconStyle:zb,Alt:Gb})}static Q5c(na){const ab={display:"flex"};na?ab.flexDirection="column":(ab.height="100%",ab.flexWrap=
"nowrap",ab.justifyContent="left",ab.alignItems="left",ab.lineHeight="normal");return ab}static i6c(na){const ab={margin:"0px 3px"};na&&(ab["max-width"]="68px");return ab}static lZ(na,ab){const Gb={};Gb.width=na;Gb["min-width"]=na;Gb.height=ab;return Gb}}Object(u.a)(wa,"AutomateCommandRenderer",null,[]);class qa{constructor(na,ab){this.scripts=na;this.hOb=ab}get length(){return this.scripts.length}pN(na){for(let ab=0;ab<this.scripts.length;ab++)if(this.scripts[ab].id===na||this.scripts[ab].shareId===
na)return ab;return-1}sort(){this.hOb(this.scripts)}Lh(na){return-1===this.pN(na.id)?(this.scripts.push(na),!0):!1}HGa(na){return-1===this.pN(na.id)?(this.scripts=[na].concat(this.scripts),!0):!1}Tzd(na){na=this.pN(na.id);if(-1!==na){for(var ab=this.scripts[na].lU();0<na;)this.scripts[na]=this.scripts[na-1],na--;this.scripts[0]=ab}}CX(na){const ab=this.pN(na.id);if(-1!==ab){const Gb=this.scripts[ab].shareId;this.scripts[ab]=na;this.scripts[ab].shareId=Gb}}dBb(na){const ab=this.pN(na.id);return-1!==
ab?na.name===this.scripts[ab].name:!1}DU(na){na=this.pN(na);return-1!==na?(this.scripts.splice(na,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}Wm(na){na=this.pN(na);return-1!==na?this.scripts[na]:null}Hw(na){return 0<=na&&this.length>na?this.scripts[na]:null}nvb(na){const ab=new qa([],this.hOb);for(let Gb=0;Gb<this.scripts.length;Gb++){const fc=this.scripts[Gb];na.Wm(fc.id)||ab.Lh(fc)}return ab}wX(){const na=[];for(const ab of this.scripts)na.push(ab.Qfb());return na}}Object(u.a)(qa,
"ScriptCollection",null,[]);var aa=a(193);class ia{constructor(na){this.xz=aa.b(na)||{};this.shareId=this.shareId||null}get id(){return this.xz.id}get shareId(){return this.xz.shareId}set shareId(na){this.xz.shareId=na||null}get name(){return this.xz.name}get qtb(){return this.xz.dateLastPublished}get body(){return this.xz.body}get description(){return this.xz.description}get kAb(){return this.xz.isCreator}get isShared(){return!!this.shareId&&0<this.shareId.length}lU(){return new ia(this.xz)}Qfb(){return this.xz}}
Object(u.a)(ia,"ScriptCore",null,[]);var Ha=a(41);class Z extends I{constructor(na,ab){super();this.$=na;this.Se=ab}GLa(na){switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.Mu.Hw(parseInt(na,10)-1);default:return this.Se.Qh.Wm(na)||this.Se.tg.Wm(na)||this.Se.Od.Wm(na)||this.Se.Tk.Wm(na)}}pLa(na,ab){let Gb=null;if(this.Se.sV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Gb=this.Mu.Hw(parseInt(na,10)-1);break;default:Gb=this.Mu.Wm(na)}T.a.isReactRibbonEnabled()?
ab[F.a.GalleryButtonProps]=wa.RIa(na,Gb):ab[F.a.InnerHTML]=wa.IMh(Gb);ab[F.a.Alt]=Gb?Gb.name:""}Pp(na){this.Mu=this.aRa();this.$.af();const ab=[];ab.push(Object(l.a)(new y.a,{name:"Operation",string:na}));ab.push(Object(l.a)(new y.a,{name:"HasReadRecentCachedScripts",bool:this.Se.Fka}));ab.push(Object(l.a)(new y.a,{name:"ReadScriptsDone",bool:this.Se.jMa}));ab.push(Object(l.a)(new y.a,{name:"ReadSamplesScriptsDone",bool:this.Se.v7}));ab.push(Object(l.a)(new y.a,{name:"SamplesScriptCount",int64:this.Se.Tk.length}));
ab.push(Object(l.a)(new y.a,{name:"ReadRecentScriptsDone",bool:this.Se.HW}));ab.push(Object(l.a)(new y.a,{name:"RecentScriptCount",int64:this.Se.Qh.length}));ab.push(Object(l.a)(new y.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ls}));ab.push(Object(l.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Se.Od.length}));A.a(r.a.woc,!0,0,ab)}eMa(na){let ab=!1,Gb="";const fc=new ia(na.scriptMetadata),pb={Operation:"HandleRefreshRibbonGallery"};pb.RefreshOperation=na.operationName;switch(na.operationName){case z.a.nJb:({message:Gb,
returnValue:ab}=this.dMa(fc));break;case z.a.lJb:({message:Gb,returnValue:ab}=this.bMa(fc));break;case z.a.kJb:({message:Gb,returnValue:ab}=this.aMa(fc));break;case z.a.mJb:({message:Gb,returnValue:ab}=this.cMa(fc));break;case z.a.JKd:({message:Gb,returnValue:ab}=this.Xkd(fc))}(pb.GalleryUpdated=ab)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${Gb}`),this.Pp("RefreshGallery")):c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${Gb}`);
pb.Message=Gb;c.ULS.sendTraceTag(537170320,0,50,Ha.c(pb))}aRa(){const na=new qa([],()=>{}),ab=this.Se.Od?this.Se.Od.length:0,Gb=this.Se.Qh?this.Se.Qh.length:0,fc=this.Se.Tk?this.Se.Tk.length:0;let pb=0,Ea=z.a.oIb;for(let xb=0;xb<Ea;xb++)if(xb<ab)na.Lh(this.Se.Od.Hw(xb));else if(xb-ab+pb<Gb){const bc=this.Se.Qh.Hw(xb-ab+pb);this.Se.Od.Wm(bc.id)?(pb++,xb--):na.Lh(bc)}else xb-ab-Gb+pb<fc&&na.Lh(this.Se.Tk.Hw(xb-ab+pb-Gb));return na}dMa(na){let ab;if(this.Se.Qh.HGa(na))ab="";else{ab="";const Gb=na.lU();
this.Se.Od.CX(Gb);this.Se.Od.sort();this.Se.Qh.CX(na)}return{returnValue:!0,message:ab}}bMa(na){this.Se.Od.DU(na.id);return this.Se.Qh.DU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}aMa(na){const ab=na.lU();ab.shareId=null;this.Se.Qh.HGa(ab);return this.Se.Od.Lh(na)?(this.Se.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}cMa(na){return this.Se.Od.DU(na.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Xkd(na){const ab=na.lU();let Gb=!1;this.Se.Od.dBb(ab)&&(this.Se.Od.CX(ab),this.Se.Od.sort(),Gb=!0);this.Se.Qh.HGa(na)?Gb=!0:this.Se.Qh.dBb(na)&&(this.Se.Qh.CX(na),this.Se.Qh.Tzd(na),Gb=!0);return{returnValue:Gb,message:""}}}Object(u.a)(Z,"AutomateCommandGallery",I,[]);var la=a(83);class Xa{constructor(){this.Io=null}}Object(u.a)(Xa,"AutomateCommandLicensingBase",null,[]);
class Za{constructor(na,ab,Gb=null,fc="",pb=""){this.value=na;this.isSuccess=ab;this.timeStamp=Gb;this.errorCode=fc;this.errorMessage=pb}}Object(u.a)(Za,"BoolResultWrapper",null,[]);class xa extends Xa{constructor(){super()}sta(){const na=w.a.Qa.zb,ab=[];return new Promise(Gb=>{la.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fc=>{fc.isFeatureEnabled("ExcelOfficeScripting",!1).then(pb=>{ab.push(Object(l.a)(new y.a,{name:"IsLicensed",bool:pb}));A.a(r.a.soc,
!0,n.getElapsedMilliseconds(na,w.a.Qa.zb),ab);this.Io=new Za(pb,!0);Gb(pb)}).catch(pb=>{ab.push(Object(l.a)(new y.a,{name:"IsLicensed",bool:!1}));ab.push(Object(l.a)(new y.a,{name:"Error",string:pb.toString()}));ab.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"exception"}));A.a(r.a.soc,!1,n.getElapsedMilliseconds(na,w.a.Qa.zb),ab);this.Io=new Za(!1,!1,void 0,"exception",pb.toString());Gb(!1)})})})}}Object(u.a)(xa,"AutomateCommandLicensing",Xa,[]);var fa=a(1305),ua=a(1303),sa=a(1302),sb=a(1304),
hb=a(1394),bb=a(27),lb=a(170),Fa=a(570),Na=a(314),Mb=a(5);class dc{constructor(na,ab,Gb,fc){this.q6a=na;this.U$b=ab;this.jW=Gb;this.fZ=fc}}Object(u.a)(dc,"LaunchSDXParams",null,[]);class Cb{constructor(na,ab,Gb,fc,pb,Ea){this.actionName=na;this.shapeId=ab;this.scriptLink=Gb;this.clickId=fc;this.kR=pb;this.buttonText=Ea}}Object(u.a)(Cb,"RunfromButtonParameters",null,[]);var Tb=a(161),Jb=a(58),eb=a(750),za=a(51),ha=a(39),fb=a(136);class rb{constructor(na,ab,Gb,fc,pb,Ea,xb,bc,zb){this.WA=null;this.cache=
new Na.a;this.w_=!1;this.BM={};this.$=na;this.pmb=Gb;this.indexedDB=fc;this.Vpb=pb;this.ov=Ea;this.Gha=xb;this.Se=bc;this.KC=zb;this.aVg=new wa(this,na);this.DMc=w.a.Qa.zb;this.vOb="";fc.re()&&(this.w_=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));na=!0;if(bb.a.X_c){this.cache.re()&&!z.a.oua&&(ab=this.Se.J0e(z.a.ZKa(this.$)),ab.isSuccess&&(na=n.getElapsedSeconds(ab.timeStamp,w.a.Qa.zb),this.ov.Io=new Za(!0,!0),this.WA=new Za(ab.value,!0),na=this.WA.value?604800<na:86400<na,this.xyb=
this.sTa(!0)));this.afd();if("undefined"!==typeof makerstorage&&this.G8a)if(this.vOb=ea(this.$),ca(this.$))N(this.$,"localstorageToken"),this.ov.Io=new Za(!0,!0),this.WA=new Za(!0,!0),this.xyb=this.sTa(!0);else if((ab=z.a.wLa())&&makerstorage.setStorageEnvironmentOverride(ab),na||z.a.oua)try{this.$.eeb("automateTab",!0),this.xyb=z.a.oua?this.ov.sta().then(()=>this.Gha.mba()).then(()=>this.sTa(!1)).catch(()=>this.sTa(!1)):this.ov.sta().then(()=>this.Gha.mba()).then(Ub=>this.jbi(Ub)).then(()=>this.sTa(!1)).catch(()=>
this.sTa(!1))}catch(Ub){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Ub.message}`),this.xyb=Promise.resolve(!1),this.$.eeb("automateTab",!1)}this.xyb?this.xyb.then(Ub=>{this.nNd(Ub);this.Se.wjd()}):this.nNd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.nNd(!1)}get tg(){return this.Se.tg}get Od(){return ra()?
new qa([],()=>{}):this.Se.Od}get Tk(){return this.Se.Tk}get Qh(){return this.Se.Qh}get Va(){return this.pmb}get sV(){return this.Se.sV}get initTime(){return this.DMc}get kR(){const na=!!this.ov.Io&&this.ov.Io.isSuccess&&this.ov.Io.value;var ab=!!this.WA&&!this.WA.isSuccess;const Gb=!!this.WA&&this.ov.Io.isSuccess&&this.WA.value;ab=z.a.oua||Gb||ab&&!bb.a.eca(11);return this.G8a&&na&&ab}get G8a(){const na="TestHost"===this.$.va.DocumentHostInfo.HostTier;var ab=v.AFrameworkApplication.fa.Xa("UserPrincipalName");
ab=!v.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!ab&&!ab.includes("ext#")&&!ab.includes("guest#");return!bb.a.z5&&(na||this.Gha.Ppb&&ab)}sTa(na){const ab=v.AFrameworkApplication.fa.qa("IsO365CommercialHost");let Gb="",fc="",pb=!1;var Ea,xb=(Ea=this.ov.Io&&this.ov.Io.isSuccess)&&this.ov.Io.value;Ea=z.a.oua?Ea:!(xb&&(!this.WA||!this.WA.isSuccess));this.ov.Io&&!this.ov.Io.isSuccess?(fc=this.ov.Io.errorCode,Gb=this.ov.Io.errorMessage):this.WA&&!this.WA.isSuccess&&(fc=this.WA.errorCode,Gb=this.WA.errorMessage);
xb=[];xb.push(Object(l.a)(new y.a,{name:"IsScriptingEnabled",bool:this.kR}));xb.push(Object(l.a)(new y.a,{name:"IsValidHost",bool:ab}));xb.push(Object(l.a)(new y.a,{name:"IsUserLicensed",bool:this.ov.Io?this.ov.Io.value:!1}));z.a.oua||xb.push(Object(l.a)(new y.a,{name:"IsAdminSwitchOn",bool:this.WA?this.WA.value:!1}));xb.push(Object(l.a)(new y.a,{name:"ShowTab",bool:this.kR}));z.a.oua||xb.push(Object(l.a)(new y.a,{name:"ServiceChecked",bool:!na}));this.kR?T.a.Txa(this.$)&&(na=Tb.a(this.$),(null===
na||void 0===na?0:na.Gm)?(xb.push(Object(l.a)(new y.a,{name:"RibbonType",string:"React"})),na.Gm.NJj(Mb.a.Bda),na.Gm.zSd(["AutomateAutomateTask"],!z.a.Cyf&&!z.a.oAd),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(pb=!0)):(fc="ribbon_manager_error",Gb="The RibbonManager or RibbonUser is null")):this.bdi();xb.push(Object(l.a)(new y.a,{name:"Error",string:Gb}));
xb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:fc}));A.a(r.a.WMi,Ea,n.getElapsedMilliseconds(this.initTime,w.a.Qa.zb),xb);this.$.eeb("automateTab",!1);return Promise.resolve(pb)}Jc(na,ab){if(!ab)return!1;ab.MenuItems=this.aVg.Led(ab.MenuId);return!0}SGd(){this.w_&&(z.a.Uw?this.Se.XIb(this.KC).continueWith(na=>{na.result&&this.KC.Pp(z.a.sO)}):this.Se.$Jd(this.KC));ca(this.$)?this.Hxb(Object(l.a)(new B.a,{IsSuccess:!0,Token:"FakeToken"})):this.Gha.mba().then(na=>{this.Hxb(na)})}pLa(na,ab,Gb){if(z.a.Uw)this.KC.pLa(na,
ab,Gb);else{Gb=null;if(this.Se.sV)switch(na){case "1":case "2":case "3":case "4":case "5":case "6":Gb=this.KC.Mu.Hw(parseInt(na,10)-1);break;default:Gb=this.KC.Mu.Wm(na)}ab[F.a.GalleryButtonProps]=wa.RIa(na,Gb);ab[F.a.Alt]=Gb?Gb.name:""}}eMa(na){if(z.a.Uw)this.KC.eMa(na);else{let ab=!1,Gb="";const fc=new ia(na.scriptMetadata),pb={Operation:"HandleRefreshRibbonGallery"};pb.RefreshOperation=na.operationName;switch(na.operationName){case z.a.nJb:({message:Gb,returnValue:ab}=this.dMa(fc));break;case z.a.lJb:({message:Gb,
returnValue:ab}=this.bMa(fc));break;case z.a.kJb:({message:Gb,returnValue:ab}=this.aMa(fc));break;case z.a.mJb:({message:Gb,returnValue:ab}=this.cMa(fc))}(pb.GalleryUpdated=ab)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${Gb}`),this.Pp("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${Gb}`);pb.Message=Gb;c.ULS.sendTraceTag(537170311,0,50,
Ha.c(pb))}}$kd(na,ab,Gb,fc){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Zp(null,!1,1023))na=new Cb(z.a.qLb,na,ab,Gb,this.kR,fc),this.Vpb.Lwa(na)}iyb(na,ab,Gb){na=new Cb(z.a.P2d,na,ab,Gb,this.kR);this.Vpb.Lwa(na)}zkd(na){this.Vpb.ZLa(z.a.QVd,na)}ykd(na){this.Vpb.ZLa(z.a.A4c,na)}Akd(na){this.Vpb.ZLa(z.a.AXd,na)}Blc(na,ab){var Gb=za.b().uj(na);const fc=[];fc.push(Object(l.a)(new y.a,{name:"SessionId",string:this.$.va.UserSessionId}));z.a.oAd||(fc.push(Object(l.a)(new y.a,
{name:"MenuItemId",string:ab})),fc.push(Object(l.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Od.length})),fc.push(Object(l.a)(new y.a,{name:"PublishedScriptCount",int64:this.tg.length})),fc.push(Object(l.a)(new y.a,{name:"RecentScriptCount",int64:this.Qh.length})),fc.push(Object(l.a)(new y.a,{name:"Command",string:Gb})));ab=this.Nid(na,ab);if(Gb=this.i7f(na)?this.IYh():this.shd(na,Gb,ab))this.i7f(na)?(fa.a.instance.j6(Gb.U$b,"Taskpane",Gb.fZ,Gb.q6a,Gb.jW),A.a(r.a.hNf,void 0,void 0,fc)):(fc.push(Object(l.a)(new y.a,
{name:z.a.XC,string:Gb.jW.dh[z.a.XC]})),fa.a.instance.j6(Gb.U$b,"Taskpane",Gb.fZ,Gb.q6a,Gb.jW),1904816141===na&&(fc.push(Object(l.a)(new y.a,{name:"ScriptId",string:ab.id})),fc.push(Object(l.a)(new y.a,{name:"ShareId",string:ab.shareId})),fc.push(Object(l.a)(new y.a,{name:"IsPreviewGallery",bool:!!this.KC.Mu.Wm(ab.id)})),fc.push(Object(l.a)(new y.a,{name:"IsOwner",bool:ab.kAb||!!this.tg.Wm(ab.id)})),this.$.af()),A.a(r.a.zyf,void 0,void 0,fc))}IYh(){const na=new ua.a(z.a.axa,z.a.Bva,z.a.locale),ab=
new sa.a(z.a.KFd,OSF.StoreType.Sdx,OSF.StoreType.Sdx,z.a.LFd),Gb=new sb.a;Gb.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.xxb(this.$);return new dc(na,ab,Gb,null)}shd(na,ab,Gb){let fc=null;const pb=z.a.wq,Ea=new ua.a(z.a.axa,z.a.Bva,z.a.locale),xb=new sa.a(z.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,z.a.qSa),bc=new sb.a;bc.dh.AdminPolicyForFeedback=Ha.c(this.BM);bc.dh.DocumentHostInfo=Jb.a.hc(this.$.va.DocumentHostInfo);bc.dh.CodeEditorUrl=z.a.RZ(this.$);bc.dh.MakerTestService=
Y.EwaSettings.getBooleanFeatureGate(z.a.ema,!1);bc.dh[z.a.fLb]=z.a.fV(this.$);bc.dh.StorageModePreference=this.vOb||"";bc.dh.Source="Ribbon";bc.dh[z.a.XOb]=Jb.a.hc(pb);bc.dh[z.a.fqb]=this.$.roc?"true":"false";bc.dh[z.a.XC]=lb.a.create().toString();var zb=Ka(this.$);const Ub=Oa(this.$);bc.optionalProperties.HeaderCssClass=zb;bc.optionalProperties.TitleCssClass=Ub;bc.dh[z.a.Hyb]=zb;bc.dh[z.a.tPb]=Ub;zb={};zb.ribbonCommand=ab;zb[z.a.tOb]=this.Gha.getAuthContext();zb[z.a.AW]=this.Se.WIb?this.tg.wX():
null;zb[z.a.z3d]=this.Se.VQa?this.Od.wX():null;z.a.Uw&&(zb[z.a.sO]=this.Se.UQa?this.Qh.wX():null);bc.dh[z.a.Szb]=Jb.a.hc(zb);ab={};V(this.$,ab);bc.dh[z.a.zvb]=Jb.a.hc(ab);switch(na){case -45542983:bc.dh.Script="";bc.dh.Destination="Editor";bc.dh.IsOwner=!0;bc.optionalProperties[hb.a.Ri]=J.a.instance.ga(2118);bc.optionalProperties[hb.a.taskPaneWidth]=pb;bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.RZ(this.$);fc=z.a.nia;break;case -1342227603:bc.optionalProperties[hb.a.Ri]=J.a.instance.ga(2120);
bc.optionalProperties[hb.a.taskPaneWidth]=pb;bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.xxb(this.$);break;case 971811139:case 1606046412:bc.dh.Script="";bc.dh.Destination="BackStage";bc.dh.IsOwner=!0;bc.optionalProperties[hb.a.Ri]=J.a.instance.ga(2118);bc.optionalProperties[hb.a.taskPaneWidth]=pb;bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.RZ(this.$);fc=z.a.nia;break;case 1043696663:bc.dh.Script="";bc.dh.Destination="BackStage_Workbook";bc.optionalProperties[hb.a.Ri]=
J.a.instance.ga(2118);bc.optionalProperties[hb.a.taskPaneWidth]=pb;bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.RZ(this.$);fc=z.a.nia;break;case 1845457202:bc.optionalProperties[hb.a.Ri]=J.a.instance.ga(2119);bc.optionalProperties[hb.a.taskPaneWidth]=pb;bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.Hdc(this.$);fc=z.a.XPd;break;case -2126202430:case 1623358083:case 1904816141:if(Gb)bc.dh.Script=Jb.a.hc(Gb.Qfb()),bc.dh.Destination="Details",bc.dh.IsOwner=Gb.kAb||
!!this.tg.Wm(Gb.id),bc.optionalProperties[hb.a.Ri]=J.a.instance.ga(2118),bc.optionalProperties[hb.a.taskPaneWidth]=pb,bc.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.RZ(this.$),fc=z.a.nia;else return null;break;default:return null}return new dc(Ea,xb,bc,fc)}Nid(na,ab){switch(na){case -2126202430:na=this.Se.n8.Wm(z.a.bPb);break;case 1623358083:na=this.Se.n8.Wm(z.a.cPb);break;default:na=ab?this.GLa(ab):null}return na}afd(){la.a.instance.Ub("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(na=>
{this.BM.FeedbackEnabled=!0;this.BM.ScreenshotEnabled=!0;this.BM.EmailEnabled=!0;na.AF("Enabled").then(ab=>{this.BM.FeedbackEnabled=ab},()=>{});na.AF("IncludeScreenshot").then(ab=>{this.BM.ScreenshotEnabled=ab},()=>{});na.AF("IncludeEmail").then(ab=>{this.BM.EmailEnabled=ab},()=>{})})}jbi(na){const ab=w.a.Qa.zb,Gb=[];if(!na||!na.IsSuccess){const fc=na?na.ErrorCode:"need_token";na=na?na.ErrorMessage:"No Access Token";Gb.push(Object(l.a)(new y.a,{name:"ServiceChecked",bool:!1}));Gb.push(Object(l.a)(new y.a,
{name:"Error",string:na}));Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:fc}));A.a(r.a.VBd,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.WA=new Za(!1,!1,void 0,fc,na);return Promise.resolve(!1)}Gb.push(Object(l.a)(new y.a,{name:"ServiceChecked",bool:!0}));N(this.$,na.Token);return makerstorage.getUserPermissions(this.$.va.UserSessionId).then(fc=>{this.WA=new Za(fc.OfficeScriptingEnabled,!0);this.Se.Jze(z.a.ZKa(this.$),fc.OfficeScriptingEnabled);Gb.push(Object(l.a)(new y.a,{name:"IsEnabled",
bool:this.WA.value}));A.a(r.a.VBd,!0,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);return Promise.resolve(this.WA.value)}).catch(fc=>{Object.getType(fc)===makerstorage.StorageServiceError?(Gb.push(Object(l.a)(new y.a,{name:"Error",string:fc.message})),Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${fc.errorCode.toString()}_${fc.status.toString()}`}))):(Gb.push(Object(l.a)(new y.a,{name:"Error",string:fc.toString()})),Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"exception"})));
A.a(r.a.VBd,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.WA=new Za(!1,!1,void 0,"exception",fc.toString());return Promise.resolve(!1)})}Hxb(na){this.Se.Kid(this.KC);z.a.Uw?this.Se.Aid(na,this.KC,this.cache):this.nid(na);ra()||this.Se.ZJd(ab=>{this.Se.Yid(ab,na,this.KC)},this.KC)}nid(na){const ab=w.a.Qa.zb,Gb=[];if(na&&na.IsSuccess){N(this.$,na.Token);var fc=Fa.a.create().toString();Gb.push(Object(l.a)(new y.a,{name:"CorrelationId",string:fc}));makerstorage.getScripts(fc).then(pb=>{Gb.push(Object(l.a)(new y.a,
{name:"HasReadCachedScripts",bool:this.Se.a5}));this.tg.clear();for(const Ea of pb)this.tg.Lh(new ia(Ea));this.tg.sort();this.Se.WIb=!0;this.Se.GW=!0;this.w_&&(pb=Jb.a.hc(this.tg.wX()),this.indexedDB.Tna(new eb.a(z.a.AW,pb)));Gb.push(Object(l.a)(new y.a,{name:"ScriptCount",int64:this.tg.length}));A.a(r.a.Rca,!0,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.Pp(z.a.AW)}).catch(pb=>{Object.getType(pb)===makerstorage.StorageServiceError?(Gb.push(Object(l.a)(new y.a,{name:"Error",string:pb.message})),
Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${pb.errorCode.toString()}_${pb.status.toString()}`})),17===pb.errorCode&&this.cache.LJb(z.a.ZKa(this.$))):(Gb.push(Object(l.a)(new y.a,{name:"Error",string:pb.toString()})),Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"exception"})));A.a(r.a.Rca,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.Se.GW=!0;this.Pp(z.a.AW)})}else fc=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",Gb.push(Object(l.a)(new y.a,
{name:"ServiceChecked",bool:!1})),Gb.push(Object(l.a)(new y.a,{name:"Error",string:na})),Gb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:fc})),A.a(r.a.Rca,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb),this.Se.GW=!0,this.Pp(z.a.AW)}GLa(na){if(z.a.Uw)return this.KC.GLa(na);switch(na){case "1":case "2":case "3":case "4":case "5":case "6":return this.KC.Mu.Hw(parseInt(na,10)-1);default:return this.tg.Wm(na)||this.Od.Wm(na)||this.Tk.Wm(na)}}dMa(na){let ab;if(this.tg.Lh(na))this.tg.sort(),ab="";else{ab=
"";const Gb=na.lU();this.Od.CX(Gb);this.Od.sort();this.tg.CX(na);this.tg.sort()}return{returnValue:!0,message:ab}}bMa(na){this.Od.DU(na.id);return this.tg.DU(na.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}aMa(na){const ab=na.lU();ab.shareId=null;this.tg.Lh(ab)&&this.tg.sort();return this.Od.Lh(na)?(this.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}cMa(na){return this.Od.DU(na.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Pp(na){if(z.a.Uw)this.KC.Pp(na);else{this.aRa();this.$.af();const ab=[];ab.push(Object(l.a)(new y.a,{name:"Operation",string:na}));ab.push(Object(l.a)(new y.a,{name:"HasReadCachedScripts",bool:this.Se.a5}));ab.push(Object(l.a)(new y.a,{name:"ReadScriptsDone",bool:this.Se.jMa}));ab.push(Object(l.a)(new y.a,{name:"ReadSamplesScriptsDone",bool:this.Se.v7}));ab.push(Object(l.a)(new y.a,
{name:"SamplesScriptCount",int64:this.Tk.length}));ab.push(Object(l.a)(new y.a,{name:"ReadPublishedScriptsDone",bool:this.Se.GW}));ab.push(Object(l.a)(new y.a,{name:"PublishedScriptCount",int64:this.tg.length}));ab.push(Object(l.a)(new y.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ls}));ab.push(Object(l.a)(new y.a,{name:"WorkbookScriptCount",int64:this.Od.length}));A.a(r.a.woc,!0,0,ab)}}aRa(){this.KC.Mu=new qa([],()=>{});const na=this.Od?this.Od.length:0,ab=this.tg?this.tg.length:0,Gb=this.Tk?
this.Tk.length:0;let fc=0;const pb=z.a.oIb;for(let Ea=0;Ea<pb;Ea++)if(Ea<na)this.KC.Mu.Lh(this.Od.Hw(Ea));else if(Ea-na+fc<ab){const xb=this.tg.Hw(Ea-na+fc);this.Od.Wm(xb.id)?(fc++,Ea--):this.KC.Mu.Lh(xb)}else Ea-na-ab+fc<Gb&&this.KC.Mu.Lh(this.Tk.Hw(Ea-na+fc-ab))}nNd(na){Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(na?(ha.PageLoadTrackingInfo.instance.D0(Mb.a.zO,
["automateTab"]),ha.PageLoadTrackingInfo.instance.bS(Mb.a.zO,["automateTab"]),ha.PageLoadTrackingInfo.instance.QW(Mb.a.zO,["automateTab"])):ha.PageLoadTrackingInfo.instance.Tda(Mb.a.zO,["automateTab"]))}bdi(){Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&fb.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Mb.a.Bda))}i7f(na){return z.a.oAd&&-1342227603===na}}Object(u.a)(rb,"AutomateCommandManager",null,[801]);var pa=a(1360),Ma=a(1307),Ja=
a(249),Ga=a(857),La=a(50),nb=a(103),Lb=a(21),ac;(function(na){na.preparing="preparing";na.running="running";na.succeeded="succeeded";na.fetchFailed="fetchFailed";na.runFailed="runFailed";na.canceled="canceled";na.alreadyRunning="alreadyRunning";na.initializing="initializing"})(ac||(ac={}));Object(u.b)("OfficeScriptsRunStatus",ac);class ib{constructor(na,ab,Gb,fc,pb,Ea){this.scriptLink="";this.runStatus=ac.preparing;this.clickId="";this.hasLogs=this.isOwner=this.buttonText=void 0;this.scriptLink=na;
this.runStatus=ab;this.clickId=Gb;this.buttonText=fc;this.isOwner=pb;this.hasLogs=Ea}}Object(u.a)(ib,"OfficeScriptsBusinessBarParams",null,[]);class Ra{constructor(na){this.shareId="";this.shareId=na}}Object(u.a)(Ra,"OfficeScriptsShareLinkObject",null,[]);class ya{constructor(na,ab,Gb,fc){this.OV=!1;this.Tca=()=>{this.vNb()?(this.gIb(),Lb.h(this.$).Ea.WJb(this.Tca)):this.OV&&Lb.h(this.$).Ea.WJb(this.Tca)};this.SCd=(pb,Ea)=>{Object.getType(Ea)===String&&Ea.toString().endsWith(z.a.qba(this.$))&&(this.OV=
!1)};this.$=na;this.Gha=ab;this.ov=Gb;this.businessBarManager=fc;this.gTd()}Lwa(na){if(na.kR){const ab=[];ab.push(Object(l.a)(new y.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.OV}));ab.push(Object(l.a)(new y.a,{name:"actionName",string:na.actionName}));ab.push(Object(l.a)(new y.a,{name:z.a.XC,string:na.clickId.toString()}));this.OV?this.YLb(na):this.Mkd(na);A.a(r.a.Ayf,void 0,void 0,ab)}}ZLa(na,ab){const Gb={};Gb[z.a.XC]=ab;this.BSa(na,Gb)}gTd(){this.vNb()?this.gIb():Lb.h(this.$).Ea.eXc(this.Tca)}vNb(){if(this.OV||
ca(this.$))return!1;const na=nb.a(this.$);return Lb.h(this.$).Ea.Qob&&na.wgf()}gIb(){this.ov.Io?this.ov.Io.value&&this.Gha.mba():this.ov.sta().then(na=>{na&&this.Gha.mba()});A.a(r.a.vyf)}PQd(){const na=lb.a.create().toString();var ab={};V(this.$,ab);const Gb={};Gb[z.a.tOb]=this.Gha.getAuthContext();const fc={};fc[z.a.zvb]=Jb.a.hc(ab);fc[z.a.Szb]=Jb.a.hc(Gb);fc[z.a.j9c]=Jb.a.hc(this.$.va.DocumentHostInfo);fc[z.a.EXd]=ea(this.$);fc[z.a.XOb]=Jb.a.hc(z.a.wq);fc[z.a.fqb]=this.$.roc?"true":"false";fc[z.a.fLb]=
z.a.fV(this.$);fc[z.a.Hyb]=Ka(this.$);fc[z.a.tPb]=Oa(this.$);fc[z.a.XC]=na;ab=[];ab.push(Object(l.a)(new y.a,{name:z.a.XC,string:na}));A.a(r.a.yyf,void 0,void 0,ab);this.BSa(z.a.$nd,fc)}Mkd(na){this.$Ud(na);ca(this.$)&&N(this.$,"localstorage");f.TaskExtensions.Aa(La.GetServiceTaskFactory.Oa(this.$.da,374,375,1),ab=>{this.owd(ab.result).continueWith(()=>{this.OQd(na)});this.OV=!0},this.$.la,3)}owd(na){const ab={};ab.SolutionId=z.a.solutionId;ab.Version=z.a.qSa;ab.StoreType=OSF.StoreType.Sdx;ab.StoreId=
OSF.StoreType.Sdx;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(ab.AssetId=null,ab.AssetStoreId=null):(ab.AssetId=z.a.solutionId,ab.AssetStoreId=OSF.StoreType.Sdx);ab.TargetType=1;ab.SharedRuntimeId=z.a.qba(this.$);ab.SourceLocationOverrideResourceId=z.a.qba(this.$);ab.IsToBePersisted=!1;const Gb=new pa.a;Gb.Ri=J.a.instance.ga(2142);Gb.taskPaneWidth=z.a.wq;const fc=new Ga.a;fc.AUa=Oa(this.$);fc.e_=Ka(this.$);return na.CLb(ab,Gb,void 0,void 0,fc)}OQd(na){this.PQd();
Ja.a(this.$)&&Ja.a(this.$).nXc(this.SCd);this.YLb(na)}YLb(na){const ab={};ab[z.a.uPd]=na.shapeId;ab[z.a.tPd]=na.scriptLink;ab[z.a.XC]=na.clickId.toString();ab[z.a.sPd]=na.buttonText;this.BSa(na.actionName,ab)}BSa(na,ab){const Gb=new sa.a(z.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,z.a.qSa),fc=new ua.a(z.a.axa,z.a.Bva,this.$.va.UICultureTag),pb=new sb.a;pb.optionalProperties[hb.a.Ri]=J.a.instance.ga(2142);pb.optionalProperties[hb.a.sourceLocationOverrideResourceId]=z.a.qba(this.$);pb.optionalProperties[hb.a.LZb]=
ab;pb.optionalProperties[hb.a.taskPaneWidth]=z.a.wq;fa.a.instance.j6(Gb,Ma.a.action,na,fc,pb)}$Ud(na){na.actionName===z.a.qLb&&(na=new ib(na.scriptLink,"initializing",na.clickId.toString(),na.buttonText),this.businessBarManager.TWc(64,na))}}Object(u.a)(ya,"AutomateCommandRunFromButton",null,[669]);var Va=a(157),oa=a(22);class kb{constructor(){this.Qh=null;this.a5=this.v7=this.Ls=this.GW=this.VQa=this.WIb=this.UQa=this.HW=this.Fka=!1;this.n8=this.Tk=this.Od=this.tg=null}get sV(){const na=z.a.Uw?this.Fka:
this.a5;return this.v7||na||this.jMa}get jMa(){return(z.a.Uw?this.HW:this.GW)&&this.Ls&&this.v7}static EWd(na){na.sort((ab,Gb)=>Gb.qtb-ab.qtb)}static Foa(na){na.sort((ab,Gb)=>oa.a.compare(ab.name,Gb.name,!0))}static jjd(na){let ab,Gb;Gb=ab=null;if(na){const fc=na.indexOf(":");if(-1!==fc)return ab=na.substr(0,fc),Gb=na.substr(fc+1),{returnValue:!0,uOb:ab,shareId:Gb}}return{returnValue:!1,uOb:ab,shareId:Gb}}static Sid(na,ab){const Gb={};Gb[z.a.zRb]=encodeURIComponent(na.workbookContext.WorkbookFileName);
Gb[z.a.HLb]=ab.wX();return Ha.c(Gb)}static YIb(na,ab){return f.TaskExtensions.XJ(ab.bka(z.a.Dpa),Gb=>{Gb=Gb.result;if(""!==Gb){var fc=Ha.b(Gb);Gb=fc[z.a.HLb];if(fc[z.a.zRb]===encodeURIComponent(na.workbookContext.WorkbookFileName)){fc=new qa([],pb=>{kb.Foa(pb)});for(const pb of Gb)fc.Lh(new ia(pb));fc.sort();return fc}}},na.la,3)}}Object(u.a)(kb,"AutomateCommandStorageBase",null,[]);var Sa=a(116),U=a(98);class ta extends kb{constructor(na,ab){super();this.$=na;this.Gua=new DOMParser;this.cache=new Na.a;
this.indexedDB=ab;ab.re()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.a5=!1;this.tg=new qa([],Gb=>{kb.EWd(Gb)});this.Od=new qa([],Gb=>{kb.Foa(Gb)});this.Tk=new qa([],Gb=>{kb.Foa(Gb)});this.Qh=new qa([],()=>{});this.n8=new qa([],Gb=>{kb.Foa(Gb)})}Jze(na,ab){if(this.cache.re()){const Gb={};Gb.TimeStamp=w.a.Qa.zb;Gb.IsEnabled=ab;this.cache.vyc(na,Jb.a.hc(Gb))}}J0e(na){let ab=!1,Gb=!1,fc=null;this.cache.re()&&(na=Ha.b(this.cache.h5a(na)))&&(Gb=na.IsEnabled,fc=new Date(na.TimeStamp),
ab=!0);return new Za(Gb,ab,fc)}XIb(na){const ab=w.a.Qa.zb,Gb=[];return f.TaskExtensions.XJ(this.indexedDB.bka(z.a.sO),fc=>{const pb=!this.HW||!this.Qh.length;fc=fc.result;Gb.push(Object(l.a)(new y.a,{name:"ExistingScriptCount",int64:this.Qh.length}));if(""!==fc&&(fc=Ha.b(fc),Gb.push(Object(l.a)(new y.a,{name:"CachedScriptCount",int64:fc.length})),pb)){for(const Ea of fc)this.Qh.Lh(new ia(Ea));this.Fka=!0;this.UQa=0<fc.length;A.a(r.a.uoc,pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.gRa(na);return!0}A.a(r.a.uoc,
pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);return!1},this.$.la,3)}$Jd(na){Y.EwaSettings.getBooleanFeatureGate(z.a.wHa,!1)&&!ra()&&this.cKd(na);z.a.Uw?this.XIb(na):this.YJd(na)}Aid(na,ab,Gb){const fc=w.a.Qa.zb,pb=[];if(na&&na.IsSuccess){N(this.$,na.Token);var Ea=Fa.a.create().toString();pb.push(Object(l.a)(new y.a,{name:"CorrelationId",string:Ea}));makerstorage.getRecentScripts(Ea).then(xb=>{pb.push(Object(l.a)(new y.a,{name:"HasReadCachedScripts",bool:this.Fka}));this.Qh.clear();for(const bc of xb)this.Qh.Lh(new ia(bc));
this.HW=this.UQa=!0;this.indexedDB.re()&&(xb=Jb.a.hc(this.Qh.wX()),this.indexedDB.Tna(new eb.a(z.a.sO,xb)));pb.push(Object(l.a)(new y.a,{name:"ScriptCount",int64:this.Qh.length}));A.a(r.a.Rca,!0,n.getElapsedMilliseconds(fc,w.a.Qa.zb),pb);ab.Pp(z.a.sO)}).catch(xb=>{Object.getType(xb)===makerstorage.StorageServiceError?(pb.push(Object(l.a)(new y.a,{name:"Error",string:xb.message})),pb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${xb.errorCode.toString()}_${xb.status.toString()}`})),
17===xb.errorCode&&Gb.LJb(z.a.ZKa(this.$))):(pb.push(Object(l.a)(new y.a,{name:"Error",string:xb.toString()})),pb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"exception"})));A.a(r.a.wyf,!1,n.getElapsedMilliseconds(fc,w.a.Qa.zb),pb);this.HW=!0;ab.Pp(z.a.sO)})}else Ea=na?na.ErrorCode:"need_token",na=na?na.ErrorMessage:"No Access Token",pb.push(Object(l.a)(new y.a,{name:"ServiceChecked",bool:!1})),pb.push(Object(l.a)(new y.a,{name:"Error",string:na})),pb.push(Object(l.a)(new y.a,{name:"ErrorCode",
string:Ea})),A.a(r.a.Rca,!1,n.getElapsedMilliseconds(fc,w.a.Qa.zb),pb),this.HW=!0,ab.Pp(z.a.sO)}ZJd(na,ab){const Gb=new Va.a,fc=ka(this.$);Ba(this.$,pb=>{if((pb=pb.Result)&&200===pb.ResponseStatusCode)pb=pb.ResponseBody.join(""),pb=JSON.parse(pb),na(this.dGd(pb.value)),Gb.setResult(!0);else{pb=pb?"RichApi_"+pb.ResponseStatusCode:"RichApiError";const Ea=[];Ea.push(Object(l.a)(new y.a,{name:"Error",string:"Failed to read shared script ids from document"}));Ea.push(Object(l.a)(new y.a,{name:"ErrorCode",
string:pb}));this.Ls=!0;this.jU(ab,w.a.Qa.zb,0,Ea);Gb.setResult(!1)}},pb=>{pb=Sa.a.Oe(pb.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const Ea=[];Ea.push(Object(l.a)(new y.a,{name:"Error",string:"Failure using rich api: "+pb}));Ea.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"RichApiFailure"}));this.Ls=!0;this.jU(ab,w.a.Qa.zb,0,Ea);Gb.setResult(!1)},fc,Gb)}Yid(na,ab,Gb){const fc=w.a.Qa.zb;let pb=0,Ea=0;this.Ls=pb===na.count;const xb=
[];xb.push(Object(l.a)(new y.a,{name:"ScriptIds",int64:na.count}));if(na.count)if(ab&&ab.IsSuccess){N(this.$,ab.Token);for(var bc of na){const zb=Fa.a.create().toString();makerstorage.getSharedScript(bc.value,zb).then(Ub=>{const wc=[];wc.push(Object(l.a)(new y.a,{name:"BodySize",int64:Ub.body.length}));wc.push(Object(l.a)(new y.a,{name:"CorrelationId",string:zb}));A.a(r.a.voc,!0,n.getElapsedMilliseconds(fc,w.a.Qa.zb),wc);pb++;Ub=new ia(Ub);Ub.shareId=na.oa(Ub.id);this.Od.Lh(Ub);this.Ls=pb===na.count;
this.VQa=!0;this.jU(Gb,fc,Ea,xb)}).catch(Ub=>{const wc=[];Object.getType(Ub)===makerstorage.StorageServiceError?(xb.push(Object(l.a)(new y.a,{name:"Error",string:Ub.message})),xb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:`makerstorage_${Ub.errorCode.toString()}_${Ub.status.toString()}`}))):(wc.push(Object(l.a)(new y.a,{name:"Error",string:Ub.toString()})),wc.push(Object(l.a)(new y.a,{name:"ErrorCode",string:"exception"})));wc.push(Object(l.a)(new y.a,{name:"CorrelationId",string:zb}));A.a(r.a.voc,
!1,n.getElapsedMilliseconds(fc,w.a.Qa.zb),wc);pb++;Ea++;this.Ls=pb===na.count;this.jU(Gb,fc,Ea,xb)}).finally(()=>{if(Y.EwaSettings.getBooleanFeatureGate(z.a.wHa,!1)&&this.indexedDB.re()&&this.Ls){const Ub=kb.Sid(this.$,this.Od);this.indexedDB.Tna(new eb.a(z.a.Dpa,Ub))}})}}else bc=ab?ab.ErrorCode:"need_token",ab=ab?ab.ErrorMessage:"No Access Token",xb.push(Object(l.a)(new y.a,{name:"Error",string:ab})),xb.push(Object(l.a)(new y.a,{name:"ErrorCode",string:bc})),this.Ls=!0,this.jU(Gb,fc,Ea,xb);else this.Ls=
this.VQa=!0,this.jU(Gb,fc,Ea,xb),Y.EwaSettings.getBooleanFeatureGate(z.a.wHa,!1)&&f.TaskExtensions.XJ(kb.YIb(this.$,this.indexedDB),zb=>{zb.result&&(this.indexedDB.U7b(z.a.Dpa),this.Od.clear(),Gb.Pp("CachedScripts"))},this.$.la,3)}Kid(na){const ab={id:"samples-6"};ab.name=J.a.instance.ga(2136);this.Tk.Lh(new ia(ab));ab.id="samples-8";ab.name=J.a.instance.ga(2137);this.Tk.Lh(new ia(ab));ab.id="samples-2";ab.name=J.a.instance.ga(2133);this.Tk.Lh(new ia(ab));ab.id="samples-4";ab.name=J.a.instance.ga(2134);
this.Tk.Lh(new ia(ab));ab.id="samples-5";ab.name=J.a.instance.ga(2135);this.Tk.Lh(new ia(ab));ab.id="samples-9";ab.name=J.a.instance.ga(2138);this.Tk.Lh(new ia(ab));this.v7=!0;na.Pp("SampleScripts")}wjd(){const na={};na.id=z.a.bPb;na.name=J.a.instance.ga(2139);this.n8.Lh(new ia(na));na.id=z.a.cPb;na.name=J.a.instance.ga(2140);this.n8.Lh(new ia(na))}dGd(na){const ab=new U.a;if(na=this.Gua.parseFromString(na,"text/xml").querySelector('[id="script-ids-node-id"]')){na=na.getElementsByTagName("scriptId");
for(let Gb=0;Gb<na.length;Gb++){const fc=na[Gb].getAttribute("id");if(fc){let pb,Ea;({uOb:pb,shareId:Ea}=kb.jjd(fc)).returnValue&&ab.ia(pb,Ea)}}}return ab}cKd(na){const ab=w.a.Qa.zb,Gb=[];f.TaskExtensions.XJ(kb.YIb(this.$,this.indexedDB),fc=>{fc=fc.result;Gb.push(Object(l.a)(new y.a,{name:"ExistingScriptCount",int64:this.Od.length}));if(fc){Gb.push(Object(l.a)(new y.a,{name:"CachedScriptCount",int64:fc.length}));const pb=!this.Ls||0===this.Od.length;if(pb){for(const Ea of fc.getScripts())this.Od.Lh(Ea);
this.Od.sort();A.a(r.a.G$a,pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.gRa(na);return!0}A.a(r.a.G$a,pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb)}else A.a(r.a.G$a,!1,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);return!1},this.$.la,3)}YJd(na){const ab=w.a.Qa.zb,Gb=[];f.TaskExtensions.XJ(this.indexedDB.bka(z.a.AW),fc=>{const pb=!this.GW||!this.tg.length;fc=fc.result;Gb.push(Object(l.a)(new y.a,{name:"ExistingScriptCount",int64:this.tg.length}));if(""!==fc&&(fc=Ha.b(fc),Gb.push(Object(l.a)(new y.a,
{name:"CachedScriptCount",int64:fc.length})),pb)){for(const Ea of fc)this.tg.Lh(new ia(Ea));this.tg.sort();A.a(r.a.toc,pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);this.gRa(na);return!0}A.a(r.a.toc,pb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),Gb);return!1},this.$.la,3)}jU(na,ab,Gb,fc){this.Ls&&(fc.push(Object(l.a)(new y.a,{name:"ScriptCount",int64:this.Od.length})),fc.push(Object(l.a)(new y.a,{name:"ScriptErrorCount",int64:Gb})),A.a(r.a.xyf,!Gb,n.getElapsedMilliseconds(ab,w.a.Qa.zb),fc),this.Od.sort(),
na.Pp(z.a.Dpa))}gRa(na){this.a5=!0;na.Pp("CachedScripts")}}Object(u.a)(ta,"AutomateCommandStorage",kb,[]);var ub=a(695);class hc extends b.a{constructor(na){super();this.$=na;this.Fb()}create(){const na=La.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya),ab=H.a.loadScript(133,4,this.Ya,void 0,void 0,351),Gb=La.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.Ya),fc=La.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Ya),pb=La.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([na,
ab,Gb,fc,pb],this.la,3),()=>{const Ea=na.result,xb=fc.result;var bc=pb.result;const zb=new xa,Ub=new x(this.$,Ea,zb),wc=new ta(this.$,xb),mb=new Z(this.$,wc),Db=new ya(this.$,Ub,zb,bc);bc=Object(ub.a)(this.$.da,352,()=>new rb(this.$,Ea,Gb.result,xb,Db,zb,Ub,wc,mb));this.ob(bc)},this.la,3)}static ka(na){na&&na.da.Ga(351,new hc(na))}}Object(u.a)(hc,"AutomateCommandManagerFactory",b.a,[]);var Bc=a(9);a.d(D,"a",function(){return Qa});const Qa=()=>{Bc.a.Fa(na=>{m.ka(na);hc.ka(na)})}},1187:function(u,D,
a){u=a(0);var c=a(15),b=a(84),e;(function(P){P[P.generalException=0]="generalException";P[P.invalidArgument=1]="invalidArgument";P[P.notAllowed=2]="notAllowed";P[P.apiNotAvailable=3]="apiNotAvailable";P[P.unresolvedPendingRequest=4]="unresolvedPendingRequest";P[P.timeout=5]="timeout";P[P.adalTimeout=6]="adalTimeout";P[P.userNotSignedIn=7]="userNotSignedIn";P[P.userAborted=8]="userAborted";P[P.silentSignInFailed=9]="silentSignInFailed";P[P.invalidResourceUrl=10]="invalidResourceUrl";P[P.invalidGrant=
11]="invalidGrant";P[P.connectionLost=12]="connectionLost";P[P.clientError=13]="clientError";P[P.serverError=14]="serverError"})(e||(e={}));Object(u.b)("ErrorCodes",e);a(1301);class f{constructor(P,G){this.requestCallback=this.requestParameters=null;this.requestParameters=P;this.requestCallback=G}}Object(u.a)(f,"OutstandingRequest",null,[]);class d{}d.kLi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.fLi="AADSTS65001";d.uLi="AADSTS70011";d.userAborted="13002";d.W6i="Popup Window is null";d.V6i=
"Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.iTj="tokenRevoked";Object(u.a)(d,"WopiHostErrorType",null,[]);var h=a(4),m=a(729),l=a(570),v=a(41),t=a(1300);class z{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(z,"WopiIdentityInfo",null,[390]);class r{constructor(P,G,C){this.expiration=this.authority=this.accessToken=null;this.accessToken=P;this.authority=G;this.expiration=C}}Object(u.a)(r,
"WopiIdentityToken",null,[389]);var n=a(27),w=a(147),B=a(373),A=a(164),y=a(72),x=a(344);class F{constructor(P){this._initialized=!1;this.Nab={};this.dBc={};this.TO=h.AFrameworkApplication.sa.mE;this.Gmd=P}g3a(P){this._initialized||(P.uo(A.a.WMf),P.em(A.a.WMf,Object(b.a)(this,this.kYi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(P,G,C=null){this.POa(P,G);return new Promise((H,J)=>{if(this.gpd(G))if(G in this.Nab)J("unresolvedPendingRequest");else{var M=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,
344,10,v.c({["error"]:"Request timeout.",["callerId"]:G}));J("timeout")},12E4);this.Qed(P,G,C,(S,W)=>{window.clearTimeout(M);S?H(S):(c.ULS.sendTraceTag(37856033,369,15,v.c({["error"]:e[W]})),J(W))})}else c.ULS.sendTraceTag(37856034,344,10,v.c({["error"]:"Caller is not allowed."})),J("notAllowed")})}getPrimaryIdentityInfo(P){return new Promise((G,C)=>{this.gpd(P)?this.g1h((H,J)=>{H?G(H):(c.ULS.sendTraceTag(37856064,369,10,v.c({["error"]:J.toString()})),C(J))}):(c.ULS.sendTraceTag(37856065,344,10,v.c({["error"]:"Caller is not allowed."})),
C("notAllowed"))})}getAuthContext(P){return new Promise((G,C)=>{const H=this.getAuthContextSync(P);H?G(H):C("notAllowed")})}getAuthContextSync(P){if(this.gpd(P)){const G=new t.a;G.upn=h.AFrameworkApplication.fa.Xa("UserPrincipalName");G.userId=h.AFrameworkApplication.fa.Xa("LoggableUserId");G.authority=h.AFrameworkApplication.fa.Xa("HostAuthAuthority");G.tenantId=h.AFrameworkApplication.fa.Xa("TenantId");G.isAnonymous=h.AFrameworkApplication.fa.qa("IsAnonymousUser");G.supportsAuthToken=this.Sdi(P);
P=h.AFrameworkApplication.fa.Xa("HostAuthType");G.authorityType="aad"===P.toLowerCase()?2:"msa"===P.toLowerCase()?1:0;return G}c.ULS.sendTraceTag(40751647,344,10,v.c({["error"]:"Caller is not allowed."}));return null}Sdi(P){const G=m.a.bzb;return n.a.aya?G&&m.a.Tcg?Array.contains(m.a.Tcg,P.toLowerCase()):!1:G}Qed(P,G,C,H){var J=[];Array.add(J,Object.assign(new y.a,{name:"CallerId",string:G}));Array.add(J,Object.assign(new y.a,{name:B.a.PWd,string:P.correlationId}));w.a.sendTelemetryEvent(Object.assign(new x.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:J}));J=l.a.create().toString();const M="getAccessToken_"+J,S=this.TO.Ac("ComponentAttach",M);this.dBc[M]=S;const W={};W[B.a.QWd]=J;W[B.a.FMj]=P.resource;W[B.a.GMj]=P.scope;W[B.a.S$f]=h.AFrameworkApplication.fa.Xa("HostAuthType");W[B.a.JMj]=h.AFrameworkApplication.fa.Xa("UserPrincipalName");W[B.a.HMj]=P.silentLogin;W[B.a.CMj]=P.options;W[B.a.PWd]=P.correlationId;W[B.a.DMj]=G;C&&(W[B.a.addinName]=C.AddinName,W[B.a.BMj]=
C.AddinTrustId);this.Gmd.execute(O=>{this.g3a(O);O.Oj(A.a.getAuthToken,W)});this.Nab[J]=new f(P,H)}g1h(P){const G=h.AFrameworkApplication.fa.Xa("UserName"),C=h.AFrameworkApplication.fa.Xa("UserPrincipalName"),H=h.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),J=new z;J.email=C;J.displayName=G;switch(H){case "OrgIdPuid":J.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":J.authority="MicrosoftAccount";break;default:J.authority=H}P(J,null)}kYi(P){let G=null;try{let H=P.Values[B.a.QWd];
const J=P.Values[B.a.AMj],M=P.Values[B.a.S$f],S=P.Values[B.a.IMj];let W=null,O=null;const T=this.Nab[H];if("undefined"!==typeof T&&T){var C=[];Array.add(C,Object.assign(new y.a,{name:B.a.PWd,string:T.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new x.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:C}));G=T.requestCallback;delete this.Nab[H];"undefined"!==typeof J&&J&&J.length?O=new r(J,M,S):W=e[this.qGi(P)];C="getAccessToken_"+H;C in
this.dBc&&(this.dBc[C].stop(),delete this.dBc[C]);G(O,W)}else c.ULS.sendTraceTag(37856066,344,10,v.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:H}))}catch(H){P=P.Values[B.a.QWd],P in this.Nab&&delete this.Nab[P],this.amc(),c.ULS.sendTraceTag(37856067,344,10,v.c({["error"]:H.message,["stack"]:H.stack})),G&&G(null,"generalException")}}gpd(P){var G=h.AFrameworkApplication.b8h();P=P.toLowerCase();for(const C of G)if(P===C.toLowerCase())return!0;G=m.a.KYc;for(let C in G)if(P===
G[C].toLowerCase())return!0;return!1}qGi(P){P=P.Values[B.a.EMj];this.amc();c.ULS.sendTraceTag(39068821,344,15,v.c({["error"]:P}));return P?-1<P.indexOf(d.kLi)?9:-1<P.indexOf(d.W6i)||-1<P.indexOf(d.V6i)?12:-1<P.indexOf(d.invalidResourceUrl)?10:-1<P.indexOf(d.userAborted)?8:-1<P.indexOf(d.uLi)||-1<P.indexOf(d.fLi)||P===d.iTj?11:-1<P.indexOf(d.adalTimeout)?6:0:13}POa(P,G){P=this.qej(P.resource);c.ULS.sendTraceTag(39921882,344,50,v.c({["callerId"]:G,["resource"]:P}))}amc(){c.ULS.sendTraceTag(39068822,
344,50,v.c({["userAgent"]:window.navigator.userAgent}))}qej(P){return(P?P:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(F,"WopiIdentityManager",null,[346]);var I=a(248);class L{constructor(){this.gb=null}get name(){return"Common.App.WopiIdentity"}Vh(P){this.gb=P;P.register(F,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").xc().Fc(()=>new F(P.Ub("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&
h.AFrameworkApplication.fa.Fv(Object(b.a)(this,this.NB,"onFullAppSettingsReady"))}NB(){try{this.gb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(P){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+P)}}dispose(){}static main(){I.a.instance.Ei(new L)}}Object(u.a)(L,"WopiIdentityPackage",null,[4,5]);a.d(D,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.WopiIdentity");L.main()}},1192:function(u,D,a){a.r(D);u=a(0);var c=
a(7),b=a(15),e=a(4),f=a(157),d=a(187),h=a(82),m=a(188),l=a(60),v=a(50),t=a(37),z=a(227),r=a(116),n=a(527);class w{constructor(wa){wa=wa.split("|");this.Ax=wa[1];this.DTc=wa[2];this.LXd=wa[3]}get solutionId(){return this.Ax}get solutionVersion(){return this.DTc}get needToRestoreManifest(){return this.LXd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(w,"AddinStoreInfo",null,[]);class B{}Object(u.a)(B,"CustomFunctionRegistrationInfos",null,[]);var A=a(196),y=a(66);const x=(wa,qa,aa)=>F(wa,qa,
A.a.none,y.a.current,aa),F=(wa,qa,aa,ia,Ha)=>{aa=wa.continueWith(()=>{qa(wa)},3,aa,ia);aa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Ha)},4);return aa},I=(wa,qa,aa)=>L(wa,qa,A.a.none,y.a.current,aa),L=(wa,qa,aa,ia,Ha)=>{aa=wa.jp(()=>qa(wa),3,aa,ia);aa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,Ha)},4);return t.TaskExtensions.uDc(aa)},X=(wa,qa,aa)=>P(wa,qa,A.a.none,y.a.current,aa),P=(wa,qa,aa,ia,Ha)=>{aa=wa.jp(()=>qa(wa),3,aa,ia);aa.continueWith(()=>{b.ULS.sendTraceTag(537163461,
0,10,Ha)},4);return aa},G=(wa,qa,aa)=>C(wa,qa,A.a.none,y.a.current,aa),C=(wa,qa,aa,ia,Ha)=>{aa=wa.jp(()=>qa(wa),3,aa,ia);aa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Ha)},4);return t.TaskExtensions.uDc(aa)},H=(wa,qa,aa)=>J(wa,qa,A.a.none,y.a.current,aa),J=(wa,qa,aa,ia,Ha)=>{aa=wa.continueWith(()=>{qa(wa)},3,aa,ia);aa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Ha)},4);return aa},M=(wa,qa)=>{X(a(1192).CustomFunctionsInstaller.q4e("CustomFunctionsRuntimeLogging"),aa=>{if(aa.result&&
window.console)switch(aa=S(wa.severity)+" "+wa.message+qa,wa.severity){case 2:window.console.log&&window.console.log(aa);break;case 0:window.console.info&&window.console.info(aa);break;case 1:window.console.error&&window.console.error(aa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},S=wa=>{switch(wa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var W=a(960);class O{}Object(u.a)(O,"InstallationInfo",
null,[]);class T{}Object(u.a)(T,"UninstallationInfo",null,[]);var Y=a(28),va=a(91),ca=a(35),V=a(29),ra=a(1),N=a(22),ea=a(281),Ba=a(750),ka=a(55);class Ka{constructor(wa,qa){this.$Sc=wa;this._message=qa}get severity(){return this.$Sc}get message(){return this._message}}Object(u.a)(Ka,"CustomFunctionLog",null,[]);a.d(D,"CustomFunctionsInstaller",function(){return Oa});class Oa{constructor(wa,qa,aa){this.w_=!1;this.OF={};this.$=wa;this.wj=qa;this.Dod().Sna();this.indexedDB=aa;this.indexedDB.re()&&(this.w_=
!0,this.indexedDB.initialize(Oa.wzb,Oa.xzb))}get yV(){return this.wj.yV}tff(wa,qa,aa,ia){if(ia.invariantNamespace)for(let Ha=0;Ha<ia.invariantNamespace.length;++Ha){const Z=ia.invariantNamespace.charAt(Ha);if("."!==Z&&"_"!==Z&&"a">Z&&"z"<Z&&"A">Z&&"Z"<Z&&"0">Z&&"9"<Z)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Z}', Position=${Ha}.`),Error.create("InvariantNamespace validation failed");}return I(this.T_g(aa,ia.manifest),
()=>I(this.VJd(wa),Ha=>{let Z=Ha.result;return(null===Z||void 0===Z?0:Z.isDynamicMetadata)?this.YKd(wa,qa,Z,!1,!1,!1):I(this.N5j(wa,qa,ia),la=>{let Xa;Z=(Xa=new O,Xa.addinId=aa,Xa.locale=ia.locale,Xa.addinInvariantNamespace=ia.invariantNamespace,Xa.addinNamespace=ia.namespace,Xa.addinTitle=ia.title,Xa.isXllCompatible=ia.isXllCompatible,Xa.metadataContent=JSON.stringify(JSON.parse(la.result)),Xa);return this.YKd(wa,qa,Z,!1,Oa.MFh(ia.osfControl.getStoreType()),W.a(this.$,ia))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}vff(wa,qa,aa,ia){if(!Oa.$td(aa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return I(this.VJd(wa),Ha=>{Ha=Ha.result;if(!Ha&&(Ha=ca.a.Dc(this.yV,wa),!Ha))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,
qa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Ha.metadataContent=JSON.stringify(JSON.parse(aa));Ha.isDynamicMetadata=!0;return this.YKd(wa,qa,Ha,!0,!0,ia)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Hgg(wa,qa){this.wj.cja();const aa=Object(c.a)(new T,{solutionId:wa}),ia=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,
qa,null)}.`;return I(this.JLd(wa),()=>I(this.PLd(wa),()=>this.A0d(this.wj,wa,qa,aa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),ia)}N5j(wa,qa,aa){const ia=new f.a;OSF.OUtil.xhrGet(aa.metadataUrl,Ha=>{Ha?ia.setResult(Ha):ia.setException(Error.create("Invalid manifest"))},Ha=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,
qa,null)}. ErrorCode: ${Ha}.`);ra.EwaSettings.isChangeGateEnabled("OfficeVSO:7223300_HandleFaultedTaskXhrGetMetadataAsync")?ia.Rs():ia.setException(Error.create("Failed to download manifest"))});return ia.task}Dod(){return I(this.Ftc(),wa=>{const qa=wa.result;if(!qa.length)return ka.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");wa=new d.a;const aa=[];for(let ia=0;ia<qa.length;ia++){const Ha=Object(h.a)(String,
qa[ia]);wa.add(X(this.VJd(Ha),Z=>{if(Z=Z.result){const la=ca.a.Dc(this.OF,Z.addinId);la&&la===Z.metadataContent||(this.OF[Z.addinId]=Z.metadataContent,this.yV[Ha]=Z,aa.push(Z))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return G(ka.Task.WhenAllEnumerable(wa),()=>{if(aa.length){let ia;const Ha=(ia=new B,ia.registrationInfos=aa,ia);return this.j2b(this.wj,qa,Ha)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return ka.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}wff(){var wa=new f.a;new d.a;const qa=[],aa=[];Object.keys(this.yV).forEach(ia=>{ia=Object(h.a)(String,ia);const Ha=ca.a.Dc(this.yV,ia);qa.push(Ha);aa.push(ia)});if(!aa.length)return wa.setResult(!0),wa.task;wa=Object(c.a)(new B,{registrationInfos:qa});return this.j2b(this.wj,aa,wa)}Ftc(){return X(this.vhd(n.a.XZa),wa=>{wa=
wa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(wa||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(wa||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Bmg(wa){return this.kSd(n.a.XZa,Sys.Serialization.JavaScriptSerializer.serialize(wa))}VJd(wa){return I(this.vhd(n.a.l5a(wa)),qa=>{qa=qa.result||"";return 0<qa.length?ka.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(qa,!0)):
ka.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}F5j(wa,qa){return I(this.mQe(wa),()=>I(this.kSd(n.a.l5a(wa),Sys.Serialization.JavaScriptSerializer.serialize(qa)),()=>Oa.lSd(n.a.uld,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}JLd(wa){return I(this.cUf(wa),
()=>I(this.uUf(n.a.l5a(wa)),()=>I(this.Ftc(),qa=>qa.result.length?ka.Task.Ta(!0):Oa.lSd(n.a.uld,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}uRf(wa){return this.vhd(n.a.k5a(wa))}ymg(wa,qa){return I(this.mQe(wa),
()=>this.kSd(n.a.k5a(wa),qa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}PLd(wa){return I(this.cUf(wa),()=>this.uUf(n.a.k5a(wa)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}mQe(wa){return I(this.Ftc(),qa=>{qa=qa.result;const aa=wa.toLowerCase();if(qa.includes(aa))return ka.Task.Ta(!0);qa.push(aa);return this.Bmg(qa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}cUf(wa){return I(this.Ftc(),
qa=>{qa=qa.result;const aa=wa.toLowerCase();return qa.includes(aa)?(qa.splice(Array.indexOf(qa,aa),1),this.Bmg(qa)):ka.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}T_g(wa,qa){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return wa=new OSF.AddinIdInfo(wa),wa.needToRestoreManifest()?this.ymg(wa.getSolutionId(),qa):ka.Task.Ta(!0);wa=new w(wa);return wa.needToRestoreManifest?this.ymg(wa.solutionId,
qa):ka.Task.Ta(!0)}Lpj(wa){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const aa=new OSF.AddinIdInfo(wa);return aa.needToRestoreManifest()?X(this.uRf(aa.getSolutionId()),ia=>{(ia=ia.result)&&OSF.OsfManifestManager.cacheManifestFromXml(aa.getSolutionId(),aa.getSolutionVersion(),ia,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ka.Task.Ta(!0)}const qa=new w(wa);return qa.needToRestoreManifest?
X(this.uRf(qa.solutionId),aa=>{(aa=aa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(qa.solutionId,qa.solutionVersion,aa,this.$.va.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ka.Task.Ta(!0)}uUf(wa){return this.w_?this.indexedDB.U7b(wa):Oa.$hj(wa)}kSd(wa,qa){return this.w_?this.indexedDB.Tna(new Ba.a(wa,qa)):Oa.lSd(wa,qa)}vhd(wa){return this.w_?this.indexedDB.bka(wa):Oa.q4e(wa)}YKd(wa,qa,aa,ia,Ha,Z){const la=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,
qa,null)}.`;return t.TaskExtensions.uDc(X(this.ZKd(this.wj,wa,qa,aa,!1,ia,Z),()=>Ha?this.F5j(wa,aa):ka.Task.Ta(!0),la))}ZKd(wa,qa,aa,ia,Ha,Z,la){if(!Z&&(Z=ca.a.Dc(this.OF,ia.addinId))&&Z===ia.metadataContent)return ka.Task.Ta(!0);this.OF[ia.addinId]=ia.metadataContent;this.yV[qa]=ia;la||wa.IJb(qa);wa.cja();return I(this.vfj(qa,aa,ia),()=>this.CId(ia.addinId,Ha),"Failed to register functions for customfunction addin")}vfj(wa,qa,aa){const ia=new f.a,Ha=this.IHa(aa);return this.u4(Z=>{ra.EwaSettings.ma(254)&&
M(Oa.ktb,wa);(Z=Z.Result)&&204===Z.ResponseStatusCode?ia.setResult(!0):(delete this.OF[aa.addinId],delete this.yV[wa],x(this.JLd(wa),()=>{x(this.PLd(wa),()=>{this.v8f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${wa}. Received status code ${Z?Z.ResponseStatusCode.toString():"Unknown"}.`),ia.setResult(!1))},Z=>{Z=r.a.Oe(Z.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,
qa,null)}. Errors: ${V.a.sc(Z)}.`);ra.EwaSettings.ma(254)&&M(Oa.jtb,wa);delete this.OF[aa.addinId];delete this.yV[wa];ia.setResult(!1)},Ha,ia,!0)}j2b(wa,qa,aa){const ia=new f.a,Ha=Y.a.Qa.ue.m;qa.forEach(la=>{la=Object(h.a)(String,la);wa.jCe(la)});wa.cja();const Z=this.c0c(aa);return this.u4(la=>{ra.EwaSettings.ma(254)&&M(Oa.ktb,Sys.Serialization.JavaScriptSerializer.serialize(qa));la=la.Result;let Xa=!0;var Za=Sys.Serialization.JavaScriptSerializer.deserialize(la.ResponseBody.toString());Za=Array.isArray(Za.value)?
Za.value:null;const xa=new d.a;for(let fa=0;fa<Za.length;fa++)if(!Za[fa]){Xa=!1;const ua=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${la.ResponseStatusCode}.`;xa.add(I(this.JLd(qa[fa]),()=>{delete this.OF[aa.registrationInfos[fa].addinId];delete this.yV[qa[fa]];return this.PLd(qa[fa])},ua))}H(ka.Task.WhenAllEnumerable(xa),()=>{x(this.CId("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${Y.a.Qa.ue.m-
Ha} Millisecond.`);Xa?ia.setResult(Xa):H(this.v8f(),()=>{ia.setResult(Xa)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},la=>{la=r.a.Oe(la.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${V.a.sc(la)}.`);
ra.EwaSettings.ma(254)&&M(Oa.jtb,Sys.Serialization.JavaScriptSerializer.serialize(qa));for(la=0;la<aa.registrationInfos.length;la++)delete this.OF[aa.registrationInfos[la].addinId],delete this.yV[qa[la]];ia.setResult(!1)},Z,ia,!0)}A0d(wa,qa,aa,ia){return I(this.IXj(wa,qa,aa,ia),()=>this.CId(ia.solutionId,!1),"Failed to unregister functions for customfunction addin")}IXj(wa,qa,aa,ia){const Ha=new f.a;wa.IJb(qa);(wa=ca.a.Dc(this.yV,qa))&&delete this.OF[wa.addinId];delete this.yV[qa];ia=this.o0c(ia);
return this.u4(()=>{ra.EwaSettings.ma(254)&&M(Oa.p7c,qa);Ha.setResult(!0)},Z=>{Z=r.a.Oe(Z.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(qa,aa,null)}. Errors: ${V.a.sc(Z)}.`);ra.EwaSettings.ma(254)&&M(Oa.o7c,qa);Ha.setResult(!1)},ia,Ha,!1)}u4(wa,qa,aa,ia,Ha){const Z=this.$.userOperationManager,la=this.$.pa;let Xa=null,Za=null,xa=null;const fa=()=>{if(Z.Hta()||
0<la.ya.XU||0<la.Mk.XU)return!1;Xa&&Z.mo(Xa);Za&&la.Nr(Za);xa&&la.jx(xa);const ua=aa.request;let sa=0;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ua.RequestFlags&1&&256!==(ua.RequestFlags&256)||(sa=16):sa=ua.RequestFlags&1?0:16;Z.pD(new m.a(507,0,(sb,hb,bb)=>{ra.EwaSettings.ma(254)&&M(Ha?Oa.n7c:Oa.q7c,ua.RequestBody);return l.g(la.ya,"ExecuteRichApiRequest",aa,ea.b(sb,wa),ea.a(hb,qa),bb,null,0)},sa|64));return!0};fa()||(Xa=()=>{fa()},Za=()=>{fa()},xa=()=>
{fa()},Z.xr(Xa),la.Nq(Za),la.kw(xa));return ia.task}IHa(wa){const qa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};qa.RequestBody=JSON.stringify(wa);qa.RequestFlags=1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(qa.RequestFlags|=256);wa=this.$.pa.ya.Na(1);wa.request=qa;return wa}c0c(wa){const qa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};qa.RequestBody=JSON.stringify(wa);qa.RequestFlags=
1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(qa.RequestFlags|=256);wa=this.$.pa.ya.Na(1);wa.request=qa;return wa}o0c(wa){const qa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};qa.RequestBody=JSON.stringify(wa);qa.RequestFlags=1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(qa.RequestFlags|=256);wa=this.$.pa.ya.Na(1);wa.request=qa;return wa}CId(wa,qa){const aa=v.GetServiceTaskFactory.create(this.$.da,
153,this.$.la,1);return L(aa,()=>{aa.result.VNd();return wa&&qa?this.Lpj(wa):ka.Task.Ta(!0)},this.$.la,z.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}v8f(){const wa=new va.a(1949669462,0,this.$.Hc,0,null);return this.$.Ka.Lb(wa)}static q4e(wa){try{return ka.Task.Ta(localStorage.getItem(wa))}catch(qa){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${qa.message||
"Unknown"}`),ka.Task.Ta(null)}}static lSd(wa,qa){try{return localStorage.setItem(wa,qa),ka.Task.Ta(!0)}catch(aa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${aa.message||"Unknown"}`),ka.Task.Ta(!1)}}static $hj(wa){try{return localStorage.removeItem(wa),ka.Task.Ta(!0)}catch(qa){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${qa.message||
"Unknown"}`),ka.Task.Ta(!1)}}static MFh(wa){return N.a.equals(wa,"registry",!0)||N.a.equals(wa,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static $td(wa){if(!wa)return!1;try{JSON.parse(wa)}catch(qa){return!1}return!0}}Oa.wzb="CustomFunctionCache";Oa.xzb="CustomFunction";Oa.n7c=new Ka(2,"CustomFunctions [Registration] [Begin] SolutionId=");Oa.ktb=new Ka(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Oa.jtb=new Ka(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Oa.q7c=new Ka(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Oa.p7c=new Ka(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Oa.o7c=new Ka(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(Oa,"CustomFunctionsInstaller",null,[708])},1195:function(u,D,a){a.r(D);u=a(0);var c=a(7),b=a(15),e=a(933),f=a(157),d=a(82),h=a(188),m=a(60),l=a(50),v=a(37),t=a(116),z=a(527),r=a(960);class n{constructor(S){S=S.split("|");this.Ax=S[1];this.DTc=S[2];this.LXd=
S[3]}get solutionId(){return this.Ax}get solutionVersion(){return this.DTc}get needToRestoreManifest(){return this.LXd===OSF.StoreTypeEnum.Registry.toString()}}Object(u.a)(n,"AddinStoreInfo",null,[]);class w{}Object(u.a)(w,"CustomFunctionRegistrationInfos",null,[]);const B=(S,W)=>{if(a(1195).CustomFunctionsLegacyInstaller.gxb("CustomFunctionsRuntimeLogging")&&window.console)switch(W=A(S.severity)+" "+S.message+W,S.severity){case 2:window.console.log&&window.console.log(W);break;case 0:window.console.info&&
window.console.info(W);break;case 1:window.console.error&&window.console.error(W)}},A=S=>{switch(S){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class y{}Object(u.a)(y,"InstallationInfo",null,[]);class x{}Object(u.a)(x,"UninstallationInfo",null,[]);var F=a(153),I=a(35),L=a(29),X=a(1),P=a(13),G=a(281),C=a(863),H=a(55);class J{constructor(S,W){this.$Sc=S;this._message=W}get severity(){return this.$Sc}get message(){return this._message}}Object(u.a)(J,"CustomFunctionLog",
null,[]);a.d(D,"CustomFunctionsLegacyInstaller",function(){return M});class M{constructor(S){this.OF={};this.$=S;this.Dod().Sna()}tff(S,W,O,T){const Y=new f.a;if(T.invariantNamespace)for(W=0;W<T.invariantNamespace.length;++W){const ca=T.invariantNamespace.charAt(W);if("."!==ca&&"_"!==ca&&"a">ca&&"z"<ca&&"A">ca&&"Z"<ca&&"0">ca&&"9"<ca)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${ca}', Position=${W}.`),Y.setResult(!1),
Y.task}M.cacheManifest(O,T.manifest);let va=M.WJd(S);(null===va||void 0===va?0:va.isDynamicMetadata)?this.XKd(S,va,Y,!1,!1):OSF.OUtil.xhrGet(T.metadataUrl,ca=>{va=Object(c.a)(new y,{addinId:O,locale:T.locale,addinInvariantNamespace:T.invariantNamespace,addinNamespace:T.namespace,addinTitle:T.title,isXllCompatible:T.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(ca))});this.XKd(S,va,Y,!1,r.a(this.$,T))},ca=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${S}. ErrorCode: ${ca}.`);
Y.setResult(!1)});return Y.task}vff(S,W,O,T){W=new f.a;if(!M.$td(O))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),W.setResult(!1),W.task;const Y=M.WJd(S);if(!Y)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),W.setResult(!1),W.task;Y.metadataContent=JSON.stringify(JSON.parse(O));Y.isDynamicMetadata=
!0;this.XKd(S,Y,W,!0,T);return W.task}Hgg(S){const W=new f.a,O=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.Aa(O,()=>{const T=O.result;T.cja();const Y=Object(c.a)(new x,{solutionId:S});M.KLd(S);M.QLd(S);v.TaskExtensions.Aa(this.A0d(T,S,Y),va=>{F.b(va)?W.setResult(va.result):(va.Wf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${S}.`):va.Ch&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${S}.`),
W.setResult(!1))},this.$.la,0)},this.$.la,3);return W.task}Dod(){const S=new f.a,W=M.bKd();0<W.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const O=[];W.forEach(Y=>{Y=Object(d.a)(String,Y);if(Y=M.WJd(Y)){const va=I.a.Dc(this.OF,Y.addinId);va&&va===Y.metadataContent||(this.OF[Y.addinId]=Y.metadataContent,O.push(Y))}});if(!O.length)return S.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
S.task;const T=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.Aa(T,()=>{const Y=T.result,va=Object(c.a)(new w,{registrationInfos:O});v.TaskExtensions.Aa(this.j2b(Y,W,va),ca=>{F.b(ca)?S.setResult(ca.result):(ca.Wf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ca.Ch&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
S.setResult(!1))},this.$.la,0)},this.$.la,3);return S.task}Kpj(S){S=new n(S);if(S.needToRestoreManifest){const W=M.$cj(S.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(S.solutionId,S.solutionVersion,W,this.$.va.UICultureTag)}}XKd(S,W,O,T,Y){const va=l.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);v.TaskExtensions.Aa(va,()=>{v.TaskExtensions.Aa(this.ZKd(va.result,S,W,!1,T,Y),ca=>{F.b(ca)?((ca=ca.result)&&M.G5j(S,W),O.setResult(ca)):(ca.Wf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${S}.`):
ca.Ch&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${S}.`),O.setResult(!1))},this.$.la,0)},this.$.la,3)}ZKd(S,W,O,T,Y,va){if(!Y&&(Y=I.a.Dc(this.OF,O.addinId))&&Y===O.metadataContent)return H.Task.Ta(!0);this.OF[O.addinId]=O.metadataContent;const ca=new f.a;va||S.IJb(W);S.cja();S=this.IHa(O);return this.u4(V=>{X.EwaSettings.ma(254)&&B(M.ktb,W);const ra=V.Result;204===ra.ResponseStatusCode?v.TaskExtensions.Aa(this.BId(ca,
O.addinId,T),N=>{N.Wf?W?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${W}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${O.addinId}.`):N.Ch&&(W?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${W}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${O.addinId}.`));ca.setResult(!1)},this.$.la,4):(V=()=>{delete this.OF[O.addinId];M.KLd(W);M.QLd(W);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${W}. Received status code ${ra.ResponseStatusCode}.`);ca.setResult(!1)},V=Object(c.a)(new C.a,{LMa:OSF.InfoType.Error,title:O.addinTitle,
description:String.format(P.a.instance.nb(153),P.a.instance.ga(1881)),buttonText:P.a.instance.ga(4),Rha:V,Nfc:!1,Ria:V,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.WUd(V))},V=>{V=t.a.Oe(V.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${W}. Errors: ${L.a.sc(V)}.`);X.EwaSettings.ma(254)&&B(M.jtb,W);delete this.OF[O.addinId];ca.setResult(!1)},S,ca,!0)}j2b(S,W,O){const T=
new f.a;W.forEach(va=>{va=Object(d.a)(String,va);S.jCe(va)});S.cja();const Y=this.c0c(O);return this.u4(va=>{X.EwaSettings.ma(254)&&B(M.ktb,Sys.Serialization.JavaScriptSerializer.serialize(W));va=va.Result;let ca=!0;var V=Sys.Serialization.JavaScriptSerializer.deserialize(va.ResponseBody.toString());V=Array.isArray(V.value)?V.value:null;for(let ra=0;ra<V.length;ra++)V[ra]||(ca=!1,delete this.OF[O.registrationInfos[ra].addinId],M.KLd(W[ra]),M.QLd(W[ra]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${W[ra]}. Received status code ${va.ResponseStatusCode}.`));
v.TaskExtensions.Aa(this.BId(T,"",!1),ra=>{ra.Wf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ra.Ch&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");T.setResult(!1)},this.$.la,4);T.setResult(ca)},va=>{va=t.a.Oe(va.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(W)}. Errors: ${L.a.sc(va)}.`);
X.EwaSettings.ma(254)&&B(M.jtb,Sys.Serialization.JavaScriptSerializer.serialize(W));for(const ca of O.registrationInfos)delete this.OF[ca.addinId];T.setResult(!1)},Y,T,!0)}A0d(S,W,O){const T=new f.a;S.IJb(W);S=this.o0c(O);return this.u4(()=>{X.EwaSettings.ma(254)&&B(M.p7c,W);v.TaskExtensions.Aa(this.BId(T,O.solutionId,!1),Y=>{Y.Wf?W&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${W}.`):Y.Ch&&
W&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${W}.`);T.setResult(!1)},this.$.la,4)},Y=>{Y=t.a.Oe(Y.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${W}. Errors: ${L.a.sc(Y)}.`);X.EwaSettings.ma(254)&&B(M.o7c,W);T.setResult(!1)},S,T,!1)}u4(S,W,O,T,Y){const va=this.$.userOperationManager,
ca=this.$.pa;let V=null,ra=null,N=null;const ea=()=>{if(va.Hta()||0<ca.ya.XU||0<ca.Mk.XU)return!1;V&&va.mo(V);ra&&ca.Nr(ra);N&&ca.jx(N);const Ba=O.request;va.pD(new h.a(507,0,(ka,Ka,Oa)=>{X.EwaSettings.ma(254)&&B(Y?M.n7c:M.q7c,Ba.RequestBody);return m.g(ca.ya,"ExecuteRichApiRequest",O,G.b(ka,S),G.a(Ka,W),Oa,null,0)},(Ba.RequestFlags&1?0:16)|64));return!0};ea()||(V=()=>{ea()},ra=()=>{ea()},N=()=>{ea()},va.xr(V),ca.Nq(ra),ca.kw(N));return T.task}IHa(S){const W={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};W.RequestBody=JSON.stringify(S);W.RequestFlags=1;S=this.$.pa.ya.Na(1);S.request=W;return S}c0c(S){const W={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};W.RequestBody=JSON.stringify(S);W.RequestFlags=1;S=this.$.pa.ya.Na(1);S.request=W;return S}o0c(S){const W={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};W.RequestBody=JSON.stringify(S);W.RequestFlags=1;S=this.$.pa.ya.Na(1);S.request=W;return S}BId(S,W,O){const T=
l.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);v.TaskExtensions.Aa(T,()=>{T.result.VNd();W&&O&&this.Kpj(W);S.setResult(!0)},this.$.la,3);return T}wff(){return H.Task.Ta(!0)}static bKd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(M.gxb(z.a.XZa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(M.gxb(z.a.XZa)||"[]"):null)||[]}static Cmg(S){M.mSd(z.a.XZa,Sys.Serialization.JavaScriptSerializer.serialize(S))}static WJd(S){S=M.gxb(z.a.l5a(S))||"";return 0<
S.length?Sys.Serialization.JavaScriptSerializer.deserialize(S,!0):null}static G5j(S,W){M.lQe(S);M.mSd(z.a.l5a(S),Sys.Serialization.JavaScriptSerializer.serialize(W))}static KLd(S){M.bUf(S);M.vUf(z.a.l5a(S))}static $cj(S){return M.gxb(z.a.k5a(S))}static H5j(S,W){M.lQe(S);M.mSd(z.a.k5a(S),W)}static QLd(S){M.bUf(S);M.vUf(z.a.k5a(S))}static lQe(S){const W=M.bKd();S=S.toLowerCase();W.includes(S)||(W.push(S),M.Cmg(W))}static bUf(S){const W=M.bKd();S=S.toLowerCase();W.includes(S)&&(W.splice(Array.indexOf(W,
S),1),M.Cmg(W))}static cacheManifest(S,W){S=new n(S);S.needToRestoreManifest&&M.H5j(S.solutionId,W)}static gxb(S){try{return localStorage.getItem(S)}catch(W){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${W.message||"Unknown"}`),null}}static mSd(S,W){try{localStorage.setItem(S,W)}catch(O){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${O.message||
"Unknown"}`)}}static vUf(S){try{localStorage.removeItem(S)}catch(W){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${W.message||"Unknown"}`)}}static $td(S){if(!S)return!1;try{JSON.parse(S)}catch(W){return!1}return!0}}M.n7c=new J(2,"CustomFunctions [Registration] [Begin] SolutionId=");M.ktb=new J(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");M.jtb=new J(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
M.q7c=new J(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");M.p7c=new J(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");M.o7c=new J(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(M,"CustomFunctionsLegacyInstaller",null,[708])},1234:function(u,D,a){u=a(0);var c=a(196),b=a(15);class e{}Object(u.a)(e,"AddinCommandsHost",null,[]);var f=a(1317),d=a(1395),h=a(861),m=a(60);const l=(I,L,X,P,G,C)=>{const H=I.Na(9);H.sharedInfo=L;return m.g(I,"InsertAgaveTaskpane",
H,X,P,G,C,0)},v=(I,L,X,P,G,C,H=null)=>{H=I.Na(9,H);H.sharedInfo=L;return m.g(I,"ShowAgaveTaskpane",H,X,P,G,C,0)};var t=a(371),z=a(188),r=a(37),n=a(1),w=a(281),B=a(146);class A extends B.a{constructor(I){super();this.Ee=this.ZDa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=695;this.dialogHeight=438;this.A9g="100%";this.x9g="408px";this.y9g="15px";this.z9g="0";this.eBg=I}get containerDiv(){return this.Vk}Zz(){super.Zz();this.Vk.style.width=this.A9g;this.Vk.style.height=this.x9g;this.Vk.style.marginTop=
this.y9g;this.Vk.style.padding=this.z9g}YI(){super.YI();this.wb.style.width=String.format("{0}px",this.dialogWidth);this.wb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.eBg()}}Object(u.a)(A,"AddInCommandsDialog",B.a,[]);var y=a(55),x=a(66);B=a(98);a.d(D,"a",function(){return F});class F extends e{constructor(I,L,X,P=null,G=null){super();this.$=I;this.ie=L;this.ownerAddinInfo=X;this.Wd=G;this.mdb=P||y.Task.Ta(!0)}u9g(){const I=this.mdb;this.mdb=y.Task.Ta(!0);
return I}disposeHost(I){this.ie.uRa(I)}setOwnerAddinEToken(I){this.ownerAddinInfo.eToken=I}showTaskpane(I,L,X){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let P=null,G=!1,C=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,!0)).CKe(I.solutionId.substr(this.ownerAddinInfo.solutionId.length));P=L.getSharedRuntimeForTaskpane("Workbook",C);G=!!P&&1===P.LifeTime;this.ie.mCe(G?this.ownerAddinInfo.solutionId:I.solutionId,G?P:null,null)||(this.Zrf(G,!0),this.mdb=
this.Bod(I,P,(H,J)=>{H?(G&&(H.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,H.SharedRuntime=P),H.WebExtensionOsfControlType=3,this.ie.SIa(H),X(H.InstanceId,J),this.Zrf(G,!1),n.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),X(null,J))}))}getSettings(I,L){let X=this.ie.Taa(I.solutionId);
X?L(this.ie.IZ(X).OsfPropertyBag):this.mdb=this.Bod(I,null,P=>{P?L(P.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(I,L,X){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const P=this.$.pa.ya,G=H=>{const J=H.Result,M=J?J.AgaveData:null;M?(this.ie.wJe(M,()=>{const S=new A(()=>{this.disposeHost(M.InstanceId)});S.initializeAndShow("",null,null);return S.containerDiv}),X(M.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
X(null,H.Errors?H.Errors[0].ErrorCause:5001))},C=F.Qsb(I,this.ownerAddinInfo);this.mdb=t.a(this.$.userOperationManager,(H,J,M)=>l(P,C,w.b(H,G),J,M,null),H=>new z.a(500,0,H,64),this.Wd)}createUILessSandbox(I,L,X){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const P=L.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),G=!!P&&1===P.LifeTime;(L=this.ie.pIh(G?this.ownerAddinInfo.solutionId:I.solutionId,G?P:null))?X(L,0):this.mdb=this.Bod(I,P,(C,H)=>{C?(G?(C.PrimaryMarketplace.SolutionId=
this.ownerAddinInfo.solutionId,C.SharedRuntime=P,C.TaskpaneVisible=!1,C.WebExtensionOsfControlType=3,this.ie.SIa(C)):(C.WebExtensionOsfControlType=4,this.ie.wJe(C,()=>{F.ogb.ia(C.InstanceId,new d.a);return F.ogb.oa(C.InstanceId).Pia})),X(C.InstanceId,H)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),X(null,H))})}Bod(I,L,X){let P=null;const G=this.$.pa.ya,C=W=>{const O=W.Result;(P=O?O.AgaveData:null)||X(null,W.Errors?W.Errors[0].ErrorCause:5001)},H=F.Qsb(I,this.ownerAddinInfo);
L&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),H.SharedRuntimeId=L.Resid);let J=500;var M=(W,O,T)=>l(G,H,w.b(W,C),O,T,null);let S=0;void 0===H.IsToBePersisted||null===H.IsToBePersisted||H.IsToBePersisted||(J=538,M=(W,O,T)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,
null,null,this.ownerAddinInfo.storeId));return v(G,H,w.b(W,C),O,T,null)},S=16);S|=64;M=t.a(this.$.userOperationManager,M,W=>new z.a(J,0,W,S),this.Wd);return r.TaskExtensions.ts(M,()=>P?this.qwd(G,P.InstanceId,(W,O)=>{if(W){L||(P.PrimaryMarketplace.MarketplaceType=I.storeType);n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(I.assetId?I.assetId.toLowerCase().startsWith("wa")?P.AssetMarketplace={SolutionId:I.assetId,SolutionVersion:I.version,MarketplaceType:OSF.StoreType.OMEX,
MarketplaceRef:I.assetStoreId}:(P.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,50,"WACExcelAddinCommandsHost: AssetId is not a valid value")):P.AssetMarketplace=null);P.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;P.OwnerAddinStoreType=this.ownerAddinInfo.storeType;P.OsfPropertyBag=[];for(O=0;O<W.Settings.length;O++){const T=[];T[0]=W.Settings[O].Name;T[1]=W.Settings[O].Value;P.OsfPropertyBag[O]=T}X(P,0)}else X(null,O.Errors?O.Errors[0].ErrorCause:5001)}):y.Task.Ta(!1),c.a.none,3,
x.a.current)}qwd(I,L,X){const P=G=>{X(G.Result,G)};return t.a(this.$.userOperationManager,(G,C,H)=>{G=w.b(G,P);const J=I.Na(1);J.controlId=L;return m.g(I,"DdaLoadSettings",J,G,C,H,null,0)},G=>new z.a(501,0,G,80),this.Wd)}Zrf(I,L){var X;I&&(null===(X=window.performance)||void 0===X?0:X.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${L}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(I){F.ogb.lb(I)&&
F.ogb.oa(I).initializeAndShowWithTitle()}static hideUILessDialog(I){F.ogb.lb(I)&&F.ogb.oa(I).hide()}static Qsb(I,L){const X={};X.SolutionId=I.solutionId;X.Version=I.version;X.StoreType=L.storeType;X.StoreId=I.storeId;X.AssetId=I.solutionId;X.AssetStoreId="omex";X.TargetType=1;X.Width=350;X.OwnerAddinSolutionId=L.solutionId;X.OwnerAddinStoreType=L.storeType;X.SharedRuntimeId=null;X.Preload=!1;return X}}F.ogb=new B.a;Object(u.a)(F,"WACExcelAddinCommandsHost",e,[])},1240:function(u,D,a){var c=a(9);u=
a(0);var b=a(692),e=a(15),f=a(102),d=a(4),h=a(1308),m=a(1),l=a(183),v=a(55);class t{constructor(B,A,y){this.ntb=null;this.$=B;A?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.ntb=new h.a(B,A,y)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}nc(){return!1}executeCommand(B,A,y){B=!1;switch(A.command){case 73979048:this.ntb&&
this.ntb.d8i(A,f.a.instance,d.AFrameworkApplication.fa,y),B=!0}return B?v.Task.Ta(!0):l.a(A.command)}wc(B,A){return 73979048===A.command&&m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Jc(){return!1}dispose(){this.ntb&&this.ntb.dispose()}}Object(u.a)(t,"DataFromPictureCommandHandler",null,[165,2]);var z=a(37),r=a(50);class n extends b.a{constructor(B){super(B)}nd(){const B=r.GetServiceTaskFactory.Oa(this.$.da,328,327,1),A=r.GetServiceTaskFactory.Oa(this.$.da,
484,485,1);z.TaskExtensions.Aa(z.TaskExtensions.Fd([B,A],this.$.la),()=>{this.Yc([new t(this.$,B.result,A.result)])},this.$.la,3)}static ka(B){b.a.Nd(452,new n(B))}}Object(u.a)(n,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return w});const w=()=>{c.a.Fa(B=>{n.ka(B)})}},1300:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static KPh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(u.a)(c,"WopiAuthContext",null,[391])},1301:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.VJf="OneDriveWOPI";Object(u.a)(c,"HostApplicationType",null,[])},1308:function(u,D,a){(function(c){a.d(D,"a",function(){return F});var b=a(0),e=a(15),f=a(170),d=a(82),
h=a(1314),m=a(38),l=a(249),v=a(42),t=a(371),z=a(188),r=a(60),n=a(91),w=a(13),B=a(21),A=a(41),y=a(1315),x=a(1);class F extends m.a{constructor(I,L,X){super();this.ond=h.a.getTypeName();this.kzb=this.nU=this.Wd=null;this.imageHeight=this.imageWidth=0;this.IMa=this.errorMessage=this.tableData=null;this.Omd=0;this.EVc=!1;this.Uya=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6646472_DataFromPictureMigratingToNewALAPI");this.JKe=P=>{if(P){var G={};if(({At:G}=A.d(this.Zjh(P.data))).returnValue&&(P=Object(d.a)(Object,
G),"."===P.DataFromPictureWildcard))if(P.SessionId!==this.IMa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),P.CmdType){case "ACK":this.EVc=!0;this.Pcg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
this.ivj();0<this.errorMessage.length?this.L1f():0<this.tableData.length&&this.c2f();break;case "insert_html":const H=this.$.pa.ya;G={};var C=B.h(this.$).ha.ra.$c.clone();G.PasteId=f.a.create().toString();G.DestinationRanges=v.s(v.v(C,this.$));C=P.Parameters.split("|",3);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${C[0]}|${C[1]}|${C[2]}.`);
C=P.Parameters.indexOf("|");C=P.Parameters.indexOf("|",C+1);C=P.Parameters.indexOf("|",C+1);G.SourceHtml=P.Parameters.substring(C+1);G.CopyOperationId=null;const J=H.Na(1,H.Wb());J.pasteHtmlParameters=G;t.a(this.$.userOperationManager,(M,S,W)=>r.g(H,"pasteHtmlContent",J,M,S,W,null,64),M=>new z.a(204,0,M,1),null);this.Omd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Omd.toString()}`)}}};this.Edf=
(P,G)=>{if(P=G.EM)if(!G.parentPath||1>=G.parentPath.length||G.parentPath[1]!==this.IMa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=P.errorCode;switch(G){case null:case -1:this.errorMessage=w.a.instance.ga(2263);break;case 1:this.errorMessage=w.a.instance.ga(2264);
break;case 2:this.errorMessage=w.a.instance.ga(2265)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${G?G.toString():"null"}.`);this.gue.stop();this.tableData=P.html;this.EVc&&(0<this.errorMessage.length?this.L1f():0<this.tableData.length&&this.c2f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.augmentationLoopManager=
L;this.uploaderCreator=X;this.initialize()}dispose(){window.removeEventListener("message",this.JKe,!1);this.Uya&&this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}E_i(I,L){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let X=new Image;X.onload=()=>{var P=document.createElement("canvas");P.width=X.width;P.height=X.height;const G=P.getContext("2d");try{G.drawImage(X,0,0,X.width,X.height)}catch(J){e.ULS.sendTraceTag(523805145,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${J.message}`);return}let C;try{C=P.toDataURL("image/jpeg")}catch(J){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${J.message}`);return}P=C.split(",");if(2>P.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{P=P[1];try{var H=window.self.atob(P)}catch(J){e.ULS.sendTraceTag(523805142,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${J.message}`);return}28E5<H.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.oIj()):(this.zrj(this.Wd,this.nU,P,X.width,X.height),URL.revokeObjectURL(X.src),X=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};X.src=I}d8i(I,L,X,P){this.Wd=I;this.nU=P;this.uploaderCreator.vhi(this.$,
L,X,P,this)}zrj(I,L,X,P,G){this.IMa=f.a.create().toString();this.Omd=0;this.kzb=X;this.imageWidth=P;this.imageHeight=G;this.errorMessage=this.tableData="";this.EVc=!1;this.Pcg=this.$.Jb.Ng("LoadResource","DataFromPictureTaskpaneLaunch");this.Pcg.start();this.u2i(I,L);this.gue=this.$.Jb.Ng("LoadResource","DataFromPictureAnnotation");this.gue.start();this.S1j()}S1j(){if(this.kzb.length){var I=window.self.atob(this.kzb);var L=new Uint8Array(I.length);for(let X=0;X<I.length;X++)L[X]=I.charCodeAt(X);this.augmentationLoopManager.R1j(L,
this.IMa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}u2i(I,L){L.SessionID=this.IMa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;I=new n.a(-859308420,I.method,I.mode,I.$e,I.tabName);this.$.Ka.Lb(I,L)}k$c(I){try{const L=c.from(I,"utf16le").toString("base64");return y.a.IIa(this.IMa,L)}catch(L){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),
""}}Zjh(I){try{const L=y.a.IIa(this.IMa,I);return c.from(L,"base64").toString("utf16le")}catch(L){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}ivj(){if(this.kzb.length){var I=l.a(this.$).Taa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.k$c(this.kzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,X=>{X&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,
0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}c2f(){if(this.tableData.length){var I=l.a(this.$).Taa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.k$c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,X=>{X&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,
0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}L1f(){if(this.errorMessage.length){var I=l.a(this.$).Taa("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.k$c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,X=>{X&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,
0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.JKe,!1);this.Uya?this.augmentationLoopManager.register(this.augmentationLoopManager.Rbc().nyc("DataFromPicture").ayc(()=>{}).activateAnnotation({annotationType:this.ond,y_:!1,pPa:this.Edf}).build()):(this.augmentationLoopManager.activateAnnotation(this.ond),this.augmentationLoopManager.AY(this.ond,this.Edf))}}Object(b.a)(F,
"DataFromPictureManager",m.a,[560])}).call(this,a(1309).tng)},1309:function(u,D,a){(function(c){function b(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,bjk:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(C){return!1}}function e(G,C){if((f.nP?2147483647:1073741823)<C)throw new RangeError("Invalid typed array length");f.nP?(G=new Uint8Array(C),G.__proto__=f.prototype):(null===G&&(G=new f(C)),G.length=C);return G}function f(G,
C,H){if(!(f.nP||this instanceof f))return new f(G,C,H);if("number"===typeof G){if("string"===typeof C)throw Error("If encoding is specified then the first argument must be a string");return m(this,G)}return d(this,G,C,H)}function d(G,C,H,J){if("number"===typeof C)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&C instanceof ArrayBuffer){C.byteLength;if(0>H||C.byteLength<H)throw new RangeError("'offset' is out of bounds");if(C.byteLength<H+(J||0))throw new RangeError("'length' is out of bounds");
C=void 0===H&&void 0===J?new Uint8Array(C):void 0===J?new Uint8Array(C,H):new Uint8Array(C,H,J);f.nP?(G=C,G.__proto__=f.prototype):G=l(G,C);C=G}else if("string"===typeof C){J=G;G=H;if("string"!==typeof G||""===G)G="utf8";if(!f.aif(G))throw new TypeError('"encoding" must be a valid string encoding');H=z(C,G)|0;J=e(J,H);C=J.write(C,G);C!==H&&(J=J.slice(0,C));C=J}else C=v(G,C);return C}function h(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');if(0>G)throw new RangeError('"size" argument must not be negative');
}function m(G,C){h(C);G=e(G,0>C?0:t(C)|0);if(!f.nP)for(var H=0;H<C;++H)G[H]=0;return G}function l(G,C){var H=0>C.length?0:t(C.length)|0;G=e(G,H);for(var J=0;J<H;J+=1)G[J]=C[J]&255;return G}function v(G,C){if(f.isBuffer(C)){var H=t(C.length)|0;G=e(G,H);if(0===G.length)return G;C.copy(G,0,0,H);return G}if(C){if("undefined"!==typeof ArrayBuffer&&C.buffer instanceof ArrayBuffer||"length"in C)return(H="number"!==typeof C.length)||(H=C.length,H=H!==H),H?e(G,0):l(G,C);if("Buffer"===C.type&&L(C.data))return l(G,
C.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function t(G){if(G>=(f.nP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.nP?2147483647:1073741823).toString(16)+" bytes");return G|0}function z(G,C){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||G instanceof ArrayBuffer))return G.byteLength;
"string"!==typeof G&&(G=""+G);var H=G.length;if(0===H)return 0;for(var J=!1;;)switch(C){case "ascii":case "latin1":case "binary":return H;case "utf8":case "utf-8":case void 0:return A(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*H;case "hex":return H>>>1;case "base64":return x(G).length;default:if(J)return A(G).length;C=(""+C).toLowerCase();J=!0}}function r(G,C,H){var J=!1;if(void 0===C||0>C)C=0;if(C>this.length)return"";if(void 0===H||H>this.length)H=this.length;if(0>=
H)return"";H>>>=0;C>>>=0;if(H<=C)return"";for(G||(G="utf8");;)switch(G){case "hex":G=C;C=H;H=this.length;if(!G||0>G)G=0;if(!C||0>C||C>H)C=H;J="";for(H=G;H<C;++H)G=J,J=this[H],J=16>J?"0"+J.toString(16):J.toString(16),J=G+J;return J;case "utf8":case "utf-8":return B(this,C,H);case "ascii":G="";for(H=Math.min(this.length,H);C<H;++C)G+=String.fromCharCode(this[C]&127);return G;case "latin1":case "binary":G="";for(H=Math.min(this.length,H);C<H;++C)G+=String.fromCharCode(this[C]);return G;case "base64":return 0===
C&&H===this.length?I.KZe(this):I.KZe(this.slice(C,H));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":C=this.slice(C,H);H="";for(G=0;G<C.length;G+=2)H+=String.fromCharCode(C[G]+256*C[G+1]);return H;default:if(J)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase();J=!0}}function n(G,C,H,J,M){if(0===G.length)return-1;"string"===typeof H?(J=H,H=0):2147483647<H?H=2147483647:-2147483648>H&&(H=-2147483648);H=+H;isNaN(H)&&(H=M?0:G.length-1);0>H&&(H=G.length+H);if(H>=G.length){if(M)return-1;
H=G.length-1}else if(0>H)if(M)H=0;else return-1;"string"===typeof C&&(C=f.from(C,J));if(f.isBuffer(C))return 0===C.length?-1:w(G,C,H,J,M);if("number"===typeof C)return C&=255,f.nP&&"function"===typeof Uint8Array.prototype.indexOf?M?Uint8Array.prototype.indexOf.call(G,C,H):Uint8Array.prototype.lastIndexOf.call(G,C,H):w(G,[C],H,J,M);throw new TypeError("val must be string, number or Buffer");}function w(G,C,H,J,M){function S(Y,va){return 1===W?Y[va]:Y.idj(va*W)}var W=1,O=G.length,T=C.length;if(void 0!==
J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>G.length||2>C.length)return-1;W=2;O/=2;T/=2;H/=2}if(M)for(J=-1;H<O;H++)if(S(G,H)===S(C,-1===J?0:H-J)){if(-1===J&&(J=H),H-J+1===T)return J*W}else-1!==J&&(H-=H-J),J=-1;else for(H+T>O&&(H=O-T);0<=H;H--){O=!0;for(J=0;J<T;J++)if(S(G,H+J)!==S(C,J)){O=!1;break}if(O)return H}return-1}function B(G,C,H){H=Math.min(G.length,H);for(var J=[];C<H;){var M=G[C],S=null,W=239<M?4:223<M?3:191<M?2:1;if(C+W<=H)switch(W){case 1:128>
M&&(S=M);break;case 2:var O=G[C+1];128===(O&192)&&(M=(M&31)<<6|O&63,127<M&&(S=M));break;case 3:O=G[C+1];var T=G[C+2];128===(O&192)&&128===(T&192)&&(M=(M&15)<<12|(O&63)<<6|T&63,2047<M&&(55296>M||57343<M)&&(S=M));break;case 4:O=G[C+1];T=G[C+2];var Y=G[C+3];128===(O&192)&&128===(T&192)&&128===(Y&192)&&(M=(M&15)<<18|(O&63)<<12|(T&63)<<6|Y&63,65535<M&&1114112>M&&(S=M))}null===S?(S=65533,W=1):65535<S&&(S-=65536,J.push(S>>>10&1023|55296),S=56320|S&1023);J.push(S);C+=W}G=J.length;if(G<=X)J=String.fromCharCode.apply(String,
J);else{H="";for(C=0;C<G;)H+=String.fromCharCode.apply(String,J.slice(C,C+=X));J=H}return J}function A(G,C){C=C||Infinity;for(var H,J=G.length,M=null,S=[],W=0;W<J;++W){H=G.charCodeAt(W);if(55295<H&&57344>H){if(!M){if(56319<H){-1<(C-=3)&&S.push(239,191,189);continue}else if(W+1===J){-1<(C-=3)&&S.push(239,191,189);continue}M=H;continue}if(56320>H){-1<(C-=3)&&S.push(239,191,189);M=H;continue}H=(M-55296<<10|H-56320)+65536}else M&&-1<(C-=3)&&S.push(239,191,189);M=null;if(128>H){if(0>--C)break;S.push(H)}else if(2048>
H){if(0>(C-=2))break;S.push(H>>6|192,H&63|128)}else if(65536>H){if(0>(C-=3))break;S.push(H>>12|224,H>>6&63|128,H&63|128)}else if(1114112>H){if(0>(C-=4))break;S.push(H>>18|240,H>>12&63|128,H>>6&63|128,H&63|128)}else throw Error("Invalid code point");}return S}function y(G){for(var C=[],H=0;H<G.length;++H)C.push(G.charCodeAt(H)&255);return C}function x(G){var C=I,H=C.GSj;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>G.length)G="";else for(;0!==G.length%4;)G+="=";return H.call(C,
G)}function F(G,C,H,J){for(var M=0;M<J&&!(M+H>=C.length||M>=G.length);++M)C[M+H]=G[M];return M}var I=a(1311);a(1312);var L=a(1313);D.tng=f;D.wgk=function(G){+G!=G&&(G=0);return f.xte(+G)};D.hbk=50;f.nP=void 0!==c.nP?c.nP:b();D.ujk=f.nP?2147483647:1073741823;f.from=function(G,C,H){return d(null,G,C,H)};f.nP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));
f.xte=function(G){h(G);return e(null,G)};f.NQg=function(G){return m(null,G)};f.isBuffer=function(G){return!(null==G||!G.Oyg)};f.compare=function(G,C){if(!f.isBuffer(G)||!f.isBuffer(C))throw new TypeError("Arguments must be Buffers");if(G===C)return 0;for(var H=G.length,J=C.length,M=0,S=Math.min(H,J);M<S;++M)if(G[M]!==C[M]){H=G[M];J=C[M];break}return H<J?-1:J<H?1:0};f.aif=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};f.concat=function(G,C){if(!L(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.xte(0);var H;if(void 0===C)for(H=C=0;H<G.length;++H)C+=G[H].length;C=f.NQg(C);var J=0;for(H=0;H<G.length;++H){var M=G[H];if(!f.isBuffer(M))throw new TypeError('"list" argument must be an Array of Buffers');M.copy(C,J);J+=M.length}return C};f.byteLength=z;f.prototype.Oyg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?
B(this,0,G):r.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,G)};f.prototype.compare=function(G,C,H,J,M){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===C&&(C=0);void 0===H&&(H=G?G.length:0);void 0===J&&(J=0);void 0===M&&(M=this.length);if(0>C||H>G.length||0>J||M>this.length)throw new RangeError("out of range index");if(J>=M&&C>=H)return 0;if(J>=M)return-1;if(C>=
H)return 1;C>>>=0;H>>>=0;J>>>=0;M>>>=0;if(this===G)return 0;var S=M-J,W=H-C,O=Math.min(S,W);J=this.slice(J,M);G=G.slice(C,H);for(C=0;C<O;++C)if(J[C]!==G[C]){S=J[C];W=G[C];break}return S<W?-1:W<S?1:0};f.prototype.includes=function(G,C,H){return-1!==this.indexOf(G,C,H)};f.prototype.indexOf=function(G,C,H){return n(this,G,C,H,!0)};f.prototype.lastIndexOf=function(G,C,H){return n(this,G,C,H,!1)};f.prototype.write=function(G,C,H,J){if(void 0===C)J="utf8",H=this.length,C=0;else if(void 0===H&&"string"===
typeof C)J=C,H=this.length,C=0;else if(isFinite(C))C|=0,isFinite(H)?(H|=0,void 0===J&&(J="utf8")):(J=H,H=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var M=this.length-C;if(void 0===H||H>M)H=M;if(0<G.length&&(0>H||0>C)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(M=!1;;)switch(J){case "hex":C=Number(C)||0;J=this.length-C;H?(H=Number(H),H>J&&(H=J)):H=J;J=G.length;if(0!==J%2)throw new TypeError("Invalid hex string");
H>J/2&&(H=J/2);for(J=0;J<H;++J){M=parseInt(G.substr(2*J,2),16);if(isNaN(M))break;this[C+J]=M}return J;case "utf8":case "utf-8":return F(A(G,this.length-C),this,C,H);case "ascii":return F(y(G),this,C,H);case "latin1":case "binary":return F(y(G),this,C,H);case "base64":return F(x(G),this,C,H);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=G;M=this.length-C;for(var S=[],W=0;W<J.length&&!(0>(M-=2));++W){var O=J.charCodeAt(W);G=O>>8;O%=256;S.push(O);S.push(G)}return F(S,this,C,H);default:if(M)throw new TypeError("Unknown encoding: "+
J);J=(""+J).toLowerCase();M=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.sik||this,0)}};var X=4096;f.prototype.slice=function(G,C){var H=this.length;G=~~G;C=void 0===C?H:~~C;0>G?(G+=H,0>G&&(G=0)):G>H&&(G=H);0>C?(C+=H,0>C&&(C=0)):C>H&&(C=H);C<G&&(C=G);if(f.nP)C=this.subarray(G,C),C.__proto__=f.prototype;else{H=C-G;C=new f(H,void 0);for(var J=0;J<H;++J)C[J]=this[J+G]}return C};f.prototype.idj=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");
if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,C,H,J){H||(H=0);J||0===J||(J=this.length);C>=G.length&&(C=G.length);C||(C=0);0<J&&J<H&&(J=H);if(J===H||0===G.length||0===this.length)return 0;if(0>C)throw new RangeError("targetStart out of bounds");if(0>H||H>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length);G.length-
C<J-H&&(J=G.length-C+H);var M=J-H;if(this===G&&H<C&&C<J)for(J=M-1;0<=J;--J)G[J+C]=this[J+H];else if(1E3>M||!f.nP)for(J=0;J<M;++J)G[J+C]=this[J+H];else Uint8Array.prototype.set.call(G,this.subarray(H,H+M),C);return M};f.prototype.fill=function(G,C,H,J){if("string"===typeof G){"string"===typeof C?(J=C,C=0,H=this.length):"string"===typeof H&&(J=H,H=this.length);if(1===G.length){var M=G.charCodeAt(0);256>M&&(G=M)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");if("string"===
typeof J&&!f.aif(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof G&&(G&=255);if(0>C||this.length<C||this.length<H)throw new RangeError("Out of range index");if(H<=C)return this;C>>>=0;H=void 0===H?this.length:H>>>0;G||(G=0);if("number"===typeof G)for(J=C;J<H;++J)this[J]=G;else for(G=f.isBuffer(G)?G:A((new f(G,J)).toString()),M=G.length,J=0;J<H-C;++J)this[J+C]=G[J%M];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1310))},1310:function(u){var D=function(){return this}();
try{D=D||(new Function("return this"))()}catch(a){"object"===typeof window&&(D=window)}u.exports=D},1311:function(u,D){function a(f){var d=f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}D.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};D.GSj=function(f){var d=a(f);var h=d[0];d=d[1];var m=new e(3*(h+d)/4-d),l=0,v=0<d?h-4:h,t;for(t=0;t<v;t+=4)h=b[f.charCodeAt(t)]<<18|b[f.charCodeAt(t+1)]<<12|b[f.charCodeAt(t+
2)]<<6|b[f.charCodeAt(t+3)],m[l++]=h>>16&255,m[l++]=h>>8&255,m[l++]=h&255;2===d&&(h=b[f.charCodeAt(t)]<<2|b[f.charCodeAt(t+1)]>>4,m[l++]=h&255);1===d&&(h=b[f.charCodeAt(t)]<<10|b[f.charCodeAt(t+1)]<<4|b[f.charCodeAt(t+2)]>>2,m[l++]=h>>8&255,m[l++]=h&255);return m};D.KZe=function(f){for(var d=f.length,h=d%3,m=[],l=0,v=d-h;l<v;l+=16383){for(var t=m,z=t.push,r,n=f,w=l+16383>v?v:l+16383,B=[],A=l;A<w;A+=3)r=(n[A]<<16&16711680)+(n[A+1]<<8&65280)+(n[A+2]&255),B.push(c[r>>18&63]+c[r>>12&63]+c[r>>6&63]+c[r&
63]);r=B.join("");z.call(t,r)}1===h?(f=f[d-1],m.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],m.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return m.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(u=0;64>u;++u)c[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;b[45]=62;b[95]=63},1312:function(u,D){D.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<
d)-1,m=h>>1,l=-7;f=b?f-1:0;var v=b?-1:1,t=a[c+f];f+=v;b=t&(1<<-l)-1;t>>=-l;for(l+=d;0<l;b=256*b+a[c+f],f+=v,l-=8);d=b&(1<<-l)-1;b>>=-l;for(l+=e;0<l;d=256*d+a[c+f],f+=v,l-=8);if(0===b)b=1-m;else{if(b===h)return d?NaN:Infinity*(t?-1:1);d+=Math.pow(2,e);b-=m}return(t?-1:1)*d*Math.pow(2,b-e)};D.write=function(a,c,b,e,f,d){var h,m=8*d-f-1,l=(1<<m)-1,v=l>>1,t=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var z=e?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=l):
(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+v?c+t/h:c+t*Math.pow(2,1-v),2<=c*h&&(e++,h/=2),e+v>=l?(c=0,e=l):1<=e+v?(c=(c*h-1)*Math.pow(2,f),e+=v):(c=c*Math.pow(2,v-1)*Math.pow(2,f),e=0));for(;8<=f;a[b+d]=c&255,d+=z,c/=256,f-=8);e=e<<f|c;for(m+=f;0<m;a[b+d]=e&255,d+=z,e/=256,m-=8);a[b+d-z]|=128*r}},1313:function(u){var D={}.toString;u.exports=Array.isArray||function(a){return"[object Array]"==D.call(a)}},1314:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);
D=a(722);var c=a(697);class b extends D.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(u.a)(b,"DetectedHtmlTableAnnotation",D.a,[])},1315:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{static IIa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=
Array(256),d=Array(256);let h,m=0,l=0;let v,t="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var z=b.charCodeAt(h%b.length);if(256<=z)return"";m=(m+f[h]+z)%256;z=f[h];f[h]=f[m];f[m]=z}for(h=0;256>h;h++)d[h]=f[256-h-1];m=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;m=(m+f[h])%256;z=f[h];f[h]=f[m];f[m]=z;z=e.charCodeAt(b);if(256<=z)return"";v=z^f[(f[h]+f[m])%256];l=(l+d[h])%256;z=d[h];d[h]=d[l];d[l]=z;t+=String.fromCharCode(v^f[(d[h]+d[l])%256])}return t}}Object(u.a)(c,"RC4A",null,[])},1317:function(u,D,
a){a.d(D,"a",function(){return b});u=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.llb=e;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&d.AZh();this.Ax=f;this.ODg=h}get WEb(){return this.llb}get solutionId(){return this.Ax}get sUd(){return this.ODg}eLa(e){e=this.WEb+this.solutionId+e;return this.sUd?(e in b.K0b||(b.K0b[e]="AddinControl"+b.APg++),b.K0b[e]):e}CKe(e){if(this.sUd){const d=b.K0b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.WEb.length+this.solutionId.length)}}return e}X7e(e){e=
this.WEb+this.solutionId+e;return this.sUd?(e in b.$Xc||(b.$Xc[e]="AddinTab"+b.LPg++),b.$Xc[e]):e}}b.K0b={};b.$Xc={};b.LPg=0;b.APg=0;Object(u.a)(b,"DefaultRibbonNamingProvider",null,[758])},1364:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(82),e;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";
r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=
21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";
r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";r[r.tableAddedEvent=102]=
"tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=1E3]=
"invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=2103]=
"shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(u.b)("MessageType",e);var f=a(765),d=a(249),h=a(734),m=a(58),l=a(37),v=a(153),t=a(1);a.d(D,"DdaEventDispatch",function(){return z});class z{constructor(r){this.iB=null;this.Deg={};this.Feg=
{};this.Wcd={};this.lBd={};this.Ykd=(n,w)=>{n=this.$.Jb.Ac("Task","DdaEventDispatch.HandleServerEvent");w=w.i2f;for(let x=0;x<w.length;x++)switch(w[x].EventType){case 2:var B=w[x],A={};A.Name=B.Name;A.BindingType=B.BindingType;A.ColCount=B.ColCount;A.RowCount=B.RowCount;this.Jwa(B.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,A,null);break;case 4:this.Jwa(w[x].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(B=w[x],B.InstanceId){A=Array(B.Entries.length);
for(var y=0;y<B.Entries.length;y++)A[y]=z.Kdc(B.Entries[y],B.IsRemoteOverride);0<B.Entries.length&&1===B.Entries[0].Category?this.r9i(B.InstanceId,A):B.InstanceId&&this.Jwa(B.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,A)}else{this.Wcd={};this.lBd={};for(A=0;A<B.Entries.length;A++)this.gNe(B.Entries[A],B.IsRemoteOverride);B=JSON.stringify(this.Wcd);A=JSON.stringify(this.lBd);y=JSON.stringify(this.Deg);const F=JSON.stringify(this.Feg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${B}, Number of Not Fired event: ${A}, Total Number of Fired event: ${y}, Total Number of Not Fired event: ${F}`)}}n.stop()};
this.XLb=(n,w)=>{this.Jwa(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)};this.$=r;this.Ixc=this.Ykd}n0b(r){r&&(this.cja(),this.iB.push(r))}$uc(r){this.iB&&(Array.remove(this.iB,r),this.iB.length||(this.$.wantServerEvents=!1,this.$.mlj(this.Ixc),this.iB=null))}r9i(r,n){const w=Object(b.a)(h.DdaFacade,d.a(this.$));l.TaskExtensions.Aa(w.W_h(r),B=>{if(v.b(B)){var A=B.result;B=w.An(A);if(A)if(B.ijc)this.Jwa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n);else if(B.p7b)for(A=0;A<n.length;A++)B.p7b.push(n[A]);
else B.p7b=n}else B.Wf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):B.Ch&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}N9i(r,n){const w=Object(b.a)(h.DdaFacade,d.a(this.$)),B=w.NOh(r);B?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(B,n,this.XLb):w.Sah(r,n)}gNe(r,n){let w=!1;const B=parseInt(r.Type,
10);var A=r.Target;const y=Object(b.a)(h.DdaFacade,d.a(this.$));if((A=y.kj.a0h(B,A))&&0<Object.keys(A).length){w=!0;for(let F in A)if(A=F,y.kj.z1b(A)){const I=Array(1);I[0]=z.Kdc(r,n);if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var x=I[0][3];if(void 0!==x&&null!==x&&(x=Object(b.a)(Object,m.a.li(x)))&&void 0!==x.triggerControlId&&null!==x.triggerControlId&&void 0!==x.triggerSource&&null!==x.triggerSource){let L=!1;n?(x.triggerSource="Unknown",L=!0):y.Qoh(x.triggerControlId,
A)&&(x.triggerSource="ThisLocalAddin",L=!0);L&&(I[0][3]=m.a.hc(x))}}this.Jwa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,I)}}w?(this.ugc(e[B],this.Wcd),this.ugc(e[B],this.Deg)):(this.ugc(e[B],this.lBd),this.ugc(e[B],this.Feg))}cja(){this.iB||(this.iB=[],this.$.vse(this.Ixc),this.$.wantServerEvents=!0)}ugc(r,n){r in n||(n[r]=0);n[r]+=1}fN(r,n,w){const B={};B.Target=n;B.Category=65536;B.Type=r;B.Message=w;B.Id=-1;this.gNe(B,!1)}EIh(r,n){const w={Target:"",Category:2,Type:1E3};w.Message=n;w.Id=
0;n=Array(1);n[0]=z.Kdc(w,!1);this.N9i(r,n)}Kac(r,n,w,B){const A={};A.Target=w;A.Category=65536;A.Type=n;A.Message=B;A.Id=-1;n=Array(1);n[0]=z.Kdc(A,!1);this.Jwa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n)}DIh(r,n){this.Jwa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n)}Jwa(r,n,w,B){if(this.iB){var A=Object(b.a)(h.DdaFacade,d.a(this.$));if(!A||n!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&n!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||A.kj.z1b(r)){r=new f.a(n,r,
w,B);for(let y=0,x=this.iB.length;y<x;y++)(n=this.iB[y])&&n(r)}}}static Kdc(r,n){const w=Array(6);w[0]=r.Category;w[1]=r.Type;w[2]=r.Target;w[3]=r.Message;w[4]=r.Id;w[5]=n;return w}}Object(u.a)(z,"DdaEventDispatch",null,[])},1395:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);D=a(146);var c=a(86);class b extends D.a{constructor(){super(void 0,void 0,void 0,!0);this.ZDa="AddinCommandsUILessDialog";this.CUc="WACDialogTitleText";this.Bfa="0";this.ZX=380;this.wqa=190;this.Ee=this.ZDa;this.Rb=
5;this.Wug=String.format("{0}px",this.ZX);this.Afa=String.format("{0}px",this.wqa);this.uaf=this.Jt=!1;this.Zz()}Zz(){super.Zz();this.Vk.style.width=this.Wug;this.Vk.style.height=this.Afa;this.Vk.style.padding=this.Bfa}Qv(e){this.YI();document.getElementById(this.mi(this.CUc)).innerText=e}YI(){super.YI();this.wb.style.width=String.format("{0}px",this.ZX);this.wb.style.height=String.format("{0}px",this.wqa);this.wb.removeAttribute(c.a.Ld);this.wb.removeAttribute(c.a.UP)}hide(){this.Wyb()}get Pia(){return this.Vk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(u.a)(b,"AddinCommandsUILessDialog",D.a,[765])},1425:function(u,D,a){a.r(D);var c=a(511),b=a(953),e=a(1187),f=a(9),d=a(0),h=a(222),m=a(187),l=a(586);class v{constructor(){this.Hhb=null}get xVg(){this.Hhb||(this.Hhb=new m.a,this.Hhb.add(12),this.Hhb.add(11));return this.Hhb}mmi(Q){return this.xVg.contains(Q.operation)}WWj(Q){const Ua=[],Fb=Q.payload;for(const nc of Fb.batchedOperations)Ua.push(new l.a(Q.operation,nc));return Ua}}Object(d.a)(v,"MacroRecorderBatchedEventList",null,
[]);var t=a(15),z=a(58),r=a(121),n=a(639);class w{equals(Q,Ua){return Q===Ua}getHashCode(Q){return Q}Zja(Q){return Q}}Object(d.a)(w,"UserOperationNameComparer",null,[99,100]);class B{static $7h(){B.Oc||(B.Oc=new n.a(new w),B.Oc.add(507),B.Oc.add(10),B.Oc.add(576),B.Oc.add(563),B.Oc.add(564),B.Oc.add(565),B.Oc.add(566),B.Oc.add(567),B.Oc.add(568),B.Oc.add(569),B.Oc.add(570),B.Oc.add(571),B.Oc.add(572),B.Oc.add(573),B.Oc.add(574),B.Oc.add(575),B.Oc.add(501),B.Oc.add(520),B.Oc.add(1),B.Oc.add(1002),
B.Oc.add(129),B.Oc.add(198),B.Oc.add(500),B.Oc.add(519),B.Oc.add(538),B.Oc.add(1E3),B.Oc.add(1003),B.Oc.add(144),B.Oc.add(502),B.Oc.add(505),B.Oc.add(179),B.Oc.add(205),B.Oc.add(134),B.Oc.add(230),B.Oc.add(103),B.Oc.add(110),B.Oc.add(112),B.Oc.add(113),B.Oc.add(124),B.Oc.add(133),B.Oc.add(154),B.Oc.add(162),B.Oc.add(168),B.Oc.add(172),B.Oc.add(201),B.Oc.add(222),B.Oc.add(227),B.Oc.add(513),B.Oc.add(534),B.Oc.add(539),B.Oc.add(545),B.Oc.add(600),B.Oc.add(547),B.Oc.add(555),B.Oc.add(558),B.Oc.add(562),
B.Oc.add(585),B.Oc.add(1001),B.Oc.add(1005),B.Oc.add(1008),B.Oc.add(1010),B.Oc.add(1011),B.Oc.add(1012),B.Oc.add(1018),B.Oc.add(252),B.Oc.add(253),B.Oc.add(258),B.Oc.add(101),B.Oc.add(102),B.Oc.add(108),B.Oc.add(257),B.Oc.add(119),B.Oc.add(120),B.Oc.add(123),B.Oc.add(126),B.Oc.add(127),B.Oc.add(130),B.Oc.add(140),B.Oc.add(159),B.Oc.add(160),B.Oc.add(165),B.Oc.add(166),B.Oc.add(167),B.Oc.add(169),B.Oc.add(189),B.Oc.add(223),B.Oc.add(214),B.Oc.add(228),B.Oc.add(233),B.Oc.add(247),B.Oc.add(504),B.Oc.add(511),
B.Oc.add(512),B.Oc.add(525),B.Oc.add(533),B.Oc.add(537),B.Oc.add(542),B.Oc.add(544),B.Oc.add(548),B.Oc.add(550),B.Oc.add(551),B.Oc.add(552),B.Oc.add(554),B.Oc.add(577),B.Oc.add(584),B.Oc.add(586),B.Oc.add(587),B.Oc.add(588),B.Oc.add(592),B.Oc.add(1009),B.Oc.add(1016),B.Oc.add(1017));return B.Oc}}B.Oc=null;Object(d.a)(B,"MacroRecorderUnrecognizedEventList",null,[]);class A{constructor(Q,Ua,Fb){this.Iac=null;this.BFi=(nc,Dc)=>{this.u7f()&&this.Tcd(Dc)};this.fuf=Ua;this.euf=Fb;this.$=Q;this.$.JV&&this.$.VNg(this.BFi);
Q.da.Ga(297,this)}init(Q){this.$.JV&&(Q?this.Iac=Q:t.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Tcd(Q){if(this.u7f())try{if(this.euf.mmi(Q)){const Ua=this.euf.WWj(Q);for(const Fb of Ua)this.fYe(Fb)}else this.fYe(Q)}catch(Ua){Q=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${r.a(Q.operation)}, Exception: ${Ua.stack}`,t.ULS.sendTraceTag(537155423,0,10,Q)}}fYe(Q){var Ua=this.fuf.w4e(Q,!0);Ua?(this.Iac(Ua.eventId,z.a.hc(Q.payload)),
t.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ua.eventId}`)):(Ua=this.fuf.w4e(Q,!1))?t.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ua.eventId}, but failed to match filters`):B.$7h().contains(Q.operation)||(this.Iac(0,z.a.hc(Q.operation)),Q=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${r.a(Q.operation)}`,t.ULS.sendTraceTag(537155420,0,50,Q))}u7f(){return this.$.G5&&this.Iac&&this.$.Zba?
!0:!1}}Object(d.a)(A,"MacroRecorderEventHandler",null,[712]);var y=a(1);class x{constructor(){this.BKc=this.CKc=this.zQc=this.ZUc=null}get operations(){this.zQc||(this.zQc=new m.a,this.Xb());return this.zQc}get TEc(){this.ZUc||(this.ZUc=new m.a,this.eg());return this.ZUc}get OWe(){this.BKc||(this.BKc=new m.a);return this.BKc}get featureGates(){this.CKc||(this.CKc=new m.a,this.ixa());return this.CKc}eg(){}ixa(){}ld(Q){this.TEc.add(Q)}Nb(Q){this.operations.contains(Q)||this.operations.add(Q)}eob(){this.featureGates.add(663)}Epe(Q){this.OWe.add(Q)}}
Object(d.a)(x,"MacroRecorderEventBase",null,[]);class F extends x{constructor(){super()}get eventId(){return 130}Xb(){this.Nb(100)}}Object(d.a)(F,"AccessibilityCheckRunEvent",x,[]);class I extends x{constructor(){super()}get eventId(){return 160}Xb(){this.Nb(241)}eg(){this.ld(Q=>Q.addToPrintArea)}}Object(d.a)(I,"AddedToPrintAreaEvent",x,[]);class L extends x{constructor(){super()}get eventId(){return 65}Xb(){this.Nb(516)}}Object(d.a)(L,"AutoFilterToggledEvent",x,[]);class X extends x{constructor(){super()}get eventId(){return 118}Xb(){this.Nb(502)}eg(){this.ld(Q=>
!(Q.z5a().FirstColumn===Q.z5a().LastColumn&&Q.z5a().FirstRow===Q.z5a().LastRow))}}Object(d.a)(X,"AutoSumEvent",x,[]);class P extends x{constructor(Q,Ua){super();this.Qfa=Q;this.S2j=Ua}get eventId(){return this.Qfa}Xb(){this.Nb(529);this.Nb(594)}eg(){this.ld(Q=>this.S2j.includes(Q.Shd()))}}Object(d.a)(P,"ChartPropertyAppliedEventBase",x,[]);class G extends P{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(G,"ChartAxisChangedEvent",P,[]);class C extends P{constructor(){super(80,
[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(C,"ChartAxisTitleChangedEvent",P,[]);class H extends P{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(H,"ChartDataLabelsChangedEvent",P,[]);class J extends P{constructor(){super(76,[-100])}}Object(d.a)(J,"ChartDataSelectedEvent",P,[]);class M extends P{constructor(){super(83,[500,501,502])}}Object(d.a)(M,"ChartDataTableChangedEvent",P,[]);var S=a(553),W=a(416),O=a(82);class T extends x{constructor(){super()}}
Object(d.a)(T,"RichApiRequestExecutedEventBase",x,[]);class Y{constructor(Q,Ua,Fb){this.response=this.request=this.eventId=this.source=null;Q&&(this.source=Q.source,this.eventId=Q.eventId,this.request=Ua,this.response=Fb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(Y,"MacroRecorderRichApiRequestExecutedPayload",null,[125]);class va extends T{constructor(){super()}get eventId(){return 117}wy(Q){va.y7||(va.y7=new n.a(S.a.cl()),
va.y7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),va.y7.add("fa000000014"));return!!Q&&va.y7.contains(Q.toLowerCase())}Xb(){this.Nb(507);this.Nb(10);this.Nb(576)}eg(){this.ld(Q=>Object(W.a)(Y,Q)&&(Q=Object(O.a)(Y,Q),Q.isValid&&this.wy(Q.source))?(t.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${Q.eventId}`),!0):!1)}}va.y7=null;Object(d.a)(va,"ChartFormatRichApiRequestExecutedEvent",T,[]);class ca extends P{constructor(){super(85,
[328,329,330,331,332,333,334,335])}}Object(d.a)(ca,"ChartGridlinesChangedEvent",P,[]);class V extends x{constructor(){super()}get eventId(){return 66}Xb(){this.Nb(528)}}Object(d.a)(V,"ChartInsertedEvent",x,[]);class ra extends P{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(ra,"ChartLegendChangedEvent",P,[]);class N extends P{constructor(){super(75,[-101])}}Object(d.a)(N,"ChartRowColumnSwitchedEvent",P,[]);class ea extends P{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(ea,
"ChartTitleChangedEvent",P,[]);class Ba extends P{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(Ba,"ChartTypeChangedEvent",P,[]);class ka extends x{constructor(){super()}get eventId(){return 131}Xb(){this.Nb(521)}}Object(d.a)(ka,"ConnectorFloatingObjectResizedEvent",x,[]);class Ka extends x{constructor(){super()}get eventId(){return 129}Xb(){this.Nb(109)}}
Object(d.a)(Ka,"EntitySelectedEvent",x,[]);class Oa extends x{constructor(){super()}get eventId(){return 49}Xb(){this.Nb(149);this.Nb(147)}}Object(d.a)(Oa,"FindCellEvent",x,[]);class wa extends x{constructor(){super()}get eventId(){return 96}Xb(){this.Nb(122)}}Object(d.a)(wa,"FloatingObjectAltTextAppliedEvent",x,[]);class qa extends x{constructor(){super()}get eventId(){return 93}Xb(){this.Nb(522)}}Object(d.a)(qa,"FloatingObjectDeletedEvent",x,[]);class aa extends x{constructor(){super()}get eventId(){return 94}Xb(){this.Nb(524)}}
Object(d.a)(aa,"FloatingObjectMovedAndResizedEvent",x,[]);class ia extends x{constructor(){super()}get eventId(){return 95}Xb(){this.Nb(523)}}Object(d.a)(ia,"FloatingObjectRotatedEvent",x,[]);class Ha extends x{constructor(){super()}get eventId(){return 100}Xb(){this.Nb(543)}}Object(d.a)(Ha,"GroupDetailsShownOrHiddenEvent",x,[]);class Z extends x{constructor(){super()}get eventId(){return 154}Xb(){this.Nb(125)}}Object(d.a)(Z,"HyperlinksRemovedFromRangeEvent",x,[]);class la extends T{constructor(){super()}get eventId(){return 125}wy(Q){la.y7||
(la.y7=new n.a(S.a.cl()),la.y7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),la.y7.add("fa000000005"));return!!Q&&la.y7.contains(Q.toLowerCase())}Xb(){this.Nb(507);this.Nb(10);this.Nb(576)}eg(){this.ld(Q=>Object(W.a)(Y,Q)?(Q=Object(O.a)(Y,Q),Q.isValid&&this.wy(Q.source)):!1)}}la.y7=null;Object(d.a)(la,"IdeasRichApiRequestExecutedEvent",T,[]);class Xa extends x{constructor(){super()}get eventId(){return 136}Xb(){this.Nb(115)}}Object(d.a)(Xa,"LinkedEntityConvertedEvent",x,[]);class Za extends x{constructor(){super()}get eventId(){return 148}Xb(){this.Nb(114)}}
Object(d.a)(Za,"LinkedEntityDisambiguationPaneToggledEvent",x,[]);class xa extends x{constructor(){super()}get eventId(){return 127}Xb(){this.Nb(119)}}Object(d.a)(xa,"MovedToEdgeEvent",x,[]);class fa extends x{constructor(){super()}get eventId(){return 135}Xb(){this.Nb(191)}ixa(){this.eob()}}Object(d.a)(fa,"NamedSheetViewCreatedEvent",x,[]);class ua extends x{constructor(){super()}get eventId(){return 166}Xb(){this.Nb(200)}ixa(){this.eob()}}Object(d.a)(ua,"NamedSheetViewDeletedEvent",x,[]);class sa extends x{constructor(){super()}get eventId(){return 133}Xb(){this.Nb(192)}ixa(){this.eob()}}
Object(d.a)(sa,"NamedSheetViewExitedEvent",x,[]);class sb extends x{constructor(){super()}get eventId(){return 162}Xb(){this.Nb(199)}ixa(){this.eob()}}Object(d.a)(sb,"NamedSheetViewRenamedEvent",x,[]);class hb extends x{constructor(){super()}get eventId(){return 167}Xb(){this.Nb(195)}ixa(){this.eob()}}Object(d.a)(hb,"NamedSheetViewSwitchedEvent",x,[]);class bb extends x{constructor(){super()}get eventId(){return 99}Xb(){this.Nb(174)}}Object(d.a)(bb,"OutlineLevelSetEvent",x,[]);class lb extends x{constructor(){super()}get eventId(){return 156}Xb(){this.Nb(244)}}
Object(d.a)(lb,"PageBreakInsertedEvent",x,[]);class Fa extends x{constructor(){super()}get eventId(){return 157}Xb(){this.Nb(245)}}Object(d.a)(Fa,"PageBreakRemovedEvent",x,[]);class Na extends x{constructor(){super()}get eventId(){return 158}Xb(){this.Nb(246)}}Object(d.a)(Na,"PageBreaksAllResetEvent",x,[]);class Mb extends x{constructor(){super()}get eventId(){return 112}Xb(){this.Nb(503)}eg(){this.ld(Q=>!!Q.pasteParameters.ClientEstimationFloatingObjectId&&2===Q.pasteParameters.CopyPasteTargetType&&
!Q.isFromCurrentSession)}}Object(d.a)(Mb,"PasteArtOtherWorkbookEvent",x,[]);class dc extends x{constructor(){super()}get eventId(){return 52}Xb(){this.Nb(503)}eg(){this.ld(Q=>!!Q.pasteParameters.ClientEstimationFloatingObjectId&&2===Q.pasteParameters.CopyPasteTargetType&&Q.isFromCurrentSession)}}Object(d.a)(dc,"PasteArtSameWorkbookEvent",x,[]);class Cb extends x{constructor(){super()}get eventId(){return 110}Xb(){this.Nb(204)}}Object(d.a)(Cb,"PasteHtmlEvent",x,[]);class Tb extends x{constructor(){super()}get eventId(){return 35}Xb(){this.Nb(506)}}
Object(d.a)(Tb,"PasteRangeEvent",x,[]);class Jb extends x{constructor(){super()}get eventId(){return 111}Xb(){this.Nb(503)}eg(){this.ld(Q=>1===Q.pasteParameters.CopyPasteTargetType)}}Object(d.a)(Jb,"PasteShadowWorkbookRangeEvent",x,[]);class eb extends x{constructor(){super()}get eventId(){return 42}Xb(){this.Nb(180)}}Object(d.a)(eb,"PasteStringEvent",x,[]);class za extends x{constructor(){super()}get eventId(){return 134}Xb(){this.Nb(220)}}Object(d.a)(za,"PendingMergeEvent",x,[]);class ha extends x{constructor(){super()}get eventId(){return 122}Xb(){this.Nb(510)}}
Object(d.a)(ha,"PictureInsertedEvent",x,[]);class fb extends x{constructor(){super()}get eventId(){return 153}Xb(){this.Nb(161)}}Object(d.a)(fb,"PivotDrillToggledEvent",x,[]);class rb extends x{constructor(Q,Ua){super();this.Qfa=Q;this.opType=Ua}get eventId(){return this.Qfa}Xb(){this.Nb(225)}eg(){this.ld(Q=>Q.opType===this.opType)}}Object(d.a)(rb,"PivotTableSettingsChangedEventBase",x,[]);class pa extends rb{constructor(){super(171,4)}}Object(d.a)(pa,"PivotTableAllItemLabelsRepeatedEvent",rb,[]);
class Ma extends rb{constructor(){super(184,17)}}Object(d.a)(Ma,"PivotTableAltTextDescriptionChangedEvent",rb,[]);class Ja extends rb{constructor(){super(183,16)}}Object(d.a)(Ja,"PivotTableAltTextTitleChangedEvent",rb,[]);class Ga extends rb{constructor(){super(173,6)}}Object(d.a)(Ga,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",rb,[]);class La extends rb{constructor(){super(172,5)}}Object(d.a)(La,"PivotTableBlankLineAfterEachItemToggledEvent",rb,[]);class nb extends rb{constructor(){super(170,
3)}}Object(d.a)(nb,"PivotTableColumnGrandTotalShownEvent",rb,[]);class Lb extends x{constructor(){super()}get eventId(){return 98}Xb(){this.Nb(132)}}Object(d.a)(Lb,"PivotTableCreatedEvent",x,[]);class ac extends rb{constructor(){super(177,10)}}Object(d.a)(ac,"PivotTableDisplayErrorStringToggledEvent",rb,[]);class ib extends rb{constructor(){super(178,11)}}Object(d.a)(ib,"PivotTableDisplayNullStringToggledEvent",rb,[]);class Ra extends rb{constructor(){super(179,12)}}Object(d.a)(Ra,"PivotTableErrorStringChangedEvent",
rb,[]);class ya extends rb{constructor(){super(174,7)}}Object(d.a)(ya,"PivotTableExpandCollapseButtonsShownEvent",rb,[]);class Va extends rb{constructor(){super(187,20)}}Object(d.a)(Va,"PivotTableIndentChangedEvent",rb,[]);class oa extends rb{constructor(){super(176,9)}}Object(d.a)(oa,"PivotTableItemsWithNoDataOnColumnsShownEvent",rb,[]);class kb extends rb{constructor(){super(175,8)}}Object(d.a)(kb,"PivotTableItemsWithNoDataOnRowsShownEvent",rb,[]);class Sa extends rb{constructor(){super(186,19)}}
Object(d.a)(Sa,"PivotTableLayoutTypeSetEvent",rb,[]);class U extends rb{constructor(){super(180,13)}}Object(d.a)(U,"PivotTableNullStringChangedEvent",rb,[]);class ta extends x{constructor(){super()}get eventId(){return 149}Xb(){this.Nb(219)}}Object(d.a)(ta,"PivotTablePivotLocationChangedEvent",x,[]);class ub extends x{constructor(){super()}get eventId(){return 102}Xb(){this.Nb(145)}}Object(d.a)(ub,"PivotTablePivotedEvent",x,[]);class hc extends rb{constructor(){super(182,15)}}Object(d.a)(hc,"PivotTableRefreshDataOnLoadToggledEvent",
rb,[]);class Bc extends x{constructor(){super()}get eventId(){return 104}Xb(){this.Nb(50)}eg(){this.ld(Q=>!!Q.pivotTableId&&!!Q.pivotTableName)}}Object(d.a)(Bc,"PivotTableRefreshedEvent",x,[]);class Qa extends rb{constructor(){super(168,1)}}Object(d.a)(Qa,"PivotTableRenamedEvent",rb,[]);class na extends rb{constructor(){super(169,2)}}Object(d.a)(na,"PivotTableRowGrandTotalShownEvent",rb,[]);class ab extends rb{constructor(){super(181,14)}}Object(d.a)(ab,"PivotTableSaveSourceDataWithFileToggledEvent",
rb,[]);var Gb=a(606);class fc extends x{constructor(){super()}get eventId(){return 155}Xb(){this.Nb(131)}eg(){this.ld(Q=>{Q=Object(O.a)(Gb.a,Q);return!!Q&&!!Q.iLa()&&!!Q.hierarchyName})}}Object(d.a)(fc,"PivotTableSortedEvent",x,[]);class pb extends rb{constructor(){super(185,18)}}Object(d.a)(pb,"PivotTableSubTotalsVisibilitySettingSetEvent",rb,[]);class Ea extends x{constructor(){super()}get eventId(){return 206}Xb(){this.Nb(560)}}Object(d.a)(Ea,"PivotValueFieldSettingAppliedEvent",x,[]);class xb extends x{constructor(){super()}get eventId(){return 161}Xb(){this.Nb(243)}}
Object(d.a)(xb,"PrintAreaClearedEvent",x,[]);class bc extends x{constructor(){super()}get eventId(){return 159}Xb(){this.Nb(241)}eg(){this.ld(Q=>!Q.addToPrintArea)}}Object(d.a)(bc,"PrintAreaSetEvent",x,[]);class zb extends x{constructor(){super()}get eventId(){return 57}Xb(){this.Nb(517)}}Object(d.a)(zb,"RangeAutoFilterClearedEvent",x,[]);class Ub extends x{constructor(Q,Ua){super();this.Qfa=Q;this.n2d=Ua}get eventId(){return this.Qfa}Xb(){this.Nb(11)}eg(){this.ld(Q=>16===Q.PZ().ValidMembers);this.ld(Q=>
Q.PZ().Font.ValidMembers===this.n2d)}}Object(d.a)(Ub,"RangeFontFormattedEventBase",x,[]);class wc extends Ub{constructor(){super(3,4)}}Object(d.a)(wc,"RangeBoldedEvent",Ub,[]);class mb extends x{constructor(){super()}get eventId(){return 2}Xb(){this.Nb(11)}eg(){this.ld(Q=>128===Q.PZ().ValidMembers)}}Object(d.a)(mb,"RangeBorderedEvent",x,[]);class Db{}Db.Gab="Table";Db.crc="Sheet";Object(d.a)(Db,"MacroRecorderEventConstants",null,[]);class Ic extends x{constructor(){super()}get eventId(){return 113}Xb(){this.Nb(208)}eg(){this.ld(Q=>
Q.getParameters().FilterType===Db.crc)}}Object(d.a)(Ic,"RangeCheckedItemsFilteredEvent",x,[]);class Hc extends x{constructor(){super()}get eventId(){return 109}Xb(){this.Nb(105)}}Object(d.a)(Hc,"RangeConditionalFormattingCreatedEvent",x,[]);class Ab extends x{constructor(){super()}get eventId(){return 124}Xb(){this.Nb(221)}}Object(d.a)(Ab,"RangeConditionalFormattingRuleDeletedEvent",x,[]);class db extends x{constructor(){super()}get eventId(){return 29}Xb(){this.Nb(508)}eg(){this.ld(Q=>3===Q.xs()||
1===Q.xs()||4===Q.xs())}}Object(d.a)(db,"RangeContentClearedEvent",x,[]);class Pb extends x{constructor(){super()}get eventId(){return 40}Xb(){this.Nb(104)}}Object(d.a)(Pb,"RangeCopiedCutCellsInsertedEvent",x,[]);class td extends x{constructor(){super()}get eventId(){return 114}Xb(){this.Nb(209)}eg(){this.ld(Q=>Q.getParameters().FilterType===Db.crc)}}Object(d.a)(td,"RangeCustomFilteredEvent",x,[]);class Vb extends x{constructor(){super()}get eventId(){return 106}Xb(){this.Nb(121)}}Object(d.a)(Vb,
"RangeDataValidationChangedEvent",x,[]);class Ac extends Ub{constructor(){super(4,64)}}Object(d.a)(Ac,"RangeDoubleUnderlinedEvent",Ub,[]);class Kc extends x{constructor(){super()}get eventId(){return 69}Xb(){this.Nb(190)}}Object(d.a)(Kc,"RangeDuplicatesRemovedEvent",x,[]);class dd extends x{constructor(){super()}get eventId(){return 1}Xb(){this.Nb(527);this.Nb(12)}}Object(d.a)(dd,"RangeEditedEvent",x,[]);class Vd extends x{constructor(){super()}get eventId(){return 164}Xb(){this.Nb(255)}eg(){this.ld(Q=>
4===Q.actionType)}}Object(d.a)(Vd,"RangeExternalLinksBrokeAllLinksEvent",x,[]);class Jd extends x{constructor(){super()}get eventId(){return 119}Xb(){this.Nb(255)}eg(){this.ld(Q=>3===Q.actionType)}}Object(d.a)(Jd,"RangeExternalLinksBrokeLinkEvent",x,[]);class oe extends x{constructor(){super()}get eventId(){return 205}Xb(){this.Nb(256)}ixa(){this.Epe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(d.a)(oe,"RangeExternalLinksChangeSourceEvent",x,[]);class De extends x{constructor(){super()}get eventId(){return 163}Xb(){this.Nb(553)}eg(){this.ld(Q=>
1===Q.actionType)}}Object(d.a)(De,"RangeExternalLinksRefreshedAllEvent",x,[]);class Ke extends x{constructor(){super()}get eventId(){return 77}Xb(){this.Nb(553)}eg(){this.ld(Q=>0===Q.actionType)}}Object(d.a)(Ke,"RangeExternalLinksRefreshedEvent",x,[]);class rd extends x{constructor(){super()}get eventId(){return 165}Xb(){this.Nb(224)}}Object(d.a)(rd,"RangeExternalLinksSetAutoRefreshEvent",x,[]);class bf extends x{constructor(){super()}get eventId(){return 5}Xb(){this.Nb(11)}eg(){this.ld(Q=>64===Q.PZ().ValidMembers)}}
Object(d.a)(bf,"RangeFillColoredEvent",x,[]);class cc extends x{constructor(){super()}get eventId(){return 59}Xb(){this.Nb(155)}}Object(d.a)(cc,"RangeFilledEvent",x,[]);class Wc extends x{constructor(){super()}get eventId(){return 115}Xb(){this.Nb(176)}eg(){this.ld(Q=>Q.gV().AutoFilterType===Db.crc&&!!Q.gV().CriteriaType)}}Object(d.a)(Wc,"RangeFilterAppliedEvent",x,[]);class id extends x{constructor(){super()}get eventId(){return 58}Xb(){this.Nb(176)}eg(){this.ld(Q=>Q.gV().AutoFilterType===Db.crc&&
!Q.gV().CriteriaType)}}Object(d.a)(id,"RangeFilterClearedEvent",x,[]);class Tc extends x{constructor(){super()}get eventId(){return 41}Xb(){this.Nb(518)}}Object(d.a)(Tc,"RangeFilterReappliedEvent",x,[]);class Gd extends x{constructor(){super()}get eventId(){return 86}Xb(){this.Nb(150)}}Object(d.a)(Gd,"RangeFlashFilledEvent",x,[]);class Wd extends Ub{constructor(){super(6,32)}}Object(d.a)(Wd,"RangeFontColoredEvent",Ub,[]);class Dd extends Ub{constructor(){super(7,8)}}Object(d.a)(Dd,"RangeFontItalicizedEvent",
Ub,[]);class Kd extends Ub{constructor(){super(8,1)}}Object(d.a)(Kd,"RangeFontNamedEvent",Ub,[]);class we extends Ub{constructor(){super(9,2)}}Object(d.a)(we,"RangeFontSizedEvent",Ub,[]);class We extends x{constructor(){super()}get eventId(){return 74}Xb(){this.Nb(215)}}Object(d.a)(We,"RangeFormattedAsTableEvent",x,[]);class Od extends x{constructor(){super()}get eventId(){return 97}Xb(){this.Nb(188)}}Object(d.a)(Od,"RangeGroupedOrUngroupedEvent",x,[]);class le extends x{constructor(){super()}get eventId(){return 60}Xb(){this.Nb(11)}eg(){this.ld(Q=>
2===Q.PZ().ValidMembers)}}Object(d.a)(le,"RangeHorizontallyAlignedEvent",x,[]);class de extends x{constructor(){super()}get eventId(){return 43}Xb(){this.Nb(526)}}Object(d.a)(de,"RangeHyperlinkAppliedEvent",x,[]);class Re extends x{constructor(){super()}get eventId(){return 63}Xb(){this.Nb(11)}eg(){this.ld(Q=>256===Q.PZ().ValidMembers)}}Object(d.a)(Re,"RangeIndentChangedEvent",x,[]);class Ee extends x{constructor(){super()}get eventId(){return 53}Xb(){this.Nb(156)}eg(){this.ld(Q=>2===Q.xs()||5===
Q.xs()||6===Q.xs()||7===Q.xs())}}Object(d.a)(Ee,"RangeMergedEvent",x,[]);class Te extends x{constructor(){super()}get eventId(){return 107}Xb(){this.Nb(216)}}Object(d.a)(Te,"RangeNamedCellStyleAppliedEvent",x,[]);class Ae extends x{constructor(){super()}get eventId(){return 12}Xb(){this.Nb(11)}eg(){this.ld(Q=>32===Q.PZ().ValidMembers)}}Object(d.a)(Ae,"RangeNumberFormattedEvent",x,[]);var kf=a(955);class Oe extends x{constructor(){super()}get eventId(){return 108}Xb(){this.Nb(141)}eg(){this.ld(Q=>
Object(W.a)(kf.a,Q))}}Object(d.a)(Oe,"RangeSortedEvent",x,[]);class $a extends Ub{constructor(){super(10,128)}}Object(d.a)($a,"RangeStrikedThroughEvent",Ub,[]);class Zb extends Ub{constructor(){super(11,16)}}Object(d.a)(Zb,"RangeUnderlinedEvent",Ub,[]);class Da extends x{constructor(){super()}get eventId(){return 61}Xb(){this.Nb(11)}eg(){this.ld(Q=>1===Q.PZ().ValidMembers)}}Object(d.a)(Da,"RangeVerticallyAlignedEvent",x,[]);class Pa extends x{constructor(){super()}get eventId(){return 62}Xb(){this.Nb(11)}eg(){this.ld(Q=>
8===Q.PZ().ValidMembers)}}Object(d.a)(Pa,"RangeWrapTextToggledEvent",x,[]);class tb extends x{constructor(){super()}get eventId(){return 103}Xb(){this.Nb(51)}}Object(d.a)(tb,"RefreshedAllEvent",x,[]);class Ib extends x{constructor(){super()}get eventId(){return 47}Xb(){this.Nb(148)}}Object(d.a)(Ib,"ReplaceAllEvent",x,[]);class Yb extends x{constructor(){super()}get eventId(){return 91}Xb(){this.Nb(532)}eg(){this.ld(Q=>95!==Q.getShapeType()&&96!==Q.getShapeType()&&97!==Q.getShapeType()&&98!==Q.getShapeType()&&
100!==Q.getShapeType()&&102!==Q.getShapeType()&&103!==Q.getShapeType())}}Object(d.a)(Yb,"ShapeInsertedEvent",x,[]);class vc extends x{constructor(){super()}get eventId(){return 92}Xb(){this.Nb(531)}}Object(d.a)(vc,"ShapeStyleSetEvent",x,[]);var Zc=a(814);class nd extends x{constructor(Q,Ua){super();this.Qfa=Q;this.n2d=Ua}get eventId(){return this.Qfa}Xb(){this.Nb(581)}eg(){this.ld(Q=>Object(W.a)(Zc.a,Q)&&4===Q.getShapeTextFormat().ValidMembers);this.ld(Q=>Object(W.a)(Zc.a,Q)&&Q.getShapeTextFormat().Font.ValidMembers===
this.n2d)}}Object(d.a)(nd,"ShapeTextFontFormattedEventBase",x,[]);class hd extends nd{constructor(){super(193,4)}}Object(d.a)(hd,"ShapeTextBoldedEvent",nd,[]);var Ud=a(957);class ee extends x{constructor(){super()}get eventId(){return 191}Xb(){this.Nb(581)}eg(){this.ld(Q=>Object(W.a)(Ud.a,Q))}}Object(d.a)(ee,"ShapeTextChangedEvent",x,[]);class ec extends nd{constructor(){super(196,32)}}Object(d.a)(ec,"ShapeTextFontColorChangedEvent",nd,[]);class Vc extends nd{constructor(){super(197,1)}}Object(d.a)(Vc,
"ShapeTextFontNameChangedEvent",nd,[]);class ud extends nd{constructor(){super(198,2)}}Object(d.a)(ud,"ShapeTextFontSizeChangedEvent",nd,[]);class ke extends x{constructor(){super()}get eventId(){return 199}Xb(){this.Nb(581)}eg(){this.ld(Q=>Object(W.a)(Zc.a,Q)&&2===Q.getShapeTextFormat().ValidMembers)}}Object(d.a)(ke,"ShapeTextHorizontallyAlignedEvent",x,[]);class te extends nd{constructor(){super(194,8)}}Object(d.a)(te,"ShapeTextItalicizedEvent",nd,[]);class pe extends nd{constructor(){super(195,
16)}}Object(d.a)(pe,"ShapeTextUnderlinedEvent",nd,[]);class rf extends x{constructor(){super()}get eventId(){return 200}Xb(){this.Nb(581)}eg(){this.ld(Q=>Object(W.a)(Zc.a,Q)&&1===Q.getShapeTextFormat().ValidMembers)}}Object(d.a)(rf,"ShapeTextVerticallyAlignedEvent",x,[]);class cf extends x{constructor(){super()}get eventId(){return 13}Xb(){this.Nb(138)}}Object(d.a)(cf,"SheetAddedEvent",x,[]);var wf=a(8);class Ge extends x{constructor(){super()}get eventId(){return 142}Xb(){this.Nb(237)}eg(){this.ld(Q=>
!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>{Q=Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>Q.DeltaColumn&&!Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstRow||Q.InsertDeleteRange.LastRow!==wf.a.Pz)||!Q.DeltaColumn&&0>Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstColumn||Q.InsertDeleteRange.LastColumn!==wf.a.Rw)})}}Object(d.a)(Ge,"SheetCellsDeletedEvent",x,[]);class Ue extends x{constructor(){super()}get eventId(){return 143}Xb(){this.Nb(237)}eg(){this.ld(Q=>
!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>{Q=Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<Q.DeltaColumn&&!Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstRow||Q.InsertDeleteRange.LastRow!==wf.a.Pz)||!Q.DeltaColumn&&0<Q.DeltaRow&&(!!Q.InsertDeleteRange.FirstColumn||Q.InsertDeleteRange.LastColumn!==wf.a.Rw)})}}Object(d.a)(Ue,"SheetCellsInsertedEvent",x,[]);class gb extends x{constructor(){super()}get eventId(){return 139}Xb(){this.Nb(237)}eg(){this.ld(Q=>
!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ld(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===wf.a.Pz)}}Object(d.a)(gb,"SheetColumnDeletedEvent",
x,[]);class Ob extends x{constructor(){super()}get eventId(){return 138}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ld(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
wf.a.Pz)}}Object(d.a)(Ob,"SheetColumnInsertedEvent",x,[]);class rc extends x{constructor(){super()}get eventId(){return 14}Xb(){this.Nb(137)}}Object(d.a)(rc,"SheetDeletedEvent",x,[]);class Oc extends x{constructor(){super()}get eventId(){return 137}Xb(){this.Nb(185)}}Object(d.a)(Oc,"SheetDirectionChangedEvent",x,[]);class ld extends x{constructor(){super()}get eventId(){return 54}Xb(){this.Nb(139)}}Object(d.a)(ld,"SheetDuplicatedEvent",x,[]);class Cd extends x{constructor(){super()}get eventId(){return 15}Xb(){this.Nb(207)}}
Object(d.a)(Cd,"SheetNameEditedEvent",x,[]);class Qd extends x{constructor(){super()}get eventId(){return 90}Xb(){this.Nb(151)}}Object(d.a)(Qd,"SheetPaneFrozenEvent",x,[]);class re extends x{constructor(){super()}get eventId(){return 120}Xb(){this.Nb(226)}}Object(d.a)(re,"SheetPrintSettingsSavedEvent",x,[]);var Ie=a(855);class qf extends x{constructor(){super()}get eventId(){return 215}Xb(){this.Nb(507)}ixa(){this.Epe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}eg(){this.ld(Q=>Object.getType(Q)===
Ie.a)}}Object(d.a)(qf,"SheetProtectionPausedResumedEvent",x,[]);class Pe extends x{constructor(){super()}get eventId(){return 64}Xb(){this.Nb(557)}}Object(d.a)(Pe,"SheetReorderedEvent",x,[]);class of extends x{constructor(){super()}get eventId(){return 141}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ld(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===wf.a.Rw)}}Object(d.a)(of,"SheetRowDeletedEvent",x,[]);class Hb extends x{constructor(){super()}get eventId(){return 140}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ld(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ld(Q=>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===wf.a.Rw)}}Object(d.a)(Hb,"SheetRowInsertedEvent",x,[]);class mc extends x{constructor(){super()}get eventId(){return 39}Xb(){this.Nb(135)}}Object(d.a)(mc,"SheetRowsColumnsAutoFitEvent",x,[]);class Mc extends x{constructor(){super()}get eventId(){return 36}Xb(){this.Nb(136)}}
Object(d.a)(Mc,"SheetRowsColumnsResizedEvent",x,[]);class Rb extends x{constructor(){super()}get eventId(){return 68}Xb(){this.Nb(183)}}Object(d.a)(Rb,"SheetShowGridlinesToggledEvent",x,[]);class xc extends x{constructor(){super()}get eventId(){return 67}Xb(){this.Nb(184)}}Object(d.a)(xc,"SheetShowHeadingsToggledEvent",x,[]);class ed extends x{constructor(){super()}get eventId(){return 89}Xb(){this.Nb(213)}}Object(d.a)(ed,"SheetSpellCheckedEvent",x,[]);class xd extends x{constructor(){super()}get eventId(){return 70}Xb(){this.Nb(515)}}
Object(d.a)(xd,"SheetTabColoredEvent",x,[]);class yd extends x{constructor(){super()}get eventId(){return 71}Xb(){this.Nb(157)}}Object(d.a)(yd,"SheetVisibilityChangedEvent",x,[]);class Zd extends x{constructor(){super()}get eventId(){return 126}Xb(){this.Nb(239)}}Object(d.a)(Zd,"SheetsVisibilityChangedEvent",x,[]);class me extends x{constructor(){super()}get eventId(){return 188}Xb(){this.Nb(203)}}Object(d.a)(me,"SlicerInsertedEvent",x,[]);class wb extends x{constructor(){super()}get eventId(){return 189}Xb(){this.Nb(173)}eg(){this.ld(Q=>
!Q.clearFilter)}}Object(d.a)(wb,"SlicerSelectionAppliedEvent",x,[]);class $b extends x{constructor(){super()}get eventId(){return 190}Xb(){this.Nb(173)}eg(){this.ld(Q=>Q.clearFilter)}}Object(d.a)($b,"SlicerSelectionClearedEvent",x,[]);class uc extends x{constructor(){super()}get eventId(){return 27}Xb(){this.Nb(208)}eg(){this.ld(Q=>Q.getParameters().FilterType===Db.Gab)}}Object(d.a)(uc,"TableCheckedItemsFilteredEvent",x,[]);class Pc extends x{constructor(){super()}get eventId(){return 144}Xb(){this.Nb(237)}eg(){this.ld(Q=>
!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Pc,"TableColumnDeletedEvent",x,[]);class Ad extends x{constructor(){super()}get eventId(){return 145}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);
this.ld(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Ad,"TableColumnInsertedEvent",x,[]);var ba=a(956);class cb extends x{constructor(){super()}get eventId(){return 121}Xb(){this.Nb(141)}eg(){this.ld(Q=>Object(W.a)(ba.a,Q))}}Object(d.a)(cb,"TableColumnSortedEvent",x,[]);class Kb extends x{constructor(){super()}get eventId(){return 105}Xb(){this.Nb(193)}}Object(d.a)(Kb,
"TableConvertedToRangeEvent",x,[]);class lc extends x{constructor(){super()}get eventId(){return 16}Xb(){this.Nb(206)}}Object(d.a)(lc,"TableCreatedEvent",x,[]);class Qc extends x{constructor(){super()}get eventId(){return 30}Xb(){this.Nb(209)}eg(){this.ld(Q=>Q.getParameters().FilterType===Db.Gab)}}Object(d.a)(Qc,"TableCustomFilteredEvent",x,[]);class Rc extends x{constructor(){super()}get eventId(){return 25}Xb(){this.Nb(187)}eg(){this.ld(Q=>1===Q.options.OperationType)}}Object(d.a)(Rc,"TableCustomSortedEvent",
x,[]);class zd extends x{constructor(){super()}get eventId(){return 28}Xb(){this.Nb(176)}eg(){this.ld(Q=>Q.gV().AutoFilterType===Db.Gab);this.ld(Q=>0===Q.gV().CriteriaType)}}Object(d.a)(zd,"TableFilterClearedEvent",x,[]);class ae extends x{constructor(){super()}get eventId(){return 32}Xb(){this.Nb(176)}eg(){this.ld(Q=>Q.gV().AutoFilterType===Db.Gab);this.ld(Q=>{const Ua=new m.a;Ua.add(1);Ua.add(2);Ua.add(8);Ua.add(9);Ua.add(10);Ua.add(11);Ua.add(12);Ua.add(13);Ua.add(14);Ua.add(15);Ua.add(16);Ua.add(17);
Ua.add(18);Ua.add(19);Ua.add(20);Ua.add(21);Ua.add(22);Ua.add(23);Ua.add(24);Ua.add(25);Ua.add(26);Ua.add(27);Ua.add(28);Ua.add(29);Ua.add(30);Ua.add(31);Ua.add(32);Ua.add(33);Ua.add(34);Ua.add(35);Ua.add(36);Ua.add(37);Ua.add(38);Ua.add(39);return Ua.contains(Q.gV().CriteriaType)})}}Object(d.a)(ae,"TableItemFilteredEvent",x,[]);class ze extends x{constructor(){super()}get eventId(){return 101}Xb(){this.Nb(217)}}Object(d.a)(ze,"TableRenamedEvent",x,[]);class Be extends x{constructor(){super()}get eventId(){return 73}Xb(){this.Nb(211)}}
Object(d.a)(Be,"TableResizedEvent",x,[]);class xe extends x{constructor(){super()}get eventId(){return 44}Xb(){this.Nb(514)}}Object(d.a)(xe,"TableRowColumnRearrangedEvent",x,[]);class Ce extends x{constructor(){super()}get eventId(){return 146}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>0>Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(Ce,"TableRowDeletedEvent",x,[]);class ef extends x{constructor(){super()}get eventId(){return 147}Xb(){this.Nb(237)}eg(){this.ld(Q=>!!Q.insertDeleteMultiRangeParameters);this.ld(Q=>Q.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(Q=>!Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(Q=>0<Q.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(ef,"TableRowInsertedEvent",x,[]);class Jf extends x{constructor(){super()}get eventId(){return 26}Xb(){this.Nb(177)}eg(){this.ld(Q=>
Q.gV().AutoFilterType===Db.Gab)}}Object(d.a)(Jf,"TableSortedEvent",x,[]);class Ia extends x{constructor(){super()}get eventId(){return 87}Xb(){this.Nb(212)}}Object(d.a)(Ia,"TableStyleAppliedEvent",x,[]);class Bb extends x{constructor(){super()}get eventId(){return 88}Xb(){this.Nb(196)}}Object(d.a)(Bb,"TableStyleOptionToggledEvent",x,[]);class zc extends x{constructor(){super()}get eventId(){return 31}Xb(){this.Nb(210)}eg(){this.ld(Q=>Q.getParameters().FilterType===Db.Gab)}}Object(d.a)(zc,"TableTop10FilteredEvent",
x,[]);class ad extends x{constructor(){super()}get eventId(){return 207}Xb(){this.Nb(238)}}Object(d.a)(ad,"TextToColumnsEvent",x,[]);class sd extends x{constructor(){super()}get eventId(){return 128}Xb(){this.Nb(559)}}Object(d.a)(sd,"ValuesSortedEvent",x,[]);class Sd extends x{constructor(){super()}get eventId(){return 55}Xb(){this.Nb(197)}}Object(d.a)(Sd,"WorkbookCalculationModeSetEvent",x,[]);class fe extends x{constructor(){super()}get eventId(){return 34}Xb(){this.Nb(181)}eg(){this.ld(Q=>!!Q.parentCommentId)}}
Object(d.a)(fe,"WorkbookCommentRepliedEvent",x,[]);class qe extends x{constructor(){super()}get eventId(){return 33}Xb(){this.Nb(181)}eg(){this.ld(Q=>!Q.parentCommentId)}}Object(d.a)(qe,"WorkbookCommentedEvent",x,[]);class mf extends x{constructor(){super()}get eventId(){return 56}Xb(){this.Nb(128)}}Object(d.a)(mf,"WorkbookRecalculatedEvent",x,[]);class Me extends x{constructor(){super()}get eventId(){return 46}Xb(){this.Nb(171)}}Object(d.a)(Me,"WorkbookRedoEvent",x,[]);class Af extends x{constructor(){super()}get eventId(){return 45}Xb(){this.Nb(170)}}
Object(d.a)(Af,"WorkbookUndoEvent",x,[]);class Bf extends x{constructor(){super()}get eventId(){return 116}Xb(){this.Nb(507);this.Nb(576);this.Nb(10)}eg(){this.ld(Q=>{if(Object(W.a)(Y,Q)&&(Q=Object(O.a)(Y,Q),void 0!==Q.source&&null!==Q.source&&void 0!==Q.eventId&&null!==Q.eventId))return t.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${Q.source}; eventId: ${Q.eventId}.`),!0;t.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(d.a)(Bf,"DefaultRichApiRequestExecutedEvent",x,[]);class He extends x{constructor(){super()}get eventId(){return 216}Xb(){this.Nb(1022)}}Object(d.a)(He,"TablelAltTextEditedEvent",x,[]);class Cf extends x{constructor(){super()}get eventId(){return 217}Xb(){this.Nb(263)}}Object(d.a)(Cf,"FloatingObjectZOrderChangedEvent",x,[]);var Qf=a(958);class Qg extends x{constructor(){super()}get eventId(){return 192}Xb(){this.Nb(507)}eg(){this.ld(Q=>Object(W.a)(Qf.a,Q)?!0:!1)}}Object(d.a)(Qg,
"VisualPropertySetEvent",x,[]);class ah extends P{constructor(){super(219,[510])}}Object(d.a)(ah,"ChartSeriesDeletedEvent",P,[]);class ng extends x{get eventId(){return 220}Xb(){this.Nb(1027)}}Object(d.a)(ng,"ChartDataChangedEvent",x,[]);class Ya extends P{constructor(){super(221,[512])}}Object(d.a)(Ya,"ChartSeriesDataChangedEvent",P,[]);class yb{constructor(Q){this.yb=null;this.$=Q}get macroRecorderEvents(){this.yb||(this.yb=new m.a,this.yb.add(new dd),this.yb.add(new mb),this.yb.add(new wc),this.yb.add(new Ac),
this.yb.add(new bf),this.yb.add(new Wd),this.yb.add(new Dd),this.yb.add(new Kd),this.yb.add(new we),this.yb.add(new $a),this.yb.add(new Zb),this.yb.add(new Ae),this.yb.add(new cf),this.yb.add(new rc),this.yb.add(new Cd),this.yb.add(new lc),this.yb.add(new Pc),this.yb.add(new Ad),this.yb.add(new Ce),this.yb.add(new ef),this.yb.add(new Ob),this.yb.add(new gb),this.yb.add(new Hb),this.yb.add(new of),this.yb.add(new Rc),this.yb.add(new Jf),this.yb.add(new uc),this.yb.add(new zd),this.yb.add(new db),this.yb.add(new Qc),
this.yb.add(new zc),this.yb.add(new ae),this.yb.add(new qe),this.yb.add(new fe),this.yb.add(new Tb),this.yb.add(new Mc),this.yb.add(new Ge),this.yb.add(new Ue),this.yb.add(new mc),this.yb.add(new Pb),this.yb.add(new Tc),this.yb.add(new de),this.yb.add(new eb),this.yb.add(new xe),this.yb.add(new Me),this.yb.add(new Af),this.yb.add(new Ib),this.yb.add(new Oa),this.yb.add(new dc),this.yb.add(new Ee),this.yb.add(new ld),this.yb.add(new Sd),this.yb.add(new mf),this.yb.add(new zb),this.yb.add(new id),this.yb.add(new cc),
this.yb.add(new le),this.yb.add(new Da),this.yb.add(new Pa),this.yb.add(new Re),this.yb.add(new Pe),this.yb.add(new L),this.yb.add(new V),this.yb.add(new xc),this.yb.add(new Rb),this.yb.add(new Kc),this.yb.add(new yd),this.yb.add(new xd),this.yb.add(new Be),this.yb.add(new We),this.yb.add(new N),this.yb.add(new J),this.yb.add(new Ke),this.yb.add(new Ba),this.yb.add(new ea),this.yb.add(new C),this.yb.add(new ra),this.yb.add(new H),this.yb.add(new M),this.yb.add(new G),this.yb.add(new ca),this.yb.add(new Gd),
this.yb.add(new Ia),this.yb.add(new Bb),this.yb.add(new ed),this.yb.add(new Qd),this.yb.add(new Yb),this.yb.add(new vc),this.yb.add(new qa),this.yb.add(new aa),this.yb.add(new ia),this.yb.add(new wa),this.yb.add(new Od),this.yb.add(new Lb),this.yb.add(new bb),this.yb.add(new Ha),this.yb.add(new ze),this.yb.add(new ub),this.yb.add(new tb),this.yb.add(new Bc),this.yb.add(new Kb),this.yb.add(new Vb),this.yb.add(new Te),this.yb.add(new Oe),this.yb.add(new Hc),this.yb.add(new Cb),this.yb.add(new Jb),this.yb.add(new Mb),
this.yb.add(new Ic),this.yb.add(new td),this.yb.add(new Wc),this.yb.add(new X),this.yb.add(new ha),this.yb.add(new Jd),this.yb.add(new re),this.yb.add(new cb),this.yb.add(new Ab),this.yb.add(new Zd),this.yb.add(new xa),this.yb.add(new sd),this.yb.add(new Ka),this.yb.add(new F),this.yb.add(new ka),this.yb.add(new sa),this.yb.add(new za),this.yb.add(new fa),this.yb.add(new Xa),this.yb.add(new Oc),this.yb.add(new Za),this.yb.add(new ta),this.yb.add(new fb),this.yb.add(new Z),this.yb.add(new fc),this.yb.add(new lb),
this.yb.add(new Fa),this.yb.add(new Na),this.yb.add(new bc),this.yb.add(new I),this.yb.add(new xb),this.yb.add(new sb),this.yb.add(new De),this.yb.add(new Vd),this.yb.add(new rd),this.yb.add(new ua),this.yb.add(new hb),this.yb.add(new Qa),this.yb.add(new na),this.yb.add(new nb),this.yb.add(new pa),this.yb.add(new La),this.yb.add(new Ga),this.yb.add(new ya),this.yb.add(new kb),this.yb.add(new oa),this.yb.add(new ac),this.yb.add(new ib),this.yb.add(new Ra),this.yb.add(new U),this.yb.add(new ab),this.yb.add(new hc),
this.yb.add(new Ja),this.yb.add(new Ma),this.yb.add(new pb),this.yb.add(new Sa),this.yb.add(new Va),this.yb.add(new me),this.yb.add(new wb),this.yb.add(new $b),this.yb.add(new ee),this.yb.add(new hd),this.yb.add(new te),this.yb.add(new pe),this.yb.add(new ec),this.yb.add(new Vc),this.yb.add(new ud),this.yb.add(new ke),this.yb.add(new rf),this.yb.add(new oe),this.yb.add(new Ea),this.yb.add(new ad),this.yb.add(new qf),this.yb.add(new He),this.yb.add(new Cf),this.yb.add(new Qg),this.yb.add(new ah),this.yb.add(new Ya),
this.yb.add(new ng),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Dhj());return this.yb}w4e(Q,Ua){let Fb=this.x4e(Q,this.macroRecorderEvents,Ua);Fb||(Fb=this.x4e(Q,yb.U7h(),Ua),!Fb&&this.Ujf(Q,yb.tLe,Ua)&&(Fb=yb.tLe));return Fb}x4e(Q,Ua,Fb){const nc=new m.a;for(let Dc of Ua)this.Ujf(Q,Dc,Fb)&&nc.add(Dc);return 1===nc.count?nc.oa(0):1<nc.count?yb.$Ph(nc):null}Ujf(Q,Ua,Fb){const nc=yb.A2i(Q,Ua);return Fb?nc&&yb.x3j(Q,Ua):nc}Dhj(){const Q=new m.a;for(let Ua of this.yb){let Fb=
!1;for(let nc of Ua.featureGates)if(!y.EwaSettings.ma(nc)){Q.add(Ua);Fb=!0;break}if(!Fb)for(let nc of Ua.OWe)if(!y.EwaSettings.getBooleanFeatureGate(nc,!1)){Q.add(Ua);break}}for(let Ua of Q)this.yb.remove(Ua)}static U7h(){yb.iEb||(yb.iEb=new m.a,yb.iEb.add(new va),yb.iEb.add(new la));return yb.iEb}static A2i(Q,Ua){return Ua.operations.contains(Q.operation)}static x3j(Q,Ua){Ua=Ua.TEc;if(!Ua.count)return!0;let Fb=!0;for(let nc of Ua)if(!nc(Q.payload)){Fb=!1;break}return Fb}static $Ph(Q){let Ua=Q.oa(0);
for(let Fb of Q)Fb.TEc.count>Ua.TEc.count&&(Ua=Fb);return Ua}}yb.iEb=null;yb.tLe=new Bf;Object(d.a)(yb,"MacroRecorderEventList",null,[]);class Wb extends h.a{constructor(Q){super();this.$=Q;this.Fb()}create(){this.ob(this.$.da.za(297)||new A(this.$,new yb(this.$),new v))}static ka(Q){Q.da.Ga(298,new Wb(Q))}}Object(d.a)(Wb,"MacroRecorderEventHandlerFactory",h.a,[]);var Cc=a(1146),Uc=a(1240),jd=a(7);a(558);class Bd{constructor(){this.$tg=new m.a}get $2b(){return this.$tg}K_h(Q){t.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",Q);const Ua=new m.a;for(let Fb of this.$2b)for(let nc of Fb.zFb)nc.id===Q&&Ua.add(nc);return Ua}qpe(Q){this.$2b.add(Q)}yhj(Q){for(let Ua of this.$2b)if(Ua.ste===Q.ste){this.$2b.remove(Ua);break}}static onh(Q,Ua,Fb=null){Q=Bd.GSh(Q);0<Q.length&&(Bd.myc(Q,!1),Fb&&Fb(Ua,Q))}static GSh(Q){const Ua=[];if(Q&&Q.zFb&&0<Q.zFb.count)for(let Fb of Q.zFb)if(Fb.controls&&0<Fb.controls.count)for(let nc of Fb.controls)if(nc.menuItems&&0<nc.menuItems.count)for(let Dc of nc.menuItems)Array.add(Ua,
Dc.id);return Ua}static myc(Q,Ua){if(Q.length){var Fb=[];for(const nc of Q)Fb.push(appChrome.actions.updateControlEnabledDisabledState(nc,Ua));appChrome.api.dispatch(Fb)}}}Object(d.a)(Bd,"ContextMenuExtensibilityCache",null,[767,768]);var he=a(1464),be=a(84),pd=a(4),Ze=a(863),hf=a(812);class k{CZa(Q,Ua=null){if(Q=hf.a.t4a(Q)){appChrome.addInApi.dispatchActionsToInstallAddIn(Q,Ua);for(const Fb of Q.tabs)if(Fb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Q,()=>{});break}}}ZLd(Q){(Q=
hf.a.t4a(Q))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(Q)}static wnh(Q,Ua,Fb=null){Q=k.M2h(Q);0<Q.length&&(k.myc(Q,!1),Fb&&Fb(Ua,Q))}static M2h(Q){const Ua=[];if(Q&&(Q=Q.gW,Q.kt&&0<Q.kt.count))for(let Fb of Q.kt)if(Fb.groups&&0<Fb.groups.length)for(const nc of Fb.groups)if(nc.controls&&0<nc.controls.length)for(const Dc of nc.controls)Array.add(Ua,Dc.id);return Ua}static myc(Q){if(Q.length){var Ua=[];for(const Fb of Q)Ua.push(appChrome.actions.updateControlEnabledDisabledState(Fb,!0));appChrome.api.dispatch(Ua)}}}
Object(d.a)(k,"OneLineRibbonExtensibilityManager",null,[788]);var Qb=a(933);class tc{constructor(){this.g6d=this.uGc=null}get HVc(){return this.uGc||(this.uGc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set HVc(Q){this.uGc=Q}get YUg(){return this.g6d||(this.g6d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(Q,Ua){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(Q,Ua)}getTaskPaneControlIdFromAssetIdRuntimeId(Q,
Ua){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(Q,Ua)}wkd(Q,Ua,Fb,nc,Dc,cd=null,kd=null){t.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",Q);if((Q=Ua.sja(Dc.ownerAddinInfo.storeType,Dc.ownerAddinInfo.solutionId))&&Q.QB&&!Q.QB.getIsUpgrading())if(Ua=null,0<Q.QB.getNotificationParams().length&&(Ua=this.Xye(Q.QB.getNotificationParams()[0]))&&2147758681===Ua.errorCode&&(Q.isUpgraded=!0),2!==Q.QB.getStatus()&&(1!==Q.QB.getStatus()||Ua&&2147758681===Ua.errorCode))Ua&&
this.g8f(Q,Ua,kd);else try{Fb.setOwnerAddinEToken(Q.QB.getEToken()),Dc.action(Fb,nc.hda),cd&&cd()}catch(qd){t.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",pd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?qd.stack:qd.message)),Qb.a.UUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}g8f(Q,Ua,Fb=null){const nc=Q.QB;if(1===nc.getNotificationParams().length||Ua.Nfc){const Dc=
Ua.Rha,cd=Ua.Ria;Ua.Rha=()=>{nc.removeFirstNotification();if(0<nc.getNotificationParams().length){const kd=this.Xye(nc.getNotificationParams()[0]);this.g8f(Q,kd)}2147758681===Ua.errorCode&&(k.wnh(Q.So,nc,Object(be.a)(this,this.vef,"initUpgradeStateDetectTask")),Bd.onh(Q.hsb,nc,Object(be.a)(this,this.vef,"initUpgradeStateDetectTask")));Dc&&Dc()};Ua.Ria=()=>{cd&&cd();Fb&&Fb()};Qb.a.WUd(Ua)}}vef(Q,Ua){let Fb=null;Fb=()=>{Q.getIsUpgrading()?window.setTimeout(Fb,1E3):Q.getUpgradingFailed()?k.myc(Ua,!0):
pd.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Fb,1E3)}Xye(Q){const Ua=new Ze.a;Ua.LMa=Q.infoType;Ua.id=Q.id;Ua.title=Q.title;Ua.description=Q.description;Ua.buttonText=Q.buttonTxt;Ua.Rha=Q.buttonCallback;Ua.Nfc=Q.highPriority;Ua.Ria=Q.dismissCallback;Ua.errorCode=Q.errorCode;Ua.udf=Q.iframeNotificationUrl;return Ua}}Object(d.a)(tc,"AddinCommandsActionHandler",null,[766]);var Jc=a(83),od=a(157),Hd=a(692),Md=a(5),ce=a(736),ne=a(693);class Qe{constructor(Q,Ua){this.Va=Q;this.S9g=Ua}jNh(Q){if(void 0!==
Q&&null!==Q&&Q===Md.a.vGe)Q="ContextMenuCell";else return null;const Ua=this.Va.Ec();this.BMh(Ua,Q);return Ua}BMh(Q,Ua){Ua=this.S9g.K_h(Ua);for(let Fb of Ua){Ua=Fb.controls;for(let nc of Ua)this.oMh(Q,nc)}}oMh(Q,Ua){var Fb=Ua.rU[ce.a.id];const nc=Ua.rU[ce.a.DVa],Dc=Ua.rU[ce.a.HVa];let cd="Image16by16",kd=Ua.rU[ce.a.EVa];ne.c(Dc)&&(cd="None");0<Ua.menuItems.count?(Fb=this.Va.ww(Fb,Fb,nc,798637440),Fb.AMb(cd,Dc,null),this.hNh(Fb.menu,Ua),Q.buttons.push(Fb)):Q.buttons.push(this.Va.LIa(Fb,nc,kd,Dc,cd,
null,!1))}hNh(Q,Ua){const Fb=this.Va.Ec();for(let nc of Ua.menuItems){Ua=nc.ima[ce.a.id];const Dc=nc.ima[ce.a.DVa],cd=nc.ima[ce.a.HVa];let kd="Image16by16";const qd=nc.ima[ce.a.EVa];ne.c(cd)&&(kd="None");Ua=this.Va.LIa(Ua,Dc,qd,cd,kd,null,!1);Fb.buttons.push(Ua)}Q.tc.push(Fb)}}Object(d.a)(Qe,"AddInCommandsContextMenuExtensibilityHandler",null,[770]);var Le=a(858);class Ff{constructor(){this.ti=null;this.visible=!1}}Object(d.a)(Ff,"AddinStatusCommandValues",null,[]);class Sf{static D$i(Q){const Ua=
new Ff;Ua.ti=Q.WZa;Ua.visible=Ua.ti?!0:!1;return Ua}static $zc(Q,Ua,Fb,nc,Dc){const cd=document.getElementById(Fb);cd?Sf.VIj(Q,Ua,cd,nc,Dc):t.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Fb))}static VIj(Q,Ua,Fb,nc,Dc){Fb?Q.WZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Qb.a.GHj(Ua,Fb,nc,Dc):Q.WZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Qb.a.$Ij(Ua,Fb):t.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(d.a)(Sf,"AddinCommandsStatusHandler",null,[]);var jg=a(38),Xf=a(226),ff=a(13);class Xg extends jg.a{constructor(Q,Ua){super();this.agaveCommandManager=this.statusBarManager=null;this.lDe=()=>{this.pG&&this.pG.QCe()};this.N9e=()=>{this.raiseEvent("LAC")};this.Tc=(Fb,nc)=>{!Fb.Zb&&Xf.b(nc)&&this.statusBarManager&&(this.statusBarManager.lG(this),this.statusBarManager=null)};this.pG=Ua;this.$=Q;this.XNj=Q.Eb+"OfficeAddinLabel-Medium14";this.$.da.$a(29,Fb=>{this.statusBarManager=Fb;Fb.JJ(this)});
this.$.ea.Tj(this.Tc);this.pG.FLg(this.N9e);this.$.da.$a(206,Fb=>{this.agaveCommandManager=Fb;Fb.fNg(this.lDe)})}Mq(Q){this.addHandler("LAC",Q)}hr(Q){this.removeHandler("LAC",Q)}rs(Q,Ua){if("QueryAddinLabel"!==Q)return!1;Ua[Le.a.LabelText]!==this.pG.WZa&&(Q=Sf.D$i(this.pG),Ua[Le.a.LabelText]=Q.ti,Ua[Le.a.Visible]=Q.visible,window.setTimeout(()=>{this.$zc()},0));return!0}Hn(){return!0}$zc(){this.$&&Sf.$zc(this.pG,this.$.domElement,this.XNj,ff.a.instance.ga(333),ff.a.instance.ga(334))}dispose(){this.$.ea.qk(this.Tc);
this.pG.Iij(this.N9e);this.agaveCommandManager&&(this.agaveCommandManager.Vjj(this.lDe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.lG(this),this.statusBarManager=null);this.pG=this.$=null;super.dispose()}}Object(d.a)(Xg,"AddinCommandsStatusBarManager",jg.a,[161,162]);var Ah=a(1316),ue=a(718),Wf=a(147),Aa=a(120),Ca=a(570),sc=a(137);class vd{constructor(){this.VZa=null}setErrorMessageForAddin(Q,Ua){this.VZa||(this.VZa={});this.VZa[Q]=Ua}iVh(Q){return this.VZa&&Q in
this.VZa?this.VZa[Q]:null}}Object(d.a)(vd,"AddinCommandsErrorManager",null,[]);var Td=a(333),ye=a(96);class df{constructor(){this.$q=this.qO=0;this.WXc=null;this.btc=this.DCc=0;this.gqa=this.hLc=this.MGc=this.x5b=this.Mja=this.m$=null}get VXc(){this.MGc||(this.MGc=new m.a);return this.MGc}get jed(){this.hLc||(this.hLc=new m.a);return this.hLc}get CIa(){this.gqa||(this.gqa=new m.a);return this.gqa}}Object(d.a)(df,"AddinCommandsListLoaderContext",null,[]);var Kf=a(816);class Tf{}Object(d.a)(Tf,"AppsForOfficeEntitlementQueryInfo",
null,[]);var Mf=a(41);const pg=Q=>{const Ua={};Ua.solutionId=Q.solutionId;Ua.version=Q.version;Ua.storeType=Q.storeType;Ua.storeId=Q.storeId;Ua.assetId=Q.assetId;Ua.assetStoreId=Q.assetStoreId;Ua.targetType=Q.targetType;Ua.requireConsent=Q.requireConsent||!1;Ua.isAddinCommands=!0;Ua.addinCommandsActionType=0;return Ua};class Zf{constructor(Q,Ua){this.entitlement=Q;this.metadata=Ua}Ydg(){const Q=pg(this.entitlement);Q.targetType=this.targetType;return Q}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(d.a)(Zf,"AddinEntitlementEx",null,[]);var wg=a(256),fg=a(30);class Lg{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(d.a)(Lg,"AddinAbstract",null,[]);class sg extends Sys.EventArgs{constructor(){super();
this.So=this.kk=null}}Object(d.a)(sg,"InsertionParamEventArgs",Sys.EventArgs,[]);class gg{constructor(Q,Ua,Fb,nc=null){this.gLb=pd.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=Q;this.Mjb=Ua;this.Ijb=Fb;this.Rlb=nc}M$b(Q){const Ua=new Sys.StringBuilder(this.gLb);Ua.append("RoamingServiceHandler.ashx?action=");Ua.append("getAddinTeachingCalloutSettings");Ua.append("&");Ua.append(this.pid(Q));Ua.append("&");Ua.append(pd.AFrameworkApplication.Zi);pd.AFrameworkApplication.Bd.Rm(Ua.toString(),
1,null,null,!0,2,Object(be.a)(this,this.oka,"getRequestSuccessCallback"),Object(be.a)(this,this.L4,"getRequestFailureCallback"),null)}G3a(Q){var Ua=new Sys.StringBuilder(this.gLb);Ua.append("RoamingServiceHandler.ashx?action=");Ua.append("saveAddinTeachingCalloutSettings");Ua.append("&");Ua.append(pd.AFrameworkApplication.Zi);Ua=Ua.toString();Q=Mf.c(Q);pd.AFrameworkApplication.Bd.Rm(Ua,2,Q,null,!0,4,null,Object(be.a)(this,this.uW,"postRequestFailureCallback"),null)}oka(Q){let Ua=!1,Fb=null;try{if(0<
Q.data.te.length){const nc=Object(O.a)(Object,Mf.a(Q.data.te)),Dc=nc?nc[this.appName]:null;Dc&&(Fb=Object(O.a)(Object,Mf.a(Dc.toString())))}Ua=!0}catch(nc){this.L4(null)}Ua&&this.Mjb&&this.Mjb(Fb)}L4(Q){this.Ijb&&this.Ijb(Q?Q.data:null)}uW(Q){this.Rlb&&this.Rlb(Q?Q.data:null)}pid(Q){const Ua=new Sys.StringBuilder("requestedsettings=");for(let Fb=0;Fb<Q.count;Fb++)Ua.append(Q.oa(Fb)),Fb<Q.count-1&&Ua.append(";");return Ua.toString()}}Object(d.a)(gg,"AddinTeachingUIRoamingRequestHandler",null,[]);class lh extends Sys.EventArgs{constructor(Q){super();
this.solutionId=Q.solutionId;this.assetId=Q.assetId;this.storeType=Q.storeType;this.storeId=Q.storeId;this.assetStoreId=Q.assetStoreId;this.targetType=Q.targetType;this.width=Q.width;this.height=Q.height;this.displayName=Q.displayName;this.version=Q.version}}Object(d.a)(lh,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Hf=a(344);class Mg{constructor(Q){this.YZa=this.kk=null;this.ZRa=!1;this.gqa=this.lSb=this.qna=this.Wh=this.OX=this.BO=null;this.Sa=Q}get appName(){return pd.AFrameworkApplication.fa.Xa("WebAppShortName")}get Lob(){this.OX||
(this.OX=new gg(this.appName,Object(be.a)(this,this.oka,"getRequestSuccessCallback"),Object(be.a)(this,this.L4,"getRequestFailureCallback"),Object(be.a)(this,this.uW,"postRequestFailureCallback")));return this.OX}get Dsa(){this.lSb||(this.lSb=new m.a);return this.lSb}set Dsa(Q){this.lSb=Q}get CIa(){this.gqa||(this.gqa=new m.a);return this.gqa}set CIa(Q){this.gqa=Q}DWc(Q,Ua){window.addEventListener?(this.kk=Q,this.YZa=Ua,window.addEventListener("LaunchAddinTaskpane",Object(be.a)(this,this.PDd,"onLaunchButtonClickedEventHandler"),
!0),window.addEventListener("DismissCallout",Object(be.a)(this,this.XCd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(be.a)(this,this.ICd,"onCloseButtonClickedEventHandler"),!0),pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(be.a)(this,this.MFb,"onCampaignLaunchedHandler"),!0)):t.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}YUj(Q,
Ua,Fb,nc){this.Wh=Q;this.Dsa=Ua;this.CIa=Fb;this.qna=nc;t.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Ua?Ua.count.toString():"null",Fb?Fb.count.toString():"null");0<this.Dsa.count||0<this.CIa.count?(Q=new m.a,Q.add(this.appName),this.Lob.M$b(Q)):this.qna(new m.a,null)}PDd(){const Q=new wg.ScriptSharpLegacyMap;this.YZa&&this.YZa.tabs&&!this.YZa.tabs[0].isOfficeTab&&Q.ia("SDX.FeatureFlags","NonOfficeTab");this.Vla(Mg.mV(this.kk),
"ClickOnLaunch",Q);pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.fma();this.YZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.YZa,()=>{const Ua=new sg;Ua.kk=this.kk;this.Sa.raiseEvent(ue.a.Cvd,Ua)}):t.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}ICd(){this.Vla(Mg.mV(this.kk),"ClickOnClose");pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.fma()}XCd(){this.Vla(Mg.mV(this.kk),"ClickOnDismiss");pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.fma()}MFb(Q){if(Q&&(Q=Q.detail)&&Q.id&&this.zpd(Q.id)){const Ua=(Q.action||"").toLowerCase();if(Q.success&&"opened"===Ua)this.Vla(Mg.mV(this.kk),"CampaignLaunched"),t.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.fma(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(be.a)(this,this.MFb,"onCampaignLaunchedHandler"),!0);else{let Fb;try{Fb=JSON.stringify(Q),t.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Fb)}catch(nc){Fb="id : "+Q.id+" telemetryEventName: "+Q.telemetryEventName,t.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Fb+" Error: "+(nc?nc.toString():""))}}}}zpd(Q){Q=fg.a.vl(Q);return-1!==Q.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==Q.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==Q.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==Q.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==Q.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==Q.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}K7(Q){if(this.appName){const Ua={},Fb={};Fb.LastTeachingUIShowTime=(new Date).toUTCString();Fb.AddinHasShown=Q;Ua[this.appName]=Mf.c(Fb);this.Lob.G3a(Ua);t.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else t.ULS.sendTraceTag(539530528,220,10,
"Fail to save roaming service since AppName is null")}fma(){if(!this.ZRa){const Q=window.g_roamingAddinList;Q&&(this.K7(Q),this.ZRa=!0)}}oka(Q){Q?this.KUd(Q)?(t.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.BO="AddinHasShown"in Q&&Q.AddinHasShown?Q.AddinHasShown.toString():null,this.Urb()):(t.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.qna(this.Dsa,null)):(t.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.BO=null,this.Urb())}L4(Q){t.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",Q?Q.httpStatus:-1);this.qna(this.Dsa,null)}uW(Q){t.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",Q?Q.httpStatus:-1)}Urb(){const Q=this.v8c();0===Q.targetType?(Q.solutionId?this.$Id(Q):this.Vla(null,"NoSolutionId"),this.ijg(Q),this.qna(this.Dsa,null)):this.qna(this.Dsa,Q);t.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",Q.addinId)}$Id(Q){const Ua=new Tf;
Ua.callbackFunc=Fb=>{if(Fb.errorCode){if(this.Vla(Q.solutionId,"FailToGetAppDetails"),pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var nc=window.g_roamingAddinList;nc&&this.K7(nc)}}else if(Fb.value)for(nc of Fb.value){var Dc=nc[1];if(Dc===Q.solutionId){Fb={};Fb.solutionId=Dc;Fb.assetId=nc[5];Dc=pd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Fb.storeType=Dc?nc[12]:nc[6];pd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?
Fb.storeId=Q.storeId:Fb.storeId=nc[11];Fb.assetStoreId=nc[6];Fb.targetType=nc[3];Fb.width=nc[7];Fb.height=nc[8];Fb.displayName=nc[0];Fb.version=nc[4];t.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",Q.solutionId);nc=new lh(Fb);this.Sa.raiseEvent(ue.a.aVd,nc);break}}};Ua.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ua.fromInsertDialog=!1;Ua.refresh=!1;this.Wh.queryEntitlementDetails(Ua)}KUd(Q){if("LastTeachingUIShowTime"in Q){if(Q=+new Date-+new Date(Q.LastTeachingUIShowTime.toString()),
Q<pd.AFrameworkApplication.fa.lN("AddinShowTeachingUIIntervalInMS",864E5))return t.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",Q),!1}else t.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}v8c(){let Q=new Td.a(new Lg,0),Ua=new Td.a(new Lg,0),Fb=0,nc=0,Dc=0;var cd=new m.a;for(var kd of this.Dsa)cd.add(kd);for(let qd of this.CIa)cd.add(qd);for(let qd of cd)if(!("excatalog"!==qd.storeType||ne.c(qd.installTimeInMS)||!qd.installTimeInMS||
qd.installTimeInMS<=pd.AFrameworkApplication.fa.lN("DateTimeInMSForNewAddin",16409952E5))){cd=Mg.kwb(qd);if(this.BO&&(kd=this.BO.split(","),0<kd.length&&Array.contains(kd,cd))){Dc++;t.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}cd.startsWith("private_")?(Q=Mg.h4e(qd,Q),nc++):(Ua=Mg.h4e(qd,Ua),Fb++)}t.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",nc,Fb,Dc);return 0<Ua.value?
Ua.key:0<Q.value?Q.key:Object.assign(new Lg,{addinId:null,targetType:-1,solutionId:null,storeId:null})}Vla(Q,Ua,Fb=null){Q={["AppTeachingUICalloutAction"]:Ua,["SDX.Id"]:Q,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Fb)for(let nc of Fb.keys)Q[nc]=Fb.oa(nc);Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}))}ijg(Q){Q&&(Q=this.BO?this.BO+","+Q.addinId:Q.addinId,pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=Q:this.K7(Q))}static mV(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static h4e(Q,Ua){return Ua.value<Q.installTimeInMS?new Td.a(Object.assign(new Lg,{addinId:Mg.kwb(Q),targetType:Q.targetType,storeId:Q.storeId,solutionId:Q.solutionId}),Q.installTimeInMS):Ua}static kwb(Q){return Telemetry.PrivacyRules.IsPrivateAddin(Q.storeType,Q.assetId,null,null,Q.storeId)?"private_"+Q.installTimeInMS:Q.solutionId}}Object(d.a)(Mg,
"PrivateCatalogTeachingCalloutHandler2",null,[]);var Rg=a(80);const Ng=()=>{const Q=Rg.a.ZZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!Q&&"4"===Q},Og=()=>Rg.a.ZZ(window.location.href.toLowerCase(),"wdtpl"),Sg=()=>{const Q=Rg.a.ZZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!Q&&"1"===Q},Wg=Q=>{let Ua=null;switch(Q){case 0:Ua="omex";break;case 1:Ua="spcatalog";break;case 2:Ua="spapp";break;case 3:Ua="filesystem";break;case 4:Ua="exchange";break;case 6:Ua="registry";break;
case 7:Ua="inmemory";break;case 8:Ua="uploadfiledevcatalog";break;case 9:Ua="hardcodedpreinstall";break;case 10:Ua="excatalog";break;case 16:Ua="wopicatalog"}return Ua},mh=Q=>{let Ua=-1;switch(Q.toLowerCase()){case "omex":Ua=0;break;case "spcatalog":Ua=1;break;case "spapp":Ua=2;break;case "filesystem":Ua=3;break;case "exchange":Ua=4;break;case "registry":Ua=6;break;case "inmemory":Ua=7;break;case "uploadfiledevcatalog":Ua=8;break;case "hardcodedpreinstall":Ua=9;break;case "excatalog":Ua=10;break;
case "wopicatalog":Ua=16}return Ua};var nh=a(681);class wh{constructor(Q){this.Zr=null;this.KA=Q}get_current(){if(!this.Zr)throw Error.argumentOutOfRange();return this.Zr.data}moveNext(){if(!this.Zr)return this.Zr=this.KA,!!this.KA;if(!this.Zr.next)return!1;this.Zr=this.Zr.next;return!0}ync(){if(!this.Zr)return this.Zr=this.KA,!!this.KA;if(!this.Zr.previous)return!1;this.Zr=this.Zr.previous;return!0}reset(){this.Zr=this.KA}}Object(d.a)(wh,"ListEnumerator",null,[0]);class qh{constructor(Q,Ua,Fb){this.next=
Fb;this.previous=Ua;this.data=Q}}Object(d.a)(qh,"ListNode",null,[]);class rh{constructor(){this.QA=this.Bq=null;this._count=0}add(Q){this.Bq?this.QA=this.QA.next=new qh(Q,this.QA,null):this.Bq=this.QA=new qh(Q,null,null);this._count=this.count+1}insert(Q,Ua){if(Q>this.count||0>Q)throw Error.argumentOutOfRange("pos");if(Q===this.count)this.add(Ua);else{for(var Fb=this.Bq;0!==Q--;)Fb=Fb.next;Q=new qh(Ua,Fb.previous,Fb);Q.previous?Q.previous.next=Q:this.Bq=Q;Q.next?Q.next.previous=Q:this.QA=Q;this._count=
this.count+1}}remove(Q){let Ua=this.Bq;for(;Ua&&Ua.data!==Q;)Ua=Ua.next;if(!Ua)return!1;Ua.previous?Ua.previous.next=Ua.next:this.Bq=Ua.next;Ua.next?Ua.next.previous=Ua.previous:this.QA=Ua.previous;this._count=this.count-1;return!0}clear(){let Q=this.Bq,Ua;for(this.QA=this.Bq=null;Q;)Ua=Q.next,Q.previous=null,Q.next=null,Q=Ua;this._count=0}indexOf(Q){let Ua=this.Bq,Fb=0;for(;Ua&&Ua.data!==Q;)Ua=Ua.next,Fb++;return Ua?Fb:-1}oa(Q){return this.at(Q).data}get count(){return this._count}getEnumerator(){return new wh(this.Bq)}[Symbol.iterator](){return Object(nh.a)(this.getEnumerator())}Gcc(Q){Q=
this.at(Q);return new wh(Q)}toArray(){const Q=Array(this.count);let Ua=0;for(let Fb of this)Q[Ua]=Fb,Ua++;return Q}at(Q){let Ua=this.Bq,Fb=0;for(;Fb!==Q;){if(!Ua)throw Error.argumentOutOfRange("pos");Ua=Ua.next;Fb++}return Ua}}Object(d.a)(rh,"List",null,[1]);class Tg extends Sys.EventArgs{constructor(Q){super();this.properties=Q}}Object(d.a)(Tg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class gh{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}
Object(d.a)(gh,"MiniAddinInfo",null,[]);class sf{constructor(Q,Ua,Fb){this.Sa=new ye.a;this.context=new df;this.iUc=this.$ag=this.CWd=this.VGa=this.BO=this.OX=null;this.contextActivationMgr=Q;this.BPg=Ua;this.WGa=Fb;this.appName=pd.AFrameworkApplication.fa.Xa("WebAppShortName")}get YOb(){this.iUc||(this.iUc=new Mg(this.Sa));return this.iUc}DLg(Q){this.Sa.addHandler(ue.a.Hob,Q)}XOg(Q){this.Sa.addHandler(ue.a.aVd,Q)}sWj(Q){null!==Q&&(this.context.qO=Q[ue.a.n$],this.context.$q=Q[ue.a.NP],this.context.DCc=
this.context.btc=0,Q=ue.a.XGa in Q?Q[ue.a.XGa]:0,-1!==this.context.qO&&0!==this.context.$q&&(this.context.m$=new rh,this.context.Mja=new rh,this.context.x5b=new rh,this.context.WXc=this.BPg.createAddinDataProvider(Wg(this.context.qO),this.contextActivationMgr),this.context.WXc?this.context.WXc.getEntitlementsAsync(this.contextActivationMgr.hda,!0,Q,Ua=>{this.bWi(Ua)}):t.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.qO)))}bWi(Q){if(Q&&0<Q.length){this.context.DCc=
Q.length;const Fb=pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Og():null;for(let nc=0;nc<Q.length;nc++){const Dc=Q[nc];if(pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Sg()&&Dc&&Dc.storeType&&"omex"===Dc.storeType.toLowerCase()&&Dc.assetId&&Fb&&Dc.assetId.toLowerCase()===Fb.toLowerCase()){var Ua={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:sf.mV(Dc)};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj(Ua)}))}!Dc||1!==Dc.targetType&&-1!==Dc.targetType?this.Doc():(Ua={},pd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ua.solutionId=Dc.solutionId,Ua.version=Dc.version):(Ua.marketplaceId=Dc.solutionId,Ua.marketplaceVersion=Dc.version),Ua.storeType=Dc.storeType,Ua.storeId=Dc.storeId,Ua.targetData=Dc,sf.ZOb?this.contextActivationMgr.isAddinCommandsExAsync(Ua,
Object(be.a)(this,this.xVi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Ua,(cd,kd,qd)=>{cd?(kd&&this.context.m$.add(qd.targetData),10===this.context.qO&&(cd=qd.targetData,kd=cd.targetType,ne.c(qd.targetTypeForExp)||(kd=qd.targetTypeForExp,cd.targetType=kd),this.context.Mja.add(cd),0===kd&&this.context.x5b.add(cd))):(qd=qd.targetData,t.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(qd.solutionId,
qd.storeType,qd.assetId,null,null,qd.storeId),qd.storeType));this.Doc()}))}}else this.Doc()}Doc(){var Q;(Q=this.context).btc=Q.btc+1;this.context.btc>=this.context.DCc&&(this.WGa.A2f(this.context.qO,!1),0<this.context.DCc&&10===this.context.qO&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(Q=!1,pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Ng()&&(Q=this.iCi()),this.vBi(),pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!Q?sf.ZOb?this.YOb.YUj(this.contextActivationMgr,this.context.VXc,this.context.CIa,(Ua,Fb)=>{const nc=new m.a;for(let Dc of Ua)Ua=Dc.Ydg(),Fb&&Fb.solutionId===Dc.solutionId&&(Ua.showCallout=!0,this.YOb.ijg(Fb)),nc.add(Ua);this.qna(nc)}):this.TOh(this.context.m$):this.F_b(this.context.m$)):this.F_b(this.context.m$))}F_b(Q){if(sf.ZOb)this.qna(this.p8g(this.context.VXc));else{var Ua=new m.a;if(Q)for(let Fb of this.context.m$)Ua.add(pg(Fb));this.context.m$&&1>this.context.m$.count&&Kf.a.lgb(ue.a.Iob,
"false",this.context.qO);Q={["ack2"]:Ua};Q[ue.a.n$]=this.context.qO;Q[ue.a.NP]=this.context.$q;this.Sa.raiseEvent(ue.a.Hob,new Tg(Q),this)}}p8g(Q){const Ua=new m.a;if(Q)for(let Fb of Q)Ua.add(Fb.Ydg());return Ua}qna(Q){Q&&Q.count||Kf.a.lgb(ue.a.Iob,"false",this.context.qO);Q={["ack2"]:Q};Q[ue.a.n$]=this.context.qO;Q[ue.a.NP]=this.context.$q;this.Sa.raiseEvent(ue.a.Hob,new Tg(Q),this)}K7(Q){if(this.appName){const Ua={},Fb={};Fb.LastTeachingUIShowTime=(new Date).toUTCString();Fb.AddinHasShown=Q;Ua[this.appName]=
Mf.c(Fb);this.OX&&(this.OX.G3a(Ua),t.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else t.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}TOh(Q){(this.VGa=Q)?(Q=new m.a,Q.add(this.appName),this.OX=new gg(this.appName,Object(be.a)(this,this.oka,"getRequestSuccessCallback"),Object(be.a)(this,this.L4,"getRequestFailureCallback"),Object(be.a)(this,this.uW,"postRequestFailureCallback")),
this.OX.M$b(Q)):(Q={["ack2"]:new m.a},Q[ue.a.n$]=this.context.qO,Q[ue.a.NP]=this.context.$q,this.Sa.raiseEvent(ue.a.Hob,new Tg(Q),this))}oka(Q){Q?this.KUd(Q)?(t.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.BO="AddinHasShown"in Q&&Q.AddinHasShown?Q.AddinHasShown.toString():null,this.Urb()):(t.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.F_b(this.VGa)):(t.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.BO=null,this.Urb())}L4(Q){t.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",Q?Q.httpStatus:-1);this.F_b(this.VGa)}uW(Q){t.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",Q?Q.httpStatus:-1)}Urb(){const Q=this.v8c();if(0===Q.targetType){Q.solutionId?(this.CWd=Q.solutionId,this.$ag=Q.storeId,this.$Id()):this.Vla("NoSolutionId");if(Q.addinId){const Ua=this.BO?this.BO+","+Q.addinId:Q.addinId;pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=Ua:this.K7(Ua)}this.Ppe(null)}else this.Ppe(Q.addinId);t.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",Q.addinId)}$Id(){const Q=new Tf;Q.callbackFunc=Ua=>{if(Ua.errorCode){if(this.Vla("FailToGetAppDetails"),pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Fb=window.g_roamingAddinList;Fb&&this.K7(Fb)}}else if(Ua.value)for(Fb of Ua.value){var nc=Fb[1];if(nc===this.CWd){Ua={};Ua.solutionId=
nc;Ua.assetId=Fb[5];nc=pd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Ua.storeType=nc?Fb[12]:Fb[6];pd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Ua.storeId=this.$ag:Ua.storeId=Fb[11];Ua.assetStoreId=Fb[6];Ua.targetType=Fb[3];Ua.width=Fb[7];Ua.height=Fb[8];Ua.displayName=Fb[0];Ua.version=Fb[4];Fb=new lh(Ua);this.Sa.raiseEvent(ue.a.aVd,Fb);break}}};Q.storeType=OSF.StoreTypeEnum.PrivateCatalog;Q.fromInsertDialog=!1;Q.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(Q)}KUd(Q){if("LastTeachingUIShowTime"in
Q){if(Q=+new Date-+new Date(Q.LastTeachingUIShowTime.toString()),Q<pd.AFrameworkApplication.fa.lN("AddinShowTeachingUIIntervalInMS",864E5))return t.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",Q),!1}else t.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}v8c(){let Q=new Td.a(new gh,0),Ua=new Td.a(new gh,0),Fb=0,nc=0,Dc=0;var cd=new rh;if(0<this.context.m$.count)for(var kd of this.context.m$)cd.add(kd);if(0<this.context.x5b.count)for(let qd of this.context.x5b)cd.add(qd);
for(let qd of cd)if(!("excatalog"!==qd.storeType||ne.c(qd.installTimeInMS)||!qd.installTimeInMS||qd.installTimeInMS<=pd.AFrameworkApplication.fa.lN("DateTimeInMSForNewAddin",16409952E5))){cd=sf.kwb(qd);if(this.BO&&(kd=this.BO.split(","),0<kd.length&&Array.contains(kd,cd))){Dc++;t.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}cd.startsWith("private_")?(Q.value<qd.installTimeInMS&&(Q=new Td.a(Object.assign(new gh,{addinId:cd,targetType:qd.targetType,storeId:qd.storeId,
solutionId:qd.solutionId}),qd.installTimeInMS)),nc++):(Ua.value<qd.installTimeInMS&&(Ua=new Td.a(Object.assign(new gh,{addinId:cd,targetType:qd.targetType,storeId:qd.storeId,solutionId:qd.solutionId}),qd.installTimeInMS)),Fb++)}t.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",nc,Fb,Dc);return 0<Ua.value?Ua.key:0<Q.value?Q.key:Object.assign(new gh,{addinId:null,targetType:-1,solutionId:null,storeId:null})}Ppe(Q){const Ua=
new m.a;for(let nc of this.VGa){const Dc=pg(nc);if(Q){var Fb=sf.kwb(nc);Q===Fb&&(Dc.showCallout=!0,Fb=this.BO?this.BO+","+Q:Q,pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Fb:this.K7(Fb))}Ua.add(Dc)}this.VGa&&1>this.VGa.count&&Kf.a.lgb(ue.a.Iob,"false",this.context.qO);Q={["ack2"]:Ua};Q[ue.a.n$]=this.context.qO;Q[ue.a.NP]=this.context.$q;this.Sa.raiseEvent(ue.a.Hob,new Tg(Q),this)}iCi(){if(sf.ZOb)return this.jCi(this.context.jed);
var Q=!1;if(this.context.Mja&&1>this.context.Mja.count)return Q;const Ua=Og();if(!Ua)return Q;for(let Fb of this.context.Mja)if(Fb.storeId&&Fb.storeId.toLowerCase()===Ua.toLowerCase()||Fb.assetId&&Fb.assetId.toLowerCase()===Ua.toLowerCase())Q={["SDX_Id"]:sf.mV(Fb),["SDX_TargetType"]:ne.c(Fb.targetType)?"":Fb.targetType.toString()},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Aa.a.Vj(Q)})),Q=!0;return Q}vBi(){if(sf.ZOb)this.wBi(this.context.jed);
else if(!(this.context.Mja&&1>this.context.Mja.count))if(this.WGa.Qjf()){var Q=this.WGa.a6e();Q?(Q=this.N1e(this.context.Mja,Q),t.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(Q=this.N1e(this.context.Mja,null),t.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.WGa.a5f(Q)}else t.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}N1e(Q,Ua){const Fb={};let nc=!1;for(let Dc of Q)if(Q=sf.mV(Dc))!Ua||Q in Ua||(this.yya(Dc,Q),t.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===Q.toLowerCase()?nc||(nc=!0,Fb[Q]=null):Fb[Q]=null;return Fb}yya(Q,Ua){var Fb=Q.installTimeInMS?(new Date(Q.installTimeInMS)).toISOString():"";Fb={["SDX.Id"]:Ua,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ne.c(Q.targetType)?"":Q.targetType.toString(),["SDX.AdminDeploymentTime"]:Fb};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj(Fb)}));1===Q.targetType&&(Q={["SDX.Id"]:Ua,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Aa.a.Vj(Q)})))}jCi(Q){let Ua=!1;if(Q&&1>Q.count)return Ua;const Fb=Og();if(!Fb)return Ua;for(let nc of Q)if(nc.storeId&&nc.storeId.toLowerCase()===Fb.toLowerCase()||nc.assetId&&nc.assetId.toLowerCase()===Fb.toLowerCase())Q={["SDX_Id"]:sf.d6e(nc),["SDX_TargetType"]:ne.c(nc.targetType)?"":nc.targetType.toString()},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Aa.a.Vj(Q)})),Ua=!0;return Ua}wBi(Q){if(!(Q&&1>Q.count))if(this.WGa.Qjf()){var Ua=this.WGa.a6e();Ua?(Q=this.O1e(Q,Ua),t.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(Q=this.O1e(Q,null),t.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.WGa.a5f(Q)}else t.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}O1e(Q,Ua){const Fb={};let nc=!1;for(let Dc of Q)if(Q=sf.d6e(Dc))!Ua||Q in
Ua||(this.lEi(Dc,Q),t.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Q.toLowerCase()?nc||(nc=!0,Fb[Q]=null):Fb[Q]=null;return Fb}lEi(Q,Ua){var Fb=Q.installTimeInMS?(new Date(Q.installTimeInMS)).toISOString():"";Fb={["SDX.Id"]:Ua,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ne.c(Q.targetType)?"":Q.targetType.toString(),["SDX.AdminDeploymentTime"]:Fb};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj(Fb)}));
1===Q.targetType&&(Q={["SDX.Id"]:Ua,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Aa.a.Vj(Q)})))}xVi(Q,Ua,Fb,nc){Q?(-1===nc.targetType&&(nc.targetType=Fb.targetTypeForExp),Q=new Zf(Fb.targetData,nc),Ua&&this.context.VXc.add(Q),10===this.context.qO&&(this.context.jed.add(Q),0===Q.targetType&&this.context.CIa.add(Q))):(Ua=Fb.targetData,t.ULS.sendTraceTag(542978528,220,
15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua.solutionId,Ua.storeType,Ua.assetId,null,null,Ua.storeId),Ua.storeType));this.Doc()}Vla(Q){Q={["AppTeachingUICalloutAction"]:Q,["SDX.Id"]:this.CWd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}))}static get ZOb(){return pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static mV(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static d6e(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static kwb(Q){return Telemetry.PrivacyRules.IsPrivateAddin(Q.storeType,Q.assetId,null,null,Q.storeId)?"private_"+Q.installTimeInMS:Q.solutionId}}Object(d.a)(sf,"AddInCommandsListLoader",null,[]);class ma{constructor(Q){this.pBg=Q}get hda(){return this.pBg}insertOsfControl(Q){return this.hda.insertOsfControl(Q)}getManifestInvaildErrorString(){return this.hda.getManifestInvaildErrorString()}isAddinCommandsAsync(Q,
Ua){this.hda.isAddinCommandsAsync(Q,Ua)}isAddinCommandsExAsync(Q,Ua){this.hda.isAddinCommandsExAsync(Q,Ua)}ownerAddinControlRecreated(Q,Ua){this.hda.ownerAddinControlRecreated(Q,Ua)}queryEntitlementDetails(Q){this.hda.queryEntitlementDetails(Q)}}Object(d.a)(ma,"ContextActivationMgrWrapper",null,[760]);class vb{createAddinDataProvider(Q,Ua){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(Q,Ua.hda)}static get instance(){vb.Ma||(vb.Ma=new vb);return vb.Ma}}vb.Ma=null;Object(d.a)(vb,
"OSFAddinDataProviderFactory",null,[757]);class oc{constructor(){this.Ver=1}}Object(d.a)(oc,"CacheItem",null,[]);class Fc{constructor(Q){this.YEa=Q}Dl(Q){const Ua=this.YEa.getItem(Q);if(Ua){let Fb=new oc;try{Fb=Sys.Serialization.JavaScriptSerializer.deserialize(Ua,!0)}catch(nc){return this.YEa.removeItem(Q),null}return Fb.Data?Fb.Data:Fb.data}return null}sRa(Q){this.YEa.removeItem(Q)}}Object(d.a)(Fc,"AppsDataCacheManager",null,[341]);var wd=a(817);class Pd{constructor(){new Fc(wd.a.instance)}A2f(Q,
Ua){Q=ue.a.S2e()+Q;wd.a.instance.setItem(Q,Ua.toString())}a6e(){var Q=ue.a.e6e();t.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",Q);Q=wd.a.instance.getItem(Q);return Mf.a(Q)}a5f(Q){const Ua=ue.a.e6e();t.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ua);wd.a.instance.setItem(Ua,Mf.c(Q))}Qjf(){return!!wd.a.instance.localStorage}static get instance(){Pd.Ma||(Pd.Ma=new Pd);return Pd.Ma}}Pd.Ma=null;Object(d.a)(Pd,"AddInCommandsCacheManager",null,[761]);class ie{constructor(Q,Ua,Fb,nc,Dc,
cd){this.$q=Q;this.kk=Ua;this.$W=Fb;this.displayName=Dc;this.Aof=cd}}Object(d.a)(ie,"PostLaunchAddinCommandsParameters",null,[]);class da{constructor(Q,Ua,Fb){this.ZRa=!1;this.OX=null;this.fb=Q;this.dkb=Ua;this.whb=Fb}DWc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(be.a)(this,this.PDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(be.a)(this,this.XCd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(be.a)(this,this.ICd,"onCloseButtonClickedEventHandler"),!0),pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(be.a)(this,this.MFb,"onCampaignLaunchedHandler"),!0)):t.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}PDd(){const Q={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:da.mV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.whb&&this.whb.tabs&&!this.whb.tabs[0].isOfficeTab&&(Q["SDX.FeatureFlags"]="NonOfficeTab");Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.fma();this.whb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.whb,()=>{const Ua=new sg;Ua.kk=this.dkb;this.fb.raiseEvent(ue.a.Cvd,
Ua)}):t.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}ICd(){const Q={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:da.mV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.fma()}XCd(){const Q={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:da.mV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.fma()}MFb(Q){if(Q&&(Q=Q.detail)&&Q.id&&this.zpd(Q.id)){const Fb=
(Q.action||"").toLowerCase();if(Q.success&&"opened"===Fb){var Ua={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:da.mV(this.dkb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Ua)}));t.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.fma();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(be.a)(this,this.MFb,"onCampaignLaunchedHandler"),!0)}else try{Ua=JSON.stringify(Q),t.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ua)}catch(nc){Ua="id : "+Q.id+" telemetryEventName: "+Q.telemetryEventName,t.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ua+" Error: "+(nc?nc.toString():""))}}}zpd(Q){Q=fg.a.vl(Q);return-1!==Q.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==Q.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==Q.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==Q.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==Q.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==Q.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}K7(Q){const Ua=pd.AFrameworkApplication.fa.Xa("WebAppShortName");if(Ua){const Fb={},nc={};nc.LastTeachingUIShowTime=(new Date).toUTCString();nc.AddinHasShown=Q;Fb[Ua]=Mf.c(nc);this.OX=new gg(Ua,null,null,Object(be.a)(this,this.uW,"postRequestFailureCallback")),this.OX.G3a(Fb),t.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else t.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}fma(){if(!this.ZRa){const Q=window.g_roamingAddinList;Q&&(this.K7(Q),this.ZRa=!0)}}uW(Q){t.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",Q?Q.httpStatus:-1)}static mV(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}}Object(d.a)(da,"PrivateCatalogTeachingCalloutHandler",null,[]);class jb{constructor(Q){this.zde=null;this.rbe=
Q}get jya(){return this.zde}CZa(Q,Ua=null){this.rbe.CZa(Q,Ua);this.zde=Q}ZLd(Q){this.rbe.ZLd(Q)}}Object(d.a)(jb,"RibbonExtensibilityManagerWithChangeDetection",null,[788]);var Nb=a(862),E=a(98);class ja{static G3e(Q){const Ua=new m.a;if(ja.AFe)for(var Fb of ja.AFe)Ua.add(Fb);Fb=null;switch(Q){case "Workbook":Fb=ja.p5j;break;case "Document":Fb=ja.kph;break;case "Presentation":Fb=ja.y8i}if(Fb)for(const nc of Fb)Ua.add(nc);return Ua}}ja.AFe=["PrimaryCommandSurface","ContextMenu"];ja.p5j=null;ja.kph=
null;ja.y8i=null;Object(d.a)(ja,"ExtensionPointType",null,[]);class Ta{constructor(Q){this.wge=null;if(ne.c(Q))throw t.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Hsg=Q}get zFb(){return this.wge||(this.wge=new m.a)}get ste(){return this.Hsg}}Object(d.a)(Ta,"ContextMenuExtensibility",null,[769]);class Eb{constructor(Q,Ua=null,Fb=0){if(ne.c(Q))throw t.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.iBg=Q;this.xEg=Ua;this.gxg=Fb}get gW(){return this.iBg}get startedNode(){return this.xEg}get hOh(){return this.gxg}}Object(d.a)(Eb,"RibbonExtensibility",null,[795]);class jc{constructor(Q){this.gwg=Q.entitlement}get entitlement(){return this.gwg}createActionContext(Q,Ua){Q={};Q.ownerAddinInfo=this.entitlement;Q.action=Ua;return Q}}Object(d.a)(jc,"AddInCommandsContextProvider",null,[]);class ic{constructor(Q,Ua,
Fb){this.A5d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=Q;this.eventBuilder=Ua;this.contextMenuBuilder=Fb}get Nse(){return this.A5d}rch(Q){return new jc(Q)}createActionBuilder(Q,Ua){return OfficeExt.DefaultControlActionBinder.createActionBuilder(Q,Ua.entitlement,Ua.manifest)}startApplyAddin(Q){this.A5d=Q;const Ua=this.rch(Q);this.actionBuilder=this.createActionBuilder(Ua,Q)}endApplyAddin(){}Ked(Q,Ua,Fb=0){return this.ribbonBuilder.kt&&
0<this.ribbonBuilder.kt.count?new Eb(this.yNh(Q,Ua),this.Nse.startedNode,Fb):null}k_e(){var Q=null;if(this.contextMenuBuilder.enc&&0<this.contextMenuBuilder.enc.count){Q||(Q=this.Nse.entitlement.solutionId);Q=new Ta(Q);for(let Ua of this.contextMenuBuilder.enc)Q.zFb.add(Ua);return Q}return null}yNh(Q,Ua){return this.ribbonBuilder.kt&&0<this.ribbonBuilder.kt.count?new hf.a(this.ribbonBuilder.kt,Q,Ua):null}}Object(d.a)(ic,"AddinCommandsBuilder",null,[]);class gc{constructor(Q,Ua,Fb,nc,Dc,cd,kd){this.cUa=
new E.a;this.$q=Q;this.Wh=Ua;this.ap=Fb;this.ribbonManager=nc;this.contextMenuManager=Dc;this.pG=cd;this.rha=kd;this.TO=pd.AFrameworkApplication.sa.mE}cDb(Q,Ua,Fb,nc,Dc,cd,kd){const qd=(Id,Yd,Je,Se)=>{Dc(Id,Yd,Je,Se);Id=Nb.a[this.$q]+Yd.assetId;({value:Yd}=this.cUa.Dc(Id)).returnValue&&(Yd.stop(),this.cUa.remove(Id))};if(0!==this.$q&&Q){t.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",Q.count);4===this.$q&&(t.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
nc)),this.A4g(Q,nc),cd());for(let Id of Q)if(Q=Id,t.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId))),this.$kg(Q))if(kd&&Q.requireConsent)kd(Q,Yd=>{try{if(this.TO){const Se=Nb.a[this.$q]+Yd.solutionId,vf=this.TO.Ac("ComponentAttach",Se);this.cUa.ia(Se,vf)}const Je=this.pG.sja(Yd.storeType,Yd.solutionId);6!==this.$q&&(Je&&(this.l4b(Je),Je.QB.purge(!1)),
this.Wh.insertOsfControl(this.jIb(Yd,Ua,Fb,qd)),Je&&this.Wh.ownerAddinControlRecreated(Yd.solutionId,Yd.storeType))}catch(Je){t.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.solutionId,Yd.ownerAddinStoreType||Yd.storeType,Yd.assetId,null,null,Yd.storeId),Yd.version,Yd.storeType,Yd.storeId,Je.message)),qd(!1,Yd,null,null)}});
else try{if(this.TO){const Je=Nb.a[this.$q]+Q.solutionId,Se=this.TO.Ac("ComponentAttach",Je);this.cUa.ia(Je,Se)}const Yd=this.pG.sja(Q.storeType,Q.solutionId);6!==this.$q&&(Yd&&(this.l4b(Yd),Yd.QB.purge(!1)),this.Wh.insertOsfControl(this.jIb(Q,Ua,Fb,qd)),Yd&&this.Wh.ownerAddinControlRecreated(Q.solutionId,Q.storeType))}catch(Yd){t.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.ap.uN,
Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,Yd.message)),qd(!1,Q,null,null)}else qd(!1,Q,null,null)}}Syi(Q,Ua,Fb,nc,Dc,cd){const kd=(qd,Id,Yd,Je)=>{cd(qd,Id,Yd,Je);qd=Nb.a[this.$q]+Id.solutionId;({value:Id}=this.cUa.Dc(qd)).returnValue&&(Id.stop(),this.cUa.remove(qd))};if(6===this.$q&&Q)if(t.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,
Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId))),this.$kg(Q))try{if(this.TO){const Id=Nb.a[this.$q]+Q.solutionId,Yd=this.TO.Ac("ComponentAttach",Id);this.cUa.ia(Id,Yd)}const qd=this.pG.sja(Q.storeType,Q.solutionId);qd||kd(!1,Q,null,null);pd.AFrameworkApplication.sa&&pd.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.I_e(Q,Ua,nc,Dc,Fb,Id=>{kd(Id,Q,Fb,qd.displayName)}):(this.I_e(Q,Ua,nc,Dc,Fb),kd(!0,Q,Fb,qd.displayName))}catch(qd){t.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,qd.message)),kd(!1,Q,null,null)}else kd(!1,Q,null,null)}tNi(Q,Ua,Fb,nc,Dc,cd){if(cd)if(cd._isAddinCommandsManifest(this.ap.uN))try{pd.AFrameworkApplication.sa&&pd.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.H_e(Q,Ua,Fb,Dc,cd,kd=>{nc(kd,Q,cd,cd.getDefaultDisplayName())}):(this.H_e(Q,Ua,Fb,Dc,cd),nc(!0,Q,cd,cd.getDefaultDisplayName()))}catch(kd){t.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId,kd.message)),nc(!1,Q,cd,cd.getDefaultDisplayName())}else t.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId)),nc(!1,Q,null,null);else t.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.ap.uN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.ownerAddinStoreType||Q.storeType,Q.assetId,null,null,Q.storeId),Q.version,Q.storeType,Q.storeId)),
nc(!1,Q,null,null)}jIb(Q,Ua,Fb,nc){const Dc={},cd=document.createElement("div");cd.setAttribute("visible","false");Dc.div=cd;Dc.id=Q.solutionId;Dc.solutionId=Q.solutionId;Dc.version=Q.version;Dc.storeType=Q.storeType;Dc.storeId=Q.storeId;Dc.assetId=Q.assetId;Dc.assetStoreId=Q.assetStoreId;Dc.isvirtualOsfControl=!0;Dc.virtualOsfControlActivationCallback=(kd,qd)=>{const Id=this.pG.sja(Q.storeType,Q.solutionId);Id&&(Id.isUpgraded&&(Q.isUpgraded=!0),this.l4b(Id));this.tNi(Q,Ua,Fb,nc,kd,qd)};Dc.reason=
3===this.$q?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Dc}H_e(Q,Ua,Fb,nc,Dc,cd=null){const kd={};kd.solutionId=nc.getSolutionId();kd.version=nc.getVersion();kd.storeType=nc.getStoreType();kd.storeId=nc.getStoreId();pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?kd.assetId=nc.getAssetId():kd.assetId=nc.getSolutionId();kd.assetStoreId=nc.getAssetStoreId();
kd.targetType=nc.getOsfControlType();let qd=null,Id=null;if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))qd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.uN,this.ap.formFactor)).parseExtensions(kd,Dc,this.rha),Id=ja.G3e(this.ap.uN);else try{qd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.ap.uN,this.ap.formFactor)).parseExtensions(kd,Dc,this.rha),Id=ja.G3e(this.ap.uN)}catch(Je){throw t.ULS.sendTraceTag(538752131,
220,10,"Exception encounter while parsing manifest. Exception: "+Je.message),Je;}if(Id&&0<Id.count){if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Yd=Ua(Q);Ua=Fb(Q);Fb=!!pd.AFrameworkApplication.fa&&pd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Yd=new ic(Yd,null,Ua);for(let Je of Id)Yd.commandSurface=Je,qd.apply(Yd,this.rha,Fb)}else try{let Je=Ua(Q),Se=Fb(Q),vf=!!pd.AFrameworkApplication.fa&&
pd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Yd=new ic(Je,null,Se);for(let Kg of Id)Yd.commandSurface=Kg,qd.apply(Yd,this.rha,vf)}catch(Je){throw t.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Je.message),Je;}if(OSF.OUtil.checkFlight(14))try{let Je=Yd.Ked(Q.solutionId,Dc.getDefaultDisplayName()),Se=Yd.k_e();Je&&this.ribbonManager.CZa(Je,cd);Se&&this.contextMenuManager.qpe(Se);this.pG.Xpe(nc,Je,Se,Dc.getDefaultDisplayName());
t.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Dc.getDefaultDisplayName())}catch(Je){throw OfficeExt.DevConsole.log(Je),t.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Je.message),Je;}else try{let Je=Yd.Ked(Q.solutionId,Dc.getDefaultDisplayName()),Se=Yd.k_e();Je&&this.ribbonManager.CZa(Je);Se&&this.contextMenuManager.qpe(Se);this.pG.Xpe(nc,Je,Se,Dc.getDefaultDisplayName());t.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Dc.getDefaultDisplayName())}catch(Je){throw t.ULS.sendTraceTag(539870851,
220,10,"Error generating ribbon extensibility. Exception: "+Je.message),Je;}}}I_e(Q,Ua,Fb,nc,Dc,cd=null){const kd={};kd.solutionId=Q.solutionId;kd.version=Q.version;kd.storeType=Q.storeType;pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?kd.storeId=Q.storeId:kd.storeId=Q.assetStoreId;kd.assetId=Q.assetId;kd.assetStoreId=Q.assetStoreId;kd.targetType=Q.targetType;const qd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.ap.uN,this.ap.formFactor);
try{const Id=Ua.getManifest(),Yd=qd.parse(kd,Id,Dc,this.rha,Ua.getSharedRuntimeId(),Ua),Je=Fb(Q),Se=nc(Q),vf=new ic(Je,null,Se);vf.commandSurface="PrimaryCommandSurface";Yd.apply(vf,this.rha,!0);if(vf.ribbonBuilder.kt&&0<vf.ribbonBuilder.kt.count){const Kg=vf.Ked(Q.solutionId,Ua.getManifest().getDefaultDisplayName(),1);pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.CZa(Kg,cd):Kg&&this.ribbonManager.CZa(Kg,
cd);this.pG.HJg(Ua,Kg,Dc,Ua.getManifest().getDefaultDisplayName());t.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ua.getManifest().getDefaultDisplayName())}}catch(Id){t.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ua.getManifest().getDefaultDisplayName(),Id.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Id)}}l4b(Q){Q.So&&this.ribbonManager.ZLd(Q.So);Q.hsb&&this.contextMenuManager.yhj(Q.hsb);this.pG.ghj(Q.QB.getStoreType(),
Q.QB.getSolutionId())}A4g(Q,Ua){Ua=Wg(Ua);for(let Fb of this.pG.P6a){if(Fb.QB.getStoreType()!==Ua)continue;let nc=!0;for(let Dc of Q){const cd=Dc;if(cd&&Fb.Flf(cd.storeType,cd.solutionId)){nc=!1;break}}nc&&(this.l4b(Fb),Fb.QB.purge(!1))}}$kg(Q){return!!Q&&!!Q.solutionId&&!!Q.version&&!!Q.storeType&&!!Q.storeId}}Object(d.a)(gc,"AddInCommandsIntegration",null,[]);class $c{constructor(Q,Ua,Fb,nc,Dc,cd,kd,qd=null){this.fb=new ye.a;this.OGc=Q;this.bvg=Ua;this.Km=Fb;this.Hme=nc;this.rYa=Dc;this.vsg=cd;
this.mSb=kd;this.aBg=qd;this.Syg=pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.QMc=pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}ELg(Q){this.fb.addHandler(ue.a.Mse,Q)}vNg(Q){this.fb.addHandler(ue.a.Cvd,Q)}WOg(Q){this.fb.addHandler(ue.a.m8f,Q)}LLg(Q){this.fb.addHandler(ue.a.YZc,Q)}kzi(Q,Ua,Fb){const nc=Fb[ue.a.Gob],Dc=void 0===Fb[ue.a.NP]?0:Fb[ue.a.NP];if(nc&&0!==Dc)if(0>=nc.count&&4!==
Dc)this.bNf(new ie(Dc,null,null,Ua,null,!0));else{var cd=nc.count,kd=new jb(new k),qd=void 0===Fb[ue.a.n$]?-1:Fb[ue.a.n$],Id=new gc(Dc,this.Km,this.OGc,kd,this.bvg,this.rYa,this.mSb),Yd=rg=>this.Hme.SYg(rg.solutionId,this.mSb,this.OGc,Q),Je=rg=>this.Hme.bYg(rg.solutionId),Se=(rg,lg,mg)=>{cd--;mg=new ie(Dc,lg,kd,Ua,mg,0>=cd);if(rg&&lg)this.bNf(mg);else{if(3===Dc||lg&&lg.isUpgraded)rg="",lg&&(rg=Telemetry.PrivacyRules.GetPrivacyCompliantId(lg.solutionId,lg.ownerAddinStoreType||lg.storeType,lg.assetId,
null,null,lg.storeId)),lg={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:rg},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj(lg)}));this.aNf(mg)}cd||pd.AFrameworkApplication.sa.updateCommandUI()},vf=(rg,lg,mg,Ag)=>{Se(rg,lg,Ag)},Kg=()=>{this.yBd();0>=nc.count&&4===Dc&&this.rYa.LRd()};6===Dc?(qd=Fb[ue.a.LJa],Fb=Fb[ue.a.MJa],Id.Syi(nc.oa(0),qd,Fb,Yd,Je,(rg,lg,mg,Ag)=>{Se(rg,lg,Ag)})):
Id.cDb(nc,Yd,Je,qd,vf,Kg,this.aBg)}else Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),t.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.OGc.uN)),this.aNf(new ie(Dc,null,null,Ua,null,!0))}aNf(Q){this.yBd(Q);this.d9f(!1,Q)}bNf(Q){const Ua=Q.kk;let Fb=null;
null!==Ua&&(Fb=Ua.storeType,Fb=Fb.toLowerCase());if(Q&&"omex"===Fb&&(3===Q.$q||Ua.isUpgraded)){var nc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua.solutionId,Ua.ownerAddinStoreType||Ua.storeType,Ua.assetId,null,null,Ua.storeId)};Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Vj(nc)}))}this.yBd(Q);nc=this.QMc&&Sg()&&"omex"===Fb&&!!Q.$W&&!!Ua.solutionId&&2===Q.$q&&
Ua.solutionId.toLowerCase()===Og().toLowerCase();if("omex"===Fb&&Q.$W&&(3===Q.$q&&"hardcodedpreinstall"!==Fb||Ua.isUpgraded)||nc)nc=new sg,nc.kk=Ua,nc.So=Q.$W.jya,this.fb.raiseEvent(ue.a.YZc,nc);if(this.Syg){nc=Ng();const Dc=Og();nc&&Ua&&"excatalog"===Ua.storeType&&Q.$W&&5===Q.$q&&Dc&&(Ua.storeId&&Ua.storeId.toLowerCase()===Dc.toLowerCase()||Ua.assetId&&Ua.assetId.toLowerCase()===Dc.toLowerCase())&&(nc=new sg,nc.kk=Ua,nc.So=Q.$W.jya,this.fb.raiseEvent(ue.a.YZc,nc),t.ULS.sendTraceTag(525362254,220,
50,"Email alert triggers AutoLaunchAddin event."))}Ua&&(Pd.instance.A2f(mh(Fb),!0),"uploadfiledevcatalog"===Fb&&(nc=this.vsg.createAddinDataProvider(Fb,this.Km))&&nc.localCacheAddinCommands(this.Km.hda,Ua.solutionId,Ua.version,Ua.storeId),Kf.a.lgb(ue.a.Iob,"true",mh(Fb)));this.d9f(!0,Q)}d9f(Q,Ua){Q?pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ua.$W&&5===Ua.$q&&Ua.$W.jya&&void 0!==Ua.kk.showCallout&&null!==Ua.kk.showCallout&&
Ua.kk.showCallout?(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Mg(this.fb)).DWc(Ua.kk,hf.a.t4a(Ua.$W.jya)):(new da(this.fb,Ua.kk,hf.a.t4a(Ua.$W.jya))).DWc(),Q=new sg,Q.So=Ua.$W.jya,Q.kk=Ua.kk,this.fb.raiseEvent(ue.a.m8f,Q)):3!==Ua.$q?Ua.Aof&&this.rYa.LRd():Ua.$W&&Ua.$W.jya&&"hardcodedpreinstall"!==Ua.kk.storeType&&Qb.a.IHj(Ua.displayName,Ua.$W.jya,Ua.kk.isAutoLaunched):3===Ua.$q?Ua.kk&&"uploadfiledevcatalog"===Ua.kk.storeType.toLowerCase()?
(Ua=this.mSb.iVh(Ua.kk.solutionId),Qb.a.UUd(Ua?Ua:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.rYa.H3f():Ua.Aof&&this.rYa.LRd()}yBd(Q=null){var Ua=Q?Q.kk:null;const Fb=new sg;if(Fb.kk=Ua){var nc=this.rYa.sja(Ua.storeType,Ua.solutionId,6===Q.$q?1:0);if(nc&&nc.So){Fb.So=nc.So;var Dc=this.QMc?Og():null;Dc=this.QMc&&Sg()&&!!Ua.solutionId&&!!Dc&&Ua.solutionId.toLowerCase()===Dc.toLowerCase()&&2===Q.$q;if(3===Q.$q&&"hardcodedpreinstall"!==Ua.storeType||Dc)Q="",nc.So.gW&&
nc.So.gW.kt&&(nc=nc.So.gW.kt.oa(0))&&(Q=nc.id),Ua={["SDX_CommandPlacement"]:Q,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua.solutionId,Ua.ownerAddinStoreType||Ua.storeType,Ua.assetId,null,null,Ua.storeId)},Wf.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Aa.a.Vj(Ua)}))}}this.fb.raiseEvent(ue.a.Mse,Fb)}}Object(d.a)($c,"LaunchAddinCommandsHandler",null,[764]);class gd{}
gd.DVa="Alt";gd.EVa="Command";gd.id="Id";gd.HVa="Image16by16";gd.TRb="LabelText";gd.LVa="Title";gd.GROUP="Group";gd.u4d="Groups";gd.phb="Controls";gd.button="Button";gd.$aa="FlyoutAnchor";gd.LARGE="Large";gd.SMALL="Small";Object(d.a)(gd,"AddinDataNodeConstants",null,[]);a(375);a(566);a(561);a(136);class md{constructor(Q,Ua){this.eFa=this.c8d=null;if(ne.c(Q)||ne.c(Ua))throw t.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.gvg=Ua;this._id=Q;this.rU[gd.id]=this._id}get id(){return this._id||""}get rU(){return this.c8d||(this.c8d={})}get controlType(){return this.gvg||""}get menuItems(){return this.eFa||(this.eFa=new m.a)}}Object(d.a)(md,"ControlDefinition",null,[763]);class Xd{constructor(Q){this.ffe=null;if(ne.c(Q))throw t.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=Q;this.ima[gd.id]=this._id}get ima(){return this.ffe||
(this.ffe={})}get id(){return this._id||""}}Object(d.a)(Xd,"MenuItemDefinition",null,[794]);class ge{constructor(Q){this.iqa=null;if(ne.c(Q))throw t.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=Q}get id(){return this._id}get controls(){return this.iqa||(this.iqa=new m.a)}}Object(d.a)(ge,"OfficeMenuDefinition",null,[762]);var ve=a(25);class Fe{constructor(Q,Ua,Fb){this.sJ=
this.wWa=null;this.ZPc=Q;this.lWa=Ua;this.NVa=Fb;this.zAg=new m.a}get Knc(){return this.ZPc}get Irb(){return this.lWa}get GVc(){return this.NVa}addButton(Q){t.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",Q.actionType);this.sJ=new md(this.cta(Q.id),gd.button);this.sJ.rU[gd.TRb]=Q.label;this.sJ.rU[gd.DVa]=Q.label;this.sJ.rU[gd.HVa]=Q.icon["16"];this.dqb(this.sJ.rU[gd.id],Q.action);this.DGa(this.sJ.rU);this.wWa.controls.add(this.sJ);this.sJ=null}startBuildMenu(Q){if(ne.c(this.wWa))this.wWa=
new ge(Q.id);else{const Ua=this.cta(Q.id);this.sJ=new md(Ua,gd.$aa);this.l0a(this.sJ.rU,Q);this.sJ.rU[gd.HVa]=Q.icon["16"];this.sJ.rU[gd.EVa]=ve.a.alwaysEnabled}}addMenuItem(Q){t.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",Q.actionType);const Ua=new Xd(this.cta(Q.id));this.l0a(Ua.ima,Q);Q.icon&&(Ua.ima[gd.HVa]=Q.icon["16"]);this.dqb(Ua.ima[gd.id],Q.action);this.DGa(Ua.ima);this.sJ.menuItems.add(Ua)}endBuildMenu(){ne.c(this.sJ)?(this.enc.add(this.wWa),this.wWa=null):(this.wWa.controls.add(this.sJ),
this.sJ=null)}get enc(){return this.zAg}dqb(Q,Ua){this.GVc.bindAction(Q,Ua)}DGa(Q){this.Irb.DGa(Q)}cta(Q){return this.Knc.eLa(Q)}l0a(Q,Ua){Q[gd.TRb]=Ua.label;Q[gd.DVa]=Ua.label}}Object(d.a)(Fe,"ContextMenuExtensibilityCreator",null,[787,784]);class Ve{constructor(Q){this.llb=Q}get WEb(){return this.llb}eLa(Q){return this.WEb+Q}}Object(d.a)(Ve,"DefaultContextMenuNamingProvider",null,[786]);var jf=a(1317);class gf{bindAction(Q,Ua){OfficeExt.DefaultControlActionBinder.bindAction(Q,Ua)}}Object(d.a)(gf,
"DefaultUIControlActionBinder",null,[785]);class xf{constructor(Q){this.MDa=Q}get command(){return this.MDa}DGa(Q){Q[gd.EVa]=this.command}}Object(d.a)(xf,"DefaultUIControlCommandBinder",null,[782]);var Ye=a(32);class Lf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(Lf,"AddInControl",null,[]);class Nf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(d.a)(Nf,
"AddInGroup",null,[]);class Ef{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(Ef,"AddInMenuItem",null,[]);class uf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(uf,"AddInTab",null,[]);class Bg{constructor(Q,Ua,Fb,nc,Dc,cd){this.jSb=new m.a;this.Cib=this.Dfa=this.xWa=null;this.ZPc=Q;this.NVa=Ua;this.lWa=Fb;
this.Ax=nc;this.mSb=Dc;this.c$d=cd}get Knc(){return this.ZPc}get kt(){return this.jSb}get GVc(){return this.NVa}get Irb(){return this.lWa}startBuildTab(Q){const Ua=Q.isOfficeTab?Q.id:this.Knc.X7e(Q.id),Fb=Q.isOfficeTab?null:Q.label;this.xWa=Object.assign(new uf,{id:Ua,title:Fb,isOfficeTab:Q.isOfficeTab,visible:Q.visible,groups:[],tabType:Q.tabType,insertBefore:Q.insertBefore,insertAfter:Q.insertAfter,autoFocus:Q.autoFocus})}startBuildGroup(Q){const Ua=this.cta(Q.id);this.Dfa=Object.assign(new Nf,
{id:Ua,mlrId:Q.mlrId,title:Q.label,controls:[],groupType:0})}addNativeGroup(Q){this.Dfa=Object.assign(new Nf,{id:Q.id,mlrId:Q.mlrId,title:Q.label,controls:[],groupType:1});this.xWa.groups.push(this.Dfa)}addButton(Q){const Ua=this.cta(Q.id);Ua&&(this.dqb(Ua,Q.action),t.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",Q.actionType),Q=Object.assign(new Lf,{id:Ua,title:Q.label,iconLocation:this.dhd(Q),enabled:Q.enabled,controlType:0,attributes:this.l0a()}),this.c$d.epe(new Ye.a(Ua,
this.Irb.command.toString())),this.Dfa.controls.push(Q))}addNativeControl(Q){Q.id&&(t.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",Q.actionType),Q=Object.assign(new Lf,{id:Q.id,title:"",iconLocation:"",enabled:Q.enabled,controlType:2,attributes:this.l0a()}),this.Dfa.controls.push(Q))}startBuildMenu(Q){const Ua=this.cta(Q.id);Ua&&(this.Cib=Object.assign(new Lf,{id:Ua,title:Q.label,iconLocation:this.dhd(Q),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(Q){const Ua=
this.cta(Q.id);Ua&&(this.dqb(Ua,Q.action),t.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",Q.actionType),Q=Object.assign(new Ef,{id:Ua,title:Q.label,iconLocation:this.dhd(Q),enabled:Q.enabled,attributes:this.l0a()}),this.c$d.epe(new Ye.a(Ua,this.Irb.command.toString())),this.Cib.menuItems.push(Q))}endBuildMenu(){ne.c(this.Cib.id)||this.Dfa.controls.push(this.Cib);this.Cib=null}endBuildGroup(){ne.c(this.Dfa.id)||this.xWa.groups.push(this.Dfa);this.Dfa=null}endBuildTab(){ne.c(this.xWa.id)||
this.jSb.add(this.xWa);this.xWa=null}l0a(){const Q={};this.DGa(Q);return Q}dhd(Q){return Q.icon["80"]?Q.icon["80"]:Q.icon["32"]}DGa(Q){this.Irb.DGa(Q)}cta(Q){return this.Knc.eLa(Q)}dqb(Q,Ua){this.GVc.bindAction(Q,Ua)}}Object(d.a)(Bg,"OneLineRibbonExtensibilityCreator",null,[783,784]);class vg{constructor(Q,Ua){this.llb=Q;this.NVa=new gf;this.lWa=new xf(Ua)}bYg(Q){Q=new Ve(Q);return new Fe(Q,this.lWa,this.NVa)}SYg(Q,Ua,Fb,nc){Fb=new jf.a(this.llb,Q,Fb,!0);return new Bg(Fb,this.NVa,this.lWa,Q,Ua,nc)}}
Object(d.a)(vg,"UIExtensibilityFactory",null,[759]);var Eg=a(91),Ih=a(861),Qh=a(22),dg=a(37),Ug=a(76),Cg=a(50);class Yg{constructor(Q){this.UGa=this.ZGa=this.kk=this.So=null;this.mUf=0;this.QVi=()=>{if(this.kk&&this.UGa){const Ua=new Eg.a(ve.a.T2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ua,{["SourceControlId"]:this.UGa},null);t.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.JHj=(Ua,Fb)=>{Ua=null;if(Fb)if(Ua=Fb,this.kk=Ua.kk,(this.So=Ua.So)&&this.So.gW&&
this.So.gW.kt&&(this.ZGa=this.So.gW.kt.oa(0)),this.ZGa&&this.ZGa.id)if(this.ZGa.isOfficeTab)if(Fb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ua=this.kk.solutionId,Ua in Fb?this.UGa=Fb[Ua]:(Fb=Yg.GetPrivacyCompliantId(this.kk),t.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Fb}`),this.UGa=this.SOh(this.So)),this.UGa)if(Qh.a.contains(this.ZGa.id,Md.a.FW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(hf.a.t4a(this.So),
()=>{this.F9f(this.qid(this.UGa))});else{if(Fb=this.$.Ka)Fb.Dse(this.NIf),t.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else t.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Fb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Aa.a.Vj(Fb)})),this.u6();else this.H9f(this.qid(this.ZGa.id),0);else t.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Fb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Fb)})),this.u6();
else this.u6()};this.NIf=()=>{if(Qh.a.contains(this.ZGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ua=this.$.Ka;Ua&&Ua.kWf(this.NIf);this.F9f(this.qid(this.UGa))}};this.SVi=()=>{var Ua={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Ua)}));this.u6();let Fb=
{};Fb[Ug.a.lg]=this.bD;Ua={};Ua.solutionId=this.bD.solutionId;Ua.assetId=this.bD.assetId;Ua.assetStoreId=this.bD.assetStoreId;Ua.height=0!=this.bD.height?this.bD.height:600;Ua.storeId=this.bD.storeId;Ua.storeType=this.bD.storeType;Ua.targetType=this.bD.targetType;Ua.width=0!=this.bD.width?this.bD.width:600;Ua.displayName=this.bD.displayName;Ua.version=this.bD.version;Ua.isAddinCommands=!1;Fb[ue.a.Esa]=Ua;let nc=new Eg.a(-741808261,0,0,2,null);dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.Oa(this.$.da,
374,375,1),Dc=>{Dc=Dc.result;null!=Dc&&Dc.insertAgave(Fb,nc)},this.$.la,3)};this.sPi=()=>{let Ua={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Ua)}));this.u6()};this.PQi=()=>{let Ua={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Ua)}));this.u6()};this.uW=Ua=>{t.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ua?Ua.httpStatus:-1}`)};this.$=Q.$;this.addinUICommandHandler=Q;this.appName=pd.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.FPg=pd.AFrameworkApplication.fa.ud("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}static FVa(Q){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,Q.storeType,Q.assetId,null,null,Q.storeId)}zgj(Q){this.bD=Q;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.SVi,!0),window.addEventListener("DismissCallout",this.PQi,!0),window.addEventListener("CloseCallout",this.sPi,!0))}qid(Q){return"[id="+Q+"]"}H9f(Q,
Ua){Ua>this.FPg?(window.clearTimeout(this.mUf),this.G9f("[data-unique-id='pivotOverflowButton']"),t.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+Q)?this.G9f(Q):this.mUf=window.setTimeout(()=>{this.H9f(Q,Ua+1)},1E3)}F9f(Q){var Ua=document.querySelector("button[data-unique-id='RightPaddle']");if(Ua)Q={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));else if(Ua=document.querySelector("button"+Q),!Ua||"none"===window.getComputedStyle(Ua).display)if(Ua=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ua){Ua={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Ua)}));t.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.u6();return}this.dfg(Ua,"ShowTeachingUIForAddinButton")}G9f(Q){Q=document.querySelector("button"+Q);if(!Q&&(Q=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!Q)){Q={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));t.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.u6();return}this.dfg(Q,"ShowTeachingUIForAddinTab")}dfg(Q,Ua){Q.setAttribute("lpp-id","latestAddin");const Fb=Jc.a.instance.Ub("Common.ISystemInitiatedFeedback");Fb&&Q?(Fb.execute(nc=>{nc.logActivity(Ua,null)}),Q={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)})),t.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(t.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),Q={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Yg.GetPrivacyCompliantId(this.kk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)})),this.u6())}SOh(Q){if(!Q)return null;Q=Q.gW;if((null===Q||void 0===Q?0:Q.kt)&&0<Q.kt.count)for(let Ua of Q.kt)if(Ua.groups&&0<Ua.groups.length)for(const Fb of Ua.groups)if(Fb.controls&&0<Fb.controls.length)for(const nc of Fb.controls){if(nc.attributes&&
0===nc.controlType&&nc.enabled)return nc.id;if(nc.menuItems)for(const Dc of nc.menuItems)if(Dc.attributes&&Dc.enabled)return nc.id}return null}eKj(){var Q=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(Q&&"none"!==window.getComputedStyle(Q).display)t.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{Q=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==Q){Q={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)}));t.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.u6();return}t.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ua=Jc.a.instance.Ub("Common.ISystemInitiatedFeedback");null==
Ua||null==Q?(Q={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)})),t.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.u6()):(Ua.execute(Fb=>{Fb.logActivity("ShowTeachingUIForContentAddin",null)}),Q={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Yg.FVa(this.bD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj(Q)})),t.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}K7(Q){const Ua={},Fb={};Fb.LastTeachingUIShowTime=(new Date).toUTCString();Fb.AddinHasShown=Q;Ua[this.appName]=Mf.c(Fb);this.Lob=new gg(this.appName,null,null,
this.uW),this.Lob.G3a(Ua),t.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}u6(){if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.ZRa){const Q=window.g_roamingAddinList;Q&&(this.K7(Q),this.ZRa=!0)}}}Object(d.a)(Yg,"AddinTeachingCalloutHandler",null,[]);var Sh=a(1234),Ni=a(420),di=a(11),ei=a(183),fi=a(43),Fg=a(21),xh=a(55);class gi{constructor(Q,
Ua,Fb,nc,Dc,cd,kd=null){this.disposed=!1;this.aOi=(qd,Id)=>{if(Id)if(Id)if(qd=Id.kk){if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",!1)&&(Sg()||Ng())){const Je=this.$.ea.workbookContext.WebExtensions;if(Je){let Se=!1;for(var Yd of Je)if(Yd.PrimaryMarketplace.SolutionId.toLowerCase()===qd.solutionId.toLowerCase()){Se=!0;break}if(!Se){t.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{t.ULS.sendTraceTag(512258443,
220,15,"Has no add-in persisted in the file.");return}}Id=Id.So;Yd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(qd.solutionId in Yd)Id=Yd[qd.solutionId];else if(Id=this.KSh(Id),void 0===Id||null===Id){t.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Yd=new Eg.a(ve.a.T2,0,0,2,null);this.executeCommand(0,Yd,{["SourceControlId"]:Id},null);qd.isAutoLaunched=!0}else t.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else t.ULS.sendTraceTag(528098436,
220,15,"agaveParams is null");else t.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.pff=(qd,Id)=>{"Insert"==Id.tabName&&(qd=this.$.Ka,null!=qd&&(qd.kWf(this.pff),t.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.YOb.eKj())};this.RVi=(qd,Id)=>{qd=null;Id&&(qd=Id);(null===qd||void 0===qd?0:qd.So)&&this.OAj(qd.So);this.$.af();y.EwaSettings.ma(87)&&qd&&qd.kk&&this.XUg(qd.kk)};this.$=Q;t.ULS.shipAssertTag(537170659,0,!(void 0===Ua||null===Ua),
`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${fi.a.jZ()}`);this.ie=Ua;this.uGe=Fb;this.J0b=nc;this.sha=Dc;this.Job=cd;this.ap=new Ih.a;this.rha=new vd;this.Xbd=kd;Ah.a.azb=Ah.a.MVe;this.Z7c=new m.a;this.G2a=new m.a}dispose(){void 0!==this.Job&&null!==this.Job&&(this.Job.dispose(),this.Job=null);this.ie=this.$=null;this.disposed=!0}WEj(Q,Ua){switch(Q){case ve.a.T2:Q=this.GEj(Ua);break;default:Q=!1}return Q}nc(){return!1}executeCommand(Q,Ua,Fb){Q=dg.TaskExtensions.Rj();
Ua=Ua.command;switch(Ua){case 843847158:break;case -2025863019:Qb.a.UUd(Fb[ue.a.XXc].toString(),()=>{Fg.h(this.$).focus()});break;case -1777565636:Sh.a.showUILessDialog(Fb[ue.a.Kob].toString());this.ie.XHj(Fb[ue.a.Kob].toString());break;case 1592314317:Sh.a.hideUILessDialog(Fb[ue.a.Kob].toString());this.ie.Oci(Fb[ue.a.Kob].toString());break;case ve.a.T2:Q=this.wkd(Fb);break;case ve.a.bDb:this.cDb(Fb);break;case ve.a.Mna:this.Mna(Fb);break;case ve.a.VUd:this.Job.$zc();break;case ve.a.refreshAddinCommands:this.sej();
break;case 1949669462:this.sha.H3f(!0);break;case -1014260128:Q=this.executeDynamicAddInCommandsAPI(Fb);break;default:Q=ei.a(Ua)}return Q}wc(Q,Ua){Q=!1;switch(Ua.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case ve.a.Mna:case ve.a.VUd:case ve.a.refreshAddinCommands:case 1949669462:case ve.a.bDb:case -1014260128:Q=!0;break;case ve.a.T2:Q=!pd.AFrameworkApplication.protectedFile}return Q}Jc(){return!1}KSh(Q){if(!Q)return t.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),
null;if((Q=Q.gW)&&Q.kt&&0<Q.kt.count)for(let Ua of Q.kt){if(Ua.groups&&1===Ua.groups.length){Q=Ua.groups[0];if(Q.controls&&1===Q.controls.length){const Fb=Q.controls[0];if(Fb.attributes&&!Fb.controlType&&Fb.enabled)return Fb.id}Q.controls&&t.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ua.groups&&t.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}sej(){if(this.sha.twd()){this.sha.QCe();var Q=this.gfd();if(Q&&0<Q.count)for(let Ua of Q)Q={[ue.a.n$]:Ua,[ue.a.NP]:4,
[ue.a.XGa]:(new Date).getTime()},this.Mna(Q)}}Mna(Q){t.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${Q[ue.a.NP]}, DataProvider ${Q[ue.a.n$]}.`);this.sha.bxj();window.setTimeout(()=>{if(void 0===this.ie||null===this.ie)t.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${fi.a.jZ()}`);else{const Ua=new sf(new ma(this.ie.Wh),vb.instance,Pd.instance);Ua.DLg((Fb,
nc)=>{this.cDb(nc.properties)});pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Ua.XOg((Fb,nc)=>{null==nc?Wf.a.sendTelemetryEvent(Object(jd.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Vj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.YOb=new Yg(this),this.YOb.zgj(nc),Fb=this.$.Ka,null!=Fb&&(Fb.Dse(this.pff),t.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ua.sWj(Q)}},0)}cDb(Q){if(!this.disposed){t.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${Q[ue.a.NP]}.`);try{if(y.EwaSettings.ma(184)){const Fb=Q[ue.a.Gob];if(Fb&&0<Fb.count){const nc=Fb.count;for(let Dc=nc-1;0<=Dc;Dc--){const cd=Fb.oa(Dc);OSF.OsfControl.isFirstPartyStoreString(cd.storeType)||
Fb.remove(Fb.oa(Dc))}if(Fb.count<nc){const Dc=Cg.GetServiceTaskFactory.Oa(this.$.da,5,4,0);dg.TaskExtensions.Aa(Dc,()=>{Dc.result.kg(36,null)},this.$.la,3)}if(!Fb.count)return}}if(void 0===this.ie||null===this.ie)t.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${fi.a.jZ()}`);else{var Ua=null;Ua=pd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new $c(this.ap,this.uGe,new ma(this.ie.Wh),new vg(this.$.Eb,ve.a.T2),this.sha,
vb.instance,this.rha,(Fb,nc)=>{const Dc={};Dc.InstanceId=Ca.a.create().toString();Dc.PrimaryMarketplace={};Dc.PrimaryMarketplace.SolutionId=Fb.solutionId;Dc.PrimaryMarketplace.SolutionVersion=Fb.version;Dc.PrimaryMarketplace.MarketplaceType=Fb.storeType;Dc.PrimaryMarketplace.MarketplaceRef=Fb.storeId;Dc.WebExtensionType=1;this.ie.kKj(Dc,()=>{nc(Fb)})}):new $c(this.ap,this.uGe,new ma(this.ie.Wh),new vg(this.$.Eb,ve.a.T2),this.sha,vb.instance,this.rha);Ua.LLg(this.aOi);Ua.ELg(this.RVi);if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Fb=new Yg(this);Ua.vNg(Fb.QVi);Ua.WOg(Fb.JHj)}this.$.da.za(53).Gm&&sc.a.get_instance().Ck(5,null).continueWith(()=>{this.disposed||Ua.kzi(this.Xbd,this.$.domElement,Q)})}}catch(Fb){t.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Fb.message}.`)}}}wkd(Q){const Ua=dg.TaskExtensions.Rj();Q=Q[this.ap.wia];const Fb=this.J0b.HVc(Q),nc=new Sh.a(this.$,this.ie,Fb.ownerAddinInfo,Ua);return this.M9e(Ua,Q,Fb,nc)}M9e(Q,Ua,Fb,nc){this.J0b.wkd(Ua,this.sha,nc,new ma(this.ie.Wh),
Fb,()=>{Q=nc.u9g()},()=>{Fg.h(this.$).focus()});return Q}XUg(Q){const Ua=dg.TaskExtensions.Rj();var Fb=this.ie.Taa(Q.solutionId);if(Fb){var nc=this.ie.IZ(Fb);if(di.HelperMethods.Iw(nc)&&0!==nc.SharedRuntime.State)return}nc=this.J0b.YUg;const Dc=Q.solutionId in nc?nc[Q.solutionId]:null;if(Dc){const cd=this.J0b.HVc(Dc),kd=new Sh.a(this.$,this.ie,cd.ownerAddinInfo,Ua),qd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.solutionId,null!==cd.ownerAddinInfo?cd.ownerAddinInfo.storeType:Q.storeType,Q.assetId,
null,null,Q.storeId);nc=Id=>{if(Id){const Yd={};for(const Je of Id)Yd[Je[0]]=Je[1];(Id=ue.a.Lse in Yd?Yd[ue.a.Lse]:null)&&"true"===Id.toLowerCase()&&(t.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${Q.storeType}, StoreId ${Q.storeId}, SolutionId ${qd}.`),this.M9e(Ua,Dc,cd,kd))}};t.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${Q.storeType}, StoreId ${Q.storeId}, SolutionId ${qd}.`);if(Fb)nc(this.ie.IZ(Fb).OsfPropertyBag);else if(Fb=
this.$.ea.workbookContext.WebExtensions)for(const Id of Fb)if((1===Id.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===Q.targetType&&Id.PrimaryMarketplace.MarketplaceType.toLowerCase()===Q.storeType.toLowerCase()&&Id.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Q.storeId.toLowerCase()&&Id.PrimaryMarketplace.SolutionId.toLowerCase()===Q.solutionId.toLowerCase()){nc(Id.OsfPropertyBag);break}}}yYd(Q,Ua,Fb=!1){Q&&(!Fb||Ua||this.Z7c.contains(Q)||this.Z7c.add(Q),(Fb=
this.G2a.contains(Q))&&Ua&&this.G2a.remove(Q),Fb||Ua||this.G2a.add(Q))}OAj(Q){if((Q=Q.gW)&&Q.kt)for(let Ua of Q.kt)if(Ua.groups)for(const Fb of Ua.groups)if(Fb.controls)for(const nc of Fb.controls)if(this.yYd(nc.id,nc.enabled,!0),1===nc.controlType&&nc.menuItems)for(const Dc of nc.menuItems)this.yYd(Dc.id,Dc.enabled,!0)}gfd(){const Q=new m.a;y.EwaSettings.ma(53)&&(this.$.ea.Vg.get(27)&&(Q.add(0),Q.add(16)),this.$.ea.Vg.get(33)&&Q.add(1),Q.add(8));return Q}executeDynamicAddInCommandsAPI(Q){let Ua=
!0;if(void 0===Q||null===Q||void 0===Q[ue.a.gub]||null===Q[ue.a.gub])return xh.Task.Ta(!1);switch(Q[ue.a.gub]){case 1:Ua=this.yZj(Q);break;case 2:Ua=this.SAj(Q);break;case 4:this.G2a.clear();this.G2a.addRange(this.Z7c);break;case 3:Ua=this.installContextualTab(Q);break;default:Ua=!1}return xh.Task.Ta(Ua)}GEj(Q){return Q&&this.ap.wia in Q?(Q=Q[this.ap.wia])?this.G2a.contains(Q):!1:!1}yZj(Q){var Ua=null;let Fb=null,nc=null,Dc=!0;void 0!==Q[ue.a.j4]&&null!==Q[ue.a.j4]&&void 0!==Q[this.ap.wia]&&null!==
Q[this.ap.wia]&&void 0!==Q[ue.a.i4]&&null!==Q[ue.a.i4]&&(Ua=Q[ue.a.j4],Fb=Q[ue.a.m9b],nc=Q[this.ap.wia],Dc=Q[ue.a.i4]);if(!Ua||!nc)return t.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;Q=(new jf.a(this.$.Eb,Ua,this.ap,!0)).eLa(nc);Ua={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ua.AssetId=Fb;Ua.MaskedTabId=Q;Ua.IsToEnable=Dc;t.ULS.sendTraceTag(537170648,220,50,z.a.hc(Ua));this.yYd(Q,Dc);Ni.a.GC.updateCommandUI();return!0}SAj(Q){var Ua,
Fb,nc=null,Dc=null;let cd=null;var kd=null;let qd=!0;void 0!==Q[ue.a.D9c]&&null!==Q[ue.a.D9c]&&void 0!==Q[ue.a.j4]&&null!==Q[ue.a.j4]&&void 0!==Q[this.ap.wia]&&null!==Q[this.ap.wia]&&void 0!==Q[ue.a.i4]&&null!==Q[ue.a.i4]&&(nc=Q[ue.a.D9c],Dc=Q[ue.a.j4],cd=Q[ue.a.m9b],kd=Q[this.ap.wia],qd=Q[ue.a.i4]);if(!nc||!Dc||!kd)return t.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;Q=(new jf.a(this.$.Eb,Dc,this.ap,!0)).X7e(kd);kd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
kd.StoreType=nc;kd.AssetId=cd;kd.MaskedTabId=Q;kd.IsToShow=qd;t.ULS.sendTraceTag(537170646,220,15,z.a.hc(kd));nc=this.sha.sja(nc,Dc,1);Dc=!1;if(null===(Fb=null===(Ua=null===nc||void 0===nc?void 0:nc.So)||void 0===Ua?void 0:Ua.gW)||void 0===Fb?0:Fb.kt)for(let Id of nc.So.gW.kt)if(Id.id===Q){Dc=!0;break}if(!Dc)return t.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ua=[];qd?appChrome.selectors.getSelectedTabId()!==Q&&Ua.push(appChrome.actions.activateRibbonTab(Q)):
(appChrome.selectors.getSelectedTabId()===Q&&Ua.push(appChrome.actions.setCurrentTab(Md.a.FW)),Ua.push(appChrome.actions.deactivateRibbonTab(Q)));appChrome.api.dispatch(Ua);return!0}installContextualTab(Q){let Ua=null,Fb=null,nc=null;var Dc=null;if(void 0!==Q[ue.a.j4]&&null!==Q[ue.a.j4]&&void 0!==Q[ue.a.i4]&&null!==Q[ue.a.i4]){const cd=Q[ue.a.i4];Ua=Q[ue.a.j4];void 0!==cd[ue.a.LJa]&&null!==cd[ue.a.LJa]&&void 0!==cd[ue.a.MJa]&&null!==cd[ue.a.MJa]&&(Fb=cd[ue.a.LJa],nc=cd[ue.a.MJa],Dc=cd[ue.a.E9c])}if(!(Ua&&
nc&&Fb&&Dc))return t.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;Q=this.sha.sja(Dc.PrimaryMarketplace.MarketplaceType,Dc.PrimaryMarketplace.SolutionId,1);if(null===Q||void 0===Q?0:Q.So)return t.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;Q={};Q.solutionId=Dc.PrimaryMarketplace.SolutionId;Q.version=Dc.PrimaryMarketplace.SolutionVersion;Q.storeType=Dc.PrimaryMarketplace.MarketplaceType;Q.storeId=Dc.PrimaryMarketplace.MarketplaceRef;
y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Dc.AssetMarketplace?(Q.assetId=Dc.AssetMarketplace.SolutionId,Q.assetStoreId=Dc.AssetMarketplace.MarketplaceRef):(Q.assetId=null,Q.assetStoreId=null):(Q.assetId=Dc.PrimaryMarketplace.SolutionId,Q.assetStoreId=Dc.PrimaryMarketplace.MarketplaceRef);Q.targetType=Dc.WebExtensionOsfControlType;Q.width=Dc.TaskpaneWidth;Q.height=0;Q.isAddinCommands=!0;Dc=new m.a;Dc.add(Q);Q={};Q[ue.a.Gob]=Dc;Q[ue.a.NP]=6;Q[ue.a.LJa]=Fb;
Q[ue.a.MJa]=nc;this.cDb(Q);return!0}}Object(d.a)(gi,"AddinUICommandHandler",null,[166,165,2]);var ti=a(63),ui=a(600),Oi=a(18),Pi=a(16);class Mh extends Hd.a{constructor(Q){super(Q);this.handler=null;this.pHg=()=>{t.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.rd&16384)}]`);const Ua=new od.a;this.$.da.$a(53,Yd=>{t.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Ua.setResult(Yd)});const Fb=Ua.task,nc=new Bd,Dc=he.a.getInstance(),cd=new Xg(this.$,Dc),kd=Cg.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Ya),qd=this.bfj(nc),Id=Cg.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Ya);return dg.TaskExtensions.Aa(dg.TaskExtensions.Fd([Fb,kd,qd,Id],this.la),()=>{t.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(this.$.da,106,this.la,
this.Ya),Yd=>{this.handler=new gi(this.$,Yd.result,nc,new tc,Dc,cd,Jc.a.instance.Jh("Common.IExternalUICommandDefinitionMapping"));t.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Yc([this.handler]);this.$.da.Ga(198,this.handler)},this.la,3)},this.la,3)};this.Mjh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ka.vcb(this.handler),this.$.da.EU(198),this.handler=null):t.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
this.$.da.EU(204);Pi.a(Oi.a,20,this.$.da,198)}}nd(){t.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");ti.a(this.$).add(Object(jd.a)(new ui.a,{kzc:()=>{const Q=this.$.ea.hI&&this.$.ea.Zb&&!!(this.$.rd&16384)&&this.$.isEditMode;this.$.ea.Zb&&t.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${Q}] IsSessionFullyLoaded [${this.$.ea.hI}] IsSessionActive [${this.$.ea.Zb}] ShowCommandUI [${!!(this.$.rd&
16384)}] IsEditMode [${this.$.isEditMode}]`);return Q},TZb:this.pHg,C7b:this.Mjh,M3a:2}))}bfj(Q){const Ua=Cg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);return dg.TaskExtensions.Aa(Ua,()=>{t.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new Qe(Ua.result,Q))},this.la,3)}static ka(Q){Hd.a.Nd(199,new Mh(Q))}}Object(d.a)(Mh,"AddinUICommandHandlerFactory",Hd.a,[]);var oh=a(1192),
vi=a(1195),Xh=a(695);class Bh extends h.a{constructor(Q){super();this.$=Q;this.Fb()}create(){let Q;if(y.EwaSettings.ma(396)){const Ua=Cg.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.Ya),Fb=Cg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Ya);dg.TaskExtensions.Aa(xh.Task.mJ(Ua,Fb),()=>{this.ob(Object(Xh.a)(this.$.da,278,()=>new oh.CustomFunctionsInstaller(this.$,Ua.result,Fb.result)))},this.$.la,3)}else Q=Object(Xh.a)(this.$.da,278,()=>new vi.CustomFunctionsLegacyInstaller(this.$)),
this.ob(Q)}static ka(Q){Q.da.Ga(279,new Bh(Q))}}Object(d.a)(Bh,"CustomFunctionsInstallerFactory",h.a,[]);var hi=a(87),Ch=a(47),Di=a(46);class ii{constructor(Q,Ua){this.XQa=this.YQa=null;this.gfg=(Fb,nc)=>{let Dc=null,cd=null,kd=null;nc?(Object(W.a)(261,nc)?(Dc=nc.dHa,kd=nc.instanceId):Object(W.a)(486,nc)&&(Dc=nc.get_element(),kd=nc.instanceId),Dc)?(cd=Object(O.a)(705,Fb),cd)?this.ORf(kd,Dc,cd)||kd in this.XQa||(this.YQa[kd]=0,this.XQa[kd]=Ch.a.instance.eD(()=>{10<=this.YQa[kd]||this.ORf(kd,Dc,cd)?
(delete this.YQa[kd],this.XQa[kd].dispose(),delete this.XQa[kd]):this.YQa[kd]+=1},500,Di.a.qQg,!0,!1)):t.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):t.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):t.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=Q;this.$=Ua;this.MZc=!1;this.$.da.Ga(224,this)}ka(Q){this.MZc?t.ULS.sendTraceTag(537170629,0,
10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.MZc=!0,this.XQa={},this.YQa={},Q?Q.oMg(this.gfg):t.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(Q){if(Q){Q.ljj(this.gfg);Q=this.XQa;for(let Ua in Q)hi.a.Ia(Q[Ua]);this.YQa=this.XQa=null;this.MZc=!1}else t.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}ORf(Q,Ua,Fb){if(this.Rli(Fb,Q))return!1;
Q=Ua.querySelector("iframe");if(!Q)return t.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;Q=Q.title;if(!Q||!Q.length)return t.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(Q);return!0}Rli(Q,Ua){return(Q=Q.Wh.getOsfControl(Ua))?Q.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(ii,"AgaveOnSelectedReadoutHandler",null,[706]);
class Xc extends h.a{constructor(Q){super();this.$=Q;this.Fb()}create(){const Q=this.$.da;dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.Oa(Q,211,212,this.Ya),Ua=>{Ua=Q.za(224)||new ii(Ua.result,this.$);this.ob(Ua)},this.la,3)}static ka(Q){Q.da.Ga(225,new Xc(Q))}}Object(d.a)(Xc,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var Ed=a(734),bh=a(53);const Ei=(Q,Ua)=>bh.a.pwd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,pd.AFrameworkApplication.fa.ud("MaxRetriesForLoadingScript",
0),Q,Ua);var wi=a(240);class ji{constructor(Q,Ua,Fb){this.iframe=Q;this.onSuccess=Ua;this.onError=Fb;$addHandler(window,"message",Object(be.a)(this,this.V$e,"handleResponse"))}V$e(Q){try{if(Q&&Q.rawEvent&&Q.rawEvent.origin&&this.iframe&&this.iframe.id){var Ua=this.tLf(Q.rawEvent.origin);const Fb=this.tLf(document.domain);if(S.a.cl().equals(Fb,Ua))if(Q.rawEvent.source&&Q.rawEvent.source.frameElement&&Q.rawEvent.source.frameElement.id&&S.a.cl().equals(Q.rawEvent.source.frameElement.id,this.iframe.id)){Ua=
null;try{Ua=JSON.parse(Q.rawEvent.data)}catch(nc){t.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",nc.message)}Ua?(Ua.statusCode!==wi.a.mP||void 0!==Ua.error&&Ua.error?(t.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ua.statusCode,Ua.error),this.onError()):(t.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Ua.authorizationCode?Ua.authorizationCode:Ua.signInUrl)),$removeHandler(window,"message",Object(be.a)(this,this.V$e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):t.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):t.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):t.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else t.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else t.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else t.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Fb){t.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Fb.message)}}tLf(Q){let Ua=
"";try{Q&&(Ua=-1<Q.indexOf("//")?Q.split("/")[2]:Q.split("/")[0])&&(Ua=Ua.split(":")[0],Ua=Ua.split("?")[0])}catch(Fb){t.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Fb.message)}return Ua}static ka(Q,Ua,Fb){new ji(Q,Ua,Fb)}}Object(d.a)(ji,"ResponseHandler",null,[]);var Fi=a(252);class ph{constructor(Q){this.pGa=Q}tryAuthenticate(Q,Ua){this.gbb(ph.hyg,()=>{Q()},Ua)}tryAuthorize(Q,Ua){this.gbb(ph.qtg,Q,Ua)}getSignInUrl(Q,Ua){this.gbb(ph.hle,Q,Ua)}signOut(Q,Ua){this.gbb(ph.iEg,
Q,Ua)}gbb(Q,Ua,Fb){var nc=new Fi.QueryStringBuilder("AuthenticationProxyHandler.aspx");nc.Xi("responseType",Q);pd.AFrameworkApplication.xZa(nc);nc=String.format("{0}{1}&{2}",this.pGa,nc.toString(),pd.AFrameworkApplication.Zi);const Dc=document.createElement("iframe");Dc.setAttribute("id","privateCatalogIframe");Dc.setAttribute("name","privateCatalogIframe");Dc.setAttribute("style","display: none");S.a.cl().equals(Q,ph.hle)||Dc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
ji.ka(Dc,Ua,Fb);Dc.setAttribute("src",nc);document.body.appendChild(Dc)}}ph.qtg="authcode";ph.hyg="identitytoken";ph.hle="signinurl";ph.iEg="signout";Object(d.a)(ph,"AuthenticationProxy",null,[]);class xg{}xg.getUserId="getUserId";xg.getLastStoreUpdate="laststoreupdate";xg.getEntitlement="getEntitlements";xg.getEToken="getEToken";xg.getManifest="getManifest";xg.getAppState="getAppState";xg.getKilledApps="getRemovedAddins";xg.getAppDetails="getAppDetails";xg.removeApps="removeAddin";xg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";xg.getPrivateCatalogAddIns="getAddIns";xg.getPrivateCatalogManifests="getAppManifests";xg.isStoreDisabled="isStoreDisabled";Object(d.a)(xg,"S2SWebRequestActions",null,[]);var Gi=a(575);class Dh{getUserId(Q,Ua){const Fb=new m.a;Fb.add(new Td.a("corr",Q));this.fX(xg.getUserId,Fb,1,Ua)}getLastStoreUpdate(Q,Ua,Fb){const nc=new m.a;nc.add(new Td.a("lc",Q));nc.add(new Td.a("corr",Ua));this.fX(xg.getLastStoreUpdate,nc,1,Fb)}getEntitlement(Q,Ua,Fb,nc){Q=new m.a;Q.add(new Td.a("av",
Ua));Q.add(new Td.a("corr",Fb));this.fX(xg.getEntitlement,Q,1,nc)}getEToken(Q,Ua,Fb,nc,Dc,cd){const kd=new m.a;kd.add(new Td.a("cmu",Q));kd.add(new Td.a("cmf",Ua));kd.add(new Td.a("assetid",Fb));kd.add(new Td.a("expver",nc));kd.add(new Td.a("corr",Dc));this.fX(xg.getEToken,kd,1,cd)}getManifest(Q,Ua,Fb,nc){const Dc=new m.a;Dc.add(new Td.a("cmu",Q));Dc.add(new Td.a("assetid",Ua));Dc.add(new Td.a("corr",Fb));this.fX(xg.getManifest,Dc,1,nc)}getAppState(Q,Ua,Fb){const nc=new m.a;nc.add(new Td.a("ma",Q));
nc.add(new Td.a("corr",Ua));this.fX(xg.getAppState,nc,1,Fb)}getKilledApps(Q,Ua){const Fb=new m.a;Fb.add(new Td.a("corr",Q));this.fX(xg.getKilledApps,Fb,1,Ua)}getAppDetails(Q,Ua,Fb,nc){const Dc=new m.a;Dc.add(new Td.a("cmo",Q));Dc.add(new Td.a("corr",Fb));this.sendWithBody(xg.getAppDetails,Dc,Ua,2,nc,!1)}removeApps(Q,Ua,Fb){const nc=new m.a;nc.add(new Td.a("corr",Ua));this.sendWithBody(xg.removeApps,nc,Q,2,Fb,!1)}getLastPrivateCatalogUpdate(Q,Ua,Fb,nc,Dc,cd){const kd=new m.a;kd.add(new Td.a("catalog",
"privatecatalog"));kd.add(new Td.a("clientCode",Q));kd.add(new Td.a("clientVersion",Ua));kd.add(new Td.a("corr",Dc));Q=String.format("authorizationCode={0}&refreshToken={1}",Fb?fg.a.mf(Fb):"",nc?fg.a.mf(nc):"");this.sendWithBody(xg.getLastPrivateCatalogUpdate,kd,Q,2,cd,!0)}getPrivateCatalogAddIns(Q,Ua,Fb,nc,Dc,cd){const kd=new m.a;kd.add(new Td.a("catalog","privatecatalog"));kd.add(new Td.a("clientCode",Q));kd.add(new Td.a("clientVersion",Ua));kd.add(new Td.a("corr",Dc));Q=String.format("authorizationCode={0}&refreshToken={1}",
Fb?fg.a.mf(Fb):"",nc?fg.a.mf(nc):"");this.sendWithBody(xg.getPrivateCatalogAddIns,kd,Q,2,cd,!0)}getPrivateCatalogManifests(Q,Ua,Fb,nc,Dc){const cd=new m.a;cd.add(new Td.a("catalog","privatecatalog"));cd.add(new Td.a("corr",nc));Q=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",fg.a.mf(Q),Ua?fg.a.mf(Ua):"",Fb?fg.a.mf(Fb):"");this.sendWithBody(xg.getPrivateCatalogManifests,cd,Q,2,Dc,!0)}isStoreDisabled(Q,Ua){const Fb=new m.a;Fb.add(new Td.a("corr",Q));this.fX(xg.isStoreDisabled,
Fb,2,Ua)}fX(Q,Ua,Fb,nc){this.sendWithBody(Q,Ua,null,Fb,nc,!1)}sendWithBody(Q,Ua,Fb,nc,Dc,cd){const kd=new Fi.QueryStringBuilder("AddinServiceHandler.ashx");kd.Xi("action",Q);kd.Xi("app",Gi.a[pd.AFrameworkApplication.sa.Pa.Fj]);for(let qd of Ua)kd.Xi(qd.key,qd.value);Ua=String.format("{0}{1}&{2}",pd.AFrameworkApplication.sa.Pa.$V,kd.toString(),pd.AFrameworkApplication.Zi);pd.AFrameworkApplication.Bd.Rm(Ua,nc,Fb,null,!1,2,qd=>{let Id=null,Yd=null;qd&&qd.data&&(qd.data.responseHeaders["X-BlockedForMinor"]&&
"1"===qd.data.responseHeaders["X-BlockedForMinor"].toString()&&(qd.data.httpStatus=451),Id=qd.data.te,Yd=qd.data.responseHeaders);Dc(qd.data.httpStatus,Id,Yd)},qd=>{var Id=null;let Yd=null;cd&&qd&&qd.data&&qd.data.te&&(Id=qd.data.te,Yd=qd.data.responseHeaders);Dc(qd.data.httpStatus,Id,Yd);if(pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Id={message:"AddinServiceHandler request failed"};Id.code=qd.data.httpStatus;Id.action=Q;
if(qd.data.request||qd.data.request.get_headers())Id["X-UserSessionId"]=qd.data.request.get_headers()["X-UserSessionId"];408===qd.data.httpStatus||503===qd.data.httpStatus?t.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Id)):t.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Id))}else t.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",qd.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+Q,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(Dh,"S2SWebRequestManager",
null,[]);class ki extends h.a{constructor(Q){super();this.NRf=this.ddaFacade=null;this.$=Q;Q.da.Ga(106,this);this.Fb()}get ie(){return this.ddaFacade||(this.ddaFacade=new Ed.DdaFacade(this.$,this.NRf))}create(){t.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");pd.AFrameworkApplication.disableWholeAppsForOfficeFeature?t.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${pd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
y.EwaSettings.ma(400)?Jc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Q=>{Q.isFeatureEnabled("mso_officeStore",!0).then(Ua=>{Ed.DdaFacade.I5b=Ua;this.FIe();return null})}):this.FIe()}FIe(){const Q=Cg.GetServiceTaskFactory.Oa(this.$.da,224,225,this.Ya),Ua=bh.a.pwd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.va.MaxRetriesForLoadingScript,this.$.la,this.Ya,106),Fb=Ei(this.la,this.Ya);dg.TaskExtensions.Aa(dg.TaskExtensions.Fd([Q,Ua,Fb],this.$.la),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?t.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${fi.a.jZ()}`):this.qgi();t.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.NRf=Q.result;this.ob(this.ie);t.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}qgi(){y.EwaSettings.ma(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Dh);
this.$.he.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Dh,new ph(pd.AFrameworkApplication.fa.appSettings.WebServiceBase),y.EwaSettings.ma(71),y.EwaSettings.ma(427));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Dh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Dh)}dispose(){hi.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(Q){new ki(Q)}}Object(d.a)(ki,"DdaFacadeServiceFactory",
h.a,[]);var li=a(460);class Hi{constructor(Q,Ua,Fb,nc,Dc,cd){this.$=Q;this.agaveCommandManager=cd}Jc(){return!1}nc(){return!1}wc(Q,Ua,Fb,nc){let Dc=!1;switch(Ua.command){case -684355545:Dc=!0;break;case -741808261:Dc=!!Fb;break;case -859308420:Dc=!!nc&&1===nc.pz;break;case 418618014:Dc=1===Q&&!!nc&&1===nc.pz;break;case -515602470:Ua=y.EwaSettings.ma(232)&&2===Q;Dc=(1===Q||Ua)&&!!nc&&1===nc.pz;break;case 2086613372:Dc=y.EwaSettings.ma(232)&&2===Q&&!!nc&&1===nc.pz;break;case -1336341324:Dc=y.EwaSettings.ma(475)&&
1===Q&&!!nc&&1===nc.pz;break;case 451940422:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===Q&&!!nc&&1===nc.pz;break;case -1444574190:case -336193495:Dc=1===Q&&!!nc&&1===nc.pz;break;case 1296389134:Dc=1===Q&&!!nc&&1===nc.pz;break;case -1473679467:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===Q&&!!nc&&1===nc.pz;break;case 1221897806:Dc=y.EwaSettings.ma(164)&&2===Q;break;case 1172793074:case 1930653487:Dc=
y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===Q;break;case -1753056834:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Dc=!0;break;case 301511274:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Dc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Dc=this.$.isEditMode&&
this.$.ea.eNb}return Dc}executeCommand(Q,Ua,Fb){let nc=dg.TaskExtensions.Rj();const Dc=Ua.command;switch(Ua.command){case -1473679467:li.a(this.$,488,489,1,cd=>{nc=cd.mji(Fb.SourceControlId,Ua)});break;case 1296389134:this.agaveCommandManager.gNj(Fb.SourceControlId,Fb.LabelText);break;case -684355545:this.agaveCommandManager.h1c();break;case -741808261:nc=this.agaveCommandManager.insertAgave(Fb,Ua);li.a(this.$,488,489,1,cd=>{cd.SHg(Fb)});break;case -1336341324:y.EwaSettings.ma(475)&&(nc=this.agaveCommandManager.Lkd(Fb,
Q,Ua));break;case 1172793074:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(nc=this.agaveCommandManager.Lkd(Fb,Q,Ua));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:nc=this.agaveCommandManager.Lkd(Fb,Q,Ua);break;default:nc=ei.a(Dc)}return nc}}Object(d.a)(Hi,"AgaveCommandHandler",null,
[165]);class Th{}Object(d.a)(Th,"Selection",null,[]);var mi=a(1303),Uh=a(1302),tg=a(1304),Dg=a(1394),xi=a(1305);class Jh{}Object(d.a)(Jh,"SmartLookupApplicationInterface",null,[]);class Ii{}Object(d.a)(Ii,"ApplicationProperties",null,[]);class ni{}Object(d.a)(ni,"EnterpriseUserInfo",null,[]);class Kh{}Object(d.a)(Kh,"FeatureGates",null,[]);class oi{constructor(Q,Ua,Fb=!0){this.eTj=9E5;this.hTj=3E5;this.Txd=null;this.Vsf="";this.Qxd=0;this.rtb=Date.now;this.Gya=Q;this.O9a=Ua;Fb&&this.dfd()}h4h(){const Q=
this.rtb();if(Q<this.Qxd+this.eTj)return Q>this.Qxd+this.hTj&&this.dfd(),this.Vsf;this.dfd();return""}dfd(){this.Txd=this.Txd||new Promise(Q=>{this.i4h().then(Ua=>{this.Vsf=Ua;this.Qxd=this.rtb();this.Txd=null;Q(Ua)})})}i4h(){return this.O9a&&this.O9a.length?new Promise(Q=>{this.Gya.UL("SmartLookup",this.O9a).then(Ua=>{Ua.IsSuccess?Ua.Token||(Q(""),t.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(t.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Ua.ErrorCode+": "+Ua.ErrorMessage),Q(""));Q(Ua.Token)}).catch(Ua=>{Ua=Mf.c(Ua);t.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ua);Q("")})}):(t.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(oi,"SmartLookupAuthenticationManager",null,[740]);class pf{static XUh(){switch(Object(O.a)(String,pd.AFrameworkApplication.Pb.AudienceGroup)||""){case "Dogfood":if(pd.AFrameworkApplication.fa){let Q=
pd.AFrameworkApplication.fa.Xa("UserPrincipalName");Q=fg.a.vl(Q);const Ua=pd.AFrameworkApplication.fa.$p("SmartLookupINTEnabledForSKITeam")?pd.AFrameworkApplication.fa.Fw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ua,Q)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static I3h(){switch(pd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":pd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":pd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":pf.XUh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(pf,"Utils",null,[]);var Nh=a(556),ch=a(170);class Gg{constructor(Q){t.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Btf=pd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.REi=pd.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.O9a=pd.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");this.vFi=Rg.a.kN(pd.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.N9a=new Kh;this.N9a.EnableAllTabV2=!0;this.N9a.EnableIntentService=!0;this.N9a.EnableInDocumentSearch=pd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.N9a.EnableLocalSearch=pd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.N9a.IntentServiceEndpoint=
pf.I3h();this.qFi=new oi(Q,this.O9a)}get approvedOriginPattern(){return this.REi}uPh(){return Promise.resolve(this.vPh())}vPh(){const Q=new Ii;Q.anid="";Q.applicationVersion=pd.AFrameworkApplication.buildVersion;Q.appCorrelationId=ch.a.create().toString();Q.themePlatform=Gg.w4j;Q.lcid=pd.AFrameworkApplication.lcid;Q.launchUtcTime=(new Date).toUTCString();Q.featureGates=this.N9a;var Ua=Nh.a.uK(pd.AFrameworkApplication.lcid);Ua=Ua?Ua.name:null;Q.market=this.ucc(Ua);Q.uiLanguage=Ua;Q.sessionId=pd.AFrameworkApplication.userSessionId;
Q.themeId=0;Q.parentalControl=Gg.L3i;const Fb=new ni;Fb.CountryCode=this.ucc(Ua);Fb.ServiceEndpoint=this.O9a;Fb.IsGoLocal=!1;Fb.IsEnabled=this.Btf;Fb.IsEnterpriseEnabled=this.Btf;Fb.TenantRoot=this.vFi;Q.enterpriseUserInfo=Fb;Q.accessToken=this.qFi.h4h();return Q}ucc(Q){Q=Q.split("-");return Q[Q.length-1]}}Gg.w4j="web";Gg.L3i="yes";Object(d.a)(Gg,"SmartLookupManager",null,[731]);class Hg extends jg.a{constructor(Q){super();this.$=Q;this.isFirstLaunch=!1}Jc(){return!1}nc(){return!1}wc(Q,Ua){Q=y.EwaSettings.ma(134);
return-983891024===Ua.command&&Q}executeCommand(Q,Ua){Q=dg.TaskExtensions.Rj();-983891024===Ua.command&&this.Tyi();return Q}Tyi(){var Q=new Gg(null);const Ua={};var Fb=Fg.h(this.$).Sb(null).originalText;Fb=Object(jd.a)(new Th,{neighborhood:Fb,mentionStart:0,mentionLength:Fb?Fb.length:0});const nc=Object(jd.a)(new Jh,{selection:Fb,entryPoint:0});Q.uPh().then(cd=>{cd.applicationName=Hg.appName;cd.isFirstLaunch=this.isFirstLaunch;cd.themeId=5;Ua[Hg.smartLookupApplicationInterface]=JSON.stringify(nc);
Ua[Hg.GRg]=JSON.stringify(cd);this.isFirstLaunch=!1});Q=new mi.a("ExcelOnline","Web","en-Us");Fb=new Uh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Dc=new tg.a;Dc.optionalProperties[Dg.a.Ri]=ff.a.instance.ga(1799);Dc.optionalProperties[Dg.a.taskPaneWidth]=350;Dc.optionalProperties[Dg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Dc.dh=Ua;xi.a.instance.j6(Fb,"Taskpane","SmartLookupSDXTaskpane",Q,Dc)}}Hg.GRg="AppProperties";Hg.appName="Excel";Hg.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(d.a)(Hg,"SmartLookupCommandHandler",jg.a,[165]);class Yh extends Hd.a{constructor(Q){super(Q)}nd(){li.a(this.$,374,375,this.Ya,Q=>{this.Yc([new Hi(this.$,null,null,null,null,Q),new Hg(this.$)])})}static ka(Q){Hd.a.Nd(76,new Yh(Q))}}Object(d.a)(Yh,"AgaveCommandHandlerFactory",Hd.a,[]);var Zh=a(1318),Eh=a(105);class sh{constructor(){this.ie=null;this.Lbb=(Q,Ua,Fb,nc,Dc)=>{if(2===Fb){Q=Dc?Dc:{};Ua=Q.callback;Fb=Q.refresh?Q.refresh:!1;if(!Ua)return 16;pd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=Q.storeType?this.ie.uPf(Ua,Fb,Q.storeType):this.ie.Ada(Ua,Fb)}return 32};this.Zfj=(Q,Ua,Fb,nc,Dc)=>{2===Fb&&(Q=Dc?Dc.callback:null)&&this.ie.nMg(Q);return 32};this.lji=(Q,Ua,Fb,nc,Dc)=>{2===Fb&&this.ie.eEd(null,OSF.AgaveHostAction.InsertAgave,Dc);return 32}}initialize(Q){sh.initialized||(this.ie=Q,this.Fg(),sh.initialized=!0)}Fg(){pd.AFrameworkApplication.ub.Me(ve.a.Lbb,Eh.a.frame,this.Lbb,96);pd.AFrameworkApplication.ub.Mb(ve.a.Sej,Eh.a.frame,this.Zfj);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&pd.AFrameworkApplication.ub.Me(ve.a.lff,Eh.a.frame,this.lji,96)}static get instance(){sh.Ma||(sh.Ma=new sh);return sh.Ma}}sh.Ma=null;sh.initialized=!1;Object(d.a)(sh,"AgaveCommandActor",null,[]);var dh=a(1360),pi=a(1307),$h=a(111),ai=a(354),Qi=a(351),Ri=a(1238),Vg=a(19),Ji=a(346);class yi{constructor(){this.QYd=this.SBc=null;this.wq=0;this.QBc=null}}Object(d.a)(yi,"FirstPartyAddinTaskpaneOverrides",null,[]);class qi{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(d.a)(qi,"IdeasSelectionContext",null,[]);class zi extends qi{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(zi,"IdeasTableSelectionContext",qi,[]);class Fh{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(Fh,"AutoFilterRange",
null,[]);class ri{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(ri,"IdeasAutoFilterSource",null,[]);class Ai{constructor(Q,Ua){this.selection=Q;this.tables=Ua}}Object(d.a)(Ai,"IdeasXLIMTableBoundaries",null,[]);var Pg=a(60);const bi=(Q,Ua,Fb,nc,Dc,cd,kd=null)=>{kd=Q.Na(9,kd);kd.sharedInfo=Ua;return Pg.g(Q,"ShowAgaveTaskpane",kd,Fb,nc,Dc,cd,0)};var eh=a(857),Rh=a(64),Bi=a(132),Oh=a(42),ug=a(371),Vh=a(188),Ci=a(162),Si=a(564),$f=a(281),Gh=a(103),Ki=
a(133),ci=a(51),th=a(146),K=a(180);class ob extends th.a{constructor(){super();this.Afa="calc(100% - 46px)";this.RDa="15px";this.Bfa="0";this.VJc="WACDialogPanel";this.ZX=695;this.WJc=462;this.wqa="80%";this.KHc=350;this.Lhb="100%";this.Rb=5;this.Ee="AppsForOfficeInsertionDialog";this.hKc=!!pd.AFrameworkApplication.fa&&pd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Zz(){super.Zz();this.Vk.style.width=this.Lhb;this.Vk.style.height=this.Afa;this.Vk.style.marginTop=this.RDa;
this.Vk.style.padding=this.Bfa}rAa(){this.Vk.style.width=this.Lhb;this.Vk.style.height=this.Afa;this.Vk.style.marginTop=this.RDa;this.Vk.style.padding=this.Bfa;this.ZX>K.a.Zma?(this.wb.style.width=String.format("{0}px",K.a.Zma),this.wb.style.overflowX="scroll",pd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.ZX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>K.a.Yma||this.WJc+50>K.a.Yma?(this.wb.style.height=String.format("{0}px",
K.a.Yma),this.wb.style.overflowY="scroll",this.wb.style.top="0",pd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.hKc||(this.wb.style.marginTop="-48px"),this.Vk.style.minHeight=String.format("{0}px",this.KHc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.wqa);this.nta()}nta(){if(this.wb){var Q=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.ZX>K.a.Zma)pd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft=
"0";else{const Ua=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));pd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ua:this.wb.style.marginLeft=Ua;pd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(Q)}else t.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}YI(){super.YI();const Q=document.getElementById(this.mi(this.VJc));Q.style.width=String.format("{0}px",this.ZX);Q.style.height=this.wqa}get Pia(){return this.Vk}}
Object(d.a)(ob,"AppsForOfficeInsertionDialog",th.a,[339]);class Sb extends th.a{constructor(){super();this.Afa="calc(100% - 46px)";this.RDa="15px";this.Bfa="0";this.VJc="WACDialogPanel";this.ZX=695;this.WJc=462;this.wqa="80%";this.KHc=350;this.Lhb="100%";this.Rb=5;this.Ee="SDXDialog"}Zz(){super.Zz();this.Vk.style.width=this.Lhb;this.Vk.style.height=this.Afa;this.Vk.style.marginTop=this.RDa;this.Vk.style.padding=this.Bfa}rAa(){this.Vk.style.width=this.Lhb;this.Vk.style.height=this.Afa;this.Vk.style.marginTop=
this.RDa;this.Vk.style.padding=this.Bfa;this.ZX>K.a.Zma?(this.wb.style.width=String.format("{0}px",K.a.Zma),this.wb.style.overflowX="scroll",pd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.ZX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>K.a.Yma||this.WJc+50>K.a.Yma?(this.wb.style.height=String.format("{0}px",K.a.Yma),this.wb.style.overflowY="scroll",this.wb.style.top="0",pd.AFrameworkApplication.isRtl?this.wb.style.right=
"0":this.wb.style.left="0",this.Vk.style.minHeight=String.format("{0}px",this.KHc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.wqa);this.nta()}nta(){if(this.wb){var Q=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.ZX>K.a.Zma)pd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft="0";else{const Ua=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));pd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Ua:this.wb.style.marginLeft=
Ua;pd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(Q)}else t.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}YI(){super.YI();const Q=document.getElementById(this.mi(this.VJc));Q.style.width=String.format("{0}px",this.ZX);Q.style.height=this.wqa}get Pia(){return this.Vk}}Object(d.a)(Sb,"SDXDialog",th.a,[]);var kc=a(959),yc=a(145),bd=a(573),Fd;(function(Q){Q[Q.Valid=2]="Valid";Q[Q.Invalid=4]="Invalid";Q[Q.All=
6]="All"})(Fd||(Fd={}));Object(d.b)("MetadataState",Fd);var Nd=a(343);class Rd extends jg.a{constructor(Q,Ua,Fb,nc,Dc){super();this.xBa={};this.cdd={};this.dAa=this.sdxDialog=this.i5=null;this.ocb=!1;this.p$h=(cd,kd,qd,Id,Yd)=>{if(2!==qd)return 32;cd=Yd[kc.a.bvb];kd=Yd[kc.a.fZ];qd=Yd[kc.a.jW];Yd=new dh.a;Yd.Ugc=qd.optionalProperties.InstanceToken;Yd.sourceLocationOverrideResourceId=qd.optionalProperties[Dg.a.sourceLocationOverrideResourceId];Yd.JB=qd.dh;Yd.fZ=kd;kd=null!=Yd.Ugc?Yd.Ugc:(new Ca.a(ch.a.create(),
1)).toString();qd=null!=Yd.JB?Yd.JB:{};Id={};Id.id=kd;Id.solutionId=cd.getId();Id.version=cd.tDa;Id.storeType=cd.getStoreType();Id.storeId=cd.getStoreId();Id.assetId=null;Id.assetStoreId=null;Id.settings=qd;Id.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Id.osfControlType=OSF.OsfControlType.ContainerLevel;Id.sourceLocationOverrideResourceId=Yd.sourceLocationOverrideResourceId;Id.featureGates=pd.AFrameworkApplication.fa.T2e(cd.getId());this.Clc(Yd,Id);return 32};this.xlc=(cd,
kd,qd,Id,Yd)=>{2===qd&&(this.i5=new ob,this.i5.initializeAndShow("",null,null),cd=Yd.CommandValueId,kd=[],kd.push(Yd.SourceControlId),kd.push(cd),kd.push(null),this.ie.Dpf(this.i5.Pia,kd));return 32};this.Clc=(cd,kd)=>{this.sdxDialog=new Sb;this.sdxDialog.initializeAndShow("",null,null);kd.div=this.sdxDialog.Pia;cd={};cd.InstanceId=kd.id;cd.WebExtensionType=2;cd.PrimaryMarketplace={};cd.PrimaryMarketplace.SolutionId=kd.solutionId;cd.PrimaryMarketplace.MarketplaceType=kd.storeType;cd.PrimaryMarketplace.MarketplaceRef=
kd.storeId;cd.PrimaryMarketplace.SolutionVersion=kd.version;cd.SrcLocationOverrideResourceId=kd.sourceLocationOverrideResourceId;cd.WebExtensionOsfControlType=6;this.xBa[kd.solutionId]=kd.settings;cd.OsfPropertyBag=this.gnc([],kd.solutionId);this.ie.SIa(cd);this.ie.Wh.insertOsfControl(kd)};this.Fai=(cd,kd,qd,Id,Yd)=>{if(2!==qd)return 32;cd=Yd[kc.a.bvb];qd=Yd[kc.a.fZ];Yd=Yd[kc.a.jW];kd=new dh.a;kd.Ugc=Yd.optionalProperties.InstanceToken;kd.Ri=Yd.optionalProperties[Dg.a.Ri];kd.AS=Yd.optionalProperties[Dg.a.AS];
Dg.a.taskPaneWidth in Yd.optionalProperties&&(kd.taskPaneWidth=Yd.optionalProperties[Dg.a.taskPaneWidth]);kd.sourceLocationOverrideResourceId=Yd.optionalProperties[Dg.a.sourceLocationOverrideResourceId];kd.JB=Yd.dh;kd.onTaskPaneClose=Yd.optionalProperties[Dg.a.onTaskPaneClose];kd.fZ=qd;qd=new Eg.a(-859308420,0,2,0,"");Id=cd.getStoreType()===OSF.StoreType.Sdx;const Je=new eh.a;Je.e_=Yd.optionalProperties.HeaderCssClass||Vg.a.bKa;Je.AUa=Yd.optionalProperties.TitleCssClass;this.c8(qd,cd.getId(),kd,Id,
Je);return 32};this.qai=(cd,kd,qd,Id,Yd)=>{if(2!==qd)return 32;cd=Yd[kc.a.bvb].getId();Yd=Yd[kc.a.jW].optionalProperties[Dg.a.sourceLocationOverrideResourceId];return cd?(this.ie.Wh.refreshOsfControl(cd,Yd),32):8};this.i7i=cd=>{cd=cd.Result;if(cd=null===cd?null:cd.SolutionId)this.ie.tpe(cd),Gh.a(this.$).Yna(3,cd)};this.$Mf=(cd,kd)=>{var qd;const Id=(cd=cd.Result)?cd.AgaveData:null;if(Id){var Yd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Id.PrimaryMarketplace.SolutionId,Id.PrimaryMarketplace.MarketplaceType,
null===(qd=null===Id||void 0===Id?void 0:Id.AssetMarketplace)||void 0===qd?void 0:qd.SolutionId,null,null,Id.PrimaryMarketplace.MarketplaceRef);t.ULS.shipAssertTag(537170434,0,Id.TaskpaneWidth===Rd.Hkh,`Taskpane width is ${Id.TaskpaneWidth}, assetId is ${Yd}.`);if(qd=this.cdd[Id.PrimaryMarketplace.SolutionId])qd.SBc&&(Id.TaskpaneTitle=qd.SBc),qd.QBc&&(Id.TaskpaneIconId=qd.QBc),qd.QYd&&(Id.TaskpaneButtonTooltip=qd.QYd),0<qd.wq&&(Id.TaskpaneWidth=qd.wq);kd&&(Id.FocusOnIframeWhenLoaded=kd.focusOnIframeWhenLoaded,
kd.width&&(Id.TaskpaneWidth=kd.width),Id.TaskpaneIconCssClass=kd.dl,Id.TaskpaneHeaderCssClass=kd.e_,Id.TaskpaneTitleCssClass=kd.AUa,Id.IsFirstPartyOptOutAppContextOptmization=kd.isFirstPartyOptOutAppContextOptmization);this.xBa[Id.PrimaryMarketplace.SolutionId]&&(Id.OsfPropertyBag=this.gnc(Id.OsfPropertyBag,Id.PrimaryMarketplace.SolutionId));Si.a(Id)||(Id.WebExtensionOsfControlType=1);Id&&(this.ie.tpe(cd.SolutionId),this.ie.SIa(Id))}else t.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};
this.YFh=cd=>{cd&&(this.lcd.dof(cd),this.sBe())};this.dNf=cd=>{cd=cd.toDataURL("image/jpeg");const kd=this.ie.Taa(Rd.Jbf+"."+Rd.yec),qd={};qd.screenshot=cd;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(kd,"onScreenshot",qd,()=>{})};this.M9h=(cd,kd,qd,Id,Yd)=>{if(2!==qd)return 32;if($h.a.ph(Yd)||Yd[kc.a.KFe]!==pi.a.action)return 8;kd=Yd[kc.a.jW];return kd?(cd=(cd=this.$_h(Yd))?this.ie.Taa(cd):null)?(Yd=this.ie.Pah(Yd[kc.a.fZ],kd.optionalProperties[Dg.a.LZb]),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
(qd=this.ie.IZ(cd),qd.TaskpaneTitle!==kd.optionalProperties[Dg.a.Ri]&&(qd.TaskpaneTitle=kd.optionalProperties[Dg.a.Ri],qd.TaskpaneIconCssClass=kd.optionalProperties.IconCssClass,qd.TaskpaneIconUrl=kd.optionalProperties.TaskPaneIconUrl,qd.TaskpaneIconId=kd.optionalProperties.TaskPaneIconId,y.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(kd=this.ie.Wh,kd.changeIframeTitle(cd,qd.TaskpaneTitle),qd=kd.getOsfControl(cd),kd.raiseOsfControlStatusChange(qd)):(kd=this.ie.Wh.getOsfControl(cd),
this.ie.Wh.raiseOsfControlStatusChange(kd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(cd,Yd,this.XLb),32):8:8};this.XLb=(cd,kd)=>{this.ie.zIh(cd,kd)};this.hLd=()=>{dg.TaskExtensions.XJ(Cg.GetServiceTaskFactory.Oa(this.$.da,20,404,1),cd=>{cd.result.F5a()},this.$.la)};this.$=Q;this.viewBlockContainerHelpers=Fb;this.ie=Ua;this.lcd=nc;this.Th=Dc;this.Th.Mb(ve.a.E8f,Eh.a.frame,this.Fai);this.Th.Mb(ve.a.XYf,Eh.a.frame,this.qai);this.Th.Mb(ve.a.QVe,Eh.a.frame,this.M9h);this.Th.Mb(ve.a.Clc,
Eh.a.frame,this.p$h);this.Th.Mb(ve.a.xlc,Eh.a.frame,this.xlc)}fNg(Q){this.addHandler(Rd.oFd,Q)}Vjj(Q){this.removeHandler(Rd.oFd,Q)}dispose(){hi.a.Ia(this.i5);this.i5=null;this.ocb&&(this.$.ea.lo(this.hLd),this.ocb=!1);super.dispose()}h1c(){this.i5.hide()}gNj(Q,Ua){if(Q){this.raiseEvent(Rd.oFd);const Fb=Q.split("|");this.XCi(Q,Ua,Fb);this.i5=new ob;this.i5.initializeAndShow("",null,null);this.ie.Dpf(this.i5.Pia,Fb);y.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&
(window[Rd.CPg]=Q===Rd.pVg?"Backstage":Q===Rd.yqj?"Ribbon":Q===Rd.KQj?"TellMe":"Unknown")}}Lkd(Q,Ua,Fb){var nc=dg.TaskExtensions.Rj();if(-515602470===Fb.command||-336193495===Fb.command||2086613372===Fb.command||-1444574190===Fb.command||-1336341324===Fb.command||451940422===Fb.command)nc=this.e$h(Q,Ua,Fb);418618014===Fb.command&&(Ua=new dh.a,Ua.Ri=ff.a.instance.ga(1812),nc=this.c8(Fb,Rd.Aci,Ua,!0));if((Fb.tabName===this.$.Eb+Md.a.uZf||Fb.tabName===Md.a.v0)&&2===Fb.$e||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
Q[Ug.a.Ic])||Q[Ug.a.Ic]===Md.a.tV)return this.A$e(Q,Fb);if(7===Fb.$e&&Q.SourceControlId===this.$.Eb+Md.a.xec)return Q.MenuItemId=Md.a.eKd,this.A$e(Q,Fb);1221897806===Fb.command&&(nc=this.o8f(Fb,"Format"));if(1930653487===Fb.command||1172793074===Fb.command)nc=this.o8f(Fb,"Data");-1753056834===Fb.command&&(nc=this.TIj(Fb));932597253===Fb.command&&(t.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),yc.c(932597253,!0),Ua=new dh.a,Ua.Ri=ff.a.instance.ga(2153),Ua.sourceLocationOverrideResourceId=
y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Rd.s7i:Rd.u7i,Ua.focusOnIframeWhenLoaded=!0,Ua.taskPaneWidth=Rd.rdf,nc={},nc.LaunchSource=Object(O.a)(String,Q.SourceControlId),nc.LaunchMode="Default",Ua.JB=nc,nc=this.c8(Fb,Rd.t7i,Ua,!0));301511274===Fb.command&&(nc=this.cJj(Fb));if(515196233===Fb.command){Ua=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);if(nc=this.$.da.za(465))nc.Rbf(),Ua&&nc.Oii();
nc=new dh.a;nc.Ri=ff.a.instance.ga(2227);const Dc={};Dc.SourceUILocation=ai.a[Fb.$e];Ua&&(Dc.SessionID=this.$.ea.sessionId,this.MRd(Dc));nc.JB=Dc;Ua=new eh.a;Ua.e_=Vg.a.bKa;nc=this.c8(Fb,Rd.B2i,nc,!0,Ua,void 0,nc.Ri)}1723441034===Fb.command&&(Ua=new dh.a,Ua.Ri=ff.a.instance.ga(2239),Ua.focusOnIframeWhenLoaded=!0,Ua.taskPaneWidth=Rd.k$i,nc=new eh.a,nc.e_=Vg.a.gxh,nc=this.c8(Fb,bd.a,Ua,!0,nc));y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&Q.LoadDataFromPictureTaskpane&&
(Ua={},nc=new dh.a,nc.Ri=ff.a.instance.ga(2266),Ua.SessionID=Q.SessionID,nc.JB=Ua,nc.focusOnIframeWhenLoaded=!0,nc=this.c8(Fb,Q.DataFromPictureAssetId,nc,!0));return nc}insertAgave(Q,Ua){var Fb=dg.TaskExtensions.Rj();const nc=this.$;let Dc;var cd=Q[ue.a.Esa];Dc=Q[Ug.a.lg];let kd=null;eh.a.key in Q&&(kd=Q[eh.a.key]);this.i5&&this.i5.hide();if(!Dc||!cd)return t.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Fb;this.$.O5&&Md.a.Uoa in Q&&(Dc.EnabledInViewMode=Q[Md.a.Uoa]);
Q=this.gSh(Ua.command);if(!Dc.EnabledInViewMode&&!nc.Zp(null,!1,Q))return Fb;let qd=void 0===Dc.IsToBePersisted||null===Dc.IsToBePersisted||Dc.IsToBePersisted?0:16;if(1===Dc.TargetType)Fb=this.Fji(Dc,cd,Ua,kd,qd);else{cd=Fg.h(nc);Fb=this.viewBlockContainerHelpers.bhb(cd);const Id=nc.ea.isNamedObjectViewMode?nc.na.sheetName:nc.na.name;let Yd,Je,Se,vf;Fb?(cd=Fb.ve,Yd=cd.pf.top,Je=cd.pf.left,Se=Fb.lJ.x,vf=Fb.lJ.y):(Yd=Je=1,Fb=this.viewBlockContainerHelpers.NLa(cd),Se=Fb.x,vf=Fb.y);const Kg=this.$.pa.ya.Wb();
qd|=64;Fb=ug.a(this.$.userOperationManager,(rg,lg,mg)=>{var Ag=nc.pa.ya,jh=Yd,fh=Je,kh=Se,si=vf;rg=$f.b(rg,this.i7i);const Mi=Ag.Na(9,Kg);Mi.sharedInfo=Dc;Mi.sheetName=Id;Mi.positionRow=jh;Mi.positionCol=fh;Mi.positionOffsetX=kh;Mi.positionOffsetY=si;return Pg.g(Ag,"InsertWebExtension",Mi,rg,lg,mg,null,0)},rg=>new Vh.a(534,0,rg,qd),Ua)}return Fb}o9g(){var Q=Jc.a.instance.Ub("Common.App.ICustomerFeedbackUiWrapper");if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Ua=Jc.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.lcd?this.lcd.wkb?this.sBe():Ua.instance.m9c(this.YFh):t.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ua={};pd.AFrameworkApplication.fa.Npe(Ua);Q=Q.instance.getContext(Ua);Ua={};"telemetryGroup"in Q&&(Ua=Q.telemetryGroup);Ua.processSessionId=Q.sessionId;Ua.officeBuild=Q.build;Q.telemetryGroup=Ua;Q.feedbackType=-1;Q.userVoiceEnabled=!1;"disableIncludeScreenshot"in Q||(Q.disableIncludeScreenshot=
!1);"screenshot"in Q||(Q.screenshot=!1);Q.disableScreenshotPreview=!1;Q.includeScreenshotSelectedDefault=!0;return Q}tNf(Q){if(!this.dAa&&y.EwaSettings.getBooleanFeatureGate(Rd.uei,!1)){var Ua=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ua=this.Qye(Ua);const Fb=new eh.a;Fb.dl=Vg.a.hbd;Fb.e_=Vg.a.BSe;Fb.AUa=Vg.a.Fad;this.dAa=this.CLb(Ua,null,!1,null,Fb);Ki.b(this.$).Gd(Bi.a.J7i,{["Location"]:Q?ai.a[Q.$e]:0,["InputMethod"]:Q?
Qi.a[Q.method]:0},void 0,!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.J_d()}}MRd(Q){const Ua=this.$.ea.Vg.get(17);Jc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Fb=>{Fb.isFeatureEnabled("mso_sendASmile",Ua).then(nc=>{Q.FeedbackEnabled=Ua&&nc;return null})})}o8f(Q,Ua){const Fb=Fg.h(this.$),nc=new dh.a;var Dc={};Dc.ActiveTab=Ua;Dc.DatapaneFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);Dc.AceFlighting=!0;Dc.ChartNewSDXRecording=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Dc.ThemeColorsFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Dc.UOMirror=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Dc.FormatTaskPaneAceButtonDark=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);Dc.FormatTaskPaneBetterFeedbackButton=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Dc.FormatTaskPaneBetterScrollbar=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);Dc.FormatTaskPaneUXImprovePhase2=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.MRd(Dc);Dc.startTimeMs=Date.now();Dc.UserSessionId=this.$.va.UserSessionId;(Ua=Fb.ha.Ra.qo)&&(Dc.SubSelection=
Ua);t.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Dc.UserSessionId}, UILocation: ${void 0===Q.$e||null===Q.$e?"Null":ai.a[Q.$e]}, SubSelection: ${Ua||"ChartRoot"}`);nc.JB=Dc;nc.Ri=ff.a.instance.ga(979);Dc=new eh.a;Dc.e_=Vg.a.bKa;return this.c8(Q,Rd.f3g,nc,!0,Dc)}TIj(Q){const Ua=new dh.a;Ua.JB={};Ua.Ri=ff.a.instance.ga(1798);Ua.AS=Rd.bqf;const Fb=new eh.a;Fb.e_=Vg.a.bKa;return this.c8(Q,Rd.bqf,Ua,!0,Fb,void 0,Ua.Ri)}cJj(Q){const Ua=new dh.a;Ua.JB={};Ua.Ri=ff.a.instance.ga(2177);
const Fb=new eh.a;Fb.e_=Vg.a.Gyh;Fb.AUa=Vg.a.FSe;return this.c8(Q,Rd.vKi,Ua,!0,Fb)}A$e(Q,Ua){const Fb=Rd.Jbf;var nc=Q[Ug.a.Ic].toString();const Dc={},cd=new dh.a;cd.Ri=ff.a.instance.ga(9);switch(nc){case "A0":Dc.query=(Q[Ug.a.lg]||"").split("|").slice(2,Ji.a.QS).join("|");break;case "A1":Dc.query=Q.CommandValueId;break;case "Help":Dc.gwdropdownflightinfo=y.EwaSettings.ma(237);Dc.query="";break;case Md.a.eKd:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(cd.Ri=ff.a.instance.ga(1764),cd.sourceLocationOverrideResourceId=Rd.yec,Dc.feedback=this.o9g()):Dc.query=nc;break;case "HelpArticle":Dc.query=Q[Ug.a.lg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Dc.query=nc;break;default:return xh.Task.Ta(!0)}cd.JB=Dc;nc=new eh.a;nc.e_=Vg.a.bKa;return this.c8(Ua,Fb,cd,!1,nc,Q[Md.a.Uoa]||!1)}Qye(Q){const Ua={};y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ua.SolutionId=Rd.dxa,Ua.Version="0.0.0.0",
Ua.StoreType=OSF.StoreType.Sdx,Ua.StoreId=OSF.StoreType.Sdx,Ua.AssetId=null,Ua.AssetStoreId=null,Ua.Height=0,Ua.Width=0):(Ua.Version="0.0.0.0",Ua.AssetId=Rd.dxa,Ua.SolutionId=Rd.dxa,Ua.AssetStoreId="",Ua.StoreType=OSF.StoreType.Sdx,Ua.Height=0,Ua.Width=0,Ua.StoreId=OSF.StoreType.Sdx);Ua.TargetType=OSF.OsfControlTarget.TaskPane;Ua.IsToBePersisted=!1;Ua.SourceLocationOverrideResourceId=Q;Ua.SharedRuntimeId=Q;return Ua}e$h(Q,Ua,Fb){function nc(){kd.LaunchMode="Default";y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Dc.Ri=ff.a.instance.ga(1811);Dc.AS=Rd.BYc;Dc.dl=Vg.a.hbd;cd.dl=Vg.a.hbd}const Dc=new dh.a,cd=new eh.a,kd={};this.dAa&&this.MRd(kd);kd.LaunchSource="";kd.StartTimeMs=Date.now();kd.CorrelationId=ch.a.create().toString();Dc.JB=kd;Dc.focusOnIframeWhenLoaded=!0;Dc.taskPaneWidth=Rd.rdf;cd.e_=Vg.a.BSe;cd.AUa=Vg.a.Fad;switch(Fb.command){case -1444574190:let Yd;kd.LaunchMode="RecommendedPivotTables";
kd.SelectionContext="";kd.LaunchSource="PivotTableHandRaise"===Object(O.a)(String,Q.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&Q.SourceSelection){var qd=Q.SourceSelection.split(",")[0];Ua=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:qd,LQf:Yd,range:Id}=Oh.Z(qd,this.$.xa)).returnValue&&!Fg.h(this.$).Bb.J5(Id))Q=this.$.xa.getItemByName(qd),
kd.SelectionContext=JSON.stringify(Object(jd.a)(new qi,{address:Yd,addressWithSheet:qd+"!"+Id.Cz(!1),sheetId:Rh.d(Q),sheetName:qd,isSheetEmpty:!1,columnCount:Id.width,rowCount:Id.height,columnIndex:Id.left+Ua,rowIndex:Id.top+Ua,selectionType:"Continuous"}));else if((Q=this.$.Cb.getItemByName(Object(O.a)(String,Q.SourceSelection)))&&Rh.n(Q)){var Id=Ci.a(Q,!0);qd=this.$.xa.getItemByName(Q.sheetName);kd.SelectionContext=JSON.stringify(Object(jd.a)(new zi,{tableName:Q.name,hasTableHeaders:Ci.d(Q),isPivotTable:!1,
isTable:!0,userSelectedPivotTable:!1,address:Id.Cz(!1),addressWithSheet:qd.name+"!"+Id.Cz(!1),sheetId:Rh.d(qd),sheetName:qd.name,isSheetEmpty:!1,columnCount:Id.width,rowCount:Id.height,columnIndex:Id.left+Ua,rowIndex:Id.top+Ua,selectionType:"Continuous"}))}}y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Dc.Ri=ff.a.instance.ga(1810);
Dc.AS=Rd.G5i;Dc.dl=Vg.a.XUe;cd.dl=Vg.a.XUe;break;case -336193495:kd.LaunchMode="RecommendedCharts";y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Dc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Dc.Ri=ff.a.instance.ga(1809);Dc.AS=Rd.ydj;Dc.dl=Vg.a.YUe;cd.dl=Vg.a.YUe;break;case -1336341324:if(!y.EwaSettings.ma(475))return xh.Task.Ta(!1);kd.LaunchMode="NL";Dc.AS=Rd.BYc;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Dc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Dc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(y.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Dc.Ri=ff.a.instance.ga(1814);kd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Dc.Ri=ff.a.instance.ga(1815);kd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Dc.Ri=ff.a.instance.ga(1813),kd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!y.EwaSettings.ma(232))return xh.Task.Ta(!1);
kd.LaunchMode="ChartDesigner";kd.LaunchSelectionMode=Ua.toString();y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Dc.Ri=ff.a.instance.ga(1816);Dc.AS=Rd.BYc;break;case 451940422:kd.LaunchSource="AutoFilter";Id=JSON.parse(Q.CommandValueId);kd.AutoFilterSource=JSON.stringify(Object.assign(new ri,{autoFilterRange:{sheetName:Id.AutoFilterRange.SheetName,
firstColumn:Id.AutoFilterRange.FirstColumn,lastColumn:Id.AutoFilterRange.LastColumn,firstRow:Id.AutoFilterRange.FirstRow,lastRow:Id.AutoFilterRange.LastRow},autoFilterType:Id.AutoFilterType,itemIndex:Id.ItemIndex,id:Id.Id}));nc();break;default:y.EwaSettings.ma(232)&&(kd.LaunchSelectionMode=Ua.toString()),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(kd.XlimTableBoundaries=this.i5h()),nc()}y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Dc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Dc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.dAa?this.dAa.jp(()=>this.D1f(kd,Dc)):this.Qhi(Fb,Dc,cd,kd)}Qhi(Q,Ua,Fb,nc){const Dc=this.Qye(Ua.sourceLocationOverrideResourceId);this.dAa=this.CLb(Dc,Ua,!1,Q,Fb,!1);return y.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(nc.NoActionMsgOnFirstInstance=!0,this.xBa[Rd.dxa]=nc,this.dAa):this.dAa.jp(()=>this.D1f(nc,Ua))}D1f(Q,Ua){const Fb=
this.ie.Taa(this.ie.w4a(Rd.dxa,Ua.sourceLocationOverrideResourceId));if(Fb){this.xBa[Rd.dxa]=Q;const nc=this.gnc(this.ie.IZ(Fb).OsfPropertyBag,Rd.dxa);this.ie.IZ(Fb).OsfPropertyBag=nc}this.j6(Rd.dxa,"LaunchIdeasAction",Q,Ua);return xh.Task.Ta(!0)}c8(Q,Ua,Fb=null,nc=!1,Dc=null,cd=!1,kd=null){dg.TaskExtensions.Rj();Fb||(Fb=new dh.a);const qd={};y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(qd.SolutionId=Ua,qd.Version="0.0.0.0",qd.StoreType=nc?OSF.StoreType.Sdx:
OSF.StoreType.FirstParty,qd.StoreId=nc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,qd.AssetId=null,qd.AssetStoreId=null,qd.Height=0,qd.Width=0):(qd.Version="0.0.0.0",qd.AssetId=Ua,qd.SolutionId=Ua,qd.AssetStoreId="",qd.StoreType=nc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,qd.Height=0,qd.Width=0,qd.StoreId=nc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty);qd.TargetType=OSF.OsfControlTarget.TaskPane;qd.IsToBePersisted=!1;qd.SourceLocationOverrideResourceId=Fb.sourceLocationOverrideResourceId;if(Fb.Ri||
kd)this.cdd[Ua]=Object(jd.a)(new yi,{SBc:Fb.Ri,QYd:kd,QBc:Fb.AS});y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Fb.JB||(Fb.JB={}),Fb.JB.ShowFeedback=this.$.isFeedbackEnabled,this.xBa[Ua]=Fb.JB):Fb.JB&&(this.xBa[Ua]=Fb.JB);Ua={};Ua[Ug.a.lg]=qd;kd={};kd.solutionId=qd.SolutionId;kd.version=qd.Version;kd.storeType=qd.StoreType;kd.storeId=qd.StoreId;kd.assetId=qd.AssetId;kd.assetStoreId=qd.AssetStoreId;kd.height=qd.Height;kd.targetType=
qd.TargetType;kd.width=qd.Width;kd.isAddinCommands=!nc;Ua[ue.a.Esa]=kd;Dc||(Dc=new eh.a);Dc.focusOnIframeWhenLoaded=Fb.focusOnIframeWhenLoaded;Dc.width=Fb.taskPaneWidth;Ua[eh.a.key]=Dc;Ua[Md.a.Uoa]=cd;return this.insertAgave(Ua,Q)}Fji(Q,Ua,Fb,nc,Dc){const cd=(Yd,Je)=>{var Se=Yd.SolutionId;var vf=OSF.OsfControl.isFirstPartyStoreString(Yd.StoreType);vf&&Yd.SourceLocationOverrideResourceId&&(Se=this.ie.w4a(Se,Yd.SourceLocationOverrideResourceId));var Kg=this.ie.mCe(Se,null,Yd.SharedRuntimeId);vf&&(y.EwaSettings.ma(291)&&
Kg&&(vf=this.ie.Taa(Se))&&(Se=null,Se=this.gnc(this.ie.IZ(vf).OsfPropertyBag,Yd.SolutionId),(vf=this.ie.Wh.getOsfControl(vf))&&vf.setSettings(Se)),Yd.SharedRuntimeId&&Kg||this.ie.Wh.refreshOsfControl(Yd.SolutionId,Yd.SourceLocationOverrideResourceId));if(!Kg){const rg=this.$.pa.ya.Wb();let lg=519;Kg=(mg,Ag,jh)=>{var fh=this.$.pa.ya;mg=$f.b(mg,this.$Mf);const kh=fh.Na(9,rg);kh.sharedInfo=Yd;return Pg.g(fh,"InsertAgaveTaskpane",kh,mg,Ag,jh,nc,0)};void 0===Yd.IsToBePersisted||null===Yd.IsToBePersisted||
Yd.IsToBePersisted||(lg=538,Kg=(mg,Ag,jh)=>{const fh=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.SolutionId,Yd.StoreType,Yd.AssetId,null,null,Yd.StoreId);t.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Yd.StoreType}, StoreId ${Yd.StoreId}, SolutionId ${fh}.`);return bi(this.$.pa.ya,Yd,$f.b(mg,this.$Mf),Ag,jh,nc,rg)});Dc|=64;return ug.a(this.$.userOperationManager,Kg,mg=>new Vh.a(lg,0,mg,Dc),Je)}return dg.TaskExtensions.tba()},kd=Yd=>{var Je=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.solutionId,
Yd.storeType,Yd.assetId,null,null,Yd.storeId);t.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Je} from ${Yd.storeType}.`);Je={};const Se=new m.a;Se.add(Yd);Je[ue.a.Gob]=Se;Je[ue.a.NP]=3;Yd=new Eg.a(ve.a.bDb,0,this.$.Hc,0,null);return this.$.Ka.Lb(Yd,Je)};if(!y.EwaSettings.ma(53)||Q.StoreId===OSF.StoreType.FirstParty)return cd(Q,Fb,nc);if(Ua.isAddinCommands)return kd(Ua);const qd=new od.a,Id={};y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Id.solutionId=
Q.SolutionId,Id.version=Q.Version):(Id.marketplaceId=Q.SolutionId,Id.marketplaceVersion=Q.Version);Id.storeType=Q.StoreType;Id.storeId=Q.StoreId;Id.targetData=Q;y.EwaSettings.ma(93)&&(Id.clearCache=!0);this.ie.Wh.isAddinCommandsAsync(Id,(Yd,Je,Se)=>{qd.setResult(Je);Yd||(Yd=Se.targetData,Je=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.SolutionId,Yd.StoreType,Yd.AssetId,null,null,Yd.StoreId),t.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Je} from ${Yd.StoreType} during addin inserting`))});
return dg.TaskExtensions.ts(qd.task,Yd=>Yd.result?kd(Ua):cd(Q,Fb,nc),this.$.la)}gnc(Q,Ua){if(!this.xBa[Ua])return Q;const Fb={};if(Q)for(const Dc of Q)Fb[Dc[0]]=Dc[1];Q=this.xBa[Ua];for(var nc of Object.keys(Q))nc===Rd.$Fh&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Fb[nc]=Sys.Serialization.JavaScriptSerializer.serialize(Q[nc]):Fb[nc]=Sys.Serialization.JavaScriptSerializer.serialize(Q[nc].toString());nc=Object.keys(Fb).length;nc=Array(nc);Q=
0;for(const Dc of Object.keys(Fb))nc[Q]=[Dc,Fb[Dc].toString()],Q++;return nc}XCi(Q,Ua,Fb){const nc=this.$.va.UserSessionId,Dc=this.$.va.UICultureTag,cd=this.$.va.UICultureTagLcid,kd=this.$.va.WacHostId;let qd="",Id="";5<=Fb.length&&(qd=Fb[3],Id=Fb[4]);this.YCi(qd,Id,Q,Ua,Dc,cd,nc,kd)}YCi(Q,Ua,Fb,nc,Dc,cd,kd,qd){const Id={};Id.a=kd;Id.b=Fb;Id.c=nc;Id.d=Q;Id.e=Ua;Id.f=Dc;Id.g=cd;Id.h=qd;ci.b().Pe(36,Id)}sBe(){if(Ri.a.nyf())t.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.dNf);
return}catch(Q){t.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(Q?Q.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.dNf)}catch(Q){t.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(Q?Q.toString():null))}}}CLb(Q,Ua=null,Fb=!1,nc=null,Dc=null,cd=!0){var kd=Q.SolutionId;let qd=xh.Task.Ta(!1);Q&&kd&&Q.SharedRuntimeId&&(nc=nc||new Eg.a(-859308420,0,2,0,""),kd={},kd.solutionId=Q.SolutionId,kd.version=Q.Version,kd.storeType=Q.StoreType,
kd.storeId=Q.StoreId,kd.assetId=Q.AssetId,kd.assetStoreId=Q.AssetStoreId,kd.height=Q.Height,kd.targetType=Q.TargetType,kd.width=0,kd.isAddinCommands=!1,kd.sharedRuntimeId=Q.SharedRuntimeId,Q.Preload=cd,Dc=Dc?Dc:new eh.a,Dc.width=0,Ua&&(Dc.focusOnIframeWhenLoaded=Ua.focusOnIframeWhenLoaded,cd=new yi,Ua.Ri&&(cd.SBc=Ua.Ri),0<Ua.taskPaneWidth&&(cd.wq=Ua.taskPaneWidth),Ua.AS&&(cd.QBc=Ua.AS),this.cdd[Q.SolutionId]=cd),Ua={},Ua[Ug.a.lg]=Q,Ua[ue.a.Esa]=kd,Ua[eh.a.key]=Dc,Ua[Md.a.Uoa]=Fb,qd=this.insertAgave(Ua,
nc));return qd}j6(Q,Ua,Fb,nc=null){if(Q&&Ua){Q=new Uh.a(Q,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const Dc=new mi.a("ExcelOnline","Web",this.$.va.UICultureTag),cd=new tg.a;cd.optionalProperties[Dg.a.LZb]=Fb;nc&&(nc.sourceLocationOverrideResourceId&&(cd.optionalProperties[Dg.a.sourceLocationOverrideResourceId]=nc.sourceLocationOverrideResourceId),nc.Ri&&(cd.optionalProperties[Dg.a.Ri]=nc.Ri),nc.dl&&(cd.optionalProperties.IconCssClass=nc.dl),nc.NYd&&(cd.optionalProperties.TaskPaneIconUrl=nc.NYd),
nc.AS&&(cd.optionalProperties.TaskPaneIconId=nc.AS));xi.a.instance.j6(Q,pi.a.action,Ua,Dc,cd)}}$_h(Q){if(!$h.a.ph(Q)){var Ua=Q[kc.a.bvb];if(Ua&&(Ua=Ua.getId(),Q=Q[kc.a.jW],Ua&&Q))return this.w4a(Ua,Q.optionalProperties[Dg.a.sourceLocationOverrideResourceId])}return null}w4a(Q,Ua=null){return Q&&Ua?`${Q}.${Ua}`:Q}gSh(Q){switch(Q){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return y.EwaSettings.ma(232)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;default:return 1}}J_d(){this.$.ea.qg?this.hLd():(this.$.ea.Kk(this.hLd),this.ocb=!0)}i5h(){var Q=this.$.da.za(20);if(!Q)return this.J_d(),"";Q=Q.F5a();if(!Q)return this.J_d(),"";var Ua=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Ua=Rh.d(Ua);var Fb=Fg.h(this.$).ha.ra.selectedRanges;const nc=[];for(const cd of Fb){Fb=new Nd.a(cd,Ua);var Dc=Q.Gdc(Fb,Fd.Valid);Fb=[];if(Dc)for(const kd of Dc)(Dc=kd.table.XA)&&(Dc=Dc.range.toString())&&
Fb.push(Dc);Fb=new Ai(cd.toString(),Fb);nc.push(Fb)}return JSON.stringify(nc)}}Rd.uei="Microsoft.Office.Excel.IdeasXLOPreload";Rd.oFd="IDS";Rd.Jbf="FA000000012";Rd.dxa="FA000000005";Rd.Aci="HelloWorld";Rd.f3g="FA000000014";Rd.yec="Help.GiveFeedback.Url";Rd.$Fh="feedback";Rd.bqf="FA000000066";Rd.u7i="PowerBi.Url";Rd.s7i="PowerBi.DevUrl";Rd.t7i="FA000000054";Rd.vKi="FA000000064";Rd.B2i="FA000000075";Rd.BYc="AnalyzeDataTaskPane";Rd.ydj="RecommendedChartsTaskPane";Rd.G5i="PivotTableTaskPane";Rd.Hkh=350;
Rd.rdf=320;Rd.k$i=320;Rd.CPg="g_InstallOrigin";Rd.pVg="InsertAddInsFromBackstage";Rd.yqj="InsertAppsForOffice";Rd.KQj="LaunchAddinDialogFromTellMe";Object(d.a)(Rd,"AgaveCommandManager",jg.a,[701,702]);class je extends h.a{constructor(Q){super();this.$=Q;this.Fb()}create(){const Q=this.$.da,Ua=Cg.GetServiceTaskFactory.create(Q,106,this.la,this.Ya),Fb=Cg.GetServiceTaskFactory.create(Q,104,this.la,this.Ya),nc=bh.a.loadScript(35,0,this.Ya,void 0,void 0,375);dg.TaskExtensions.Aa(dg.TaskExtensions.Fd([Fb,
Ua,nc],this.la),()=>{let Dc=null;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Dc=Jc.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);sh.instance.initialize(Ua.result);const cd=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Xh.a)(this.$.da,374,()=>new Rd(this.$,Ua.result,Fb.result,Dc,pd.AFrameworkApplication.ub)):new Rd(this.$,Ua.result,Fb.result,Dc,
pd.AFrameworkApplication.ub);Q.Ga(206,cd);this.ob(Q.za(374)||Q.Ga(374,cd))},this.la,3);Jc.a.instance.register(Zh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").xc().Fc(()=>new Zh.a(this.$.ru))}static ka(Q){Q.da.Ga(375,new je(Q))}}Object(d.a)(je,"AgaveCommandManagerFactory",h.a,[]);var $e=a(560);class Xe{constructor(){this.initialized=!1;this.agaveCommandManager=this.ie=this.q1a=null;this.pU={}}initialize(Q){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.Brj(Q)}mji(Q,Ua){let Fb=dg.TaskExtensions.Rj();if(this.initialized&&Q&&0<Q.length){let nc=this.YOh(Q);Q in this.pU&&(Fb=this.agaveCommandManager.insertAgave(nc,Ua))}return Fb}SHg(Q){this.initialized&&(Q=Q[Ug.a.lg]||{},!Q.SolutionId||Q.SolutionId in this.pU||this.ie.Ada(Ua=>{this.Ada(Ua)},!0))}jai(Q){this.initialized&&(Q=Q||"")&&0<Q.length&&Q in this.pU&&(delete this.pU[Q],this.ie.Ada(Ua=>{this.Ada(Ua)},!0))}YOh(Q){return Q in this.pU?this.pU[Q]:{}}Ada(Q){var Ua=!1;if(Q&&
!Q.errorCode){if(Q.value)for(const Fb of Q.value)Q=Fb[1],Fb[3]==OSF.OsfControlTarget.InContent&&Q&&0<Q.length&&!(Q in this.pU)&&(Ua={NoReporting:!1,IsSystemInitiated:!1},Ua.description=Fb[2],Ua.iconUrl=Fb[9],Ua[ue.a.Esa]={solutionId:Fb[1],version:Fb[4],storeType:Fb[12],storeId:Fb[11],assetId:Fb[5],assetStoreId:Fb[6],targetType:Fb[3],width:Fb[7],height:Fb[8],displayName:Fb[0],id:Fb[1]},Ua[Ug.a.lg]={SolutionId:Fb[1],Version:Fb[4],StoreType:Fb[12],StoreId:Fb[11],AssetId:Fb[5],AssetStoreId:Fb[6],TargetType:Fb[3],
Width:Fb[7],Height:Fb[8],Id:Fb[1]},this.pU[Q]=Ua,Ua=!0);Ua&&this.lch()}}lch(){let Q=[];for(const Ua in this.pU)Q.push({id:Ua,controlType:0,title:this.pU[Ua][ue.a.Esa].displayName});if(0<Q.length){for(const Ua in this.pU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ua,this.pU[Ua].iconUrl);this.r4g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:Xe.uyf,isOfficeTab:!0,groups:[{id:Xe.xff,title:Xe.yff,controls:Q}]}]});for(const Ua in this.pU)this.q1a.addCommandToMaps(Object(jd.a)(new Ye.a(Ua,
"-1473679467"),{legacyControlId:Ua}))}}r4g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:Xe.uyf,isOfficeTab:!0,groups:[{id:Xe.xff,title:Xe.yff,controls:[]}]}]})}Brj(Q){const Ua=Cg.GetServiceTaskFactory.Oa(Q.da,374,375,1),Fb=Cg.GetServiceTaskFactory.create(Q.da,106,Q.la,1);dg.TaskExtensions.Aa(dg.TaskExtensions.Fd([Ua,Fb],Q.la),()=>{this.agaveCommandManager=Ua.result;this.q1a=Jc.a.instance.Jh("Common.IExternalUICommandDefinitionMapping")||new $e.a(Q.Eb,Q);pd.AFrameworkApplication.ub.Mb(ve.a.YTf,
Eh.a.frame,(nc,Dc,cd,kd,qd)=>{this.jai(qd)});this.ie=Fb.result;this.ie.Ada(nc=>{this.Ada(nc)},!0);this.initialized=!0},Q.la,3)}}Xe.uyf="tabinsert";Xe.xff="installedContentAddins";Xe.yff=ff.a.instance.ga(2274);Object(d.a)(Xe,"AgaveCommandRibbon",null,[700]);class ig extends h.a{constructor(Q){super();this.$=Q;this.Fb()}create(){if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const Q=this.$.da,Ua=new Xe;Ua.initialize(this.$);this.ob(Q.za(488)||
Q.Ga(488,Ua))}}static ka(Q){Q.da.Ga(489,new ig(Q))}}Object(d.a)(ig,"AgaveCommandRibbonFactory",h.a,[]);var Zg=a(1301),Uf=a(731);class uh{constructor(){this.o$d=this.J9d=this.Jfa=null;this.Zjb=0}get displayName(){return this.Jfa}set displayName(Q){this.Jfa=Q}get email(){return this.J9d}set email(Q){this.J9d=Q}get federationProvider(){return this.o$d}set federationProvider(Q){this.o$d=Q}get identityType(){return this.Zjb}set identityType(Q){this.Zjb=Q}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(Q){switch(Q){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Ua){switch(Q){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Ua){Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}static wdh(Q){const Ua=new uh;Ua.displayName=Q.displayName;Ua.email=Q.email;switch(Q.authority){case Zg.a.VJf:Ua.identityType=1;break;default:Ua.identityType=0}Ua.federationProvider="";return Ua}}Object(d.a)(uh,"OfficeIdentityInfo",null,[]);class hh{static get RQe(){return hh.kwg}static Hcc(Q){return Q in hh.RQe?hh.RQe[Q].toString():Q}}hh.map=null;hh.kwg={["GeneralException"]:Uf.a.generalException,
["AccessDenied"]:Uf.a.BVc,["ApiNotAvailable"]:Uf.a.apiNotAvailable,["UserNotSignedIn"]:Uf.a.userNotSignedIn,["UserAborted"]:Uf.a.userAborted,["UnsupportedUserIdentity"]:Uf.a.xYj,["InvalidResourceUrl"]:Uf.a.invalidResourceUrl,["InvalidGrant"]:Uf.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:Uf.a.EPg,["ResourceNotAllowed"]:Uf.a.upj,["ClientError"]:Uf.a.clientError,["ServerError"]:Uf.a.serverError};Object(d.a)(hh,"SingleSignOnErrorCodeMap",null,[]);class Lh{constructor(Q,Ua){this.aSb=Q;this.Zjb=Ua}get accessToken(){return this.aSb}set accessToken(Q){this.aSb=
Q}get tokenIdenityType(){return this.Zjb}set tokenIdenityType(Q){this.Zjb=Q}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(Q){switch(Q){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Ua){switch(Q){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}
Object(d.a)(Lh,"SingleSignOnToken",null,[]);class R{constructor(){this.d6d=null;this.Vje=this.CXb=this.uE="";this.jle=!0;this.options=null}get authChallenge(){return this.d6d}set authChallenge(Q){this.d6d=Q}get correlationId(){return this.uE}set correlationId(Q){this.uE=Q}get policy(){return null}set policy(Q){}get resource(){return this.CXb}set resource(Q){this.CXb=Q}get scope(){return this.Vje}set scope(Q){this.Vje=Q}get silentLogin(){return this.jle}set silentLogin(Q){this.jle=Q}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(Q){switch(Q){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Ua){switch(Q){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}Object(d.a)(R,"TokenParameters",null,[313]);class Wa{constructor(Q,Ua){this.uib=Ua;this.LA=Q}get roamingSettings(){return null}getAccessToken(Q){const Ua=this.uib.getOsfControl(this.LA),
Fb=Ua.getManifest(),nc=Fb.getMarketplaceID();this.POa(Q,nc);return OfficeExtension.WacRuntime.Utility.createPromise((Dc,cd)=>{Ua.isFirstParty()&&this.uib._enableFirstPartySSO?this.hmi(Fb,Q)?Jc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(Q,nc).then(kd=>{Dc(kd)},kd=>{cd(kd)}):cd(Uf.a.BVc):cd(Uf.a.apiNotAvailable)}).then(Dc=>{let cd;switch(Dc.authority){case Zg.a.VJf:cd=1;break;default:cd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Lh(Dc.accessToken,
cd))},Dc=>{this.logErrorResponse(Q,nc,Dc);return Dc?OfficeExtension.WacRuntime.Utility.createPromise((cd,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(Dc,hh.Hcc(Dc)))}):OfficeExtension.WacRuntime.Utility.createPromise((cd,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,hh.Hcc(Uf.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const Q=this.uib.getOsfControl(this.LA);Q.getManifest();const Ua=Q.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Fb,nc)=>{Jc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ua).then(Dc=>{Fb(Dc)},Dc=>{nc(Dc.toString())})}).then(Fb=>{Fb=uh.wdh(Fb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Fb)},Fb=>Fb?OfficeExtension.WacRuntime.Utility.createPromise((nc,Dc)=>{Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(Fb,hh.Hcc(Fb)))}):OfficeExtension.WacRuntime.Utility.createPromise((nc,Dc)=>
{Dc(OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,hh.Hcc(Uf.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(Q){switch(Q){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 1:return this.tOh(Ua);case 3:return this.IPh();case 2:return this.f1h()}Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}tOh(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,R);return this.getAccessToken(Q)}IPh(){return this.getAuthContext()}f1h(){return this.getPrimaryIdentityInfo()}hmi(Q,
Ua){let Fb=!1;const nc=Q.getWebApplicationAuthorizations();Q=null;for(const Dc of nc)if(Dc.getResource().toLowerCase()===Ua.resource.toLowerCase()){Q=Dc;Fb=!0;break}if(!Fb)return!1;Ua=Ua.scope.split(" ,+");for(const Dc of Ua)if(Dc&&Dc.length){Ua=!1;for(const cd of Q.getScopes())Dc.toLowerCase()===cd.toLowerCase()&&(Ua=!0);if(!Ua)return!1}return!0}POa(Q,Ua){Q=this.fyf(Q.resource);t.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ua,["resource"]:Q})}logErrorResponse(Q,Ua,Fb){Q=this.fyf(Q.resource);
t.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ua,["resource"]:Q,["error"]:Fb})}fyf(Q){return Q.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Wa,"AuthenticationService",null,[]);class qb{create(Q,Ua){return new Wa(Q,Ua)}}Object(d.a)(qb,"AuthenticationServiceFactory",null,[]);var Xb=a(844),pc=a(961),Lc=a(944);class Ec{}Ec.generalException="generalException";Ec.invalidArgument="invalidArgument";Ec.notAllowed="notAllowed";Ec.apiNotAvailable="apiNotAvailable";
Ec.unresolvedPendingRequest="unresolvedPendingRequest";Ec.timeout="timeout";Ec.adalTimeout="adalTimeout";Ec.userNotSignedIn="userNotSignedIn";Ec.userAborted="userAborted";Ec.silentSignInFailed="silentSignInFailed";Ec.invalidResourceUrl="invalidResourceUrl";Ec.invalidGrant="invalidGrant";Ec.connectionLost="connectionLost";Ec.clientError="clientError";Ec.serverError="serverError";Object(d.a)(Ec,"WopiHostErrorCodes",null,[]);var Gc=a(729);class qc{}Object(d.a)(qc,"OAuthCallerMetadata",null,[]);var Sc=
a(27);class fd{constructor(Q){this.Gya=Q;this.bwg=pd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}FVc(Q,Ua,Fb,nc,Dc,cd,kd,qd){if(!this.Gya)return Dc=new pc.a,Dc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Dc);const Id=new qc;Id.AddinName=kd;Id.AddinTrustId=qd;let Yd=-1;Q=null;if(Dc&&this.ujf())Q=this.Gya.Mfg(ue.a.gCc,Ua,Dc,fd.g6e(kd),Id);else{const Je=Date.now();Q=this.Gya.UL(ue.a.gCc,Ua,Id).then(Se=>{Yd=
Date.now()-Je;const vf=(Fb||nc)&&"login_required"===Se.ErrorCode;return(Fb&&("interaction_required"===Se.ErrorCode||"consent_required"===Se.ErrorCode||"invalid_grant"===Se.ErrorCode)||vf)&&this.ujf()?this.Gya.Mfg(ue.a.gCc,Ua,null,fd.g6e(kd),Id):Promise.resolve(Se)})}return Q.then(Je=>{const Se=new pc.a;Je.IsSuccess?(Se.token=Je.Token,Je.Telemetry&&(Se.GUa=Je.Telemetry.fromCache,Se.expiresOn=Je.Telemetry.expiresOn)):(Se.errorCode=this.pGi(Je),Se.UYd=this.N3i(Je));return Se}).catch(()=>{const Je=new pc.a;
Je.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Je)}).then(Je=>{Je.Eha="OauthManager";0<=Yd&&(Je.Rxb=Yd);return Je})}Hoi(Q){const Ua=(pd.AFrameworkApplication.fa.Xa(pd.AFrameworkApplication.x8)||"").toLowerCase();return(Sc.a.aya||"teams"===Ua&&Gc.a.bzb)&&!fd.loi(Q)||!this.Gya||!this.Gya.cNa()?!1:!0}ujf(){return this.bwg||1!==Lc.a.Tbc()}pGi(Q){switch(Q.ErrorCode){case "UserCancelled":case "interaction_required":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;
break;case "consent_required":case "invalid_grant":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":Q=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;
default:Q=Q.ErrorCode===Ec.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:Q.ErrorCode===Ec.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:Q.ErrorCode===Ec.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:Q.ErrorCode===Ec.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:Q.ErrorCode===Ec.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return Q}N3i(Q){let Ua=
"";(Q=RegExp("AADSTS(\\d+)").exec(Q.ErrorMessage))&&1<Q.length&&(Ua=Q[1]);return Ua}static g6e(Q){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,Q)}static loi(Q){if(!Q)return!1;Q=Q.toLowerCase();for(const Ua of Xb.AppsForOfficeSingleSignOnManager.nYe)if(Ua===Q)return!0;return!1}}Object(d.a)(fd,"AppsforOfficeTokenFromOauthManager",null,[61]);class Yc{constructor(Q){this.xFi=Q}static ipa(){if(pd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var Q=
null;try{Q=Jc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ua){t.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ua)}Q=new fd(Q);Yc.Ma=new Yc(Q)}}static getInstance(){Yc.jbe||(Yc.ipa(),Yc.jbe=!0);return Yc.Ma}}Yc.Ma=null;Yc.jbe=!1;Object(d.a)(Yc,"AppsForOfficeOauthManagerFactory",null,[40]);var Ld=a(1300),$d=a(134);class se{constructor(Q,Ua,Fb,nc){this.menuItemId=Q;this.xG=Ua;this.zOj=Fb;this.JGh=nc}}Object(d.a)(se,"NewDocumentParameters",null,[]);const Ne=Q=>
{var Ua=Q.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Fb=Ua.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Fb.addParameter("shortcuts","String[]",1,null,0);Ua.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Fb=Ua.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Fb.addParameter("shortcuts","Object",1,null,0);Ua=Q.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Fb=Ua.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Fb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ua=Q.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Fb=Ua.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Fb.addParameter("base64File","String",1,null,0);Ua=Q.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Ua.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Fb=Ua.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Fb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ua=Q.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ua.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Fb=Ua.addMethod("Register",1,"Void",0,0,"Register",0);Fb.addParameter("metadata","String",1,null,0);Fb.addParameter("javascript","String",1,null,0);Ua=Q.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ua.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ua.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ua.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ua=Q.addEnumType("Microsoft.Authentication.IdentityType");Ua.addEnumField("OrganizationAccount",
0);Ua.addEnumField("MicrosoftAccount",1);Ua=Q.addEnumType("Microsoft.Authentication.AuthorityType");Ua.addEnumField("External",0);Ua.addEnumField("Msa",1);Ua.addEnumField("Aad",2);Ua=Q.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ua.addProperty("DisplayName",4,"String",1,!1,null,0);Ua.addProperty("Email",3,"String",1,!1,null,0);Ua.addProperty("FederationProvider",2,"String",1,!1,null,0);Ua.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ua=Q.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ua.addProperty("AppId",4,"String",1,!1,null,0);Ua.addProperty("Authority",2,"String",1,!1,null,0);Ua.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ua.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ua.addProperty("TenantId",6,"String",1,!1,null,0);Ua.addProperty("Upn",
1,"String",1,!1,null,0);Ua=Q.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ua.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Fb=Ua.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Fb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ua.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Ua.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ua=Q.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ua.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ua.addProperty("CorrelationId",7,"String",1,!1,null,0);Ua.addProperty("Policy",4,"String",1,!1,null,0);Ua.addProperty("Resource",2,"String",1,!1,null,0);Ua.addProperty("Scope",
5,"String",1,!1,null,0);Ua.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ua=Q.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ua.addProperty("AccessToken",2,"String",1,!1,null,0);Ua.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ua=Q.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ua.addProperty("Id",1,"String",1,
!0,null,0);Ua.addProperty("Value",2,"Object",1,!1,null,0);Ua=Q.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Fb=Ua.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Fb.addParameter("id","String",1,null,0);Fb=Ua.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Fb.addParameter("id","String",1,null,0);Ua=Q.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ua.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Fb=Ua.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Fb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ua=Q.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ua.addEnumField("Inactive",0);Ua.addEnumField("Background",1);Ua.addEnumField("Visible",2);Ua=Q.addEnumType("Microsoft.AppRuntime.Visibility");
Ua.addEnumField("Hidden",1);Ua.addEnumField("Visible",2);Ua=Q.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ua.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Fb=Ua.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Fb.addParameter("jsonCreate","String",1,null,0);Fb=Ua.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Fb.addParameter("jsonUpdate",
"String",1,null,0);Fb=Ua.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Fb.addParameter("id","String",1,null,0);Fb=Ua.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Fb.addParameter("id","String",1,null,0);Ua.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ua=Q.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ua.addProperty("Id",2,"String",1,!0,null,0);Fb=Ua.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Fb.addParameter("visibility","Boolean",1,null,0);Ua.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ua=Q.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ua.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ua.addProperty("Id",2,"String",1,!0,null,0);Ua.addProperty("Label",4,"String",1,!0,null,0);Fb=Ua.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Fb.addParameter("enabled","Boolean",1,null,0);Ua.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Ua=Q.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ua.addMethod("GetCount",3,"Int32",1,1,"Count",0);Fb=Ua.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Fb.addParameter("key","String",1,null,0);Ua.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ua.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ua=Q.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ua.addEnumField("Unknown",0);Ua.addEnumField("Basic",
1);Ua.addEnumField("Premium",2);Ua=Q.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Fb=Ua.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Fb.addParameter("feature","String",1,null,0);Fb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Fb=Ua.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Fb.addParameter("feature","String",1,null,0);Fb=Ua.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Fb.addParameter("feature","String",1,null,0);Fb.addParameter("fallbackValue","Boolean",1,null,0);Ua.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Fb=Ua.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Fb.addParameter("experienceId","String",1,null,0);Fb=Ua.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Fb.addParameter("feature","String",1,null,0);Ua=Q.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ua.addProperty("Id",5,"String",1,!0,null,0);Ua.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Ua.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ua=Q.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Ua.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ua=Q.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Ua.addMethod("Disable",3,"Void",0,1,"Disable",0);Ua.addMethod("Enable",2,"Void",0,1,"Enable",0);Ua.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var tf=a(185);class Df{constructor(Q,Ua){this.tAg=Q;this.OAg=Ua}createAndOpenWorkbook(Q){if(Q&&
Q.length>this.tAg)throw t.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",Q.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.invalidArgument,tf.a.ga(1758));const Ua=new se("blank","agave",Q?"streamBase64":"streamEmpty",Q);let Fb=null;return OfficeExtension.WacRuntime.Utility.createPromise((nc,Dc)=>{const cd=new $d.StandardDialog;cd.Rb=4;cd.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,kd=>{2===kd||0===kd?Dc("Cancelled"):
(Fb=window.open(""),this.OAg.create(nc,Dc,Ua).T1a())})}).then(nc=>{if(!nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,tf.a.ga(1754));try{Fb.top.location.href=nc}catch(Dc){t.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Sc.a.Dp,Dc),t.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Fb.location.replace(nc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},nc=>{if("Cancelled"===nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.rFd,tf.a.ga(1757));Fb.close();this.CRj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 1:return this.hbh(Ua)}Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}hbh(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.createAndOpenWorkbook(Q)}CRj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,
tf.a.ga(1754));}}Object(d.a)(Df,"WacWorkbook",null,[]);const Yf=(Q,Ua)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof Q+", objectId="+Q+", value="+Ua);return null},lf=Q=>{Q.add("InternalTest","PreviewExecutionMethod",Yf)};var Gf=a(249),nf=a(730),hg=a(738);class qg{constructor(Q){this.jb=Q}get $(){return this.jb}}Object(d.a)(qg,"RichApiPreviewExecutionContext",null,[]);var Ig=a(24),Jg=a(965),$g=a(33),yh=a(207),zf=a(210),af=a(108),yf=a(12);class ag extends zf.a{constructor(Q,
Ua,Fb,nc,Dc){super(Q,"Select Data");this.htmlSanitizationHelper=this.eqb=null;this.SKe=Ua;this.Q7c=Fb;this.htmlSanitizationHelper=Dc;this.callback=nc}get pc(){return"DdaBindingPrompt"}start(Q,Ua){let Fb="<div class='"+af.a.Jvh+" "+Vg.a.rp+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+af.a.sF+"' /></div>";Fb=String.format(Fb,fg.a.Eg(this.Q7c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(this.Qb,Fb):this.Qb.innerHTML=Fb;this.eqb=yf.DOMElementExtensions.getElementById(this.Qb,"bindingText");Q=Ua?Q.T3a(Ua,this.Q7c.DdaBindingsMethod.BindingId):null;(null===Q||void 0===Q?0:Q.IsValidRef)?(Ua=new Ig.Range(Q.Reference.FirstRow+1,Q.Reference.FirstColumn+1,Q.Reference.LastRow+1,Q.Reference.LastColumn+1,!1,!1),this.eqb.value=Q.Reference.SheetName+
"!"+Ua):(Q=Fg.h(this.$).ha,this.eqb.value=Rh.f(this.$.na)||!Q.ra.Mg?"":Q.Jia);this.initialize();this.ug()}vq(){this.y2c();this.addButton(0);this.addButton(1);super.vq()}setFocus(){yf.DOMElementExtensions.setFocus(this.eqb)}validate(){return!0}commit(){let Q=this.eqb.value.trim();const Ua=Q.indexOf("!");-1!==Ua&&(Q=this.b4h(Q.substring(0,Ua))+Q.substr(Ua));this.SKe.addBinding(this.Q7c,Q,0,this.callback);return!0}jta(){this.SKe.BQ.qf(nf.a.internalError,this.callback);super.jta()}b4h(Q){Q=Qh.a.trimStart(Q.trim(),
"=");return Q.length?Q.startsWith("'")&&Q.endsWith("'")?Q:di.HelperMethods.Z9b(Q):""}}Object(d.a)(ag,"DdaBindingPrompt",zf.a,[]);class eg{constructor(Q){this.ea=Q}qf(Q,Ua){if(Ua){const Fb={};Fb.Error=Q;Fb.Version=this.ea.ye;Ua(Fb)}}SKa(Q,Ua){this.qf(Q,Ua)}LH(Q,Ua){this.qf(nf.a.LZe(Q.Errors[0].MessageId),Ua)}zv(Q){Q&&Q(this.oQ())}oQ(){const Q={Error:0};Q.Version=this.ea.ye;return Q}}Object(d.a)(eg,"DdaErrorGenerator",null,[]);var Rf=a(282);class Vf{constructor(Q,Ua,Fb){this.$=Q;this.BQ=Ua;this.uA=
Fb}pAd(Q,Ua){const Fb=Q.DdaGoToByIdMethod.GoToType,nc=Q.DdaGoToByIdMethod.SelectionMode,Dc=Q.DdaGoToByIdMethod.Id.toString().trim(),cd=kd=>{const qd=this.$.xa.getItemByName(kd.SheetName);(null===qd||void 0===qd?0:qd.visible)?(Fg.h(this.$).pg(kd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.BQ.zv(Ua)):this.BQ.qf(nf.a.O1g,Ua)};0===Fb?this.lKi(Dc,nc,Q.DdaMethod.ControlId,cd,Ua):1===Fb?this.pKi(Dc,nc,cd,Ua):this.BQ.qf(nf.a.uYj,Ua)}lKi(Q,Ua,Fb,nc,Dc){this.uA.ddaGetBinding(Fb,
Q,cd=>{if(!Rf.a(cd)&&cd.Result&&cd.Result.Reference){cd=cd.Result;var kd={};kd.SheetName=cd.Reference.SheetName;kd.FirstRow=cd.Reference.FirstRow;kd.FirstColumn=cd.Reference.FirstColumn;kd.LastRow=cd.Reference.LastRow;kd.LastColumn=cd.Reference.LastColumn;Vf.kYc(kd,Ua);1!==cd.BindingType?nc(kd):this.uA.ddaGetBindingData(Fb,Q,1,0,2,0,0,-1,-1,qd=>{Rf.a(qd)||!qd.Result?this.BQ.LH(qd,Dc):(qd=qd.Result,2!==Ua&&(kd.FirstRow-=qd.Headers.length,0>kd.FirstRow&&(kd.FirstRow=0)),nc(kd))},Dc)}else this.BQ.SKa(nf.a.I$f,
Dc)},Dc)}pKi(Q,Ua,Fb,nc){var Dc=Oh.z(Q);Dc?(Dc=Oh.v(Dc,this.$),Vf.kYc(Dc,Ua),Fb(Dc)):this.$.ea.isNamedObjectViewMode&&this.$.Cb.Qk(Q)?this.$.Cb.na=this.$.Cb.getItemByName(Q):(Dc=cd=>{Rf.a(cd)||!cd.Result?this.$.xa.contains(Q)?(cd={},cd.SheetName=Q,cd.FirstRow=0,cd.FirstColumn=0,cd.LastRow=0,cd.LastColumn=0,Fb(cd)):this.BQ.SKa(nf.a.I$f,nc):(cd=cd.Result,Vf.kYc(cd,Ua),Fb(cd))},this.$.xa.na?this.uA.parseRangeForGoto(Q,this.$.xa.na.name,Dc,nc):this.uA.parseRange(Q,Dc,nc))}static kYc(Q,Ua){Q.LastRow=2===
Ua?Q.FirstRow:Q.LastRow;Q.LastColumn=2===Ua?Q.FirstColumn:Q.LastColumn}}Object(d.a)(Vf,"DdaNavigator",null,[]);const bg=(Q,Ua,Fb,nc,Dc,cd)=>{const kd=Q.Na(1);kd.request=Ua;return Pg.g(Q,"ExecuteRichApiRequest",kd,Fb,nc,Dc,cd,0)};var cg=a(294),yg;(function(Q){Q[Q.unsupported=0]="unsupported";Q[Q.surface=1]="surface";Q[Q.combo=2]="combo";Q[Q.column=3]="column";Q[Q.column3D=4]="column3D";Q[Q.bar=5]="bar";Q[Q.bar3D=6]="bar3D";Q[Q.line=7]="line";Q[Q.line3D=8]="line3D";Q[Q.pie=9]="pie";Q[Q.pie3D=10]="pie3D";
Q[Q.scatter=11]="scatter";Q[Q.bubble=12]="bubble";Q[Q.area=13]="area";Q[Q.area3D=14]="area3D";Q[Q.doughnut=15]="doughnut";Q[Q.radar=16]="radar";Q[Q.stock=17]="stock";Q[Q.waterfall=18]="waterfall";Q[Q.funnel=19]="funnel";Q[Q.treemap=20]="treemap";Q[Q.sunburst=21]="sunburst";Q[Q.boxWhisker=22]="boxWhisker";Q[Q.histogram=23]="histogram";Q[Q.pareto=24]="pareto";Q[Q.regionMap=25]="regionMap";Q[Q.noVisibleSeries=26]="noVisibleSeries";Q[Q.complexDataSource=27]="complexDataSource";Q[Q.pivotChart=28]="pivotChart"})(yg||
(yg={}));Object(d.b)("ChartCategory",yg);class vh{constructor(Q,Ua){this.source=Q;this.eventId=Ua}}Object(d.a)(vh,"MacroRecorderEventData",null,[]);class Of{constructor(Q,Ua,Fb){this.parentName=Q;this.$=Ua;this.request=Fb}t2h(Q){var Ua;if(void 0===Q||null===Q||void 0===Q.RequestBody||null===Q.RequestBody)return null;const Fb=JSON.parse(Q.RequestBody);if(void 0!==Q.ActiveChartId&&null!==Q.ActiveChartId){Fb.ActiveChartId=Q.ActiveChartId;const nc=Fg.h(this.$).ha.Ra.$b;if(null===(Ua=null===nc||void 0===
nc?void 0:nc.floatingObject)||void 0===Ua?0:Ua.Vc)Fb.ActiveChartType=yg[nc.floatingObject.Vc.ChartCategory]}void 0!==Q.SheetMultiRange&&null!==Q.SheetMultiRange&&(Fb.SheetName=Q.SheetMultiRange.SheetName);return Fb}J2h(Q){if(void 0===Q||null===Q||void 0===Q.Result||null===Q.Result)return null;Q=Q.Result;return void 0===Q.ResponseBody||null===Q.ResponseBody||Q.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(Q.ResponseBody.join(""))}hti(Q){return!!Q&&!(void 0===Q.eventId||null===Q.eventId)&&
0<Q.eventId.length}ek(Q){return()=>{if(this.$.Zba){const Ua=this.aZg(this.request);if(this.hti(Ua)){const Fb=this.t2h(this.request),nc=this.J2h(Q);if(Fb&&!$h.a.isEmpty(Fb)&&nc&&!$h.a.isEmpty(nc))return t.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Y(Ua,Fb,nc);t.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Fb?"(not null)":"(null)"}; responseInfo: ${nc?"(not null)":"(null)"}`}`)}}return new Y(null,
null,null)}}aZg(Q){const Ua=this.iti(Q.SolutionId),Fb=Of.a2h(Q);if(Fb&&Ua)return t.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Fb,["request.SolutionId"]:Q.SolutionId})}`),new vh(Q.SolutionId,Fb);Q=JSON.stringify({["recorderEventId"]:Fb,["isRecorderAwareAddin"]:Ua,["request.SolutionId"]:Q.SolutionId});t.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${Q}`);return null}iti(Q){if(!Q)return!1;Q=Q.toLowerCase();return Of.X7h().contains(Q)}static X7h(){Of.yAa||
(Of.yAa=new n.a(S.a.cl()),Of.yAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Of.yAa.add("fa000000005"),Of.yAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Of.yAa.add("fa000000014"),Of.yAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Of.yAa}static a2h(Q){let Ua=null;var Fb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Fb.test(Q.RequestBody))Ua=Fb.exec(Q.RequestBody)[1];else{Q=Q.RequestHeaders;if(!Q)return Ua;Fb=wf.a.RMi.toLowerCase();for(let nc=0;nc<Q.length;nc++)if(Q[nc].Name.toLowerCase()===
Fb){Ua=Q[nc].Value;break}}return Ua}}Of.yAa=null;Object(d.a)(Of,"DdaRichApiRequestRecorder",null,[]);class Ti extends cg.a{constructor(Q,Ua,Fb,nc,Dc,cd,kd,qd){super(10,0,Ua,qd);this.Xmb=Fb;this.ojb=nc;this.a4=Dc;this.jGa=cd;this.request=kd;this.bPd=new Of("10",Q,kd)}get GEc(){return this.jGa}get Yt(){return this.Xmb}get Oaa(){return this.ojb}n3(Q){return super.n3(Q)||this.H0g(Q)}ek(){return this.bPd.ek(this.od)}Rfb(){const Q={OperationType:3};Q.RichApiRequest=this.request;return Q}H0g(Q){return(Ua,
Fb,nc)=>bg(Q,this.request,$f.b(Ua,this.Xmb),$f.a(Fb,this.ojb),nc,this.a4)}}Object(d.a)(Ti,"DdaRichApiRequestBatchOperation",cg.a,[]);class Ui extends Vh.a{constructor(Q,Ua,Fb,nc){super(576,0,Fb,nc);this.bPd=new Of("576",Q,Ua)}ek(){return this.bPd.ek(this.od)}}Object(d.a)(Ui,"DdaRichApiRequestOperation",Vh.a,[]);class Wi{constructor(Q,Ua){this.DI=(Fb,nc)=>{this.BQ.SKa(nf.a.internalError,nc)};this.$=Q;this.BQ=Ua}ddaAddBinding(Q,Ua,Fb,nc,Dc,cd,kd){this.kK((qd,Id,Yd)=>{var Je=this.$.pa.ya,Se=this.Wja();
qd=$f.b(qd,cd);Id=$f.a(Id,this.DI);const vf=Je.Na(9);vf.controlId=Q;vf.bindingId=Ua;vf.bindingType=Fb;vf.currentSheetName=Se;vf.formula=nc;vf.options=Dc;return Pg.g(Je,"DdaAddBinding",vf,qd,Id,Yd,kd,0)},kd,563)}ddaReleaseBinding(Q,Ua,Fb,nc){this.kK((Dc,cd,kd)=>{var qd=this.$.pa.ya;Dc=$f.b(Dc,Fb);cd=$f.a(cd,this.DI);const Id=qd.Na(9);Id.controlId=Q;Id.bindingId=Ua;return Pg.g(qd,"DdaReleaseBinding",Id,Dc,cd,kd,nc,0)},nc,564)}ddaGetBinding(Q,Ua,Fb,nc){this.kK((Dc,cd,kd)=>{var qd=this.$.pa.ya;Dc=$f.b(Dc,
Fb);cd=$f.a(cd,this.DI);const Id=qd.Na(1);Id.controlId=Q;Id.bindingId=Ua;return Pg.g(qd,"DdaGetBinding",Id,Dc,cd,kd,nc,0)},nc,565,16)}ddaGetAllBindings(Q,Ua,Fb){this.kK((nc,Dc,cd)=>{var kd=this.$.pa.ya;nc=$f.b(nc,Ua);Dc=$f.a(Dc,this.DI);const qd=kd.Na(1);qd.controlId=Q;return Pg.g(kd,"DdaGetAllBindings",qd,nc,Dc,cd,Fb,0)},Fb,566,16)}ddaGetBindingData(Q,Ua,Fb,nc,Dc,cd,kd,qd,Id,Yd,Je){this.kK((Se,vf,Kg)=>{var rg=this.$.pa.ya,lg=this.Wja();Se=$f.b(Se,Yd);vf=$f.a(vf,this.DI);const mg=rg.Na(1);mg.controlId=
Q;mg.bindingId=Ua;mg.coerceType=Fb;mg.valueFormat=nc;mg.filterType=Dc;mg.startRow=cd;mg.startCol=kd;mg.rowCount=qd;mg.colCount=Id;mg.currentSheetName=lg;return Pg.g(rg,"DdaGetBindingData",mg,Se,vf,Kg,Je,0)},Je,567,16)}ddaSetBindingData(Q,Ua,Fb,nc,Dc,cd,kd){this.kK((qd,Id,Yd)=>{var Je=this.$.pa.ya,Se=this.Wja();qd=$f.b(qd,cd);Id=$f.a(Id,this.DI);const vf=Je.Na(9);vf.controlId=Q;vf.bindingId=Ua;vf.startRow=Fb;vf.startCol=nc;vf.currentSheetName=Se;vf.bindingData=Dc;return Pg.g(Je,"DdaSetBindingData",
vf,qd,Id,Yd,kd,0)},kd,568)}ddaGetSelectedData(Q,Ua,Fb,nc,Dc,cd,kd){this.kK((qd,Id,Yd)=>{var Je=this.$.pa.ya,Se=this.Wja();qd=$f.b(qd,cd);Id=$f.a(Id,this.DI);const vf=Je.Na(1);vf.controlId=Q;vf.coerceType=Ua;vf.valueFormat=Fb;vf.filterType=nc;vf.currentSheetName=Se;vf.formula=Dc;return Pg.g(Je,"DdaGetSelectedData",vf,qd,Id,Yd,kd,0)},kd,569,16)}ddaSetSelectedData(Q,Ua,Fb,nc,Dc){this.kK((cd,kd,qd)=>{var Id=this.$.pa.ya,Yd=this.Wja();cd=$f.b(cd,nc);kd=$f.a(kd,this.DI);const Je=Id.Na(9);Je.controlId=Q;
Je.currentSheetName=Yd;Je.formula=Ua;Je.bindingData=Fb;return Pg.g(Id,"DdaSetSelectedData",Je,cd,kd,qd,Dc,0)},Dc,570)}ddaLoadSettings(Q,Ua,Fb){this.kK((nc,Dc,cd)=>{var kd=this.$.pa.ya;nc=$f.b(nc,Ua);Dc=$f.a(Dc,this.DI);const qd=kd.Na(1);qd.controlId=Q;return Pg.g(kd,"DdaLoadSettings",qd,nc,Dc,cd,Fb,0)},Fb,501,16)}ddaSaveSettings(Q,Ua,Fb,nc,Dc){this.kK((cd,kd,qd)=>{var Id=this.$.pa.ya;cd=$f.b(cd,nc);kd=$f.a(kd,this.DI);const Yd=Id.Na(9);Yd.controlId=Q;Yd.settings=Ua;Yd.overwriteIfStale=Fb;return Pg.g(Id,
"DdaSaveSettings",Yd,cd,kd,qd,Dc,0)},Dc,571)}ddaAddRowsColumns(Q,Ua,Fb,nc,Dc,cd){this.kK((kd,qd,Id)=>{var Yd=this.$.pa.ya,Je=this.Wja();kd=$f.b(kd,Dc);qd=$f.a(qd,this.DI);const Se=Yd.Na(9);Se.controlId=Q;Se.bindingId=Ua;Se.isRow=Fb;Se.currentSheetName=Je;Se.bindingData=nc;return Pg.g(Yd,"DdaAddRowsColumns",Se,kd,qd,Id,cd,0)},cd,572)}ddaDeleteAllDataValues(Q,Ua,Fb,nc){this.kK((Dc,cd,kd)=>{var qd=this.$.pa.ya,Id=this.Wja();Dc=$f.b(Dc,Fb);cd=$f.a(cd,this.DI);const Yd=qd.Na(9);Yd.controlId=Q;Yd.bindingId=
Ua;Yd.currentSheetName=Id;return Pg.g(qd,"DdaDeleteAllDataValues",Yd,Dc,cd,kd,nc,0)},nc,573)}ddaClearBindingFormats(Q,Ua,Fb,nc){this.kK((Dc,cd,kd)=>{var qd=this.$.pa.ya,Id=this.Wja();Dc=$f.b(Dc,Fb);cd=$f.a(cd,this.DI);const Yd=qd.Na(9);Yd.controlId=Q;Yd.bindingId=Ua;Yd.currentSheetName=Id;return Pg.g(qd,"DdaClearBindingFormats",Yd,Dc,cd,kd,nc,0)},nc,574)}ddaSetBindingFormats(Q,Ua,Fb,nc,Dc,cd){this.kK((kd,qd,Id)=>{var Yd=this.$.pa.ya,Je=this.Wja();kd=$f.b(kd,Dc);qd=$f.a(qd,this.DI);const Se=Yd.Na(9);
Se.controlId=Q;Se.bindingId=Ua;Se.currentSheetName=Je;Se.bindingData=Fb;Se.isSetFormats=nc;return Pg.g(Yd,"DdaSetBindingFormats",Se,kd,qd,Id,cd,0)},cd,575)}parseRange(Q,Ua,Fb){this.kK((nc,Dc,cd)=>{const kd=this.$.pa.ya.Wb();return Pg.v(this.$.pa.ya,Q,-1,$f.b(nc,Ua),$f.a(Dc,this.DI),cd,Fb,kd)},Fb,162,16)}parseRangeForGoto(Q,Ua,Fb,nc){this.kK((Dc,cd,kd)=>{const qd=this.$.pa.ya.Wb();return Pg.w(this.$.pa.ya,Q,Ua,$f.b(Dc,Fb),$f.a(cd,this.DI),kd,nc,qd)},nc,562,16)}executeRichApiRequest(Q,Ua,Fb){y.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(Q.RequestFlags&=8191);if(y.EwaSettings.ma(256))this.TEh(this.$.pa.ya.Wb(),Ua,()=>{this.BQ.SKa(nf.a.internalError,Fb)},Fb,Q);else{let nc=Ed.DdaFacade.Rhd(Q);!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.yy||nc&16?(nc|=64,this.$.userOperationManager.pD(new Ui(this.$,Q,(Dc,cd,kd)=>bg(this.$.pa.ya,Q,$f.b(Dc,Ua),$f.a(cd,this.DI),kd,Fb),nc))):(this.BQ.SKa(nf.a.GFc,Fb),t.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Wja(){return this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.activeItemName}kK(Q,Ua,Fb,nc=0){!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.yy||nc&16?this.$.userOperationManager.pD(new Vh.a(Fb,0,Q,nc|64)):(this.BQ.SKa(nf.a.GFc,Ua),t.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}TEh(Q,Ua,Fb,nc,Dc){let cd=Ed.DdaFacade.Rhd(Dc);if(!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.yy||cd&16){var kd=this.$.Jb.Ac("UserAction",
"Rich Api request");this.$.userOperationManager.Kc(new Ti(this.$,Q,Ua,Fb,nc,kd,Dc,cd|64),null)}else this.BQ.SKa(nf.a.GFc,nc),t.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(d.a)(Wi,"DdaWebServiceHelper",null,[]);class Vi{constructor(Q,Ua,Fb,nc){this.xGh=Q;this.fileSize=Ua;this.aLj=nc}}Object(d.a)(Vi,"DocumentFile",null,[]);class og{}og.generalException="GeneralException";og.vRg="ApiNotFound";og.rFd="OperationCancelled";og.invalidArgument="InvalidArgument";Object(d.a)(og,
"ErrorCodes",null,[]);class ih{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(d.a)(ih,"WacApiDelegates",null,[]);var zh=a(614);class kg extends ih{constructor(Q,Ua){super();this.hmf=(Fb,nc)=>{Fb=kg.E$g(Fb,nc);if(!zh.a(this.$,Fb))return!0;Fb=this.$.shortcutKeyManager.x7e(Fb);return!!Fb&&
0<Fb.length};this.addinId=Q;this.$=Ua}replaceShortcuts(Q){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,Q,this.hmf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(Q){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(Q,this.hmf)}static feh(Q,Ua){const Fb=document.createEvent("KeyboardEvent");if(Sc.a.VF)Fb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(Q&8),!!(Q&32),!!(Q&4),!!(Q&256));else{const nc=
[];Q&4&&nc.push("Shift");Q&8&&nc.push("Control");Q&32&&nc.push("Alt");Fb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,nc.join(" "),!1,"en-US")}Q=new Sys.UI.DomEvent(Fb);Q.keyCode=Ua;return Q}static E$g(Q,Ua){if(Sc.a.fg)switch(Ua){case 189:Ua=173;break;case 187:Ua=61;break;case 186:Ua=59}return kg.feh(Q,Ua)}}Object(d.a)(kg,"ExcelWacApiDelegates",ih,[]);class zg{constructor(Q){this.FJa={};this.fHi=Q}MIg(Q,Ua){this.efc(Q)||(this.FJa[Q]={});if(this.koi(Q))return t.ULS.sendTraceTag(537163157,344,
50,`App ${Q} has reach the limit of number of cached files.`),nf.a.PHi;this.FJa[Q][Ua.xGh.toString()]=Ua;return nf.a.success}yUh(Q,Ua){let Fb=null;this.efc(Q)&&(Fb=this.FJa[Q][Ua.toString()]);Fb||t.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${Q}, fileHandler:${Ua}] doesn't exist`);return Fb}efc(Q){return Q in this.FJa}Zgj(Q,Ua){if(this.efc(Q)){const Fb=this.FJa[Q];delete Fb[Ua.toString()];1>Object.keys(Fb).length&&delete this.FJa[Q];return Ua.toString()in Fb?nf.a.internalError:nf.a.success}return nf.a.internalError}koi(Q){return this.efc(Q)?
Object.keys(this.FJa[Q]).length>=this.fHi:!1}static getInstance(Q){return Q.da.za(200)||Q.da.Ga(200,new zg(zg.gHi))}static YKi(){return++zg.X_g}}zg.KGi=4194304;zg.gHi=1;zg.X_g=0;Object(d.a)(zg,"GetFileApiHelper",null,[]);class Hh{constructor(Q){this.LA=Q}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.LA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){switch(Q){case 1:return this.DLi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){Q=this.invokeMethod(Q,
Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}DLi(){this.notifyActionHandlerReady();return null}}Object(d.a)(Hh,"AddinInternalService",null,[]);class Ph{constructor(Q,Ua){this.tJ=Ua;this.LA=Q}getAppRuntimeState(){return this.tJ.getAppRuntimeState(this.LA)?2:1}setAppRuntimeState(Q){switch(Q){case 2:Q=!0;break;case 1:Q=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.invalidArgument,tf.a.ga(1758));}this.tJ.setAppRuntimeState(this.LA,Q)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q,Ua){switch(Q){case 2:return this.wPh();case 1:return this.Rwj(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,
Ua){Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}wPh(){return this.getAppRuntimeState()}Rwj(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"int");this.setAppRuntimeState(Q);return null}}Object(d.a)(Ph,"AppRuntimeService",null,[]);var Wh=a(966);class Li{constructor(Q,Ua,Fb,nc){this.Ax=Q;this.W1=Fb;this.ez=nc.Wh.getOsfControl(Ua)}disable(){try{if(!tf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.GHe();
if(!this.Elf())return this.HHe();this.W1.zXj(this.Ax)}catch(Q){return t.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",Q.message||"Unknown"),this.EHe()}return null}enable(){try{if(!tf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.GHe();if(!this.Elf())return this.HHe();this.W1.Xej(this.Ax)}catch(Q){return t.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
Q.message||"Unknown"),this.EHe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,
Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){switch(Q){case 1:return this.nDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 3:return this.snh();case 2:return this.ksh()}Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}snh(){return this.disable()}ksh(){return this.enable()}nDa(){this._OnAccess();return null}GHe(){return Wh.a(Uf.a.notImplemented,
tf.a.ga(1759))}HHe(){return Wh.a(Uf.a.sharedRuntimeNotAvailable,tf.a.ga(1763))}EHe(){return Wh.a(Uf.a.generalException,tf.a.ga(1754))}Elf(){const Q=this.ez.getSharedRuntimeId();return!!Q&&0<Q.length}}Object(d.a)(Li,"BeforeDocumentCloseNotification",null,[]);class $i{constructor(){this.Jle=this.Pfe=this.HA=!1}get enabled(){return this.HA}set enabled(Q){this.HA=Q}get nativeRuntime(){return this.Pfe}set nativeRuntime(Q){this.Pfe=Q}get streamingEnabled(){return this.Jle}set streamingEnabled(Q){this.Jle=
Q}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(Q){switch(Q){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q,Ua){switch(Q){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ua,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Ua){Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}}Object(d.a)($i,"CustomFunctionEngineStatus",null,[]);class aj{constructor(Q,Ua,Fb){this.Eyg=Q;this.Fyg=Ua;this.ACg=Fb}get status(){const Q=new $i;Q.enabled=this.Eyg;Q.streamingEnabled=this.Fyg;Q.nativeRuntime=!1;return Q}register(Q){return OfficeExtension.WacRuntime.Utility.createPromise(this.ACg(Q))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(Q){switch(Q){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 1:return this.Lfj(Ua)}Q=this.invokeMethod(Q,
Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}Lfj(Q){const Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"string");return this.register(Ua,Q)}}Object(d.a)(aj,"CustomFunctionManager",null,[]);var bj=a(943);class cj{constructor(Q,Ua,Fb,nc){this.Q6d="";this.nUb=0;this.qP=Q;this._id=Ua;this.LA=Fb;this.tJ=nc}get id(){return this._id}_RegisterStateChange(){this.nUb||this.qP.execute(Q=>
{this.Q6d=Q.una(this._id,Ua=>{this.tJ.CIh(this.LA,this._id,JSON.stringify(Ua))})});this.nUb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.nUb--;this.nUb||this.qP.execute(Q=>{Q.ELd(this._id,this.Q6d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(Q){switch(Q){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 6:return this.isg();case 7:return this.ksg()}Q=
this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}isg(){return this._RegisterStateChange()}ksg(){return this._UnregisterStateChange()}}Object(d.a)(cj,"LicenseFeature",null,[]);class dj{constructor(Q,Ua){this.qP=Jc.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.LA=Q;this.tJ=Ua;this.qBg=this.tJ.Wh.getOsfControl(this.LA)}getFeatureTier(Q,Ua){return OfficeExtension.WacRuntime.Utility.createPromise(Fb=>{const nc=1===Ua?1:2===
Ua?2:0;this.qP.execute(Dc=>{Dc.getFeatureTier(Q,nc).then(cd=>{Fb(this.SYh(cd))},()=>{Fb(Ua)})})})}getLicenseFeature(Q){Q=new cj(this.qP,Q,this.LA,this.tJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}isFeatureEnabled(Q,Ua){return OfficeExtension.WacRuntime.Utility.createPromise(Fb=>{this.qP.execute(nc=>{nc.isFeatureEnabled(Q,Ua).then(Dc=>{Fb(Dc)},()=>{Fb(Ua)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(Q=>{this.qP.execute(Ua=>{Ua=
Ua.isFreemiumUpsellEnabled();Q(Ua)})})}launchUpsellExperience(Q){if(this.qBg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.qP.execute(Ua=>{Ua.launchUpsellExperience(Q)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.BVc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q,Ua){switch(Q){case 6:return this.jsg(Ua)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 2:return this.xVh(Ua);case 5:return this.RYh(Ua);
case 1:return this.Xoi(Ua);case 3:return this.Ipi();case 4:return this.szi(Ua)}Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}xVh(Q){const Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"int");return this.getFeatureTier(Ua,Q)}RYh(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.getLicenseFeature(Q)}Xoi(Q){const Ua=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,
0,"string");Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,1,"boolean");return this.isFeatureEnabled(Ua,Q)}Ipi(){return this.isFreemiumUpsellEnabled()}szi(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.launchUpsellExperience(Q)}jsg(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");this._TestFireStateChangedEvent(Q);return null}SYh(Q){switch(Q){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(dj,"License",
null,[]);var jj=a(153);const kj=(Q,Ua,Fb)=>nc=>(Dc,cd)=>{dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(Ua.da,279,Ua.la,1),kd=>{kd=kd.result;let qd=!1;var Id=Fb.Wh.getOsfControl(Q);let Yd=null;Id&&(Yd=Id.getStoreType(),(Id=Id.getManifest())&&Id.getSharedRuntimeForCustomFunctions("Workbook")&&(qd=!0));dg.TaskExtensions.Aa(kd.vff(Q,Yd,nc,qd),Je=>{jj.b(Je)?Je.result?Dc(null):cd(OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.invalidArgument,ff.a.instance.ga(1758))):cd(OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,
ff.a.instance.ga(1754)))},Ua.la,3)},Ua.la,3)};class Xi{constructor(Q){if(!Q)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.ryd=Q}areShortcutsInUse(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Ua,Fb)=>{this.ryd.checkShortcutsInUse(Q).then(nc=>{Ua(nc)}).catch(nc=>{Fb(nc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((Q,Ua)=>{this.ryd.getShortcuts().then(Fb=>{Q(Fb)}).catch(Fb=>{Ua(Fb)})})}replaceShortcuts(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Ua,
Fb)=>{this.ryd.replaceShortcuts(Q).then(()=>{Ua(null)}).catch(nc=>{Fb(nc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokeMethodAsync(Q,Ua){switch(Q){case 3:return this.dTg(Ua);case 1:return this.f4h();case 2:return this.ymj(Ua)}Q=this.invokeMethod(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}dTg(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"Array<string>");return this.areShortcutsInUse(Q)}f4h(){return this.getShortcuts()}ymj(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"any");return this.replaceShortcuts(Q)}}Object(d.a)(Xi,"ActionService",
null,[]);var ej=a(518);class fj{constructor(){this.Vra=null}U3h(){this.Vra||(this.Vra=ej.a.mr(Jc.a.instance.Ub("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Vra}getSharedFilePickerResponse(Q){return OfficeExtension.WacRuntime.Utility.createPromise((Ua,Fb)=>{try{const nc=this.U3h();xh.Task.WAA.call(null,nc).continueWith(()=>{const Dc=nc.result;if(Dc){let cd={};({At:cd}=Mf.d(Q)).returnValue?Dc.Agd(cd).then(kd=>{kd&&0<kd.length?Ua(kd):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(kd=>{Fb(kd)}):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(nc){Fb(nc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);
}invokePropertyGetAsync(Q){Q=this.invokePropertyGet(Q);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}invokePropertySet(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokePropertySetAsync(Q,Ua){this.invokePropertySet(Q,Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(Q){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(Q);}invokeMethodAsync(Q,Ua){switch(Q){case 1:return this.T3h(Ua)}Q=this.invokeMethod(Q,
Ua);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Q)}T3h(Q){Q=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Q,0,"string");return this.getSharedFilePickerResponse(Q)}}Object(d.a)(fj,"SharedFilePicker",null,[]);class gj{createInstance(Q,Ua){switch(Q){case "Microsoft.Office.ActionService":return new Xi(Ua);case "Microsoft.Office.SharedFilePicker":return new fj}return null}}Object(d.a)(gj,"WacApiHost",null,[]);class hj{constructor(Q,Ua,Fb,nc,Dc){this.fVc=null;this.wSb=
Q;this.LA=Ua;this.tJ=Fb;this.jb=nc;this.wGg=Dc}hostName(){return"ExcelOnline"}appId(){return this.wSb}createInstance(Q){switch(Q){case "Microsoft.Authentication.AuthenticationService":return Jc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.LA,this.tJ.Wh);case "Microsoft.Authentication.TokenParameters":return new R;case "Microsoft.ExcelServices.CustomFunctionManager":Q=this.jb.ma(121);var Ua=this.jb.ma(122);return new aj(Q,Ua,kj(this.wSb,
this.jb,this.tJ));case "Microsoft.AppRuntime.AppRuntimeService":return new Ph(this.LA,this.tJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return Q=Gf.a(this.jb),new Li(this.wSb,this.LA,Q,this.tJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return Q=Gf.a(this.jb),new bj.DynamicRibbon(this.wSb,this.LA,this.tJ,Q,Q.An(this.LA).wl);case "Microsoft.Office.Licensing.License":return new dj(this.LA,this.tJ);case "Microsoft.InternalService.AddinInternalService":return new Hh(this.LA);
default:if(this.fVc||(this.fVc=new gj),Ua=this.fVc.createInstance(Q,this.wGg))return Ua}t.ULS.sendTraceTag(537163155,0,10,`Typename: ${Q} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Uf.a.generalException,Uf.a.generalException);}}Object(d.a)(hj,"RichApiHost",null,[]);var lj=a(381),ij=a(28),mj=a(118),Yi=a(35),nj=a(99),oj=a(285),pj=a(44),qj=a(250),rj=a(6),sj=a(69),tj=a(200);class If{constructor(Q,Ua,Fb,nc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=Q;this.ie=Ua;this.htmlSanitizationHelper=nc;this.xe=new eg(Q.ea);this.uA=new Wi(Q,this.xe);this.Ywf=Fb;this.cac=new Map}get BQ(){return this.xe}dispose(){this.$=this.cac=null}nc(){return!1}Jc(){return!1}executeCommand(Q,Ua,Fb){Q=Ua.command;switch(Q){case 451041795:this.xe.qf(Fb[Ug.a.lg],Fb[Ug.a.a4]);break;case 974713501:this.w$h(Fb[Ug.a.lg],Fb[Ug.a.a4]);break;case 1237877382:this.xe.zv(Fb[Ug.a.a4]);break;default:return ei.a(Q)}return xh.Task.Ta(!0)}wc(Q,Ua,Fb){if(Q=!!Fb)switch(Ua.command){case 974713501:case 1237877382:case 451041795:break;
default:Q=!1}return Q}w$h(Q,Ua){var Fb,nc;const Dc=Q.DdaMethod;"undefined"===typeof Dc.DispatchId?this.xe.qf(nf.a.internalError,Ua):If.coi(Q)||this.$.rd&1?(Dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new ag(this.$,this,Q,Ua,this.htmlSanitizationHelper)).start(this.ie,Q.DdaMethod.ControlId):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.u3h(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.pBj(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(Q,this.Vfd(Q.DdaMethod.ControlId),0,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.bQh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.cxj(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.aQh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Ygj(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.aPh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.qwd(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(Q.DdaAddRowsColumns.IsRow=!0,this.qqe(Q,Ua)):Dc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(Q.DdaAddRowsColumns.IsRow=!1,this.qqe(Q,Ua)):Dc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.blh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.F4g(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(Q.DdaSetBindingFormats.IsSetFormats=!0,this.Q2f(Q,Ua)):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(Q.DdaSetBindingFormats.IsSetFormats=!1,this.Q2f(Q,Ua)):Dc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(Q,Q.DdaBindingsMethod.ItemName,Q.DdaBindingsMethod.FailOnCollision?2:1,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.BVh(Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pAd(Q,Ua):Dc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.vUh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.wUh(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.$gj(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(Q.DdaMethod.ControlId,Q),this.xe.zv(Ua)):
Dc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?y.EwaSettings.ma(23)?this.xe.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ua):this.kIi(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?y.EwaSettings.ma(23)?this.xe.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ua):this.gIi(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(Q,Ua):Dc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(Q,Ua):this.xe.qf(nf.a.vFd,Ua),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Dc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Q=this.ie.IZ(Q.DdaMethod.ControlId),Ua="",Q&&(Ua=Ed.DdaFacade.getSolutionId(Q,this.$),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Ua=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua,Q.OwnerAddinStoreType||Q.PrimaryMarketplace.MarketplaceType,null===
(Fb=Q.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,null,null,Q.PrimaryMarketplace.MarketplaceRef):(Fb=Q.PrimaryMarketplace.MarketplaceType,Fb===OSF.StoreType.InMemory?Q.OwnerAddinSolutionId&&Q.AssetMarketplace&&(Fb=Q.AssetMarketplace.MarketplaceType):Fb===OSF.StoreType.WopiCatalog&&(Fb=OSF.StoreType.OMEX),Ua=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ua,Fb,null===(nc=Q.AssetMarketplace)||void 0===nc?void 0:nc.SolutionId,null,null,Q.PrimaryMarketplace.MarketplaceRef))),t.ULS.sendTraceTag(537163224,
344,50,`DDA method Id: ${Dc.DispatchId}, AppID: ${Ua}`))):this.xe.qf(nf.a.KNe,Ua)}bQh(Q,Ua){Q.DdaGetBindingData.CoerceType=If.L4b(Q.DdaGetBindingData.CoerceType);Q.DdaGetBindingData.FilterType=If.yXe(Q.DdaGetBindingData.FilterType);Q.DdaGetBindingData.ValueFormat=If.Ukg(Q.DdaGetBindingData.ValueFormat);if(this.skc(Q.DdaGetBindingData.CoerceType,Ua)){if(Q.DdaGetBindingData){const Fb=Q.DdaGetBindingData;0===Fb.FilterType&&(Fb.FilterType=2);Fb.StartCol|=0;Fb.StartRow|=0;Fb.ColCount=void 0===Fb.ColCount?
-1:Fb.ColCount;Fb.RowCount=void 0===Fb.RowCount?-1:Fb.RowCount}this.uA.ddaGetBindingData(Q.DdaMethod.ControlId,Q.DdaGetBindingData.BindingId,Q.DdaGetBindingData.CoerceType,Q.DdaGetBindingData.ValueFormat,Q.DdaGetBindingData.FilterType,Q.DdaGetBindingData.StartRow,Q.DdaGetBindingData.StartCol,Q.DdaGetBindingData.RowCount,Q.DdaGetBindingData.ColCount,Fb=>{if(Rf.a(Fb)||!Fb.Result)this.xe.LH(Fb,Ua);else{const nc=this.xe.oQ();nc.Data=If.Oye(Fb.Result);Ua(nc)}},Ua)}}cxj(Q,Ua){Q.DdaSetBindingData.CoerceType=
If.L4b(Q.DdaSetBindingData.CoerceType);if(this.skc(Q.DdaSetBindingData.CoerceType,Ua)){var Fb=If.d0c(Q.DdaSetBindingData.CoerceType,Q.DdaSetBindingData.Data);If.uhc(Fb)?this.xe.qf(nf.a.rDc,Ua):(1===Fb.CoerceType&&(Fb.CellFormat||(Fb.CellFormat=Q.DdaSetBindingData.CellFormat),Fb.TableOptions||(Fb.TableOptions=Q.DdaSetBindingData.TableOptions)),Q.DdaSetBindingData&&(Q.DdaSetBindingData.StartCol|=0,Q.DdaSetBindingData.StartRow|=0),this.uA.ddaSetBindingData(Q.DdaMethod.ControlId,Q.DdaSetBindingData.BindingId,
Q.DdaSetBindingData.StartRow,Q.DdaSetBindingData.StartCol,Fb,nc=>{Rf.a(nc)?this.xe.LH(nc,Ua):this.xe.zv(Ua)},Ua))}}u3h(Q,Ua){Q.DdaGetBindingData.CoerceType=If.L4b(Q.DdaGetBindingData.CoerceType);Q.DdaGetBindingData.ValueFormat=If.Ukg(Q.DdaGetBindingData.ValueFormat);Q.DdaGetBindingData.FilterType=If.yXe(Q.DdaGetBindingData.FilterType);if(this.skc(Q.DdaGetBindingData.CoerceType,Ua)){var Fb=this.Vfd(Q.DdaMethod.ControlId);Fb?this.uA.ddaGetSelectedData(Q.DdaMethod.ControlId,Q.DdaGetBindingData.CoerceType,
Q.DdaGetBindingData.ValueFormat,Q.DdaGetBindingData.FilterType,Fb,nc=>{if(Rf.a(nc))this.xe.LH(nc,Ua);else{const Dc=this.xe.oQ();Dc.Data=If.Oye(nc.Result);Ua(Dc)}},Ua):this.xe.qf(nf.a.g7e,Ua)}}vUh(Q,Ua){const Fb=Q[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],nc=Q[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Dc=Q.DdaMethod.ControlId,cd=zg.getInstance(this.$);if(0>=nc)t.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.xe.qf(nf.a.Gki,
Ua);else if(nc>zg.KGi)t.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.xe.qf(nf.a.$1e,Ua);else{var kd=null;switch(Fb){case 1:kd="Compressed";break;case 0:kd="Text";break;case 2:kd="Pdf";break;default:t.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Fb} is not supported.`);this.xe.qf(nf.a.mXe,Ua);return}if("Text"===kd)t.ULS.sendTraceTag(537163218,344,15,`Requested file type ${kd} is not supported.`),this.xe.qf(nf.a.mXe,Ua);else{y.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(Q=new Sys.StringBuilder,Q.append(Jg.a(this.$,kd)),"Pdf"===kd&&yh.a.Yk(Q,wf.a.APf,"WholeWorkbook"),Q=Q.toString()):Q=Jg.a(this.$,kd);var qd=null,Id=new XMLHttpRequest;Id.onreadystatechange=()=>{if(4===Id.readyState)if(200===Id.status){var Yd=Id.response;if(Yd){qd=new Uint8Array(Yd);Yd=this.xe.oQ();var Je=qd.length,Se=zg.YKi(),vf={},Kg=0;for(let rg=0;rg<Je;rg+=nc){const lg=[],mg=rg+nc<Je?rg+nc:Je;for(let Ag=0,jh=rg;jh<mg;Ag++,jh++)lg[Ag]=qd[jh];vf[(Kg++).toString()]=lg}vf=new Vi(Se,Je,nc,vf);vf=cd.MIg(Dc,
vf);vf!==nf.a.success?this.xe.qf(vf,Ua):(Yd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Se,Yd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Je,t.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${kd}, the file size is ${Je}`),Ua(Yd))}else t.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${kd}.`),this.xe.qf(nf.a.internalError,Ua)}else 500===Id.status?this.xe.qf(nf.a.LZe(parseInt(Id.statusText,
10)),Ua):(t.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${kd}.`),this.xe.qf(nf.a.FKi,Ua))};Id.open("GET",Q,!0);Id.responseType="arraybuffer";Id.setRequestHeader("If-Modified-Since","0");Id.send(null)}}}wUh(Q,Ua){var Fb=Q[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],nc=Q[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];Q=Q.DdaMethod.ControlId;(Fb=zg.getInstance(this.$).yUh(Q,Fb))?(Fb=Fb.aLj,0>nc||nc>=Object.keys(Fb).length?this.xe.qf(nf.a.rfi,
Ua):(nc=Fb[nc.toString()],Fb=this.xe.oQ(),Fb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=nc,Fb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=nc.length,Ua(Fb))):this.xe.qf(nf.a.internalError,Ua)}$gj(Q,Ua){var Fb=Q[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];Q=Q.DdaMethod.ControlId;Fb=zg.getInstance(this.$).Zgj(Q,Fb);Fb===nf.a.success?this.xe.zv(Ua):this.xe.qf(Fb,Ua)}pBj(Q,Ua){Q.DdaSetBindingData.CoerceType=If.L4b(Q.DdaSetBindingData.CoerceType);if(this.skc(Q.DdaSetBindingData.CoerceType,
Ua)){var Fb=this.Vfd(Q.DdaMethod.ControlId);if(Fb){var nc=If.d0c(Q.DdaSetBindingData.CoerceType,Q.DdaSetBindingData.Data),Dc=Fg.h(this.$).ha;1===nc.CoerceType&&(!nc.Data&&Dc.ra.U5&&(nc.Headers||(nc.Headers=[]),nc.Headers.length||nc.Headers.push([]),nc.Headers[0].length||nc.Headers[0].push("")),If.uhc(nc)||(nc.CellFormat||(nc.CellFormat=Q.DdaSetBindingData.CellFormat),nc.TableOptions||(nc.TableOptions=Q.DdaSetBindingData.TableOptions)));if(If.uhc(nc))this.xe.qf(nf.a.rDc,Ua);else{var cd=Dc.ra.$c.clone(),
kd=Dc.ra.activeCell.clone();this.uA.ddaSetSelectedData(Q.DdaMethod.ControlId,Fb,nc,qd=>{var Id;if(Rf.a(qd))this.xe.LH(qd,Ua);else{qd=cd.clone();const Yd=nc.Headers?nc.Headers[0].length:nc.Data[0].length;1!==nc.CoerceType||nc.Data?1===nc.CoerceType&&(null===(Id=nc.TableOptions)||void 0===Id?0:Id.length)&&0==nc.TableOptions[0]?(qd.top+=1,qd.bottom=qd.top+nc.Data.length-1):qd.bottom=qd.top+nc.Data.length-(1===nc.CoerceType?0:1):qd.bottom=qd.top+1;qd.right=qd.left+Yd-1;Id=qd.contains(kd)?kd:qd.topLeft;
Dc.updateSelection(qd,Id,0);this.xe.zv(Ua)}},Ua)}}else this.xe.qf(nf.a.oBe,Ua)}}addBinding(Q,Ua,Fb,nc){Ua?this.uA.ddaAddBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Q.DdaBindingsMethod.BindingType,Ua,Fb,Dc=>{if(Rf.a(Dc))this.xe.LH(Dc,nc);else{const cd=this.xe.oQ();cd.Bindings=Array(1);cd.Bindings[0]=this.ie.n2b(Dc.Result);nc(cd)}},nc):this.xe.qf(nf.a.uuj,nc)}aQh(Q,Ua){this.uA.ddaGetBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Fb=>{if(Rf.a(Fb)||!Fb.Result)this.xe.LH(Fb,
Ua);else{const nc=this.xe.oQ();nc.Bindings=Array(1);nc.Bindings[0]=this.ie.n2b(Fb.Result);Ua(nc)}},Ua)}BVh(Q){const Ua=this.xe.oQ(),Fb={};Fb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ua[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Fb;Q(Ua)}Ygj(Q,Ua){this.uA.ddaReleaseBinding(Q.DdaMethod.ControlId,Q.DdaBindingsMethod.BindingId,Fb=>{Rf.a(Fb)?this.xe.LH(Fb,Ua):this.xe.zv(Ua)},Ua)}aPh(Q,Ua){this.uA.ddaGetAllBindings(Q.DdaMethod.ControlId,Fb=>
{if(Rf.a(Fb))this.xe.LH(Fb,Ua);else{const nc=this.xe.oQ();if(Fb.Result){Fb=Fb.Result;nc.Bindings=Array(Fb.length);for(let Dc=0;Dc<Fb.length;Dc++)nc.Bindings[Dc]=this.ie.n2b(Fb[Dc])}else nc.Bindings=null;Ua(nc)}},Ua)}qwd(Q,Ua){this.uA.ddaLoadSettings(Q.DdaMethod.ControlId,Fb=>{if(Rf.a(Fb))this.xe.LH(Fb,Ua);else{const nc=this.xe.oQ();nc.Properties=Fb.Result;Ua(nc)}},Ua)}saveSettings(Q,Ua){const Fb={Settings:[]};for(let nc=0;nc<Q.DdaSettingsMethod.Properties.length;nc++){const Dc={};Dc.Name=Q.DdaSettingsMethod.Properties[nc][0];
Dc.Value=Q.DdaSettingsMethod.Properties[nc][1];Fb.Settings[nc]=Dc}this.uA.ddaSaveSettings(Q.DdaMethod.ControlId,Fb,Q.DdaSettingsMethod.OverwriteIfStale,nc=>{Rf.a(nc)?this.xe.LH(nc,Ua):this.xe.zv(Ua)},Ua)}qqe(Q,Ua){const Fb=If.d0c(1,Q.DdaAddRowsColumns.Data);If.uhc(Fb)?this.xe.qf(nf.a.rDc,Ua):this.uA.ddaAddRowsColumns(Q.DdaMethod.ControlId,Q.DdaAddRowsColumns.BindingId,Q.DdaAddRowsColumns.IsRow,Fb,nc=>{Rf.a(nc)?this.xe.LH(nc,Ua):this.xe.zv(Ua)},Ua)}blh(Q,Ua){this.uA.ddaDeleteAllDataValues(Q.DdaMethod.ControlId,
Q.DdaBindingsMethod.BindingId,Fb=>{Rf.a(Fb)?this.xe.LH(Fb,Ua):this.xe.zv(Ua)},Ua)}F4g(Q,Ua){this.uA.ddaClearBindingFormats(Q.DdaMethod.ControlId,Q.DdaClearBindingFormats.BindingId,Fb=>{Rf.a(Fb)?this.xe.LH(Fb,Ua):this.xe.zv(Ua)},Ua)}Q2f(Q,Ua){const Fb={},nc=Q.DdaSetBindingFormats.IsSetFormats;nc?Fb.CellFormat=Q.DdaSetBindingFormats.CellFormat:Fb.TableOptions=Q.DdaSetBindingFormats.TableOptions;this.uA.ddaSetBindingFormats(Q.DdaMethod.ControlId,Q.DdaSetBindingFormats.BindingId,Fb,nc,Dc=>{Rf.a(Dc)?this.xe.LH(Dc,
Ua):this.xe.zv(Ua)},Ua)}executeRichApiRequest(Q,Ua){var Fb;const nc=Q.ArrayData,Dc={},cd=Fg.h(this.$).ha;if(nc){if("WacPartition"===nc[0]){this.zEh(Q,Ua);return}const Se=Object(O.a)(Ed.DdaFacade,Gf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===nc[0]){var kd=Se.An(Q.DdaMethod.ControlId);kd&&(kd.ijc=!0,kd.TOf())}Dc.HttpMethod=nc[1];Dc.PathAndQuery=nc[2];Dc.RequestHeaders=If.w3e(nc[3]);Dc.RequestBody=nc[4];Dc.AppPermission=nc[5];kd=nc[6];Dc.RequestFlags=kd;var qd=0;if(Rh.i(this.$.na))switch(cd.Ne){case 1:qd=
2;break;case 2:qd=3;break;case 128:qd=4;break;default:qd=1}var Id=null;cd.Ra.hB&&(Id=cd.Ra.hB.nj);Dc.SheetMultiRange=Oh.r(cd.ra.selectedRanges,this.$);Dc.ActiveCell=Oh.v(cd.ra.activeCell,this.$);Dc.ActiveChartId=Id;Dc.SelectionState=qd;qd=this.ie.IZ(Q.DdaMethod.ControlId);Dc.InstanceId=qd?qd.InstanceId:"";if(qd&&qd.PrimaryMarketplace){let vf;if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1))if(qd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)vf=
qd.PrimaryMarketplace.SolutionId,Id=qd.PrimaryMarketplace.MarketplaceType;else{if(!qd.OwnerAddinSolutionId){t.ULS.sendTraceTag(512325018,344,15,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.xe.qf(nf.a.SMa,Ua);return}if(!qd.OwnerAddinStoreType){t.ULS.sendTraceTag(512325017,344,15,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.xe.qf(nf.a.SMa,Ua);return}vf=qd.OwnerAddinSolutionId;Id=qd.OwnerAddinStoreType}else if(vf=Ed.DdaFacade.getSolutionId(qd,this.$),
Id=qd.PrimaryMarketplace.MarketplaceType,Id===OSF.StoreType.InMemory){if(!qd.OwnerAddinSolutionId){this.xe.qf(nf.a.SMa,Ua);return}if(qd.AssetMarketplace)Id=qd.AssetMarketplace.MarketplaceType;else{this.xe.qf(nf.a.SMa,Ua);return}}else Id===OSF.StoreType.WopiCatalog&&(Id=OSF.StoreType.OMEX);let Kg=Telemetry.PrivacyRules.GetPrivacyCompliantId(vf,Id,null===(Fb=qd.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,null,null,qd.PrimaryMarketplace.MarketplaceRef);Dc.CompliantSolutionId=Kg;Dc.SolutionId=
vf;Dc.MarketplaceType=Id;Dc.SolutionVersion=qd.PrimaryMarketplace.SolutionVersion;Dc.StoreLocation=qd.PrimaryMarketplace.MarketplaceRef}else Dc.SolutionId=Dc.MarketplaceType="",Dc.CompliantSolutionId="";Dc.IsEventsEnabled=void 0===Se||null===Se||Se.kj.z1b(Dc.InstanceId);Dc.RequestGuid=ch.a.create().toString();Fb=Dc.RequestBody.length;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Fb>this.$.va.ExcelRichApiMaxAllowedRequestPayloadSize){this.xe.qf(nf.a.Rnj,Ua);t.ULS.sendTraceTag(537163213,
0,50,`Request payload size:${Fb} exceeded the limit`);return}y.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&kd&4096&&(Fb=new qg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Fb,lf,nc),Dc.RequestBody=nc[4])}const Yd=If.J6e(Dc.RequestHeaders);If.pGd++;const Je=ij.a.Qa.zb;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Dc&&Dc.RequestBody&&t.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Dc.RequestBody.length}`);
this.uA.executeRichApiRequest(Dc,Se=>{var vf;this.W1f(Je,!0,Se.ServerCorrelationId);let Kg=null,rg=null;var lg=Se.ServerCorrelationId;if(null===(vf=null===Se||void 0===Se?void 0:Se.Errors)||void 0===vf?0:vf[0])Kg=Se.Errors[0].MessageIdName,rg=Se.Errors[0].Description,y.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&sj.a(this.$).fd.xM(Se.Errors[0].MessageId);if(Rf.a(Se)||!Se.Result)this.C9a(lg,Yd,"Server error",Kg,rg),this.xe.LH(Se,Ua);else{let Ag=null;if(y.EwaSettings.ma(256))if((vf=
Se.Result)&&vf.length){for(let kh=0;kh<vf.length;kh++)if(vf[kh].RequestGuid===Dc.RequestGuid){Ag=vf[kh];break}Ag||this.xe.LH(Se,Ua)}else Ag=Se.Result;else Ag=Se.Result;if(!Kg&&Ag&&Ag.ResponseBody&&Ag.ResponseBody[0])if(Se=Ag.ResponseBody[0],Se.startsWith('{"Error":')){1<Ag.ResponseBody.length&&(Se=Se.substring(0,Se.indexOf("}")+1),Se+="}");try{var mg=z.a.li(Se);mg.Error&&this.C9a(lg,Yd,"Pipeline error",mg.Error.Code,mg.Error.Message)}catch(kh){this.C9a(lg,Yd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.C9a(lg,
Yd);else this.C9a(lg,Yd,"Server error",Kg,rg);const jh=(lg=Ag.SheetMultiRange)?lg.SheetName:null;mg=Ag.ActiveChartId;const fh=Ag.SelectionState;Se=5===fh&&!!lg||6===fh||7===fh||8===fh;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.yy&&Se)this.xe.qf(nf.a.GFc,Ua),t.ULS.sendTraceTag(537163211,0,50,`${fh.toString()} is not allowed`);else if(5===fh&&lg){if(this.$.xa&&jh)if(this.$.xa.Qk(jh))this.ZVc(jh);else{let kh=null;kh=()=>{this.$.xa.Qk(jh)&&
(t.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.ZVc(jh),this.$.xa.eKb(kh))};this.$.xa.vob(kh);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let si=null;si=()=>{this.$.xa.Qk(jh)&&(this.ZVc(jh),this.$.xa.Ena(si))};this.$.xa.oha(si)}}}else if(6===fh||7===fh||8===fh||9===fh){if(lg){const kh=Oh.g(lg.Ranges);if(jh&&Oh.cb(kh,!0))if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!this.$.xa.Qk(jh)){let si=null;si=()=>{this.pjg(cd,kh,jh,fh);this.$.xa.Ena(si)};this.$.xa.oha(si)}else this.pjg(cd,kh,jh,fh)}7===fh?(mg="38.{"+tj.e(mg)+"}",Gh.a(this.$).Yna(0,mg,!0)):8===fh&&Gh.a(this.$).Yna(2,mg,!0);9===fh&&(this.$.va.ApiCallToSetPageLayout=!0)}Ag.PostProcessActions?(lg=z.a.li(Ag.PostProcessActions),this.n7i(lg).then(()=>{this.Jdb(Ag,Ua);this.Ucd(Q.DdaMethod.ControlId,Dc);return Promise.resolve(null)},kh=>{this.Jdb(Ag,Ua,kh);return Promise.reject(kh)})):this.Jdb(Ag,Ua)}},Se=>{this.W1f(Je,
!1,null);this.C9a(null,Yd,"Web service error");Ua(Se)})}Ucd(Q,Ua){const Fb=Object(O.a)(Ed.DdaFacade,Gf.a(this.$));(null===Fb||void 0===Fb?0:Fb.aPd)&&Fb.An(Q)&&If.fFj(Ua.RequestHeaders)&&(t.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${Q}; SolutionId: ${Ua.SolutionId}.`),Fb.aPd.qth(Q))}zEh(Q,Ua){var Fb=this.ie.IZ(Q.DdaMethod.ControlId);const nc=Ed.DdaFacade.getSolutionId(Fb,this.$);var Dc=null;Dc=Ed.DdaFacade.Nva(Fb,this.$);
Dc=new kg(Dc,this.$);Dc=new hj(nc,Q.DdaMethod.ControlId,this.ie,this.$,Dc);const cd={ResponseHeaders:[]};cd.ResponseBody=Array(1);Fb=If.w3e(Q.ArrayData[3]);const kd=If.J6e(Fb);Fb=new Df(this.$.va.CreateWorkbookMaxAllowedBase64Size,this.Ywf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Dc,Ne,Fb,Q.ArrayData).then(qd=>{if(!qd)return this.gxd(!1,"The rich api executor call failed",kd),t.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),cd.ResponseStatusCode=500,this.Jdb(cd,
Ua),null;this.gxd(!0,"The rich api executor call succeeded",kd);cd.ResponseStatusCode=qd[0];cd.ResponseBody[0]=qd[2];this.Jdb(cd,Ua);return null},qd=>{cd.ResponseStatusCode=400;cd.ResponseBody[0]=qd.toString();this.gxd(!1,"The rich api executor call failed",kd);t.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${nc}`);this.Jdb(cd,Ua);return null})}W1f(Q,Ua,Fb){If.pGd--;Q=mj.a(ij.a.Qa,Q);t.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${Q}, requests pending:${If.pGd}, request result:${Ua?
"success":"false"}, server correlationid: ${Fb}.`)}Jdb(Q,Ua,Fb=null){const nc=Array(3);nc[0]=Q.ResponseStatusCode;nc[1]=If.K4h(Q.ResponseHeaders);const Dc=[];var cd=!1;if(Fb&&Q.ResponseBody){const kd=z.a.li(Q.ResponseBody.join(""));kd.Error||(cd={},cd.Error=Fb,cd.TraceIds=kd.TraceIds,cd.ProcessedResults={},cd.ProcessedResults.Results=kd.Results,Dc[0]=z.a.hc(cd),cd=!0)}nc[2]=cd?Dc:Q.ResponseBody;Q=this.xe.oQ();Q.Data=nc;Ua(Q)}pAd(Q,Ua){(new Vf(this.$,this.xe,this.uA)).pAd(Q,Ua)}kIi(Q,Ua){t.ULS.sendTraceTag(537163206,
0,50,"MessageParent API called!");const Fb=Q[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],nc=Q[ue.a.YXc],Dc=Q[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];Q=this.$.da.za(232).C2a.lIi(Q.DdaMethod.ControlId,Fb,nc,Dc);Q===nf.a.success?this.xe.zv(Ua):(t.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.xe.qf(Q,Ua))}gIi(Q,Ua){t.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Fb=Q[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],nc=Q[ue.a.YXc],Dc=Q[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.za(232).C2a.mvj(Q.DdaMethod.ControlId,Fb,nc,Dc);this.xe.zv(Ua)}getAccessToken(Q,Ua){t.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Fb=(Dc,cd)=>{var kd;if(Dc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Dc=this.xe.oQ(),Dc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=cd.accessToken,Ua(Dc);else{cd=this.ie.IZ(Q.DdaMethod.ControlId);let qd=null!==cd.OwnerAddinStoreType?cd.OwnerAddinStoreType:cd.PrimaryMarketplace.MarketplaceType;t.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:Dc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.DdaFacade.getSolutionId(cd,this.$),qd,null===(kd=cd.AssetMarketplace)||void 0===kd?void 0:kd.SolutionId,null,null,cd.PrimaryMarketplace.MarketplaceRef),["storeType"]:qd})}.`);this.xe.qf(Dc,Ua)}},nc=!y.EwaSettings.ma(23);dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),Dc=>{const cd=this.ie.Wh,kd=Yc.getInstance();Xb.AppsForOfficeSingleSignOnManager.getInstance(cd,Dc.result,
kd).getAccessToken(Q.DdaMethod.ControlId,nc,Q,Fb)},this.$.la)}getAuthContext(Q,Ua){dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>{var Fb=this.ie.Wh.getOsfControl(Q.DdaMethod.ControlId);if(Fb.isFirstParty()){Fb=Fb.getManifest();var nc=Fb.getMarketplaceID(),Dc=Fb.getWebApplicationId(),cd=Fb.getWebApplicationMsaId();Jc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(nc).then(kd=>{const qd=this.xe.oQ(),Id={};Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
Dc;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=cd||Dc;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=kd.upn;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=kd.userId;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=kd.authority;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Ld.a.KPh(kd.authorityType);Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=kd.isAnonymous;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
kd.tenantId;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=kd.supportsAuthToken;qd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Id;Ua(qd)},kd=>{const qd=this.xe.oQ(),Id={},Yd=new Ld.a;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Dc;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=cd||Dc;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Yd.upn;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Yd.userId;
Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Yd.authority;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Yd.authorityType;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Yd.isAnonymous;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Yd.tenantId;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=kd;Id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Yd.supportsAuthToken;qd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Id;qd.Error=1;Ua(qd)})}},this.$.la)}Pni(Q){const Ua=Fg.h(this.$).ha;return 16===Ua.Ne&&!!Ua.Ra.$b&&!!Ua.Ra.$b.floatingObject&&Qh.a.equals(Ua.Ra.$b.floatingObject.id,Q,!0)}Vfd(Q){const Ua=Fg.h(this.$).ha;return Ua.ra.Mg?1===Ua.Ne||this.Pni(Q)?Ua.Jia:null:null}skc(Q,Ua){return 1!==Q&&2!==Q&&3!==Q?(this.xe.qf(nf.a.FEe,Ua),!1):!0}gxd(Q,Ua,Fb){const nc={};nc.a=this.$.va.UserSessionId;nc.b=Q;nc.c=Ua;nc.d=null;nc.e=Fb;ci.b().Pe(37,nc)}C9a(Q,Ua,Fb=null,nc=null,Dc=null){const cd={};Q&&(cd.ServerCorrelationId=
Q);void 0!==Ua&&null!==Ua&&(cd.Source=Ua);Fb&&(cd.ErrorType=Fb);nc&&(cd.MessageId=nc);Dc&&(cd.StatusDescription=Dc);y.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&nc&&"ExternalDataRefreshFailed"===nc&&(cd.StatusDescription="");t.ULS.sendTraceTag(50688452,0,50,z.a.hc(cd))}n7i(Q){let Ua=new Promise(Fb=>{Fb(null)});for(let Fb=0;Fb<Q.length;Fb++)Ua=this.m7i(Ua,Q[Fb]);return Ua}m7i(Q,Ua){if(!Ua)return t.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),Q.then(()=>Promise.reject(If.y4a(og.generalException,
ff.a.instance.ga(1754),null)));switch(Ua.actionType){case 1:case 2:Q=Q.then(()=>{const Fb=Object(O.a)(Ed.DdaFacade,Gf.a(this.$));if(Fb.An(Ua.controlId))switch(Fb.kj.L9h(Ua),Ua.messageType){case 14:case 100:Fb.$Od.U1b(Ua);break;case 11:case 12:Fb.Jqj.Lpb(Ua);break;case 51:case 52:Fb.Hqj.Lpb(Ua);break;case 2101:case 2102:Fb.Iqj.Lpb(Ua);break;case 2E3:Fb.Kqj.U1b(Ua);break;case 2201:this.$.G5&&Fb.aPd.WTg(Ua);break;case 2203:Fb.Lqj.XTg(Ua);break;case 2700:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Fb.ZOd.U1b(Ua)}else t.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ua.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:Q=Q.then(()=>{this.w9h(Ua);return Promise.resolve(null)});break;case 15:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(Q=Q.then(()=>{this.dai(Ua);return Promise.resolve(null)}));break;case 4:Q=Q.then(()=>{if(y.EwaSettings.ma(104)){var Fb=Fg.h(this.$).ha.ra.activeCell;Fb.top!==Ua.row+1&&Fb.left!==Ua.column+1&&(Fb=Oh.v(Ig.Range.Qc(Ua.row+
1,Ua.column+1),this.$),Fg.h(this.$).pg(Fb,null,null,null,3,"DdaMethodHandler.ShowCard"));li.a(this.$,243,242,0,nc=>{nc.Meb(Ua.row+1,Ua.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:Q=Q.then(()=>{Object(O.a)(Ed.DdaFacade,Gf.a(this.$)).kj.JPe(Ua.controlId,Ua.isEnableEvents);return Promise.resolve(null)});break;case 5:Q=Q.then(()=>this.eih(Ua));break;case 6:Q=Q.then(()=>this.v2i(Ua));break;case 8:Q=Q.then(()=>{y.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(O.a)(Ed.DdaFacade,Gf.a(this.$)).E4g();const Fb=new qj.a(rj.a.Uj,5,null);pj.a(this.$).Ks(Fb);return Promise.resolve(null)});break;case 9:Q=Q.then(()=>this.gxj(Ua));break;case 10:Q=Q.then(()=>this.w5j(Ua));break;case 11:Q=Q.then(()=>this.v5j());break;case 12:Q=Q.then(()=>this.s5j());break;case 13:Q=Q.then(()=>this.t5j(Ua));break;case 14:Q=Q.then(()=>this.u5j(Ua));break;case 16:Q=Q.then(()=>Promise.resolve(Ua));break;case 17:Q=Q.then(()=>this.ttj(Ua,Object(O.a)(Ed.DdaFacade,Gf.a(this.$))));break;
case 18:Fg.h(this.$).focus();break;case 19:this.S9e(Ua.entryType,!1,Ua.options);break;case 20:this.S9e(Ua.entryType,!0,Ua.options);break;default:Q=Q.then(()=>Promise.reject(If.y4a(og.vRg,ff.a.instance.ga(1755),null)))}return Q}dai(Q){var Ua=Object(O.a)(Ed.DdaFacade,Gf.a(this.$)).An(Q.controlId);if(Ua&&!(0===Q.operationType^!Ua.aea)){Fg.h(this.$).Rjc=!0;switch(Q.operationType){case 0:var Fb=new oj.a(document.createElement("input"));Fb.text=Q.range;Ua.xii(Fg.h(this.$).Gf.Agh(Fb,new lj.a(this.$)));Ua.aea.startEdit(!0);
break;case 1:Ua.LUf();this.rangePicker=null;break;case 2:Ua.aea.Fjg(Q.range);break;case 3:Ua.aea.Fjg(Q.startingRange);Ua=Q.expandSelection;Fb=Q.getNextDataRegionCell;let nc=0;switch(Q.keyboardDirectionValue){case 2:nc=38;Q=Ua&&Fb?105288353:Ua?-31900117:Fb?542791952:137938150;break;case 3:nc=40;Q=Ua&&Fb?-1297307319:Ua?-1603798598:Fb?1713663844:-798660877;break;case 0:nc=37;Q=Ua&&Fb?-403586027:Ua?2039316657:Fb?-2012742350:-1470715894;break;case 1:nc=39;Q=Ua&&Fb?784916030:Ua?589730764:Fb?1324884057:
-1231471547;break;default:Q=1461300262}Ua=this.s6b("keydown",nc,Ua,Fb);Fg.h(this.$).iLb(Ua,new Eg.a(Q,1,0,8,null))}Fg.h(this.$).Rjc=!1}}s6b(Q,Ua,Fb,nc){const Dc=document.createEvent("KeyboardEvent");if(Sc.a.VF)Dc.initKeyboardEvent(Q,!1,!1,window.self,"A",0,nc,!1,Fb,!1);else{let cd="";Fb&&(cd+="Shift");nc&&(cd+=0<cd.length?" Control":"Control");Dc.initKeyboardEvent(Q,!1,!1,window.self,"A",0,cd,!1,"en-US")}Q=new Sys.UI.DomEvent(Dc);Q.keyCode=Ua;return Q}w9h(Q){switch(Q.operationType){case 1:dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(this.$.da,
153,this.$.la,1),Ua=>{Ua.result.VNd()},this.$.la,3);break;case 2:if(Q=Object(O.a)(Ed.DdaFacade,Gf.a(this.$)).An(Q.controlId))Q.ijc=!0,Q.TOf()}}eih(Q){const Ua=Q.fileBase64;return Ua&&Ua.length>this.$.va.CreateWorkbookMaxAllowedBase64Size?Promise.reject(If.y4a(og.invalidArgument,ff.a.instance.ga(1758),"Application.CreateWorkbook")):(new Promise((Fb,nc)=>{const Dc=new $d.StandardDialog;Dc.Rb=4;Dc.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,cd=>{2!==
cd&&0!==cd||nc(If.y4a(og.rFd,ff.a.instance.ga(1757),"Application.CreateWorkbook"));cd=new se("blank","agave",Ua?"streamBase64":"streamEmpty",Ua);this.Ywf.create(Fb,nc,cd).T1a()})})).then(Fb=>{this.cac.set(Q.fakeFileId,Fb);return Promise.resolve(null)},Fb=>Fb?Promise.reject(Fb):Promise.reject(If.y4a(og.generalException,ff.a.instance.ga(1754),"Application.CreateWorkbook")))}v2i(Q){return new Promise((Ua,Fb)=>{if(this.cac.has(Q.fakeFileId)){const nc=this.cac.get(Q.fakeFileId);Fb=new $d.StandardDialog;
Fb.Rb=4;Fb.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Dc=>{1===Dc&&di.HelperMethods.lf(nc,void 0,void 0,"DdaMethodHandler.fileUrl");Ua(null)})}else Fb(If.y4a(og.generalException,ff.a.instance.ga(1754),"Document.Open"))})}gxj(Q){return new Promise(Ua=>{Object(O.a)(Ed.DdaFacade,Gf.a(this.$)).DZf=Q.runtimeCalculationMode;const Fb=this.$.da.za(268);Fb&&Fb.rBd(3===Q.runtimeCalculationMode);Ua(null)})}w5j(Q){$g.a.iCb(this.$)&&this.$.da.za(331).Kdb(0,
Q.urlStr,!0,!0,null);return Promise.resolve(null)}v5j(){$g.a.iCb(this.$)&&this.$.da.za(331).Kdb(1,null,!0,!0,null);return Promise.resolve(null)}s5j(){$g.a.iCb(this.$)&&this.$.da.za(331).GPe();return Promise.resolve(null)}t5j(Q){$g.a.iCb(this.$)&&this.$.da.za(331).Kdb(5,Q.urlStr,!0,!0,null);return Promise.resolve(null)}u5j(Q){if($g.a.iCb(this.$)){const Ua=this.$.da.za(331);for(const Fb of Ua.Naa)Fb.IsActive&&Fb.HostEditUrl&&Fb.UrlStr===Q.hostEditUrlStr&&di.HelperMethods.lf(Fb.HostEditUrl,"_blank")}return Promise.resolve(null)}ttj(Q,
Ua){const Fb=hg.a.aX;Q=z.a.li(Q.payload);const nc={};"eventId"in Q&&"payload"in Q&&(nc.eventId=Q.eventId,nc.payload=Q.payload);Ua.fN(2201,Fb,z.a.hc(nc));return Promise.resolve(null)}S9e(Q,Ua,Fb){const nc=this.$.da.za(5);nc&&(Q=this.FQh(Q))&&(Ua?nc.removeEntry(Q):nc.TWc(Q,Fb))}FQh(Q){switch(Q){case 0:return 64;case 1:if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}ZVc(Q){Q=Object(O.a)(nj.a,this.$.xa.getItemByName(Q));(null===Q||void 0===Q?0:Q.visible)&&Q.activate(!0)}pjg(Q,
Ua,Fb,nc){var Dc=Q.ra.Cs;const cd=Dc<Ua.length&&Ua[Dc].contains(Q.ra.activeCell);Q=cd?Q.ra.activeCell:Ua[0].topLeft;Dc=cd?Dc:0;Fg.h(this.$).U4(Ua,Dc,Fb,null,Q,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===nc)}static get Fjh(){If.rqa||(If.rqa={},If.rqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,If.rqa[Microsoft.Office.WebExtension.CoercionType.Text]=2,If.rqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,If.rqa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,If.rqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return If.rqa}static get Ijh(){If.Iib||(If.Iib={},If.Iib[Microsoft.Office.WebExtension.FilterType.All]=1,If.Iib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return If.Iib}static get Jjh(){If.Jib||(If.Jib={},If.Jib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,If.Jib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return If.Jib}static w3e(Q){if(!Q||!Q.length)return null;const Ua=Array(Q.length/2);for(let Fb=
0;Fb<Q.length/2;Fb++)Ua[Fb]={},Ua[Fb].Name=Q[2*Fb],Ua[Fb].Value=Q[2*Fb+1];return Ua}static K4h(Q){if(!Q||!Q.length)return null;const Ua=Array(2*Q.length);for(let Fb=0;Fb<Q.length;Fb++)Ua[2*Fb]=Q[Fb].Name,Ua[2*Fb+1]=Q[Fb].Value;return Ua}static jdd(Q){if(!Q||!Q.length)return null;const Ua=Array(Q.length);for(let Fb=0,nc=Q.length;Fb<nc;Fb++){const Dc=Q[Fb].length;if(Dc){Ua[Fb]=Array(Dc);for(let cd=0;cd<Dc;cd++)Ua[Fb][cd]=null==Q[Fb][cd]?null:Q[Fb][cd].toString()}else return null}return Ua}static L4b(Q){return"string"===
typeof Q?Yi.a.xq(If.Fjh,Q,0):Q}static yXe(Q){return"string"===typeof Q?Yi.a.xq(If.Ijh,Q,0):Q}static Ukg(Q){return"string"===typeof Q?Yi.a.xq(If.Jjh,Q,0):Q}static coi(Q){switch(Q.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static d0c(Q,Ua){const Fb={};Fb.CoerceType=Q;1===Fb.CoerceType?(Fb.Data=If.jdd(Ua.Rows),Fb.Headers=If.jdd(Ua.Headers)):Fb.Data=If.jdd(Ua);return Fb}static Oye(Q){return 1===Q.CoerceType?{["Headers"]:Q.Headers,["Rows"]:Q.Data}:
Q.Data}static uhc(Q){return 1===Q.CoerceType?!Q.Data&&!Q.Headers:!Q.Data}static J6e(Q){let Ua="Unknown";if(!Q)return Ua;for(let Fb=0;Fb<Q.length;Fb++)if(Q[Fb].Name.toLowerCase()===wf.a.Mqj){Ua=Q[Fb].Value;break}return Ua}static fFj(Q){if(!Q)return!1;const Ua=wf.a.TMi.toLowerCase();for(let Fb=0;Fb<Q.length;Fb++)if(Q[Fb].Name.toLowerCase()===Ua)return!0;return!1}static y4a(Q,Ua,Fb){const nc={};nc.Code=Q;nc.Message=Ua;nc.Location=Fb;nc.ActionIndex=0;return nc}}If.rqa=null;If.Iib=null;If.Jib=null;If.pGd=
0;Object(d.a)(If,"DdaMethodHandler",null,[165,2]);class Zi extends Hd.a{constructor(Q){super(Q)}nd(){const Q=Cg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Ya),Ua=Cg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Ya),Fb=Ei(this.la,this.Ya),nc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?Cg.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):xh.Task.Ta(null);
dg.TaskExtensions.Aa(dg.TaskExtensions.Fd([Q,Ua,Fb,nc],this.la),()=>{const cd=Q.result,kd=Jc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Yc([new If(this.$,cd,kd,nc.result)])},this.la,3);const Dc=Jc.a.instance;dg.TaskExtensions.Aa(Cg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.Ya),()=>{Dc.register(qb,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").xc().Fc(()=>new qb)},this.$.la)}static ka(Q){Hd.a.Nd(82,new Zi(Q))}}
Object(d.a)(Zi,"DdaCommandHandlerFactory",Hd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Mi("");c.a.Mi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();
Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(Q=>{Wb.ka(Q)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Cc.a)();Object(Uc.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(Q=>{y.EwaSettings.ma(53)&&Mh.ka(Q)})})();(()=>{f.a.Fa(Q=>{y.EwaSettings.ma(121)&&Bh.ka(Q)})})();f.a.Fa(Xc.ka);f.a.Fa(ki.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");
(()=>{f.a.Fa(Q=>{Yh.ka(Q);je.ka(Q);ig.ka(Q)})})();f.a.Fa(Zi.ka)},1464:function(u,D,a){u=a(0);var c=a(187),b=a(96);class e{constructor(){this.GOe=this.displayName=this.hsb=this.So=this.QB=null;this.isUpgraded=!1}Flf(d,h){return this.QB.getStoreType().toLowerCase()===d.toLowerCase()&&this.QB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(u.a)(e,"AddinCommandsResourceItem",null,[]);a.d(D,"a",function(){return f});class f{constructor(){this.NGc=null;this.CLc=0;this.hNc=!1;this.fb=new b.a;this.yyg=
new c.a}FLg(d){this.fb.addHandler("AddinCommandsLoadingMessageChanged",d)}Iij(d){this.fb.removeHandler("AddinCommandsLoadingMessageChanged",d)}get WZa(){return this.NGc}jeb(d){d!==this.NGc&&(this.NGc=d,this.fb.raiseEvent("AddinCommandsLoadingMessageChanged"))}bxj(){this.CLc++;this.WZa||this.jeb(CommonUIStrings.l_LoadingAddInsTitle)}LRd(){this.CLc--;this.twd()&&(this.hNc?this.WZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.jeb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.jeb(null))}H3f(d=
!1){this.hNc=!0;this.jeb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}QCe(){this.hNc=!1;this.twd()?this.jeb(null):this.jeb(CommonUIStrings.l_LoadingAddInsTitle)}twd(){return 0>=this.CLc}get P6a(){return this.yyg}sja(d,h,m=0){for(let l of this.P6a)if(l.Flf(d,h)&&(!l.So||l.So.hOh===m))return l;return null}Xpe(d,h,m,l){const v=new e;v.QB=d;v.So=h;v.hsb=m;v.displayName=l;this.P6a.add(v)}HJg(d,h,m,l){const v=new e;v.QB=d;v.So=h;v.hsb=null;v.GOe=
m;v.displayName=l;this.P6a.add(v)}ghj(d,h){let m=0;for(let l of this.P6a)l.QB.getStoreType()===d&&l.QB.getSolutionId()===h?this.P6a.removeAt(m):m++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(u.a)(f,"AddinCommandsResourceManager",null,[])},730:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);var c=a(35);class b{static get iIi(){return b.nfe||(b.nfe={["-2002156328"]:b.FEe,["-1954750170"]:b.g7e,["317650254"]:b.w6g,["-1005263101"]:b.zki,["1353664579"]:b.Guj,["159671765"]:b.Aki,
["1446690022"]:b.$1e,["1150069548"]:b.rDc,["-1409306331"]:b.oBe,["338507772"]:b.KKe,["-457159301"]:b.i3i,["-1037701970"]:b.ejh,["-1893322318"]:b.Fki,["965579896"]:b.gjh,["93287890"]:b.fjh,["358088857"]:b.Rxj,["-1223650923"]:b.KKe,["2007306190"]:b.r2g,["1549955423"]:b.Wxe,["-1275974171"]:b.Eki,["382101082"]:b.y2i,["-898776235"]:b.QJi,["335464256"]:b.HJi,["1677378049"]:b.Dki,["-261992848"]:b.sXj,["-980820954"]:b.Wxe,["-931375837"]:b.x2i,["929186550"]:b.Oqh,["-982144310"]:b.j$i,["-785741187"]:b.xki,
["2125217573"]:b.Hki,["299124955"]:b.yki,["1669853884"]:b.arj,["-1515932330"]:b.x6g,["314621024"]:b.BKh,["-300049690"]:b.v2g,["14766835"]:b.TCj,["-1251992761"]:b.KNe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.xGa,["49173765"]:b.xGa,["-907155566"]:b.xGa,["-1201603824"]:b.xGa,
["1541165282"]:b.xGa,["-1347753427"]:b.xGa,["134912532"]:b.xGa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static LZe(e){return c.a.xq(b.iIi,e.toString(),b.internalError)}}b.success=0;b.FEe=1E3;b.g7e=1001;b.w6g=1002;b.zki=1003;b.Guj=1004;b.Aki=1005;b.$1e=1008;b.mXe=1009;b.invalidSheetName=1014;b.rDc=2E3;b.oBe=2001;b.KKe=2002;b.i3i=2003;b.ejh=2004;b.Fki=2005;b.gjh=2007;b.fjh=2008;b.Rxj=2009;b.r2g=2014;b.uuj=3E3;b.Wxe=3002;b.Eki=3004;b.y2i=3005;b.QJi=3006;b.HJi=3007;b.Dki=3008;b.sXj=3009;b.x2i=
3010;b.TCj=4002;b.vFd=5E3;b.internalError=5001;b.KNe=5002;b.SMa=5004;b.uYj=5007;b.rfi=5008;b.invalidOrTimedOutSession=5012;b.GFc=5016;b.xGa=5102;b.Rnj=5103;b.responsePayloadSizeLimitExceeded=5104;b.O1g=7001;b.I$f=7002;b.Oqh=8E3;b.j$i=8001;b.xki=8010;b.Hki=8011;b.yki=8012;b.arj=8020;b.x6g=8021;b.BKh=8022;b.v2g=8023;b.PHi=11E3;b.FKi=11001;b.Gki=11002;b.nfe=null;Object(u.a)(b,"DdaErrorIds",null,[])},731:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.BVc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.rFd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.xYj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.EPg="AddinIsAlreadyRequestingToken";c.upj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.p$g=
"ControlIdNotFound";c.jqj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(c,"ErrorCodes",null,[])},734:function(u,D,a){a.r(D);var c=a(0),b=a(7),e=a(15),f=a(1305),d=a(84),h=a(96);class m{constructor(Da,Pa,tb){this._id=Da;this.xsg=Pa;this.Fug=tb;this.cgf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get DPg(){return this.xsg}get Z6g(){return this.Fug}execute(Da,
Pa,tb){tb=tb||{};tb.commandMode=this.cgf;Pa.invokeAppCommand(this.DPg,this.Z6g,tb,()=>{Da.GWi(this.id)})}}Object(c.a)(m,"AddinNativeActionBase",null,[467]);class l extends m{constructor(Da,Pa){super(1,Da,Pa);this.cgf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(l,"AddinTakeSnapshotAction",m,[]);class v{Tah(Da){return new m(3,Da,this.QOh().getNativeActionName(3))}QOh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(v,"AddinNativeActionManager",null,[449]);var t=
a(146);class z{invokeAppCommand(Da,Pa,tb,Ib){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Da,Pa,tb,Ib)}static getInstance(){z.Ma||(z.Ma=new z);return z.Ma}}z.Ma=null;Object(c.a)(z,"OSFAddinCommandsRuntimeManager",null,[410]);var r=a(4),n=a(180),w=a(27);class B extends t.a{constructor(Da,Pa,tb){super();this.U9=null;this.CUc="WACDialogTitleText";this.Bfa="0";this.RDa="15px";this.Vug="0px";this.Afa="calc(100% - 30px)";this.Uug="100%";this.Qie=0;this.fb=new h.a;this.zsg=new v;this.Rb=5;this.Ee=
this.ZDa=tb;this.RJc=Da;this.Y8d=Pa;this.hKc=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}QNg(Da){this.fb.addHandler("OnDialogClosedEventKey",Da)}Pzj(){this.gFa=null}Zz(){super.Zz();this.Vk.style.width="100%";this.Vk.style.height=this.mfc?this.Afa:this.Uug;this.Vk.style.marginTop=this.mfc?this.RDa:this.Vug;this.Vk.style.padding=this.Bfa}YI(){super.YI();this.wb.style.width=String.format("{0}px",this.RJc*window.innerWidth/100);this.wb.style.height=
String.format("{0}px",this.Y8d*window.innerHeight/100);this.wb.style.minWidth="0px";this.hKc&&r.AFrameworkApplication.isRtl&&100===this.RJc&&(this.wb.style.right="0px",this.wb.style.marginRight="0px");this.U9=document.getElementById(this.mi(this.CUc));this.U9.style.position="absolute";this.U9.style.whiteSpace="nowrap";this.U9.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.U9.style.right="14px",this.U9.style.left="44px"):(this.U9.style.right="44px",this.U9.style.left="14px")}Qv(Da){super.Qv(Da);
this.U9&&this.U9.setAttribute("title",Da)}get Pia(){return this.Vk}aOd(){this.wb.style.width=String.format("{0}px",this.RJc*window.innerWidth/100);this.wb.style.height=String.format("{0}px",this.Y8d*window.innerHeight/100);this.wb.style.overflowY="hidden";this.wb.style.overflowX="hidden";this.wb.style.marginTop="";this.wb.style.top="";w.a.w5&&r.AFrameworkApplication.isRtl?(this.wb.style.right="",this.wb.style.marginRight=""):(this.wb.style.left="",this.wb.style.marginLeft="")}hide(){this.zsg.Tah(this.ZDa).execute(this,
z.getInstance(),{});this.Qie=window.setTimeout(()=>{this.fb.raiseEvent("OnDialogClosedEventKey",this.ZDa);n.a.prototype.hide.call(this)},500)}GWi(Da){3===Da&&(window.clearTimeout(this.Qie),this.fb.raiseEvent("OnDialogClosedEventKey",this.ZDa),super.hide())}}Object(c.a)(B,"AppsForOfficeDialog",t.a,[382,383]);class A{constructor(){this.dialog=this.Ee=null}}Object(c.a)(A,"DialogInfo",null,[]);class y{}y.url="url";y.height="height";y.width="width";y.T8c="displayInIframe";y.Mfc="hideTitle";Object(c.a)(y,
"DialogSettings",null,[]);class x{constructor(){this.height=this.width=0;this.Ee=this.controlId=this.pageUrl=null;this.Mfc=this.T8c=!1}}Object(c.a)(x,"DisplayDialogParams",null,[]);class F extends Sys.EventArgs{constructor(Da,Pa,tb=null,Ib="",Yb=""){super();this.controlId=Da;this.messageType=Pa;this.messageContent=tb;this.messageOrigin=Ib;this.targetOrigin=Yb}}Object(c.a)(F,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(Da,Pa,tb=null,Ib="",Yb=""){super();this.controlId=
Da;this.messageType=Pa;this.messageContent=tb;this.messageOrigin=Ib;this.targetOrigin=Yb}}Object(c.a)(I,"OnMessageParentEventArgs",Sys.EventArgs,[]);var L=a(41),X=a(30),P=a(170),G=a(98);class C{constructor(Da){this.fb=new h.a;this.Km=Da}YNg(Da){this.fb.addHandler("OnMessageParentEventKey",Da)}XNg(Da){this.fb.addHandler("OnMessageDialogEventKey",Da)}showDialog(Da,Pa,tb,Ib){if(C.K8.lb(Pa))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const ec=L.b(Da),Vc=ec[y.url];if(this.Km.getOsfControl(Pa).checkAppDomains(Vc)){var Yb=new x;Yb.width=ec[y.width];Yb.height=ec[y.height];Yb.pageUrl=Vc;Yb.T8c=ec[y.T8c];Yb.Mfc=ec[y.Mfc];Yb.controlId=Pa;Yb.Ee=P.a.create().toString();var vc=new A;vc.Ee=Yb.Ee;var Zc=this.Km.getOsfControl(Yb.controlId).getManifest().getDefaultDisplayName(),nd=this.Km.getOsfControl(Yb.controlId).getStoreType().toLowerCase();Da=null;var hd=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);Da=(4===r.AFrameworkApplication.sa.Pa.Fj&&"hardcodedpreinstall"===nd||hd&&"sdxcatalog"===nd)&&Yb.Mfc?this.createAndShowAppsForOfficeDialog(Yb.width,Yb.height,Yb.Ee,!0,Zc):this.createAndShowAppsForOfficeDialog(Yb.width,Yb.height,Yb.Ee,!1,Zc);var Ud=this.Km.getOsfControl(Yb.controlId),ee=Ud.getManifest();hd={};hd.id=Yb.Ee;hd.solutionId=Ud.getSolutionId();hd.version=Ud.getVersion();hd.storeType=nd;hd.storeId=Ud.getStoreId();hd.assetId=Ud.getAssetId();hd.assetStoreId=Ud.getAssetStoreId();hd.ownerAddinSolutionId=
Ud.getOwnerAddinSolutionId();hd.ownerAddinStoreType=Ud.getOwnerAddinStoreType();hd.appDomains=ee.getAppDomains();hd.dialogUrl=Vc;hd.osfControlType=1;hd.agaveName=Zc;hd.div=Da.Pia;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(hd.solutionId,hd.ownerAddinStoreType||hd.storeType,hd.assetId,null,null,hd.storeId),X.a.qw(Yb.pageUrl));this.Km.insertDialogControl(hd);Da.QNg(Object(d.a)(this,this.KQi,"onDialogClosed"));vc.dialog=
Da;C.K8.ia(Yb.controlId,vc);Ib&&Ib(hd);tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ec){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ec.message),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}lIi(Da,Pa,tb,Ib){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Ib&&(Ib=tb);try{const Yb=this.eLa(Da);Yb&&this.fb.raiseEvent("OnMessageParentEventKey",new I(Yb,OSF.DialogMessageType.DialogMessageReceived,Pa,tb,Ib))}catch(Yb){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Yb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}kIa(Da,Pa){if(C.K8.lb(Da))try{const tb=C.K8.oa(Da);tb.dialog&&tb.dialog.hide();this.Km.purgeDialogControl(tb.Ee);
C.K8.remove(Da);Pa(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(tb){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",tb.message),Pa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Pa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}mvj(Da,Pa,tb,Ib){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Ib&&(Ib=tb);if(C.K8.lb(Da)&&(Da=C.K8.oa(Da),Da.dialog))try{this.fb.raiseEvent("OnMessageDialogEventKey",new F(Da.Ee,OSF.DialogMessageType.DialogParentMessageReceived,Pa,tb,Ib))}catch(Yb){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Yb.message)}}eLa(Da){let Pa=null;for(let tb of C.K8)if(tb.value.Ee===Da){Pa=tb.key;break}return Pa}KQi(Da,Pa){if(Da=this.eLa(Pa))this.Km.purgeDialogControl(Pa),C.K8.remove(Da),this.fb.raiseEvent("OnMessageParentEventKey",
new I(Da,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Da,Pa,tb,Ib,Yb){Da=new B(Da,Pa,tb);Yb=Ib?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Yb);Ib&&(Da.mfc=!1,Da.Jt=!1);Da.initializeAndShow(Yb,null,null);Da.Pzj();return Da}static G7h(){return C.K8}static getInstance(Da){C.Ma||(C.Ma=new C(Da));return C.Ma}}C.Ma=null;C.K8=new G.a;Object(c.a)(C,"AppsForOfficeDialogManager",null,[340]);var H=a(844),J=a(1317),M=a(1395),S=a(933),W=a(718),O=a(172),
T=a(1318),Y=a(119),va=a(83),ca=a(87),V=a(639),ra=a(553),N=a(682),ea=a(82),Ba=a(416),ka=a(157),Ka=a(187),Oa=a(38),wa=a(5),qa=a(861),aa=a(1234),ia=a(78);class Ha{constructor(){this.command=0;this.properties=null}}Object(c.a)(Ha,"DdaRequestInfo",null,[]);var Z=a(730),la=a(76);class Xa extends ia.a{constructor(Da,Pa){super();this.requests=[];this.disposed=this.F3b=!1;this.Nf=()=>{if(!this.disposed){this.grid.Vb.Il(this.Nf);this.F3b=!1;const tb=this.requests;this.requests=[];for(let Ib of tb)this.ddaFacade.CK(Ib.command,
Ib.properties)}};this.ddaFacade=Da;this.grid=Pa}Tkh(Da,Pa){this.disposed||(this.F3b||(this.grid.Vb.sm(this.Nf),this.F3b=!0),this.requests.push(Object(b.a)(new Ha,{command:Da,properties:Pa})))}dispose(){if(!this.disposed){this.disposed=!0;this.F3b&&this.grid.Vb.Il(this.Nf);var Da=this.requests;this.requests=null;for(let Pa of Da)(Da=Pa.properties?Pa.properties[la.a.a4]:null)&&this.ddaFacade.qf(Z.a.SMa,Da);this.ddaFacade=this.grid=null;super.dispose()}}static b7g(Da,Pa){var tb=!1;974713501===Da&&(Pa=
(Da=Pa?Pa[la.a.lg]:null)?Da.DdaMethod:null)&&Pa.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(tb=Da.ArrayData,tb=!!tb&&64===(tb[6]&64));return tb}}Object(c.a)(Xa,"DdaCellEditDelayRequestHandler",ia.a,[]);var Za=a(765);class xa extends Za.a{constructor(Da,Pa,tb,Ib,Yb,vc,Zc){super(Da,Pa,tb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ib;this.messageContent=Yb;this.messageOrigin=vc;this.targetOrigin=Zc}}Object(c.a)(xa,"DialogMessageReceivedEventArgs",
Za.a,[]);class fa extends Za.a{constructor(Da,Pa,tb,Ib,Yb,vc,Zc){super(Da,Pa,tb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ib;this.messageContent=Yb;this.messageOrigin=vc;this.targetOrigin=Zc}}Object(c.a)(fa,"DialogParentMessageReceivedEventArgs",Za.a,[]);var ua=a(1),sa=a(21);class sb{constructor(Da){this.Wh=this.aZc=null;this.vWi=(Pa,tb)=>{this.handlers.lb(tb.controlId)&&(Pa=new xa(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,tb.controlId,
null,tb.messageType,tb.messageContent,tb.messageOrigin,tb.targetOrigin),this.handlers.oa(tb.controlId)(Pa),tb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(tb.controlId))};this.uWi=(Pa,tb)=>{this.inc.lb(tb.controlId)&&(Pa=new fa(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,tb.controlId,null,tb.messageType,tb.messageContent,tb.messageOrigin,tb.targetOrigin),this.inc.oa(tb.controlId)(Pa))};this.handlers=new G.a;this.inc=new G.a;this.Jg=Da;this.C2a.YNg(this.vWi);
this.C2a.XNg(this.uWi)}get C2a(){this.aZc||(this.aZc=C.getInstance(this.contextActivationMgr));return this.aZc}get contextActivationMgr(){!this.Wh&&this.Jg&&(this.Wh=this.Jg.Wh);return this.Wh}addHandler(Da,Pa,tb,Ib){if(ua.EwaSettings.ma(23))this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,tb);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Yb=vc=>{vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Da,
Pa),this.Jg.zv(tb)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Jg.qf(vc,tb))};this.handlers.lb(Da)?Yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Da,Ib,Yb)}}zJg(Da,Pa,tb){ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,tb):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.inc.ia(Da,Pa),this.Jg.zv(tb))}removeHandler(Da,
Pa){ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Pa):this.handlers.lb(Da)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.C2a.kIa(Da,tb=>{this.handlers.remove(Da);tb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Jg.zv(Pa):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Jg.qf(tb,Pa))})):this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Pa)}bij(Da,Pa){ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Pa):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.inc.remove(Da),this.Jg.zv(Pa))}showDialog(Da,Pa,tb){try{ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&sa.h(this.Jg.$).eb&&sa.h(this.Jg.$).Uo(!0),this.C2a.showDialog(Pa,Da,tb,Ib=>{this.Jg.QJg(this.UZg(Ib))})}catch(Ib){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Ib.message}`),tb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}UZg(Da){const Pa={};Pa.InstanceId=Da.id;Pa.WebExtensionType=Da.osfControlType===OSF.OsfControlTarget.InContent?0:1;Pa.PrimaryMarketplace={};Pa.PrimaryMarketplace.SolutionId=Da.solutionId;Pa.PrimaryMarketplace.SolutionVersion=Da.version;Pa.PrimaryMarketplace.MarketplaceRef=Da.storeId;Pa.PrimaryMarketplace.MarketplaceType=Da.storeType;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)&&(Pa.OwnerAddinSolutionId=Da.ownerAddinSolutionId,Pa.OwnerAddinStoreType=Da.ownerAddinStoreType);return Pa}static ka(Da){if(!Da.$.da.za(232)){const Pa=new sb(Da);Da.$.da.Ga(232,Pa)}}}Object(c.a)(sb,"DialogMessageReceivedEventManager",null,[797]);class hb{constructor(Da,Pa){this.iB=null;this.Qfa=Da;this.YEg=Pa}n0b(Da){Da&&(this.iB||(this.iB=[]),this.iB.push(Da))}$uc(Da){this.iB&&Array.remove(this.iB,Da)}get eventId(){return this.Qfa}get targetId(){return this.YEg}get Ibi(){return 0<this.iB.length}IGi(Da){return this.eventId!==
Da.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Da.ddaBinding.Name:!0}j3b(Da){this.iB&&Array.forEach(this.iB,Pa=>{Pa(Da)})}xna(){this.iB=[]}}Object(c.a)(hb,"DdaEventRegistration",null,[]);class bb{constructor(Da){this.oF=null;this.$wa=!1;this.Pc=()=>{this.oF.forEach(Pa=>{Pa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Pa.j3b(new Za.a(Pa.eventId,"",null))})};this.Jg=
Da}invokeDdaMethod(Da,Pa){const tb={};tb[la.a.lg]=Da;tb[la.a.a4]=Pa;this.Jg.CK(974713501,tb)}registerDdaEventAsync(Da,Pa,tb,Ib,Yb){bb.CAb(Da)?(bb.aqd(Da)&&this.tmd(),this.oF||(this.oF=[]),Pa=this.mvb(Da,tb),Pa||(Pa=new hb(Da,tb),this.oF.push(Pa)),Pa.n0b(Ib),this.Jg.zv(Yb)):this.Jg.qf(-1,Yb)}unregisterDdaEventAsync(Da,Pa,tb,Ib,Yb){bb.CAb(Da)?((Da=this.mvb(Da,tb))&&Da.$uc(Ib),this.Jg.zv(Yb)):this.Jg.qf(-1,Yb)}tmd(){this.$wa||(sa.h(this.Jg.$).ha.QE(this.Pc),this.$wa=!0)}mvb(Da,Pa){if(!this.oF)return null;
for(let tb=0;tb<this.oF.length;tb++){const Ib=this.oF[tb];if(Ib.eventId===Da&&Ib.targetId===Pa)return Ib}return null}static CAb(Da){return Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static aqd(Da){return Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(bb,"EmbeddingPage",null,[773]);var lb=a(178);class Fa extends Za.a{constructor(Da,Pa,tb,Ib,Yb,vc,Zc,nd){super(Da,Pa,tb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=vc-Ib.Reference.FirstColumn;
this.columnCount=nd;Da=Math.max(Yb,Ib.Reference.FirstRow);Yb=Math.min(Yb+Zc-1,Ib.Reference.LastRow);Da>Yb?this.startRow=this.rowCount=void 0:(this.startRow=Da-Ib.Reference.FirstRow,this.rowCount=Yb-Da+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Fa,"DdaBindingSelectionEventArgs",Za.a,[]);var Na=a(199),Mb=a(24),dc=a(42),Cb=a(50),Tb=a(417),Jb=a(33),eb=a(37),za=a(564),ha=a(109),
fb=a(53),rb=a(91),pa=a(12),Ma=a(11),Ja=a(103);class Ga{}Ga.fAh="ewa-wx-disabled-div";Ga.eAh="ewa-wx-container-div";Ga.ESe="ewa-ptp-nov2-flex";Object(c.a)(Ga,"CssClassNames",null,[]);const La=Ga.fAh,nb=Ga.eAh;class Lb extends lb.a{constructor(Da,Pa,tb,Ib=!1){super();this.Ndb=0;this.oF=null;this.$wa=!1;this.Qsc=null;this.GU=0;this.q7b=this.zWa=this.uJc=this.c6d=null;this.Ice=!1;this.AQc=this.aea=this.e3d=null;this.Pc=()=>{this.enabled&&(this.xvj(),this.Qsc=dc.d(sa.h(this.$).ha.ra.selectedRanges))};
this.a$e=Yb=>{Yb.controlId===this.Hd.InstanceId&&Array.forEach(this.oF,vc=>{vc.IGi(Yb)&&vc.j3b(Yb)})};this.czf=Yb=>{if((Yb=Object(ea.a)(261,Yb))&&!Yb.Es())if(!this.Hd||OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)||this.$.c3){Yb.nf=this.Hd;Yb.wj=this.Jg;this.e3d=Yb;this.Byc(Yb.dHa);const vc=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Jb.a.gd(this.$)&&Ma.HelperMethods.Iw(this.Hd)&&this.Hd.Preload&&!this.Hd.TaskpaneVisible;
vc?Yb.HDd():ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Yb.HDd(),(this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Yb.vg(!1)):((this.Hd.SharedRuntime&&1===this.Hd.SharedRuntime.LifeTime||this.Hd.SharedRuntimeId)&&!this.Hd.TaskpaneVisible&&Yb.vg(!1),Yb.HDd());this.Z6a||(Jb.a.gd(this.$)?vc||Yb.e7():Tb.a(this.$).result.qG(Yb,!0));this.$.da.za(77).bVf(this.czf);this.A$=Object(ea.a)(326,
Yb)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Yb,vc)=>{3===vc.control.floatingObject.type&&vc.control.floatingObject.wl.InstanceId===this.D1.WebExtensionId&&(this.A$=Object(ea.a)(326,vc.control),this.Byc(vc.control.Jd.firstChild),Ja.a(this.$).Suc(this.onFloatingObjectControlAdded))};this.jb=Da.$;this.Jg=Da;this.Hd=tb;this.Hd.InstanceId=tb.SrcLocationOverrideResourceId?Da.w4a(tb.InstanceId,tb.SrcLocationOverrideResourceId):
tb.InstanceId;this.hi=Pa;this.D1={};this.D1.WebExtensionId=tb.InstanceId;this.EKf="osfControl_"+tb.InstanceId;this.J8c="disabled_"+tb.InstanceId;this.D1.BindingData=tb.BindingData;this.Z6a=this.Jg.Z6a(tb.InstanceId);this.lhc=this.Jg.lhc(tb.InstanceId);this.bhe=tb.WebExtensionOsfControlType;this.VNf=Ib}get controlId(){return this.Hd.InstanceId}xii(Da){this.aea||(this.aea=Da)}LUf(){this.aea&&(this.aea.dispose(),this.aea=null)}get controlType(){return this.Hd.WebExtensionType}get ownerAddinSolutionId(){return this.Hd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.GU}get Hy(){return this.AQc}get sU(){return this.Hd.SrcLocationOverrideResourceId?
this.Jg.w4a(this.Hd.PrimaryMarketplace.SolutionId,this.Hd.SrcLocationOverrideResourceId):this.Hd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Hd.SrcLocationOverrideResourceId}get wl(){return this.Hd}get A$(){return this.c6d}set A$(Da){this.c6d=Da}get osfControlType(){return this.bhe}get iua(){return this.uJc}set iua(Da){this.uJc=Da}get p7b(){return this.zWa}set p7b(Da){this.zWa=Da}get focusOnIframeWhenLoaded(){return this.Hd.FocusOnIframeWhenLoaded}get ijc(){return this.Ice}set ijc(Da){this.Ice=
Da}Qnd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Hd.PrimaryMarketplace.MarketplaceType)&&ua.EwaSettings.ma(184)){const Pa=Cb.GetServiceTaskFactory.Oa(this.$.da,5,4,0);eb.TaskExtensions.Aa(Pa,()=>{Pa.result.kg(36,null)},this.la,3);return this}if(1===this.Hd.WebExtensionType)eb.TaskExtensions.Aa(Tb.a(this.$),Pa=>{Pa.result.Bsb(this.$.da,77,5,this.czf,1)},this.la,3);else{var Da=this.FXe();const Pa=Ja.a(this.$);Da||(Da={Type:3},Da.Id=this.D1.WebExtensionId,Da.WebExtensionData=this.Hd,Da.ContentHtml=
"<div/>",Da.Version=0,Da.AbsoluteLeft=0,Da.AbsoluteTop=0,Da.AbsoluteRight=0,Da.AbsoluteBottom=0,Da.Width=0,Da.Height=0,Da.ZOrder=0,Da.OriginDeltaX=0,Da.OriginDeltaY=0,Da=new Na.a(Da),Pa.a6b(Da,null),Da=Pa.Tq(Da.Kg()));Da?(this.Byc(Da.Jd.firstChild),this.A$=Object(ea.a)(326,Da)):Pa.d0b(this.onFloatingObjectControlAdded)}return this}nef(Da){this.Byc(Da);return this}bpc(){this.VNf||this.Jg.Wh.purgeOsfControl(this.controlId,!1);this.Egg(!0);const Da=this.FXe();Da&&Ja.a(this.$).deleteFloatingObject(Da);
this.Jg.kj.Lhj(this.controlId);this.Jg.kj.JPe(this.controlId,!0);this.AQc=null}TDd(Da){this.D1=Da}invokeDdaMethod(Da,Pa){if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var tb={};tb[la.a.lg]=Da;tb[la.a.a4]=Pa;this.Jg.CK(974713501,tb)}else this.Jg.qf(Z.a.SMa,Pa)}dfj(Da,Pa,tb,Ib){if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Lb.tph(Da)||void 0!==Pa&&null!==Pa&&void 0!==this.T3a(Pa)&&null!==this.T3a(Pa))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${Da}, targetId: ${Pa}`),Lb.Khf(Da)&&this.Ddi(),Lb.aqd(Da)&&this.tmd(),Lb.Ihf(Da))ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Jg.$.da.za(232).addHandler(this.controlId,tb,Ib,Pa);else if(Lb.Jhf(Da))ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Jg.$.da.za(232).zJg(this.controlId,tb,Ib);else{Lb.Hhf(Da)&&this.c$e(-1777565636,Ib);this.oF||(this.oF=[]);var Yb=this.mvb(Da,
Pa);Yb||(Yb=new hb(Da,Pa),this.oF.push(Yb));Yb.xna();Yb.n0b(tb);this.Jg.zv(Ib);Da===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.zWa&&(this.q7b=tb)}else this.Jg.qf(3002,Ib);else this.Jg.qf(-1,Ib)}CXj(Da,Pa,tb,Ib){Lb.Ihf(Da)?ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Jg.$.da.za(232).removeHandler(this.controlId,Ib):Lb.Jhf(Da)?ua.EwaSettings.ma(23)?this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Jg.$.da.za(232).bij(this.controlId,
Ib):(Lb.Hhf(Da)&&this.c$e(1592314317,Ib),Pa=this.mvb(Da,Pa),this.enabled?(Pa&&(Pa.$uc(tb),Pa.Ibi||Array.remove(this.oF,Pa),this.oF.length?Lb.Khf(Da)&&this.Fgg(!1):this.Egg(!1)),this.Jg.zv(Ib)):this.Jg.qf(-1,Ib))}ka(Da){pa.DOMElementExtensions.getElementById(Da,this.EKf)||Da.appendChild(pa.DOMElementExtensions.tf(this.Hy))}showHide(Da){pa.DOMElementExtensions.setVisible(this.Hy,Da)}resize(Da,Pa){pa.DOMElementExtensions.Xv(this.Hy,Da);pa.DOMElementExtensions.iJ(this.Hy,Pa)}GMe(Da){if(!this.GU&&!pa.DOMElementExtensions.getElementById(this.Hy,
this.J8c)&&this.Hy){const Pa=document.createElement("div");Pa.id=this.J8c;Pa.className=La;Pa.style.backgroundImage="url("+fb.a.current.io(103)+")";Pa.style.opacity=Da?"1":"0";Pa.style.backgroundRepeat="no-repeat";Pa.style.backgroundPosition="center";this.Hy.insertBefore(Pa,this.Hy.firstChild)}this.GU++}hsh(){0<this.GU&&this.GU--;this.GU||(pa.DOMElementExtensions.tf(pa.DOMElementExtensions.getElementById(this.Hy,this.J8c)),this.$wa&&!dc.Q(this.Qsc,sa.h(this.$).ha.ra.selectedRanges)&&this.Pc(null,null))}T3a(Da){if(!this.D1||
!this.D1.BindingData)return null;for(let Pa=0;Pa<this.D1.BindingData.length;Pa++)if(this.D1.BindingData[Pa].Name===Da)return this.D1.BindingData[Pa];return null}getDefaultIconUrl(){const Da=this.B5e();return Da?Da.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Hd.TaskpaneTitle)return this.Hd.TaskpaneTitle;const Da=this.B5e();return Da?Da.getDefaultDisplayName():null}TOf(){if(this.zWa&&this.q7b){const Da=new Za.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.zWa);
this.q7b(Da);this.q7b=this.zWa=null}}vg(Da){this.e3d&&this.e3d.vg(Da)}Dxj(){this.$.ea.isNamedObjectViewMode&&this.Gsi()&&(this.$.da.za(34).Cxj(this.Hy),this.showHide(!1));if(this.Jg.L4j){if(!this.VNf){const Da={};Da.div=this.Hy;Da.id=this.Hd.InstanceId;Da.solutionId=this.Hd.PrimaryMarketplace.SolutionId;Da.version=this.Hd.PrimaryMarketplace.SolutionVersion;Da.storeId=this.Hd.PrimaryMarketplace.MarketplaceRef;Da.storeType=this.Hd.PrimaryMarketplace.MarketplaceType;Da.ownerAddinSolutionId=this.Hd.OwnerAddinSolutionId;
Da.ownerAddinStoreType=this.Hd.OwnerAddinStoreType;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?this.Hd.AssetMarketplace?(Da.assetId=this.Hd.AssetMarketplace.SolutionId,Da.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef):(Da.assetId=null,Da.assetStoreId=null):this.Hd.AssetMarketplace&&(Da.assetId=this.Hd.AssetMarketplace.SolutionId,Da.assetStoreId=this.Hd.AssetMarketplace.MarketplaceRef);Da.settings=this.Hd.OsfPropertyBag;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
Da.reason=this.Z6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.lhc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Da.reason=this.Z6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Da.osfControlType=0===this.Hd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Da.isForUILessAction=4===
this.Hd.WebExtensionOsfControlType;Da.sourceLocationOverrideResourceId=this.Hd.SrcLocationOverrideResourceId;Da.focusOnIframeWhenLoaded=this.Hd.FocusOnIframeWhenLoaded;za.a(this.Hd)&&(Da.featureGates=r.AFrameworkApplication.fa.T2e(Da.solutionId));Da.hostInfoFlags=0;this.iua&&(Da.hostInfoFlags|=2);Ma.HelperMethods.Iw(this.Hd)&&(Da.hostInfoFlags|=1);this.$.c3||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Da.hostInfoFlags|=4);ua.EwaSettings.ma(628)&&(Da.hostInfoFlags|=
8);ua.EwaSettings.ma(53)&&ua.EwaSettings.ma(93)&&!this.uJc&&(Da.virtualOsfControlActivationCallback=()=>{this.Jg.ZEd(this.Hd)});Da.sharedRuntimeId=this.Hd.SharedRuntime?this.Hd.SharedRuntime.Resid:this.Hd.SharedRuntimeId;!Ma.HelperMethods.Iw(this.Hd)||this.Hd.Preload||za.a(this.Hd)||this.Jg.Wh.getOsfControl(a(734).DdaFacade.getSolutionId(this.Hd,this.$))||(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Jg.ZEd(this.Hd):this.Jg.ZEd(this.Hd));
Da.initialDisplayMode=this.Hd.TaskpaneVisible?2:1;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Da.titleOverride=this.wl.TaskpaneTitle);this.Jg.Wh.insertOsfControl(Da)}this.GU=0}else this.GMe(!0)}Egg(Da){this.Fgg(Da);this.lXj()}Ddi(){this.Ndb||this.hi.n0b(this.a$e);this.Ndb++}Fgg(Da){0<this.Ndb&&(Da?this.Ndb=0:this.Ndb--,this.Ndb||this.hi.$uc(this.a$e))}tmd(){if(!this.$wa){const Da=sa.h(this.$).ha;this.Qsc=dc.d(sa.h(this.$).ha.ra.selectedRanges);Da.QE(this.Pc);this.$wa=
!0}}lXj(){this.$wa&&(sa.h(this.$).ha.JI(this.Pc),this.$wa=!1)}vuj(Da){var Pa=new Mb.Range(Da.Reference.FirstRow+1,Da.Reference.FirstColumn+1,Da.Reference.LastRow+1,Da.Reference.LastColumn+1,!1,!1);1===Da.BindingType&&(Da.HasHeaders&&--Pa.top,Da.HasTotals&&(Pa.bottom+=1));var tb=sa.h(this.$).ha.ra.selectedRanges;Da=Pa.Pzb(this.Qsc);tb=Pa.Pzb(tb);return(Pa=Pa.Ke(sa.h(this.$).ha.ra.activeRange))&&(ha.e(Da)&&!ha.e(tb)||!ha.e(Da)&&!ha.e(tb)&&!dc.Q(Da,tb))?Pa:null}xvj(){Array.forEach(this.oF,Da=>{if(Da.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Da.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Jg.kj.z1b(this.controlId))if(Da.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Da.j3b(new Za.a(Da.eventId,this.controlId,null));else if(Da.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Pa=this.T3a(Da.targetId);if((null===Pa||void 0===Pa?0:Pa.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Cb.na.sheetName:this.$.xa.na.name)===
Pa.Reference.SheetName){const tb=this.vuj(Pa);tb&&Da.j3b(new Fa(Da.eventId,this.controlId,this.Jg.n2b(Pa),Pa,tb.top-1,tb.left-1,tb.height,tb.width))}}})}mvb(Da,Pa){if(!this.oF)return null;for(let tb=0;tb<this.oF.length;tb++){const Ib=this.oF[tb];if(Ib.eventId===Da&&Ib.targetId===Pa)return Ib}return null}FXe(){const Da=Ja.a(this.$).aV;for(let Pa=Da.length-1;0<=Pa;--Pa){const tb=Da[Pa];if(3===tb.floatingObject.type&&tb.floatingObject.wl.InstanceId===this.D1.WebExtensionId)return tb}return null}Gsi(){for(let Da=
0;Da<this.$.Cb.count;Da++)if(this.$.Cb.getItem(Da).GMa===this.D1.WebExtensionId)return!0;return!1}Byc(Da){this.AQc=Da;this.Hy.id=this.EKf;this.Hy.className=nb;this.Hy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Dxj()}B5e(){if(!this.enabled)return null;const Da=za.a(this.wl)?"":this.wl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.wl.PrimaryMarketplace.SolutionId,Da)}c$e(Da,Pa){if(ua.EwaSettings.ma(23))this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Pa);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.bhe)this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Pa);else{const tb={};tb[W.a.Kob]=this.controlId;const Ib=new rb.a(Da,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Lb(Ib,tb);this.Jg.zv(Pa)}}catch(tb){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${tb.message}.`),this.Jg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Pa)}}static tph(Da){return Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Khf(Da){return Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Da===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Da===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static aqd(Da){return Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Ihf(Da){return Da===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Jhf(Da){return Da===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Hhf(Da){return Da===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Lb,"OsfControl",lb.a,[796]);class ac{constructor(){this.ZZa={}}add(Da){this.ZZa[Da]=!0}remove(Da){delete this.ZZa[Da]}clear(){for(const Da of Object.keys(this.ZZa))delete this.ZZa[Da]}paf(){return 0<Object.keys(this.ZZa).length}POh(){return Object.keys(this.ZZa)}}Object(c.a)(ac,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var ib=a(58);class Ra{constructor(Da,Pa,tb){this.CTf=this.BTf=0;this.dNb=this.Abb=null;this.POi=()=>{var Ib=sa.h(this.$).ha.Ra.hB;if(this.Kpd(Ib)&&(Ib=this.ywb(Ib))){var Yb={};Yb.chartId=Ib;Yb.worksheetId=this.Xja();Yb=ib.a.hc(Yb);this.vja(51,Ib,Yb);this.vja(51,this.Xja(),Yb)}};this.QOi=()=>{if(this.Abb){var Ib={};Ib.chartId=this.Abb;Ib.worksheetId=this.dNb;Ib=ib.a.hc(Ib);this.vja(52,this.Abb,Ib);this.vja(52,this.dNb,Ib)}Ib=sa.h(this.$).ha.Ra.hB;this.Kpd(Ib)?(this.Abb=this.ywb(Ib),this.dNb=this.Xja()):
this.dNb=this.Abb=null};this.$=Da;this.kj=Pa;this.hi=tb}Lpb(Da){51===Da.messageType?this.BTf=this.qHa(Da.actionType,this.BTf,this.POi):52===Da.messageType&&(this.CTf=this.qHa(Da.actionType,this.CTf,this.QOi))}qHa(Da,Pa,tb){if(1===Da)Pa||sa.h(this.$).ha.Ra.qXc(tb),Pa++,this.oBj();else if(2===Da){if(1>Pa)return Pa;1===Pa&&sa.h(this.$).ha.Ra.nMd(tb);Pa--}return Pa}vja(Da,Pa,tb){Pa&&this.kj.s_(Da,Pa)&&this.hi.fN(Da,Pa,tb)}ywb(Da){return Da&&Da.floatingObject?(Da=Da.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===Da.length?Da[0]:null:null}Xja(){const Da=this.$.xa.na;return Da&&0===Da.wG?Da.sheetId:null}oBj(){const Da=sa.h(this.$).ha.Ra.hB;this.Kpd(Da)&&(this.Abb=this.ywb(Da),this.dNb=this.Xja())}Kpd(Da){return!!Da&&!!Da.floatingObject&&0===Da.floatingObject.type}}Object(c.a)(Ra,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var ya=a(738),Va=a(193),oa=a(610),kb=a(99),Sa=a(347),U=a(55);class ta extends ia.a{constructor(Da,Pa,tb){super();this.GU=this.EAa=0;this.Pc=(Ib,Yb)=>{if(this.enabled&&!(this.zjf()||
null!==Yb&&void 0!==Yb&&Yb.Qmf)&&(Ib=Object(ea.a)(kb.a,this.$.xa.na))&&0===Ib.wG){const vc=Ib.sheetId,Zc=this.S1e();let nd=null,hd=null;this.kj.Emf()&&(nd=this.grid.Bb.Bj(this.grid.ha.ra.activeCell),hd=vc in this.alc?this.alc[vc]:null);this.dwe(vc,Zc)&&eb.TaskExtensions.Aa(U.Task.Ta(!0),()=>{this.cbi(vc,Zc);this.Oai(vc,Zc,nd,hd)},this.la);this.FNe(vc,Zc,nd)}};this.$=Da;this.kj=Pa;this.hi=tb;this.grid=sa.h(Da);this.tOa={};this.alc={}}get enabled(){return!this.GU&&0<this.EAa}U1b(Da){Object(ea.a)(Sa.a,
this.$.xa);1===Da.actionType?(this.EAa||this.grid.ha.QE(this.Pc),this.EAa++):2!==Da.actionType||1>this.EAa||(1===this.EAa&&this.grid.ha.JI(this.Pc),this.EAa--)}kyc(Da){Da?this.GU++:(0<this.GU&&this.GU--,this.GU||this.Pc(null,new oa.a(!1)))}S1e(){return this.grid.ha.ra.selectedRanges}dwe(Da,Pa){return ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Da&&Va.e(this.tOa)||Da in this.tOa)&&!dc.Q(this.tOa[Da],Pa):Da in this.tOa&&!dc.Q(this.tOa[Da],
Pa)}FNe(Da,Pa,tb){this.tOa[Da]=dc.d(Pa);this.alc[Da]=tb}zjf(){return this.grid.eb||this.grid.ri}bYe(Da,Pa){this.kj.s_(14,Da)&&this.hi.fN(14,Da,Pa);this.kj.s_(14,ya.a.aX)&&this.hi.fN(14,ya.a.aX,Pa)}cbi(Da,Pa){const tb={};tb.worksheetId=Da;tb.address=this.yid(Pa);Pa=ib.a.hc(tb);this.bYe(Da,Pa)}Oai(Da,Pa,tb,Ib){if(this.kj.Emf()){var Yb="";let vc="";Ib&&(Yb=Ib.nj);tb&&(vc=tb.nj);Ib?tb?(Pa=tb.usedRange.Pzb(Pa),Yb!==vc&&this.Lac(Yb,"",Da),this.Lac(vc,this.yid(Pa),Da)):this.Lac(Yb,"",Da):tb&&(Yb=tb.usedRange.Pzb(Pa),
this.Lac(vc,this.yid(Yb),Da))}}Lac(Da,Pa,tb){if(this.kj.s_(100,Da)){const Ib={};Ib.address=Pa;Ib.worksheetId=tb;this.hi.fN(100,Da,ib.a.hc(Ib))}}yid(Da){return dc.i(Da,",",this.$,!1)}dispose(){0<this.EAa&&this.grid.ha.JI(this.Pc);this.alc=this.tOa=null;this.EAa=0;this.hi=this.kj=this.$=this.grid=null}}Object(c.a)(ta,"RichApiEventSelectionChangedHandler",ia.a,[]);var ub=a(343);class hc extends ta{constructor(Da,Pa,tb){super(Da,Pa,tb);this.Kof=this.Lof=null}S1e(){return ub.a.Msb(this.grid.ha.rangePicker.lL)}dwe(Da,
Pa){return this.Lof!==Da||!dc.Q(this.Kof,Pa)}FNe(Da,Pa){this.Lof=Da;this.Kof=dc.d(Pa)}zjf(){return!this.grid.eb&&!this.grid.ri}bYe(Da,Pa){this.kj.s_(2700,ya.a.aX)&&this.hi.fN(2700,ya.a.aX,Pa)}}Object(c.a)(hc,"RichApiEventPickedRangesChangedHandler",ta,[]);class Bc{constructor(Da,Pa,tb){this.mRa=this.lRa=0;this.QHa=this.Vha=null;this.zCf=()=>{var Ib=sa.h(this.$).ha.Ra.hB;if(0<this.mRa&&this.Vha&&this.QHa){var Yb={};Yb.shapeId=this.Vha;Yb.worksheetId=this.QHa;Yb=ib.a.hc(Yb);this.fireEvent(2102,this.Vha,
Yb)}this.sui(Ib)?(this.Vha=this.PVj(Ib),this.QHa=this.Xja(),this.Vha&&this.QHa)?0<this.lRa&&(Ib={},Ib.shapeId=this.Vha,Ib.worksheetId=this.QHa,Ib=ib.a.hc(Ib),this.fireEvent(2101,this.Vha,Ib)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Vha}', or worksheet id: '${this.QHa}' from a Floating object or gridview.`):this.QHa=this.Vha=null};this.$=Da;this.kj=Pa;this.hi=tb}Lpb(Da){const Pa=sa.h(this.$).ha;1===Da.actionType?(this.lRa||this.mRa||Pa.Ra.qXc(this.zCf),
2101===Da.messageType?this.lRa++:2102===Da.messageType&&this.mRa++):2===Da.actionType&&(2101===Da.messageType?this.lRa=0<this.lRa?this.lRa-1:0:2102===Da.messageType&&(this.mRa=0<this.mRa?this.mRa-1:0),this.lRa||this.mRa||Pa.Ra.nMd(this.zCf))}sui(Da){return!!Da&&!!Da.floatingObject&&(0===Da.floatingObject.type||7===Da.floatingObject.type||1===Da.floatingObject.type||3===Da.floatingObject.type||5===Da.floatingObject.type)}PVj(Da){if(!Da||!Da.floatingObject)return null;Da=Da.floatingObject.id;var Pa=
Da.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Pa=Pa&&1===Pa.length?Pa[0]:null;return Pa?Pa:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Da}', but we failed.`),null)}Xja(){const Da=this.$.xa.na;return Da&&0===Da.wG?Da.sheetId:null}fireEvent(Da,Pa,tb){Pa&&this.kj.s_(Da,Pa)&&this.hi.fN(Da,Pa,tb)}}Object(c.a)(Bc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Qa{constructor(Da,Pa,tb){this.FTf=this.ETf=this.GTf=this.DTf=
0;this.F1i=(Ib,Yb)=>{Ib=Object(ea.a)(kb.a,Yb.na);this.H8a(Ib)&&(Yb={},Yb.worksheetId=Ib.sheetId,Yb=ib.a.hc(Yb),this.vja(11,Ib.sheetId,Yb))};this.I1i=(Ib,Yb)=>{Ib=Object(ea.a)(kb.a,Yb.WD);this.H8a(Ib)&&(Yb={},Yb.worksheetId=Ib.sheetId,Yb=ib.a.hc(Yb),this.vja(12,Ib.sheetId,Yb))};this.G1i=(Ib,Yb)=>{Ib=Object(ea.a)(kb.a,Yb.na);this.H8a(Ib)&&(Yb={},Yb.worksheetId=Ib.sheetId,Ib=ib.a.hc(Yb),this.vja(11,null,Ib,!0))};this.H1i=(Ib,Yb)=>{Ib=Object(ea.a)(kb.a,Yb.WD);this.H8a(Ib)&&(Yb={},Yb.worksheetId=Ib.sheetId,
Ib=ib.a.hc(Yb),this.vja(12,null,Ib,!0))};this.$=Da;this.kj=Pa;this.hi=tb}Lpb(Da){11===Da.messageType?Da.targetId===ya.a.aX?this.ZTg(Da.actionType):this.YTg(Da.actionType):12===Da.messageType&&(Da.targetId===ya.a.aX?this.$Tg(Da.actionType):this.aUg(Da.actionType))}YTg(Da){this.DTf=this.qHa(Da,this.DTf,this.F1i)}aUg(Da){this.GTf=this.qHa(Da,this.GTf,this.I1i)}ZTg(Da){this.ETf=this.qHa(Da,this.ETf,this.G1i)}$Tg(Da){this.FTf=this.qHa(Da,this.FTf,this.H1i)}qHa(Da,Pa,tb){1===Da?Pa=this.KZc(Pa,tb):2===Da&&
(Pa=this.u8c(Pa,tb));return Pa}KZc(Da,Pa){Da||this.$.xa.Uf(Pa);Da++;return Da}u8c(Da,Pa){if(1>Da)return Da;1===Da&&this.$.xa.Bg(Pa);Da--;return Da}H8a(Da){return!!Da&&0===Da.wG}vja(Da,Pa,tb,Ib=!1){Pa=Ib?ya.a.aX:Pa;this.kj.s_(Da,Pa)&&this.hi.fN(Da,Pa,tb)}}Object(c.a)(Qa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var na=a(239),ab=a(14),Gb=a(224);class fc extends Sys.EventArgs{constructor(Da,Pa,tb,Ib){super();this.sheet=Da;this.o2g=Pa;this.offsetX=tb;this.offsetY=Ib}}Object(c.a)(fc,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class pb{constructor(Da,Pa,tb){this.z4b=null;this.Mtd=!1;this.onPointerDown=Ib=>{let Yb;3===Ib.tb?({b1a:Yb}=this.gridView.acc(Ib.clientPoint),this.Mtd=!!Yb&&this.gridView.ha.ra.MNe(Yb)):this.Mtd=!1;this.z4b=Ib.clientPoint;return!1};this.hd=Ib=>{if(this.gridView.inRangePicker||this.gridView.ri||this.Mtd||Ib.shiftKey||Ib.ctrlKey||Ib.Ca.button!==Sys.UI.MouseButton.leftButton||!this.z4b||!Ib.clientPoint||Ib.clientPoint.x!==this.z4b.x||Ib.clientPoint.y!==this.z4b.y)return!1;const Yb=
({b1a:Ib}=this.gridView.acc(Ib.clientPoint)).returnValue,vc=Object(ea.a)(kb.a,this.$.xa.na);if(Yb&&vc&&0===vc.wG){if(!this.gridView.ha.ra.E4.contains(Ib))return!1;Ib=new fc(vc,Ib,Ma.HelperMethods.KGd(Yb.x),Ma.HelperMethods.KGd(Yb.y));this.J1i(Ib)}return!1};this.$=Da;this.gridView=sa.h(Da);this.kj=Pa;this.hi=tb;this.Cgj()}dispose(){this.ZXj()}Cgj(){for(const Da of this.gridView.Nn){const Pa=Da.domElement;na.a.instance.ta(ab.a.pointerDown,Pa,this.onPointerDown);Gb.a.instance.ta(ab.a.click,Pa,this.hd)}}ZXj(){for(const Da of this.gridView.Nn){const Pa=
Da.domElement;na.a.instance.Ba(ab.a.pointerDown,Pa,this.onPointerDown);Gb.a.instance.Ba(ab.a.click,Pa,this.hd)}}J1i(Da){var Pa=Da.sheet;if(this.H8a(Pa)){var tb={};tb.worksheetId=Pa.sheetId;tb.address=Da.o2g.toString();tb.offsetX=Da.offsetX;tb.offsetY=Da.offsetY;Da=Pa.sheetId;this.kj.s_(21,Da)&&(Pa=ib.a.hc(tb),this.hi.fN(21,Da,Pa));Da=ya.a.aX;this.kj.s_(21,Da)&&(tb=ib.a.hc(tb),this.hi.fN(21,Da,tb))}}H8a(Da){return!!Da&&0===Da.wG}}Object(c.a)(pb,"RichApiEventSingleClickedHandler",null,[]);class Ea{constructor(Da,
Pa,tb){this.wJb=0;this.rbb=this.xbb=null;this.GJf=()=>{const Ib=sa.h(this.$).ha.Ra.hB;if(Ib)if(this.snf(Ib)){const Yb=this.Xja();this.Vcd(Yb);this.xbb=Ib.floatingObject.id;this.rbb=Yb}else this.xbb&&(this.Vcd(this.rbb),this.rbb=this.xbb=null);else this.xbb&&(this.Vcd(this.rbb),this.rbb=this.xbb=null)};this.$=Da;this.kj=Pa;this.hi=tb}U1b(Da){2E3===Da.messageType&&(1===Da.actionType?(this.wJb||sa.h(this.$).ha.Ra.qXc(this.GJf),this.wJb++,this.Kxj()):2===Da.actionType&&this.wJb&&(1===this.wJb&&sa.h(this.$).ha.Ra.nMd(this.GJf),
this.wJb--))}Vcd(Da){var Pa;const tb={};tb.worksheetId=Da;tb.revisionLoad=!1;if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(ua.EwaSettings.ma(703)||ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Ib=sa.h(this.$).ha.Ra.hB;(null===(Pa=null===Ib||void 0===Ib?void 0:Ib.floatingObject)||void 0===Pa?0:Pa.Vc)?tb.selectedVisualId=Ib.floatingObject.Vc.VisualID:tb.selectedVisualId=null}Pa=
ib.a.hc(tb);Da&&this.kj.s_(2E3,Da)&&this.hi.fN(2E3,Da,Pa)}Xja(){const Da=this.$.xa.na;return Da&&0===Da.wG?Da.sheetId:null}Kxj(){const Da=sa.h(this.$).ha.Ra.hB;this.snf(Da)&&(this.xbb=Da.floatingObject.id,this.rbb=this.Xja())}snf(Da){return!!Da&&Da.jud()}}Object(c.a)(Ea,"RichApiEventVisualSelectionChangedHandler",null,[]);class xb{constructor(Da,Pa,tb){this.xJb=0;this.wmg=!0;this.abc=0;this.Isd=!0;this.uCe=()=>{const Ib=document.hasFocus();if(this.wmg!==Ib){if(Ib){const Yb=ib.a.hc({});this.hi.fN(2203,
ya.a.aX,Yb)}this.wmg=Ib}};this.vCe=Ib=>{(0<Ib.timeRemaining()||Ib.didTimeout)&&this.uCe();window.requestIdleCallback(this.vCe)};this.$=Da;this.kj=Pa;this.hi=tb;window.requestIdleCallback||(this.Isd=!1)}XTg(Da){1===Da.actionType?(this.xJb||this.qUg(),this.xJb++):2!==Da.actionType||1>this.xJb||(1===this.xJb&&this.dmh(),this.xJb--)}qUg(){if(this.kj.s_(2203,ya.a.aX))if(this.Isd){const Da={};Da.timeout=this.$.va.CheckFocusTimeout;this.abc=window.requestIdleCallback(this.vCe,Da)}else this.abc=window.setInterval(this.uCe,
this.$.va.CheckFocusTimeInterval)}dmh(){this.Isd?window.cancelIdleCallback(this.abc):window.clearInterval(this.abc)}}Object(c.a)(xb,"RichApiEventWorkbookActivatedHandler",null,[]);var bc;(function(Da){Da[Da.none=0]="none";Da[Da.registerEvent=1]="registerEvent";Da[Da.unregisterEvent=2]="unregisterEvent";Da[Da.customFunction=3]="customFunction";Da[Da.showCard=4]="showCard";Da[Da.createWorkbook=5]="createWorkbook";Da[Da.openWorkbook=6]="openWorkbook";Da[Da.enableEvents=7]="enableEvents";Da[Da.closeWorkbook=
8]="closeWorkbook";Da[Da.setCalculationMode=9]="setCalculationMode";Da[Da.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Da[Da.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Da[Da.workbookLinksEnableContent=12]="workbookLinksEnableContent";Da[Da.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Da[Da.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Da[Da.rangePicker=15]="rangePicker";Da[Da.enableRichApiRecording=16]="enableRichApiRecording";Da[Da.recordAction=
17]="recordAction";Da[Da.focus=18]="focus";Da[Da.businessBarShow=19]="businessBarShow";Da[Da.businessBarHide=20]="businessBarHide"})(bc||(bc={}));Object(c.b)("PostProcessActionType",bc);var zb=a(249);class Ub{constructor(Da,Pa,tb){this.FKf=null;this.Tcd=(Ib,Yb)=>{const vc=ya.a.aX,Zc={};Zc.eventId=Ib;Zc.payload=Yb;this.kj.s_(2201,vc)&&this.hi.fN(2201,vc,ib.a.hc(Zc))};this.$=Da;this.kj=Pa;this.hi=tb;this.Zhi()}WTg(Da){1===Da.actionType?(this.$.Zba=!0,Object(ea.a)(a(734).DdaFacade,zb.a(this.$)).Ucd(!0)):
2===Da.actionType&&(this.$.Zba=!1);this.FKf=Da.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${bc[Da.actionType]}; controlId: ${this.FKf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Zba}.`)}qth(Da){Object(ea.a)(a(734).DdaFacade,zb.a(this.$)).eYe(Da,this.$.Zba)}Zhi(){this.$.JV&&eb.TaskExtensions.Aa(Cb.GetServiceTaskFactory.Oa(this.$.da,297,298,1),Da=>{(Da=Da.result)&&Da.init(this.Tcd)},this.$.la,3)}}Object(c.a)(Ub,"RichApiMacroRecorderEventHandler",
null,[]);class wc{}Object(c.a)(wc,"SessionRecreationInfo",null,[]);class mb{constructor(Da,Pa,tb){this.$=Da;this.kj=Pa;this.runtimeCalculationMode=tb}yKi(){return ua.EwaSettings.ma(257)?this.kj.Tbi()||0!==this.runtimeCalculationMode:!1}fZg(){var Da={};Da.eventRegistrationInfos=this.kj.nVh();Da.runtimeCalculationMode=this.runtimeCalculationMode;Da=Object(b.a)(new wc,{runtimeState:Da});const Pa={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Pa.RequestBody=JSON.stringify(Da);
Pa.RequestFlags=1;return Pa}}Object(c.a)(mb,"RichApiRuntimeStateHandler",null,[]);class Db{constructor(Da,Pa,tb,Ib,Yb,vc,Zc,nd,hd){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Da;this.processUtcTime=Pa;this.dequeueUtcTime=tb;this.inQueueDurationInMS=Ib;this.executionDurationInMS=Yb;this.operationCount=vc;this.ServerCorrelationId=
Zc;this.UserOperationName=nd;this.IsDocumentHidden=hd}}Object(c.a)(Db,"UserOperationQueueItemsStatisticsData",null,[]);var Ic=a(329),Hc=a(31),Ab=a(19),db=a(293),Pb=a(49),td=a(594),Vb=a(64),Ac=a(59),Kc=a(71);class dd extends Ic.a{constructor(Da,Pa,tb){super(tb,Da);this.Cwa=this.hashCode=null;this.A5b=!1;this.an=(Ib,Yb)=>{Yb.jd.hash===this.hashCode&&this.Cwa&&Object(ea.a)(a(734).DdaFacade,this.$.da.za(35)).DIj(this.Cwa.InstanceId)};this.sf=(Ib,Yb)=>{switch(Yb.jd.block.state){case 1:case 3:case 5:this.mea(Yb)}};
this.Gj=()=>{this.KIb(!0)};this.Mo=(Ib,Yb)=>{this.isVisible&&this.WUa(Yb.WD);this.clearCache()};this.se=(Ib,Yb)=>{this.ZTa(Yb.na,!!Yb.WD)};this.dO=()=>{this.$.ea.Uma()};this.xVa=Pa;this.domElement.classList.add(Hc.a.B$b);this.domElement.classList.add(Ab.a.rp);tb.tabIndex=0;this.ZTa(this.$.na,!1);this.Gc.ka("mousedown",this.dO);this.Gc.ka("contextmenu",Ib=>{Kc.g(Ib)});this.$.xa.KJ(this.Mo);this.$.Cb.KJ(this.Mo);this.$.Cb.Uf(this.se);this.$.xa.Uf(this.se);this.Ea.mt(this.sf);this.Ea.jH(this.an);this.Ea.jw(this.Gj);
this.mv(this.rza)}get Ea(){return this.xVa}dispose(){this.$&&(this.$.xa.sL(this.Mo),this.$.Cb.sL(this.Mo),this.$.Cb.Bg(this.se),this.$.xa.Bg(this.se));this.xVa&&(this.xVa.gr(this.sf),this.xVa.HI(this.an),this.xVa.ix(this.Gj));this.Oy(this.rza);this.clearCache();ca.a.Ia(this.xVa);this.xVa=null;pa.DOMElementExtensions.tf(this.domElement);super.dispose()}Cxj(Da){pa.DOMElementExtensions.tf(pa.DOMElementExtensions.getElementById(this.domElement,Da.id));this.domElement.appendChild(Da)}dod(){if(this.Cwa&&
!this.A5b){var Da=Object(ea.a)(a(734).DdaFacade,zb.a(this.$)).An(this.Cwa.InstanceId);Da&&(Da.resize(this.Cwa.Width,this.Cwa.Height),Da.ka(this.domElement),Da.showHide(!0),this.A5b=!0)}}J8a(){return!0}mea(Da){this.Cwa=Da.jd.block.je;this.A5b=!1;this.dod()}WUa(Da){this.$.ea.n5&&Da&&(Da.Yu||(Da.Yu=new db.a),Da.Yu.ei=new Pb.a(this.domElement.scrollLeft,this.domElement.scrollTop),Da.Yu.bIb=20)}clearCache(){this.Ea.sRa(this.hashCode);this.Cwa=this.hashCode=null;this.A5b=!1}ZTa(Da,Pa){if(this.isVisible=
!!Da&&Vb.o(Da))this.hashCode=this.Ea.tsa(Da,Ac.a.H7b,this.hashCode),this.Ryc(Pa)}static rHa(Da){if(!Da.da.za(34)){const Pa=Da.uf;Da.da.Ga(34,new dd(Da,new td.a(Da,Da.ea,Da.pa.Mk,3,0),Pa.appendChild(Pa.ownerDocument.createElement("div"))))}}}Object(c.a)(dd,"WebExtensionView",Ic.a,[793,169,2]);var Vd=a(226),Jd=a(371),oe=a(436),De=a(188),Ke=a(60),rd=a(116),bf=a(47),cc=a(46),Wc=a(153),id=a(110),Tc=a(63),Gd=a(28),Wd=a(29),Dd=a(282),Kd=a(22),we=a(13),We=a(281),Od=a(737),le=a(51),de=a(147),Re=a(864);const Ee=
Da=>{de.a.sendOtelEvent(Object.assign(new Re.a,{otelEvent:Da}))},Te=Da=>{de.a.sendOtelCustomerContent(Object.assign(new Re.a,{otelEvent:Da}))};var Ae=a(200),kf=a(863),Oe=a(25),$a=a(223);a.d(D,"DdaFacade",function(){return Zb});class Zb extends Oa.a{constructor(Da,Pa){super();this.hi=this.Km=this.ea=null;this.zf=[];this.RJa=null;this.disposed=this.initialized=this.yRb=this.pKe=!1;this.$Ca=null;this.grc=[];this.jKe=[];this.rQa=[];this.r2a=null;this.BGd=new V.a(ra.a.cl());this.I0b=new N.a(ra.a.cl());
this.KHb=[];this.aMf=[];this.L7b=350;this.hya=this.wfa=null;this.kVc=!1;this.xje=this.wje=this.vje=this.tje=this.pje=this.uje=this.qje=this.sje=this.oje=this.rje=null;this.yf=()=>{this.$Ca=this.ea.Ho.WebExtensions;for(var tb=this.zf.length-1;0<=tb;--tb){var Ib=this.zf[tb],Yb;if(Yb=!this.vIh(Ib.controlId))Yb=Ib,Yb=ua.EwaSettings.ma(121)?!Yb.iua:!0;Yb&&(Ib.bpc(),this.zf.splice(tb,1))}if(this.$Ca)for(let vc=0,Zc=this.$Ca.length;vc<Zc;vc++)tb=this.$Ca[vc],(Ib=this.An(tb.WebExtensionId))&&Ib.TDd(tb)};
this.dqc=tb=>{this.raiseEvent("csc",tb.getID())};this.eEd=(tb,Ib,Yb)=>{if(Ib===OSF.AgaveHostAction.KeyboardShortcuts){var vc=Object(ea.a)(Object,Yb);Ib={};Ib.keyCode=vc.keyCode;Ib.type="keydown";Ib.ctrlKey=vc.ctrlKey;Ib.shiftKey=vc.shiftKey;Ib.altKey=vc.altKey;Ib.metaKey=vc.metaKey;vc=this.An(tb);tb=vc.A$;Ib.srcElement=Object(Ba.a)(261,tb)?tb.dHa:sa.h(this.$).mc;tb=new Sys.UI.DomEvent(Ib);vc=Zb.Nva(vc.wl,this.$);Ib={};Ib.focusedAddinId=vc;vc=new rb.a(1461300262,1,this.$.Hc,6,null);sa.h(this.$).iLb(tb,
vc,Ib)}else if(Ib===OSF.AgaveHostAction.Select)this.O9e(!0);else if(Ib===OSF.AgaveHostAction.UnSelect)this.O9e(!1);else if(Ib===OSF.AgaveHostAction.CancelDialog)this.CK(-684355545,null);else if(Ib===OSF.AgaveHostAction.InsertAgave)tb={},Yb&&(tb[W.a.Esa]=Yb,tb[la.a.lg]=Zb.Qsb(Yb),this.CK(-741808261,tb));else if(Ib===OSF.AgaveHostAction.InsertDevManifest)tb={},Yb&&(tb[W.a.Esa]=Yb,tb[la.a.lg]=Zb.Qsb(Yb),this.CK(-741808261,tb));else if(Ib===OSF.AgaveHostAction.InsertDevManifestError)tb=Object(ea.a)(Object,
Yb),tb={[W.a.XXc]:this.Km.getDevManifestInvalidUrlErrorString(tb.manifestUrl)},this.CK(-2025863019,tb);else if(Ib===OSF.AgaveHostAction.NotifyHostError)tb={[W.a.XXc]:this.Km.getManifestInvaildErrorString()},this.CK(-2025863019,tb);else if(Ib===OSF.AgaveHostAction.RefreshAddinCommands)ua.EwaSettings.ma(53)&&this.CK(Oe.a.refreshAddinCommands,null);else if(Ib===OSF.AgaveHostAction.CtrlF6Exit||Ib===OSF.AgaveHostAction.CtrlF6ExitShift){if(vc=this.$.da.za(15)){(tb=this.An(tb).A$)&&tb.$Ac();w.a.fg&&document.activeElement.blur();
var Zc={keyCode:117,type:"keydown",ctrlKey:!0};Zc.shiftKey=Ib===OSF.AgaveHostAction.CtrlF6ExitShift;Zc.srcElement=Object(Ba.a)(261,tb)?tb.dHa:sa.h(this.$).mc;tb=new Sys.UI.DomEvent(Zc);vc.Mma(tb)}}else if(Ib===OSF.AgaveHostAction.PageIsReady){if((tb=this.An(tb).A$)&&tb.f_a===OSF.OsfControlTarget.TaskPane&&(tb=this.$.da.za(183))&&this.zf){Ib=Jb.a.gd(this.$);for(vc of this.zf)Zb.jNa(vc.sU)&&(Ib?tb.gg(!0,!1):tb.setFocusOnToolbarFirstElement())}}else if(Ib===OSF.AgaveHostAction.TabExit){Ib=this.An(tb);
const Ud=Ib.A$;if(Ud)if(Ud.f_a===OSF.OsfControlTarget.InContent)Ud.oof();else{if(Ud.f_a===OSF.OsfControlTarget.TaskPane)if(Jb.a.gd(this.$))w.a.fg&&document.activeElement.blur(),O.UISurfaces.ej().then(ee=>{const ec=Object(Ba.a)(261,Ud)?Ud:null;ec?ec.isResizable?ee.focusResizeHandle():ee.focusTabbedTaskPaneArea():ee.focusTabbedTaskPaneArea();return null});else if(Ib=this.$.da.za(183))w.a.fg&&document.activeElement.blur(),(tb=document.getElementById(this.$.Eb+wa.a.doc))&&pa.DOMElementExtensions.isVisible(tb)?
pa.DOMElementExtensions.setFocus(tb):Ib.setFocusOnToolbarFirstElement()}else Ib&&4===Ib.osfControlType&&this.Km.notifyAgave(tb,OSF.AgaveHostAction.TabIn)}else if(Ib===OSF.AgaveHostAction.TabExitShift)(Ib=this.An(tb),vc=Ib.A$)?vc.f_a===OSF.OsfControlTarget.InContent?vc.pof():vc.f_a===OSF.OsfControlTarget.TaskPane&&(tb=Object(Ba.a)(261,vc)?vc:null)&&(w.a.fg&&document.activeElement.blur(),tb.O3f()):Ib&&4===Ib.osfControlType&&this.Km.notifyAgave(tb,OSF.AgaveHostAction.TabIn);else if(Ib===OSF.AgaveHostAction.EscExit||
Ib===OSF.AgaveHostAction.ExitNoFocusable||Ib===OSF.AgaveHostAction.ExitNoFocusableShift)if(vc=this.An(tb).A$)vc.$Ac();else{if(Ib===OSF.AgaveHostAction.EscExit){Ib=null;for(Zc of C.G7h())if(Zc.value.Ee===tb){Zc.value.dialog.hide();Ib=Zc.key;break}Ib&&(tb=this.An(Ib))&&4!==tb.osfControlType&&this.Wh.notifyAgave(Ib,OSF.AgaveHostAction.TabIn)}}else if(Ib===OSF.AgaveHostAction.InstallCustomFunctions)if(ua.EwaSettings.ma(121)){Tc.a(this.$).kZe(()=>!1);var nd=this.$.da;eb.TaskExtensions.Aa(Cb.GetServiceTaskFactory.Oa(nd,
278,279,1),Ud=>{Ud=Ud.result;nd.za(278)||nd.Ga(278,Ud);const ee=Yb.osfControl.getStoreType();Ud.tff(Yb.osfControl.getSolutionId(),ee,Zb.tTh(Yb.osfControl),Yb).Sna()},this.la,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Ib===OSF.AgaveHostAction.UninstallCustomFunctions)if(ua.EwaSettings.ma(121)){Tc.a(this.$).kZe(()=>!1);var hd=this.$.da;eb.TaskExtensions.Aa(Cb.GetServiceTaskFactory.Oa(hd,278,279,
1),Ud=>{Ud=Ud.result;hd.za(278)||hd.Ga(278,Ud);Ud.Hgg(Yb.solutionId,Yb.storeType).Sna()},this.la,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Ib===OSF.AgaveHostAction.SendTelemetryEvent?Ee(Yb):Ib===OSF.AgaveHostAction.SendCustomerContent?Te(Yb):Ib===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.Vyi(Yb):Ib===OSF.AgaveHostAction.RefreshRibbonGallery?ua.EwaSettings.getBooleanFeatureGate($a.a.jB,
!1)?(tb=this.$.da.za(519))&&tb.eMa(Yb):(tb=this.$.da.za(352))&&tb.eMa(Yb):Ib===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.iij(Yb.solutionId),Jb.a.gd(this.$)||(tb=this.$.da.za(183))&&tb.pA(),ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&r.AFrameworkApplication.ub.ae(Oe.a.YTf,2,Yb.solutionId)):Ib===OSF.AgaveHostAction.GetOriginalControlId&&(tb=new J.a(this.$.Eb,Yb.ownerAddinSolutionId,new qa.a,!0),Yb.originalControlId=tb?tb.CKe(Yb.controlId):
Yb.controlId)};this.yvj=(tb,Ib)=>{const Yb=Array(2);Yb[0]=Ib;Yb[1]=null;this.hi.EIh(tb,JSON.stringify(Yb))};this.n1i=()=>{this.$.na&&Vb.o(this.$.na)&&this.$.da.za(34).dod()};this.ed=()=>{this.mqf()};this.HR=(tb,Ib)=>{var Yb,vc;1===Ib.Mr&&(tb=Ib.Qf)&&(Ib=new Db(id.toTimestamp(tb.enqueueUtcTime),id.toTimestamp(tb.processUtcTime),id.toTimestamp(tb.dequeueUtcTime),id.getElapsedMilliseconds(tb.enqueueUtcTime,tb.processUtcTime),id.getElapsedMilliseconds(tb.processUtcTime,tb.dequeueUtcTime),tb.operationCount,
(null===(vc=null===(Yb=tb.operation)||void 0===Yb?void 0:Yb.od)||void 0===vc?0:vc.ServerCorrelationId)?tb.operation.od.ServerCorrelationId:null,tb.operation?Enum.toString(oe.a,tb.operation.operationName):null,Od.a.CD(id.getElapsedMilliseconds(tb.enqueueUtcTime,Gd.a.Qa.zb))),Yb=Sys.Serialization.JavaScriptSerializer.serialize(Ib),e.ULS.sendTraceTag(50872916,0,50,Yb))};this.Tc=(tb,Ib)=>{!this.ea.Zb&&Vd.a(Ib)?(Array.forEach(this.zf,this.oBf),this.zf.length=0,this.yRb=!1):(Ib.YH&&(e.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.zYf()),this.wL(),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.yRb=!1))};this.Oo=()=>{ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.zYf());this.wL();ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.yRb=
!1)};this.oBf=tb=>{tb.bpc();this.raiseEvent("cd",tb.controlId)};this.jb=Da;this.oYc=Pa;this.initialize();sb.ka(this);this.DZf=0;(Da=(Da=!(w.a.Fp||w.a.z5))&&(!ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!w.a.fg))&&OfficeExt.ShortcutKeyDispatchManager.init();this.zyg={}}get G1b(){return this.wfa||(this.wfa=new T.a(this.$.ru))}nXc(Da){this.addHandler("cd",Da)}kjj(Da){this.removeHandler("cd",Da)}pMg(Da){this.addHandler("csc",Da)}mjj(Da){this.removeHandler("csc",
Da)}mMg(Da){this.addHandler("ca",Da)}jjj(Da){this.removeHandler("ca",Da)}nMg(Da){this.addHandler("ci",Da)}oMg(Da){this.addHandler("ekros",Da)}ljj(Da){this.removeHandler("ekros",Da)}eGd(Da,Pa){try{return JSON.parse(Da)[Pa].toLowerCase()}catch(tb){return""}}eEj(Da){const Pa=this.eGd(Da,"AudienceGroup"),tb=this.eGd(Da,"SessionOrigin");try{const Ib=parseInt(this.eGd(Da,"Ring"),10);if("automation"!==Pa&&"bluechicken"!==tb&&-2<=Ib)return!0}catch(Ib){if("automation"!==Pa&&"bluechicken"!==tb)return!0}return!1}get Wh(){if(!this.Km){const Da=
{},Pa=!(this.$.rd&1),tb=fb.a.current.mL,Ib=this.$.workbookContext,Yb=Y.a.ML+Y.a.Y4b;Da.pageBaseUrl=tb.LayoutsContentUrlPrefix;Da.appName=OSF.AppName.ExcelWebApp;Da.appVersion="16";Da.appSettings=this.AXh();Da.singleSignOnSettings=H.AppsForOfficeSingleSignOnManager.l4h();Da.clientMode=Pa?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Da.appUILocale=this.$.va.UICultureTag;Da.dataLocale=this.$.va.DataCultureTag;Da.docUrl=Ib.ClientUrl;Da.hostControl=this;Da.formFactor=OSF.FormFactor.Default;Da.lcid=
this.$.JG.toString();Da.localizedScriptsUrl=Y.a.ML+Y.a.c4c;Da.localizedImagesUrl=Yb;Da.localizedStylesUrl=Y.a.ML+Y.a.zFe;Da.localizedResourcesUrl=Yb;Da.osfOmexBaseUrl=tb.OsfOmexBaseUrl;Da.firstPartyManifestCDNUrl=tb.FirstPartyAddInManifestCDN;Da.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");Da.sdxCdnUrl=tb.SdxCdnUrl;Da.sdxDmsUrl=tb.SdxDmsUrl;Da.devCatalogUrl=tb.DevCatalogUrl;Da.controlStatusChanged=this.dqc;Da.notifyHost=this.eEd;Da.allowExternalMarketplace=
this.$.ea.Vg.get(27)&&Zb.I5b;Da.enableAddinCommands=ua.EwaSettings.ma(53);Da.enableBlackForestRedirect=ua.EwaSettings.ma(88);Da.enableMyOrg=this.$.ea.Vg.get(33);Da.enableMyApps=this.$.ea.Vg.get(34);Da.enableDevCatalog=ua.EwaSettings.ma(44);Da.enablePrivateCatalog=this.YEj();Da.enableTaskpaneUpgradeToAppCommand=ua.EwaSettings.ma(93);Da.showSignOutFromPrivateCatalogMessage=this.$.ea.Vg.get(36);Da.enableUploadFileDevCatalog=ua.EwaSettings.ma(53)&&!ua.EwaSettings.ma(280);Da.userNameHashCode=X.a.qw(r.AFrameworkApplication.userName);
Da.envCode=this.$.va.OfficeAddinTelemetryDataSourceCode.toString();Da.enableSingleSignOnForAddin=!ua.EwaSettings.ma(23)&&r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Da.enableDisplayBlockedMinorError=ua.EwaSettings.ma(181);Da.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;Da.enableAnonymousUseLegacyCatalogService=ua.EwaSettings.ma(171);Da.enableInsertDialogAccessibilityFix=ua.EwaSettings.ma(178);Da.disableAppsForOfficeThirdParty=ua.EwaSettings.ma(184);Da.enableFirstPartySSO=
ua.EwaSettings.ma(196);Da.wacSessionId=this.$.va.UserSessionId;Da.disableLogging=!this.$.va.AriaLoggingIsEnabled;Da.enableFirstPartySDXErrorMessages=ua.EwaSettings.ma(209);Da.enableRichApiCellEditDelay=ua.EwaSettings.ma(188);Da.isHostDocumentDomain=ua.EwaSettings.ma(224);Da.loggableUserId=r.AFrameworkApplication.fa.Xa("LoggableUserId");Da.sessionStartInfoJson=r.AFrameworkApplication.fa.Xa("SessionStartInfoJson");Da.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;
Da.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Xa("PostMessageOrigin");Da.wacIsEmbedded=r.AFrameworkApplication.fa.qa("IsEmbedded");Da.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");Da.enableRemoveAppCommandsAddin=r.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");Da.isHostFrameTrustCheckEnabledForAddIns=r.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");Da.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;
Da.agaveAddinUploadEnabled=ua.EwaSettings.ma(46);Da.hostAllowedOfficeStore=r.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");Da.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");Da.hostInstallAddIns=r.AFrameworkApplication.fa.Xa("HostInstallAddIns");Da.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");Da.approvedAddIns=r.AFrameworkApplication.fa.Xa("ApprovedAddIns");Da.addinEnforceHttpsIsEnabled=this.eEj(Da.sessionStartInfoJson);
Da.hostFeatureGateFlag=0;Da.isUpnCheckEnabled=r.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");Da.wacUpn=r.AFrameworkApplication.fa.Xa("UserPrincipalName");Da.isReactRibbonEnabled=Jb.a.isReactRibbonEnabled();Da.enableSetFocusOnTaskpaneOnUserAction=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Da.isSafariWithIndexedDBDisabled=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&w.a.PNa;Da.isIndexedDBDisabled=
ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&w.a.PNa||ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&w.a.fg;Da.enableCustomShortcuts=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");Da.changeGetModifierKeyStringOutputOrder=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Da.officeJsUrl=r.AFrameworkApplication.CL("OfficeJs/excel.js",5);Da.enableOfficeJsUrlParam=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Km=new OSF.ContextActivationManager(Da);this.Km.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Km.setWSA(r.AFrameworkApplication.Un);this.Km&&"undefined"!==typeof this.Km.hostCheckReadyHandler&&r.AFrameworkApplication.kNg(Object(d.a)(this.Km,this.Km.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const vc=va.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Km.setOAuthManager(vc)}catch(vc){}}return this.Km}get L4j(){return this.kVc}get kj(){return this.rje}get Nna(){return this.oje}get $Od(){return this.sje}get ZOd(){return this.qje}get Jqj(){return this.uje}get Hqj(){return this.pje}get Iqj(){return this.tje}get Kqj(){return this.vje}get Lqj(){return this.wje}get aPd(){return this.xje}get yV(){return this.zyg}get $(){return this.jb}n2b(Da){const Pa=
{};Pa.Name=Da.Name;Pa.BindingType=Da.BindingType;Pa.HasHeaders=Da.HasHeaders;Da.IsValidRef&&(Pa.ColCount=Da.Reference.LastColumn-Da.Reference.FirstColumn+1,Pa.RowCount=Da.Reference.LastRow-Da.Reference.FirstRow+1);return Pa}Dpf(Da,Pa){const tb=this.iYg(Pa);if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")){let Ib=null;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==tb.assetId&&
"undefined"!==typeof tb.assetId&&null!==Pa&&"LaunchAddinDialogFromTellMe"===Pa[0]&&(Ib="{98143890-AC66-440E-A448-ED8771A02D52}");this.Km.launchInsertDialog(Da,Ib,tb)}else this.Km.launchInsertDialog(Da,null,tb)}Ada(Da,Pa){if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.uPf(Da,Pa,OSF.StoreTypeEnum.MarketPlace);else{const tb={};tb.callbackFunc=Da;tb.storeType=OSF.StoreTypeEnum.MarketPlace;tb.fromInsertDialog=!1;tb.refresh=Pa;this.Km.queryEntitlementDetails(tb)}}uPf(Da,
Pa,tb){const Ib={};Ib.callbackFunc=Da;Ib.storeType=tb;Ib.fromInsertDialog=!1;Ib.refresh=Pa;this.Km.queryEntitlementDetails(Ib)}invokeDdaMethod(Da,Pa){const tb=this.An(Da.DdaMethod.ControlId);tb?tb.invokeDdaMethod(Da,Pa):this.qf(Z.a.internalError,Pa)}registerDdaEventAsync(Da,Pa,tb,Ib,Yb){(Pa=this.An(Pa))?Zb.CAb(Da)?Pa.dfj(Da,tb,Ib,Yb):this.qf(Z.a.vFd,Yb):this.qf(Z.a.internalError,Yb)}unregisterDdaEventAsync(Da,Pa,tb,Ib,Yb){(Pa=this.An(Pa))?Zb.CAb(Da)?Pa.CXj(Da,tb,Ib,Yb):this.qf(Z.a.vFd,Yb):this.qf(Z.a.internalError,
Yb)}dispose(){this.disposed||(this.$.Kl(this.ed),this.ea.qk(this.Tc),this.ea.ZR(this.Oo),this.ea.Ov(this.yf),this.oYc.detach(this),this.$.userOperationManager.mo(this.HR),this.grc=this.zf=this.hi=this.oYc=this.jb=null,this.RJa&&(this.RJa.dispose(),this.RJa=null),ca.a.Ia(this.$Od),ca.a.Ia(this.ZOd),this.r2a&&(this.r2a.dispose(),this.r2a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}Yfd(Da){return(Da=this.An(Da))?Da.getDefaultIconUrl():null}kyc(Da){if(this.pKe!==
Da){this.pKe=Da;for(let Pa=0,tb=this.zf.length;Pa<tb;Pa++){const Ib=this.zf[Pa];Da?Ib.GMe(!1):Ib.hsh()}this.$Od.kyc(Da);this.ZOd.kyc(Da)}}TTh(Da){return(Da=this.An(Da))?Da.getDefaultDisplayName():null}qf(Da,Pa,tb=!0){const Ib={};Ib[la.a.lg]=Da;Ib[la.a.a4]=Pa;this.CK(451041795,Ib,tb)}zv(Da){const Pa={};Pa[la.a.a4]=Da;this.CK(1237877382,Pa)}CK(Da,Pa,tb=!0){const Ib=new rb.a(Da,0,this.$.Hc,0,null),Yb=Pa?Pa[la.a.a4]:null;this.r2a&&sa.h(this.$).eb&&Xa.b7g(Da,Pa)?this.r2a.Tkh(Da,Pa):(Da=this.$.Ka.Lb(Ib,
Pa),tb&&eb.TaskExtensions.Aa(Da,vc=>{Wc.a(vc)?this.qf(Z.a.internalError,Yb,!1):vc.result||(sa.h(this.$).eb?this.qf(Z.a.SMa,Yb,!1):this.qf(Z.a.internalError,Yb,!1))},this.la,8))}B9g(Da){return!!this.uja(Pa=>Zb.getSolutionId(Pa.wl,this.$)===Zb.getSolutionId(Da,this.$)&&Pa.wl.PrimaryMarketplace.MarketplaceType===Da.PrimaryMarketplace.MarketplaceType&&Pa.wl.PrimaryMarketplace.MarketplaceRef===Da.PrimaryMarketplace.MarketplaceRef&&Pa.wl.PrimaryMarketplace.SolutionVersion===Da.PrimaryMarketplace.SolutionVersion)}An(Da){return this.uja(Pa=>
Pa.controlId.startsWith(Da))}iIh(Da){return this.uja(Pa=>Pa.iua===Da)}GXe(Da){return this.uja(Pa=>Pa.sU===Da&&!!Pa.iua)}VXe(Da,Pa,tb,Ib){return this.uja(Yb=>Yb.sU===Da&&Yb.wl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Pa.toLowerCase()&&Yb.wl.PrimaryMarketplace.MarketplaceType.toLowerCase()===tb.toLowerCase()&&!!Yb.wl.SharedRuntime&&!!Yb.wl.SharedRuntime.Resid&&!!Ib&&!!Ib.Resid&&Yb.wl.SharedRuntime.Resid.toLowerCase()===Ib.Resid.toLowerCase())}LTg(Da,Pa){if(Da=this.An(Da))Da.ka(Pa),Da.showHide(!0)}DIj(Da){(Da=
this.An(Da))&&Da.showHide(!1)}SIa(Da){var Pa;if(1!==Da.WebExtensionType||this.$.rd&8388608&&Da.TaskpaneVisible||this.$.rd&8388608&&!Da.TaskpaneVisible&&Ma.HelperMethods.Iw(Da)){let tb=null;Ma.HelperMethods.Iw(Da)&&(tb=Zb.Nva(Da,this.$),Da.TaskpaneWidth||(Da.TaskpaneWidth=this.L7b));const Ib=(new Lb(this,this.hi,Da)).Qnd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.PrimaryMarketplace.SolutionId,ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?Da.OwnerAddinStoreType||Da.PrimaryMarketplace.MarketplaceType:Da.PrimaryMarketplace.MarketplaceType,null===(Pa=Da.AssetMarketplace)||void 0===Pa?void 0:Pa.SolutionId,null,null,Da.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Da.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ma.HelperMethods.Iw(Da)}`);tb&&(Ib.iua=tb);this.zf.push(Ib);this.hya=null;this.Z6a(Da.InstanceId)||(Da=String.format("{0}|{1}|{2}|{3}|{4}",Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.SolutionVersion,
Da.PrimaryMarketplace.MarketplaceRef,Da.PrimaryMarketplace.MarketplaceType,Da.WebExtensionType),this.raiseEvent("ci",Da))}}kKj(Da,Pa){Da.TaskpaneWidth=this.L7b;Da.TaskpaneVisible=!0;const tb={};tb.SolutionId=Da.PrimaryMarketplace.SolutionId;tb.TargetType=Da.WebExtensionType;tb.Version=Da.PrimaryMarketplace.SolutionVersion;tb.StoreType=Da.PrimaryMarketplace.MarketplaceType;tb.StoreId=Da.PrimaryMarketplace.MarketplaceRef;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?Da.AssetMarketplace?(tb.AssetId=Da.AssetMarketplace.SolutionId,tb.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(tb.AssetId=null,tb.AssetStoreId=null):(tb.AssetId=Da.PrimaryMarketplace.SolutionId,tb.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef);tb.Width=Da.TaskpaneWidth;const Ib=new Lb(this,this.hi,Da,!0);Ib.Qnd();this.zf.push(Ib);const Yb=()=>{this.uRa(Ib.controlId);this.Wh.purgeOsfControl(Ib.controlId,!1);Pa()};let vc=null;vc=bf.a.instance.eD(()=>{Ib.Hy&&(ca.a.Ia(vc),vc=null,this.Wh.insertBlankControlWithErrorUX(this.jIb(Ib,
tb),Yb))},100,cc.a.Hjh)}ych(Da){if(Da&&Da.length){var Pa=[];Da.forEach(tb=>{if(tb.ContainsCustomFunctions){const Ib=Zb.Nva(tb,this.$);this.BGd.contains(Ib)||(this.BGd.add(Ib),this.aMf.push(tb));this.B9g(tb)||Pa.push(tb)}});Pa.length&&this.wHe(Pa)}}wJe(Da,Pa){this.An(Da.InstanceId)||(Pa=Pa(),Da=(new Lb(this,this.hi,Da)).nef(Pa),this.zf.push(Da),this.hya=null)}XHj(Da){Zb.k2a.lb(Da)&&Zb.k2a.oa(Da).initializeAndShowWithTitle()}Oci(Da){Zb.k2a.lb(Da)&&Zb.k2a.oa(Da).hide()}W_h(Da){var Pa=null;let tb,Ib,
Yb=null;tb=Zb.$jd(Da,!0);if(!tb)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),U.Task.Ta(null);(Ib=this.Km.getOsfControl(Zb.getSolutionId(tb,this.$)))&&(Pa=Ib.getManifest())&&(Yb=Pa.getSharedRuntimeForCustomFunctions("Workbook"));if(Pa=Yb&&1===Yb.LifeTime?this.VXe(tb.PrimaryMarketplace.SolutionId,tb.PrimaryMarketplace.MarketplaceRef,tb.PrimaryMarketplace.MarketplaceType,Yb):this.iIh(Da))return U.Task.Ta(Pa.controlId);const vc=
new ka.a;Ma.HelperMethods.vkc(Yb)&&(tb.SharedRuntime=Yb);Da=Ib?Ib.getNotificationParams():[];if(!Da.length)return this.$He(tb);this.i8f(Da,()=>{eb.TaskExtensions.Aa(vc.task,()=>{this.$He(tb)},this.la,3)},()=>{});return vc.task}NOh(Da){Da=Zb.$jd(Da,!1);if(!Da)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Pa=null;var tb=this.Km.getOsfControl(Zb.getSolutionId(Da,this.$));tb&&(tb=tb.getManifest())&&(Pa=tb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
return Ma.HelperMethods.vkc(Pa)&&(Da=this.VXe(Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.MarketplaceRef,Da.PrimaryMarketplace.MarketplaceType,Pa))?Da.controlId:null}Sah(Da,Pa){var tb=Zb.$jd(Da,!1);if(tb){var Ib=null,Yb=this.Km.getOsfControl(Zb.getSolutionId(tb,this.$));Yb&&(Yb=Yb.getManifest())&&(Ib=Yb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ma.HelperMethods.vkc(Ib)){tb.SharedRuntime=Ib;var vc=tb.PrimaryMarketplace.SolutionId;Yb=tb.PrimaryMarketplace.SolutionVersion;
var Zc=OSF.OsfManifestManager.getCachedManifest(vc,Yb);if(Zc)if(this.I0b.lb(Da))Ib=this.I0b.oa(Da),eb.TaskExtensions.Aa(Ib,Ud=>{(Ud=Ud.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ud,Pa,this.hi.XLb)},this.la,3);else{var nd={};nd.solutionId=vc;nd.version=Yb;nd.storeType=tb.PrimaryMarketplace.MarketplaceType;nd.storeId=tb.PrimaryMarketplace.MarketplaceRef;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?tb.AssetMarketplace?(nd.assetId=
tb.AssetMarketplace.SolutionId,nd.assetStoreId=tb.AssetMarketplace.MarketplaceRef):(nd.assetId=null,nd.assetStoreId=null):(nd.assetId=vc,nd.assetStoreId=null);nd.targetType=OSF.OsfControlTarget.TaskPane;var hd=new ka.a;tb=eb.TaskExtensions.Rj();tb=new aa.a(this.$,this,nd,tb);Ib=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(vc,Ib.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Zc,Ib,Yb);tb.createUILessSandbox(nd,Zc,(Ud,ee)=>{Ud&&!ee?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Ud,
Pa,this.hi.XLb),hd.setResult(Ud)):hd.setResult(null);this.I0b.remove(Da)});this.I0b.ia(Da,hd.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}jCe(Da){(Da=this.GXe(Da))&&(Da.wl.SharedRuntime||this.IJb(Da.controlId))}IJb(Da){(Da=this.GXe(Da))&&this.uRa(Da.controlId)}Qoh(Da,Pa){if(!this.zf||!Da||!Pa)return!1;if(Da.toLowerCase()===Pa.toLowerCase())return!0;let tb=null,Ib=null;for(let Yb=0,vc=this.zf.length;Yb<vc;Yb++){const Zc=this.zf[Yb];
if(Zc.ownerAddinSolutionId&&(Zc.controlId===Da&&(tb=Zc.ownerAddinSolutionId.toLowerCase()),Zc.controlId===Pa&&(Ib=Zc.ownerAddinSolutionId.toLowerCase()),tb&&Ib))break}return tb&&tb===Ib?!0:!1}QJg(Da){this.An(Da.InstanceId)||(Da=new Lb(this,this.hi,Da),this.zf.push(Da),this.hya=null)}BUf(Da){if(this.zf&&0<=Da&&Da<this.zf.length){const Pa=this.zf[Da],tb=Pa.Hy;this.zf.splice(Da,1);this.oBf(Pa);pa.DOMElementExtensions.tf(tb)}}uRa(Da){if(this.zf)for(let Pa=0,tb=this.zf.length;Pa<tb;Pa++)if(this.zf[Pa].controlId===
Da){this.BUf(Pa);break}}iij(Da){if(this.zf){Da=Da.toLowerCase();for(let Pa=0,tb=this.zf.length;Pa<tb;Pa++)if(Da===this.zf[Pa].ownerAddinSolutionId.toLowerCase()){this.BUf(Pa);break}}}pUg(Da){Da.Ni&&(this.An(Da.floatingObject.wl.InstanceId)||(this.lhc(Da.floatingObject.wl.InstanceId)||this.grc.push(Da.floatingObject.wl.InstanceId),this.SIa(Da.floatingObject.wl)),this.ea.isNamedObjectViewMode&&this.LTg(Da.floatingObject.wl.InstanceId,Da.Jd))}Taa(Da){if(this.zf)for(let Pa=0,tb=this.zf.length;Pa<tb;Pa++)if(1===
this.zf[Pa].controlType&&Kd.a.equals(this.zf[Pa].sU,Da,!0))return this.zf[Pa].controlId;return null}KHh(Da){const Pa=[];if(this.zf)for(let tb=0,Ib=this.zf.length;tb<Ib;tb++)Kd.a.equals(this.zf[tb].sU,Da,!0)&&Pa.push(this.zf[tb].controlId);return Pa}pIh(Da,Pa){if(!Pa||!Da)return null;if(this.zf)for(let tb=0,Ib=this.zf.length;tb<Ib;tb++)if(1===this.zf[tb].controlType&&Kd.a.equals(this.zf[tb].sU,Da,!0)&&this.zf[tb].wl.SharedRuntime&&Kd.a.equals(this.zf[tb].wl.SharedRuntime.Resid,Pa.Resid,!0))return this.zf[tb].controlId;
return null}w4a(Da,Pa=null){return Da?Pa?`${Da}.${Pa}`:Da:""}mCe(Da,Pa,tb){if(this.hya===Da)return!0;this.hya=Da;let Ib=null,Yb=!1;if(!Ib&&this.zf)for(let vc=0,Zc=this.zf.length;vc<Zc;vc++)if(1===this.zf[vc].controlType&&Kd.a.equals(this.zf[vc].sU,Da,!0)){let nd=!1,hd=!1;Pa?(nd=!0,hd=!!this.zf[vc].wl.SharedRuntime&&Kd.a.equals(this.zf[vc].wl.SharedRuntime.Resid,Pa.Resid,!0)):tb&&(nd=!0,hd=Kd.a.equals(this.zf[vc].wl.SharedRuntimeId,tb,!0));if(!nd||hd){hd&&this.zf[vc].vg(!0);Ib=this.zf[vc].controlId;
Yb=!0;this.hya=null;break}}Ib&&this.raiseEvent("ca",Ib);return Yb}setAppRuntimeState(Da,Pa){var tb;if(Da){const Ib=this.An(Da);if(Ib&&Ma.HelperMethods.Iw(Ib.wl))Ib.vg(Pa),Pa&&(this.raiseEvent("ca",Da),(null===(tb=Ib.Hy)||void 0===tb?0:tb.firstChild)&&(Da=Ib.Hy.firstChild.title)&&0<Da.length&&this.G1b.pvj(Da));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(we.a.instance.ga(2240));}else throw e.ULS.sendTraceTag(537170564,0,15,
"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(we.a.instance.ga(2241));}getAppRuntimeState(Da){if(Da)if((Da=this.An(Da))&&Ma.HelperMethods.Iw(Da.wl))Da=Da.wl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(we.a.instance.ga(2240));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(we.a.instance.ga(2241));return Da}T3a(Da,Pa){return(Da=
this.An(Da))?Da.T3a(Pa):null}Z6a(Da){return this.oCe(this.grc,Da)}lhc(Da){return this.oCe(this.jKe,Da)}tpe(Da){this.jKe.push(Da)}IZ(Da){return(Da=this.An(Da))?Da.wl:null}tBd(Da){this.raiseEvent("ekros",Da,this)}ZEd(Da){if(Da){var Pa=this.An(Da.InstanceId);Pa&&(Da.SharedRuntime||Da.SharedRuntimeId||(this.uRa(Pa.controlId),this.Wh.purgeOsfControl(Pa.controlId,!1)),Pa={},Pa.SolutionId=Da.PrimaryMarketplace.SolutionId,Pa.TargetType=Da.WebExtensionType,Pa.Version=Da.PrimaryMarketplace.SolutionVersion,
Pa.StoreType=Da.PrimaryMarketplace.MarketplaceType,Pa.StoreId=Da.PrimaryMarketplace.MarketplaceRef,ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Da.AssetMarketplace?(Pa.AssetId=Da.AssetMarketplace.SolutionId,Pa.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(Pa.AssetId=null,Pa.AssetStoreId=null):(Pa.AssetId=Da.PrimaryMarketplace.SolutionId,Pa.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef),Pa.Width=Da.TaskpaneWidth,Pa.SharedRuntimeId=Da.SharedRuntimeId,
this.efg(Pa))}}cja(){this.hi.cja()}fN(Da,Pa,tb){this.hi.fN(Da,Pa,tb)}eYe(Da,Pa){Pa=Zb.jgh(Pa);Da=this.IZ(Da);this.hi.Kac(Da.InstanceId,2202,ya.a.aX,Pa)}Ucd(Da){for(let Pa=0,tb=this.zf.length;Pa<tb;Pa++)this.eYe(this.zf[Pa].controlId,Da)}AIh(Da,Pa){Pa=Zb.xbh(Pa);this.hi.Kac(Da,65539,"",Pa)}CIh(Da,Pa,tb){this.hi.Kac(Da,1,Pa,tb)}zIh(Da,Pa){this.hi.DIh(Da,Pa)}Pah(Da,Pa){return[[2,1E3,"",JSON.stringify([Da,Pa]),0,!1]]}nmi(){return!!this.Nna&&this.Nna.paf()}E4g(){this.Nna&&this.Nna.clear()}BIh(){if(this.Nna&&
this.Nna.paf()){var Da=this.Nna.POh();for(const Pa of Da){Da=this.KHh(Pa);for(const tb of Da)this.hi.Kac(tb,65540,"","{}")}}}Xej(Da){this.Nna.add(Da)}zXj(Da){this.Nna.remove(Da)}uja(Da){if(!this.zf)return null;for(const Pa of this.zf)if(Da(Pa))return Pa;return null}$He(Da){const Pa=new ka.a,tb=Zb.Nva(Da,this.$);if(Ma.HelperMethods.Iw(Da))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.YLf(Da,Ib=>{Ib?(Da.InstanceId=Ib.InstanceId,Da.WebExtensionOsfControlType=
3,Da.TaskpaneVisible=!1,this.SIa(Da),Pa.setResult(Da.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.PrimaryMarketplace.SolutionId,Da.PrimaryMarketplace.MarketplaceType,null,null,null,Da.PrimaryMarketplace.MarketplaceRef)} failed`),Pa.setException(Error.create("Null insert data")))});else{Zb.k2a.ia(Da.InstanceId,new M.a);const Ib=Zb.k2a.oa(Da.InstanceId).Pia;this.xch(Da,Ib,tb);this.YLf(Da,null);Pa.setResult(Da.InstanceId)}return Pa.task}xch(Da,
Pa,tb){this.An(Da.InstanceId)||(Da=new Lb(this,this.hi,Da),Da.iua=tb,Da.nef(Pa),this.zf.push(Da),this.hya=null)}YLf(Da,Pa){const tb=Zb.Nva(Da,this.$);if(!this.BGd.contains(tb))this.KHb.push(Da),1<=this.KHb.length&&this.ZLf(Da,Pa);else if(Pa)for(const Ib of this.aMf)if(Zb.Nva(Ib,this.$)===tb){Pa(Ib,0);break}}ZLf(Da,Pa){let tb=null;const Ib={};Ib.SolutionId=Zb.getSolutionId(Da,this.$);Ib.TargetType=Da.WebExtensionType;Ib.Version=Da.PrimaryMarketplace.SolutionVersion;Ib.StoreType=Da.PrimaryMarketplace.MarketplaceType;
Ib.StoreId=Da.PrimaryMarketplace.MarketplaceRef;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Da.AssetMarketplace?(Ib.AssetId=Da.AssetMarketplace.SolutionId,Ib.AssetStoreId=Da.AssetMarketplace.MarketplaceRef):(Ib.AssetId=null,Ib.AssetStoreId=null):(Ib.AssetId=Da.PrimaryMarketplace.SolutionId,Ib.AssetStoreId=Da.PrimaryMarketplace.MarketplaceRef);Ib.Width=Da.TaskpaneWidth;Ib.ContainsCustomFunctions=!0;Ma.HelperMethods.Iw(Da)&&(Ib.SharedRuntimeId=Da.SharedRuntime.Resid);
const Yb=this.$.pa.ya;Da=this.$.pa.ya.Wb();const vc=Yb.Na(9,Da);vc.sharedInfo=Ib;const Zc=hd=>{hd=rd.a.Oe(hd.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Wd.a.sc(hd)}`)},nd=hd=>{hd&&!Dd.a(hd)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.SolutionId,Ib.StoreType,Ib.AssetId,null,null,Ib.StoreId)} finish with errors: ${Wd.a.sc(hd.Errors)}`);
this.KHb.shift();0<this.KHb.length&&this.ZLf(this.KHb[0],Pa)};if(Pa){const hd=Ud=>{const ee=Ud.Result;(tb=ee?ee.AgaveData:null)||Pa(null,Ud.Errors?Ud.Errors[0].ErrorCause:5001);Pa(tb,0)};Da=(Ud,ee,ec)=>Ke.g(Yb,"InsertAgaveTaskpane",vc,We.b(Ud,nd,hd),We.a(ee,Zc),ec,null,0)}else Da=(hd,Ud,ee)=>Ke.g(Yb,"InsertAgaveTaskpane",vc,We.b(hd,nd),We.a(Ud,Zc),ee,null,0);Jd.a(this.$.userOperationManager,Da,hd=>new De.a(519,0,hd,64),null)}YEj(){return this.$.he.get(35)}VLd(Da){Da=this.An(Da);(null===Da||void 0===
Da?0:Da.aea)&&Da.LUf()}ILi(Da){var Pa=this.uja(tb=>Zb.jNa(tb.sU));Pa&&(Pa=this.Wh.getOsfControl(Pa.controlId))&&Pa.notifyAgave(OSF.AgaveHostAction.SendMessage,Da)}bni(){return!!this.uja(Da=>1===Da.controlType&&Zb.jNa(Da.sU))}ani(){const Da=this.uja(Pa=>Zb.jNa(Pa.sU));return Da?Da.Hy?pa.DOMElementExtensions.isVisible(Da.Hy):!1:!1}Dyj(){const Da=this.uja(Pa=>Zb.jNa(Pa.sU));Da&&(Da.vg(!0),this.raiseEvent("ca",Da.controlId))}initialize(){const {DdaEventDispatch:Da}=a(1364),Pa=void 0===this.$||null===
this.$||ua.EwaSettings.ma(257);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Pa&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(dd.rHa(this.$),this.ea=this.$.ea,this.hi=new Da(this.$),this.$.nl(this.ed),this.ea.Tj(this.Tc),this.ea.zM(this.Oo),this.ea.mu(this.yf),this.$.userOperationManager.xr(this.HR),this.mqf(),this.eWi(),this.nhi(),this.$.da.Ga(35,
this),this.oYc.ka(this),Pa&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.rje=new ya.a,Pa&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.uje=new Qa(this.$,this.kj,this.hi),new pb(this.$,this.kj,this.hi),this.sje=new ta(this.$,this.kj,this.hi),this.qje=new hc(this.$,this.kj,this.hi),this.pje=new Ra(this.$,this.kj,this.hi),this.tje=new Bc(this.$,this.kj,this.hi),this.vje=new Ea(this.$,this.kj,this.hi),this.wje=
new xb(this.$,this.kj,this.hi),this.$.JV&&(this.xje=new Ub(this.$,this.kj,this.hi)),ua.EwaSettings.ma(188)&&(this.r2a=new Xa(this,sa.h(this.$))),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.oje=new ac),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}vIh(Da){if(!this.$Ca)return null;for(let Pa=0,tb=this.$Ca.length;Pa<tb;Pa++)if(Da.startsWith(this.$Ca[Pa].WebExtensionId))return this.$Ca[Pa];return null}mqf(){var Da,
Pa=this.ea;if(Pa.Zb&&!this.yRb){if(Pa.workbookContext){if(this.kVc=this.$.ea.Vg.get(22),null===(Da=Pa.workbookContext.WebExtensions)||void 0===Da?0:Da.length){Da=Pa.workbookContext.WebExtensions;Pa=!1;for(let tb=Da.length-1;0<=tb;tb--){if(!this.ea.isNamedObjectViewMode){this.grc.push(Da[tb].InstanceId);if(1!==Da[tb].WebExtensionType){Da.splice(tb,1);continue}if(Ma.HelperMethods.Iw(Da[tb])&&0!==Da[tb].SharedRuntime.State)1===Da[tb].SharedRuntime.State?Da[tb].TaskpaneVisible=!1:2===Da[tb].SharedRuntime.State?
Da[tb].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Da[tb].ContainsCustomFunctions&&!Da[tb].TaskpaneVisible&&!za.a(Da[tb])){Da.splice(tb,1);continue}}const Ib=OSF.OsfControl.isFirstPartyStoreString(Da[tb].PrimaryMarketplace.MarketplaceType);if(ua.EwaSettings.ma(184)&&!Ib&&(Da.splice(tb,1),!Pa)){Pa=!0;const Yb=Cb.GetServiceTaskFactory.Oa(this.$.da,5,4,3);eb.TaskExtensions.Aa(Yb,()=>{Yb.result.kg(36,null)},this.la,3)}ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
Da[tb].PrimaryMarketplace&&Zb.jNa(Da[tb].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Da.splice(tb,1))}this.wHe(Da)}}else this.kVc=!1;this.yRb=!0}}O9e(Da){const Pa=sa.h(this.$),tb=Pa.ha.Ra.$b;if(tb&&Da){Da=!1;if(this.zf)for(const Ib of this.zf)if(Zb.jNa(Ib.sU)||Zb.mqi(Ib.sU)){Da=!0;break}Da||Pa.ha.Ra.zH(tb)}}eWi(){this.Wh&&this.ea.isNamedObjectViewMode&&this.$.na&&Vb.o(this.$.na)&&(this.$.da.za(34).dR?this.$.da.za(34).dod():
this.$.da.za(34).mv(this.n1i))}wHe(Da){let Pa=null;Pa=tb=>{const Ib=tb.WebExtensionData,Yb=tb.IsTaskPane,vc=tb.RecordHandler,Zc=()=>{this.rQa.shift();0<this.rQa.length&&Pa(this.rQa[0])};if(this.Taa(Ib.PrimaryMarketplace.SolutionId))Zc();else{Yb&&(Ib.WebExtensionOsfControlType=1);var nd=za.a(Ib);if(!Yb||Ib.TaskpaneVisible||nd||Ib.SharedRuntime&&0!==Ib.SharedRuntime.State||Ib.ContainsCustomFunctions){var hd=new Lb(this,this.hi,Ib,!Yb);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.PrimaryMarketplace.SolutionId,
Ib.PrimaryMarketplace.MarketplaceType,null,null,null,Ib.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ib.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ma.HelperMethods.Iw(Ib)}`);hd.Qnd();Ma.HelperMethods.Iw(Ib)&&(hd.iua=Zb.Nva(Ib,this.$),Ib.TaskpaneWidth=this.L7b);nd&&(Ib.WebExtensionToolTip="");Yb&&Ib.TaskpaneVisible&&!nd&&(Ib.TaskpaneWidth=this.L7b);this.zf.push(hd);var Ud=this.hya=null;Ud=bf.a.instance.eD(()=>{hd.Hy&&(ca.a.Ia(Ud),Ud=null,vc&&vc(tb,hd),Zc())},100,cc.a.Gjh)}else Zc()}};
for(let tb=0;tb<Da.length;tb++)if(!this.An(Da[tb].InstanceId))if(1!==Da[tb].WebExtensionType)this.SIa(Da[tb]);else if(!ua.EwaSettings.ma(53))this.Gnb(Da[tb],Pa);else if(this.$.rd&8388608||Da[tb].TaskpaneVisible){const Ib={};ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(Ib.solutionId=Da[tb].PrimaryMarketplace.SolutionId,Ib.version=Da[tb].PrimaryMarketplace.SolutionVersion);Ib.marketplaceId=Da[tb].PrimaryMarketplace.SolutionId;Ib.marketplaceVersion=Da[tb].PrimaryMarketplace.SolutionVersion;
Ib.storeType=Da[tb].PrimaryMarketplace.MarketplaceType;Ib.storeId=Da[tb].PrimaryMarketplace.MarketplaceRef;Ib.targetData=Da[tb];this.Wh.isAddinCommandsAsync(Ib,(Yb,vc,Zc)=>{if(Yb){var nd=Zc.targetData;if(vc){if(ua.EwaSettings.ma(87))if(Ib.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Yb=Ib.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),vc=Ib.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Yb||vc)&&Ma.HelperMethods.Iw(nd)&&this.Gnb(nd,
Pa);else if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.I$h(Zc,Pa);else{let hd=!1;this.Ada(Ud=>{if(!Ud.errorCode){if(Ud.value)for(const ee of Ud.value){if(hd)break;hd=Ae.e(ee[1])===Ae.e(nd.PrimaryMarketplace.SolutionId)}hd?Ma.HelperMethods.Iw(nd)&&this.Gnb(nd,Pa):(Ud={},ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ud.SolutionId=Zc.solutionId,Ud.Version=Zc.version):(Ud.SolutionId=Zc.marketplaceId,
Ud.Version=Zc.marketplaceVersion),Ud.StoreType=nd.PrimaryMarketplace.MarketplaceType,Ud.StoreId=Zc.storeId,ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ud.AssetId=null,Ud.AssetStoreId=null):(Ud.AssetId=Zc.marketplaceId,Ud.AssetStoreId=Zc.storeId),Ud.Width=nd.TaskpaneWidth,Ud.TargetType=nd.WebExtensionType,nd.TaskpaneVisible=!0,this.foe(Ud,nd,Pa))}},!0)}}else this.Gnb(nd,Pa)}else Yb=Zc.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.PrimaryMarketplace.SolutionId,
Yb.PrimaryMarketplace.MarketplaceType,null,null,null,Yb.PrimaryMarketplace.MarketplaceRef)} from ${Yb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}I$h(Da,Pa){let tb=!1;this.Ada(Ib=>{const Yb=Da.targetData;if(!Ib.errorCode){if(Ib.value)for(const vc of Ib.value){if(tb)break;tb=Ae.e(vc[1])===Ae.e(Yb.PrimaryMarketplace.SolutionId)}tb?Ma.HelperMethods.Iw(Yb)&&this.Gnb(Yb,Pa):(Ib={},ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ib.SolutionId=
Da.solutionId,Ib.Version=Da.version):(Ib.SolutionId=Da.marketplaceId,Ib.Version=Da.marketplaceVersion),Ib.StoreType=Yb.PrimaryMarketplace.MarketplaceType,Ib.StoreId=Da.storeId,ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ib.AssetId=null,Ib.AssetStoreId=null):(Ib.AssetId=Da.marketplaceId,Ib.AssetStoreId=Da.storeId),Ib.TargetType=Yb.WebExtensionType,Ib.Width=Yb.TaskpaneWidth,Yb.TaskpaneVisible=!0,this.foe(Ib,Yb,Pa))}},!0)}Gnb(Da,Pa){const tb={};tb.WebExtensionData=
Da;tb.IsTaskPane=!0;this.rQa.push(tb);1===this.rQa.length&&Pa(tb)}foe(Da,Pa,tb){const Ib={};Ib.ActivationInfo=Da;Ib.WebExtensionData=Pa;Ib.IsTaskPane=!1;Ib.RecordHandler=(Yb,vc)=>{const Zc=Yb.ActivationInfo;this.Wh.insertBlankControlWithErrorUX(this.jIb(vc,Zc),()=>{this.uRa(vc.controlId);this.Wh.purgeOsfControl(vc.controlId,!1);this.efg(Zc)})};this.rQa.push(Ib);1===this.rQa.length&&tb(Ib)}efg(Da){var Pa={};Pa.solutionId=Da.SolutionId;Pa.version=Da.Version;Pa.storeType=Da.StoreType;Pa.storeId=Da.StoreId;
Pa.assetId=Da.AssetId;Pa.assetStoreId=Da.AssetStoreId;Pa.targetType=Da.TargetType;Pa.sharedRuntimeId=Da.SharedRuntimeId;Da=new Ka.a;Da.add(Pa);Pa={};Pa[W.a.Gob]=Da;Pa[W.a.NP]=3;Da=new rb.a(Oe.a.bDb,0,this.$.Hc,0,null);this.$.Ka.Lb(Da,Pa)}jIb(Da,Pa){const tb={};tb.div=Da.Hy;tb.id=Da.controlId;tb.solutionId=Pa.SolutionId;tb.version=Pa.Version;tb.storeId=Pa.StoreId;tb.storeType=Pa.StoreType;tb.osfControlType=OSF.OsfControlTarget.TaskPane;return tb}zYf(){if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const tb=
[];for(var Da=0;Da<this.zf.length;Da++){var Pa=this.zf[Da];0!==Pa.osfControlType&&3!==Pa.osfControlType&&4!==Pa.osfControlType||tb.push(Pa)}Da=!1;for(Pa=0;Pa<tb.length;Pa++){const Ib=tb[Pa];this.uRa(Ib.controlId);!Da&&Ib&&Ib.wl&&(Da=Ma.HelperMethods.Iw(Ib.wl))}Da&&this.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}ua.EwaSettings.ma(396)&&eb.TaskExtensions.Aa(Cb.GetServiceTaskFactory.Oa(this.$.da,278,279,3),tb=>{tb&&(tb=tb.result)&&(this.$.da.za(278)||this.$.da.Ga(278,tb),tb.wff().Sna())},
this.la,3)}wL(){var Da=new mb(this.$,this.kj,this.DZf);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ua.EwaSettings.ma(257)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.kj||null===this.kj));if(Da.yKi()){const Pa=()=>{},tb=Yb=>{Yb=rd.a.Oe(Yb.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Wd.a.sc(Yb)}.`)},
Ib=Da.fZg();Da=Zb.Rhd(Ib);Da|=64;this.$.userOperationManager.pD(new De.a(507,0,(Yb,vc,Zc)=>Ke.g(this.$.pa.ya,"ExecuteRichApiRequest",this.gZg(Ib),We.b(Yb,Pa),We.a(vc,tb),Zc,null,0),Da))}}gZg(Da){const Pa=this.$.pa.ya.Na(1);Pa.request=Da;return Pa}oCe(Da,Pa){if(Da)for(let tb=0;tb<Da.length;tb++)if(Kd.a.equals(Da[tb],Pa,!0))return!0;return!1}iYg(Da){const Pa={};Pa.navigationMode=OSF.OsfNavigationMode.DefaultMode;Pa.assetId=null;Pa.category=null;if(!Da||3>Da.length)return Pa;if(Da[0]){const tb=parseInt(Da[0],
10);isNaN(parseInt(tb,10))||(Pa.navigationMode=tb)}Da[1]&&(Pa.assetId=Da[1]);Da[2]&&(Pa.category=Da[2]);return Pa}nhi(){if(ua.EwaSettings.ma(61)){var Da=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Da&&"*"!==Da.trim()){this.RJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new bb(this),Da,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.he.get(2));try{this.RJa.init()}catch(Pa){try{this.RJa.dispose()}catch(tb){}this.RJa=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Pa.message)}Da={};Da.a=this.$.va.UserSessionId;le.b().Pe(39,Da)}}}i8f(Da,Pa,tb){const Ib=Zb.vXg(Da[0]),Yb=Ib.Rha,vc=Ib.Ria;Ib.Rha=()=>{Yb&&Yb();const Zc=Ib.LMa!==OSF.InfoType.Error?Pa:null;Da.shift();Da.length?this.i8f(Da,Zc,tb):Zc&&Zc()};Ib.Ria=()=>{vc&&vc();tb&&Ib.LMa!==OSF.InfoType.Error&&tb()};S.a.WUd(Ib)}AXh(){const Da={};Da.AddinRibbonControlsOverriddenByApi=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
Da.AddinActionDefinitionHybridMode=ua.EwaSettings.ma(631).toString();Da.UseActionIdForUILessCommand=ua.EwaSettings.ma(634).toString();Da.AllowStorageAccessByUserActivationOnIFrame=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Da.RequirementSetRibbonApiOnePointTwo=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Da.flightingTreatmentVariables=r.AFrameworkApplication.fa.Sac;
Da.ShortcutInfoArrayInUserPreferenceData=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return Da}static get I5b(){return Zb.e8d}static set I5b(Da){Zb.e8d=Da}static getSolutionId(Da){let Pa=Da.PrimaryMarketplace.SolutionId;ua.EwaSettings.ma(289)&&Da.OwnerAddinSolutionId&&(Pa=Da.OwnerAddinSolutionId);return Pa}static Rhd(Da){let Pa=0;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Da.RequestFlags&1&&256!==
(Da.RequestFlags&256)||(Pa=16):Pa=Da.RequestFlags&1?0:16;return Pa}static Nva(Da,Pa){Pa=Zb.getSolutionId(Da,Pa);return Zb.W1e(Pa,Da.PrimaryMarketplace.SolutionVersion,Da.PrimaryMarketplace.MarketplaceType,Da.PrimaryMarketplace.MarketplaceRef)}static jgh(Da){return JSON.stringify({["recording"]:Da})}static xbh(Da){const Pa={};Pa.visibility=Da?"Visible":"Hidden";return JSON.stringify(Pa)}static tTh(Da){let Pa=Da.getSolutionId(),tb=Da.getVersion(),Ib=Da.getStoreType();Da=Da.getStoreId();return Zb.W1e(Pa,
tb,Ib,Da)}static W1e(Da,Pa,tb,Ib){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Da,Pa,Zb.I4h(tb).toString(),Ib)}static $jd(Da,Pa){var tb=Da.split("|");if(7>tb.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==tb[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${tb[0]}'.`),null;let Ib=tb[1];const Yb=tb[2],vc=Zb.J4h(tb[3]),Zc=tb[4];tb=
tb[5];Ib&&Ib.length||(Ib=tb);tb={};tb.InstanceId=String.format("{{{0}}}",P.a.create().toString());tb.WebExtensionOsfControlType=4;tb.WebExtensionType=1;tb.PrimaryMarketplace={};tb.PrimaryMarketplace.SolutionId=Ib;tb.PrimaryMarketplace.SolutionVersion=Yb;tb.PrimaryMarketplace.MarketplaceRef=Zc;tb.PrimaryMarketplace.MarketplaceType=vc;tb.ContainsCustomFunctions=Pa?!0:!1;Pa&&(tb.OsfPropertyBag=[["customFunctionAddinId",Da]]);return tb}static J4h(Da){Da=parseInt(Da,10);return Da===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:Da===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Da===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Da===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Da===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Da===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Da===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Da===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Da===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Da===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Da===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static I4h(Da){return Da===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Da===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Da===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Da===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Da===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Da===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Da===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Da===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Da===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Da===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Da===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Qsb(Da){const Pa={};Pa.Version=Da.version;Pa.AssetId=Da.assetId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Pa.AssetStoreId=Da.assetStoreId:Pa.AssetStoreId=null!==Da.assetStoreId?
Da.assetStoreId.toString():null;Pa.StoreType=Da.storeType;Pa.Height=Da.height;Pa.SolutionId=Da.solutionId;Pa.StoreId=Da.storeId;Pa.TargetType=Da.targetType;Pa.Width=1===Pa.TargetType?0:Da.width;Pa.SharedRuntimeId=Da.sharedRuntimeId;return Pa}static CAb(Da){return Da===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Da===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Da===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Da===
OSF.DDA.EventDispId.dispidRichApiMessageEvent||Da===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Da===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Da===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static vXg(Da){return Object(b.a)(new kf.a,{LMa:Da.infoType,id:Da.id,title:Da.title,description:Da.description,buttonText:Da.buttonTxt,Rha:Da.buttonCallback,Nfc:Da.highPriority,Ria:Da.dismissCallback,errorCode:Da.errorCode,udf:Da.iframeNotificationUrl})}static jNa(Da){let Pa=
"FA000000014"===Da;Pa||(Pa="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Da);return Pa}static mqi(Da){return"FA000000005"===Da}}Zb.k2a=new G.a;Zb.e8d=!0;Object(c.a)(Zb,"DdaFacade",Oa.a,[218,771,705,772,773,2])},738:function(u,D,a){a.d(D,"a",function(){return e});u=a(0);var c=a(15),b=a(111);class e{constructor(){this.rLd=0;this.LW={};this.Jta={}}a0h(f,d){return this.LW[e.g0c(f,d)]}JPe(f,d){d||void 0!==this.Jta[f]&&null!==this.Jta[f]?d&&void 0!==this.Jta[f]&&null!==this.Jta[f]&&delete this.Jta[f]:
this.Jta[f]=1}z1b(f){return void 0===this.Jta[f]||null===this.Jta[f]}L9h(f){const d=e.g0c(f.messageType,f.targetId);1===f.actionType?this.iai(f.controlId,f.messageType,d):2===f.actionType&&this.Wai(f.controlId,f.messageType,d)}Lhj(f){if(f){var d=Object.keys(this.LW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.LW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.LW[h])}}s_(f,d){f=e.g0c(f,d);f=this.LW[f];return!!f&&0<Object.keys(f).length}Tbi(){return!b.a.isEmpty(this.LW)}Emf(){return 0<
this.rLd}nVh(){const f=[],d=this.LW;for(let l in d){var h=l,m=d[l];for(let v in m){m=v;const t={};t.eventType=parseInt(h.split("#")[0],10);t.targetId=h.split("#")[1];t.addinId=m;f.push(t)}}return f}iai(f,d,h){if(this.LW[h])h=this.LW[h],h[f]=h[f]?h[f]+1:1;else{let m={};m[f]=1;this.LW[h]=m}100===d&&this.rLd++}Wai(f,d,h){if(this.LW[h]){const m=this.LW[h];if(f){const l=m[f];1===l?(delete m[f],Object.keys(m).length||delete this.LW[h]):m[f]=l-1;100===d&&this.rLd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static g0c(f,d){return String.format("{0}#{1}",f,d)}}e.aX="Workbook";Object(u.a)(e,"RichApiEventRegistration",null,[])},765:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=
f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(u.a)(c,"DdaEventArgs",null,[])},812:function(u,D,a){u=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(u.a)(c,"AddInDataTransferObject",null,[]);a.d(D,"a",function(){return b});class b{constructor(e,f,d){this.jSb=e;this.tsg=f;this.usg=d}get kt(){return this.jSb}get lJg(){return this.tsg}get mJg(){return this.usg}static t4a(e){return(e=e.gW)?Object.assign(new c,{tabs:e.kt.toArray(),
id:e.lJg,title:e.mJg}):null}}Object(u.a)(b,"OneLineRibbonExtensibility",null,[])},844:function(u,D,a){a.r(D);u=a(0);var c=a(187),b=a(15),e=a(98);class f{constructor(){this.startTime=0;this.callback=null}}Object(u.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(u.a)(d,"AccessTokenInformation",null,[103]);var h=a(961);class m{constructor(){this.token=null;this.expiresOn=0;this.Eha=this.authChallenge=null}}Object(u.a)(m,"CachedTokenInfo",null,[]);class l{constructor(){this.NSb=
new c.a;this.u$=this.t$=!1;this.$oa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Rse=null}get callbacks(){return this.NSb}}Object(u.a)(l,"SSORequestInfo",null,[]);class v extends l{constructor(){super();this.errorCode=0}}Object(u.a)(v,"SSOFailedRequestInfo",l,[]);var t=a(4);class z{constructor(L,X,P,G){this.sT=new c.a;this.YG=new c.a;this.bqa=null;this.dmb=new c.a;this.Xde=Promise.resolve(null);this.fle=!1;this.CXb=X;this.d8d=L;this.RTc=P;this.ysg=G}ZFj(L){if(this.bqa&&this.bqa.authChallenge===
L.authChallenge){if(Date.now()/1E3+z.WGi>this.bqa.expiresOn)return this.bqa=null,!1;L=new h.a;L.token=this.bqa.token;L.expiresOn=this.bqa.expiresOn;L.Eha=this.bqa.Eha;L.GUa=!0;L.Rxb=0;this.jyb(L);return!0}return!1}CEj(L){for(let X=0;X<this.YG.count;X++)if(this.YG.oa(X).authChallenge===L.authChallenge&&this.YG.oa(X).$oa===L.$oa){let P;(P=this.YG.oa(X)).retryCount=P.retryCount+1;L.retryCount=this.YG.oa(X).retryCount;if(this.YG.oa(X).retryCount<z.uHi||!this.YG.oa(X).t$&&L.t$||!this.YG.oa(X).u$&&L.u$){if(!this.YG.oa(X).t$&&
L.t$||!this.YG.oa(X).u$&&L.u$)L.retryCount=0;this.YG.removeAt(X);break}L=new h.a;L.errorCode=this.YG.oa(X).errorCode;this.jyb(L);return!0}return!1}eLg(L,X){for(let P=0;P<this.YG.count;P++)if(this.YG.oa(P).$oa===L.$oa&&this.YG.oa(P).authChallenge===L.authChallenge)return;this.YG.add(Object.assign(new v,{t$:L.t$,u$:L.u$,authChallenge:L.authChallenge,$oa:L.$oa,errorCode:X,retryCount:L.retryCount}))}get resource(){return this.CXb}Ped(L,X,P,G,C,H){const {AppsForOfficeSingleSignOnManager:J}=a(844);""===
P&&(P=null);if(this.fle)J.p6(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var M=null;for(let S of this.sT)if(S.t$===L&&S.u$===X&&S.authChallenge===P&&S.$oa===C){M=S;break}M||(M=Object.assign(new l,{t$:L,u$:X,authChallenge:P,Rse:G,$oa:C,retryCount:0,startTime:J.Ew()}),this.sT.add(M));M.retryCount=0;M.callbacks.add(H);this.Xde=this.Xde.then(()=>{var {AppsForOfficeSingleSignOnManager:S}=a(844);if(0<this.sT.count){var W=this.sT.oa(0);if(this.ZFj(W)||this.CEj(W))return null;
for(let T=0;T<this.dmb.count;)this.dmb.oa(T)+z.uRj<S.Ew()?this.dmb.removeAt(T):T++;if(this.dmb.count>=z.qHi||this.sT.count>=z.SGi)return W=new h.a,W.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.jyb(W),null;let O=null;t.AFrameworkApplication.sa&&(S=t.AFrameworkApplication.sa.mE)&&(O=S.Ac("ComponentAttach",this.d8d+z.EEg));return W.$oa.FVc(this.d8d,this.resource,W.t$,W.u$,W.authChallenge,this.RTc,this.ysg,W.Rse).then(T=>{O&&O.stop();this.jyb(T)},()=>{O&&O.stop();const T=new h.a;
T.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.jyb(T)})}return null})}}jyb(L){const {AppsForOfficeSingleSignOnManager:X}=a(844);try{if(this.sT.count){var P=this.sT.oa(0);this.sT.removeAt(0);var G=null;L.errorCode||(G=new d,G.accessToken=L.token);L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&L.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.eLg(P,L.errorCode);var C={};null!=L.Rxb&&(C.getTokenSilentTime=L.Rxb.toString());null!=L.Ejd&&(C.getTokenPopupTime=L.Ejd.toString());null!=L.chd&&(C.getIDTokenTime=L.chd.toString());null!=L.GUa&&(C.tokenCached=L.GUa.toString());L.UYd&&(C.detailedError=L.UYd);L.Eha&&(C.authLibrary=L.Eha);P.retryCount&&(C.retryCount=P.retryCount);for(var H of P.callbacks)X.p6(H,L.errorCode,G,C);null!=L.GUa&&L.GUa||this.dmb.add(P.startTime);if(!L.errorCode)for(null!=L.expiresOn&&(this.bqa=Object.assign(new m,{token:L.token,
expiresOn:L.expiresOn,authChallenge:P.authChallenge,Eha:L.Eha})),this.YG.clear(),H=0;H<this.sT.count;)if(this.sT.oa(H).authChallenge===P.authChallenge){for(let J of this.sT.oa(H).callbacks)X.p6(J,L.errorCode,G,C);this.sT.removeAt(H)}else H++}}catch(J){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",J.message)}}shutdown(){this.fle=!0;this.sT.clear()}}z.uRj=6E4;z.qHi=6;z.SGi=6;z.uHi=3;z.WGi=300;z.EEg="GetAccessToken";Object(u.a)(z,"SSOCallbackManager",null,[]);
var r=a(718),n=a(729),w=a(120),B=a(80),A=a(27),y=a(30),x=a(147),F=a(344);a.d(D,"AppsForOfficeSingleSignOnManager",function(){return I});class I{constructor(L,X,P=null){this.LGc=new e.a;const G=new c.a;X&&G.add(X.xFi);P&&G.addRange(P);this.Km=L;this.FFg=G}Qed(L,X,P,G,C,H,J,M,S,W){W=Object.assign(new f,{startTime:I.Ew(),callback:W});try{const Y=!!P&&""!==P;var O=W.startTime;const va=this.getOsfControl(L);let ca=va.getStoreType()||"",V=va.getOwnerAddinStoreType()||"",ra=va.getSolutionId()||"";const N=
va.getVersion()||"";ca=ca.toLowerCase();V=V.toLowerCase();ra=ra.toLowerCase();var T=B.a.bhd(X)||"";const ea=B.a.bhd(va.getIframeUrl())||"",Ba=T.toLowerCase()===ea.toLowerCase();T=ca;"inmemory"===ca&&(T=V);const ka=Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,T,va.getAssetId(),null,null,va.getStoreId());let Ka;Ka=t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?{["callInstanceId"]:O.toString(),["controlSolutionId"]:ka,["controlVersion"]:N,
["storeType"]:ca,["ownerStoreType"]:V,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:C.toString(),["allowSignInPrompt"]:H.toString(),["hasAddinAuthChallenge"]:Y.toString(),["securityOriginEqualsSourceLocation"]:Ba.toString(),["singleSignOnEnabled"]:J.toString(),["accountTypeFilter"]:M||""}:{["callInstanceId"]:O.toString(),["controlAssetId"]:ka,["controlVersion"]:N,["storeType"]:ca,["ownerStoreType"]:V,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:C.toString(),["allowSignInPrompt"]:H.toString(),
["hasAddinAuthChallenge"]:Y.toString(),["securityOriginEqualsSourceLocation"]:Ba.toString(),["singleSignOnEnabled"]:J.toString(),["accountTypeFilter"]:M||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ka);x.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:w.a.Vj(Ka)}));O=!0;const Oa=t.AFrameworkApplication.fa.Xa("HostAuthType");switch(M){case "aad":O="aad"===Oa;break;case "msa":O="msa"===Oa;break;default:O=!M||"noFilter"===M}if(O){M=
null;if(J)for(let wa of this.FFg)if(wa.Hoi(ra)){M=wa;break}M?this.isSSOAddin(L)?(J=!0,"omex"===T&&(J=!1),"spapp"===T||"spcatalog"===T?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):C&&!J?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(C&&"exchange"===T&&(G=!1),this.Ped(L,X,P,T,G,H,S,M,W))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Y){this.amc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
Y.message),I.p6(W,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(L,X,P,G){this.Qed(L,P[r.a.YXc]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,X,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,G)}Ped(L,X,P,G,C,H,J,M,S){this.LGc.lb(L)?G=this.LGc.oa(L):(G=new z(L,this.getWebApplicationResource(L).split(",")[0],G,this.getDefaultDisplayName(L)),this.LGc.add(L,G));const W=G.resource;L=I.H2h(W,this.getWebApplicationId(L));const O=OfficeExt.WACUtils.getHostSecure(X);L&&O?L.toLowerCase()===O.toLowerCase()?G.Ped(C,H,P,J,M,S):(I.QOa('SSO Resource "'+W+'" cannot be used from "'+X+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),I.p6(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(L||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),O||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),I.p6(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}amc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(L){return this.Km.getOsfControl(L)}isSSOAddin(L){return this.getOsfControl(L).getManifest().isSSOAddin()}getWebApplicationId(L){return this.getOsfControl(L).getManifest().getWebApplicationId()}getWebApplicationResource(L){return this.getOsfControl(L).getManifest().getWebApplicationResource()}getDefaultDisplayName(L){return this.getOsfControl(L).getManifest().getDefaultDisplayName()}static l4h(){try{const L=
{};A.a.aya&&n.a.bzb&&(L.UiHostSupportsAuthTokenAddinList=I.nYe);L.UiHostSupportsAuthToken=n.a.bzb;return L}catch(L){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",L.message)}return null}static getInstance(L,X,P=null){I.Ma||(I.Ma=new I(L,P));return I.Ma}static QOa(L){window.console.warn&&window.console.warn(L)}static H2h(L,X){if(!L)return"";X||(X="");let P=L.toLowerCase();var G=X.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(G)||
(I.QOa('SSO App Id "'+X+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));P.endsWith(G)||(I.QOa('SSO Resource "'+L+'" does not end with App Id "'+X+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!P.startsWith("https://")&&!P.startsWith("api://"))return I.QOa('SSO Resource "'+L+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(X=0;X<L.length;X++){G=L.charAt(X);const C=y.a.charCodeAt(L,X);if(33>C||126<C||"&"===G||"?"===G||"#"===G||"%"===G||"\\"===G)return I.QOa('SSO Resource "'+L+'" contains an invalid character "'+G+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+G+"' in resource URI."),""}if(0<=L.indexOf("::"))return I.QOa('SSO Resource "'+L+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
L.length)return I.QOa('SSO Resource "'+L+'" is '+L.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+L.length+"."),"";P.startsWith("api://")&&(P="https://"+P.substring(6,P.length));return 8===P.length?"":OfficeExt.WACUtils.getHostSecure(P)||""}static p6(L,X,P,G){var C=L.startTime;let H=0;0<C&&(H=I.Ew()-C);C={["callInstanceId"]:C.toString(),["callDuration"]:H.toString(),["errorCode"]:X.toString()};if(G)for(let J in G)C[J]=
G[J];b.ULS.sendTraceTag(51401116,344,50,"{0}",C);x.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:w.a.Vj(C)}));L.callback(X,P)}static Ew(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(L){}return Date.now()}}I.nYe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");I.Ma=null;Object(u.a)(I,
"AppsForOfficeSingleSignOnManager",null,[77])},861:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);var c=a(13);class b{constructor(){this.KVe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.JVe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1626),c.a.instance.ga(1630)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1627),c.a.instance.ga(1631)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1628),c.a.instance.ga(1632)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1629),c.a.instance.ga(1633)]};this.J$b=null}get wia(){return"SourceControlId"}get uN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}AZh(){if(!this.J$b){this.J$b={};for(const e of Object.keys(this.KVe))this.J$b[e]=this.KVe[e];for(const e of Object.keys(this.JVe))this.J$b[e]=this.JVe[e][0]}}}Object(u.a)(b,"AddinCommandsStringProvider",null,[789])},863:function(u,D,a){a.d(D,"a",function(){return c});
u=a(0);class c{constructor(){this.LMa=0;this.Rha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Nfc=!1;this.udf=this.Ria=null}}Object(u.a)(c,"AddInCommandsNotificationParameters",null,[])},933:function(u,D,a){u=a(0);var c=a(15),b=a(84),e=a(152),f=a(14),d=a(86);class h extends Sys.UI.Control{constructor(G,C,H,J){super(document.createElement("div"));this.$S=this.YS=this.Zv=this.TG=this.$G=this.Xpa=this.yra=null;this.Pjb=this.Nqa=!1;this.content=this.Xp=null;this.E1=0;
this.Gxe=null;this.aU=0;this.oIf=null;this.dme=G;this.ohe=C;this.AP=H;this.TJ=J;this.ig=C.ownerDocument;this.lfc=this.Jt=this.hkb=!1}get kW(){this.yra||(this.yra=this.ig.createElement("div"),this.yra.id=this.mi("WACCalloutOuter"),this.yra.className="WACCalloutOuter",this.yra.setAttribute(d.a.Ld,d.a.z_a),this.yra.style.width=this.E1+"px");return this.yra}get $pb(){if(!this.Xpa){this.Xpa=this.ig.createElement("div");this.Xpa.id=this.mi("WACCalloutBeakContainer");this.Xpa.className="WACCalloutBeakContainer";
var G="CalloutBeakTopFilled_32x16x32";if(5===this.aU||6===this.aU||4===this.aU)G="CalloutBeakBottomFilled_32x16x32";G=e.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.Xpa.appendChild(G)}return this.Xpa}set $pb(G){this.Xpa=G}get qNa(){return this.hkb}get title(){return this.Xp}set title(G){this.Xp!==G&&(this.Xp=G,this.YS&&(this.YS.innerText=this.Xp))}get Jt(){return this.Nqa}set Jt(G){this.Nqa!==G&&(this.Nqa=G,this.$G&&(this.$G.contains(this.Zv)&&!this.Nqa?this.$G.removeChild(this.Zv):!this.$G.contains(this.Zv)&&
this.Nqa&&this.npe()))}get lfc(){return this.Pjb}set lfc(G){this.Pjb!==G&&(this.Pjb=G,this.$G&&(this.$G.contains(this.YS)&&!this.Pjb?this.$G.removeChild(this.YS):!this.$G.contains(this.YS)&&this.Pjb&&this.Fqe()))}show(){this.hkb||(this.Qch(),this.wo(),this.ohe.appendChild(this.kW),this.kW.style.display="Block",this.ABj(),this.hkb=!0,this.oIf&&this.oIf())}dismiss(){this.hkb&&(this.z2a(),this.ohe.removeChild(this.kW),this.hkb=!1,this.TJ&&this.TJ())}dispose(){this.dismiss();this.YS=this.Zv=this.TG=this.Xpa=
this.$G=this.yra=null;Sys.Component.prototype.dispose.call(this)}mi(G){return this.get_element().id+G}Qch(){this.$G=this.ig.createElement("div");this.$G.id=this.mi("WACCalloutHeader");this.$G.className="WACCalloutHeader";this.Jt&&this.npe();this.lfc&&this.Fqe();this.TG=this.ig.createElement("div");this.TG.id=this.mi("WACCalloutContent");this.TG.className="WACCalloutContent";this.TG.style.width=190<this.E1?this.E1-26+"px":"164px";this.TG.appendChild(this.content);this.kW.appendChild(this.$pb);this.kW.appendChild(this.$G);
this.kW.appendChild(this.TG)}npe(){this.Zv=this.ig.createElement("a");this.Zv.className="WACCalloutCloseAnchor";this.Zv.id=this.mi("WACCalloutCloseAnchor");this.Zv.href="#";this.$G.appendChild(this.Zv);const G=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Zv.appendChild(G)}Fqe(){this.YS=this.ig.createElement("div");this.YS.className="WACCalloutTitle UIFontBold";this.YS.style.width=190<this.E1?this.E1-30+"px":"160px";this.YS.id=
this.mi("WACCalloutTitle");this.YS.innerText=this.title;this.$G.contains(this.Zv)?this.$G.insertBefore(this.YS,this.Zv):this.$G.appendChild(this.YS)}ABj(){var G=this.dme;let C;if(1===this.aU){var H=this.Gxe.y+16;C=-16}else 2===this.aU||3===this.aU||0===this.aU?(H=G.y+G.height+15,C=-15):(H=G.y-this.kW.clientHeight-15-2,C=this.kW.clientHeight-1);this.kW.style.top=H+"px";this.$pb.style.top=C+"px";1===this.aU?(G=this.Gxe.x-16,this.kW.style.left="50%",this.kW.style.marginLeft=-this.E1/2+"px",H=Sys.UI.DomElement.getBounds(this.kW),
this.$pb.style.left=G-H.x+"px"):(H=G.x+this.dme.width/2,2===this.aU||5===this.aU?(G=20,H-=36):0===this.aU||4===this.aU?(G=this.E1/2-16,H-=this.E1/2):(G=this.E1-20-32,H=H-this.E1+36),this.kW.style.left=H+"px",this.$pb.style.left=G+"px")}wo(){this.Jt&&!this.$S&&(this.$S=Object(b.a)(this,this.X$,"closeHandler"),this.AP.ta(f.a.click,this.Zv,this.$S,null))}z2a(){this.Jt&&this.$S&&(this.AP.Ba(f.a.click,this.Zv,this.$S),this.$S=null)}X$(){this.dismiss();return!0}}Object(u.a)(h,"Callout",Sys.UI.Control,[76]);
class m extends h{constructor(G,C,H,J,M,S=null){super(G,H,M.uX,S);this.wfe=0;this.E1=this.FZh(J);this.$Ya=C;this.ef=M;this.vSj=7;this.zl=this.$Ya.ownerDocument.createElement("div");this.zl.className="ModalCalloutControlOverlay";this.zl.tabIndex=0;this.$Ya.insertBefore(this.zl,this.$Ya.firstChild)}show(){this.qNa||(this.ef.Csc(),this.ef.YP(!1),this.zl.style.zIndex=String(this.ef.J2),super.show(),this.Kj(),this.wfe=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.vSj))}dismiss(){this.qNa&&
(this.ef.aN(!1),this.$j(),this.$Ya&&this.$Ya.contains(this.zl)&&this.$Ya.removeChild(this.zl),super.dismiss(),window.clearTimeout(this.wfe))}Kj(){this.ef.Csa(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Yy.ta(f.a.click,this.zl,Object(b.a)(this,this.hd,"onClick"))}$j(){this.ef.Jcb(Object(b.a)(this,this.dismiss,"dismiss"));this.ef.Yy.Ba(f.a.click,this.zl,Object(b.a)(this,this.hd,"onClick"))}hd(){this.dismiss();return!0}FZh(G){let C=0;switch(G){case 0:C=190;break;case 1:C=250;break;case 2:C=300;
break;case 3:C=360}return C}}Object(u.a)(m,"ModalCallout",h,[]);var l=a(462),v=a(172);class t extends m{constructor(G,C,H,J,M,S=null){super(G,C,H,J,M,S);this.sWb=null}show(){if(!this.qNa){const G=Object.assign(new l.a,{onShow:()=>{m.prototype.show.call(this)}});v.UISurfaces.QH().then(C=>{const H=C.externalNotification();this.sWb=C.addNotification(H,G);return null},C=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",C);return null})}}dismiss(){this.qNa&&this.sWb&&(v.UISurfaces.QH().then(G=>
{G.removeNotification(this.sWb);return this.sWb=null},G=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(u.a)(t,"ReactManagedModalCallout",m,[]);var z=a(4);class r{static Deh(G,C,H){return z.AFrameworkApplication.sa.Pa.iR?new t(G,C,H,3,z.AFrameworkApplication.sa,null):new m(G,C,H,3,z.AFrameworkApplication.sa,null)}}Object(u.a)(r,"ModalCalloutControlFactory",null,[]);var n=a(54),w=a(859),B=a(581),A=a(860),y=a(134),x=a(56),F=a(40),
I=a(83),L=a(812),X=a(693);a.d(D,"a",function(){return P});class P{static get G1b(){return P.wfa||(P.wfa=I.a.instance.Jh("Common.Utils.IAriaNotifier"))}static DHe(G,C,H,J){P.zJ&&P.zJ.qNa&&P.zJ.dismiss();P.zJ=r.Deh(C,G,G);P.zJ.content=H;X.b(J)||(P.zJ.title=J,P.zJ.lfc=!0);G=new Sys.UI.Bounds(0,0,x.a.kec(),x.a.jec());P.zJ.aU=P.bRh(G,C,P.zJ.E1);P.zJ.show();P.G1b&&P.G1b.sendNotification(H.innerText,!0)}static y5c(G,C,H,J=null){v.UISurfaces.QH().then(M=>{let S=null;P.amb&&(M.removeNotification(P.amb),P.amb=
null);const W=M.callout(Object.assign(new w.a,{target:G,title:C,content:H,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new A.a,{onDismiss:()=>{M.removeNotification(S)},directionalHint:null!=J?J:null})})),O=Object.assign(new l.a,{expirationOptions:Object.assign(new B.a,{displayTimeoutSeconds:7,onExpire:()=>{M.removeNotification(P.amb)}})});S=P.amb=M.addNotification(W,O);return null},M=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
M);return null})}static UUd(G,C=null){P.zJ&&P.zJ.qNa&&P.zJ.dismiss();const H=new y.StandardDialog;H.CTa=!1;H.Rb=0;H.jA(n.a.Gyi,CommonUIStrings.l_DialogError,X.b(G)?P.e2e():G,C)}static WUd(G){P.zJ&&P.zJ.qNa&&P.zJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));const C=X.b(G.description)?P.e2e():G.description,H=new y.StandardDialog;let J=null;G.Rha?(H.Rb=1,H.oc(1,G.buttonText),H.V0(1)):H.Rb=0;J=M=>{1===M?G.Rha():G.Ria&&G.Ria()};
H.CTa=!1;0===G.LMa?H.jA(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,C,J):1===G.LMa?H.oX(G.title?G.title:CommonUIStrings.l_DialogWarning,C,J):H.JBa(G.title?G.title:CommonUIStrings.l_DialogInfo,C,J)}static bRh(G,C,H){let J=4;const M=G.x+G.width-C.x-C.width;C.x-G.x+C.width/2<=H/2?J=5:M+C.width/2<=H/2&&(J=6);return J}static HHj(G,C,H,J=!1){(C=L.a.t4a(C))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(C,M=>{M&&(J||P.y5c(M,
H,G,5))})}static IHj(G,C,H=!1){P.HHj(C.startedNode?C.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),C,C.startedNode?C.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),H)}static GHj(G,C,H,J){if(P.ckg)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,H,J,CommonUIStrings.l_InsertionDialogRefresh)),P.y5c(C,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{C=
F.a.yp(C);var M=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),S=document.createElement("span");S.innerText=M[0];var W=document.createElement("span");W.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,H,J,CommonUIStrings.l_InsertionDialogRefresh);W.className="UIFontBold";H=document.createElement("span");H.innerText=M[1];J=document.createElement("div");Sys.UI.DomElement.addCssClass(J,"ModalCalloutControl");J.appendChild(S);J.appendChild(W);J.appendChild(H);
P.DHe(G,C,J,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static $Ij(G,C){var H=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,J=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;P.ckg?P.y5c(C,H,J):(C=F.a.yp(C),P.DHe(G,C,P.MZg(J),H))}static MZg(G){const C=document.createElement("div");Sys.UI.DomElement.addCssClass(C,"ModalCalloutControl");C.innerText=G;return C}static e2e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get ckg(){return z.AFrameworkApplication.sa.Pa.Oi&&
z.AFrameworkApplication.sa.Pa.iR}}P.zJ=null;P.amb=null;P.wfa=null;Object(u.a)(P,"AddInCommandsNotificationFactory",null,[])},943:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(1464),e=a(147),f=a(120),d=a(718),h=a(731),m=a(344);class l{constructor(n,w,B,A){this.HA=!1;this._id=n;this.Ax=w;this.W1=B;this.Hd=A}get enabled(){return this.HA}set enabled(n){const {DynamicRibbon:w}=a(943);var B=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,y=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ax,B,null,null,null,A);B={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,B,y,null,null,A),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Button",["toggle"]:n};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:w.VBc+"ControlUpdate",dataFields:f.a.Vj(B)}));this.HA=n;this.W1.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.Ax,["PrivacyCompliantSolutionId"]:x,
["SourceControlId"]:this.id,["MethodData"]:this.HA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(n){switch(n){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n,
w){switch(n){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertySetAsync(n,w){this.invokePropertySet(n,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n,w){switch(n){case 5:return this.kyj(w);case 1:return this.nDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,w){n=this.invokeMethod(n,
w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}kyj(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");this.setEnabled(n);return null}nDa(){this._OnAccess();return null}}Object(u.a)(l,"RibbonButton",null,[]);class v{constructor(n,w,B,A){this._id=n;this.Ax=w;this.W1=B;this.Hd=A}get id(){return this._id}setVisibility(n){const {DynamicRibbon:w}=a(943),B=this.Hd.OwnerAddinStoreType;var A=this.Hd.PrimaryMarketplace.MarketplaceRef;const y=this.Hd.AssetMarketplace?
this.Hd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ax,B,y,null,null,A);A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,B,y,null,null,A),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Tab",["toggle"]:n};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:w.VBc+"ControlUpdate",dataFields:f.a.Vj(A)}));this.W1.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.Ax,
["PrivacyCompliantSolutionId"]:x,["StoreType"]:B,["SourceControlId"]:this.id,["MethodData"]:n})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(n){switch(n){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
}invokePropertySetAsync(n,w){this.invokePropertySet(n,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n,w){switch(n){case 3:return this.dCj(w);case 1:return this.nDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,w){n=this.invokeMethod(n,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}dCj(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");this.setVisibility(n);
return null}nDa(){this._OnAccess();return null}}Object(u.a)(v,"RibbonTab",null,[]);var t=a(966),z=a(185);a.d(D,"DynamicRibbon",function(){return r});class r{constructor(n,w,B,A,y){this.Ax=n;this.tJ=B;this.W1=A;this.Hd=y;this.uib=this.tJ.Wh;this.ez=this.uib.getOsfControl(w);this.sAg=this.ez.getManifest()}get buttons(){return null}executeRequestCreate(n){try{var w=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,y=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:
null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ax,w,y,null,null,A);const x={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,w,y,null,null,A),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:r.VBc+"ExecuteRequestCreate",dataFields:f.a.Vj(x)}));const F=z.a.li(n);n={};w={};w[d.a.LJa]=this.ez;w[d.a.MJa]=F;w[d.a.E9c]=this.Hd;n[d.a.gub]=
3;n[d.a.j4]=this.Ax;n[d.a.m9b]=B;n[d.a.i4]=w;this.W1.CK(-1014260128,n);let I=r.Gbc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,I)}catch(A){B=r.Gbc("ExecuteRequestCreate",!1,A.toString()),c.ULS.sendTraceTag(538572825,0,50,B)}return null}executeRequestUpdate(n){try{var w=this.Hd.OwnerAddinStoreType;const A=this.Hd.PrimaryMarketplace.MarketplaceRef,y=this.Hd.AssetMarketplace?this.Hd.AssetMarketplace.SolutionId:null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ax,w,y,null,
null,A);const x={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Hd.OwnerAddinSolutionId,w,y,null,null,A),["ownerAddinStoreType"]:this.Hd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:r.VBc+"ExecuteRequestUpdate",dataFields:f.a.Vj(x)}));const F=z.a.li(n);n={};w={};w[d.a.LJa]=this.ez;w[d.a.MJa]=F;w[d.a.E9c]=this.Hd;n[d.a.gub]=3;n[d.a.j4]=this.Ax;n[d.a.m9b]=B;n[d.a.i4]=w;this.W1.CK(-1014260128,
n);let I=r.Gbc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,I)}catch(A){B=r.Gbc("ExecuteRequestUpdate",!1,A.toString()),c.ULS.sendTraceTag(538572823,0,50,B)}return null}getButton(n){let w=null;if(!this.Vhf())return this.FHe();if(n&&0<n.length){if(!this.ACe(n))return this.YHe(n);w=new l(n,this.Ax,this.W1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)}getTab(n){let w=null;if(!this.Vhf())return this.FHe();if(this.ez.getOwnerAddinControlRecreated())return this.Qdh();
if(n&&0<n.length){if(!this.ACe(n))return this.YHe(n);w=new v(n,this.Ax,this.W1,this.Hd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(n){switch(n){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokePropertyGetAsync(n){n=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}invokePropertySet(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);
}invokePropertySetAsync(n,w){this.invokePropertySet(n,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(n){switch(n){case 1:return this.nDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);}invokeMethodAsync(n,w){switch(n){case 7:return this.OEh(w);case 6:return this.PEh(w);case 3:return this.IQh(w);case 5:return this.h5h(w)}n=this.invokeMethod(n,w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}OEh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,
0,"string");return this.executeRequestCreate(n)}PEh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.executeRequestUpdate(n)}IQh(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getButton(n)}h5h(n){n=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getTab(n)}nDa(){this._OnAccess();return null}YHe(n){return t.a(h.a.p$g,z.a.ga(1760)+n)}FHe(){return t.a(h.a.jqj,z.a.ga(1756))}Qdh(){return t.a(h.a.hostRestartNeeded,
z.a.ga(1761))}Vhf(){var n=this.ez.getSharedRuntimeId();n=!!n&&0<n.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",n));return n}ACe(n){const w=this.sAg.getRibbonExtensionControlMap();return n in w||this.y3g(n)}y3g(n){var w=this.lIh();if(w){w=w.GOe;for(const B of w.tabs){if(B.id===n)return!0;for(const A of B.groups)for(const y of A.controls){if(y.id===n)return!0;if("Menu"===y.type){w=y;for(const x of w.items)if(x.id===n)return!0}}}}return!1}lIh(){return b.a.getInstance().sja(this.Hd.PrimaryMarketplace.MarketplaceType,
this.Hd.PrimaryMarketplace.SolutionId,1)}static Gbc(n,w,B){const A={};A.methodName="DynamicRibbon."+n;A.result=w?"Succeeded":"Failed";A.message=B;return z.a.hc(A)}}r.VBc="Office.Online.Extensibility.Ribbon.";Object(u.a)(r,"DynamicRibbon",null,[])},953:function(u,D,a){a.d(D,"a",function(){return b});var c=a(954);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},960:function(u,D,a){a.d(D,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},961:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Eha=this.GUa=this.chd=this.Ejd=this.Rxb=this.UYd=null}}Object(u.a)(c,"AppsForOfficeOauthResult",null,[])},966:function(u,D,a){a.d(D,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/6f7f61b29b155ecc9a2cccfd51037899/EwaDSEsNext.agave.js.map