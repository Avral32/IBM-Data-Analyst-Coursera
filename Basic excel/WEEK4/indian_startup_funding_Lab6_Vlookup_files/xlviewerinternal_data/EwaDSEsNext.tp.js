'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1446:function(u,D,a){a.r(D);var c=a(0),b=a(511),e=a(48),f=a(9),d=a(53),h=a(87),m=a(55),l=a(82),v=a(222),t=a(417),z=a(37),r=a(7),n=a(15),w=a(85),B=a(83),A=a(224),y=a(14),x=a(107),F=a(4),I=a(86),L=a(147),X=a(120),P=a(573),G=a(94),C=a(732),H=a(5),J=a(721),M=a(132),S=a(371),W=a(188),O=a(283),T=a(33),Y=a(247),va=a(564),ca=a(12),V=a(1),ra=a(11),N=a(13),ea=a(21),Ba=a(133),ka=a(152),Ka=a(344),Oa=a(682),wa=a(553),qa=
a(19);const aa=qa.a.Ead;class ia extends G.a{constructor(Vb,Ac,Kc,dd){super(Vb);this.tte='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.V0b=null;this.Wmd=this.Wdg=!1;this.Xae=this.wj=this.nf=null;this.wq=0;this.button=null;this.lPf=!1;this.yec="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=Vd=>{if(void 0!==Vd.Ca&&null!==Vd.Ca&&Vd.Ca.keyCode===w.a.rA)if(Vd.Ca.shiftKey){if(!T.a.gd(this.$)){Vd=this.$.da.za(183);if(!Vd)return!1;Vd.VRd()}}else this.gg(!0,
!1),Vd.Ca.preventDefault(),Vd.Ca.stopPropagation();return!0};this.dqc=(Vd,Jd)=>{Object.getType(Jd)===String&&Jd.toString()===this.nf.InstanceId&&(Vd=!!this.title,Jd=!this.Wmd,Vd&&this.DPe(),this.hgg(),T.a.gd(this.$)&&(Vd&&this.Wdg||Jd&&this.Wmd)&&this.m8.updateTaskPane(this.j1,this.eC))};this.Dma=()=>{var Vd;V.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.wj.VLd(this.nf.InstanceId);const Jd=va.a(this.nf);if(Jd)if(this.nf.TaskpaneTitle===N.a.instance.ga(979))n.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.nf.PrimaryMarketplace)if("FA000000005"===this.nf.PrimaryMarketplace.SolutionId){n.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let oe="Unknown",De="Unknown",Ke="Unknown";null===(Vd=this.nf.OsfPropertyBag)||void 0===Vd?void 0:Vd.forEach(rd=>{2===rd.length&&("LaunchMode"===rd[0]?oe=rd[1]:"CorrelationId"===rd[0]?De=rd[1]:"LaunchSelectionMode"===rd[0]&&(Ke=rd[1]))});Vd={["LaunchMode"]:oe,["CorrelationId"]:De,["LaunchSelectionMode"]:Ke,["Location"]:"taskPane"};
Ba.b(this.$).Gd(M.a.c6g,Vd,void 0,!0);'"Default"'===oe?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(rd=>{rd.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===oe?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(rd=>{rd.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===oe&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(rd=>
{rd.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===oe&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&B.a.instance.Ub("Common.ISystemInitiatedFeedback").execute(rd=>{rd.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else T.a.uli()&&"FA000000043"===this.nf.PrimaryMarketplace.SolutionId?"Record Actions"===this.nf.TaskpaneTitle&&(this.$.Zba=!1,n.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.nf.PrimaryMarketplace.SolutionId===P.a?this.Mrf(!1):V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)&&"FA000000075"===this.nf.PrimaryMarketplace.SolutionId&&(Vd=this.$.da.za(465))&&Vd.uNe();ra.HelperMethods.Iw(this.nf)?this.vg(!1):(T.a.gd(this.$)?this.m8.hideTaskPane(this.j1):this.raiseEvent("AgavePaneRemovedEventKey"),this.wj.uRa(this.nf.InstanceId),
T.a.gd(this.$)||this.m8.pA());ea.h(this.$).setFocus();if(1===this.nf.WebExtensionOsfControlType&&!Jd){this.nf.TaskpaneVisible=!1;const oe=this.$.pa.ya.Wb();S.a(this.$.userOperationManager,(De,Ke,rd)=>O.c(this.$.pa.ya,this.nf.InstanceId,!1,De,Ke,rd,oe),De=>new W.a(547,0,De,64),null)}return!0};this.HFf=(Vd,Jd)=>{Object.getType(Jd)===String&&Jd.toString()===this.nf.InstanceId&&(T.a.gd(this.$)?this.m8.hideTaskPane(this.j1):this.raiseEvent("AgavePaneRemovedEventKey"))};this.GFf=(Vd,Jd)=>{Object.getType(Jd)===
String&&Jd.toString()===this.nf.InstanceId&&(this.I_d(),T.a.gd(this.$)?this.e7():this.m8.qG(this,!0))};this.onResize=()=>{this.I$c()};this.$=Ac;this.m8=Kc;V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&dd?dd.sk(this.domElement,String.format(this.tte,aa,this.$.Eb+H.a.qYc,this.$.Eb+H.a.pYc)):this.domElement.innerHTML=String.format(this.tte,aa,this.$.Eb+H.a.qYc,this.$.Eb+H.a.pYc);
this.Gsg=ca.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+H.a.pYc);this.Gsa=ca.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+H.a.qYc);V.EwaSettings.ma(417)&&(this.V0b=ca.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));Vb=ca.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");this.Voa=this.Vbh();Vb.appendChild(this.Voa);A.a.instance.ta(y.a.click,this.Voa,this.Dma);this.Jkc=x.KeyInputManager.instance.Ms(this.Voa,
this.Dma,w.a.Sh);T.a.gd(this.$)||x.KeyInputManager.instance.ta(y.a.Ob,this.Voa,this.onCloseButtonTabKeyDown);ca.DOMElementExtensions.setVisible(this.Gsa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.I$c();this.$&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&this.domElement.classList.add(C.a.ESe);this.$.VA(this.onResize)}MP(Vb){this.addHandler("AgavePaneRemovedEventKey",Vb)}$R(Vb){this.removeHandler("AgavePaneRemovedEventKey",
Vb)}GLg(Vb){this.addHandler("AgavePaneReadyKey",Vb)}Jij(Vb){this.removeHandler("AgavePaneReadyKey",Vb)}get dHa(){return this.Gsg}get ih(){return 6}get dl(){return this.nf.TaskpaneIconCssClass||""}get vN(){return this.nf.TaskpaneButtonTooltip||this.nf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.Xae}get Lp(){return this.nf.TaskpaneWidth}get isResizable(){const Vb=Ac=>{var Kc,dd;return(null===(dd=null===(Kc=this.nf)||void 0===Kc?void 0:Kc.PrimaryMarketplace)||void 0===dd?void 0:dd.SolutionId)===
Ac};return!OSF.OsfControl.isFirstPartyStoreString(this.nf.PrimaryMarketplace.MarketplaceType)&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||Vb("FA000000043")||Vb("FA000000054")||V.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&Vb("FA000000005")||V.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&Vb("FA000000050")?!0:!1}get de(){return Y.a.rQg}get mc(){return this.domElement}get Ff(){return!!this.nf}get title(){return this.wj.TTh(this.nf.InstanceId)}get titleText(){return this.title}get f_a(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.nf.InstanceId}get j1(){return"AgaveTaskPane-"+
this.instanceId.replace(RegExp("[{}]","g"),"")}get eC(){const Vb=this.m8.Kva(this.mc,this.titleText,this.Lp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Lp,void 0,this.iconUrl,this.nf.TaskpaneIconId,ra.HelperMethods.Iw(this.nf));if(V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.nf.SrcLocationOverrideResourceId===this.yec){Vb.contentProps.type="OcvFeedbackTaskPaneProps";Vb.hideHeader=
!1;let Ac=JSON.parse(this.nf.OsfPropertyBag[0][1]);Vb.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:Ac,taskPaneLocation:Vb.location,taskPaneIdToClose:this.j1}}return Vb}startEdit(){return!0}$Ac(){return!0}oof(){this.wj.Wh.notifyAgave(this.nf.InstanceId,OSF.AgaveHostAction.TabIn)}pof(){this.wj.Wh.notifyAgave(this.nf.InstanceId,OSF.AgaveHostAction.TabInShift)}HDd(){this.wj.nXc(this.HFf);this.wj.mMg(this.GFf);let Vb=this.wj.Yfd(this.nf.InstanceId);this.title&&Vb||this.wj.pMg(this.dqc);
this.title&&this.DPe();this.raiseEvent("AgavePaneReadyKey");T.a.gd(this.$)&&(""!==this.dl?d.a.Ge(10):d.a.current.io(102),this.dig(),V.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&T.a.gd(this.$)&&ra.HelperMethods.Iw(this.nf)&&this.nf.Preload&&!this.nf.TaskpaneVisible?this.B6b():this.e7())}B6b(){this.m8.B6b(this.j1,this.eC)}e7(){this.m8.e7(this.j1,this.eC)}dispose(){var Vb,Ac;this.lPf||(null===(Ac=null===(Vb=this.nf)||void 0===Vb?void 0:Vb.PrimaryMarketplace)||void 0===
Ac?void 0:Ac.SolutionId)!==P.a||this.Mrf(!0);A.a.instance.Ba(y.a.click,this.Voa,this.Dma);x.KeyInputManager.instance.Vv(this.Voa,this.Jkc);T.a.gd(this.$)||x.KeyInputManager.instance.Ba(y.a.Ob,this.Voa,this.onCloseButtonTabKeyDown);this.wj&&(this.wj.mjj(this.dqc),this.wj.kjj(this.HFf),this.wj.jjj(this.GFf),this.$&&(this.$.bE(this.onResize),this.$=null));this.$=this.nf=null;super.dispose()}dig(){this.nf&&this.hgg()}JR(Vb){Vb||this.I_d()}vg(Vb){if(this.nf){const Ac=this.nf.TaskpaneVisible!==Vb;this.nf.TaskpaneVisible=
Vb;T.a.gd(this.$)?Vb||this.m8.hideTaskPane(this.j1):this.m8.pA();ra.HelperMethods.Iw(this.nf)&&Ac&&this.wj.AIh(this.instanceId,Vb)}}nq(){let Vb=!1;this.nf&&this.$.rd&8388608&&(Vb=this.nf.TaskpaneVisible);return Vb}Es(){return!this.nf||OSF.OsfControl.isFirstPartyStoreString(this.nf.PrimaryMarketplace.MarketplaceType)||this.$.c3?ra.HelperMethods.Iw(this.nf)?this.nf.TaskpaneVisible:!!this.nf:!1}gg(Vb,Ac){return Ac?!1:(this.I_d(),this.wj.Wh.notifyAgave(this.nf.InstanceId,Vb?OSF.AgaveHostAction.TabIn:
OSF.AgaveHostAction.TabInShift),!0)}lh(Vb){return ca.DOMElementExtensions.xf(this.mc,Vb)}sj(){}Wj(){}WQ(Vb,Ac){var Kc=Ac.querySelectorAll(ca.DOMElementExtensions.Ir);Ac=ca.DOMElementExtensions.wm(Kc);Kc=ca.DOMElementExtensions.tB(Kc);let dd=!1;Ac===Vb.Gb&&Vb.Ca.shiftKey?((Vb=document.getElementById(this.$.Eb+H.a.doc))&&ca.DOMElementExtensions.isVisible(Vb)?ca.DOMElementExtensions.setFocus(Vb):this.gg(!1,!1),dd=!0):Kc!==Vb.Gb||Vb.Ca.shiftKey||(this.O3f(),dd=!0);return dd}O3f(){this.Voa&&ca.DOMElementExtensions.setFocus(this.Voa)}Vbh(){const Vb=
document.createElement("a");Vb.tabIndex=0;Vb.id="AgaveTaskpaneCloseButtonId";Vb.className=H.a.yfb+(F.AFrameworkApplication.isRtl?H.a.Waa:H.a.Xaa);Vb.title=N.a.instance.ga(10);Vb.setAttribute(I.a.Ld,I.a.ot);Vb.style.borderColor="transparent";V.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?Vb.style.margin="6px 6px 0px 6px":Vb.style.margin="6px";Vb.style.zIndex="2";Vb.style.position="relative";const Ac=document.createElement("span");Ac.className="StandardButtonImage clip16x16 StandardButtonImageNoText";
Ac.id=Vb.id+"-close";const Kc=ka.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,N.a.instance.ga(793));Ac.appendChild(Kc);Vb.appendChild(Ac);return Vb}DPe(){this.Gsa.innerText=this.title;this.Gsa.style.textOverflow="ellipsis";this.Gsa.style.whiteSpace="nowrap";this.Gsa.style.overflowX="hidden";this.nf.TaskpaneTitleCssClass&&(this.Gsa.className=this.Gsa.className+" "+this.nf.TaskpaneTitleCssClass);V.EwaSettings.ma(417)&&(this.V0b.className=this.V0b.className+" "+this.nf.TaskpaneHeaderCssClass);
ca.DOMElementExtensions.setVisible(this.Gsa,!0);this.button&&(this.button.t0a.title=this.title);this.I$c();this.Wdg=!0}hgg(){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.dl&&!T.a.gd(this.$)){if(this.button){var Vb=d.a.Ge(10),Ac=this.button.Fl;Ac.setAttribute("src",Vb);Ac.setAttribute("class",this.dl)}return}}else if(this.dl){this.button&&(Vb=d.a.Ge(10),Ac=this.button.Fl,Ac.setAttribute("src",Vb),Ac.setAttribute("class",this.dl));return}if(Ac=V.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?
this.nf.TaskpaneIconUrl?this.nf.TaskpaneIconUrl:this.wj.Yfd(this.nf.InstanceId):this.wj.Yfd(this.nf.InstanceId))this.$.G5&&this.nf.PrimaryMarketplace&&this.nf.PrimaryMarketplace.SolutionId===J.a.solutionId&&(Ac=this.GXh(Ac)),T.a.gd(this.$)?this.Xae=Ac:(Vb=this.button.Fl,Vb.setAttribute("src",Ac),Ac=d.a.current.io(102),Vb.setAttribute("onerror","this.onerror = null;this.src = '"+Ac+"';")),this.Wmd=!0}GXh(Vb){const Ac=J.a.Hdc(this.$),Kc=J.a.RZ(this.$),dd=J.a.qba(this.$),Vd=J.a.xxb(this.$),Jd=this.nf.SrcLocationOverrideResourceId,
oe=T.a.gd(this.$);return Jd===Ac?oe?Vb.replace("/icon-32.png","/record-tp-20.png"):Vb.replace("/icon-32.png","/record-tp-32.png"):Jd===Kc?oe?Vb.replace("/icon-32.png","/code-tp-20.png"):Vb.replace("/icon-32.png","/code-tp-32.png"):Jd===dd?oe?Vb.replace("/icon-32.png","/rfb-tp-20.png"):Vb.replace("/icon-32.png","/rfb-tp-32.png"):Jd===Vd?oe?Vb.replace("/icon-32.png","/flowconnector-tp-20.png"):Vb.replace("/icon-32.png","/flowconnector-tp-32.png"):Vb}I$c(){this.$&&!V.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
(this.dHa.style.height=ra.HelperMethods.uc(this.m8.YO.offsetHeight-this.V0b.offsetHeight))}I_d(){this.wj.tBd(this)}Mrf(Vb){Vb={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:Vb.toString()};const Ac=new Oa.a(wa.a.cl());Ac.add("PaneClosedTime",3);Ac.add("IsSessionEnded",1);L.a.sendTelemetryEvent(Object(r.a)(new Ka.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:X.a.Vj(Vb,Ac)}));this.lPf=!0}}Object(c.a)(ia,"AgaveTaskPane",G.a,[39,261,263,326]);var Ha=a(50);class Z extends v.a{constructor(Vb){super();
this.XFd=[];this.WJf=null;this.dzf=Ac=>{this.ob(Object(l.a)(261,Ac))};this.$=Vb;this.Fb()}create(){const Vb=V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?Ha.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):m.Task.Ta(null),Ac=t.a(this.$);z.TaskExtensions.Aa(z.TaskExtensions.Fd([Ac,Vb],this.$.la),()=>{const Kc=new ia(document.createElement("div"),this.$,Ac.result,Vb.result);
this.XFd.push(Kc);Kc.GLg(this.dzf);this.Sa.raiseEvent(v.a.t_c,null,Kc)},this.la,3)}dispose(){for(const Vb of this.XFd)Vb.Jij(this.dzf);h.a.qc(this.XFd);h.a.Ia(this.WJf);this.$=this.WJf=null;super.dispose()}}Object(c.a)(Z,"AgaveTaskPaneFactory",v.a,[]);var la=a(30),Xa=a(238),Za=a(209),xa=a(259),fa=a(60),ua=a(47),sa=a(46),sb=a(324),hb=a(71),bb=a(22),lb=a(285),Fa=a(281);const Na=qa.a.BBh,Mb=`<div class="${qa.a.Ead}"><div title="{0}" class="${qa.a.Kyh}">{0}</div></div><div><div class="${qa.a.Fyh}">{1}</div><div class="${qa.a.Hyh} ${qa.a.rp}" id="parametersSection">&nbsp;</div><div align="bottom" class="${qa.a.Eyh}"><button class="${qa.a.ASe} ${qa.a.Dyh}" id="applyButton" type="submit">{2}</button><button class="${qa.a.ASe}" id="resetButton" type="button">{3}</button></div></div>`,
dc=`<div><div class="${qa.a.Iyh}"><label for="{2}" title="{1}">{0}</label></div><div class="${qa.a.Jyh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class Cb extends Xa.a{constructor(Vb,Ac,Kc,dd){super(Vb);this.sSd=this.EWa=this.l1=null;this.wq=0;this.htmlSanitizationHelper=null;this.UHf=()=>{this.EWa=null};this.iAj=()=>{h.a.Ia(this.sSd);this.sSd=null;this.isVisible!==this.cUd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.W7g=(Vd,Jd)=>bb.a.compare(Vd.Name,Jd.Name,!0);
this.lzf=Vd=>{hb.g(Vd);if(!this.Psa.domElement.classList.contains(qa.a.m$b)){ea.h(this.$).Uo(!0);var Jd=[];for(Vd=0;Vd<this.l1.length;Vd++){const De=this.EWa[Vd],Ke=this.l1[Vd].text;De.Values=[Ke];Ke&&Jd.push(De)}if(Jd.length){var oe=this.$.pa.ya.Wb();this.Psa.addCssClass(qa.a.m$b);this.$.userOperationManager.Kc(new W.a(142,0,(De,Ke,rd)=>fa.F(this.$.pa.ya,Jd,!1,0,!1,Fa.b(De,this.OZi),Fa.a(Ke,this.NZi),rd,null,oe)),null)}}};this.wYi=Vd=>{hb.g(Vd);Vd=this.l1;for(let Jd=0,oe=Vd.length;Jd<oe;Jd++)Vd[Jd].text=
""};this.OZi=()=>{this.Psa.removeCssClass(qa.a.m$b)};this.NZi=()=>{this.Psa.removeCssClass(qa.a.m$b)};this.RGb=(Vd,Jd)=>{13===Jd.charCode&&this.lzf(Jd)};this.$=Ac;this.taskPaneManager=Kc;this.htmlSanitizationHelper=dd;Ac=String.format(Mb,this.titleText,N.a.instance.ga(1323),N.a.instance.ga(1324),N.a.instance.ga(1325));this.htmlSanitizationHelper&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
this.htmlSanitizationHelper.sk(Vb,Ac):Vb.innerHTML=Ac;this.Wab=this.getElementById("parametersSection");this.Psa=new sb.a(this.getElementById("applyButton"));this.Psa.Gc.ka("click",this.lzf);this.XNd=new sb.a(this.getElementById("resetButton"));this.XNd.Gc.ka("click",this.wYi);this.$.ea.Tj(this.UHf);xa.a(this.$).ai(this)}MP(Vb){this.get_events().addHandler("RemoveParamTpEventKey",Vb)}$R(Vb){this.get_events().removeHandler("RemoveParamTpEventKey",Vb)}RE(Vb){this.addHandler("parameterTaskPaneVilibilityChanged",
Vb)}nG(Vb){this.removeHandler("parameterTaskPaneVilibilityChanged",Vb)}get D8b(){this.Ief();return this.EWa}get mc(){return this.domElement}get Lp(){return 250}get isResizable(){return!1}get Ff(){return this.isVisible}get de(){return Y.a.D3i}get ih(){return 2}get dl(){return Na}get vN(){return N.a.instance.ga(1064)}get cUd(){return!!this.D8b&&0<this.D8b.length&&!this.$.isEditMode}get titleText(){return N.a.instance.ga(1322)}get eC(){return this.taskPaneManager.Kva(this.mc,this.titleText,this.Lp,this.isResizable,
()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}vg(Vb){T.a.gd(this.$)&&(Vb?(this.Ief(),this.taskPaneManager.e7("ParametersTaskPane",this.eC)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}nq(){return this.cUd}Es(){return this.cUd}JR(){}dispose(){this.$&&this.$.ea.qk(this.UHf);this.PUf();h.a.qc([this.Psa,this.XNd]);this.EWa=this.Wab=this.$=this.Psa=this.XNd=null;super.dispose()}gg(Vb,Ac){Ac||(this.l1&&0<this.l1.length?this.l1[0]:this.Psa).focus();
return!Ac}lh(Vb){return ca.DOMElementExtensions.xf(this.mc,Vb)}sj(){}Wj(){}WQ(){return!1}Ief(){!this.EWa&&this.$.rd&2048&&this.bUg(this.$.workbookContext.TaskPaneParameters,this.$.va.SlicerParameters)}bUg(Vb,Ac){var Kc=[];this.PUf();if(!this.$.isEditMode&&Vb&&0<Vb.length){var dd=this.W7g;if(Ac&&0<Ac.length){var Vd=new Za.a([...Ac]);Vd.z$.sort(dd)}else Vd=null;for(let oe=0,De=Vb.length;oe<De;oe++){var Jd=Vb[oe];Ac&&!(0>ra.HelperMethods.lw(Vd,0,Vd.gka(),Jd,dd))||Jd.IsPivotPageField||Jd.IsSlicer||Kc.push(Jd)}}this.EWa=
Kc;if(this.Wab&&(this.isVisible!==0<Kc.length&&(this.sSd=ua.a.instance.create(this.iAj,500,sa.a.E3i,!0,!0)),this.htmlSanitizationHelper&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.aZ(this.Wab):this.Wab.innerHTML="",Kc.length)){Ac="";Vb=[];for(let oe=0,De=Kc.length;oe<De;oe++)dd=this.$.Eb+"param"+oe,Vb.push(dd),Jd=Kc[oe],Vd=Jd.Name?la.a.Eg(Jd.Name):
"",Jd=Jd.Comment?la.a.h_(Jd.Comment):"",Ac+=String.format(dc,Vd,Jd,dd);this.htmlSanitizationHelper&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.sk(this.Wab,Ac):this.Wab.innerHTML=Ac;Ac=[];for(let oe=0,De=Kc.length;oe<De;oe++)Kc=new lb.a(document.getElementById(Vb[oe])),Ac.push(Kc),Kc.qNg(this.RGb);this.l1=Ac}}PUf(){if(this.l1){for(let Vb=0,Ac=
this.l1.length;Vb<Ac;Vb++)this.l1[Vb].akj(this.RGb);h.a.qc(this.l1);this.l1=null}}static cUg(Vb,Ac,Kc){const dd=Vb.da;let Vd=dd.za(17);if(!Vd){const Jd=document.getElementById(Vb.Eb+H.a.F3i);Jd&&(Vd=dd.Ga(17,new Cb(Jd,Vb,Ac,Kc)))}return Vd}}Object(c.a)(Cb,"ParametersTaskPane",Xa.a,[132,263,39,2]);class Tb extends v.a{constructor(Vb){super();this.$=Vb;this.Fb()}create(){const Vb=V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
Ha.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):m.Task.Ta(null),Ac=t.a(this.$);z.TaskExtensions.Aa(z.TaskExtensions.Fd([Ac,Vb],this.$.la),()=>{this.ob(Cb.cUg(this.$,Ac.result,Vb.result))},this.la,3)}}Object(c.a)(Tb,"ParametersTaskPaneFactory",v.a,[]);var Jb=a(692),eb=a(183);class za{nc(){return!1}executeCommand(Vb,Ac){Vb=Ac.command;switch(Vb){case 329273335:case 1962240939:case 296943390:case -625072140:return m.Task.Ta(!0);default:return eb.a(Vb)}}wc(Vb,Ac,Kc,dd){if(Vb=!!dd&&2===dd.pz)switch(Ac.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:Vb=!1}return Vb}Jc(){return!1}}Object(c.a)(za,"TaskPaneCommandHandler",null,[165]);class ha extends Jb.a{constructor(Vb){super(Vb)}nd(){this.Yc([new za])}static ka(Vb){Jb.a.Nd(115,new ha(Vb))}}Object(c.a)(ha,"TaskPaneCommandHandlerFactory",Jb.a,[]);var fb=a(1320),rb=a(172);class pa{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(pa,"TaskPaneGroupAppProps",null,[]);var Ma=a(27),Ja=a(38),Ga=a(212);class La{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(La,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var nb=a(292),Lb=a(18),ac=a(16),ib=a(127);class Ra{constructor(Vb){this.width=Vb}}Object(c.a)(Ra,"ActiveTaskPaneData",null,[]);class ya extends Ja.a{constructor(Vb,Ac){super();this.isVisible=!1;
this.OYd=this.Hea=-1;this.JLe=40;this.nh=this.OL=this.animationManager=this.qJc=null;this.pDd=()=>{this.sYf()};this.PBc=new Set;this.PBc.add("FieldListTaskPane");this.PBc.add("PivotTableSettingsTaskPane");this.PBc.add("SlicerSettingsTaskPane");this.jb=Ac;xa.a(this.$).ai(this);this.nA=Vb;this.d$a=this.HYg();T.a.hj(Ac)||F.AFrameworkApplication.sa.Pa.Ye||(this.nA.style.bottom=this.$.rd&4?ra.HelperMethods.uc(this.$.Cea):"0");this.bac={};this.VOb={};this.r5d={};this.LYd=ib.a.instance.Zd(this.mc);this.LYd.ka("focusin",
this.pDd);this.Nii()}get $(){return this.jb}get bha(){return this.r5d}get VM(){return this.qJc}get isCollapsed(){return!this.VM}dispose(){xa.a(this.$).aA(this);const Vb=this.bac;for(let Ac in Vb)({key:Ac,value:Vb[Ac]}).value();this.VOb=this.r5d=this.bac=null;this.LYd.iD();this.d$a=this.nA=this.LYd=null;super.dispose()}Kva(Vb,Ac,Kc,dd,Vd,Jd,oe,De,Ke=ya.Mzi,rd=ya.Lzi,bf=null,cc=null,Wc=!1){const id=Object(r.a)(new La,{getContent:()=>Vb});id.isSharedRuntime=Wc;return Object(r.a)(new fb.a,{hideHeader:!0,
contentProps:id,title:Ac,width:Kc,location:2,onOpen:Vd,onClose:Jd,onShow:oe,onHide:De,iconUrl:bf,iconId:cc,enableResize:dd,minResizeWidth:Ke,maxResizeWidth:rd})}e7(Vb,Ac){rb.UISurfaces.ej().then(Kc=>{Vb in this.bha?Kc.setSelectedTaskPane(Vb):Kc.showTaskPane(Vb,Ac);return null})}B6b(Vb,Ac){rb.UISurfaces.ej().then(Kc=>{Kc.initializeHiddenSharedRuntimeTaskPane(Vb,Ac);const dd=this.$.domElement;dd.addEventListener("scroll",function Jd(){0!=dd.scrollLeft&&(dd.scrollLeft=0,dd.removeEventListener("scroll",
Jd))})})}updateTaskPane(Vb,Ac){rb.UISurfaces.ej().then(Kc=>{Kc.updateTaskPane(Vb,Ac);return null})}setSelectedTaskPane(Vb){rb.UISurfaces.ej().then(Ac=>{Ac.setSelectedTaskPane(Vb);return null})}hideTaskPane(Vb){rb.UISurfaces.ej().then(Ac=>{Ac.hideTaskPane(Vb,ya.xQj);return null})}get mc(){return this.nA}get Ff(){return this.isVisible}get de(){return Y.a.LBc}gg(Vb,Ac){return Ac?!1:(this.q1f(),!0)}lh(Vb){return ca.DOMElementExtensions.xf(this.mc,Vb)}sj(){this.$.frame.Le.tk(this.de)}Wj(){}HYg(){const Vb=
document.createElement(Ga.a.div);Vb.style.height="0px";Vb.style.width="0px";Vb.tabIndex=-1;return Vb}BOh(){var Vb=ca.DOMElementExtensions.getElementById(this.nA,"tabStripFocusZone");if(Vb){Vb=Vb.getElementsByTagName("button");for(let Ac=0;Ac<Vb.length;Ac++)if(Boolean.parse(Vb[Ac].getAttribute("aria-selected")))return Vb[Ac].getAttribute("aria-controls")}return null}y8g(Vb){return(Vb=window.getComputedStyle(Vb,null).getPropertyValue("transition-duration"))?parseInt(Vb.endsWith("ms")?parseFloat(Vb):
1E3*parseFloat(Vb),10):0}tfj(){const Vb=document.getElementById("tabbedTaskPaneContainer");Vb&&Vb.addEventListener("transitionend",()=>this.RHa(-1))}Nii(){rb.UISurfaces.ej().then(Vb=>{let Ac;Vb.renderTaskPaneGroups(null,this.nA,(Ac=new pa,Ac.middleContainer=this.d$a,Ac.onOpen=(Kc,dd)=>{this.isVisible=!0;-1===this.Hea&&(this.Hea=this.y8g(dd));T.a.hj(this.$)||(this.bha[Kc]=new Ra(ca.DOMElementExtensions.fQ(ca.DOMElementExtensions.getElementById(dd,ya.Lcg))))},Ac.onClose=Kc=>{this.isVisible=0<Vb.selectors.getTabbedTaskPaneCount();
n.ULS.sendTraceTag(537014371,0,50,`Closing of ${Kc} TaskPane`);if(!this.isVisible)this.ZYe(),T.a.hj(this.$)||F.AFrameworkApplication.sa.Pa.Ye||window.requestAnimationFrame(()=>{this.O0b(this.d$a)});else if(!T.a.hj(this.$)&&this.VM&&this.VM!==Kc){const dd=1<Vb.selectors.getTabbedTaskPaneCount()?this.Zdc():0,Vd=1===Vb.selectors.getTabbedTaskPaneCount()?-1*this.Zdc():0;this.Zse(Kc,this.VM,dd,Vd)}T.a.hj(this.$)?this.RHa(this.Hea):(F.AFrameworkApplication.sa.Pa.Ye&&0>=this.Hea&&this.RHa(this.Hea),delete this.bha[Kc]);
delete this.VOb[Kc]},Ac.onShow=(Kc,dd)=>{null!=this.di&&(this.di.stop(),this.di=null);this.qJc=Kc;this.sYf();1!==dd&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.yrj()},0)});T.a.hj(this.$)?window.requestAnimationFrame(()=>{this.RHa(this.Hea)}):F.AFrameworkApplication.sa.Pa.Ye&&0>=this.Hea?window.requestAnimationFrame(()=>{this.RHa(this.Hea)}):window.requestAnimationFrame(()=>{this.Ssj(this.d$a,this.Hea)})},Ac.onHide=(Kc,dd,Vd)=>{const Jd=this.BOh();Jd!==Kc&&(this.di=this.$.Jb.Ac("UserAction",
"TaskPaneToggle"),n.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Kc} to ${Jd}`));Vd?T.a.hj(this.$)||this.O0b(this.d$a):!T.a.hj(this.$)&&Jd&&(Kc=1===Object.keys(this.bha).length?this.Zdc():0,this.Zse(this.VM,Jd,this.Zdc(),Kc));this.qJc=null;Vd&&1!==dd&&this.ZYe();T.a.hj(this.$)&&window.requestAnimationFrame(()=>{this.RHa(this.Hea)})},Ac.setFocusCallback=(Kc,dd)=>{dd&&(this.VOb[Kc]=dd)},Ac.onResizeStart=()=>{T.a.hj(this.$)||this.fYc(ra.HelperMethods.uc(0))},Ac.onResizeEnd=()=>{T.a.hj(this.$)?
this.RHa():(this.O0b(this.d$a),this.bha[this.VM]=this.vjd(this.VM));n.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.VM} TaskPane`)},Ac));F.AFrameworkApplication.sa.Pa.Ye&&!T.a.hj(this.$)&&this.tfj();return null})}O0b(Vb){this.fYc(this.$.isChromeRtl?Vb.style.left:Vb.style.right)}fYc(Vb){n.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.VM}`);this.$.moj(Vb)}RHa(Vb=0){-1<Vb?m.Task.delay(Vb+this.JLe).continueWith(()=>{this.$.oAa(nb.a.VZ("ResetContentAreaMargin"))}):
this.$.oAa(nb.a.VZ("ResetContentAreaMargin"))}Zse(Vb,Ac,Kc,dd){Ac=Ac.endsWith(ya.MYd)?Ac.substring(0,Ac.length-ya.MYd.length):Ac;Ac=this.W8e(Ac);dd=Ac+dd;Vb=this.W8e(Vb);dd<Vb&&this.fYc(ra.HelperMethods.uc(Ac+Kc))}Ssj(Vb,Ac){window.setTimeout(()=>{this.O0b(Vb)},Ac+this.JLe)}Zdc(){return-1!==this.OYd?this.OYd:this.OYd=ca.DOMElementExtensions.fQ(ca.DOMElementExtensions.getElementById(this.nA,"tabStripFocusZone"))}vjd(Vb){return ca.DOMElementExtensions.fQ(ca.DOMElementExtensions.getElementById(ca.DOMElementExtensions.getElementById(this.nA,
Vb+ya.MYd),ya.Lcg))}W8e(Vb){if(Vb in this.bha){const Ac=this.bha[Vb].width;return 0<Ac?Ac:this.vjd(Vb)}return Vb?this.vjd(Vb):0}ZYe(){ea.h(this.$).setFocus()}yrj(){if(this.VOb[this.VM]){const Vb=this.VOb[this.VM];Vb&&Vb(null,null)}else this.PBc.has(this.VM)||this.q1f()}q1f(){rb.UISurfaces.ej().then(Vb=>{1<Vb.selectors.getTabbedTaskPaneCount()?Vb.focusTabbedTaskPaneArea():(Vb=ca.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?Vb.focus():(Vb=ca.DOMElementExtensions.wm(this.mc.querySelectorAll("button")))&&
Vb.focus();return null})}sYf(){this.$.domElement.scrollLeft=0;Ma.a.PNa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}RE(Vb){this.addHandler(ya.ehb,Vb)}nG(Vb){this.removeHandler(ya.ehb,Vb)}get YO(){return this.nA}get dC(){n.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}Bsb(Vb,Ac,Kc,dd,Vd){let Jd=Vb.za(Ac);Jd||(Jd=ac.a(Lb.a,Kc,Vb,Ac),Jd.SetScriptLoadFlavor(Vd));
dd&&Jd.iXc(dd);const oe=""+Ac;let De=null;const Ke=()=>{Jd.create();De()};this.bac[oe]=De=()=>{Jd.Quc(Ke);delete this.bac[oe]};Jd.b0b(Ke)}initialize(){n.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}P8f(){}yN(){n.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}qG(){n.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}Eqe(){n.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}RXf(){n.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}Qxb(){n.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}ofd(){n.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}kja(){n.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}pA(){n.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){n.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}VRd(){n.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(Vb){const Ac=
ya.DZg(Vb.Eb,Vb.isChromeRtl,Vb);ya.iUg(Vb,Ac);return new ya(Ac,Vb)}static DZg(Vb,Ac,Kc){const dd=document.createElement("div");dd.id=Vb+H.a.MBc;T.a.hj(Kc)?dd.classList.add(qa.a.r4j):(dd.classList.add(Ac?qa.a.t4j:qa.a.s4j),F.AFrameworkApplication.sa.Pa.Ye&&dd.classList.add(qa.a.hRa));return dd}static iUg(Vb,Ac){Vb.isMobileMode&&Ac.setAttribute("aria-hidden","true");F.AFrameworkApplication.sa.Pa.Ye?document.getElementById("FarPaneRegion").appendChild(Ac):(T.a.hj(Vb)&&Ac.classList.add(qa.a.gvh),document.getElementById(Vb.Eb+
H.a.c1a).insertBefore(Ac,Vb.SBa))}}ya.Mzi=300;ya.Lzi=950;ya.xQj=2;ya.MYd="-panel";ya.Lcg="ExcelTaskPaneContentWrapper";ya.f$f="rtpSizeChanged";ya.LEe="rtpCollapsed";ya.bLf="rtpAdded";ya.ehb="rtpVisibility";Object(c.a)(ya,"ReactTaskPaneManager",Ja.a,[265,39,2]);var Va=a(95),oa=a(156),kb=a(239),Sa=a(416),U=a(84),ta=a(555);class ub extends Sys.EventArgs{constructor(){super()}}Object(c.a)(ub,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var hc=a(45);const Bc=C.a.fyh,Qa=C.a.hyh,na=`<span class='${qa.a.B4b} ${C.a.iyh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class ab extends Xa.a{constructor(Vb){super(document.createElement("a"));this.Sa=new Ja.a;this.htmlSanitizationHelper=this.hme=null;this.hd=()=>{this.enabled&&this.Sa.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=Vb}TLg(Vb){this.Sa.addHandler("tpButtonClicked",Vb)}fVf(Vb){this.Sa.removeHandler("tpButtonClicked",Vb)}get t0a(){return this.domElement}get taskPane(){return this.hme}get enabled(){return super.enabled}set enabled(Vb){Vb!==super.enabled&&(this.domElement.classList.toggle(C.a.uU),
this.domElement.classList.toggle(Qa),this.domElement.tabIndex=Vb?0:-1,super.enabled=Vb)}get Fl(){return this.domElement.firstChild.firstChild}dispose(){h.a.qc([this.Sa]);this.Sa=null;this.domElement&&hc.a.xna(this.domElement);super.dispose()}Mii(Vb){const Ac=6===Vb.ih;var Kc=Ac&&!Vb.dl;Kc=String.format(na,Vb.vN,Vb.dl,Kc?d.a.current.io(102):d.a.Ge(10),C.a.Gia,Kc?String.format('style="width:24px;{0}:0px"',"left"):"");V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.sk(this.domElement,Kc):this.domElement.innerHTML=Kc;this.domElement.classList.add(Bc);this.domElement.classList.add(Qa);this.domElement.title=Vb.vN;this.domElement.tabIndex=0;ca.DOMElementExtensions.Pu(this.domElement,H.a.ot,null,null);this.hme=Vb;Ac&&(Vb=this.taskPane,null===Vb||void 0===Vb?void 0:Vb.dig());A.a.instance.ta(y.a.click,this.domElement,this.hd);x.KeyInputManager.instance.Ms(this.domElement,this.hd,w.a.Sh)}}Object(c.a)(ab,"TaskPaneButton",Xa.a,[319]);class Gb extends G.a{constructor(Vb,
Ac,Kc,dd){super(Vb);this.animationManager=this.h6=this.De=null;this.lM=this.eWa=!1;this.u8d=0;this.jb=null;this.qNc=!1;this.htmlSanitizationHelper=null;this.Vz=()=>{this.bqi||(this.pA(),this.$.af())};this.vCd=(Vd,Jd)=>{this.onButtonClick(Vd,Jd)};this.J6=()=>{this.CDc()};this.$=Ac;this.htmlSanitizationHelper=dd;xa.a(this.$).ai(this);this.$.Cb.Uf(this.J6);this.configuration=Kc;this.baseName=ra.HelperMethods.kwa(this.domElement,this.configuration.Ncg||this.configuration.j1);this.aac={};this.Afb=[];this.ju=
[];this.Aqb={};this.ime=document.getElementById(this.baseName+this.configuration.KYd);this.YO||n.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.KYd} not found`);this.bFg=document.getElementById(this.baseName+this.configuration.j1);this.nA||n.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.j1} not found`);this.cFg=document.getElementById(this.baseName+this.configuration.SZd);
this.OL||n.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.SZd} not found`);Vb=String.format(Gb.yQj,this.baseName+this.configuration.xeg,this.baseName+Gb.UOb);V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.sk(this.OL,Vb):this.OL.innerHTML=Vb;this.I6d=document.getElementById(this.baseName+Gb.UOb);
this.sze||n.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Gb.UOb} not found`);(this.zqb=document.getElementById(this.baseName+Gb.UOb))||n.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Gb.UOb} not found`);this.yug=this.DIe(this.configuration.JEe,this.GEe);this.xug=this.UHe(this.configuration.HEe,N.a.instance.ga(1291),this.n8h,this.k1a,!0);this.rwg=this.DIe(this.configuration.mWe,this.$Eh);this.qwg=this.UHe(this.configuration.kWe,
N.a.instance.ga(1290),this.o8h,this.mKa,!1);ca.DOMElementExtensions.setVisible(this.mKa,!1);A.a.instance.ta(y.a.click,this.j1a,Object(U.a)(this,this.Xoc,"onCollapseIconClicked"));A.a.instance.ta(y.a.click,this.lKa,Object(U.a)(this,this.npc,"onExpandIconClicked"));A.a.instance.ta(y.a.click,this.k1a,Object(U.a)(this,this.Xoc,"onCollapseIconClicked"));A.a.instance.ta(y.a.click,this.mKa,Object(U.a)(this,this.npc,"onExpandIconClicked"));x.KeyInputManager.instance.ta(y.a.Ob,this.j1a,Object(U.a)(this,this.CAf,
"onCollapseIconKeyDown"));x.KeyInputManager.instance.ta(y.a.Ob,this.lKa,Object(U.a)(this,this.fCf,"onExpandIconKeyDown"))}RE(Vb){this.addHandler(Gb.ehb,Vb);Vb(this,new ub(this.isVisible,ca.DOMElementExtensions.isVisible(this.OL)))}nG(Vb){this.removeHandler(Gb.ehb,Vb)}get OL(){return this.cFg}get mc(){return this.OL}get Ff(){return this.eWa}set Ff(Vb){this.eWa=Vb}get nA(){return this.bFg}get de(){return Y.a.gMi}get YO(){return this.ime}get dC(){return this.ju}get nh(){return this.De}get VM(){return null}get bha(){return null}get isCollapsed(){return this.lM}get j7c(){return this.u8d}get $(){return this.jb}set $(Vb){this.jb=
Vb}get sze(){return this.I6d}get j1a(){return this.xug}get lKa(){return this.qwg}get k1a(){return this.yug}get mKa(){return this.rwg}get bqi(){return this.qNc}get o8h(){return this.configuration.IEe}get n8h(){return this.configuration.lWe}Bsb(Vb,Ac,Kc,dd,Vd){let Jd=Vb.za(Ac);Jd||(Jd=ac.a(Lb.a,Kc,Vb,Ac),Jd.SetScriptLoadFlavor(Vd));dd&&Jd.iXc(dd);const oe=""+Ac;oe in this.aac||Jd.A0b((rd,bf)=>{this.T6(bf)});let De=null;const Ke=()=>{Jd.create();De()};this.aac[oe]=De=()=>{Jd.Quc(Ke);delete this.aac[oe]};
Jd.b0b(Ke)}dispose(){if(this.ju)for(let Ac=0,Kc=this.ju.length;Ac<Kc;Ac++)this.ju[Ac].fVf(this.vCd),this.ju[Ac].dispose();const Vb=this.aac;for(let Ac in Vb)({key:Ac,value:Vb[Ac]}).value();this.$.ea&&this.$.Cb&&this.$.Cb.Bg(this.J6);this.zqb=this.I6d=this.ime=this.De=this.Aqb=this.Afb=this.ju=null;A.a.instance.Ba(y.a.click,this.j1a,Object(U.a)(this,this.Xoc,"onCollapseIconClicked"));A.a.instance.Ba(y.a.click,this.lKa,Object(U.a)(this,this.npc,"onExpandIconClicked"));A.a.instance.Ba(y.a.click,this.k1a,
Object(U.a)(this,this.Xoc,"onCollapseIconClicked"));A.a.instance.Ba(y.a.click,this.mKa,Object(U.a)(this,this.npc,"onExpandIconClicked"));x.KeyInputManager.instance.Ba(y.a.Ob,this.j1a,Object(U.a)(this,this.CAf,"onCollapseIconKeyDown"));x.KeyInputManager.instance.Ba(y.a.Ob,this.lKa,Object(U.a)(this,this.fCf,"onExpandIconKeyDown"));super.dispose()}gg(Vb,Ac){if(Ac)return!1;this.De&&!this.isCollapsed?(Vb=this.nh.taskPane,Vb.Ff&&Vb.gg(!0,!1)||ca.DOMElementExtensions.setFocus(this.nh.t0a)):ca.DOMElementExtensions.setFocus(this.lKa);
return!0}lh(Vb){return this.isVisible?ca.DOMElementExtensions.xf(this.domElement,Vb)||ca.DOMElementExtensions.xf(this.domElement,ca.DOMElementExtensions.axb(Vb)):!1}sj(){}Wj(){this.De&&this.De.taskPane.Wj()}setFocusOnToolbarFirstElement(){this.isCollapsed?ca.DOMElementExtensions.setFocus(this.lKa):ca.DOMElementExtensions.setFocus(this.j1a)}VRd(){for(let Vb=this.ju.length-1;0<=Vb;Vb--)if(this.ju[Vb].isVisible){ca.DOMElementExtensions.setFocus(this.ju[Vb].t0a);return}this.setFocusOnToolbarFirstElement()}Qxb(Vb){const Ac=
[];for(let Kc=this.ju.length-1;0<=Kc;Kc--)this.ju[Kc].taskPane.ih===Vb&&Ac.push(this.ju[Kc].taskPane);return Ac}ofd(Vb){const Ac=[];for(let Kc=0;Kc<this.ju.length;Kc++)this.ju[Kc].taskPane.ih===Vb&&Ac.push(this.ju[Kc]);return Ac}Eqe(Vb){if(Vb){let Ac;const Kc=Object(l.a)(261,Vb);Kc?(Ac=new ab(this.htmlSanitizationHelper),Ac.domElement.id=this.baseName+"bt_"+Vb.ih.toString()+"_"+Vb.nf.InstanceId,this.zqb.appendChild(Ac.domElement),this.Aqb["6"]=Ac,Kc.button=Ac):Ac=this.Aqb[Vb.ih.toString()];Ac.Mii(Vb);
Ac.TLg(this.vCd);Ac.isVisible=Vb.nq();Ac.enabled=Vb.Es();this.Afb.push(Vb);this.ju.push(Ac);Gb.tJi(Vb,this.YO);this.cth(Ac);this.CDc()}}qG(Vb,Ac){let Kc;for(const dd of this.ju)Kc=dd.taskPane,Kc.ih===Vb.ih&&Kc==Vb&&this.R3b(dd,Ac)}Kva(){n.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}e7(){n.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}B6b(){n.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){n.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){n.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){n.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}P8f(Vb,Ac){Vb?(this.qNc=!0,this.LSd(!1)):
(this.qNc=!1,this.LSd(!0),Ac&&(this.pA(),this.$.af()))}yN(Vb){if(!this.Afb.includes(Vb)){let Kc=null;Kc=()=>{this.tij(Vb);Vb.$R(Kc)};Vb.MP(Kc);this.Eqe(Vb);var Ac=Object(l.a)(305,Vb);Ac&&(Ac.RE(this.Vz),this.Vz(Ac,Sys.EventArgs.Empty));if(Ac=Object(l.a)(133,Vb))Ac.RE(this.Vz),this.Vz(Ac,Sys.EventArgs.Empty);if(Ac=Object(l.a)(306,Vb))Ac.RE(this.Vz),this.Vz(Ac,Sys.EventArgs.Empty);this.raiseEvent(Gb.bLf,null,Vb);this.pA()}}R3b(Vb,Ac){if(Vb.taskPane.Es()&&Vb.taskPane.nq()){if(this.De){this.De.domElement.classList.remove(Gb.Hnb);
this.De.taskPane.isVisible=!1;if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Kc=Object(l.a)(261,this.De.taskPane);Kc&&Kc.wj.VLd(Kc.nf.InstanceId)}this.h6=this.De}this.De=Vb;this.De.taskPane.isVisible=!0;this.De.domElement.classList.add(Gb.Hnb);Ac&&this.kja(!1,!1);this.Mgb()}}onButtonClick(Vb){let Ac=!1;if(this.De!==Vb){Ac=!0;const Kc=Vb.taskPane.mc;this.animationManager.l8i(Kc);if(this.De){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const dd=
Object(l.a)(261,this.De.taskPane);dd&&dd.wj.VLd(dd.nf.InstanceId)}this.De.taskPane.isVisible=!1;this.De.domElement.classList.remove(Gb.Hnb)}this.h6=this.De;this.De=Vb;this.De.domElement.classList.add(Gb.Hnb);this.De.taskPane.isVisible=!0;this.Mgb();this.animationManager.REh(Kc)}this.kja(!(this.isCollapsed||Ac),!1)}Mgb(){const Vb=this.j7c;let Ac=0;this.De&&(Ac=this.De.taskPane.wq?this.De.taskPane.wq:this.De.taskPane.Lp);Ac!==Vb&&(this.u8d=Ac,this.isCollapsed||(this.animationManager&&this.De?this.animationManager.f1b(this.nA,
Vb,Ac,this.nh.taskPane):this.nA.style.width=ra.HelperMethods.uc(Ac)),this.KRa(),this.raiseEvent(Gb.f$f,null,this))}TM(Vb){const Ac=new ab(this.htmlSanitizationHelper);Ac.isVisible=!1;Ac.domElement.id=this.baseName+"bt_"+Vb.toString();this.zqb.appendChild(Ac.domElement);this.Aqb[Vb.toString()]=Ac}CDc(){if(void 0!==this.ju&&null!==this.ju){void 0===this.De||null===this.De||this.De.taskPane.Es()||(this.De.domElement.classList.remove(Gb.Hnb),this.De.taskPane.isVisible=!1,this.De.taskPane.nq()&&(this.h6=
this.De),this.De=null);var Vb=null;for(let Ac=0;Ac<this.ju.length;Ac++)if(this.Afb[Ac].nq()){const Kc=this.Afb[Ac].Es();(this.ju[Ac].enabled=Kc)&&!Vb&&(Vb=this.ju[Ac])}void 0!==this.De&&null!==this.De||!Vb||(void 0!==this.h6&&null!==this.h6&&this.h6.taskPane.Es()&&this.h6.taskPane.nq()?this.R3b(this.h6,!1):this.R3b(Vb,!1));void 0!==ta.a(this.$)&&null!==ta.a(this.$)&&ta.a(this.$).isVisible&&void 0!==this.De&&null!==this.De&&1!==this.De.taskPane.ih&&(ta.a(this.$).isVisible=!1);void 0!==this.De&&null!==
this.De&&7!==this.De.taskPane.ih&&(Vb=this.$.da.za(52),null===Vb||void 0===Vb?0:Vb.isVisible)&&(Vb.isVisible=!1);void 0!==this.De&&null!==this.De&&8!==this.De.taskPane.ih&&(Vb=this.$.da.za(233))&&(Vb.isVisible=!1);void 0!==this.De&&null!==this.De&&9!==this.De.taskPane.ih&&(Vb=this.$.da.za(248))&&(Vb.isVisible=!1);V.EwaSettings.ma(292)&&void 0!==this.De&&null!==this.De&&12!==this.De.taskPane.ih&&(Vb=this.$.da.za(302))&&(Vb.isVisible=!1);V.EwaSettings.ma(476)&&void 0!==this.De&&null!==this.De&&15!==
this.De.taskPane.ih&&(Vb=this.$.da.za(365))&&(Vb.isVisible=!1);T.a.kud(this.$)&&void 0!==this.De&&null!==this.De&&13!==this.De.taskPane.ih&&(Vb=this.$.da.za(334))&&(Vb.isVisible=!1);void 0!==this.De&&null!==this.De&&14!==this.De.taskPane.ih&&(Vb=this.$.da.za(346))&&(Vb.isVisible=!1);void 0!==this.De&&null!==this.De&&16!==this.De.taskPane.ih&&(Vb=this.$.da.za(371))&&(Vb.isVisible=!1);V.EwaSettings.xjc()&&void 0!==this.De&&null!==this.De&&17!==this.De.taskPane.ih&&(Vb=this.$.da.za(408))&&(Vb.isVisible=
!1);V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.De&&null!==this.De&&18!==this.De.taskPane.ih&&(Vb=this.$.da.za(415))&&(Vb.isVisible=!1);this.Mgb()}}uHh(Vb,Ac){ca.DOMElementExtensions.setVisible(this.k1a,!Vb);ca.DOMElementExtensions.setVisible(this.mKa,Vb);Vb&&this.raiseEvent(Gb.LEe,null,this);this.Mgb();Ac&&ca.DOMElementExtensions.setFocus(Vb?this.lKa:this.j1a)}Sec(Vb,Ac){this.$.Xc(Vb,Ac,26,null)}T6(Vb){Vb.IO&&this.yN(Vb.IO)}tij(Vb){if(Vb){const Ac=
this.ju.length;let Kc=!1;for(let dd=0;dd<Ac;dd++){const Vd=this.ju[dd];if(Vd.taskPane===Vb){this.zqb.removeChild(Vd.t0a);delete this.Aqb[Vb.ih.toString()];Array.remove(this.Afb,Vb);Array.remove(this.ju,Vd);Vd.fVf(this.vCd);Vd.taskPane.mc.parentNode.removeChild(Vd.taskPane.mc);this.De&&this.De.taskPane===Vd.taskPane&&(this.De=null);this.h6&&this.h6.taskPane===Vd.taskPane&&(this.h6=null);Kc=!0;break}}Kc&&this.CDc()}}cth(Vb){const Ac=Vb.taskPane.ih,Kc=!!this.De&&1===this.De.taskPane.ih;(1===Ac||!Kc&&
2===Ac)&&this.R3b(Vb,!1)}static tJi(Vb,Ac){const Kc=Vb.mc;Kc.parentNode&&Kc.parentNode.removeChild(Kc);Ac.appendChild(Kc);Vb.isVisible=!1}UHe(Vb,Ac,Kc,dd,Vd){const Jd=document.createElement("a");Jd.setAttribute(H.a.LY,Vd?H.a.xk:H.a.zr);Jd.setAttribute(H.a.Ld,H.a.ot);Jd.tabIndex=0;Jd.classList.add(qa.a.Rx);Jd.classList.add(Vb);Jd.classList.add(C.a.eyh);Vb=String.format(Gb.h4g,Ac,Kc,d.a.Ge(10));V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.sk(Jd,Vb):Jd.innerHTML=Vb;dd.appendChild(Jd);return Jd}}Gb.ehb="tpVisibility";Gb.yQj=`<div id='{0}' class='${C.a.kyh}'><div id='{1}' class='${C.a.jyh}'></div></div>`;Gb.h4g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Gb.UOb="novTaskpaneButtonGroup";Gb.Hnb=C.a.gyh;Gb.f$f="tpSizeChanged";Gb.LEe="tpCollapsed";Gb.bLf="tpAdded";Object(c.a)(Gb,"TaskPaneControl",G.a,[265,39,2]);var fc=a(49),pb=a(368),Ea=a(706);class xb{constructor(){this.lWe=this.IEe=this.kWe=this.HEe=
this.mWe=this.JEe=this.xeg=this.SZd=this.KYd=this.j1=this.Ncg=null}}Object(c.a)(xb,"Configuration",null,[]);a(430);var bc=a(295);class zb extends bc.a{constructor(Vb){super(5,Vb)}}Object(c.a)(zb,"ResizeAnimationEvent",bc.a,[]);var Ub=a(474),wc=a(585),mb=a(100);class Db{constructor(Vb,Ac){this.Ocg=null;this.$=Ac;this.taskPane=Vb}KEh(){this.Ocg=ca.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Eb+H.a.CBd);const Vb=Db.J6c(this.taskPane),Ac=Db.J6c(this.Ocg),Kc=wc.a(mb.a.Ul);Kc.animate(Vb,
H.a.$yc);Kc.animate(Ac,H.a.$yc)}l8i(Vb){Vb.style.opacity="0"}REh(Vb){wc.a(mb.a.Ul).animate(Db.J6c(Vb),H.a.$yc)}f1b(Vb,Ac,Kc,dd){Ac||(dd.isVisible=!0);this.$.KRa(Kc);wc.a(mb.a.Ul).animate(Db.rgh(Vb,Ac,Kc),H.a.$yc,null,null,()=>{this.$.PAa();Kc||1===dd.ih||(dd.isVisible=!1);dd.JR(Kc<Ac)})}static rgh(Vb,Ac,Kc){Vb=new zb(Vb);Vb.mRg(Ac,Kc);return Vb}static J6c(Vb){Vb=new Ub.a(Vb);Vb.LJ(0,1);return Vb}}Object(c.a)(Db,"TaskPaneAnimationManager",null,[281]);const Ic=`<div id="{0}" class="${C.a.oyh}" runat="server"></div></div><div id="{1}" class="${C.a.nyh} ${C.a.rp}" runat="server"></div>`,
Hc=`<button type="button" id="{0}" class="${C.a.lyh}"></button><span><div id="{1}" class="${C.a.myh}"></div></span>`,Ab=C.a.Zxh;class db extends Gb{constructor(Vb,Ac,Kc,dd){super(Vb,Kc,db.gch(),dd);this.Arc=null;this.Gtd=!1;this.zS=null;this.yXi=Vd=>{var Jd=!1;if(9===Vd.Ca.keyCode){Jd=this.nh.taskPane.WQ(Vd,this.OL);if(!Jd){Jd=this.$.da.za(52);var oe=this.domElement.querySelectorAll(this.nh.taskPane===Jd?Jd.Ir:pb.a.v3i);Jd=ca.DOMElementExtensions.wm(oe);oe=ca.DOMElementExtensions.tB(oe);Jd=ca.DOMElementExtensions.rBa(Vd.Ca,
Jd,oe)}return Jd}oe=Va.FocusManager.instance().gi;if(null===oe||void 0===oe?0:oe.MN)return Jd;27===Vd.Ca.keyCode&&this.nh.taskPane.vg(!1);return Jd};this.ed=()=>{this.OL.style.bottom=this.nA.style.bottom=this.$.rd&4&&!F.AFrameworkApplication.sa.Pa.Ye?ra.HelperMethods.uc(this.$.Cea):"0";this.pA()};this.PGf=Vd=>{Object(Sa.a)(261,this.nh.taskPane)&&(this.nh.taskPane.dHa.firstChild.style[H.a.pointerEvents]="none");this.Gtd=!0;this.zS=this.lxb(Vd.clientPoint);oa.a.instance.ta(y.a.Yf,this.domElement.ownerDocument.body,
this.sqc);oa.a.instance.ta(y.a.we,this.domElement.ownerDocument.body,this.tqc);kb.a.instance.ta(y.a.Ij,this.domElement.ownerDocument.body,this.sqc);kb.a.instance.ta(y.a.Pf,this.domElement.ownerDocument.body,this.tqc);return!0};this.tqc=()=>{Object(Sa.a)(261,this.nh.taskPane)&&(this.nh.taskPane.dHa.firstChild.style[H.a.pointerEvents]="");this.Gtd=!1;oa.a.instance.Ba(y.a.Yf,this.domElement.ownerDocument.body,this.sqc);oa.a.instance.Ba(y.a.we,this.domElement.ownerDocument.body,this.tqc);kb.a.instance.Ba(y.a.Ij,
this.domElement.ownerDocument.body,this.sqc);kb.a.instance.Ba(y.a.Pf,this.domElement.ownerDocument.body,this.tqc);return!0};this.sqc=Vd=>{this.Gtd&&(Vd=this.lxb(Vd.clientPoint),Vd=Ea.a.kE(Vd,this.zS),this.Yte(Vd.x));return!0};this.xYi=Vd=>{void 0!==Vd.Ca&&null!==Vd.Ca&&(9===Vd.Ca.keyCode?Vd.Ca.shiftKey?(Vd=Object(Sa.a)(39,this.nh.taskPane)?this.nh.taskPane:null)&&Vd.gg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Vd.Ca.keyCode&&39!==Vd.Ca.keyCode||this.Yte(37===Vd.Ca.keyCode?-20:20));return!0};
this.$.domElement.classList.add(Ab);this.Mcg=Ac;this.initialize();x.KeyInputManager.instance.ta(y.a.Ob,this.domElement,this.yXi);this.WOb=ca.DOMElementExtensions.getElementById(Ac.parentNode,this.$.Eb+H.a.doc);this.RBc=ca.DOMElementExtensions.getElementById(Ac.parentNode,this.$.Eb+H.a.Nxf);this.WOb.title=N.a.instance.ga(2223);oa.a.instance.ta(y.a.Df,this.RBc,this.PGf);kb.a.instance.ta(y.a.pointerDown,this.RBc,this.PGf);x.KeyInputManager.instance.ta(y.a.Ob,this.WOb,this.xYi)}get de(){return Y.a.LBc}get GEe(){return this.OL}get $Eh(){return this.GEe}Mgb(){super.Mgb();
this.WOb&&(this.nh&&this.nh.taskPane.isResizable?(this.WOb.style.display="block",this.RBc.style.display="block"):(this.WOb.style.display="none",this.RBc.style.display="none"))}get zCc(){const Vb=this.OL;return Vb&&ca.DOMElementExtensions.isVisible(Vb)?pb.a.zCc:0}RXf(Vb){Vb&&(this.animationManager=Vb);this.Gnj();this.animationManager=Vb||new Db(this.nA,this.$);this.animationManager.KEh()}dispose(){this.Arc&&this.Arc.nG(this.Vz);ta.a(this.$)&&ta.a(this.$).nG(this.Vz);const Vb=this.$.da.za(52);Vb&&Vb.nG(this.Vz);
this.$.Kl(this.ed);h.a.qc([this.Arc]);this.Arc=null;super.dispose()}initialize(){this.RXf(null);this.TM(0);this.TM(1);this.TM(2);this.TM(7);this.TM(8);this.TM(9);this.TM(10);V.EwaSettings.ma(292)&&this.TM(12);V.EwaSettings.ma(476)&&this.TM(15);V.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.TM(13):T.a.kud(this.$)&&this.TM(13);this.TM(14);this.TM(16);V.EwaSettings.xjc()&&this.TM(17);V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.TM(18);this.pA()}pA(){var Vb=0;let Ac=0;for(let Kc=this.dC.length-1;0<=Kc;Kc--){const dd=this.dC[Kc].taskPane.nq(),Vd=this.dC[Kc].taskPane;if(this.dC[Kc].isVisible=dd)Ac++,(1!==Vd.ih&&(V.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Vd.ih)&&14!==Vd.ih&&16!==Vd.ih||Vd.Es())&&Vb++}Vb=0<Vb;ca.DOMElementExtensions.setVisible(this.OL,Vb);this.LSd(Vb);ca.DOMElementExtensions.setVisible(this.mKa,Vb&&this.isCollapsed);ca.DOMElementExtensions.setVisible(this.k1a,
Vb&&!this.isCollapsed);ca.DOMElementExtensions.setVisible(this.sze,1<Ac);this.CDc()}kja(Vb,Ac){if(this.isCollapsed!==Vb){Vb||(this.Mcg.style.display=F.AFrameworkApplication.sa.Pa.Ye?"flex":"block");var Kc=this.j7c;this.lM=!this.isCollapsed;var dd=Vb?Kc:0;Kc=Vb?0:Kc;this.nh&&(this.animationManager.f1b(this.nA,dd,Kc,this.nh.taskPane),this.KRa());Vb&&(this.Mcg.style.display="none");this.uHh(Vb,Ac)}}LSd(Vb){const Ac=this.isVisible!==Vb;this.Ff=Vb;ca.DOMElementExtensions.setVisible(this.domElement,Vb);
Ac&&(F.AFrameworkApplication.sa.Pa.Ye&&ca.DOMElementExtensions.toggleCssClass(this.domElement,C.a.Oxh,Vb),this.KRa(),this.raiseEvent(Gb.ehb,new ub(Vb,Vb),this))}Xoc(Vb){if(Vb.Gb===this.k1a&&3!==Vb.tb)return!1;this.Sec(296943390,Vb.tb);this.kja(!0,!0);return!0}npc(Vb){if(Vb.Gb===this.mKa&&3!==Vb.tb)return!1;this.Sec(-625072140,Vb.tb);this.kja(!1,!0);return!0}CAf(Vb){return 13===Vb.Ca.keyCode?(this.Sec(296943390,Vb.tb),this.kja(!0,!0),!0):!1}fCf(Vb){return 13===Vb.Ca.keyCode?(this.Sec(-625072140,Vb.tb),
this.kja(!1,!0),!0):!1}KRa(){let Vb=0;this.$.rd&262144&&(Vb+=this.zCc,ca.DOMElementExtensions.isVisible(this.nA)&&!this.isCollapsed&&(Vb+=this.j7c));this.$.KRa(Vb)}DIe(Vb,Ac){const Kc=document.createElement("div");Kc.classList.add(Vb);Ac.insertBefore(Kc,Ac.firstChild);return Kc}Gnj(){const Vb=this.domElement;let Ac=document.getElementById(this.$.Eb+H.a.c1a);F.AFrameworkApplication.sa.Pa.Ye&&(Ac=document.getElementById("FarPaneRegion"));Vb.parentNode&&Vb.parentNode!==Ac&&Vb.parentNode.removeChild(Vb);
Ac.appendChild(Vb);this.Qai()}Qai(){const Vb=this.nA,Ac=this.OL,Kc=this.$.ea;Vb.style.right="0";F.AFrameworkApplication.sa.Pa.Ye||(Vb.style.marginRight=ra.HelperMethods.uc(pb.a.zCc));Vb.style.bottom=this.$.rd&4&&!F.AFrameworkApplication.sa.Pa.Ye?ra.HelperMethods.uc(this.$.Cea):"0";this.YO.style.bottom="0";Ac.style.right="0";this.$.nl(this.ed);Kc.hI&&this.ed(null,null)}lxb(Vb){const Ac=new fc.a(0,0);return Ea.a.Vs(Ac,this.nA,Vb,!1)}Yte(Vb){const Ac=this.nA.offsetWidth;Vb=Ac-Vb;Vb<this.nh.taskPane.Lp?
Vb=this.nh.taskPane.Lp:950<Vb&&(Vb=950);this.nh.taskPane.wq=Vb;const Kc=new Db(this.nA,this.$);Kc.f1b(this.nA,Ac,Vb,this.nh.taskPane);Object(Sa.a)(261,this.nh.taskPane)||Kc.f1b(this.nh.taskPane.mc,Ac,Vb,this.nh.taskPane);this.$.KRa(this.OL.offsetWidth+Vb);this.$.oAa(nb.a.VZ("AnimateTaskpaneResize"))}static ka(Vb,Ac){let Kc=null;Vb.Jb&&(Kc=Vb.Jb.Ng("ComponentAttach","AttachTaskPanePickerControl"),Kc.start());const dd=db.FZg(Vb.Eb),Vd=db.EZg(Vb.Eb,Ac),Jd=db.GZg(Vb.Eb);dd.appendChild(Jd);dd.appendChild(Vd);
db.jUg(Vb,dd);Vb=new db(dd,Vd,Vb,Ac);Kc&&Kc.stop();return Vb}static FZg(Vb){const Ac=document.createElement("div");Ac.id=Vb+H.a.MBc;return Ac}static EZg(Vb,Ac){const Kc=document.createElement("div");Kc.id=Vb+H.a.Mxf;Kc.className=C.a.$xh;let dd=String.format(Ic,Vb+H.a.eMi,Vb+H.a.BR);dd+=String.format(Hc,Vb+H.a.doc,Vb+H.a.Nxf);V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?Ac.sk(Kc,dd):
Kc.innerHTML=dd;F.AFrameworkApplication.sa.Pa.Ye&&ca.DOMElementExtensions.toggleCssClass(Kc,C.a.hRa,!0);return Kc}static GZg(Vb){const Ac=document.createElement("div");Ac.id=Vb+H.a.CBd;Ac.className=C.a.Wzh;Ac.style.zIndex="100";F.AFrameworkApplication.sa.Pa.Ye&&ca.DOMElementExtensions.toggleCssClass(Ac,C.a.hRa,!0);return Ac}static jUg(Vb,Ac){(F.AFrameworkApplication.sa.Pa.Ye?document.getElementById("FarPaneRegion"):document.getElementById(Vb.Eb+H.a.c1a)).appendChild(Ac)}static gch(){const Vb=new xb;
Vb.Ncg=H.a.MBc;Vb.j1=H.a.Mxf;Vb.KYd=H.a.BR;Vb.SZd=H.a.CBd;Vb.xeg=H.a.fMi;Vb.JEe=C.a.byh;Vb.mWe=C.a.dyh;Vb.HEe=C.a.ayh;Vb.kWe=C.a.cyh;Vb.IEe=C.a.SUe;Vb.lWe=C.a.TUe;return Vb}}Object(c.a)(db,"TaskPanePickerControl",Gb,[]);class Pb extends v.a{constructor(Vb){super();this.$=Vb;this.Fb()}create(){if(T.a.gd(this.$))this.ob(ya.ka(this.$));else if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const Vb=
Ha.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);z.TaskExtensions.Aa(Vb,()=>{this.ob(db.ka(this.$,Vb.result))},this.la,3)}else this.ob(db.ka(this.$,null))}static ka(Vb){Vb.da.Ga(50,new Pb(Vb))}}Object(c.a)(Pb,"TaskPaneManagerFactory",v.a,[]);class td extends e.a{constructor(Vb){super(Vb);this.St=()=>{this.$.ea.YR(this.St);this.LJe()};this.$=Vb}LJe(){const Vb=this.$.da;Vb.Ga(72,new Tb(this.$));Vb.Ga(77,new Z(this.$));Pb.ka(this.$);ha.ka(this.$)}static main(){f.a.Fa(Vb=>{b.a.Kdf(Vb.domElement.ownerDocument,
d.a.current.io(97),()=>{Vb.KI()});const Ac=new td(Vb);Vb.ea.Gv?Ac.LJe():Vb.ea.QT(Ac.St)})}}Object(c.a)(td,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");td.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/5a9fc35764b9915f4aceda1992d609d1/EwaDSEsNext.tp.js.map