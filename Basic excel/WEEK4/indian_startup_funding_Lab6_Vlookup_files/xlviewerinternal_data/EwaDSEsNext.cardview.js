'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[61],{1444:function(u,D,a){a.r(D);u=a(511);D=a(0);var c=a(692),b=a(15),e=a(8),f=a(91),d=a(1),h=a(183),m=a(21),l=a(55);class v{constructor(La,nb){this.$=nb;this.cardViewManager=La}eld(La,nb,Lb){if(d.EwaSettings.ma(644)){var ac=new f.a(-90814711,La.method,La.mode,La.$e,La.tabName);this.$.Ka.Lb(ac,nb)}b.ULS.sendTraceTag(537168077,0,50,"CardViewCommandHandler:HandleShowDataCardCommand() - show data card attempted.");
if(ac=m.h(this.$)){var ib=ac.ha.ra.activeCell;ac=ib.top;ib=ib.left;if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowCardOnHoverEnabled2",!1)){const Ra=nb[e.a.s1a]||0;nb=nb[e.a.r1a]||0;0<Ra&&0<nb&&(ac=Ra,ib=nb)}this.cardViewManager.Meb(ac,ib,1,1===La.method,Lb)}}Eai(La){b.ULS.sendTraceTag(42767441,0,50,"CardViewCommandHandler: Showing a permanent error card.");var nb=m.h(this.$);nb&&(nb=nb.ha.ra.activeCell,this.cardViewManager.Meb(nb.top,nb.left,0,1===La.method,!1))}Hai(La){this.cardViewManager.Meb(La[e.a.s1a],
La[e.a.r1a],0,!1,!0)}b$h(La){this.cardViewManager.sMa(La[e.a.s1a],La[e.a.r1a],null)}nc(){return!1}executeCommand(La,nb,Lb){La=nb.command;switch(La){case -843616717:if(1===v.A4a(this.$,La))return this.eld(nb,Lb,!1),l.Task.Ta(!0);break;case -1779556985:if(3===v.A4a(this.$,La))return this.Eai(nb),l.Task.Ta(!0);break;case 1245141747:switch(v.A4a(this.$,La)){case 1:return this.eld(nb,Lb,!1),l.Task.Ta(!0);case 2:return nb=new f.a(1266950951,nb.method,nb.mode,nb.$e,nb.tabName),this.$.Ka.Lb(nb,Lb)}break;
case -1007198183:return this.eld(nb,Lb,!0),l.Task.Ta(!0);case 1637648381:return this.Hai(Lb),l.Task.Ta(!0);case 1250254126:return this.b$h(Lb),l.Task.Ta(!0)}return h.a(La)}wc(La,nb,Lb){La=nb.command;switch(La){case -843616717:return 1===v.A4a(this.$,La);case -1779556985:return 3===v.A4a(this.$,La);case 1245141747:return Lb=v.A4a(this.$,La),1===Lb||2===Lb;case -1007198183:return d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowCardOnHoverEnabled2",
!1)?!!Lb&&!!Lb[e.a.s1a]&&!!Lb[e.a.r1a]:!1;case 1637648381:case 1250254126:return!!Lb&&!!Lb[e.a.s1a]&&!!Lb[e.a.r1a];default:return!1}}Jc(){return!1}static A4a(La,nb){var Lb=La.na;return Lb&&(Lb=Lb.activeCell,Lb.isSingle||m.h(La).Bb.VNa(Lb))?v.yOh(La,nb,Lb):0}static yOh(La,nb,Lb){if(-1779556985===nb)return m.h(La).Bb.Noi(Lb)?3:0;if(m.h(La).Bb.Yxa(Lb)){if(1245141747===nb)return m.h(La).Bb.Xzb(Lb)?2:d.EwaSettings.ma(104)?1:0;if(-843616717===nb)return d.EwaSettings.ma(104)?1:0}return 0}}Object(D.a)(v,
"CardViewCommandHandler",null,[165]);var t=a(460);class z extends c.a{constructor(La){super(La)}nd(){t.a(this.$,243,242,this.Ya,La=>{this.Yc([new v(La,this.$)])})}static ka(La){c.a.Nd(241,new z(La))}}Object(D.a)(z,"CardViewCommandHandlerFactory",c.a,[]);var r=a(222),n=a(4),w=a(82),B=a(5),A=a(85),y=a(239),x=a(14),F=a(40),I=a(107),L=a(238);class X{}X.avh="ewa-cardview-container";X.bvh="ewa-cardview-container-afterinsert";X.wRe="ewa-cardview-container-rtl";X.xRe="ewa-cardview-err-notch";Object(D.a)(X,
"CssClassNames",null,[]);var P=a(61),G=a(49),C=a(259),H=a(224),J=a(94);class M extends J.a{constructor(La,nb=null){super(La);this.gEd=Lb=>{const ac=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6558158_CardViewDismissesOnBackArrow");if(!this.enabled||this.domElement.contains(Lb.Ca.target)||ac&&0<=Lb.Ca.rawEvent.composedPath().indexOf(this.domElement))return!1;this.raiseEvent("ClickOutside");return!0};this.IFf=Lb=>this.gEd(Lb);this.Lab=nb||document.body;this.enabled=!0;y.a.instance.ta(x.a.pointerDown,
this.Lab,this.gEd);H.a.instance.BAa(x.a.click,this.Lab,this.IFf,null,!0)}aMg(La){this.addHandler("ClickOutside",La)}dispose(){this.Lab&&(y.a.instance.Ba(x.a.pointerDown,this.Lab,this.gEd),H.a.instance.jDc(x.a.click,this.Lab,this.IFf,!0),this.Lab=null);super.dispose()}}Object(D.a)(M,"DetectClickOutsideBehavior",J.a,[]);class S extends J.a{constructor(La,nb){super(La);this.gridView=nb;La.focus()}dispose(){this.gridView&&(this.domElement.contains(document.activeElement)&&this.gridView.focus(),this.gridView=
null);super.dispose()}}Object(D.a)(S,"FocusAndRestoreToGridBehavior",J.a,[]);class W extends Sys.EventArgs{constructor(La,nb){super();this.actionId=La;this.parameters=nb}}Object(D.a)(W,"InvokeActionEventArgs",Sys.EventArgs,[]);class O{constructor(La,nb){this.QWg=La;this.SWg=nb}}Object(D.a)(O,"AlignedBox",null,[]);const T=(La,nb,Lb,ac,ib)=>{const Ra=new G.a(0,0);var ya=Lb.y;Lb=Lb.x;let Va=0;nb=nb.Ke(new P.a(0,0,La.x,La.y));if(0>=La.x||0>=La.y||!nb)return null;const oa=2===ib?0:ac,kb=La.x-nb.bottomRight.x-
oa,Sa=nb.topLeft.x-oa,U=kb>=Lb,ta=Sa>=Lb;let ub;(ub=1===ib||2===ib?U||!ta&&kb>=Sa:!ta&&(U||kb>=Sa))?(Ra.x=2===ib?nb.x:nb.bottomRight.x+oa,U||(Lb=kb)):ta?Ra.x=2===ib?nb.bottomRight.x-Lb:Sa-Lb:(Ra.x=0,Lb=Sa);ac=2===ib?ac:0;Ra.y=nb.y+(2===ib?ac+nb.height:0);Ra.y+ya>La.y&&(La=La.y-nb.y,ya=Math.min(ya,nb.bottomRight.y),La>=ya?ya=La:(Ra.y=(2===ib?nb.topLeft.y-ac:nb.bottomRight.y)-ya,Va=1));return 0>=Lb||0>=ya?null:new O(new P.a(Ra.x,Ra.y,Lb,ya),Va,ub)};var Y=a(24),va=a(64),ca=a(247),V=a(706),ra=a(142),
N=a(786),ea=a(47),Ba=a(46),ka=a(12),Ka=a(117),Oa=a(34),wa=a(231);class qa extends L.a{constructor(La,nb,Lb){super(document.createElement("div"));this.F1c=this.B1c=this.y1c=this.C1c=0;this.x3b=1;this.ZHa=this.O2=null;this.Ikc=this.VQ=!1;this.ENb=null;this.gQf=()=>{this.raiseEvent("OnMouseEnter");return!0};this.hQf=()=>{this.raiseEvent("OnMouseLeave");return!0};this.rPi=()=>{this.raiseEvent("HideCard")};this.Tt=()=>{this.O2&&(qa.VMf(this.$,this.gridView,this.domElement,this.C1c,this.y1c,this.F1c,this.B1c,
this.x3b,0,null).returnValue||this.raiseEvent("HideCard"))};this.onKeyDown=ac=>ac.Ca.keyCode===A.a.kJ?(this.raiseEvent("HideCard"),!0):!1;this.zYi=(ac,ib)=>{ac=this.gridView.rtl;var Ra=ka.DOMElementExtensions.getBoundingClientRect(this.domElement),ya=ka.DOMElementExtensions.getBoundingClientRect(this.domElement.parentNode);Oa.a(this.$).pea()&&(ya.x=Math.round(Oa.a(this.$).yi(ya.x)),ya.y=Math.round(Oa.a(this.$).yi(ya.y)),ya.height=Math.round(Oa.a(this.$).yi(ya.height)),ya.width=Math.round(Oa.a(this.$).yi(ya.width)));
const Va=Ra.x-ya.x,oa=ya.width-Va-Ra.width;Ra=Ra.y-ya.y;var kb=ya.height-Ra;ya=Object(wa.a)(ib.width,150,ya.width-(ac?oa:Va));ib=Object(wa.a)(ib.height,100,kb);if(ya!==this.domElement.clientWidth||ib!==this.domElement.clientHeight)kb=this.domElement.style,"auto"===kb.top&&(kb.top=Ra+"px",kb.bottom="auto"),ac?(kb.left="auto",kb.right=oa+"px"):(kb.left=Va+"px",kb.right="auto"),kb.width=ya+"px",kb.height=ib+"px",kb.maxHeight="none",this.F1c=ya,this.B1c=ib};this.$=La;this.F8h=this.$.uf;this.gridView=
m.h(La);this.domElement.classList.add(X.avh);this.Hbg(!0);this.zOb(!0);this.L0a=new M(this.domElement);this.L0a.aMg(this.rPi);this.F8h.appendChild(this.domElement);this.z1c=new S(this.domElement,this.gridView);nb&&(this.ZHa=Lb.TIa(this.domElement,this.gridView,1),this.ZHa.fse(this.zYi));C.a(La).ai(this);y.a.instance.ta(x.a.sW,this.domElement,this.gQf);y.a.instance.ta(x.a.Jy,this.domElement,this.hQf)}get de(){return ca.a.D1c}get mc(){return this.domElement}get Ff(){return!0}get Ktb(){return this.L0a.enabled}set Ktb(La){this.L0a.enabled=
La}YMg(La){this.addHandler("HideCard",La)}yob(La){this.addHandler("OnMouseEnter",La)}avc(La){this.removeHandler("OnMouseEnter",La)}zob(La){this.addHandler("OnMouseLeave",La)}bvc(La){this.removeHandler("OnMouseLeave",La)}fqj(La){this.hBe();this.guf();switch(La){case 1:this.O2.focusCard();break;case 2:this.O2.focusCardTitle()}}a5b(La,nb){this.O2&&this.O2.notifyActionCompleted(La,nb)}openUrl(La){d.EwaSettings.ma(156)?t.a(this.$,269,270,0,nb=>{this.hmg(()=>{nb.jpa(La)||F.a.bV(La)})}):this.hmg(()=>{F.a.bV(La)})}gg(La,
nb){!nb&&this.O2&&this.O2.focusCardTitle();return!nb}lh(La){return ka.DOMElementExtensions.xf(this.mc,La)}sj(){}Wj(){}dispose(){this.O2=null;this.zOb(!1);this.Hbg(!1);this.z1c&&(this.z1c.dispose(),this.z1c=null);this.ZHa&&(this.ZHa.dispose(),this.ZHa=null);this.L0a&&(this.L0a.dispose(),this.L0a=null);y.a.instance.Ba(x.a.sW,this.domElement,this.gQf);y.a.instance.Ba(x.a.Jy,this.domElement,this.hQf);this.domElement&&ka.DOMElementExtensions.tf(this.domElement);C.a(this.$).aA(this);this.hBe();super.dispose()}notifyCardChanged(){this.O2?
this.O2.notifyCardChanged():b.ULS.sendTraceTag(593273225,0,10,"CardViewCardControl.NotifyCardChanged: null Adaptive Card Controller when attempting to NotifyCardChanged")}rvc(La,nb,Lb,ac){this.x3b=Lb;if(this.OXf(nb)){Lb={};var ib=new ra.a(this.$.xa);Lb.readOnly=ib.ki;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Lb.readOnly&&0===nb.anchorType&&(Lb.readOnly=this.gridView.Bb.J5(Y.Range.Qc(nb.UC.row,nb.UC.column)));Lb.rtl=this.gridView.rtl;this.O2=cardviewui.renderAdaptiveCard(this.domElement,
La,Lb,!0);this.ZHa&&this.ZHa.Xwe();Oa.a(this.$).Ayc(this.domElement);ac&&(this.ENb=ea.a.instance.create(()=>{this.ENb=null;this.guf()},1E3,Ba.a.X1g,!0,!0))}}OXf(La){if(!La)return b.ULS.sendTraceTag(537168080,0,15,"CardViewCardControl.RepositionCard called with null AnchorInfo."),!1;let nb;const Lb=La.anchorType,ac=La.UC.row,ib=La.UC.column;if(({A1c:La,E1c:nb}=qa.VMf(this.$,this.gridView,this.domElement,ac,ib,300,560,this.x3b,Lb,La.ep)).returnValue)return 0===Lb&&(this.C1c=ac,this.y1c=ib),this.B1c=
La,this.F1c=nb,!0;b.ULS.sendTraceTag(51524302,0,15,"No space to position card");this.raiseEvent("HideCard");return!1}guf(){this.domElement.classList.add(X.bvh)}hBe(){this.ENb&&(this.ENb.dispose(),this.ENb=null)}hmg(La){if(this.Ktb){this.Ktb=!1;try{La()}finally{this.Ktb=!0}}else La()}Hbg(La){La&&!this.Ikc?(I.KeyInputManager.instance.ta(x.a.Ob,this.domElement,this.onKeyDown),this.Ikc=!0):!La&&this.Ikc&&(I.KeyInputManager.instance.Ba(x.a.Ob,this.domElement,this.onKeyDown),this.Ikc=!1)}zOb(La){La&&!this.VQ?
(this.gridView.view.nt(this.Tt),this.VQ=!0):!La&&this.VQ&&(this.gridView.view.ir(this.Tt),this.VQ=!1)}sfd(La,nb){return qa.sfd(this.gridView,this.C1c,this.y1c,La,nb,this.x3b)}static VMf(La,nb,Lb,ac,ib,Ra,ya,Va,oa,kb){var Sa;var U=Sa=0;ac=0===oa?qa.sfd(nb,ac,ib,Ra,ya,Va):qa.gRh(nb,kb,Ra,ya,Va);if(!ac)return b.ULS.sendTraceTag(589841037,0,15,"CardViewCardControl.PositionCard: Failed to place card and get cardAlignedBox"),{returnValue:!1,A1c:Sa,E1c:U};ib=ac.QWg;if(150>ib.width||100>ib.height)return{returnValue:!1,
A1c:Sa,E1c:U};Sa=V.a.Ywb(nb);U=Sa.y-ib.bottomRight.y+Ka.a.Ou;Ra=0;va.b(La.na)&&(Ra=Oa.a(La).yi(nb.Pr),N.a(ib,Ra,Oa.a(La).yi(nb.VJ)));qa.O5i(nb,Lb,Sa.x+Ra+Ka.a.Ou,ib,U,ac.SWg,oa);Sa=ib.height;U=ib.width;return{returnValue:!0,A1c:Sa,E1c:U}}static O5i(La,nb,Lb,ac,ib,Ra,ya){nb.style.width=ac.width+"px";nb.style.maxHeight=ac.height+"px";0===Ra?(nb.style.top=ac.y+"px",nb.style.bottom="auto"):(nb.style.top="auto",nb.style.bottom=ib+"px");0===ya&&La.rtl?(nb.classList.add(X.wRe),nb.style.left=Lb-ac.bottomRight.x+
"px"):(nb.classList.remove(X.wRe),nb.style.left=ac.x+"px")}static sfd(La,nb,Lb,ac,ib,Ra){nb=V.a.vRh(La,nb,Lb);if(!nb)return null;La=V.a.Ywb(La);ac=new G.a(ac,ib);return T(La,nb,ac,5,Ra)}static gRh(La,nb,Lb,ac,ib){nb=ka.DOMElementExtensions.getBoundingClientRect(nb);const Ra=ka.DOMElementExtensions.getBoundingClientRect(La.zj),ya=V.a.Ywb(La);if(!nb||!Ra||!ya)return null;nb=new P.a(nb.x-(Ra.width-ya.x)-Ra.x+La.Pr,nb.y-(Ra.height-ya.y)-Ra.y+La.VJ,nb.width,nb.height);La=V.a.Ywb(La);Lb=new G.a(Lb,ac);
return T(La,nb,Lb,3,ib)}}Object(D.a)(qa,"CardViewCardControl",L.a,[39]);var aa=a(7);class ia{constructor(){this.xfb=this.column=this.row=0}}Object(D.a)(ia,"CardLocation",null,[]);class Ha{constructor(La,nb,Lb){this.UC=Object(aa.a)(new ia,{row:La,column:nb,xfb:Lb});this.bHc=null}get ep(){return this.bHc}get anchorType(){return 0}}Object(D.a)(Ha,"CardViewCellAnchorInfo",null,[752]);class Z{constructor(La){this.mug=Object(aa.a)(new ia,{column:-1,row:-1,xfb:-1});this.bHc=La}get UC(){return this.mug}set UC(La){}get ep(){return this.bHc}get anchorType(){return 1}}
Object(D.a)(Z,"CardViewDOMAnchorInfo",null,[752]);var la=a(87);class Xa{constructor(La,nb){this.Xld=this.bVd=this.ep=this.cellRange=null;this.yVb=this.htb=this.m7b=!1;this.$=La;this.cardViewShowHideCallback=nb}get njc(){return this.yVb}gKj(La,nb,Lb,ac,ib,Ra){this.bVd&&la.a.Ia(this.bVd);this.yVb=!1;this.m7b=!0;const ya=Y.Range.Qc(La,nb);this.bVd=ea.a.instance.create(()=>{!this.m7b||this.htb||!Lb&&this.cellRange&&this.cellRange.equals(ya)||-1===La&&-1===nb&&this.ep&&this.ep===Lb||this.cellRange&&this.cellRange.equals(ya)&&
this.ep&&this.ep===Lb||(b.ULS.sendTraceTag(42767442,0,50,"CardViewHoverManager: Showing a temporary error card."),this.cellRange=ya,this.ep=Lb,this.cardViewShowHideCallback.showCard(La,nb,Lb,ac,ib,Ra,!1))},300,Ba.a.Z1g,!0,!0)}sMa(La,nb,Lb){this.njc||(this.Xld&&la.a.Ia(this.Xld),this.m7b=!1,Y.Range.Qc(La,nb),this.Xld=ea.a.instance.create(()=>{this.m7b||this.htb||!(-1!==La||-1!==nb||this.ep&&this.ep===Lb)||(this.Zzf(),this.cardViewShowHideCallback.Tbf())},600,Ba.a.Y1g,!0,!0))}GOi(La){this.yVb=La}Zzf(){this.ep=
this.cellRange=null;this.htb=this.yVb=!1}r3f(La){this.htb=La;this.cellRange?this.htb||this.njc||this.sMa(this.cellRange.bottom,this.cellRange.left,this.ep):b.ULS.sendTraceTag(537168074,0,10,"SetCursorHoveringCard: cellRange is null, which means the card should be hidden.")}}Object(D.a)(Xa,"CardViewHoverManager",null,[]);var Za=a(60);const xa=(La,nb,Lb,ac,ib,Ra,ya,Va=null)=>{Va=La.Na(1,Va);Va.cardCell=nb;Va.cardType=Lb;return Za.g(La,"GetCardViewCardByCell",Va,ac,ib,Ra,ya,4)},fa=(La,nb,Lb,ac,ib,Ra,
ya,Va,oa=null)=>{oa=La.Na(1,oa);oa.cardId=nb;oa.keyPath=Lb;oa.cardType=ac;return Za.g(La,"GetUpdatedCardViewCard",oa,ib,Ra,ya,Va,4)},ua=(La,nb,Lb,ac,ib,Ra,ya=null)=>{ya=La.Na(1,ya);ya.cardId=nb;return Za.g(La,"CardViewReportContent",ya,Lb,ac,ib,Ra,0)};class sa{}sa.pqj={["IgnoreError"]:886009118,["ManageWorkbookLinks"]:-722953877};Object(D.a)(sa,"CustomCardActions",null,[]);var sb=a(83),hb=a(58),bb=a(42),lb=a(371),Fa=a(188),Na=a(29),Mb=a(282),dc=a(281);class Cb{constructor(La,nb,Lb,ac,ib,Ra){this.Xhb=
-1;this.pyb=!1;this.Fxa=!0;this.uV=La;this.$=nb;this.IM=ac;this.yfa=Lb;this.lug=Ra;sb.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ya=>{ya.isFeatureEnabled("mso_sendASmile",!1).then(Va=>{this.Fxa=Va;return null})})}get rH(){return this.yfa}get W1g(){return this.Xhb}get Yqb(){return this.lug}get dd(){return!this.uV}dispose(){this.uV=null}performCardAction(La,nb,Lb){this.dd||this.uV.performCardAction(La,nb,Lb)}notifyCardRendered(){this.pyb||(this.dd||this.uV.zxf(),
this.pyb=!0)}openUrl(La){this.dd||this.uV.openUrl(La)}closeCard(){this.dd||this.uV.closeCard()}getCardData(La){return this.Yqb?Promise.resolve(this.Yqb):-1===this.Xhb?this.Y2h():this.A6h(La)}Y2h(){return new Promise((La,nb)=>{const Lb=Ra=>{La(this.sLf(Ra))},ac=()=>{b.ULS.sendTraceTag(577345172,0,15,"onGetCardViewCardByCellFailure");nb(null)},ib=bb.o(Y.Range.Qc(this.yfa.UC.row,this.yfa.UC.column),this.$);lb.a(this.$.userOperationManager,(Ra,ya,Va)=>xa(this.$.pa.ya,ib,this.IM,dc.b(Ra,Lb),dc.a(ya,ac),
Va,null),Ra=>new Fa.a(101,0,Ra,80),null)})}A6h(La){return new Promise((nb,Lb)=>{const ac=Ra=>{nb(this.sLf(Ra))},ib=()=>{b.ULS.sendTraceTag(577345171,0,15,"onGetUpdatedCardViewCardFailure");Lb(null)};lb.a(this.$.userOperationManager,(Ra,ya,Va)=>fa(this.$.pa.ya,this.Xhb,La,this.IM,dc.b(Ra,ac),dc.a(ya,ib),Va,null),Ra=>new Fa.a(102,0,Ra,80),null)})}sLf(La){if(this.dd)return null;if(!La||Mb.a(La))return La=La?Na.a.sc(La.Errors):"(no result)",b.ULS.sendTraceTag(577345170,0,15,`CardViewHostService.ParseGetCardDataResult - result has errors: ${La}.`),
null;La=La.Result;if(!La)return null;La=hb.a.li(La);if(!La||!La.CardData)return null;-1===this.Xhb&&(this.Xhb=La.Id);this.UZj(La);this.iZj(La);b.ULS.sendTraceTag(537168070,0,50,"CardViewHostService.ParseGetCardDataResult - succeeded");return La}UZj(La){La=La.CardData;const nb=[];if(!this.Fxa&&La.actions){for(let Lb=0;Lb<La.actions.length;Lb++)"ReportContent"!==La.actions[Lb].actionId&&nb.push(La.actions[Lb]);La.actions=nb}}iZj(La){La=Object(aa.a)(new ia,{row:La.Row+1,column:La.Column+1,xfb:void 0===
La.TableColumn||null===La.TableColumn?-1:La.TableColumn});if(La.row!==this.yfa.UC.row||La.column!==this.yfa.UC.column||La.xfb!==this.yfa.UC.xfb)this.yfa.UC=La,this.uV.HLi()}}Object(D.a)(Cb,"DynamicDataCardViewHostService",null,[2,750]);class Tb{constructor(){this.o3a=null}expand(La,nb){this.o3a&&this.TUa();this.o3a=Y.Range.Qc(La,nb);La=String.format(B.a.NQe,La,nb);(La=$get(La))&&La.classList.add(X.xRe)}TUa(){if(this.o3a){var La=String.format(B.a.NQe,this.o3a.bottom,this.o3a.left);(La=$get(La))&&La.classList.remove(X.xRe);
this.o3a=null}}}Object(D.a)(Tb,"ErrorNotchStyleManager",null,[]);class Jb{constructor(La,nb,Lb){this.pyb=!1;this.uV=La;this.yfa=Lb;this.Yqb=nb}get rH(){return this.yfa}get dd(){return!this.uV}getCardData(){return Promise.resolve(this.Yqb)}performCardAction(La,nb,Lb){this.dd||this.uV.performCardAction(La,nb,Lb)}closeCard(){}notifyCardRendered(){this.pyb||(this.dd||this.uV.zxf(),this.pyb=!0)}openUrl(La){this.dd||this.uV.openUrl(La)}dispose(){this.uV=null}}Object(D.a)(Jb,"StaticDataCardViewHostService",
null,[2,750]);var eb=a(76),za=a(50),ha=a(37);a(13);var fb=a(145),rb=a(355);class pa{constructor(La,nb){this.rH=this.RSb=this.cB=null;this.vBe=0;this.xBe=1;this.IM=null;this.FOi=Lb=>{!Lb||Mb.a(Lb)?(Lb=Lb?Na.a.sc(Lb.Errors):"(no result)",b.ULS.sendTraceTag(51524299,0,15,`AdaptiveCardViewManager.OnCardViewReportContentSuccess - request has errors [Errors: ${Lb}].`)):b.ULS.sendTraceTag(537168081,0,50,"AdaptiveCardViewManager.OnCardViewReportContentSuccess - request succeeded.")};this.EOi=()=>{b.ULS.sendTraceTag(51524301,
0,15,"AdaptiveCardViewManager.OnCardViewReportContentFailed.")};this.Ey=()=>{this.cB&&this.cB.notifyCardChanged()};this.se=()=>{this.Ika()};this.$=La;this.behaviorsFactory=nb;La.ea.PE(this.Ey);La.ea.xa.Uf(this.se);m.h(La).Vb.Xk(this.se);La.da.Ga(243,this);this.fja=new Tb;this.t3=new Xa(this.$,this)}get dd(){return!this.$}get $Ha(){return this.RSb}set $Ha(La){this.RSb=La}showCard(La,nb,Lb,ac,ib,Ra,ya){if(Lb&&-1===La&&-1===nb)this.rH=new Z(Lb);else if(!Lb&&0<=La&&0<=nb)this.rH=new Ha(La,nb,-1);else{b.ULS.sendTraceTag(537168090,
0,15,"AdaptiveCardViewManager.ShowCard called with unexpected anchor information");return}this.LFh(ib)?(this.vBe=Ra?2:1,this.xBe=this.nmh(null==this.IM?0:this.IM),this.t3.GOi(ya),this.ibh()):this.Tbf()}Tbf(){!this.dd&&d.EwaSettings.ma(104)&&this.Ika()}w8f(La,nb,Lb){!this.dd&&d.EwaSettings.ma(104)&&(this.l6f(!0,nb),this.I9f(-1,-1,La,nb,pa.SHe(Lb),!1,!0))}Meb(La,nb,Lb,ac,ib){!this.dd&&d.EwaSettings.ma(104)&&(this.l6f(ib,Lb),this.I9f(La,nb,null,Lb,null,ac,ib))}sMa(La,nb,Lb){!this.dd&&d.EwaSettings.ma(104)&&
this.t3&&this.t3.sMa(La,nb,Lb)}updateCard(La){if(this.cB){const nb=Object(w.a)(Jb,this.$Ha);nb&&(nb.Yqb=pa.SHe(La),this.cB.notifyCardChanged())}}performCardAction(La,nb,Lb){this.Dai(La,nb,Lb)}openUrl(La){this.cB.openUrl(La)}closeCard(){this.Ika()}HLi(){this.cB?this.cB.OXf(this.rH):b.ULS.sendTraceTag(577345181,0,15,"AdaptiveCardViewManager.NotifyCardFirstRendered called with null CardControl")}zxf(){this.cB?(this.cB.fqj(this.vBe),b.ULS.sendTraceTag(51524291,0,50,"AdaptiveCardViewManager.NotifyCardFirstRendered")):
b.ULS.sendTraceTag(577345180,0,15,"AdaptiveCardViewManager.NotifyCardFirstRendered called with null CardControl")}I9f(La,nb,Lb,ac,ib,Ra,ya){ya?this.t3.gKj(La,nb,Lb,ac,ib,Ra):this.showCard(La,nb,Lb,ac,ib,Ra,!0)}l6f(La,nb){La?this.sMa(-1,-1,null):this.Ika();this.IM=nb}LFh(La){if(!this.rH)return b.ULS.sendTraceTag(577345179,0,15,"AdaptiveCardViewManager.CreateHostService called with null AnchorInfo."),!1;switch(this.IM){case 2:case 3:case 4:return this.$Ha=new Jb(this,La,this.rH),!0;case 1:case 0:return this.$Ha=
new Cb(this,this.$,this.rH,null==this.IM?0:this.IM,null,null),!0;default:return b.ULS.sendTraceTag(537168088,0,15,"AdaptiveCardViewManager.CreateHostService received unexpected card type. Failed to create host service"),!1}}OFh(){b.ULS.shipAssertTag(537168087,0,null!=this.IM);return 1===this.IM}ibh(){this.cB||(this.cB=new qa(this.$,this.OFh(),this.behaviorsFactory),this.cB.YMg(()=>{this.Ika()}),this.cB.yob(()=>{this.t3.r3f(!0)}),this.cB.zob(()=>{this.t3.r3f(!1)}));let La=!0;switch(this.IM){case 0:b.ULS.sendTraceTag(51524292,
0,50,"AdaptiveCardViewManager: Showing an Error Card.");this.fja.expand(this.rH.UC.row,this.rH.UC.column);La=this.t3.njc;break;case 2:b.ULS.sendTraceTag(589841040,0,50,"AdaptiveCardViewManager: Showing an AutoDetect Card.");this.fja.TUa();break;case 3:b.ULS.sendTraceTag(577345177,0,50,"AdaptiveCardViewManager: Showing a FormulaAssistance Card.");this.fja.TUa();break;case 4:b.ULS.sendTraceTag(537168086,0,50,"AdaptiveCardViewManager: Showing a NonTemplate Card.");this.fja.TUa();break;case 1:this.t3.njc?
b.ULS.sendTraceTag(51524293,0,50,"AdaptiveCardViewManager: Showing a permanent DataType Card."):b.ULS.sendTraceTag(537168085,0,50,"AdaptiveCardViewManager: Showing a temporary DataType Card.");this.fja.TUa();break;default:b.ULS.sendTraceTag(577345176,0,50,"AdaptiveCardViewManager: Showing an unknown type Card."),this.fja.TUa()}this.cB.Ktb=La;this.cB.rvc(this.RSb,this.rH,this.xBe,1===(null==this.IM?0:this.IM))}Ika(){this.rH=this.IM=null;this.t3&&this.t3.Zzf();this.fja&&this.fja.TUa();this.cB&&(this.cB.dispose(),
this.cB=null);if(this.$Ha){const La=Object(w.a)(2,this.RSb);La&&La.dispose();this.$Ha=null}}nmh(La){switch(La){case 0:return 0;case 2:return 2;default:return 1}}Dai(La,nb,Lb){Lb=Object(w.a)(Object,Lb);switch(nb){case e.a.V1g:const ac=Object(w.a)(Cb,this.$Ha);ac&&(this.cB.a5b(La,nb),lb.a(this.$.userOperationManager,(Ra,ya,Va)=>ua(this.$.pa.ya,ac.W1g,dc.b(Ra,this.FOi),dc.a(ya,this.EOi),Va,null),Ra=>new Fa.a(103,0,Ra,80),null));break;case e.a.T1g:if(Lb&&e.a.uBe in Lb){const Ra=Lb[e.a.uBe].toString();
let ya=this.rH.UC.xfb;-1===ya&&(ya=null);const Va=this.rH.UC.row-1,oa=this.rH.UC.column-1;nb=za.GetServiceTaskFactory.Oa(this.$.da,261,262,0);ha.TaskExtensions.Aa(nb,()=>{if(!this.dd){const kb=new f.a(639960842,eb.a.Db,this.$.Hc,9,null);this.$.Ka.Lb(kb,{["LabelText"]:Ra,["MenuItemId"]:Ra,["ColumnIndex"]:ya,["SourceCardKeyPath"]:La,["SourceCardRow"]:Va,["SourceCardColumn"]:oa})}},this.$.la,3);fb.a("CardViewExtractFieldAction");this.Ika()}else b.ULS.sendTraceTag(51524294,0,15,"AdaptiveCardViewManager.HandleAction - CardActionCopyToGrid does not contain field property!");
break;case e.a.U1g:b.ULS.sendTraceTag(537168084,0,50,"AdaptiveCardViewManager.HandleAction: Invoked CardActionHelpLink.");Lb&&e.a.wBe in Lb?(this.Ika(),nb=Lb[e.a.wBe].toString(),n.AFrameworkApplication.disableWholeAppsForOfficeFeature?rb.b(1,this.$.JG,nb,this.$.KS):(Lb=new f.a(-859308420,eb.a.Db,this.$.Hc,9,null),this.$.Ka.Lb(Lb,{[eb.a.lg]:"HelpID="+nb,["InputMethod"]:eb.a.Db,["ShouldCanvasTakeFocus"]:!0,[eb.a.Ic]:B.a.tV,[B.a.Uoa]:!0}))):b.ULS.sendTraceTag(51524296,0,15,"AdaptiveCardViewManager.HandleAction - CardActionHelpLink does not contain CardHelpId!");
break;default:const ib=sa.pqj[nb];ib&&(b.ULS.sendTraceTag(537168082,0,50,`AdaptiveCardViewManager.HandleAction: Invoking an action for ${nb}.`),this.Osh(),this.Ika(),nb=new f.a(ib,eb.a.Db,this.$.Hc,9,null),this.$.Ka.Lb(nb,Lb))}}Osh(){const La=m.h(this.$).ha,nb=Y.Range.Qc(this.rH.UC.row,this.rH.UC.column);La.ra.activeCell.equals(nb)||(La.ra.Mg&&La.ra.$c.contains(nb)?La.updateSelection(La.ra.$c,nb,0):La.updateSelection(nb,nb,0))}dispose(){this.Ika();this.$&&(this.$.ea.dE(this.Ey),this.$.xa.Bg(this.se),
m.h(this.$).Vb.Fk(this.se),this.$=null);this.fja=this.t3=null}static SHe(La){const nb={Id:1};nb.CardData=La;return nb}}Object(D.a)(pa,"AdaptiveCardViewManager",null,[2,696,697,698]);var Ma=a(184);class Ja extends r.a{constructor(La){super();this.$=La;this.Fb()}create(){if(!this.$.da.za(243)){var La=this.tAi(),nb=za.GetServiceTaskFactory.Oa(this.$.da,389,390,this.Ya);ha.TaskExtensions.Aa(ha.TaskExtensions.Fd([La,nb],this.la),()=>{const Lb=new pa(this.$,nb.result);this.ob(Lb);this.$.da.Ga(399,Lb)},
this.la,3)}}tAi(){const La=za.GetServiceTaskFactory.jka(this.$.da,283,284,this.Ya).then(nb=>nb.pn.loadScript("cardviewui"),nb=>Promise.reject(nb));return Ma.c(La)}static ka(La){La.da.Ga(242,new Ja(La))}}Object(D.a)(Ja,"CardViewManagerFactory",r.a,[]);var Ga=a(9);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.CardView");Type.registerNamespace("_Ewa");u.a.Mi(".ewa-cardview-container{display:flex;flex-direction:column;position:absolute;background-color:#fff;z-index:992;box-shadow:0 0 15px rgba(0,0,0,.2);transition:opacity .1s ease-in;opacity:0}.ewa-cardview-container-afterinsert{opacity:1}.ewa-cardview-container-rtl{direction:rtl}.ewa-cardview-err-notch{border-width:6px}");
(()=>{Ga.a.Fa(La=>{Ja.ka(La);z.ka(La)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.cardview.js.map/e6c03509111ea24629d8e87cea305c81/EwaDSEsNext.cardview.js.map