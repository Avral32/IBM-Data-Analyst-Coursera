'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1078:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1079:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}xs(){return this.command}}Object(u.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[125])},1080:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1081:function(u,D,a){a.d(D,"a",function(){return"FieldInfoListContextLoaded"});a.d(D,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(D,"d",function(){return"Days from Today"});a.d(D,"g",function(){return"Years from Today"});a.d(D,"c",function(){return"Day of the Week"});a.d(D,"f",function(){return"Month of the Year"});a.d(D,"e",function(){return"End of Month"});a.d(D,"b",function(){return"Next Day"})},1082:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>
{c.a.Mi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1083:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1084:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(u.b)("DataValidationRuleType",c)},1086:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi(".ewa-facp-text-box{position:absolute}")}},1087:function(u,D,a){a.d(D,"b",function(){return"MinorThemeFont"});
a.d(D,"a",function(){return"MajorThemeFont"})},1089:function(u,D,a){a.d(D,"a",function(){return b});var c=a(511);const b=()=>{c.a.Mi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1090:function(u,D,a){a.d(D,"a",function(){return m});u=a(0);D=a(238);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class m extends D.a{constructor(l){super(document.createElement("div"));this.rR=this.xJa=this.wJa=this.yJa=this.AJa=this.zJa=!1;this.rJ=null;this.visible=void 0;this.wpc=(v,t)=>{this.Tt(v,t)};this.FMa=()=>{this.Za.textBox.LF=!0};this.Fza=()=>{this.mz(!0)};this.zzf=()=>{this.Za.textBox.focus()};this.Ph=()=>{f.h(this.$).inRangePicker||(this.qe=!1)};this.$=l;f.h(l)&&f.h(l).ha&&f.h(this.$).ha.iH(this.Ph);
this.Zk=b.a.k5(l)}get sI(){return this.ou.sI}get qe(){return this.ou.qe}set qe(l){this.ou.qe=l}get Za(){return this.rJ}set Za(l){(this.rJ=l)&&this.rJ.V2d.add(this)}get SKh(){return b.a.DN(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(l){if(this.visible===l)return l;this.visible=l;return super.set_visible(l)}Tt(){this.ECa(!1);this.ou.Tt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.rL(this.Ph);this.$=null;super.dispose()}Xh(l,
v,t=!1){l=!1;if((this.b2a||t)&&!this.Kxa()&&this.get_visible()&&this.qe)switch(this.Zk&&this.BDc(v),v){case 1872288872:this.qe=!1;l=!0;break;case -798660877:this.ou.IB(1);l=!0;break;case 137938150:this.ou.IB(-1);l=!0;break;case 2091832999:this.ou.IB(this.sI-1);l=!0;break;case 742457698:this.ou.IB(-(this.sI-1));l=!0;break;case 125627505:l=this.mz(!1);break;case 267796030:b.a.k5(this.$)&&(l=this.mz(!1))}return l}ECa(l){if(this.qe||l){var v=f.h(this.$);l=v.domElement;var t=this.rJ.textBox.domElement,
z=d.a(this.$).yi(t.offsetHeight),r=d.a(this.$).yi(t.offsetTop),n=d.a(this.$).yi(t.offsetWidth);t=d.a(this.$).yi(t.offsetLeft);v=v.Vl;var w=h.AFrameworkApplication.sa&&h.AFrameworkApplication.sa.Pa.Ye,B=$get(this.$.Eb+c.a.c1a,this.$.domElement);w&&(B=document.getElementById("EditorContainer"));var A=new Sys.UI.Point(v?this.ou.obc:0,v?this.SKh:m.X8h);z=B.offsetTop+A.y+(b.a.DN(this.$)&&v?0:z+r);this.$.v_||(r=$get(c.a.Nsa,this.$.domElement),z+=r&&!w?r.offsetHeight:0);r=this.domElement;r.style.top=e.HelperMethods.uc(z);
t=B.offsetLeft+t+A.x;!b.a.DN(this.$)&&this.$.isChromeRtl?r.style.right=e.HelperMethods.uc(v?this.ou.obc:l.offsetLeft+l.offsetWidth-t-n):r.style.left=e.HelperMethods.uc(t)}}fUa(l){this.ou&&(l&&!this.rR?(this.ou.i$(this.zzf),this.ou.g0b(this.FMa),this.ou.Dob(this.Fza),this.rR=!0):this.rR&&(this.ou.Qda(this.zzf),this.ou.Wuc(this.FMa),this.ou.nKb(this.Fza),this.rR=!1))}BDc(l){switch(l){case -798660877:case 137938150:case 2091832999:case 742457698:this.zJa=!0;break;case 125627505:this.yJa=!0;break;case 267796030:b.a.k5(this.$)&&
(this.wJa=!0)}}}m.obc=0;m.X8h=1;Object(u.a)(m,"AutoCompleteControl",D.a,[521])},1091:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.tG=f;this.description=d}}Object(u.a)(c,"ListEventArgs",Sys.EventArgs,[])},1092:function(u,D,a){a.d(D,"a",function(){return r});u=a(0);var c=a(15),b=a(27);D=a(837);var e=a(775),f=a(5),d=a(76),h=a(33),m=a(12),l=a(1),v=a(117),t=a(21),z=a(908);class r extends D.a{constructor(n,
w){super(n,w,new z.a(e.a.listItem,e.a.pDb,e.a.sDb,e.a.tDb));this.Hec=!1;this.Cmb=this.vp=null;this.EZe=!1;this.visible=void 0;this.VBa(!0);this.EZe=l.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get obc(){if(h.a.DN(this.$)){var n=document.getElementById(this.$.Eb+f.a.DZe);return!this.EZe||n?m.DOMElementExtensions.getBoundingClientRect(n).x:0}n=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.iAd):document.getElementById(this.$.Eb+
f.a.iAd+"-"+f.a.uwf);c.ULS.shipAssertTag(537170323,0,!!n||this.$.LK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return n?n.offsetWidth:0}get ee(){return this.Cmb}set ee(n){this.Cmb=n}get qe(){return void 0!==this.visible?this.visible&&0<this.vp.length:(this.visible=m.DOMElementExtensions.isVisible(this.If))&&0<this.vp.length}set qe(n){this.visible!==n&&(m.DOMElementExtensions.setVisible(this.If,n),m.DOMElementExtensions.setVisible(this.HUa,n),this.visible=
n);const w=t.h(this.$).view;n?this.Hec||(w.nt(this.tHa.wpc),this.Hec=!0):(this.vp.length=0,this.Hec&&(w.ir(this.tHa.wpc),this.Hec=!1))}Xya(){var n=460;const w=t.h(this.$);var B=w.domElement,A=this.HUa.style;const y=this.If.offsetTop+this.Nj.offsetHeight*this.Nj.sectionRowIndex-this.If.scrollTop;A.width="auto";A.whiteSpace="nowrap";A.position="absolute";const x=B.offsetLeft+B.offsetWidth-(this.domElement.offsetLeft+this.If.offsetLeft+this.If.offsetWidth+3);B=this.domElement.offsetLeft-3-(B.offsetLeft+
this.obc);n=Math.min(this.HUa.offsetWidth,n,Math.max(x,B));m.DOMElementExtensions.Xv(this.HUa,n);A.whiteSpace="";A.position="absolute";y+3>this.If.offsetTop+this.If.offsetHeight||y<this.If.offsetTop||(n=this.If.offsetLeft-3-this.HUa.offsetWidth,A=this.If.offsetLeft+this.If.offsetWidth+3,m.DOMElementExtensions.updatePosition(this.HUa,B>x!==w.rtl?n:A,y,!1))}IB(n){super.IB(n);this.Xya()}Tt(){this.Xya()}Fsa(){const n=this.Ln,w=this.If,B=3===d.a.Db||b.a.Fp,A=B?this.oEb:this.sI;this.qe=!0;w.style.height=
"auto";this.tHa.set_visible(!0);this.kob(n,B);this.vp.length>A&&(m.DOMElementExtensions.iJ(w,Math.floor(w.offsetHeight*A/this.vp.length)),w.style.overflowY="auto");m.DOMElementExtensions.Xv(w,n.offsetWidth+(this.vp.length>A?v.a.Ou:0))}}Object(u.a)(r,"AutoCompleteListBox",D.a,[])},1093:function(u,D,a){a.d(D,"a",function(){return t});u=a(0);var c=a(224),b=a(14),e=a(107),f=a(239);D=a(238);var d=a(732),h=a(5),m=a(53),l=a(12),v=a(71);class t extends D.a{constructor(z,r,n,w,B,A,y,x,F,I){super(document.createElement("a"));
this.qn=!1;this.hd=L=>{this.raiseEvent("ClickButton",L);return!0};this.onKeyDown=L=>{this.raiseEvent("KeyDown",L);return!1};this.Ww=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.iO=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=L=>{v.g(L);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=L=>{v.g(L);this.focused=!0;this.raiseEvent("Focus")};this.osh=x;this.Bnh=F;this.xJ=t.pb(this.domElement,r,n,w,B,A,y,I);this.Gc.ka("contextmenu",L=>{v.g(L)});this.enable();
this.focused=this.hovered=!1;z.appendChild(this.domElement)}lXc(z){this.get_events().addHandler("ClickButton",z)}gMd(z){this.get_events().removeHandler("ClickButton",z)}xXc(z){this.get_events().addHandler("KeyDown",z)}tMd(z){this.get_events().removeHandler("KeyDown",z)}v0b(z){this.get_events().addHandler("PointerOver",z)}EMd(z){this.get_events().removeHandler("PointerOver",z)}u0b(z){this.get_events().addHandler("PointerOut",z)}DMd(z){this.get_events().removeHandler("PointerOut",z)}qob(z){this.get_events().addHandler("Blur",
z)}ZJb(z){this.get_events().removeHandler("Blur",z)}i$(z){this.get_events().addHandler("Focus",z)}Qda(z){this.get_events().removeHandler("Focus",z)}get Fl(){return this.xJ}get isEnabled(){return this.qn}enable(){this.domElement&&(this.domElement.classList.remove(d.a.uU),this.domElement.style.cursor="",c.a.instance.ta(b.a.click,this.domElement,this.hd),e.KeyInputManager.instance.ta(b.a.Ob,this.domElement,this.onKeyDown),f.a.instance.ta(b.a.pointerOver,this.domElement,this.Ww),f.a.instance.ta(b.a.pointerOut,
this.domElement,this.iO),this.Gc.Ni("blur")||this.Gc.ka("blur",this.onBlur),this.Gc.Ni("focus")||this.Gc.ka("focus",this.onFocus),this.domElement.title=this.osh,this.qn=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.uU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.hd),e.KeyInputManager.instance.Ba(b.a.Ob,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Ww),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.iO)),this.domElement.title=this.Bnh,this.qn=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.hd),e.KeyInputManager.instance.Ba(b.a.Ob,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Ww),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.iO),this.qn=!1);l.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(z,r,n,w,B,A,y,x){z.removeAttribute("Href");z.setAttribute(h.a.Ld,h.a.ot);z.className=r;z.tabIndex=
x;r=document.createElement("span");r.className=y;r.classList.add(n);r.tabIndex=-1;z.appendChild(r);z=document.createElement("img");z.src=m.a.Ge(w);z.className=B;z.alt=A;z.tabIndex=-1;r.appendChild(z);return z}}Object(u.a)(t,"ListButton",D.a,[280,2])},1094:function(u,D,a){a.d(D,"a",function(){return d});u=a(0);var c=a(109),b=a(28),e=a(1),f=a(725);class d{constructor(l){this.Dvf=l;this.pW=Object.assign({},m);this.eub=[];this.Ymc=-1;(this.Cvf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
l&&(this.pW.countAboveThresholds={},l.forEach(v=>this.pW.countAboveThresholds[v]=0))}static get kZd(){return b.a.Qa.ue.m}XTa(){this.Ymc=d.kZd}o4(l,v=null){if(-1!==this.Ymc||Object(f.b)(v))l?(this.iob(d.kZd-(v||this.Ymc)),this.Ymc=-1):this.pW.failedCount++}CXe(){this.pW.excludingFirstAction=d.BXe(this.eub);this.eub.push(this.pW.firstAction);this.pW.includingFirstAction=d.BXe(this.eub)}iob(l){this.pW.count?1E3>this.pW.count&&this.eub.push(l):this.pW.firstAction=l;this.Cvf&&this.Dvf&&this.Dvf.forEach(v=>
{l>v&&this.pW.countAboveThresholds[v]++});this.pW.count++}static BXe(l){const v=Object.assign({},h);0<l.length&&(c.i(l),v.median=l[Math.floor(.5*l.length)],v.P75=l[Math.floor(.75*l.length)],v.P95=l[Math.floor(.95*l.length)],v.max=l[l.length-1],v.average=c.g(l,t=>t)/l.length);return v}}Object(u.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},m={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1137:function(u,D,a){function c(ba){var cb=Object(I.h)(ba),Kb=Object(X.a)(ba);const lc=cb.zi;var Qc=cb.fc.vkf;Qc=cb.Vl||Qc;Kb=b((Qc?Kb:lc).textBox.domElement);if(Qc)cb={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(cb=b(cb.domElement),{zoom:ba}=Object(P.a)(ba),1!==ba)for(const Rc of[Kb,cb])for(const zd in Rc)Rc[zd]*=ba;return{target:Kb,bounds:cb}}function b(ba){const {top:cb,left:Kb,right:lc,bottom:Qc}=ba.getBoundingClientRect();return{top:cb,left:Kb,right:lc,bottom:Qc}}function e(ba){var cb;
if(ba){var Kb=new Zd(0===ba.kind);ba=null===(cb=null===ba||void 0===ba?void 0:ba.rangeInfo)||void 0===cb?void 0:cb.positionKindInfo;if(!ba)return Kb;Kb.RF=0===ba.firstRow;Kb.QF=0===ba.firstColumn;Kb.GK=0===ba.secondRow;Kb.FK=0===ba.secondColumn;return Kb}}var f=a(9),d=a(0),h=a(692),m=a(50),l=a(37),v=a(15),t=a(19),z=a(382),r=a(76);class n{}n.Bbd="!";n.zKf="[";n.yKf="]";n.openParen="(";n.closeParen=")";n.rmg=" /.(*\\".split("");n.u9b="...";n.yHb="param_help_link";n.YFd="param_help_udf";n.qed="function_list_box";
n.PLh="function_param_box";n.ted="function_reader_description";n.med="function_description_box";n.WZe="function_param_table";n.A3i="param_row_";n.zrc="param_set";n.kLf="param_row_0";n.lLf="param_row_1";n.QLh="<div id='{0}' class='{1}'></div>";n.OLh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";n.mLf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
n.LLh="<div id='{0}' class='{1} {2} {3}'></div>";n.JLh="<div id='{0}' class='{1} {2} {3} {4}'></div>";n.Gpf="[@";n.Fah=1;n.Eah=3;n.Skh=500;n.Zuf=50;Object(d.a)(n,"FormulaAssistanceConstants",null,[]);var w=a(13),B=a(284),A=a(8),y=a(5),x=a(91),F=a(11),I=a(21),L=a(355),X=a(113),P=a(34),G=a(437),C=a(229);const H=(ba,cb,Kb)=>{if(ba){const lc=ba.da.za(491);lc?lc.SP.argumentAssistanceLearnMoreCounter++:v.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");
Kb?M(ba,cb,Kb):(Kb=new x.a(-859308420,r.a.Db,ba.Hc,0,null),ba.Ka.Lb(Kb,{[r.a.Ic]:y.a.tV,[r.a.lg]:"HelpID="+cb}))}},J=(ba,cb,Kb)=>{const lc={};lc[y.a.GQ]=cb;cb={};cb.FunctionName=Kb;lc[y.a.fcd]=cb;ba.Xc(802602464,0,8,lc)},M=(ba,cb,Kb)=>{if(Kb){if(cb&&(!cb||cb.startsWith("http://")||cb.startsWith("https://"))){if(ba.ma(156)&&(ba=Object(G.a)({FFb:269,new:C.c,registry:ba.da}))&&ba.jpa(cb))return;F.HelperMethods.lf(cb,"_blank",L.a)}}else F.HelperMethods.hW(ba.JG,"XLWAEndUser_"+cb,ba.KS)},S=ba=>{let cb=
A.a.e0;const Kb=ba.da.za(368);Kb&&!Object(I.h)(ba).Vl&&(cb=Kb.zoom);return cb};var W;(function(ba){ba.CategoryList="categoryList";ba.FunctionsMap="functionsMap";ba.FunctionIdsToDisplay="functionIdsToDisplay";ba.RefreshListCallback="refreshListCallback";ba.HelpCallback="helpCallback";ba.feedbackCallback="giveFeedbackCallback";ba.InitialCategory="initialCategory";ba.AllCategoryName="allFunctionsCategoryName"})(W||(W={}));Object(d.b)("PropsKeys",W);class O extends B.a{constructor(ba){super(ba);this.RZe=
(cb,Kb)=>{1===cb&&(this.hide(),Kb=Kb.functionName,cb=0<this.functionInfoManager.h3e(Kb).Params.length,Kb={[r.a.Ic]:Kb,["ibdk"]:!0},cb=new x.a(cb?1117706454:-433697611,0,this.$.Hc,8,null),this.$.Ka.Lb(cb,Kb))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);this.uef()};this.Bci=cb=>{M(this.$,cb,!1)};this.LRi=cb=>{this.hide();J(this.$,"InsertFunctionDialog",cb)};this.skf=cb=>!this.functionInfoManager.vic(cb);this.Ql=w.a.instance.ga(1029);this.functionInfoManager=
ba.da.za(19);this.dg()}get pc(){return"FunctionDialog"}dg(){this.functionInfoManager.VJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.GV?this.uef():this.functionInfoManager.MGa(this.onFunctionInfoLoaded)}uef(){var ba;this.$0b=this.functionInfoManager.wbc.filter(this.skf);const cb=null!==(ba=O.xof)&&void 0!==ba?ba:O.Q7g;ba=this.functionInfoManager.led;const Kb=this.functionInfoManager.Qcc(cb).map(lc=>lc.FunctionIndex);this.Pq={[O.vu]:this.pc,[W.CategoryList]:ba,
[W.FunctionsMap]:this.xdh(),[W.FunctionIdsToDisplay]:Kb,[W.RefreshListCallback]:this.aVi.bind(this),[W.feedbackCallback]:this.LRi.bind(this),[W.HelpCallback]:this.Bci,[W.InitialCategory]:cb,[W.AllCategoryName]:O.AllCategoryName};this.initializeAndShow(this.Ql,this.RZe,this.Pq)}xdh(){let ba={};this.$0b.forEach(cb=>{ba[cb.FunctionIndex]=cb});return ba}LZj(ba){ba=ba.map(cb=>cb.FunctionIndex);this.Pq[W.FunctionIdsToDisplay]=ba;this.YUa(this.Ql,this.y5a(this.RZe),this.Pq)}aVi(ba,cb){cb?cb=this.mHh(cb):
(cb=this.functionInfoManager.Qcc(ba).filter(this.skf),O.xof=ba);this.LZj(cb)}mHh(ba=""){ba=ba.toLocaleLowerCase();const cb=this.$0b.filter(({NameUI:Kb})=>Kb.toLocaleLowerCase().startsWith(ba));3<=ba.length&&(cb.push(...this.$0b.filter(Kb=>Kb.NameUI.toLocaleLowerCase().includes(ba)&&!cb.includes(Kb))),cb.push(...this.$0b.filter(Kb=>Kb.Help.toLocaleLowerCase().includes(ba)&&!cb.includes(Kb))));return cb}}O.AllCategoryName=w.a.instance.ga(1028);O.Q7g=w.a.instance.ga(1027);O.xof=void 0;Object(d.a)(O,
"FunctionDialog",B.a,[]);var T=a(55),Y=a(66),va=a(33),ca=a(87),V=a(27),ra=a(210),N=a(68),ea=a(108),Ba=a(226),ka=a(53),Ka=a(735),Oa=a(12),wa=a(71),qa=a(1);const aa=N.a.$vh,ia=N.a.kwh,Ha=N.a.lwh,Z=N.a.PRe,la=N.a.bwh,Xa=N.a.fwh,Za=N.a.MRe,xa=N.a.SRe,fa=N.a.dwh,ua=N.a.NRe;class sa extends ra.a{constructor(ba,cb){super(ba,w.a.instance.ga(1029),void 0,void 0,void 0,qa.EwaSettings.ma(391));this.$vb=this.Lqf=this.YZe=this.VZe=this.Nja=this.UZe=this.cwb=this.NKa=this.Oja=this.OKa=null;this.Mld=!1;this.Nyb=
this.UEb=this.B3b=null;this.onFunctionInfoLoaded=()=>{if(!this.NKa.count){const Kb=this.functionInfoManager.led;for(let lc=0,Qc=Kb.length;lc<Qc;++lc)this.NKa.DY(Kb[lc],Kb[lc],!1).className=N.a.awh;this.NKa.selectedIndex=0;ca.a.qc([this.B3b,this.UEb,this.Nyb]);this.B3b=this.Be.Zd(this.OKa);this.UEb=this.Be.Zd(this.Oja);this.Nyb=this.Be.Zd(this.$vb);this.B3b.ka("change",this.OCf);this.UEb.ka("change",this.zSi);this.UEb.ka("dblclick",this.ASi);this.Nyb.ka("click",this.ada);this.Nyb.ka("keyup",this.HUi);
Oa.DOMElementExtensions.setVisible(this.Oja,!0);Oa.DOMElementExtensions.setVisible(this.UZe,!1);this.$.C7c&&Oa.DOMElementExtensions.setVisible(this.Lqf,!0)}this.OCf(null);this.getButton(0).get_element().disabled=!1;this.OKa.disabled=!1;this.PSa();this.Mld=!0};this.ada=()=>{this.paa&&H(this.$,this.paa.HelpId,this.paa.IsDynamicUdf)};this.HUi=Kb=>{13!==Kb.keyCode&&32!==Kb.keyCode||this.ada(Kb)};this.OCf=()=>{const Kb=this.functionInfoManager.Qcc(this.NKa.ee.value);this.x4a(Kb);this.Oja.scrollTop=0;this.p3f()};
this.zSi=()=>{this.p3f()};this.ASi=Kb=>{this.paa&&(wa.g(Kb),this.close(0))};this.Tc=(Kb,lc)=>{Ba.b(lc)&&this.sv()};this.functionInfoManager=ba.da.za(19);this.formulaAssistanceControl=ba.da.za(221);if(this.Svb=va.a.DV(this.$))this.formulaAssistanceManager=ba.da.za(464);this.$M=cb}get pc(){return"FunctionDeprecatedDialog"}get paa(){if(!this.Oja||!this.Oja.firstChild)return null;const ba=Number.parseInvariant(this.Oja.children[this.Oja.selectedIndex].value);return this.functionInfoManager.MWh(ba)}initialize(){this.Qb.classList.add(N.a.Yvh);
this.Qb.innerHTML=sa.vH();this.Mf||(this.Ot(),this.vsa());super.initialize();const ba=Oa.DOMElementExtensions.ik(this.Qb,ua);this.rtl&&(ba.align="right",this.$vb.style.marginLeft="5px");this.Mf&&(ba.style.padding="1px");this.functionInfoManager.VJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&(this.functionInfoManager.Dcb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.qk(this.Tc));ca.a.qc([this.B3b,this.UEb,this.Nyb,this.NKa,this.cwb]);super.dispose()}Ot(){this.OKa=
Oa.DOMElementExtensions.ik(this.Qb,aa);this.Oja=Oa.DOMElementExtensions.ik(this.Qb,ia);this.OKa.setAttribute(y.a.Ld,y.a.B1b);this.NKa=new Ka.a(this.OKa,!0);this.cwb=new Ka.a(this.Oja,!0);this.UZe=Oa.DOMElementExtensions.ik(this.Qb,Xa);this.$vb=Oa.DOMElementExtensions.ik(this.Qb,la);this.YZe=Oa.DOMElementExtensions.ik(this.Qb,xa);this.Lqf=Oa.DOMElementExtensions.ik(this.Qb,fa);this.VZe=$get(sa.ned,this.Qb);this.Nja=Oa.DOMElementExtensions.ik(this.Qb,Za);this.Mf&&(this.Nja.style.paddingLeft="1px");
this.functionInfoManager.MGa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Tj(this.Tc)}aR(ba){this.$.da.$a(40,()=>{this.NKa.aR(ba)})}vq(){this.Svb?this.formulaAssistanceManager.w8b():this.formulaAssistanceControl.set_visible(!1);super.vq();this.Mld||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.OKa.disabled&&this.Mld&&Oa.DOMElementExtensions.setFocus(this.OKa)}commit(){return!0}Nrb(){let ba=this.paa.NameDataStrings;const cb=new x.a(-433697611,0,this.$.Hc,8,null);this.$.Ka.Lb(cb,
{[r.a.Ic]:ba})}jta(){this.Svb?this.formulaAssistanceManager.Vda():this.formulaAssistanceControl.Apb()}x4a(ba){this.cwb.clear();const cb=sa.ned+" "+sa.PZe;for(let Kb=0,lc=ba.length;Kb<lc;++Kb){const Qc=this.cwb.DY(ba[Kb].NameUI,ba[Kb].FunctionIndex.toString(),!1);V.a.vy&&Qc.classList.add(Z);Qc.setAttribute(y.a.UP,sa.QZe);Qc.setAttribute(y.a.MJ,cb)}this.cwb.selectedIndex=0}p3f(){if(this.paa){this.$vb.parentNode.className=N.a.NRe+(this.functionInfoManager.vic(this.paa)?"-udf":"");var ba=this.paa.NameDataStrings;
this.YZe.innerText=ba;this.$vb.innerText=ba;this.Nja.innerText=this.paa.Help;ba=this.paa.Params.split(n.Bbd);this.VZe.innerText=n.openParen+(1<ba.length?n.u9b:ba[0])+n.closeParen}}static vH(){return String.format("<div class='"+N.a.Zvh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+ea.a.qp+"'>{1}</div>\r\n<div class='"+N.a.Xvh+"'>\r\n\t<select id='{16}' class='{17} "+t.a.hq+" "+t.a.rp+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+
N.a.cwh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+t.a.hq+"'>\r\n\t\t\t<span class='"+t.a.Rx+" "+N.a.ewh+"'>\r\n\t\t\t\t<img title='{3}' class='"+t.a.pBh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",w.a.instance.ga(1032),w.a.instance.ga(1033),w.a.instance.ga(736),w.a.instance.nb(3),
ka.a.Ge(13),w.a.instance.ga(1034),sa.ILh,sa.ned,7,aa,la,Xa,Za,xa,fa,ua,sa.MLh,ia+(V.a.vy?" "+Ha:""),sa.PZe,sa.QZe)}}sa.ned="function_dialog_param_string";sa.PZe="function_dialog_function_description";sa.QZe="function_dialog_function_name";sa.MLh="function_list";sa.ILh="function_category";Object(d.a)(sa,"FunctionDeprecatedDialog",ra.a,[]);var sb=a(261),hb=a(22);class bb extends B.a{constructor(ba,cb,Kb,lc){super(ba);this.awb=cb;this.formulaAuthoringHelper=Kb;this.S9f=lc;this.FLh=(Qc,Rc)=>{var zd;if(1===
Qc){this.hide();Qc=this.awb.NameUI;for(Rc=null!==(zd=Rc.functionArgs)&&void 0!==zd?zd:[];1<Rc.length&&hb.a.ph(Rc[Rc.length-1]);)Rc.pop();zd={[r.a.Ic]:Qc,["functionArgs"]:Rc,["ibdk"]:!0};Rc=new x.a(-433697611,0,this.$.Hc,8,null);this.$.Ka.Lb(Rc,zd)}};this.zPh=Qc=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.S9f,this.awb,Qc);this.Ql=w.a.instance.ga(1030);this.dg()}get pc(){return"FunctionArgumentsDialog"}dg(){this.Rb=1;this.Pq={[sb.a.vu]:this.pc,["functionInfo"]:this.awb,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.S9f,
this.awb),["evaluateCallback"]:this.b0g,["generateArgByIndex"]:this.zPh,["helpCallback"]:this.hW,["isModal"]:!1};this.initializeAndShow(this.Ql,this.FLh,this.Pq)}hW(){M(this.$,this.awb.HelpId,!1)}b0g(){return"42"}}Object(d.a)(bb,"FunctionArgumentsDialog",B.a,[]);class lb{constructor(ba,cb,Kb){this.$=ba;this.Va=cb;this.functionInfoManager=Kb;this.KLh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=
null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.KLh.includes(this.menuId)&&this.frame.rx(this.menuId)};this.DV=va.a.DV(this.$);this.eBb=va.a.lkf();this.DV&&(this.formulaAssistanceManager=this.$.da.za(464));this.RY={};this.frame=this.$.frame;this.functionInfoManager.MGa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=ba.da.za(491)}nc(ba,cb){switch(cb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return ba=
I.h(this.$).zi,ba.F6a||!ba.eb||0>=ba.text.length?!1:!0;default:return!1}}executeCommand(ba,cb,Kb){var lc,Qc;ba=cb.command;const Rc=I.h(this.$),zd=Rc.zi;switch(ba){case 753860909:case -2060563418:null===(lc=this.formulaAssistanceManager)||void 0===lc?void 0:lc.w8b();Rc.inRangePicker&&zd.XE(!1);this.eBb?new O(this.$):(new sa(this.$,zd)).ug();this.formulaAssistanceTelemetryManager.p4a.dialogShownCounter++;break;case 1117706454:null===(Qc=this.formulaAssistanceManager)||void 0===Qc?void 0:Qc.w8b();Rc.inRangePicker&&
zd.XE(!1);const ae=this.functionInfoManager.h3e(Kb[r.a.Ic]);lc=hb.a.XTf(ae.Params).split("!")[0];const ze=""!==lc?lc.split(this.$.listSeparator).filter(Ce=>"..."!==Ce):[];l.TaskExtensions.XJ(m.GetServiceTaskFactory.Oa(this.$.da,520,521,0),Ce=>{new bb(this.$,ae,Ce.result,ze)},this.$.la,3);Kb.ibdk?this.formulaAssistanceTelemetryManager.p4a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.p4a.argsDialogOpenedByRibbonCounter++;break;case -433697611:lc=Kb.functionArgs;Kb.ibdk&&
(void 0!==lc?this.formulaAssistanceTelemetryManager.p4a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.p4a.dialogCommitedCounter++);let Be=Kb[r.a.Ic]+n.openParen;this.eBb&&(void 0!==lc&&(Be+=lc.join(this.$.listSeparator)),Be+=n.closeParen);Kb.UILocation&&this.$.Xc(-1075437823,-1,0,null);Rc.view.visibleArea.contains(Rc.ag(null))||Rc.Ht(Rc.ha.ra.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const xe=zd.textBox;Kb=zd.textBox.caretPosition;zd.eb&&zd.text?(lc=zd.text,
Qc=Kb?lc.substring(0,Kb):"=",zd.text=Qc+Be+lc.substring(Kb+(xe.Sy?xe.Sy.length:0),lc.length),xe.caretPosition=Qc.length+Be.length):l.TaskExtensions.Aa(Rc.startEdit(!0,1),()=>{zd.text="="+Be;if(this.eBb)Rc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{const Ce=Be.length+1;xe.Wdb(Ce);xe.caretPosition=Ce}},this.$.la,11,Y.a.current);Rc.Vl&&(Kb=Rc.Vb,Kb.text=xe.text,Kb.setCaretPosition(xe.caretPosition));this.DV?this.formulaAssistanceManager.Vda():(Kb=zd.g3.get(z.a.bwb),null===Kb||
void 0===Kb?void 0:Kb.ZY(!1));break;case -1334919469:H(this.$,"154468",!1)}return T.Task.Ta(!0)}wc(ba,cb){switch(cb.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.eBb;default:return!1}}GMh(ba,cb){cb=this.Va.cq(cb);const Kb=this.Va.Ec();var lc=this.functionInfoManager.Qcc(ba);if(!lc)return v.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),cb.QC();const Qc=this.eBb?1117706454:
-433697611;for(let Rc=0;Rc<lc.length;++Rc){const zd=lc[Rc].NameUI,ae=this.Va.nQ(280,"Formulas."+ba+"MenuItem_"+lc[Rc].FunctionIndex.toString(),Qc,null,1,"None",0,0,zd,!1,0);ae.label=zd;const ze=lc[Rc].Params.split(n.Bbd);ae.pS(zd+" "+(n.openParen+(1<ze.length?n.u9b:ze[0])+n.closeParen)+"\n"+lc[Rc].Help);Kb.buttons.push(ae)}ba=this.Va.Ec();lc=this.Va.nQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,t.a.ZUe,3,"Image16by16",1031,0,"Formulas.MoreFunctionsMenuItem",!1,0);ba.buttons.push(lc);cb.tc.push(Kb);
cb.tc.push(ba);return cb.QC()}Jc(ba,cb,Kb){ba=this.LWh(cb);if(-1===ba)return!1;this.menuId=Kb.MenuId;if(!this.functionInfoManager.GV)return this.functionInfoManager.VJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;ba=this.functionInfoManager.led[ba];this.RY[ba]=this.RY[ba]||this.GMh(ba,Kb.MenuId);Kb.MenuItems=this.RY[ba];return!0}LWh(ba){switch(ba){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(d.a)(lb,"FormulaAssistanceCommandHandler",null,[165]);class Fa extends h.a{constructor(ba){super(ba)}nd(){const ba=m.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya),cb=m.GetServiceTaskFactory.create(this.$.da,
153,this.la,this.Ya);l.TaskExtensions.Aa(l.TaskExtensions.Fd([ba,cb],this.la),()=>{this.Yc([new lb(this.$,ba.result,cb.result)])},this.la,3)}static ka(ba){h.a.Nd(92,new Fa(ba))}}Object(d.a)(Fa,"FormulaAssistanceCommandHandlerFactory",h.a,[]);var Na=a(222);class Mb{constructor(ba,cb){this.PKa=this.Dva=this.Ija=null;this.wGf=(Kb,lc)=>{this.Xcj(lc.functionName,lc.sed)};this.yGf=(Kb,lc)=>{this.Wcj(lc.sed,lc.xQd,lc.B3i)};this.xGf=(Kb,lc)=>{Kb=[];for(var Qc of lc.xQd)(!this.pxa||void 0!==Qc&&null!==Qc)&&
(lc=Qc.trim())&&Kb.push(lc);if(!this.pxa||Kb.length){Qc="";for(lc=0;lc<Kb.length;lc++){const Rc=this.l0c(Kb[lc]),zd=Mb.cHd(lc,Kb.length);Qc+=Rc+zd;zd&&(Qc+=this.ariaLiveNotifier.Aya)}this.ariaLiveNotifier.readText(Qc)}};this.zGf=(Kb,lc)=>{this.ariaLiveNotifier.Zcj(lc.tG,lc.description,lc.selectedIndex.toString(),lc.length.toString())};this.sGf=(Kb,lc)=>{this.ariaLiveNotifier.tRf(lc.description,lc.length)};this.ICf=()=>{this.ariaLiveNotifier.acb(w.a.instance.ga(883),y.a.pHa)};this.BCf=()=>{this.ariaLiveNotifier.readText(w.a.instance.ga(884))};
this.ECf=()=>{this.ariaLiveNotifier.readText(w.a.instance.ga(885))};this.$=cb;this.ariaLiveNotifier=ba;this.$.da.Ga(219,this);this.pxa=va.a.k5(cb)}dispose(){this.z0d();this.PKa=this.Dva=this.Ija=null}HZc(ba){ba&&(this.Ija=ba,this.Ija.Are(this.wGf),this.Ija.rse(this.yGf),this.pxa&&this.Ija.qse(this.xGf))}IZc(ba){ba&&(this.Dva=ba,this.pxa&&(this.Dva.yre(this.ICf),this.Dva.wre(this.BCf)),this.Dva.xre(this.ECf))}JZc(ba){ba&&(this.PKa=ba,this.PKa.KXc(this.zGf),this.PKa.l0b(this.sGf))}z0d(){var ba,cb,Kb;
this.Ija&&(this.Ija.CVf(this.wGf),this.Ija.aWf(this.yGf),this.pxa&&this.Ija.$Vf(this.xGf));this.PKa&&(this.PKa.HMd(this.zGf),this.PKa.Zuc(this.sGf));this.pxa&&(null===(ba=this.Dva)||void 0===ba?void 0:ba.BVf(this.ICf),null===(cb=this.Dva)||void 0===cb?void 0:cb.zVf(this.BCf));null===(Kb=this.Dva)||void 0===Kb?void 0:Kb.AVf(this.ECf)}Xcj(ba,cb){if(cb){let Kb="";this.pxa||(Kb+=w.a.instance.nb(57)+this.ariaLiveNotifier.Aya);for(let lc=0;lc<cb.length;lc++)Kb+=ba+this.ariaLiveNotifier.Aya+this.l0c(cb[lc])+
Mb.cHd(lc,cb.length);this.pxa&&(Kb+=w.a.instance.ga(882)+this.ariaLiveNotifier.Aya);this.ariaLiveNotifier.readText(Kb)}}Wcj(ba,cb,Kb){if(ba){let Qc="",Rc=0;if(cb){for(let zd=0;zd<cb.length;zd++){if(Kb>=ba[zd].split(this.$.listSeparator).length){Rc++;continue}var lc=cb[zd].trim();if(!lc)return;lc=this.l0c(lc);const ae=Mb.cHd(zd-Rc,cb.length-Rc);Qc+=lc+ae;ae&&(Qc+=this.ariaLiveNotifier.Aya)}this.ariaLiveNotifier.readText(Qc)}}}l0c(ba){if(!ba)return"";var cb=ba.split(this.$.listSeparator);ba="";for(const Kb of cb){if(Mb.vqd(Kb))ba+=
Kb;else{const lc=(cb=Mb.Yri(Kb))?Kb.replace("[","").replace("]",""):Kb;ba+=String.format(cb?w.a.instance.nb(59):w.a.instance.nb(58),lc)}ba+=this.ariaLiveNotifier.Aya}return ba}static cHd(ba,cb){return ba>=cb||1===cb?(v.ULS.shipAssertTag(537161997,0,ba<cb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(w.a.instance.nb(55),ba+1,cb)+"\r\n"}static vqd(ba){return hb.a.contains(ba,n.u9b,!0)}static Yri(ba){return ba.trimStart().startsWith(n.zKf)||ba.trimEnd().endsWith(n.yKf)}}
Object(d.a)(Mb,"FormulaAssistanceReadoutHandler",null,[524,2]);class dc extends Na.a{constructor(ba){super();this.$=ba;this.Fb()}create(){const ba=this.$.da;l.TaskExtensions.Aa(m.GetServiceTaskFactory.Oa(ba,211,212,this.Ya),cb=>{cb=ba.za(219)||new Mb(cb.result,this.$);this.ob(cb)},this.la,3)}static ka(ba){ba.da.Ga(220,new dc(ba))}}Object(d.a)(dc,"FormulaAssistanceReadoutHandlerFactory",Na.a,[]);var Cb=a(640),Tb=a(111),Jb=a(979),eb=a(58),za=a(42),ha=a(116);class fb{constructor(){this.SRa={}}njd(ba){return this.SRa&&
ba in this.SRa?this.SRa[ba]:null}cbg(ba,cb){this.SRa||(this.SRa={});this.SRa[ba]=cb}n_(){this.SRa=null}}Object(d.a)(fb,"FormulaAssistanceContextualPreviewCache",null,[]);var rb=a(60);const pa=(ba,cb,Kb,lc,Qc,Rc,zd=null)=>{zd=ba.Na(1,zd);zd.getPartialCalcResultsParameters=cb;return rb.g(ba,"GetPartialCalcResults",zd,Kb,lc,Qc,Rc,4)};class Ma{constructor(ba){this.cHi=30;this.calcManager=null;this.dd=!1;this.cQa=this.NHb=this.ebb=null;this.Ey=()=>{this.Wha.n_()};this.$=ba;this.Wha=new fb;this.aYf=-1;
this.$.ea.PE(this.Ey)}dispose(){this.dd||(this.$&&(this.$.ea.dE(this.Ey),this.$=null),this.Wha=this.NHb=null,this.dd=!0)}Mfd(ba,cb,Kb,lc){if(cb&&0>=cb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!ba)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
let Qc="="+cb.substring(Kb.start,Kb.end);qa.EwaSettings.ma(583)&&(Qc=this.calcManager.T4h(I.h(this.$).ha.ra.activeCell,ba,Kb));const Rc=this.HSh(Qc,Kb);if(qa.EwaSettings.ma(583)){if(Rc&&!this.calcManager.isFormulaSubExpressionVolatile(ba))return Promise.resolve(Rc)}else if(Rc)return Promise.resolve(Rc);return this.JSh(Qc,Kb).then(zd=>{if(this.m2c(lc))throw Error.create("OperationCanceledException");if(!zd||zd.Spj||zd.Lna.startsWith("##UNSUPPORTED:"))return this.E1e(cb,Qc,Kb,lc);this.Wha.cbg(Qc,zd.Lna);
return Promise.resolve(zd)})}HSh(ba,cb){return(ba=this.Wha.njd(ba))?new Jb.a(ba,cb.start,cb.end,0):null}JSh(ba,cb){if(!ba||0>=ba.length||!cb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.$_g(I.h(this.$).ha.ra.activeCell,ba,this.cHi,cb)}E1e(ba,cb,Kb,lc){if(!ba||0>=ba.length||!cb||0>=cb.length||!Kb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.cQa)return this.ISh(ba,cb,Kb,lc);const Qc={};Qc.PartialFormula=cb;Qc.Formula=ba;Qc.SourceRange=za.v(I.h(this.$).ha.ra.activeCell,this.$);return this.cQa=new Promise((Rc,zd)=>{this.NHb=new Cb.a;this.aYf=this.$.ea.ye;this.ebb=pa(this.$.pa.ya,Qc,ae=>{this.r1i(cb,Kb,lc,ae,Rc,zd)},ae=>{this.ebb=this.cQa=null;zd(ae)},null,null,null);this.NHb.token.register(()=>{this.I1g(zd)})})}r1i(ba,cb,Kb,lc,Qc,Rc){this.ebb=this.cQa=null;if(this.aYf!==this.$.ea.ye)Rc(Error.create("OperationCanceledException"));
else if(lc.Result)if(lc=eb.a.li(lc.Result),!lc||Tb.a.isEmpty(lc))Qc(null);else{for(let zd in lc)this.Wha.cbg(zd,lc[zd]);this.m2c(Kb)?Rc(Error.create("OperationCanceledException")):(ba=this.Wha.njd(ba))?(""===ba&&(ba=" "),Qc(new Jb.a(ba,cb.start,cb.end,0))):Rc(Error.create("SubexpressionNotFoundException"))}else Qc(null)}ISh(ba,cb,Kb,lc){return new Promise((Qc,Rc)=>{this.cQa.then(()=>{this.OYf(ba,cb,Kb,lc,Qc,Rc)}).catch(()=>{this.OYf(ba,cb,Kb,lc,Qc,Rc)})})}OYf(ba,cb,Kb,lc,Qc,Rc){if(this.m2c(lc))Rc(Error.create("OperationCanceledException"));
else{const zd=this.Wha.njd(cb);zd?Qc(new Jb.a(zd,Kb.start,Kb.end,0)):this.E1e(ba,cb,Kb,lc).then(ae=>{Qc(ae)}).catch(ae=>{Rc(ae)})}}I1g(ba){this.ebb&&(ha.a.Tu(this.ebb.nu)?(this.cQa=this.ebb=null,ba(Error.create("PendingWebReqeuestCancelled"))):v.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}n_(){this.J1g();this.Wha&&this.Wha.n_()}J1g(){this.NHb&&this.NHb.cancel()}m2c(ba){return this.dd||ba.IK}}Object(d.a)(Ma,"FormulaAssistanceContextualPreviewCalculator",null,[2]);
var Ja=a(157),Ga=a(212);class La{}La.Qwh="ewa-facp-text-box";Object(d.a)(La,"CssClassNames",null,[]);class nb{constructor(ba){this.hra=this.hUa=this.p3a=this.mQ=this.gaa=this.Za=null;this.zld=!1;this.Lc=ba}dispose(){(this.gaa||this.mQ)&&this.Ubf();this.Za=this.hra=null}xZj(ba,cb,Kb,lc){ba&&cb&&lc&&cb.Lna&&!(1>cb.Lna.length)&&(this.Za=ba,this.CUf(),this.p3a=cb,this.hUa=lc,this.THj(cb,Kb,lc))}Ubf(){this.Nci();this.CUf();this.hUa=this.p3a=null}THj(ba,cb,Kb){if(ba.Lna&&!(1>ba.Lna.length)){var lc=this.Lc.da.za(266);
if(lc){var Qc=lc.YYh();Qc&&l.TaskExtensions.Aa(this.yDb,()=>{if(cb)if(qa.EwaSettings.ma(583)&&this.Za.eb&&0<Kb.length){this.Zyb(ba.LKa,Kb[0].start,null);var Rc=this.S7e(Kb[0],Qc),zd=this.Za.text.substring(Kb[0].start,Kb[0].end).trim();zd=this.Za.text.indexOf(zd);zd=this.Za.text.substring(0,zd).lastIndexOf("\n");this.Zyb(0>zd||1>=Kb.length?Kb[0].start:zd+1,Kb[0].end,Rc?String.format(Rc,.3):null);for(var ae=1;ae<Kb.length;ae++)Rc=this.S7e(Kb[ae],Qc),zd=this.Za.text.substring(Kb[ae].start,Kb[ae].end).trim(),
zd=this.Za.text.indexOf(zd),zd=this.Za.text.substring(Kb[ae-1].end,zd).lastIndexOf("\n"),this.Zyb(0>zd?Kb[ae-1].end:zd+1+Kb[ae-1].end,Kb[ae].end,Rc?String.format(Rc,.3):null);zd=this.Za.text.substring(Kb[Kb.length-1].end,ba.Fva).indexOf("\n");this.Zyb(0>zd?Kb[Kb.length-1].end:zd+1+Kb[Kb.length-1].end,ba.Fva,null);v.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Zyb(ba.LKa,
ba.Fva,null),v.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.gaa||(this.gaa=document.createElement(Ga.a.div),this.Za.textBox.domElement.appendChild(this.gaa));this.mQ||(this.mQ=document.createElement(Ga.a.div),this.mQ.className=La.Qwh,this.Lc.domElement.appendChild(this.mQ));Rc=ba.Fva;qa.EwaSettings.ma(583)&&this.Za.eb&&Kb&&0<Kb.length&&Kb[0].start<Rc&&Kb[0].start!==ba.LKa&&
!this.Za.textBox.Sy.length&&(Rc=Kb[0].start);ae=hb.a.contains(this.Za.textBox.Qe.id,"FormulaBar",!0)&&hb.a.contains(this.Za.text.substring(ba.LKa,ba.Fva),"\n",!0);zd=this.Za.eb?this.Za.textBox.caretPosition:0;Rc=excelOnline.utils.getBoundingRectForText(this.Za.textBox.Qe,ae?zd:ba.LKa,ae?zd:Rc,qa.EwaSettings.ma(583));this.mQ.style.left=F.HelperMethods.uc(Rc.left);this.mQ.style.top=F.HelperMethods.uc(Rc.top);this.mQ.style.width=F.HelperMethods.uc(Rc.width);this.mQ.style.height=F.HelperMethods.uc(Rc.height);
dialogControls.renderToolTip(this.gaa,`FormulaAssistancePreviewToolTip_${ba.Fva}_${ba.Fva}`,ba.Lna,this.mQ,0,!1,!1,1)},this.Lc.la,3)}}}S7e(ba,cb){const Kb=this.Za.text;var lc=Kb.substring(ba.start,ba.end);lc=lc.trim();ba=Kb.indexOf(lc,ba.start);cb=Kb.indexOf(cb,ba);lc=Kb.substring(ba,cb);lc=lc.trim();return this.Za.colors.getItem(ba+"-"+(ba+lc.length))}Nci(){this.Za&&this.gaa&&this.mQ&&l.TaskExtensions.Aa(this.yDb,()=>{this.Za.textBox.domElement.contains(this.gaa)&&(dialogControls.clearToolTip(this.gaa),
this.Za.textBox.domElement.removeChild(this.gaa),this.gaa=null);this.Lc.domElement.contains(this.mQ)&&(this.Lc.domElement.removeChild(this.mQ),this.mQ=null)},this.Lc.la,3)}Zyb(ba,cb,Kb){!this.Za||ba>=cb||(this.Za.textBox.formatText(ba,cb-ba,{["background"]:Kb||"#E3DDCC"}),this.zld=!0)}CUf(){if(this.Za&&this.p3a&&this.zld){var ba=this.p3a.Fva;qa.EwaSettings.ma(583)&&0<this.hUa.length&&this.hUa[this.hUa.length-1].end>ba&&(ba=this.hUa[this.hUa.length-1].end);this.Za.textBox.formatText(this.p3a.LKa,ba-
this.p3a.LKa,{["background"]:!1});this.zld=!1}}get yDb(){if(this.hra)return this.hra;const ba=new Ja.a;this.Lc.ny(cb=>{l.TaskExtensions.Aa(cb.iwd(),()=>{ba.setResult(!0)},this.Lc.la,3)});return this.hra=ba.task}}Object(d.a)(nb,"FormulaAssistanceContextualPreviewControl",null,[2]);var Lb=a(82),ac=a(47),ib=a(46);class Ra{constructor(ba){this.r8=0;this.Tdd=ba}u8f(ba,cb,Kb){Kb?this.Gch(ba,cb,Kb):this.Z9e(ba,cb,Kb,!0)}toj(){this.r8=0}Gch(ba,cb,Kb){this.r8++;const lc=this.r8;ac.a.instance.create(()=>{this.Z9e(ba,
cb,Kb,lc===this.r8)},500,ib.a.IKh,!0,!0)}Z9e(ba,cb,Kb,lc){const Qc=this.Tdd.Mfd(ba,cb);Qc&&Qc.then(Rc=>{lc&&this.Tdd.grd(cb)&&this.Tdd.wZj(ba,Rc,Kb)}).catch(Rc=>{Rc=Object(Lb.a)(Error,Rc);"OperationCanceledException"===Rc.message?v.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${Rc}`):v.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${Rc}`)})}}Object(d.a)(Ra,"FormulaAssistanceContextualPreviewHoverManager",null,[]);
var ya=a(173);class Va{constructor(ba){this.Tsb=this.Uha=this.calcManager=this.Za=null;this.W$a=()=>{this.k6a(!1,!1)};this.$=ba;this.Rvb=new nb(ba);this.lbc=new Ma(ba);this.mbc=new Ra(this);I.h(ba).Vb.sm(this.W$a);this.$.da.Ga(317,this)}dispose(){this.n1c();ca.a.qc([this.Rvb,this.lbc]);this.mbc=this.lbc=this.Rvb=null;this.$&&I.h(this.$).Vb.Il(this.W$a);this.Uha=this.Za=this.$=null}UHj(ba,cb){cb&&ya.f(cb.text)&&!(cb.Axa||cb.textBox.Sy||this.Za&&this.Za.textBox.Sy)&&(this.Za=cb,this.calcManager=this.$.da.za(266))&&
(v.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),ba=F.HelperMethods.Awb(ba),ba=this.calcManager.Q4h(I.h(this.$).ha.ra.activeCell,this.Za.text,ba.x,ba.y),cb=this.calcManager.getSubExpressionSpan(ba),!cb||cb.end<=cb.start||this.grd(cb)||(this.Uha=cb,this.mbc.u8f(ba,cb,!0)))}lVd(ba){if(ba&&ya.f(ba.text))if(ba.textBox.Sy&&ba.textBox.Sy.trim()){if(this.Za=ba,this.calcManager=this.$.da.za(266)){v.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");ba={};var cb=this.Za.textBox.Sy.trim();ba.start=this.Za.text.indexOf(cb,this.Za.textBox.caretPosition);ba.end=ba.start+cb.length;(cb=this.calcManager.getFormulaSubExpressionObject(I.h(this.$).ha.ra.activeCell,this.Za.text,this.Za.textBox.Sy))&&!this.grd(ba)&&(this.Uha=ba,this.mbc.u8f(cb,ba,!1))}}else this.k6a(!1,!0)}k6a(ba,cb){!this.Za||cb&&this.Za.textBox.Sy||(this.Uha=
null,ba&&(this.n1c(),this.lbc.n_(),this.mbc.toj()),this.Rvb&&this.Rvb.Ubf(),this.Za.Axa||(this.Za.Axa=!1,this.Za=null))}Mfd(ba,cb){if(!this.Za||this.Za.Axa)return null;this.n1c();this.Tsb=new Cb.a;return this.lbc.Mfd(ba,this.Za.text,cb,this.Tsb.token)}wZj(ba,cb,Kb){this.Tsb=null;!ba||!cb||!cb.Lna||0>=cb.Lna.length?this.k6a(!1,!1):(ba=this.calcManager.R4h(I.h(this.$).ha.ra.activeCell,ba,this.Za.text),this.Rvb.xZj(this.Za,cb,Kb,ba))}grd(ba){return this.Uha?ba.start===this.Uha.start&&ba.end===this.Uha.end&&
ba.pre===this.Uha.pre&&ba.post===this.Uha.post:!1}n1c(){this.Tsb&&this.Tsb.cancel()}}Object(d.a)(Va,"FormulaAssistanceContextualPreviewManager",null,[627,2,628]);var oa=a(7),kb=a(4),Sa=a(224),U=a(14),ta=a(187),ub=a(1090),hc=a(70),Bc=a(775),Qa=a(31),na=a(24),ab=a(64),Gb=a(283),fc=a(247),pb=a(162);class Ea{constructor(ba=!1){this.lT=0;this.Vbe=!1;this.$Wa=this.tde=null;this.uzg=ba;this.textEdit=null}$3f(ba){this.lT=0;this.Vbe=ba.IsCompatibility;this.set_name(ba.NameDataStrings);this.$Wa=ba.Help}tyj(ba){this.lT=
1;this.set_name(ba.Name)}Vxj(ba){this.lT=2;this.set_name(ba.name);this.$Wa=ba.tooltip}xzj(ba){this.lT=3;this.set_name(ba.name);this.$Wa=ba.toolTip}w5f(ba){this.lT=4;this.set_name(ba.name)}OBj(ba){this.lT=5;this.set_name(ba.name);this.$Wa=ba.toolTip}NBj(ba){this.lT=7;this.set_name(ba.name)}nAj(){this.lT=6;this.set_name(w.a.instance.nb(192));this.$Wa=w.a.instance.nb(193)}get itemType(){return this.lT}get yni(){return this.Vbe}get name(){return this.label}set_name(ba){return this.tde=ba}get label(){return this.tde}get Nja(){return this.$Wa}get OBb(){return this.uzg}static ahh(){return Object(oa.a)(new Ea(!0),
{})}}Object(d.a)(Ea,"AutoCompleteItem",null,[586]);class xb{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(xb,"DefinedNameInfo",null,[]);var bc=a(186);class zb{constructor(ba){this.FLe={};this.$=ba}get ELe(){const ba=[];if(!this.$.Cb||!this.$.Cb.items)return ba;let cb=0;const Kb=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&va.a.DV(this.$);for(const lc of this.$.Cb.items)if(lc&&(3===lc.type&&lc.usedRange||
Kb&&2===lc.type)){const Qc=new xb;Qc.tooltip=lc.sheetName+hc.a.exclamation+lc.usedRange.toString();Qc.name=lc.name;Qc.namedRange=this.N$g(lc.usedRange);Qc.sheetName=lc.sheetName;Qc.type=this.F$g(lc.type);ba.push(Qc);this.FLe[lc.name.toUpperCase()]=Qc;++cb;if(cb===n.Zuf){v.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${n.Zuf}`);break}}return ba}QVj(ba){var cb=this.FLe[ba.toUpperCase()];if(!cb)return{returnValue:!1,sheetName:"",range:null};ba=cb.sheetName;
cb=this.w$g(cb.namedRange);return{returnValue:!0,sheetName:ba,range:cb}}N$g(ba){if(null!=ba&&void 0!=ba)return{top:ba.top,left:ba.left,bottom:ba.bottom,right:ba.right,maxRows:ba.maxRows,maxColumns:ba.maxColumns,sheetName:void 0}}w$g(ba){if(null!=ba&&void 0!=ba)return new bc.a(ba.top,ba.left,ba.bottom,ba.right,ba.maxRows,ba.maxColumns)}F$g(ba){switch(ba){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(zb,"DefinedNameInfoManager",null,[]);var Ub=a(128),wc=a(263),mb=a(260),Db=a(238);class Ic extends Sys.EventArgs{constructor(ba,
cb){super();this.functionName=ba;this.sed=cb}}Object(d.a)(Ic,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class Hc extends Sys.EventArgs{constructor(ba){super();this.xQd=ba}}Object(d.a)(Hc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class Ab extends Sys.EventArgs{constructor(ba,cb,Kb){super();this.sed=ba;this.xQd=cb;this.B3i=Kb}}Object(d.a)(Ab,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var db=a(259);class Pb{constructor(ba,cb,
Kb,lc,Qc=null){this.ela=this.a1c=!1;this.$=ba;this.formulaAssistanceUIControl=cb;this.zZe=Kb;this.Ztj=lc;this.q$e=Qc;this.ela=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Ff(){return this.a1c}set Ff(ba){this.a1c!==ba&&(ba?db.a(this.$).ai(this):db.a(this.$).aA(this),this.a1c=ba)}get de(){return this.Ztj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.zZe)}gg(ba,cb){ba=!1;cb||(I.h(this.$).zi.textBox.LF=!0,ba=this.formulaAssistanceUIControl.focus(this.zZe));
return ba}lh(ba){const cb=this.mc;return!(void 0===cb||null===cb)&&Oa.DOMElementExtensions.xf(cb,ba)}sj(){this.q$e&&this.q$e();if(this.ela){const ba=I.h(this.$).zi.textBox;this.selection=ba.selection;ba.removeSelection()}}Wj(){this.ela&&(I.h(this.$).zi.textBox.selection=this.selection)}dispose(){db.a(this.$).aA(this)}}Object(d.a)(Pb,"FormulaAssistanceFocusManager",null,[39,2]);var td=a(38),Vb=a(371),Ac=a(188),Kc=a(35),dd=a(282),Vd=a(281),Jd=a(910);class oe extends td.a{constructor(ba,cb){super();
this.dxg=[];this.ved={};this.wed={};this.hT=null;this.m9=[];this.QKa={};this.eDf=(Kb,lc)=>{v.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.QCf(Kb,!!lc&&1!==lc.FilterType,!0)};this.dDf=()=>{v.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.hT=null};this.NCf=Kb=>{v.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
this.HKd(Kb.Pja,!0,!1)};this.cDf=Kb=>{v.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.QCf(Kb,!0,!1)};this.mNc=this.oNc=!1;this.jb=ba;this.pluginScheduler=cb;this.$.da.Ga(19,this)}MGa(ba){this.addHandler("FunctionInfoLoaded",ba)}Dcb(ba){this.removeHandler("FunctionInfoLoaded",ba)}QMg(ba){this.addHandler("FunctionInfoReset",ba)}Ijj(ba){this.removeHandler("FunctionInfoReset",ba)}get GV(){return this.oNc}get xpi(){return this.mNc}get wbc(){var ba=this.hT,cb=
Jd.a(this.$);if(!cb)return ba;cb=cb.$Vh();const Kb=cb.length;if(0>=Kb)return ba;const lc=[];lc.push(...ba);for(ba=0;ba<Kb;ba++){const Qc=cb[ba],Rc={};Rc.FunctionIndex=lc.length;Rc.HelpId=Rc.GroupUI=null;Rc.Help=Qc.description;Rc.IsCommonlyUsed=Rc.IsCompatibility=!1;Rc.NameDataStrings=Qc.name;Rc.NameUI=Qc.name;Rc.Params=null;Rc.ParamsHelp=null;lc.push(Rc)}return lc}get led(){return this.m9}get $(){return this.jb}dispose(){const ba=this.$.da.za(268);ba&&ba.oMd(this.NCf);this.jb=null;super.dispose()}tYf(){this.raiseEvent("FunctionInfoReset")}VNd(){this.tYf();
this.oNc=!1;this.hT=null;this.mNc=!0}VJa(ba,cb=!1){if(this.GV)this.ZPf();else{v.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.va.UICultureTag}' from the server.`);let lc=null;(lc=this.$.da.za(268))||v.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===lc||void 0===lc?0:lc.Pja)&&0<lc.Pja.length)qa.EwaSettings.ma(121)?lc.mKh(this.cDf):this.HKd(lc.Pja,!0,!1);else{var Kb=this.$.pa.ya.Wb();ba&&(this.$.ea.Zb||cb)&&
!this.xpi&&(cb?Vb.a(this.$.userOperationManager,(Qc,Rc,zd)=>rb.o(this.$.pa.ya,ba,Vd.b(Qc,this.eDf),Vd.a(Rc,this.dDf),zd,ba,Kb),Qc=>new Ac.a(130,0,Qc,16),null):rb.o(this.$.pa.ya,ba,this.eDf,this.dDf,null,ba,Kb));!this.GV&&this.$.ea.Zb&&(lc?(v.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.GV}, IsSessionActive=${this.$.ea.Zb}`),lc.zre(this.NCf)):(v.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
rb.o(this.$.pa.ya,{FilterType:0},this.cDf,null,null,null,Kb),this.mNc=!1))}}}MWh(ba){return 0>ba||ba>=this.hT.length?null:this.hT[ba]}Sgd(ba){return Kc.a.Dc(this.ved,ba.toUpperCase())}h3e(ba){return Kc.a.Dc(this.wed,ba.toUpperCase())}Qcc(ba){return Kc.a.Dc(this.QKa,ba)}vic(ba){return!ba.GroupUI}QCf(ba,cb,Kb){const lc=dd.a(ba);v.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${lc}`);lc?(I.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.Qo(ba.Errors)):(this.HKd(ba.Result,cb,Kb),va.a.EV(this.$)&&!va.a.DV(this.$)&&this.O0j())}HKd(ba,cb,Kb){v.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${ba.length}, isCategorized = ${cb}, partialResult = ${Kb} IsFullyLoaded = ${this.GV}`);this.GV||(this.hT=ba,this.OXg(cb),this.oNc=!Kb,this.ZPf())}ZPf(){this.raiseEvent("FunctionInfoLoaded")}O0j(){const ba=this.wbc;this.pluginScheduler.notifier().setFunctionsInfo(ba);v.ULS.sendTraceTag(512278604,
0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===ba||void 0===ba?void 0:ba.length} functions}`)}OXg(ba){var cb=w.a.instance.ga(1027),Kb=[];this.QKa={};this.m9=[];this.QKa[cb]=Kb;const lc=w.a.instance.ga(1028),Qc=[];this.m9.push(cb);this.m9.push(lc);for(let zd=0,ae=this.hT.length;zd<ae;zd++){cb=this.hT[zd];cb.IsCompatibility||Qc.push(cb);var Rc=cb.NameUI;const ze=cb.NameDataStrings;this.ved[ze.toUpperCase()]||(this.ved[ze.toUpperCase()]=cb);
this.wed[Rc.toUpperCase()]||(this.wed[Rc.toUpperCase()]=cb);if(!this.vic(cb)){if(ba){Rc=cb.GroupUI;let Be=Kc.a.Dc(this.QKa,Rc);Be||(Be=[],this.QKa[Rc]=Be,this.m9.push(Rc));Be.push(cb)}cb.IsCommonlyUsed&&Kb.push(cb);cb.IsCompatibility||this.dxg.push(ze)}}this.QKa[lc]=Qc;ba&&(oe.RTf(Kb,[2,3,0,5,4,9,1,7,8,6]),Kb=Array(14),Kb[0]=0,Kb[1]=1,Kb[2]=7,Kb[3]=11,Kb[4]=5,Kb[5]=2,Kb[6]=6,Kb[7]=10,Kb[8]=9,Kb[9]=3,Kb[10]=4,Kb[11]=13,Kb[12]=12,Kb[13]=8,oe.RTf(this.m9,Kb),Kb=[],Kb.push(...this.m9),Kb.splice(13,1),
this.m9=Kb);Kb=(zd,ae)=>zd.NameUI.localeCompare(ae.NameUI);this.hT=[...this.hT];this.hT.sort((zd,ae)=>zd.NameDataStrings.localeCompare(ae.NameDataStrings));for(let zd=1,ae=this.m9.length;zd<ae&&ba;zd++)this.QKa[this.m9[zd]].sort(Kb);for(let zd=0,ae=this.hT.length;zd<ae;zd++)this.hT[zd].FunctionIndex=zd}static RTf(ba,cb){const Kb=[...ba];for(let lc=0;lc<Kb.length&&lc<cb.length;lc++)ba[lc]=Kb[cb[lc]]}}Object(d.a)(oe,"FunctionInfoManager",td.a,[518,519,2]);var De=a(239),Ke=a(94),rd=a(49),bf=a(706);class cc extends Ke.a{constructor(ba,
cb,Kb,lc=null){super(ba,lc);this.g4=null;this.COb=this.WXd=!1;this.offsetParent=this.i8=this.Q2a=null;this.LLc=!1;this.bDd=Qc=>this.O6(Qc);this.aDd=Qc=>this.$N(Qc);this.IBf=Qc=>{const Rc=F.HelperMethods.Do(Qc);Rc.button===Sys.UI.MouseButton.leftButton&&2===Qc.tb&&(this.Eqd(Rc.target)||this.VTa(Rc));return!1};this.v9d=cb;Kb&&(this.WXd=!0,De.a.instance.ta(U.a.pointerDown,this.kOe,this.IBf));this.Mfa=!1}get g9b(){return this.Mfa}get kOe(){return this.v9d}get Kbi(){return this.LLc}dispose(){this.WXd&&
(De.a.instance.Ba(U.a.Ij,this.kOe,this.IBf),this.WXd=!1);this.COb&&(this.COb=!1,De.a.instance.Ba(U.a.Pf,this.domElement.ownerDocument.body,this.bDd),De.a.instance.Ba(U.a.Ij,this.domElement.ownerDocument.body,this.aDd));this.g4=this.v9d=null;super.dispose()}ype(ba){this.g4?this.g4.push(ba):this.g4=[ba]}Eqd(ba){if(this.g4)for(let cb=0,Kb=this.g4.length;cb<Kb;++cb)if(Oa.DOMElementExtensions.xf(this.g4[cb],ba))return!0;return!1}VTa(ba){this.g9b||(this.Mfa=!0,hb.a.equals(this.domElement.currentStyle.position,
"absolute",!0)||(this.domElement.style.position="absolute"),this.mth(),De.a.instance.ta(U.a.Pf,this.domElement.ownerDocument.body,this.bDd),De.a.instance.ta(U.a.Ij,this.domElement.ownerDocument.body,this.aDd),this.COb=!0,this.drag(!0,ba))}drag(ba,cb){wa.g(cb);var Kb=new rd.a(0,0),lc=new Sys.UI.Point(cb.clientX,cb.clientY);cb=this.domElement.parentNode;lc=bf.a.Vs(Kb,cb,lc,this.isRtl());ba?(Kb=bf.a.BF(Kb,cb,this.domElement,this.isRtl()),this.Q2a=bf.a.kE(lc,Kb),this.i8=lc,this.LLc=!1):!this.Kbi&&this.Gbi(lc,
this.i8)&&(this.LLc=!0);Kb=bf.a.kE(lc,this.Q2a);bf.a.Zdb(cb,this.domElement,Kb,this.isRtl(),ba)}Aw(ba){this.COb&&(this.COb=!1,De.a.instance.Ba(U.a.Pf,this.domElement.ownerDocument.body,this.bDd),De.a.instance.Ba(U.a.Ij,this.domElement.ownerDocument.body,this.aDd));wa.g(ba);this.Mfa=!1;this.i8=this.Q2a=null}O6(ba){const cb=F.HelperMethods.Do(ba);cb.button===Sys.UI.MouseButton.leftButton&&2===ba.tb&&this.Aw(cb);return!1}$N(ba){2===ba.tb&&this.drag(!1,F.HelperMethods.Do(ba));return!1}Gbi(ba,cb){return cb.x<
ba.x-2||cb.x>ba.x+2||cb.y<ba.y-2||cb.y>ba.y+2}mth(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;Oa.DOMElementExtensions.getLocation(this.offsetParent)}}Object(d.a)(cc,"BaseDraggableBehavior",Ke.a,[]);class Wc extends cc{constructor(ba,cb,Kb=null,lc=!1){super(ba,cb,!1,Kb);this.YSa(lc);this.pj=hb.a.equals("rtl",ba.dir,!0)}setVisible(ba){Oa.DOMElementExtensions.setVisible(this.domElement,ba);ba||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.pj}YSa(ba){const cb=
this.domElement.style;cb.cursor="move";cb.position=ba?"relative":"absolute"}}Object(d.a)(Wc,"FunctionParamBoxDraggableItem",cc,[]);class id{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(d.a)(id,"FormulaArgumentAssistanceCallbacks",null,[]);class Tc{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(d.a)(Tc,"FormulaArgumentAssistanceRenderingInfo",
null,[]);var Gd=a(85),Wd=a(107),Dd=a(152);class Kd{constructor(ba){this.Bt=ba;this.zB=this.jTa=this.Ni=!1;this.onKeyDown=cb=>!this.zB&&cb.keyCode===Gd.a.xpa&&cb.altKey&&cb.ctrlKey?(this.j3a(),cb.stopPropagation(),cb.preventDefault(),!0):!1;this.Kla=cb=>{if(!this.zB)return!1;if(cb.eventName===U.a.Ob){const Kb=cb.Ca.ctrlKey?1:cb.Ca.shiftKey?50:10;switch(cb.Ca.keyCode){case Gd.a.SCa:this.$K(0,-Kb);break;case Gd.a.hfa:this.$K(0,Kb);break;case Gd.a.ifa:this.$K(-Kb,0);break;case Gd.a.mVa:this.$K(Kb,0);
break;case Gd.a.kJ:case Gd.a.Sh:this.jTa=!0;break;default:return!1}}cb.eventName===U.a.Dd&&this.jTa&&this.bN(!0);cb.Ca.preventDefault();return!0};this.Zza=cb=>{if(!this.zB)return!1;cb.Ca.preventDefault();this.bN();return!0};this.onBlur=()=>{if(!this.zB)return!1;this.bN();return!0};this.Go=Wd.KeyInputManager.instance;this.pointerInputManager=De.a.instance}ka(ba){(this.root=ba)&&!this.Ni&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ni=!0)}detach(){this.root&&this.Ni&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.Ni=!1)}j3a(){this.root&&(this.target=this.Bt.OGb("move",!0),this.nXd=this.target.getBoundingClientRect(),this.zB=!0,this.jTa=!1,this.Ps(),this.Zya||this.Gsb(),this.target.appendChild(this.Zya))}bN(ba=!1){this.Bt.lpc(ba);this.zB=!1;this.MJb();this.AJb();this.nXd=this.target=void 0}Ps(){this.Go.capture(this.Kla,null);this.pointerInputManager.Ns(U.a.pointerDown,this.target,this.Zza,!0);this.target.addEventListener("blur",this.onBlur)}AJb(){this.Go.releaseCapture();this.pointerInputManager.Ws(U.a.pointerDown,
this.target,this.Zza,!0);this.target.removeEventListener("blur",this.onBlur)}MJb(){var ba;this.target&&(null===(ba=this.Zya)||void 0===ba?void 0:ba.parentNode)===this.target&&this.target.removeChild(this.Zya)}$K(ba,cb){const Kb=this.target.getBoundingClientRect();this.Bt.onMove(ba+Kb.left-this.nXd.left,cb+Kb.top-this.nXd.top)}Gsb(){this.Zya=Dd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Kd,"FormulaAssistanceMoveAdapter",null,[]);var we=a(276);class We{constructor(ba){this.Bt=
ba;this.Ni=!1}p5(){return this.Ni&&!!this.vD}uza(ba){this.vD.style.cursor="grabbing";this.HNj=ba.clientPoint.x;this.INj=ba.clientPoint.y;this.Bt.OGb("drag");return!0}Zca(ba){this.Bt.onMove(ba.clientPoint.x-this.HNj,ba.clientPoint.y-this.INj);return!0}Yca(){this.Aw()}Xca(){this.Aw()}ka(ba){if(this.vD=ba)this.vD.style.cursor="grab",we.a.instance.KW(this.vD,this),this.Ni=!0}detach(){this.Ni&&this.vD&&(this.vD.style.cursor="",we.a.instance.t1(this.vD,this),this.Ni=!1)}Aw(){this.vD.style.cursor="grab";
this.Bt.lpc()}}Object(d.a)(We,"FormulaAssistanceDragAdapter",null,[618]);class Od{constructor(ba,cb){this.HKa=ba;this.formulaAssistanceTelemetryManager=cb;this.Ni=!1;this.WL={[le.Drag]:0,[le.Move]:0};this.uFc=this.HKa.getWindowEdgeBuffer()+1;this.IEb=new Kd(this);this.Ytb=new We(this)}ka(ba,cb,Kb,lc){this.root=ba;this.render=Kb;this.dismiss=lc;this.detach();cb&&(this.Ytb.ka(cb),this.IEb.ka(ba.firstChild),this.Ni=!0)}detach(){this.Ni&&(this.Ytb.detach(),this.IEb.detach(),this.Ni=!1);Oa.DOMElementExtensions.tf(this.placeholder)}clear(){this.HKa.setOverrideTarget(void 0);
this.detach();this.HKb()}OGb(ba,cb=!1){this.WL[ba]+=1;this.RAc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);ba=this.placeholder.firstChild;ba.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);cb&&(this.JQa=document.activeElement,ba.tabIndex=0,ba.focus());this.dismiss();return ba}onMove(ba,cb){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(ba,this.uFc-this.RAc.left),window.innerWidth-this.RAc.right-
this.uFc)}px, ${Math.min(Math.max(cb,this.uFc-this.RAc.top),window.innerHeight-this.RAc.bottom-this.uFc)}px)`}lpc(ba=!0){const cb=this.placeholder.firstChild.getBoundingClientRect(),Kb=this.HKa.getDirectionalHint({top:cb.top,left:cb.left});this.HKa.setOverrideTarget({top:1===Kb?cb.bottom:cb.top,left:cb.left});this.render();window.requestAnimationFrame(()=>{Oa.DOMElementExtensions.tf(this.placeholder);this.JQa&&(ba&&this.JQa.focus(),this.JQa=void 0)})}HKb(){const ba=this.formulaAssistanceTelemetryManager.SP,
cb=this.WL[le.Drag],Kb=this.WL[le.Move];0<cb&&(ba.argumentAssistanceDragCounter+=1,ba.argumentAssistanceDragTotalCounter+=cb,this.WL[le.Drag]=0);0<Kb&&(ba.argumentAssistanceMoveCounter+=1,ba.argumentAssistanceMoveTotalCounter+=Kb,this.WL[le.Move]=0)}}Object(d.a)(Od,"FormulaAssistanceDragControl",null,[]);var le;(function(ba){ba.Drag="drag";ba.Move="move"})(le||(le={}));Object(d.b)("FormulaAssistanceDragMode",le);class de extends Db.a{constructor(ba,cb,Kb,lc,Qc,Rc,zd){super(de.TKa(va.a.k5(ba),va.a.Cgf(),
zd));this.$=ba;this.zj=cb;this.functionInfoManager=Kb;this.formulaAssistanceUIControl=lc;this.formulaAssistanceTelemetryManager=Qc;this.pluginScheduler=Rc;this.htmlSanitizationHelper=zd;this.S2a=null;this.KY=0;this.Rq=null;this.iZc=!1;this.Qla=this.Ro=null;this.lTa=!0;this.JK=!1;this.Vba=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.Vjf=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=
ae=>{this.gQb(ae);1===ae?this.formulaAssistanceTelemetryManager.SP.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.SP.argumentAssistanceExpandCounter++};this.ASa=ae=>{const ze={};ze[y.a.GQ]="ArgumentAssistanceCard";const Be={};Be.FunctionName=ae.functionName;ze[y.a.fcd]=Be;this.$.Xc(802602464,0,8,ze)};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.SP.argumentAssistanceDismissCounter++;this.lTa=!1;this.Jtb();this.JK&&this.Bt.clear();0===this.KY&&this.gQb(1)};
this.Nf=()=>{this.lTa=!0;this.JK&&this.Bt.clear()};this.ySi=ae=>{ae.button===Sys.UI.MouseButton.leftButton&&ae.target&&(wa.g(ae),this.S2a&&this.S2a.VTa(ae))};this.Tt=()=>{void 0!==this.Ro&&null!==this.Ro&&this.Ro()};this.Zk=va.a.k5(ba);this.Vwi=va.a.Cgf();this.j5=this.Zk&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Zk){this.cSd();this.Rq=new Pb(this.$,this.formulaAssistanceUIControl,0,fc.a.Sdd);this.j5&&I.h(this.$).fc.sm(this.Nf);if(this.JK=
qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.Bt=new Od(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.S2a=new Wc(this.domElement,this.$.dF,void 0,va.a.DN(this.$)),
this.Gc.ka("mousedown",this.ySi),ba=$get(n.qed,this.zj),this.zj.insertBefore(this.domElement,ba);I.h(this.$).view.nt(this.Tt)}Are(ba){this.addHandler("FAFunctionNameUpdated",ba)}CVf(ba){this.removeHandler("FAFunctionNameUpdated",ba)}rse(ba){this.addHandler("FAParameterSelectionChangedOld",ba)}aWf(ba){this.removeHandler("FAParameterSelectionChangedOld",ba)}qse(ba){this.addHandler("FAParameterSelectionChanged",ba)}$Vf(ba){this.removeHandler("FAParameterSelectionChanged",ba)}set_visible(ba){this.Zk?
ba||this.Jtb():Sys.UI.Control.prototype.set_visible.call(this,ba);return ba}Jtb(){this.formulaAssistanceUIControl&&(this.Ro=null,this.JK&&this.Bt.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Qla=null,this.Rq.Ff=!1)}show(ba){this.Zk||(this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceRender"]),this.S2a.setVisible(!!ba),this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceRender"]),this.iZc&&(this.iZc=!1,this.formulaAssistanceTelemetryManager.Wua("argumentAssistanceOverall")))}INd(){if(!this.j5||
this.lTa){this.j5||this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceComputation"]);var ba=I.h(this.$).zi,cb={content:ba.text,caretPosition:ba.textBox.caretPosition};(this.Vba?this.pluginScheduler.getRequester().argumentAssistance(cb,0):this.pluginScheduler.requester().argumentAssistance(cb)).then(Kb=>{0===Kb.kind?Kb.payload?(this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceComputation"]),this.yHj(this.Dsc(Kb.payload),
ba.textBox.domElement)):this.Jtb():this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceComputation"],!1);return null})}}update(ba,cb,Kb,lc){if(!this.Zk&&ba){this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.iZc=!0;var Qc=this.$.listSeparator;try{var Rc=$get(n.ted,this.zj);const zd=$get(n.med,this.zj);Rc.innerText="";zd.innerText="";const ae=$get(n.WZe,this.zj),ze=ba.Params.split(n.Bbd);Rc=[];for(let Be=0,xe=ae.rows.length;Be<xe;Be++){const Ce=
ae.rows[Be];Oa.DOMElementExtensions.setVisible(Ce,Be<ze.length);let ef=ze[Be];const Jf=n.A3i+Be+"_",Ia=ba.NameDataStrings;$get(Jf+n.yHb,Ce).innerText=Ia;$get(Jf+n.YFd,Ce).innerText=Ia;if(ef){const Bb=ze[Be].split(Qc),zc=de.vqd(Bb[Bb.length-1]),ad=de.csi(ba);zc&&(ad&&(2<Bb.length?(Bb[Bb.length-2]+="1",Bb[Bb.length-3]+="1"):v.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Ia,Bb.length.toString(),
cb)),de.$Rg(Bb,ad,cb,ba));ef=Bb.join(Qc.toString()+" ");ze[Be]=ef;Kb<Bb.length?(Rc[Be]=Bb[Kb],v.ULS.shipAssertTag(537162072,0,!!Bb[Kb]&&1<=Bb[Kb].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",Kb,Bb.length,Ia,Be),Bb[Kb]=`${"<b>"}${Bb[Kb]}${"</b>"}`,ef=Bb.join(Qc.toString()+" ")):v.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+
Kb+"currRowParamsArray.Length = "+Bb.length+", current row = "+Be);lc&&v.ULS.sendTraceTag(558474578,0,50,`formula '${Ia}', ${Bb.length} params, isElipsis = ${zc}, isPairsParamsFormula = ${ad}, currentParameterIndex = ${cb}`)}this.Vwi?this.htmlSanitizationHelper.sk($get(Jf+n.zrc,Ce),"("+(ef||"")+")"):$get(Jf+n.zrc,Ce).innerHTML="("+(ef||"")+")"}lc?this.raiseEvent("FAFunctionNameUpdated",new Ic(ba.NameDataStrings,ze)):this.raiseEvent("FAParameterSelectionChangedOld",new Ab(ze,Rc,Kb));ae.className=Bc.a.vxh+
(this.functionInfoManager.vic(ba)?"-udf":"")}catch(zd){throw v.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",ba.NameDataStrings,cb,zd),zd;}this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceComputation"])}}dispose(){this.Zk||(this.Gc.iD(),ca.a.Ia(this.Gc),I.h(this.$).view.ir(this.Tt),ca.a.Ia(this.S2a),this.S2a=null);this.Zk&&ca.a.Ia(this.Rq);this.j5&&I.h(this.$).fc.Il(this.Nf);this.functionInfoManager=this.$=null;super.dispose()}Dsc(ba){const cb=
new Tc;cb.functionRenderingInfo=ba;cb.cardMode=this.KY;this.kLd(cb);return cb}kLd(ba){ba.callbacks=new id;ba.callbacks.onHelpLink=this.$gd(ba.functionRenderingInfo);ba.callbacks.onCardModeChange=this.onCardModeChange;ba.callbacks.onFeedback=this.ASa;this.j5&&(ba.callbacks.onDismissClick=this.onDismissClick)}yHj(ba,cb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceRender"]);const Kb={};Kb.zoomLevel=S(this.$);this.formulaAssistanceUIControl.updateContext(Kb);
this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,cb,ba,()=>{})};this.Ro();this.Xrc(ba);this.JK&&this.Bt.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ro,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Rq.Ff=!0;this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Wua("argumentAssistanceOverall")}}$gd(ba){return()=>
{H(this.$,ba.helpID,ba.isUDF)}}cSd(){const ba=Ub.a.get(y.a.qpb);this.KY=ba?parseInt(ba,10):de.b8c;this.formulaAssistanceTelemetryManager.H2f(this.KY)}Xrc(ba){var cb=ba.functionRenderingInfo.functionName;this.Qla&&hb.a.equals(this.Qla,cb,!0)?(cb=wc.a.map(ba.functionRenderingInfo.signatures,Kb=>{let lc="";0<=Kb.signatureParams.activeParam&&Kb.signatureParams.activeParam<Kb.signatureParams.params.length&&(lc=Kb.signatureParams.params[Kb.signatureParams.activeParam]);return lc}),this.raiseEvent("FAParameterSelectionChanged",
new Hc(cb))):(this.Qla=cb,ba=wc.a.map(ba.functionRenderingInfo.signatures,Kb=>Kb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Ic(cb,ba)))}gQb(ba){this.KY=ba;try{Ub.a.Rv(y.a.qpb,ba.toString(),mb.AFrame.v8)}catch(cb){v.ULS.sendTraceTag(537162070,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${cb.message}`)}}static vqd(ba){return hb.a.contains(ba,n.u9b,!0)}static csi(ba){return!!ba&&hb.a.c3a(ba.NameDataStrings,"IFS")}static $Rg(ba,
cb,Kb,lc){try{if(!ba||2>ba.length)v.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${lc.NameDataStrings}', ${ba?ba.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${cb}, currentParameterIndex = ${Kb}.`);else{var Qc=ba.pop().toString();for(let Rc=ba.length-1;Rc<Kb;Rc++){const zd=ba[Rc].trim();if(cb){const ae=ba[Rc-1].trim();ba.push(de.zNh(ae,zd))}else{const ae=de.Wdf(zd);ba.push(de.x_e(ae))}}ba.push(Qc)}}catch(Rc){throw v.ULS.shipAssertTag(537162068,
0,!1,`AppendNewOptionalParameters Exception. formula '${lc.NameDataStrings}', ${ba?ba.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${cb}, currentParameterIndex = ${Kb}. 
Exception: ${Rc}`),Rc;}}static zNh(ba,cb){ba=de.Wdf(ba);const Kb=de.I5e(ba);cb=de.I5e(cb);return de.x_e(ba,!0,!!Kb&&!!cb&&Kb!==cb)}static Wdf(ba){var cb=ba.match(de.QBd);ba=hb.a.trimEnd(hb.a.trimStart(ba,n.zKf),n.yKf);if(cb&&cb.length){cb=cb[cb.length-1];const Kb=Number.parseLocale(cb)+1;ba=ba.replace(cb,Kb.toString())}else ba=`${ba}${1}`;return ba}static x_e(ba,cb=!1,Kb=!1){let lc="[{0}]";cb&&(lc=Kb?"[{0}":"{0}]");return String.format(lc,ba)}static I5e(ba){return(ba=ba.match(de.QBd))&&ba.length?
ba[0]:null}static TKa(ba,cb,Kb){if(ba)return document.createElement("div");ba=String.format(n.mLf,n.kLf,n.YFd,Bc.a.gSe,n.yHb,Bc.a.fSe,n.zrc);var lc=String.format(n.mLf,n.lLf,n.YFd,Bc.a.gSe,n.yHb,Bc.a.fSe,n.zrc);ba=String.format(n.OLh,n.PLh,Bc.a.dTe,Bc.a.quh,t.a.hq,n.WZe,ba,lc);lc=document.createElement("div");cb?Kb.sk(lc,ba):lc.innerHTML=ba;return lc.firstChild}}de.QBd=RegExp("\\d+");de.b8c=0;Object(d.a)(de,"FormulaArgumentAssistanceControlDeprecated",Db.a,[585]);class Re{constructor(){this.mia=this.zta=
this.Ata=!1;this.oKf=40;this.gEe=41;this.f1a=this.CFd=this.DFd=this.zHb=0;this.hBf=!0;this.fEd=!1;this.lYe=this.kQd=-1}}Object(d.a)(Re,"ParseContext",null,[]);var Ee=a(416),Te=a(909),Ae=a(325);class kf extends Te.a{constructor(ba,cb,Kb,lc){super(ba,cb);this.formulaAssistanceControl=Kb;this.formulaAssistanceTelemetryManager=lc;this.YJf=!1;this.oTa=null;this.xnd=0;this.hJa=this.hIc=null;this.vQ=0;this.Npb=cb.textBox;this.Zk=va.a.k5(ba);this.Shj=qa.EwaSettings.xb();this.S2=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance")}get sAb(){return Object(Ee.a)(sa,
this.$.rb.Ih)}get KK(){return this.formulaAssistanceControl.qe}set KK(ba){this.formulaAssistanceControl.qe=ba}get F6a(){return this.Za.F6a}get Yei(){var ba=this.Npb.text;let cb=!1;if(0>=ba.length)return cb;const Kb=this.$.Jb.Ac("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),lc=I.h(this.$).ha.ra.activeCell.clone();var Qc=ba.charCodeAt(0);this.hJa="";this.vQ=this.$1g(ba,this.Npb.caretPosition);Qc=61===Qc&&-1!==this.vQ;if(!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Qc&&
(cb=!0);else if(Qc){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Qc=0;for(var Rc=this.vQ-1;1<=Rc&&!(this.vQ-Rc>kf.Wuf);Rc--)if(kf.zye.includes(ba.charAt(Rc))){Qc=Rc;break}Qc=ba.substring(Qc+1,this.vQ);ba=""!==Qc?this.$.Cb.getItemByName(Qc):null;Rc=this.vQ;for(var zd=this.vQ+1;zd<=this.Za.textBox.caretPosition;zd++)if("["===this.Za.text.charAt(zd))Rc=zd;else break;this.vQ=Rc}else{Qc=ba.lastIndexOf("[");Rc=0;for(zd=Qc-1;1<=zd&&!(Qc-zd>kf.Wuf);zd--)if(kf.zye.includes(ba.charAt(zd))){Rc=
zd;break}Qc=ba.substring(Rc+1,Qc);ba=""!==Qc?this.$.Cb.getItemByName(Qc):null}ba&&2===ba.type?(cb=!0,this.hJa=Qc):I.h(this.$).Bb.Bj(lc)&&(cb=!0,this.hJa="")}Kb.stop();this.xnd=Kb.zc;v.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.xnd} milliseconds`);return cb}get key(){return z.a.bwb}get calcManager(){this.hIc||(this.hIc=this.$.da.za(266,!1));return this.hIc}get JUd(){if(null!=
this.oTa)return this.oTa;if(!qa.EwaSettings.ma(135))return this.oTa=!1;const ba=I.h(this.$).ha.ra.activeCell.clone();if(1!==ba.Auf||!ba.left||I.h(this.$).ha.ra.Vic())return!1;let cb=this.formulaAssistanceControl.tableManager.Dn(ba);if(cb)return this.oTa=!1;--ba.left;--ba.right;if(!ba.Nz)return!1;cb=this.formulaAssistanceControl.tableManager.Dn(ba);return this.oTa=!!cb&&ba.top===cb.top&&this.formulaAssistanceControl.tableManager.Cah(cb,I.h(this.$))}Xh(ba,cb){this.formulaAssistanceControl.Za=this.Za;
-1470715894!==cb&&-1231471547!==cb||!this.zMe()||(this.KK=!1);return super.Xh(ba,cb)}kCd(){var ba=this.F6a;if(ba||this.JUd)if(this.formulaAssistanceControl.Za=this.Za,this.formulaAssistanceTelemetryManager.Tpb.formulaAssistanceRequestAttemptedCounter++,this.zMe())if(!ba&&this.JUd)this.formulaAssistanceControl.Cwe();else if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.Yei){if(ba=this.$.Jb.Ac("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.Ewe(),ba.stop(),this.Npb.text.endsWith("[")&&"["!==this.Npb.text.charAt(this.Npb.text.length-2)){const cb=""===this.hJa?this.formulaAssistanceControl.tableManager.Ig:Object(Lb.a)(Ae.a,this.$.Cb.getItemByName(this.hJa));v.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${cb.nj} in ${ba.zc} ms with cell edit regression time of ${this.xnd} ms and popup visibility - ${this.KK}`)}}else this.formulaAssistanceControl.Apb(),
this.YJf&&(this.YJf=this.KK=!1);else this.formulaAssistanceTelemetryManager.Tpb.formulaAssistanceRequestOptimizedCounter++;else this.KK=!1}rh(){this.Shj||(this.oTa=null,this.JUd&&this.formulaAssistanceControl.SZ())}Nf(){this.KK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Rvc();this.Zk&&this.DCi()}QId(ba,cb){return this.formulaAssistanceControl.Xh(ba,cb)}DCi(){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.uaa&&
!this.formulaAssistanceControl.Qia&&!this.formulaAssistanceControl.Eoa&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.uaa=!1);this.formulaAssistanceControl.bC&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.formulaAssistanceControl.bC=!1);this.formulaAssistanceControl.Eoa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.Eoa=!1);this.formulaAssistanceControl.PTa&&
(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.PTa=!1);this.S2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.gNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,this.formulaAssistanceControl.gNa=!1))}$1g(ba,cb){let Kb=
0,lc;for(;-1!==Kb;)if(Kb=ba.indexOf("[",Kb+1),-1!==Kb&&Kb<cb&&(lc=ba.indexOf("]",Kb+1),-1===lc||lc>=cb))return Kb;return-1}zMe(){const ba=this.Za.text,cb=this.Za.textBox.caretPosition,Kb=this.formulaAssistanceControl.g6,lc=this.formulaAssistanceControl.rca;if(this.KK&&hb.a.equals(ba,Kb,!0)&&cb===lc)return!1;this.formulaAssistanceControl.g6=ba;this.formulaAssistanceControl.rca=cb;return!0}}kf.zye=" !%&'()*+,-/:;<=>@[]^{|}~".split("");kf.Wuf=255;Object(d.a)(kf,"FormulaAutoCompleteListAutoCompleteBehavior",
Te.a,[]);var Oe=a(30),$a;(function(ba){ba[ba.function=0]="function";ba[ba.field=1]="field";ba[ba.definedName=2]="definedName";ba[ba.letVariable=3]="letVariable";ba[ba.tableColHeaderName=4]="tableColHeaderName";ba[ba.tableSpecialStructRef=5]="tableSpecialStructRef";ba[ba.pendingData=6]="pendingData";ba[ba.tableNamedObject=7]="tableNamedObject"})($a||($a={}));Object(d.b)("ItemType",$a);var Zb=a(1092),Da=a(1091);class Pa{constructor(ba){this.index=ba}execute(ba){ba.push(this.index)}}Object(d.a)(Pa,"AppendIndexOperation",
null,[616]);class tb{execute(){}}Object(d.a)(tb,"NopIndexOperation",null,[616]);class Ib{constructor(ba,cb){this.C8i=ba;this.Zwf=cb}execute(ba){for(let cb=0;cb<ba.length;cb++)ba[cb]===this.C8i&&(ba[cb]=this.Zwf)}}Object(d.a)(Ib,"ReplaceIndexOperation",null,[616]);var Yb=a(79);class vc{constructor(ba,cb){this.$=ba;this.items=cb;this.vNa=va.a.vNa(this.$)}XIe(ba,cb){const Kb=new Pa(cb);if(!this.vNa)return Kb;ba=this.$wi(ba,cb);return null!=ba?this.items[ba].OBb?new Ib(ba,cb):new tb:Kb}$wi(ba,cb){const Kb=
this.items[cb];v.ULS.shipAssertTag(537162075,0,!!Kb,"Internal error: invalid item index");ba=Yb.where(Yb.asEnumerable(ba),lc=>this.items[lc].name===Kb.name);return Yb.Ct(ba)?Yb.first(ba):null}}Object(d.a)(vc,"FilterItemOperationFactory",null,[]);var Zc=a(117),nd=a(837);class hd{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(hd,"CompletionItem",null,[]);const Ud=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${t.a.hq}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${t.a.hq}'>{5}</td>\r\n</tr>`,
ee=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${t.a.hq}'></td>\r\n\t<td id='${"item_type_cell"}' class='${t.a.hq}'>{2}</td>\r\n</tr>`,ec=`<td>\r\n\t<div class='${t.a.Rx}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Vc=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${t.a.hq}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${t.a.hq}'>{2}</td>\r\n</tr>`;
class ud extends Zb.a{constructor(ba,cb,Kb,lc,Qc,Rc){super(ba,cb);this.htmlSanitizationHelper=Qc;this.Sra=null;this.afb=this.qxc=0;this.Trb=null;this.XZe=Kb;this.Zvb=lc;this.formulaAssistanceControl=Rc;this.vp=[];this.vW=[];this.mkf=(this.Zk=va.a.k5(ba))&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");this.jqi=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7253303_ReduceInnerHTMLUsageFormulaAutoCompleteListBox")}KXc(ba){this.addHandler("FLBSelectedRowChanged",
ba)}HMd(ba){this.removeHandler("FLBSelectedRowChanged",ba)}l0b(ba){this.addHandler("ACLBUpdated",ba)}Zuc(ba){this.removeHandler("ACLBUpdated",ba)}get ckc(){return 0<this.afb&&this.afb===this.vp.length}get Aui(){return 0<this.afb}get qe(){return super.qe}set qe(ba){super.qe=ba;ba||(this.qxc=0,this.ee=null);0===this.qxc?Oa.DOMElementExtensions.setVisible(this.Zvb,ba&&!this.Zk):Oa.DOMElementExtensions.setVisible(this.Zvb,!1)}get Nj(){return this.Sra}set Nj(ba){this.mCa(this.Nj);if(ba){this.XZe.innerText=
"";this.Sra=ba;var cb=this.mCa(this.Nj);const Kb=ba.rowIndex+1,lc=$get("description_cell"+Kb,ba);this.Zvb.innerText=lc.innerText;const Qc=$get("item_type_cell",ba);this.ee=cb=cb.innerText;this.qxc="field"===Qc.innerText?1:"definedName"===Qc.innerText?2:"letVariable"===Qc.innerText?3:"tableColHeaderName"===Qc.innerText?4:"tableSpecialStructRef"===Qc.innerText?5:"pendingData"===Qc.innerText?6:"tableNamedObject"===Qc.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Da.a(this.vp.length,Kb,cb,
lc.innerText));this.cxc(ba)}}get HUa(){return this.Zvb}get tHa(){return this.formulaAssistanceControl}get P0(){return this.qxc}dispose(){super.dispose();this.Sra=this.XZe=this.Zvb=null}ABc(ba,cb,Kb,lc=0){this.mkf||this.l8(!1);let Qc="";Kb&&(Qc+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${Bc.a.N6g}'>${Kb}</td></tr></table>`);Qc+=`<table class='${this.m6}' aria-live='off'><tbody>`;const Rc=new ta.a;for(let ae=0,ze=this.vW.length;ae<ze;ae++)Qc+=this.Z7e(ba[this.vW[ae]],ae+1,
cb,lc),this.Zk&&Rc.add(this.y1e(ba[this.vW[ae]]));let zd=this.vW.length;for(let ae=0,ze=this.vp.length;ae<ze;ae++)this.vW.includes(this.vp[ae])||(zd++,Qc+=this.Z7e(ba[this.vp[ae]],zd,cb,lc),this.Zk&&Rc.add(this.y1e(ba[this.vp[ae]])));Qc+="</tbody></table>";this.jqi?this.htmlSanitizationHelper.sk(this.If,Qc):this.If.innerHTML=Qc;this.Ln=Oa.DOMElementExtensions.ik(this.domElement,this.m6);this.Zk&&(this.Trb=Rc.toArray());this.mkf?(this.qe=!0,this.tHa.set_visible(!0)):(this.l8(!0),this.XPg(!!Kb))}wKa(ba,
cb,Kb,lc="",Qc=0,Rc=!1){if(ba){var zd=[],ae=[];this.afb=0;var ze=new vc(this.$,ba);if(cb){var Be=!!cb&&0<Qc,xe=Be&&91===cb.charCodeAt(Qc+1)?Qc+2:Qc+1;Rc=Be?cb.length===xe:!1;Be&&cb.length===Qc&&qa.EwaSettings.ma(135)&&(Rc=!0);var Ce=null;!Rc&&Be&&cb.length>Qc+1&&(Ce=cb.substring(xe,cb.length));if(cb)for(let ef=0,Jf=ba.length;ef<Jf;ef++)if(Be=ba[ef].name,!ba[ef].yni){xe=ze.XIe(zd,ef);ba[ef].OBb&&this.afb++;if(!Ce&&!Rc||0===ba[ef].itemType)({bef:zd,sNf:ae}=this.uXe(cb,Be,Kb,xe,zd,ae));Ce&&1===ba[ef].itemType&&
({bef:zd,sNf:ae}=this.uXe(Ce,Be,!0,xe,zd,ae));Rc&&1===ba[ef].itemType&&xe.execute(zd)}}else for(Kb=0;Kb<ba.length;++Kb)if(ba[Kb].OBb||Rc)Ce=ze.XIe(zd,Kb),Ce.execute(zd),Ce.execute(ae),ba[Kb].OBb&&this.afb++;this.vW=ae;this.vp=zd;this.ABc(ba,cb,lc,Qc)}}Q_j(ba){if(ba&&!(1<ba.length)){var cb=[],Kb=[];cb.push(0);Kb.push(0);this.vW=cb;this.vp=Kb;this.ABc(ba,"","",0)}}Xya(){this.Nj&&super.Xya()}$aj(ba,cb){this.raiseEvent("ACLBUpdated",new Da.a(ba,void 0,void 0,cb))}ojg(ba){const cb=this.Ln.rows[ba];return(!this.Nj||
this.Nj!==cb)&&ba<this.Ln.rows.length?(this.Nj=cb,!0):!1}static z1e(ba){switch(ba){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(ba){wa.g(ba.Ca);0===this.P0||2===this.P0||3===this.P0||4===this.P0||5===this.P0||7===this.P0?(this.raiseEvent(nd.a.M5a),this.Xya()):1===this.P0?this.tHa.mz(!1):(this.tHa.mz(!1),ba=I.h(this.$),ba.Uo(!1),ba.focus());return!0}XPg(ba){this.Fsa();if(ba){var cb=this.Ln.offsetWidth+
(this.vp.length>this.sI?Zc.a.Ou:0);ba=$get("list_column_header");ba.offsetWidth>cb&&Oa.DOMElementExtensions.Xv(this.If,ba.offsetWidth);cb=this.If.getElementsByClassName(this.UV);for(let Kb=0;Kb<cb.length;Kb++)cb[Kb].style.width=F.HelperMethods.uc(ba.offsetWidth)}}Z7e(ba,cb,Kb,lc){if(1===ba.itemType){const Qc=Oe.a.Eg(ba.name),Rc=Oe.a.Eg(lc?Kb.substring(lc+1,Kb.length):Kb);let zd=0;Qc.substring(0,Rc.length).toLowerCase()!==Rc.toLowerCase()&&(zd=ud.nNj(Qc,n.rmg,Rc));Kb="";Kb=0<=zd?Kb+(Qc.substring(0,
zd)+"<b>"+Qc.substring(zd,zd+Rc.length)+"</b>"+Qc.substring(zd+Rc.length,Qc.length)):Kb+Qc;lc=lc?String.format(ec,t.a.ETe,Oe.a.h_(ka.a.Ge(0)),w.a.instance.ga(712)):"";return String.format(ee,lc,cb,$a[ba.itemType],this.UV,Kb)}if(5===ba.itemType)return String.format(Vc,"",cb,$a[ba.itemType],this.UV,Oe.a.Eg(ba.name),Oe.a.Eg(ba.Nja));if(4===ba.itemType)return String.format(Vc,"(...)",cb,$a[ba.itemType],this.UV,Oe.a.Eg(ba.name));if(6===ba.itemType)return lc=lc?String.format(ec,t.a.ETe,Oe.a.h_(ka.a.Ge(0)),
w.a.instance.ga(712)):"",String.format(Ud,lc,this.UV,Oe.a.Eg(ba.name),Oe.a.Eg(ba.Nja),cb,$a[ba.itemType]);lc=String.format(ec,2===ba.itemType||3===ba.itemType?t.a.AAh:t.a.yAh,Oe.a.h_(ka.a.Ge(0)),w.a.instance.ga(709));return String.format(Ud,lc,this.UV,Oe.a.Eg(ba.name),Oe.a.Eg(ba.Nja),cb,$a[ba.itemType])}y1e(ba){const cb=new hd;cb.label=ba.label;cb.textEdit=ba.textEdit;cb.kind=ud.z1e(ba.itemType);cb.type=ba.OBb?1:0;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&
3===cb.kind){const Kb=this.formulaAssistanceControl.NWh(ba.label);cb.detail=Kb?Kb:ba.Nja}else cb.detail=ba.Nja;return cb}uXe(ba,cb,Kb,lc,Qc,Rc){hb.a.equals(cb,"Pretend this is the line.",!1)&&0<Qc.length||hb.a.zG(cb,ba)?(lc.execute(Qc),lc.execute(Rc)):Kb&&ba.length>=n.Fah&&ud.wlh(cb,n.rmg,ba)?lc.execute(Qc):!Kb&&ba.length>=n.Eah&&hb.a.contains(cb,ba,!0)&&lc.execute(Qc);return{bef:Qc,sNf:Rc}}static wlh(ba,cb,Kb){for(const lc of cb)if(cb=ba.split(lc),!(2>cb.length))for(const Qc of cb)if(hb.a.zG(Qc,
Kb))return!0;return!1}static nNj(ba,cb,Kb){for(const lc of cb)if(cb=ba.toLowerCase().indexOf((lc+Kb).toLowerCase()),0<cb)return cb+1;return-1}}Object(d.a)(ud,"FormulaAutoCompleteListBox",Zb.a,[584]);class ke{constructor(){this.V9=this._name=null}get name(){return this._name}get toolTip(){return this.V9}}Object(d.a)(ke,"LETVariableInfo",null,[]);class te{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(te,"TableColHeaderNameInfo",null,[]);class pe{constructor(){this._name=null}get name(){return this._name}}
Object(d.a)(pe,"TableNamedObjectInfo",null,[]);class rf{constructor(){this.V9=this._name=null}get name(){return this._name}get toolTip(){return this.V9}}Object(d.a)(rf,"TableSpecialStructRefInfo",null,[]);var cf=a(171),wf=a(29),Ge=a(99),Ue=a(906),gb=a(251),Ob=a(51),rc=a(145);class Oc{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(Oc,"FormulaAutoCompleteCallbacks",null,[]);class ld{constructor(){this.callbacks=
this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(ld,"FormulaAutoCompleteRenderingInfo",null,[]);class Cd{}Object(d.a)(Cd,"RunExperimentRequest",null,[]);class Qd extends ub.a{constructor(ba,cb,Kb,lc,Qc,Rc,zd,ae,ze,Be){super(ba);this.functionInfoManager=cb;this.calcManager=lc;this.instantaneousSupportInformationManager=Qc;this.formulaAssistanceUIControl=zd;this.formulaAssistanceTelemetryManager=ae;this.pluginScheduler=ze;this.xfc=!1;this.Y5=this.uud=this.QV=this.Ig=this.uHa=this.Rq=null;
this.$6b=this.QOb=this.Wtb=this.UNe=this.f4=this.xbc=this.q4a=0;this.Bzc=!1;this.Frc=this.pja=null;this.columnName="";this.YAe=this.l8c=!1;this.IKa=[];this.uQ=null;this.f8=[];this.O8=this.ued=this.Ro=null;this.Qia=this.uaa=this.gNa=this.isCellContentOnlyEqualDuringEdit=this.PTa=this.Eoa=this.bC=this.bga=!1;this.g6=null;this.rca=0;this.$5d=null;this.DEb=0;this.lpd=!1;this.onRestoreFocus=()=>{};this.fhb=void 0;this.Vba=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");
this.Vjf=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.hBb=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.xkd=()=>{this.Zk&&this.raiseEvent(Qd.Add,null)};this.qXe=()=>{this.pja=!1;this.QV=this.Za.text;this.Ug.wKa(this.Ar,this.QV,!0,this.columnName,void 0,!1);1===this.Ug.vp.length&&1===this.Ug.vW.length?(this.set_visible(!1),this.YAe||this.rnd()):this.show()};this.kUi=xe=>
{if(dd.a(xe))-315732528!==xe.Errors[0].MessageId&&v.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${wf.a.sc(xe.Errors)}`);else if((xe=xe.Result)&&xe.length){this.Ig.WO||(this.Ig.WO={},this.Ig.WO.HeadersList=[]);this.Ig.WO.IsFullTableHeaders=!0;for(let Ce=0;Ce<xe.length;++Ce)this.Ig.WO.HeadersList[Ce]={},this.Ig.WO.HeadersList[Ce].Index=Ce,this.Ig.WO.HeadersList[Ce].Name=xe[Ce];this.QMf(!0);this.QV=this.Y7e();
this.Ug.wKa(this.Ar,this.QV,!0,void 0,void 0,!0);this.show()}else v.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.jUi=xe=>{xe=ha.a.Oe(xe.data);v.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${wf.a.sc(xe)}`)};this.Qyf=(xe,Ce)=>{this.gridView.eb||this.gridView.ri||this.sPa(null===Ce||void 0===Ce?void 0:Ce.cell)};this.rh=(xe,Ce)=>{this.sPa(null===
Ce||void 0===Ce?void 0:Ce.Gja)};this.L6=(xe,Ce)=>{this.qPd(Ce.newValue)};this.Pc=()=>{(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Zk)&&this.set_visible(!1)};this.PCf=()=>{this.O8=this.uHa=null};this.Eh=()=>{this.Zk&&this.H2a()};this.onFunctionInfoLoaded=()=>{this.Apb()};this.vza=()=>{this.Qka?(this.uHa=this.O8=null,this.Apb()):this.Sg.$k&&this.Cwe()};this.ada=()=>{this.uQ&&H(this.$,this.uQ.HelpId,this.uQ.IsDynamicUdf);return!0};this.cda=
(xe,Ce)=>{0==Ce.Mr&&(170==Ce.Qf.operation.operationName&&this.formulaAssistanceTelemetryManager.wlc++,this.$.userOperationManager.mo(this.cda))};this.QPa=(xe,Ce)=>{0==Ce.Mr&&(12==Ce.Qf.operation.operationName&&this.$.userOperationManager.xr(this.cda),this.$.userOperationManager.mo(this.QPa))};this.H2a=()=>{this.Zk&&this.Bwd();qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.bC&&(this.uaa=!0);this.SF&&this.Za.eb&&this.zna();this.Ro=null;this.formulaAssistanceUIControl&&
(this.formulaAssistanceUIControl.dismiss(this.$1b),this.Rq.Ff=!1);this.lpd=!1};this.JHf=()=>{this.SF&&this.zna();this.r9f();1===this.s1f.type&&qa.EwaSettings.xb()&&!this.Za.text.includes("\n")&&this.KHd(this.s1f)};this.onDismiss=()=>{this.qe=!1;this.gridView.zi.textBox.focus()};this.ASa=()=>{const xe={};xe[y.a.GQ]=this.Ug.ckc?"SmartSuggestionsCard":this.Ug.Aui?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,xe)};this.OCd=(xe,Ce)=>{this.Ug.ojg(Ce);this.Zk&&(this.AJa=
!0)};this.NCd=xe=>{this.Zk&&(this.xJa=!0);this.SF?(this.tFe(),this.f$&&this.W_f(),this.gridView.Eaa.w2f(),this.gridView.zi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):xe.textEdit?this.Orb(xe.textEdit):this.mz(!0)};this.Aq=I.h(ba);this.domElement.className=Bc.a.rRe;this.Sg=Rc.O5c(ba,Kb);this.O7b=new zb(ba);this.XEg=Kb;Qd.bgc||(Qd.bgc=Qd.TKa());qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252767_ReduceInnerHTMLUsageFormulaAssistanceControl")?
Be.sk(this.domElement,Qd.bgc):this.domElement.innerHTML=Qd.bgc;this.QBd=RegExp("\\d+");gb.d(this.style,this.$.isChromeRtl);this.Hja=new de(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,Be);cb=$get(n.qed,this.domElement);Kb=$get(n.med,this.domElement);lc=$get(n.ted,this.domElement);this.Zwg=new ud(this.$,cb,lc,Kb,Be,this);this.Sg.c0b(this.vza);this.functionInfoManager.MGa(this.onFunctionInfoLoaded);this.functionInfoManager.QMg(this.PCf);
this.$1b=this.domElement;this.Zk&&(this.$.xa.Uf(this.Eh),this.Ug.KXc(this.JHf),qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.$1b=document.createElement("div")));this.fUa(!0);this.Gbg(!0);this.$.domElement.appendChild(this.$1b);this.MSc=0;(Be=X.a(ba))&&this.IKa.push(new kf(ba,Be,this,this.formulaAssistanceTelemetryManager));this.IKa.push(new kf(ba,this.Aq.Vb,this,this.formulaAssistanceTelemetryManager));this.Tvb=this.IKa[0];this.$qb=this.IKa[this.IKa.length-
1];ba.da.Ga(221,this);this.instantaneousSupportInformationManager||this.$.da.$a(268,xe=>{this.instantaneousSupportInformationManager=xe});this.IWe=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);qa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.hX.anyPluginInitialized?v.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):
this.formulaAssistanceTelemetryManager.hX.anyPluginInitialized||(this.DEb=qa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.OTa=va.a.vNa(this.$);this.bGj=va.a.Mpb(this.$);this.qBd=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.S2=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.D_c=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");va.a.EV(this.$)&&
this.nod();va.a.DN(this.$)&&cb.classList.add("ewa-fb-refactor");this.Zk?this.gridView.ha.kH(this.Pc):this.gridView.ha.RT(this.Pc);this.Rq=new Pb(this.$,this.formulaAssistanceUIControl,1,fc.a.Udd,this.xkd);this.Upd=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.f$=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.Upi=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1)}yre(ba){this.addHandler(Qd.$dd,
ba)}BVf(ba){this.removeHandler(Qd.$dd,ba)}wre(ba){this.addHandler(Qd.Add,ba)}zVf(ba){this.removeHandler(Qd.Add,ba)}xre(ba){this.addHandler("FormulaAutoCompleteShown",ba)}AVf(ba){this.removeHandler("FormulaAutoCompleteShown",ba)}get ou(){return this.Ug}get Ar(){return this.O8}get ULb(){return this.Ug.ee}get TZe(){return this.Ug}get yZe(){return this.Hja}get Ug(){return this.Zwg}get b2a(){return this.OTa?this.Za?this.Za.text:null:this.QV}get rkf(){var ba;return 0===(null===(ba=this.kYe)||void 0===ba?
void 0:ba.type)}get Jui(){var ba;return 1===(null===(ba=this.kYe)||void 0===ba?void 0:ba.type)}get_visible(){return void 0!==this.fhb?this.fhb:this.fhb=super.get_visible()}set_visible(ba){if(this.fhb===ba)return this.Zk&&!ba&&this.H2a(),ba;this.Hja.set_visible(ba);this.Zk&&!ba&&this.H2a();Sys.UI.Control.prototype.set_visible.call(this,ba);return this.fhb=ba}get qe(){return this.ou.qe}set qe(ba){this.Zk&&!ba&&this.H2a();this.ou.qe=ba}get tableManager(){return this.XEg}get Qka(){return 0<this.xZ}get SF(){return this.bga}get gridView(){return this.Upi?
this.Aq:I.h(this.$)}get Bb(){return this.gridView.Bb}h1g(ba,cb){this.qe&&(ba+=n.openParen,cb++,this.bGd(ba,cb));var Kb=cb===ba.length||ba.charAt(cb)===n.closeParen;if(!(0<cb&&ba.charAt(cb-1)===n.openParen&&Kb))return v.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${cb} is invalid. Is cell empty: ${!ba.length}. Function exists in cell: ${!!this.uQ}`),!1;Kb=ba.substring(0,cb).lastIndexOf(this.$.listSeparator);const lc=ba.substring(0,cb-1).lastIndexOf(n.openParen);
ba=ba.substring(-1===Kb&&-1===lc?1:Math.max(Kb,lc)+1,cb-1).trim();return this.functionInfoManager.Sgd(ba)?!0:(v.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.uQ}`),!1)}sji(ba,cb){var Kb=this.h1g(ba,cb);if(!Kb||!this.uQ)return v.ULS.shipAssertTag(537162051,0,!Kb||Kb&&!!this.uQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Vwf:0,
mYe:0};Kb=this.uQ.Params;Kb=Kb.replace(RegExp("[\\[\\]]","g"),"");const lc=ba.charAt(cb-1)===n.openParen,Qc=lc?"":"(",Rc=cb===ba.length?")":"";var zd=this.$.listSeparator;zd=Kb.includes(zd)?Kb.indexOf(zd):Kb.length;return{returnValue:ba.substring(0,cb)+Qc+Kb+Rc+ba.substring(cb,ba.length),Vwf:lc?cb:cb+1,mYe:zd}}Tt(ba,cb){this.Zk&&void 0!==this.Ro&&null!==this.Ro&&this.Ro();this.Zk||super.Tt(ba,cb)}get K1b(){return this.$5d}get xZ(){return this.UNe}set xZ(ba){this.UNe=ba;ba||(this.f4=0)}get GFj(){if(null==
this.Frc){const ba=this.$.dc;this.Frc=!!ba&&!ba.inEmbedView}return this.Frc}get s1f(){return this.Ug.Trb[this.Ug.Nj.rowIndex]}get kYe(){var ba,cb;return null===(cb=null===(ba=this.Ug)||void 0===ba?void 0:ba.Trb)||void 0===cb?void 0:cb[0]}get $Ze(){!this.ued&&this.pluginScheduler&&(this.ued=this.pluginScheduler.getFunctionsShortDescriptions());return this.ued}dispose(){if(this.$){this.fUa(!1);const ba=this.gridView;this.f$&&(this.$.userOperationManager.mo(this.cda),this.$.userOperationManager.mo(this.QPa));
ba&&(ba.ha&&(this.Zk?ba.ha.mG(this.Pc):ba.ha.aS(this.Pc),va.a.EV(this.$)&&4!==this.DEb&&(this.hBb?ba.fc.Fk(this.rh):ba.ha.Ana(this.Qyf))),ba.view.ir(this.wpc));this.Zk&&this.$.xa&&this.$.xa.Bg(this.Eh)}this.functionInfoManager&&(this.functionInfoManager.Dcb(this.onFunctionInfoLoaded),this.functionInfoManager.Ijj(this.PCf));this.Sg&&this.Sg.Ruc(this.vza);this.Zk&&this.Ug&&this.Ug.HMd(this.JHf);va.a.thc&&this.Za&&this.Za.$Jb(this.L6);this.Gbg(!1);ca.a.Ia(this.Ug);ca.a.Ia(this.K1b);ca.a.Ia(this.Hja);
ca.a.Ia(this.Rq);this.Za=this.functionInfoManager=this.Sg=null;ca.a.qc(this.IKa);this.Ig=this.O8=this.Hja=this.IKa=null;super.dispose()}Kxa(){return!this.Ar}Hqi(){return!this.uHa}BYj(ba){this.Jui&&1872288872===ba&&(this.formulaAssistanceTelemetryManager.Bw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Qia=!0)}Xh(ba,cb){if(!this.Kxa()){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.BYj(cb);if(this.Zk&&this.SF){if(125627505===cb||267796030===cb)return this.Zk&&
this.BDc(cb),this.tFe(),this.f$&&this.W_f(),!1;if(1872288872===cb)return this.zna(),this.qe=!1,!0;if(this.Ug.ckc&&(-798660877===cb||137938150===cb))return!1}if(1!==this.Ug.P0||125627505!==cb&&267796030!==cb)if(6===this.Ug.P0){var Kb=ba.keyCode;13!==Kb&&9!==Kb||this.mz(!1)}else{if(4===this.Ug.P0||5===this.Ug.P0)return super.Xh(ba,cb,!0);1===this.Ug.vW.length&&(Kb=ba.keyCode,this.YAe=8===Kb||127===Kb||46===Kb?!0:!1)}else{if(this.mz(!1)&&!this.Qka)return this.gridView.ha.Xh(ba,cb);if(125627505===cb&&
this.Qka)return!0}}return super.Xh(ba,cb)}Rvc(){this.Sg.bdb();this.O8=null;null==this.pja||this.pja||this.Zlc("NoFieldChosen",1,2,1);this.pja=null;this.xZ=0;this.Y5=this.uud=this.Frc=null}Apb(){this.Vjf&&this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceOverall"]);const ba=!!this.Za&&!ab.f(this.$.na);let cb=null;this.S2&&ba&&(cb=this.Za.text,cb.startsWith("=")&&(this.gNa=!0,1===cb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.bGj&&ba){this.S2||(cb=this.Za.text);const Kb=
{content:cb,caretPosition:null};(this.Vba?this.pluginScheduler.getRequester().functionSuggestion(Kb,0):this.pluginScheduler.requester().functionSuggestion(Kb)).then(lc=>{if(0===lc.kind){v.ULS.shipAssertTag(537162050,0,!!lc&&!!lc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Qc=Yb.toArray(Yb.select(Yb.asEnumerable(lc.payload.items),Rc=>Qd.t$g(Rc)));this.gridView.Eaa.hSd(lc.payload,cb);this.OTa&&(this.f8=Qc,kb.AFrameworkApplication.Lg||(this.D_c&&
this.Bb.J5(this.gridView.ha.ra.activeCell)?this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++:this.Dwe(ba,!0)))}return null})}this.OTa&&ba||this.Dwe(ba,!1)}Y7e(){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var ba=this.gridView.Vl?this.Tvb.vQ:this.$qb.vQ;this.QOb="@"===this.Za.text.charAt(ba+1)&&this.Za.textBox.caretPosition>ba+1?ba+2:ba+1}else{ba=this.Za.text.lastIndexOf(n.Gpf);const cb=this.Za.text.lastIndexOf("[");
this.QOb=ba+1>=cb?ba+2:cb+1}return this.Za.text.substring(this.QOb,this.Za.textBox.caretPosition)}Ewe(){this.E9f()&&(this.rhh(),this.Ar&&(this.pja=!1,this.QV=this.Y7e(),this.Ug.wKa(this.Ar,this.QV,!0,void 0,void 0,!0),this.show(),qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Hja.Jtb()))}Cwe(){this.E9f()&&(this.K1b&&this.K1b.cancel(),this.Sg.w7a?(this.Kxa()&&this.JHe(!0),this.get_visible()?this.qXe():this.$5d=cf.AsyncMethodContext.Gr(this.qXe,
n.Skh,ib.a.JKh,this.K1b)):this.SZ())}E9f(){return this.Za?0<this.$.rb.KR||!this.Za.text||!this.Za.eb?(this.set_visible(!1),!1):ab.f(this.$.na)?!1:!0:!1}Orb(ba){this.Za&&this.qe&&(this.Cod(this.Za.text,ba),this.Za.textBox.caretPosition=ba.range.start.character+ba.newText.length,this.set_visible(!1))}mz(){var ba;if(!this.Za||!this.qe)return!1;const cb=this.Ug.P0;this.formulaAssistanceTelemetryManager.Tdf(ud.z1e(cb));let Kb="";var lc=0;const Qc=this.gridView;var Rc=this.Za.text,zd=0,ae=this.Ug.ee,ze=
!1;if(0===cb||2===cb||3===cb||7===cb)Kb+=Rc.substr(0,this.q4a)+this.Ug.ee,0!==cb||this.Ug.ee.endsWith(")")||(Kb+="("),lc=Kb.toString().length,Kb+=Rc.substr(this.xbc),2===cb&&(zd=4,ae="DefinedName",ze=!0,this.set_visible(!1));else if(1===cb)if(this.pja=!0,this.Qka){Kb+=Rc.substr(0,this.xZ+2);!Kb.toString().endsWith(hc.a.JU)&&qa.EwaSettings.ma(135)&&(Kb+=hc.a.JU);zd=this.Ug.ee;zd=zd.replace("'","''");zd=zd.replace("[","'[");zd=zd.replace("]","']");if(this.l8c||this.oGh(zd))zd=hc.a.Bzi+zd+hc.a.Pqj,ze=
!0;Kb+=zd;lc=Kb.length;zd=3;rc.a("PulloutFieldAccepted")}else return this.Za.text=this.Ug.ee,this.set_visible(!1),Qc.Uo(!1),Qc.focus(),this.Zlc("FieldName",1,1,1),rc.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===cb)v.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),Kb+=Rc.substr(0,this.QOb),hb.a.equals(this.Ug.ee,"@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString,!1)?Kb+="@":(Kb+=this.Ug.ee,
ze=!0,this.set_visible(!1)),lc=Kb.length;else if(4===cb){v.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Kb+=Rc.substr(0,this.QOb);ze="";lc=!1;var Be=[39,91,93,64,35];for(let xe=0;xe<this.Ug.ee.length;xe++){const Ce=this.Ug.ee.charCodeAt(xe);Be.includes(Ce)&&(ze+="'");ze+=this.Ug.ee.charAt(xe).toString();lc||hb.a.isNumeral(Ce)||hb.a.Ijf(Ce)||(lc=!0)}Be=this.gridView.Vl?this.Tvb.vQ:this.$qb.vQ;Rc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
"@"===Rc.charAt(Be+1)&&lc:Rc.lastIndexOf(n.Gpf)+1>=Rc.lastIndexOf("[")&&lc;Kb+=Rc?"["+ze+"]":ze;ze=!0;this.set_visible(!1);lc=Kb.toString().length}else if(6===cb)Kb+=Rc.substr(0,this.Wtb);else return v.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Za.text=Kb;this.Za.textBox.caretPosition=lc;this.Za.Zxa()&&(null===(ba=Qc.ks)||void 0===ba?0:ba.Eva)&&Qc.ks.cMb(this.Za.text,this.Za.textBox.caretPosition,this.Za.textBox.caretPosition,this.Za.textBox.Sy.length);
Qc.Vl&&(ba=Qc.Vb,ba.text=this.Za.text,ba.setCaretPosition(this.Za.textBox.caretPosition));ae=(null==this.pja?0:this.pja)?"FieldName":ae;this.Ug.Nj.sectionRowIndex>=this.Ug.vW.length?this.Zlc(ae,4,zd,0):this.Zlc(ae,1,zd,0);ze||(5===cb||4===cb?this.Ewe():this.Apb());return!0}SZ(ba=null,cb=null){ba?(this.Sg.bdb(),this.Sg.SZ(ba,!1,!1,cb)):(ba=this.gridView,ba.ha.ra.Mg&&(ba=za.v(ba.ha.ra.$c,this.$),this.Sg.SZ(ba,!0,!0,cb)))}zna(){this.bga=!1;this.Za.aNe()}NWh(ba){ba=this.calcManager.getWorksheetFuncId(ba);
return this.$Ze?this.$Ze.descriptionsMap.get(ba):null}JHe(ba){if(this.Hqi()){if(this.Sg.w7a&&this.Sg.$k&&(!this.Sg.$k.length||!this.Sg.$k[0].FieldInfoDataList))return;this.NYj(ba)}ba=Yb.asEnumerable(this.uHa);ba=Yb.concat(ba,this.QYh(this.Za.text));qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Zk&&(ba=Yb.concat(ba,this.b_h()));Yb.OBc(ba,cb=>cb.name,new Ue.a);this.OTa&&(ba=Yb.concat(Yb.asEnumerable(this.f8),ba),qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.f8.length?(this.bC||this.formulaAssistanceTelemetryManager.mA(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.bC=!0):this.bC&&this.rkf&&(this.uaa=!0):0<this.f8.length&&(this.bC=!0),this.f8=[]));this.O8=Yb.toArray(ba)}rhh(){var ba=this.Za.text;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var cb=this.gridView.Vl?this.Tvb.hJa:
this.$qb.hJa,Kb=!0;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==cb&&(this.Ig=Object(Lb.a)(Ae.a,this.$.Cb.getItemByName(cb))),this.Ig||(this.Ig=this.tableManager.Ig,Kb=!1),!this.Ig){v.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Ig=Object(Lb.a)(Ae.a,this.$.Cb.getItemByName(cb)),
this.Ig||(this.Ig=this.tableManager.Ig,Kb=!1);this.Ig.WO&&this.Ig.WO.IsFullTableHeaders?this.QMf(Kb):pb.d(this.Ig)?(v.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),Gb.q(this.$.pa.ya,this.Ig.nj,this.kUi,this.jUi,null,null)):v.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Ig)if(cb=
this.calcManager.E5a(this.tableManager.Ig))if(this.calcManager.LQg(this.tableManager.Ig,cb)){ba=Yb.empty();if(91===this.Za.text.charCodeAt(this.Za.text.length-1)){const lc=this.X1a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);ba=Yb.concat(ba,(Kb=new ta.a,Kb.add(lc),Kb))}ba=Yb.concat(ba,Yb.select(Yb.asEnumerable(cb.toArray()),lc=>{const Qc=new Ea,Rc=new te;Rc._name=lc.toString();Qc.w5f(Rc);return Qc}));this.O8=Yb.toArray(ba)}else ba.endsWith("[")&&"["!==ba.charAt(ba.length-
2)&&v.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${cb.count} columns for a table with id ${this.tableManager.Ig.nj} of size ${this.tableManager.Ig.usedRange.right-this.tableManager.Ig.usedRange.left+1}`);else ba.endsWith("[")&&"["!==ba.charAt(ba.length-2)&&v.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}oGh(ba){if(!ba)return!1;
let cb=ba.charCodeAt(0);if(46===cb||48<=cb&&57>=cb||63===cb)return!0;for(let Kb=0;Kb<ba.length;Kb++,cb=ba.charCodeAt(Kb))if(!((qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?hb.a.isLetter(cb):hb.a.vrd(cb))||92===cb||95===cb||63===cb||48<=cb&&57>=cb))return!0;return!1}bGd(ba,cb){let Kb=!1,lc=!1;var Qc=!1,Rc=0;let zd=0;this.q4a=0;this.xbc=cb;this.$6b=1;for(let ae=cb-1;0<=ae;--ae)switch(ba.charCodeAt(ae)){case 39:lc=!lc;break;case 34:Kb=
!Kb;break;case 91:++Rc;Qc=Rc>zd;break;case 93:++zd}Qc=Object(oa.a)(new Re,{zta:!Kb,Ata:!lc,mia:!Qc,zHb:1});Rc=this.W3i(ba,cb,Qc);cb=this.X3i(ba,cb,Qc.zta,Qc.Ata,Qc.mia);this.$6b=Rc+cb;if(this.MSc=Rc-1)this.Bzc=!1;this.eHh(ba,Kb,lc,Qc.CFd,Qc.DFd)}nod(){4!==this.DEb&&(this.hBb?this.gridView.fc.Xk(this.rh):this.gridView.ha.lha(this.Qyf));const ba=va.a.Vzb()?this.Aq.Sb(null):void 0;this.sPa(ba);va.a.thc&&this.gridView.zi.IZa(this.L6);Qd.vPd(this.pluginScheduler);this.OTa&&this.B3g()}IFh(){return this.OTa||
this.IWe}Y3i(){var ba=this.Y5;if(!this.GFj||!ba)return this.xZ=0,this.uHa=this.O8=null,!1;ba=ba.endsWith(hc.a.JU);let cb;if(qa.EwaSettings.ma(135)&&({sheetRange:cb}=this.gWj(this.Y5.substring(0,this.f4))).returnValue){const Kb=this.Y5.substring(0,this.xZ);if(ba&&Kb!==this.uud)return this.uud=Kb,this.xZ=this.Y5.length-(ba?1:0),this.SZ(cb,this.Y5),this.pja=!1,v.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}QYh(ba){const cb=new ta.a;this.calcManager&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
v.ULS.shipAssertTag(537162014,0,!!this.calcManager.Ota(na.Range.Qc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.IWe&&(ba=this.calcManager.extractLetVariables(ba,this.Za.textBox.caretPosition)))for(const Kb of ba){ba=new ke;ba._name=Kb;ba.V9=w.a.instance.ga(2209);const lc=new Ea;lc.xzj(ba);cb.add(lc)}return cb}b_h(){const ba=new ta.a,cb=this.$.Cb.items;for(let lc=0,Qc=cb.length;lc<Qc;lc++){var Kb=cb[lc];if(!ab.n(Kb))continue;const Rc=
new pe;Rc._name=Kb.name;Kb=new Ea;Kb.NBj(Rc);ba.add(Kb)}return ba}X1a(ba){const cb=new Ea,Kb=new rf;Kb._name=ba;cb.OBj(Kb);return cb}QMf(ba){const cb=new ta.a,Kb=this.Za.text.charCodeAt(this.Za.text.length-1),lc=this.Za.textBox.caretPosition-1;if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Za.text.charCodeAt(lc):91===Kb){var Qc=this.X1a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);cb.add(Qc)}for(var Rc of this.Ig.WO.HeadersList){Qc=
new Ea;const zd=new te;zd._name=Rc.Name;Qc.w5f(zd);cb.add(Qc)}Rc=this.gridView.Vl?this.Tvb.vQ:this.$qb.vQ;Qc=this.Za.text.charCodeAt(Rc+1);(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!ba||lc!==Rc&&35!==Qc:!ba||91!==Kb&&35!==Kb)||(ba=this.X1a("#"+this.instantaneousSupportInformationManager.Je.AllStructRefString),cb.add(ba),ba=this.X1a("#"+this.instantaneousSupportInformationManager.Je.DataStructRefString),cb.add(ba),ba=this.X1a("#"+this.instantaneousSupportInformationManager.Je.HeadersStructRefString),
cb.add(ba),ba=this.X1a("#"+this.instantaneousSupportInformationManager.Je.TotalsStructRefString),cb.add(ba));cb&&(this.O8=cb.toArray())}NYj(ba){let cb=Yb.empty();!ba&&this.functionInfoManager.GV&&(cb=Yb.concat(cb,Yb.select(Yb.asEnumerable(this.functionInfoManager.wbc),Kb=>{const lc=new Ea;lc.$3f(Kb);return lc})),ba=this.O7b.ELe,0<ba.length&&(cb=Yb.OBc(Yb.concat(cb,Yb.select(Yb.asEnumerable(ba),Kb=>{const lc=new Ea;lc.Vxj(Kb);return lc})),Kb=>Kb.name,new Ue.a)));if(this.Sg.w7a&&this.Sg.$k){if(!this.Sg.$k.length||
!this.Sg.$k[0].FieldInfoDataList)return;cb=Yb.OBc(Yb.concat(cb,Yb.select(Yb.asEnumerable(this.Sg.$k[0].FieldInfoDataList),Kb=>{const lc=new Ea;lc.tyj(Kb);return lc})),Kb=>Kb.name,new Ue.a);this.columnName=this.Sg.$k[0].ColumnName}this.uHa=Yb.toArray(cb)}sPa(ba){var cb;if(1!==this.DEb){var Kb=this.gridView.ha.ra.activeCell;if(Kb){var lc=this.calcManager.Ota(Kb,!this.Upd);if(lc){var Qc=this.$.xa,Rc=lc.sheet.index;0>=Qc.count||0>Rc||Rc>=Qc.count?v.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Qc.count}, currentSheetIndex = ${Rc}.`):
(Rc=Qc=null,this.qBd&&void 0!==this.calcManager&&null!==this.calcManager&&(ba=null!==(cb=null===ba||void 0===ba?void 0:ba.cell)&&void 0!==cb?cb:this.gridView.Ea.us(Kb))&&(cb=this.calcManager.rdc(ba.Ek),void 0!==cb&&null!==cb&&(Qc=cb.FormatString,Rc=cb.Builtin)),2!==this.DEb&&(this.pluginScheduler.notifier().setActiveCell({colIndex:lc.range.col,rowIndex:lc.range.row,sheetIndex:this.$.xa.getItem(lc.sheet.index).sheetId,docName:lc.sheet.document.name,docPath:lc.sheet.document.path,formatString:Qc,builtIn:Rc}),
v.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${lc.range.col}, row: ${lc.range.row}, format: ${Qc}`)))}else v.ULS.sendTraceTag(512278612,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else v.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}}W_f(){this.formulaAssistanceTelemetryManager.mI={Ok:this.gridView.ha.ra.activeCell,
brb:this.gridView.Vb.text,Qrb:!0};this.formulaAssistanceTelemetryManager.aDb=this.$.ea.ye;this.formulaAssistanceTelemetryManager.vlc=this.$.xa.na.sheetId;this.$.userOperationManager.xr(this.QPa)}B3g(){this.gridView.Vl?this.Tvb.ZY(!1):this.$qb.ZY(!1)}nnf(ba){let cb;cb=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?hb.a.isLetter(ba):hb.a.vrd(ba);return 48<=ba&&57>=ba||46===ba||95===ba||cb}show(){if(this.Ar){var ba=this.Ug.ojg(0);this.Zk?
0<this.Ug.vp.length?(this.formulaAssistanceTelemetryManager.Udf(this.Ug.Trb),ba||this.r9f()):this.H2a():((ba=0<this.Ug.vp.length)&&this.formulaAssistanceTelemetryManager.mA(["autoCompleteRender"]),!this.qe&&this.columnName&&ba&&this.Ug.$aj(this.Ug.vp.length,this.columnName),this.qe=ba,this.Hja.show(this.uQ),this.ECa(!0),this.Ug.Xya(),ba&&this.formulaAssistanceTelemetryManager.Bw(["autoCompleteRender"]))}}X3i(ba,cb,Kb,lc,Qc){for(Kb=Object(oa.a)(new Re,{oKf:41,gEe:40,zta:Kb,Ata:lc,mia:Qc});cb<ba.length&&
!this.qLf(ba,cb,Kb);++cb);return Kb.zHb}W3i(ba,cb,Kb){for(--cb;0<=cb&&!this.qLf(ba,cb,Kb);--cb);return Kb.zHb}qLf(ba,cb,Kb){const lc=ba.charCodeAt(cb);0>=this.f4&&(this.f4=ba.substring(0,cb).lastIndexOf(hc.a.JU));46===lc&&(cb<this.f4?this.f4=cb:cb>this.Wtb&&(this.xZ=this.Wtb=cb));if(!this.nnf(lc)&&!Qd.twi(lc)&&(!this.Qka||cb<=this.f4||!Qd.zei(lc,Kb))){Kb.hBf&&(Kb.hBf=!1,this.q4a=cb+1);if(Kb.fEd){Kb.DFd=cb+1;if(this.functionInfoManager.Sgd(ba.substring(Kb.DFd,Kb.CFd)))return!0;Kb.fEd=!1}switch(lc){case 39:Kb.Ata=
!Kb.Ata;break;case 34:Kb.zta=!Kb.zta;break;case 91:Kb.mia=!1;break;case 93:Kb.mia=!0}lc===this.$.listSeparator.toString().charCodeAt(0)&&Kb.Ata&&Kb.zta&&!Kb.f1a&&(!this.Qka||Kb.mia)&&(cb<Kb.kQd||-1===Kb.kQd)&&(Kb.zHb+=1,this.$6b++);lc===Kb.gEe&&Kb.zta&&Kb.Ata&&(!this.Qka||Kb.mia)?Kb.f1a+=1:lc===Kb.oKf&&Kb.zta&&Kb.Ata&&(!this.Qka||Kb.mia)?0<Kb.f1a?--Kb.f1a:(Kb.kQd=Kb.lYe,Kb.lYe=cb,0<cb&&this.nnf(ba.charCodeAt(cb-1))&&(Kb.fEd=!0,Kb.CFd=cb)):this.Qka&&46===lc&&cb>this.f4&&(cb<this.f4?this.f4=cb:cb>this.Wtb&&
(this.xZ=this.Wtb=cb))}return!1}eHh(ba,cb,Kb,lc,Qc){this.xbc>this.q4a&&0<=this.q4a?cb||Kb||(this.QV=ba.substring(this.q4a,this.xbc)):this.QV=null;lc!==Qc?(ba=ba.substring(Qc,lc),this.uQ&&hb.a.equals(this.uQ.NameDataStrings,ba,!0)||(this.Bzc=!0),this.uQ=this.functionInfoManager.Sgd(ba)):(this.Bzc=!1,this.uQ=null)}Gbg(ba){const cb=$get(n.kLf+"_"+n.yHb,this.domElement),Kb=$get(n.lLf+"_"+n.yHb,this.domElement);ba&&!this.xfc?(cb&&Sa.a.instance.ta(U.a.click,cb,this.ada),Kb&&Sa.a.instance.ta(U.a.click,Kb,
this.ada),this.xfc=!0):this.xfc&&(cb&&Sa.a.instance.Ba(U.a.click,cb,this.ada),Kb&&Sa.a.instance.Ba(U.a.click,Kb,this.ada),this.xfc=!1)}gWj(ba){let cb;cb=null;var Kb;if(({sheetName:lc,range:Kb}=za.Z(ba,this.$.ea.xa)).returnValue&&Kb){if(!lc){var lc=Object(Lb.a)(Ge.a,this.$.na);if(!lc)return{returnValue:!1,sheetRange:cb};lc=lc.name}cb=za.v(Kb,this.$);cb.SheetName=lc;this.l8c=!1;return{returnValue:!0,sheetRange:cb}}return({sheetName:lc,range:Kb}=this.O7b.QVj(ba)).returnValue?(cb=za.v(Kb,this.$),cb.SheetName=
lc,this.l8c=!0,{returnValue:!0,sheetRange:cb}):{returnValue:!1,sheetRange:cb}}qPd(ba){ba={content:ba,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Vba?this.pluginScheduler.getRequester().runAuthoringExperiment(ba,0):this.pluginScheduler.requester().runAuthoringExperiment(ba)}rnd(){if(1===this.Ug.vW.length&&this.Ar.length){var ba=this.Ar[this.Ug.vW[0]];if(1===ba.itemType){var cb=ba.name;ba=this.Za.text;cb=cb.substring(ba.length,cb.length);cb.length&&(this.Za.text=ba+
cb,this.Za.textBox.selectRange(ba.length,this.Za.text.length))}}else v.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Ug.vW.length})`)}Zlc(ba,cb,Kb,lc){const Qc={};Qc.a=ba;Qc.b=cb;Qc.c=Kb;Qc.d=lc;Ob.b().Pe(38,Qc,!0)}Dwe(ba,cb){if(!this.functionInfoManager.GV){if(ba)if(this.bGd(this.Za.text,this.Za.textBox.caretPosition),this.OTa||this.QV){const Kb={};Kb.Filter=this.QV?this.QV.charAt(0).toString():"";Kb.FilterType=1;Kb.IncludeOneOfEachGroupUI=
!1;this.functionInfoManager.VJa(Kb)}else qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!cb)return}0<this.$.rb.KR||this.Za&&!this.Za.eb?this.set_visible(!1):ba&&(this.bGd(this.Za.text,this.Za.textBox.caretPosition),this.Hja.update(this.uQ,this.$6b,this.MSc,this.Bzc),this.Y5=this.Za.text.substring(1,this.Za.textBox.caretPosition),this.f4=this.Y5.indexOf(hc.a.JU),this.xZ=this.Y5.lastIndexOf(hc.a.JU),this.Y3i()?
(ba=new Ea,ba.nAj(),this.uHa=this.O8=ba=[ba],this.Ug.Q_j(ba),this.show()):((this.IFh()||this.Kxa())&&this.JHe(!1),0<this.xZ?this.Ug.wKa(this.Ar,this.Y5,!1,void 0,this.Y5.lastIndexOf(hc.a.JU),!1):this.Ug.wKa(this.Ar,this.QV,!1,void 0,this.xZ,!1),this.show(),this.Zk&&(this.Ug.vp.length||this.gridView.zi.oL?this.Hja.Jtb():(this.Hja.INd(),this.Zk&&this.H2a()))))}r9f(){if(0<this.Ug.vp.length){this.formulaAssistanceTelemetryManager.mA(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const ba=
{};ba.zoomLevel=S(this.$);this.formulaAssistanceUIControl.updateContext(ba);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.$1b,this.gridView.zi.textBox.domElement,this.Occ(),()=>{})};this.Ro();this.Zk&&this.Ug.ckc&&this.raiseEvent(Qd.$dd,null);this.lpd||this.Ug.ckc||this.raiseEvent("FormulaAutoCompleteShown");this.lpd=this.Rq.Ff=!0}this.formulaAssistanceTelemetryManager.Bw(["autoCompleteRender"]);qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?
!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.f8&&null!==this.f8&&0<this.f8.length?(this.bC||this.formulaAssistanceTelemetryManager.mA(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.bC=!0):this.bC&&this.rkf&&(this.uaa=!0):!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.f8&&null!==this.f8&&0<this.f8.length&&(this.bC=!0)}}Bwd(){this.zJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByArrowKeyCounter++,
this.zJa=!1);this.AJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByMouseHoverCounter++,this.AJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByTabKeyCounter++,this.yJa=!1);this.wJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByEnterKeyCounter++,this.wJa=!1);this.xJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByMouseClickCounter++,this.xJa=!1);qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Qia&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionExplicitlyCounter++,
this.Qia=!1)}Occ(){const ba=new ld;ba.completionItems=this.Ug.Trb;ba.activeItemIndex=this.Ug.Nj?this.Ug.Nj.rowIndex:-1;this.fLd(ba);return ba}fLd(ba){ba.callbacks=new Oc;ba.callbacks.onCompletionItemSelected=this.OCd;ba.callbacks.onCompletionItemCommitted=this.NCd;ba.callbacks.onFeedback=this.ASa;ba.callbacks.onDismiss=this.onDismiss;ba.callbacks.onRestoreFocus=this.onRestoreFocus}KHd(ba){this.bga=!0;const cb=ba.textEdit.newText;this.Za.Reb(cb.substring(this.Za.text.length-ba.textEdit.range.start.character,
cb.length))}tFe(){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceTelemetryManager.Bw(["autoCompleteSmartSuggestionAccepted"]);this.mz(!0);this.bga=this.qe=!1;this.PTa=this.Eoa=!0}Cod(ba,cb){this.Za.text=ba.substring(0,cb.range.start.character)+cb.newText+ba.substring(cb.range.end.character,ba.length);this.gridView.Vl&&(this.gridView.Vb.text=this.Za.text)}static vPd(ba){qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?
ba.getRequester().runExperiment(new Cd,0):ba.requester().runExperiment(new Cd)}static t$g(ba){const cb=Ea.ahh(),Kb={IsCompatibility:!1};Kb.NameDataStrings=ba.label;Kb.Help=ba.detail;cb.$3f(Kb);cb.textEdit=ba.textEdit;return cb}static TKa(){const ba=String.format(n.QLh,n.ted,Qa.a.jSe),cb=String.format(n.LLh,n.qed,Bc.a.k$b,t.a.rp,t.a.hq),Kb=String.format(n.JLh,n.med,Bc.a.k$b,t.a.rp,Bc.a.dTe,t.a.hq);return`${ba}
${cb}
${Kb}`}static twi(ba){return 36===ba||58===ba||33===ba||39===ba||32===ba}static zei(ba,cb){return 32===ba||91===ba||!cb.mia}}Qd.$dd="FACardOpened";Qd.Add="FAFocusOnSmartSuggestionsCard";Qd.bgc=null;Object(d.a)(Qd,"FormulaAssistanceControl",ub.a,[530,521,2,531,532]);class re{constructor(ba){this.Bt=ba;this.zB=this.jTa=this.Ni=!1;this.onKeyDown=cb=>this.zB||"Space"!==cb.code&&" "!==cb.key||!cb.altKey||!cb.ctrlKey?!1:(this.j3a(),cb.stopPropagation(),cb.preventDefault(),!0);this.Kla=cb=>{if(!this.zB)return!1;
if(cb.eventName===U.a.Ob){const Kb=cb.Ca.ctrlKey?1:cb.Ca.shiftKey?50:10;switch(cb.Ca.keyCode){case Gd.a.SCa:this.$K(0,-Kb);break;case Gd.a.hfa:this.$K(0,Kb);break;case Gd.a.ifa:this.$K(-Kb,0);break;case Gd.a.mVa:this.$K(Kb,0);break;case Gd.a.kJ:case Gd.a.Sh:this.jTa=!0;break;default:return!1}}cb.eventName===U.a.Dd&&this.jTa&&this.bN(!0);cb.Ca.preventDefault();return!0};this.Zza=cb=>{if(!this.zB)return!1;cb.Ca.preventDefault();this.bN();return!0};this.onBlur=()=>{if(!this.zB)return!1;this.bN();return!0};
this.Go=Wd.KeyInputManager.instance;this.pointerInputManager=De.a.instance}ka(ba){(this.root=ba)&&!this.Ni&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ni=!0)}detach(){this.root&&this.Ni&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ni=!1)}j3a(){this.root&&(this.Bt.OGb("move",!0),this.root.focus(),this.zB=!0,this.jTa=!1,this.Ps(),this.Zya||this.Gsb(),this.root.appendChild(this.Zya))}bN(ba=!1){this.zB&&(this.zB=!1,this.Bt.lpc(ba),this.MJb(),this.AJb())}Ps(){this.Go.capture(this.Kla,
null);this.pointerInputManager.Ns(U.a.pointerDown,this.root,this.Zza,!0);this.root.addEventListener("blur",this.onBlur)}AJb(){this.Go.releaseCapture();this.pointerInputManager.Ws(U.a.pointerDown,this.root,this.Zza,!0);this.root.removeEventListener("blur",this.onBlur)}MJb(){var ba;null===(ba=this.Zya)||void 0===ba?void 0:ba.remove()}$K(ba,cb){const Kb=this.Bt.getPosition();Kb.x+=ba;Kb.y+=cb;this.Bt.setPosition(Kb)}Gsb(){this.Zya=Dd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(d.a)(re,"FormulaAssistanceMoveAdapter",null,[]);class Ie{constructor(ba){this.Bt=ba;this.startOffset={x:0,y:0};this.kag=!0;this.Ni=!1}p5(){return this.Ni&&!!this.vD}uza(ba){this.vD.style.cursor="grabbing";const cb=this.Bt.getPosition();this.kag=cb.renderDown;this.startOffset.x=cb.x-ba.clientPoint.x;this.startOffset.y=cb.y-ba.clientPoint.y;this.Bt.OGb("drag");return!0}Zca(ba){this.Bt.setPosition({x:ba.clientPoint.x+this.startOffset.x,y:ba.clientPoint.y+this.startOffset.y,renderDown:this.kag});
return!0}Yca(){this.Aw()}Xca(){this.Aw()}ka(ba,cb){this.vD=cb;this.root=ba;this.vD&&(this.vD.style.cursor="grab",we.a.instance.KW(this.vD,this,!1),this.Ni=!0)}detach(){this.Ni&&this.vD&&(this.vD.style.cursor="",we.a.instance.t1(this.vD,this),this.Ni=!1)}Aw(){this.vD.style.cursor="grab"}}Object(d.a)(Ie,"FormulaAssistanceDragAdapter",null,[618]);class qf{constructor(ba){this.formulaAssistanceTelemetryManager=ba;this.Ni=!1;this.WL={[Pe.Drag]:0,[Pe.Move]:0};this.IEb=new re(this);this.Ytb=new Ie(this)}get getPosition(){return this.rxg}get setPosition(){return this.Dke}ka(ba,
cb,Kb,lc){this.rxg=Kb;this.Dke=lc;this.IEb.ka(ba);this.Ytb.ka(ba,cb);this.Ni=!0}detach(){this.Ni&&(this.Ytb.detach(),this.IEb.detach(),this.Ni=!1)}clear(){var ba;null===(ba=this.Dke)||void 0===ba?void 0:ba.call(this,null);this.detach();this.HKb()}OGb(ba,cb=!1){this.WL[ba]++;cb&&(this.JQa=document.activeElement)}lpc(ba=!0){this.JQa&&(ba&&this.JQa.focus(),this.JQa=null)}HKb(){const ba=this.formulaAssistanceTelemetryManager.SP,cb=this.WL[Pe.Drag],Kb=this.WL[Pe.Move];0<cb&&(ba.argumentAssistanceDragCounter+=
1,ba.argumentAssistanceDragTotalCounter+=cb,this.WL[Pe.Drag]=0);0<Kb&&(ba.argumentAssistanceMoveCounter+=1,ba.argumentAssistanceMoveTotalCounter+=Kb,this.WL[Pe.Move]=0)}}Object(d.a)(qf,"FormulaAssistanceDragControl",null,[]);var Pe;(function(ba){ba.Drag="drag";ba.Move="move"})(Pe||(Pe={}));Object(d.b)("FormulaAssistanceDragMode",Pe);class of extends Db.a{constructor(ba,cb,Kb){super(of.TKa());this.$=ba;this.formulaAssistanceUIControl=cb;this.formulaAssistanceTelemetryManager=Kb;this.showCollapseText=
this.isExpanded=!0;this.KY=0;this.Qla=this.Ro=this.Rq=null;this.JK=this.jv=!1;this.setPosition=lc=>{this.formulaAssistanceUIControl.setFixedPosition(lc);this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Pc=()=>{this.visible=!1};this.onCardModeChange=lc=>{this.gQb(lc);this.showCollapseText=!1;1===lc?this.formulaAssistanceTelemetryManager.SP.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.SP.argumentAssistanceExpandCounter++};
this.onIsExpandedChange=lc=>{this.Hig(lc);this.showCollapseText=!1;const Qc=this.formulaAssistanceTelemetryManager.SP;lc?Qc.argumentAssistanceExpandCounter++:Qc.argumentAssistanceCollapseCounter++};this.ASa=lc=>J(this.$,"ArgumentAssistanceCard",lc.functionName);this.Tt=()=>{this.t_?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Ro&&null!==this.Ro&&this.Ro()};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.SP.argumentAssistanceDismissCounter++;this.dismiss();this.raiseEvent("DC");
this.t_?(this.JK&&this.Bt.clear(),this.isExpanded&&this.Hig(!1)):(this.JK&&this.$8b.clear(),0===this.KY&&this.gQb(1))};this.Nf=()=>{this.JK&&(this.t_?this.Bt.clear():this.$8b.clear())};this.t_=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.j5=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.cSd();this.Rq=new Pb(this.$,this.formulaAssistanceUIControl,0,fc.a.Sdd);this.grid=Object(I.h)(ba);this.grid.view.nt(this.Tt);
this.grid.ha.kH(this.Pc);if(this.JK=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1))this.t_?this.Bt=new qf(this.formulaAssistanceTelemetryManager):this.$8b=new Od(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),this.grid.fc.sm(this.Nf);qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Are(ba){this.addHandler("FAFunctionNameUpdated",
ba)}CVf(ba){this.removeHandler("FAFunctionNameUpdated",ba)}rse(ba){this.addHandler("FAParameterSelectionChangedOld",ba)}aWf(ba){this.removeHandler("FAParameterSelectionChangedOld",ba)}qse(ba){this.addHandler("FAParameterSelectionChanged",ba)}$Vf(ba){this.removeHandler("FAParameterSelectionChanged",ba)}uMg(ba){this.addHandler("DC",ba)}rjj(ba){this.removeHandler("DC",ba)}get visible(){return this.jv}set visible(ba){ba||this.dismiss();this.jv=ba}dismiss(){this.jv=!1;this.formulaAssistanceUIControl&&
(this.Ro=null,this.JK&&(this.t_?this.Bt.detach():this.$8b.detach()),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Qla=null,this.Rq.Ff=!1)}tKj(ba,cb){this.jv=!0;const Kb=this.Dsc(ba);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceRender"]);ba={};ba.zoomLevel=S(this.$);this.formulaAssistanceUIControl.updateContext(ba);const lc=()=>{};qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
cb,Kb,lc)},this.Ro()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,cb,Kb,lc);this.Xrc(Kb);this.JK&&this.$8b.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Ro,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Rq.Ff=!0;this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Wua("argumentAssistanceOverall")}}show(ba,cb){this.t_?this.uKj(ba):
this.tKj(ba,cb)}uKj(ba){this.jv=!0;const cb=this.Dsc(ba);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceRender"]);const Kb=()=>c(this.$);this.Ro=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,void 0,cb,Kb)};this.Ro();this.Xrc(cb);this.JK&&this.Bt.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.Rq.Ff=!0;this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceRender"]);
this.formulaAssistanceTelemetryManager.Wua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.mG(this.Pc),this.grid.view.ir(this.Tt),this.JK&&this.grid.fc.Il(this.Nf));ca.a.Ia(this.Rq);this.$=null}Dsc(ba){const cb=new Tc;cb.functionRenderingInfo=ba;cb.showCollapseText=this.showCollapseText;this.t_?cb.isExpanded=this.isExpanded:cb.cardMode=this.KY;this.kLd(cb);return cb}kLd(ba){ba.callbacks=new id;ba.callbacks.onHelpLink=this.$gd(ba.functionRenderingInfo);this.t_?
ba.callbacks.onIsExpandedChange=this.onIsExpandedChange:ba.callbacks.onCardModeChange=this.onCardModeChange;ba.callbacks.onFeedback=this.ASa;this.j5&&(ba.callbacks.onDismissClick=this.onDismissClick)}$gd(ba){return()=>{H(this.$,ba.helpID,ba.isUDF)}}cSd(){const ba=Ub.a.get(y.a.qpb);this.t_?(ba?(this.isExpanded="false"!==ba,this.showCollapseText=!1):(this.isExpanded=of.kkh,this.formulaAssistanceTelemetryManager.G2f()),this.formulaAssistanceTelemetryManager.Uwj(this.isExpanded)):(ba?(this.KY=parseInt(ba,
10),this.showCollapseText=!1):(this.KY=of.b8c,this.formulaAssistanceTelemetryManager.G2f()),this.formulaAssistanceTelemetryManager.H2f(this.KY))}Xrc(ba){var cb=ba.functionRenderingInfo.functionName;this.Qla&&hb.a.equals(this.Qla,cb,!0)?(cb=wc.a.map(ba.functionRenderingInfo.signatures,Kb=>{let lc="";0<=Kb.signatureParams.activeParam&&Kb.signatureParams.activeParam<Kb.signatureParams.params.length&&(lc=Kb.signatureParams.params[Kb.signatureParams.activeParam]);return lc}),this.raiseEvent("FAParameterSelectionChanged",
new Hc(cb))):(this.Qla=cb,ba=wc.a.map(ba.functionRenderingInfo.signatures,Kb=>Kb.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Ic(cb,ba)))}gQb(ba){this.KY=ba;try{Ub.a.Rv(y.a.qpb,ba.toString(),mb.AFrame.v8)}catch(cb){v.ULS.sendTraceTag(537162074,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${cb.message}`)}}Hig(ba){this.isExpanded=ba;try{Ub.a.Rv(y.a.qpb,ba.toString(),mb.AFrame.v8)}catch(cb){v.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${cb.message}`)}}static TKa(){return document.createElement("div")}}
of.b8c=0;of.kkh=!0;Object(d.a)(of,"FormulaArgumentAssistanceControl",Db.a,[590]);var Hb;(function(ba){ba[ba.Dismissed=0]="Dismissed";ba[ba.Smart=1]="Smart";ba[ba.Simple=2]="Simple";ba[ba.Mixed=3]="Mixed"})(Hb||(Hb={}));Object(d.b)("UIState",Hb);class mc extends Db.a{constructor(ba,cb,Kb){super(mc.TKa());this.$=ba;this.formulaAssistanceUIControl=cb;this.formulaAssistanceTelemetryManager=Kb;this.Rq=this.Za=this.gridView=null;this.uaa=this.Qia=this.xJa=this.wJa=this.yJa=this.AJa=this.zJa=!1;this.Ar=
null;this.dX=0;this.Ro=null;this.PTa=this.Eoa=this.bC=this.bga=this.jv=!1;this.XPb=Hb.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.jv=!1;this.K7a&&this.bC&&this.uNa&&(this.uaa=!0);this.Bwd();this.SF&&this.Za.eb&&this.zna();this.Ro=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Rq.Ff=!1,this.XPb=Hb.Dismissed)};this.xkd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.cda=(lc,Qc)=>{0==Qc.Mr&&(170==Qc.Qf.operation.operationName&&
this.formulaAssistanceTelemetryManager.wlc++,this.$.userOperationManager.mo(this.cda))};this.QPa=(lc,Qc)=>{0==Qc.Mr&&(12==Qc.Qf.operation.operationName&&this.$.userOperationManager.xr(this.cda),this.$.userOperationManager.mo(this.QPa))};this.RQi=()=>{this.dismiss();this.gridView.zi.textBox.focus()};this.ASa=()=>{const lc={};lc[y.a.GQ]=this.ZJf?"SmartSuggestionsCard":this.BWd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,lc)};this.Nf=()=>{qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",
!1)&&1===this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter&&this.bC&&this.$.Xc(1073817162,-1,0,null);this.uNa&&this.vQg()};this.OCd=(lc,Qc)=>{this.Kgb(Qc);this.AJa=!0};this.Pc=()=>{this.visible=!1};this.NCd=lc=>{this.xJa=!0;this.Orb(lc)};this.Eh=()=>{this.dismiss()};this.Tt=()=>{this.t_?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Ro&&null!==this.Ro&&this.Ro()};this.gridView=I.h(this.$);this.Rq=new Pb(this.$,this.formulaAssistanceUIControl,1,fc.a.Udd,this.xkd);
this.gridView.view.nt(this.Tt);this.gridView.ha.kH(this.Pc);this.$.xa.Uf(this.Eh);this.uNa=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.f$=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.t_=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.K7a=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");
this.uNa&&this.gridView.fc.sm(this.Nf);qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.Wqi=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}yre(ba){this.addHandler("FACardOpened",ba)}BVf(ba){this.removeHandler("FACardOpened",ba)}wre(ba){this.addHandler("FAFocusOnSmartSuggestionsCard",ba)}zVf(ba){this.removeHandler("FAFocusOnSmartSuggestionsCard",ba)}xre(ba){this.addHandler("FormulaAutoCompleteShown",
ba)}AVf(ba){this.removeHandler("FormulaAutoCompleteShown",ba)}KXc(ba){this.addHandler("SelectedRowChanged",ba)}HMd(ba){this.removeHandler("SelectedRowChanged",ba)}l0b(ba){this.addHandler("ListBoxUpdated",ba)}Zuc(ba){this.removeHandler("ListBoxUpdated",ba)}dispose(){this.$&&(this.f$&&(this.$.userOperationManager.mo(this.cda),this.$.userOperationManager.mo(this.QPa)),this.gridView&&(this.gridView.ha&&this.gridView.ha.mG(this.Pc),this.gridView.fc&&this.uNa&&this.gridView.fc.Il(this.Nf),this.gridView.view.ir(this.Tt)),
this.$.xa&&this.$.xa.Bg(this.Eh));ca.a.Ia(this.Rq);this.$=null}hMg(ba){this.addHandler("CVIC",ba)}djj(ba){this.removeHandler("CVIC",ba)}get visible(){return this.jv}set visible(ba){ba||this.dismiss();this.jv=ba}get SF(){return this.bga}get BWd(){var ba,cb;return 1===(null===(cb=null===(ba=this.Ar)||void 0===ba?void 0:ba.items[0])||void 0===cb?void 0:cb.type)}get ZJf(){return 1===this.Ar.items.length&&this.BWd}Xh(ba,cb){if(!this.visible)return!1;this.BDc(cb);let Kb;return(Kb=this.S$h(cb)).bfc?Kb.result:
this.kFj(cb)}eyb(ba){if(!this.visible)return!1;let cb=!1;switch(ba){case 1872288872:this.SF&&this.zna();this.K7a&&this.BWd&&(this.formulaAssistanceTelemetryManager.Bw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Qia=!0);this.visible=!1;cb=!0;break;case -798660877:this.Kgb(this.Kxb(this.dX+1));cb=!0;break;case 137938150:this.Kgb(this.Kxb(this.dX-1));cb=!0;break;case 2091832999:this.Kgb(this.Kxb(this.dX+8));cb=!0;break;case 742457698:this.Kgb(this.Kxb(this.dX-8));cb=!0;break;case 125627505:case 267796030:this.Orb(this.Ar.items[this.dX]),
cb=!0}return cb}show(ba){this.Za=this.gridView.zi;this.jv=!0;this.dX=0;this.Ar=ba;0<this.Ar.items.length&&(this.render(),this.Kgb(this.Kxb(this.dX)),this.K7a?this.uNa&&(1===this.Ar.items[0].type?(this.bC||this.formulaAssistanceTelemetryManager.mA(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.bC=!0):this.bC&&(this.uaa=!0)):1===this.Ar.items[0].type&&this.uNa&&(this.bC=!0));this.formulaAssistanceTelemetryManager.Udf(ba.items)}zna(){this.bga=!1;this.Za.aNe()}kFj(ba){return[1872288872,
-798660877,137938150,2091832999,742457698,125627505,267796030].includes(ba)}S$h(ba){return this.SF?125627505===ba||267796030===ba?(this.Orb(this.Ar.items[this.dX]),{bfc:!0,result:!1}):!this.ZJf||-798660877!==ba&&137938150!==ba?{bfc:!1}:{bfc:!0,result:!1}:{bfc:!1}}render(){this.formulaAssistanceTelemetryManager.mA(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.t_){const ba=()=>c(this.$);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,
this.Occ(),ba)}}else{const ba={};ba.zoomLevel=S(this.$);this.formulaAssistanceUIControl.updateContext(ba);this.Ro=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Za.textBox.domElement,this.Occ(),()=>{})}}this.Ro();this.Paj();this.Rq.Ff=!0;this.ush()}}ush(){this.formulaAssistanceTelemetryManager.Bw(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.Wua("autoCompleteOverall");const ba=this.Ar.items.some(Kb=>1===Kb.type),cb=this.Ar.items.some(Kb=>0===Kb.type);
ba&&cb?this.formulaAssistanceTelemetryManager.Wua("autoCompleteOverallSimpleAndSmart"):ba?this.formulaAssistanceTelemetryManager.Wua("autoCompleteOverallSmartOnly"):cb&&this.formulaAssistanceTelemetryManager.Wua("autoCompleteOverallSimpleOnly")}Paj(){const ba=this.XPb;this.XPb=this.s6h(this.Ar.items);ba!==Hb.Dismissed&&ba!==Hb.Smart||this.XPb!==Hb.Simple&&this.XPb!==Hb.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}ubj(){var ba;if(this.Wqi&&0!==this.Ar.items.length){var cb=0<=this.dX?this.dX:
0,Kb=this.Ar.items[cb];Kb={tG:Kb.label,description:null!==(ba=Kb.detail)&&void 0!==ba?ba:"",selectedIndex:cb+1,length:this.Ar.items.length};this.raiseEvent("SelectedRowChanged",Kb)}}Orb(ba){if(this.Za&&this.visible){var cb=ba.textEdit;this.Cod(this.Za.text,cb);this.Za.textBox.caretPosition=cb.range.start.character+cb.newText.length;this.SF&&(this.bga=!1,this.uNa&&(this.K7a&&this.formulaAssistanceTelemetryManager.Bw(["autoCompleteSmartSuggestionAccepted"]),this.PTa=this.Eoa=!0),this.f$&&this.Czj(),
this.gridView.Eaa.w2f(),this.Za.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:ba.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.Tdf(ba.kind)}}Czj(){this.formulaAssistanceTelemetryManager.mI={Ok:this.gridView.ha.ra.activeCell,brb:this.gridView.Vb.text,Qrb:!0};this.formulaAssistanceTelemetryManager.vlc=this.$.xa.na.sheetId;this.formulaAssistanceTelemetryManager.aDb=this.$.ea.ye;this.$.userOperationManager.xr(this.QPa)}vQg(){this.K7a&&
this.uaa&&!this.Qia&&!this.Eoa&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionImplicitlyCounter++,this.uaa=!1);this.bC&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.bC=!1);this.Eoa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,this.Eoa=!1);this.PTa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.PTa=!1)}Occ(){const ba=new ld;ba.completionItems=this.Ar.items;ba.activeItemIndex=this.dX;
this.fLd(ba);return ba}fLd(ba){ba.callbacks=new Oc;ba.callbacks.onCompletionItemSelected=this.OCd;ba.callbacks.onCompletionItemCommitted=this.NCd;ba.callbacks.onFeedback=this.ASa;ba.callbacks.onDismiss=this.RQi;ba.callbacks.onRestoreFocus=this.onRestoreFocus}KHd(ba){this.bga=!0;const cb=ba.textEdit.newText;this.Za.Reb(cb.substring(this.Za.text.length-ba.textEdit.range.start.character,cb.length))}Kgb(ba){const cb=this.dX;this.dX=ba;const Kb=this.Ar.items[ba];this.SF&&this.zna();cb!==ba&&this.render();
1===Kb.type&&qa.EwaSettings.xb()&&!this.gridView.zi.text.includes("\n")&&this.KHd(Kb);this.ubj()}Kxb(ba){return 0>ba?0:Math.min(ba,this.Ar.items.length-1)}Cod(ba,cb){this.Za.text=ba.substring(0,cb.range.start.character)+cb.newText+ba.substring(cb.range.end.character,ba.length);this.gridView.Vl&&(this.gridView.Vb.text=this.Za.text)}Bwd(){this.zJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByArrowKeyCounter++,this.zJa=!1);this.AJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByMouseHoverCounter++,
this.AJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByTabKeyCounter++,this.yJa=!1);this.wJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByEnterKeyCounter++,this.wJa=!1);this.xJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByMouseClickCounter++,this.xJa=!1);this.K7a&&this.Qia&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionExplicitlyCounter++,this.Qia=!1)}BDc(ba){switch(ba){case -798660877:case 137938150:case 2091832999:case 742457698:this.zJa=!0;break;
case 125627505:this.yJa=!0;break;case 267796030:this.wJa=!0}}static TKa(){return document.createElement("div")}s6h(ba){return ba.reduce((cb,Kb)=>cb|=0===Kb.type?Hb.Simple:Hb.Smart,Hb.Dismissed)}}Object(d.a)(mc,"FormulaAutoCompleteControl",Db.a,[589,2,531]);var Mc=a(725);class Rb{constructor(ba,cb){var Kb,lc;this.Sg=ba;this.$=cb;this.vza=()=>{this.jac.resolve(this.Sg.$k);this.wgg()};this.XCf=()=>{this.jac.reject(null);this.wgg()};this.Nf=()=>{this.Sg.bdb();this.$ud=null};null===(lc=null===(Kb=I.h(this.$))||
void 0===Kb?void 0:Kb.fc)||void 0===lc?void 0:lc.sm(this.Nf);this.MKj=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(ba,cb,Kb,lc){const Qc={P$:ba,VNe:cb};var Rc;if(Rc=Object(Mc.b)(this.$ud))Rc=this.$ud,Rc=!(Qc.P$.FirstRow===Rc.P$.FirstRow&&Qc.P$.FirstColumn===Rc.P$.FirstColumn&&Qc.P$.LastRow===Rc.P$.LastRow&&Qc.P$.LastColumn===Rc.P$.LastColumn&&Qc.P$.SheetName===Rc.P$.SheetName&&Qc.VNe===Rc.VNe);Rc&&this.Sg.bdb();this.$ud=
Qc;this.MKj&&this.Sg.w7a||this.Sg.SZ(ba,Kb,lc,cb);this.jac=new Mc.a;this.Sg.w7a?this.jac.resolve(this.Sg.$k):this.qfj();return this.jac.promise}dispose(){var ba,cb;null===(cb=null===(ba=I.h(this.$))||void 0===ba?void 0:ba.fc)||void 0===cb?void 0:cb.Il(this.Nf)}qfj(){this.Sg.c0b(this.vza);this.Sg.SMg(this.XCf)}wgg(){this.Sg.Ruc(this.vza);this.Sg.Kjj(this.XCf)}}Object(d.a)(Rb,"ServerDataProvider",null,[588]);var xc=a(322),ed=a(579),xd=a(343),yd=a(871);class Zd{constructor(ba){this.FK=this.GK=this.QF=
this.RF=!1;this.A_=ba}}Object(d.a)(Zd,"MarqueeRangeData",null,[]);class me{constructor(ba,cb,Kb,lc=!1){this.dZd=ba;this.gPb=cb;this.c8a=lc;Kb?(this.A_=Kb.A_,this.RF=Kb.RF,this.QF=Kb.QF,this.GK=Kb.GK,this.FK=Kb.FK):v.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(me,"MarqueeMetadata",null,[]);const wb="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class $b{constructor(ba,cb,Kb){this.$=ba;this.pluginScheduler=cb;this.formulaAssistanceTelemetryManager=Kb;this.enf=this.EK=this.vfb=!1;this.Tha=void 0;this.cS=null;this.rh=()=>{this.Tha=void 0};this.oza=()=>{this.EK=!1;this.Tha=void 0;this.cS=null};this.gridView=I.h(ba);this.gridView.Vb.sm(this.oza);this.enf=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094505_updateFormulaHighlightsTelemetry");this.Hsd=(this.D8a=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",
!1))&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7144730_FormulaHighlightsCaching")}get coloredReferencesManager(){this.kWa||(this.kWa=this.$.da.za(281));return this.kWa}DWj(ba,cb,Kb){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.mgb(ba,cb,Kb)}mgb(ba,cb,Kb){var lc;this.enf&&ba.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.vfb||ba.SF)return!1;const Qc=isNullOrUndefined(cb)?ba.text:cb;if(1>=Qc.length)return this.$ig(ba,
Qc,Object(Mc.b)(cb));Kb=this.D6h(ba,cb,Kb);if(this.D8a&&!this.Hsd&&this.HGj(ba,{content:Qc,selection:Kb}))return!0;Kb=null===(lc=this.e5a(Qc,Kb))||void 0===lc?void 0:lc.formulaHighlights;if(!Kb)return v.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.$ig(ba,Qc,Object(Mc.b)(cb));const {bRj:Rc,$bj:zd,Ybj:ae,DGi:ze}=this.yXh(Kb,Qc);this.Myc(ba,Rc,!!cb);cb=ba.textBox.text;if(!hb.a.equals(cb,Qc,!1))return v.ULS.shipAssertTag(38114182,
0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${cb.length}], updatedTextLength [${Qc.length}]`),cb=ba.textBox.caretPosition,ba.textBox.text=Qc,ba.textBox.caretPosition=cb,!0;this.Fz(zd,ae,ze);return this.EK=!0}KEb(ba,cb,Kb){if(!ba||!cb||!Kb)return v.ULS.shipAssertTag(512349463,0,!!ba,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),v.ULS.shipAssertTag(512349462,
0,!!cb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),v.ULS.shipAssertTag(512349461,0,!!Kb,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const lc=Object(Lb.a)(me,cb.metadata);if(!lc)return v.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Qc=lc.dZd,Rc=lc.gPb,zd=this.gridView.Bb.sqd(Kb)?Kb.Nwb(lc.QF,lc.RF):Kb.BLa(lc.QF,lc.RF,lc.FK,lc.GK);if(!zd)return v.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),
!1;const ae=Rc.indexOf("!");-1!==ae&&(zd=Rc.substring(0,ae+1)+zd);if(!ba.textBox.changeTextInExistingTextPart(Qc,Rc,zd))return v.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;lc.gPb=zd;Qc=!0;for(Rc=1;4>=Rc;Rc++)(zd=I.h(this.$).qb.Dv(3,Rc,cb.mU))?(zd.range=Kb,zd.metadata=lc):(v.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Qc=!1);this.gridView.qb.update(!1,!1);this.gridView.Vl&&
(this.gridView.fc.textBox.text=ba.text);this.gridView.fc.PQa(new xc.a({xAb:!0}));return Qc}dri(ba){if(3!==ba.Uq)return v.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;ba=Object(Lb.a)(me,ba.metadata);return ba?ba.A_&&!ba.c8a:(v.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}YBa(ba,cb){v.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+
(cb?"suspending":"resuming")+" colored references");cb&&this.EK&&(this.EK=!1,this.Fz(null,null),ba.textBox.gDe());this.vfb=cb}dispose(){var ba;this.gridView&&this.gridView.Vb&&this.gridView.Vb.Il(this.oza);(null===(ba=this.gridView)||void 0===ba?0:ba.fc)&&this.gridView.fc.Fk(this.rh);this.Tha=void 0}$yb(ba){this.formulaAssistanceTelemetryManager.mA(["highlightPreviewRanges"]);var cb=this.e5a(ba,yd.a);if(isNullOrUndefined(cb))this.ela&&this.Fz(null,null);else{var Kb=this.kka(),lc=[],Qc=new Kc.a(!1),
Rc=[];cb=cb.formulaHighlights;for(const zd of cb)if(cb=zd.kind,0===cb||2===cb||1===cb)cb=za.B(zd.rangeInfo.sharedRange),Object(Mc.b)(cb)&&(lc.push(new xd.a(cb,Kb)),this.QZ(cb,Qc,1),Rc.push(new me(zd.span.start,ba.substring(zd.span.start,zd.span.end),e(zd),!0)));this.Fz(lc,Qc,Rc);this.formulaAssistanceTelemetryManager.Bw(["highlightPreviewRanges"],!0)}}A_j(ba,cb){ba&&this.formulaAssistanceTelemetryManager.pbc.formulaHighlightsCounter++;cb&&this.formulaAssistanceTelemetryManager.pbc.parenthesesCouplingCounter++}$ig(ba,
cb,Kb){this.Fz(null,null);this.Tha=void 0;if(this.EK){this.EK=!1;const lc=ba.textBox.caretPosition;ba.textBox.setPlainText(cb);ba.textBox.caretPosition=Math.min(lc,cb.length);if(Kb)return!0}return!1}HGj(ba,cb){var Kb,lc,Qc,Rc;const zd=(null===(Kb=this.Tha)||void 0===Kb?void 0:Kb.$M)===ba&&(null===(lc=this.Tha)||void 0===lc?void 0:lc.O9c.content)===cb.content&&(null===(Qc=this.Tha)||void 0===Qc?void 0:Qc.O9c.selection.index)===cb.selection.index&&(null===(Rc=this.Tha)||void 0===Rc?void 0:Rc.O9c.selection.length)===
cb.selection.length;zd||(this.Tha={O9c:cb,$M:ba});return zd}D6h(ba,cb,Kb){let lc=Kb;Object(Mc.b)(cb)?Object(Mc.b)(Kb)||(lc={index:cb.length,length:0}):lc=ba.textBox.selection;return lc}e5a(ba,cb){if(this.Hsd&&this.nti({content:ba,selection:cb}))return this.cS.result;this.formulaAssistanceTelemetryManager.mA(["formulaHighlightsRequest"]);const Kb=this.pluginScheduler.syncRequester().formulaHighlighting({content:ba,caretPosition:cb.index,selectionLength:cb.length});this.Hsd&&(this.cS={content:ba,selection:cb,
result:Kb});this.formulaAssistanceTelemetryManager.Bw(["formulaHighlightsRequest"]);return Kb}QZ(ba,cb,Kb){let lc=cb.getItem(ba.toString());lc||(lc=wb[cb.count%wb.length],cb.add(ba.toString(),lc));return String.format(lc,Kb)}ME(ba,cb,Kb,lc,Qc=null,Rc=null){v.ULS.shipAssertTag(512349453,0,Kb<=lc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");Kb<lc&&(cb=cb.substring(Kb,lc),ba.push(Object(oa.a)(new ed.a,{text:cb,color:Qc,backgroundColor:Rc})))}Fz(ba,cb,Kb=null){ba&&
ba.length?(v.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+ba.length),ba.reverse(),Kb.reverse(),this.gridView.qb.nx(ba,[3],!0,(lc,Qc)=>{if(lc&&lc.range&&Qc){v.ULS.shipAssertTag(512349448,0,cb.lb(lc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${lc.range.toString()}' doesn't exist in the range to color dictionary`);var Rc=this.QZ(lc.range,cb,.1),zd=this.QZ(lc.range,cb,1);this.$.frame&&this.$.frame.yD&&this.$.frame.yD.CN||
(Qc.style.background=Rc);Qc.style.borderColor=zd;Kb&&(Qc.setAttribute(y.a.H6a,lc.mU.toString()),lc.metadata=Kb[lc.mU])}else v.ULS.shipAssertTag(512349451,0,!!lc,"FormulaHighlightsControl.HighlightRanges: state is null"),v.ULS.shipAssertTag(512349450,0,!!lc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),v.ULS.shipAssertTag(512349449,0,!!Qc,"FormulaHighlightsControl.HighlightRanges: div is null")})):(ba=this.$.Jb.Ac("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Wg([3]),
this.gridView.qb.SSa(new xd.a(null,this.kka()),[3]),ba.stop())}Myc(ba,cb,Kb){const lc=ba.textBox;lc.LF=!0;var Qc=lc.selection;const Rc=Qc.index;Qc=Rc+Qc.length;lc.setTextFromTextParts(cb);cb=lc.text.length;lc.selectRange(Math.min(Rc,cb),Math.min(Qc,cb));Kb&&ba.PQa(new xc.a);lc.LF=!1}wdc(){return this.gridView.fr&&this.gridView.fr.gG?this.gridView.fr.gG:this.$.na}kka(){return this.wdc().sheetId}yXh(ba,cb){const Kb=[],lc=new Kc.a(!1),Qc=[],Rc=[],zd=[];let ae=!1;var ze=!1;let Be=0;const xe=this.kka();
for(const Ce of ba){this.ME(Qc,cb,Be,Ce.span.start,null);switch(Ce.kind){case 0:case 1:case 2:ba=za.B(Ce.rangeInfo.sharedRange);if(isNullOrUndefined(ba)){v.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${Ce.kind.toString()}`);this.ME(Qc,cb,Ce.span.start,Ce.span.end,null);break}ze=this.QZ(ba,lc,1);this.ME(Qc,cb,Ce.span.start,Ce.span.end,ze);Kb.push(new xd.a(ba,xe));Rc.push({Start:Ce.span.start,End:Ce.span.end});
ze=Qc.length-1;zd.push(new me(ze,Qc[ze].text,e(Ce)));ze=!0;break;case 3:this.ME(Qc,cb,Ce.span.start,Ce.span.end,null,"rgba(229, 229, 229, 1)"),ae=!0}Be=Ce.span.end}this.ME(Qc,cb,Be,cb.length);this.A_j(ze,ae);return{bRj:Qc,$bj:Kb,Ybj:lc,DGi:zd}}nti(ba){return Object(Mc.b)(this.cS)&&this.cS.content===ba.content&&this.cS.selection.index===ba.selection.index&&this.cS.selection.length===ba.selection.length}}Object(d.a)($b,"FormulaHighlightsControl",null,[587,2]);class uc{constructor(ba,cb,Kb,lc,Qc,Rc,
zd){this.$=ba;this.functionInfoManager=cb;this.calcManager=Kb;this.pluginScheduler=lc;this.formulaAssistanceUIControl=Qc;this.formulaAssistanceTelemetryManager=Rc;this.Sg=zd;this.lTa=!0;this.gNa=this.isCellContentOnlyEqualDuringEdit=!1;this.g6=null;this.rca=-1;this.oW=0;this.Vba=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.hBb=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.hdd=qa.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.pEc=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.Ph=(ae,ze)=>{this.gridView.eb||this.gridView.ri||this.sPa(null===ze||void 0===ze?void 0:ze.cell)};this.rh=(ae,ze)=>{this.sPa(null===ze||void 0===ze?void 0:ze.Gja)};this.onFunctionInfoLoaded=()=>{this.hdd||this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);this.ljg();this.Vda()};this.qzf=()=>{this.lTa=!1};this.yzf=(ae,ze)=>{var Be=this.Za;ae=Be.text;Be=Be.textBox.caretPosition;0<this.oW&&
this.formulaAssistanceTelemetryManager.OJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.mA(["argumentAssistanceComputation","argumentAssistanceOverall"]);ze.shouldRequestAutocompleteOnCommit?this.F1f(ae,Be):this.INd(ae,Be)};this.Nf=()=>{this.S2&&(this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1),this.gNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,
this.gNa=!1));this.lTa=!0;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.w8b()};this.L6=(ae,ze)=>{this.qPd(ze.newValue)};this.Gj=()=>{this.eig()};this.eig=()=>{const ae=this.O7b.ELe;this.pluginScheduler.notifier().setDefinedNamesInfo(ae);v.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===ae||void 0===ae?void 0:ae.length} names}`)};this.e5a=(ae,ze)=>{ae=this.pluginScheduler.syncRequester().formulaHighlighting({content:ae,
caretPosition:null===ze||void 0===ze?void 0:ze.index,selectionLength:null===ze||void 0===ze?void 0:ze.length});if(isNullOrUndefined(ae)||isNullOrUndefined(ae.formulaHighlights))v.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(ae)}`);else return ae};this.functionInfoManager=cb;this.formulaAssistanceUIControl=Qc;this.pluginScheduler=lc;this.gridView=I.h(this.$);this.kkf=
qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.j5=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.qBd=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.S2=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.D_c=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.hpi=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");
this.kkf&&(this.O7b=new zb(ba),this.gridView.Ea.jw(this.Gj),this.eig());this.Lqa=new of(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.l9=new mc(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Fpi=va.a.hR(ba);this.GLj=va.a.Mpb(ba);this.gmi=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.Kui=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",
!1);this.Fpi&&(this.Mqa=new $b(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));ba.da.Ga(464,this);this.calcManager=Kb;va.a.EV(this.$)&&this.nod();this.S2&&this.gridView.fc.sm(this.Nf);this.j5&&(this.S2||this.gridView.fc.sm(this.Nf),this.Lqa.uMg(this.qzf));this.Upd=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.hdd&&(this.functionInfoManager.MGa(this.onFunctionInfoLoaded),this.functionInfoManager.GV?this.ljg():this.functionInfoManager.VJa({}))}get Jja(){return this.l9}get xZe(){return this.Lqa}get qB(){return this.Mqa}get nbb(){return this.Za.Jsi?
1:0}get Za(){return this.gridView.zi}get Bb(){return this.gridView.Bb}dispose(){if(this.$){const ba=this.gridView;ba&&(ba.ha&&va.a.EV(this.$)&&(this.hBb?ba.fc.Fk(this.rh):ba.ha.Ana(this.Ph)),this.kkf&&ba.Ea&&ba.Ea.ix(this.Gj))}this.S2&&this.gridView.fc.Il(this.Nf);this.j5&&(this.S2||this.gridView.fc.Il(this.Nf),this.Lqa.rjj(this.qzf));this.l9.djj(this.yzf);this.functionInfoManager&&this.functionInfoManager.Dcb(this.onFunctionInfoLoaded);va.a.thc&&this.Za&&this.Za.$Jb(this.L6);ca.a.Ia(this.Lqa);ca.a.Ia(this.l9);
this.l9=this.Lqa=this.functionInfoManager=this.$=null}foj(){this.rca=-1;this.g6=null}w8b(){this.l9.visible=!1;this.Lqa.visible=!1}Xh(){this.Vda();return!1}Vda(){if(!this.Za.oL)if(this.formulaAssistanceTelemetryManager.Tpb.formulaAssistanceRequestAttemptedCounter++,this.WFj()){this.hdd||this.functionInfoManager.GV||(this.functionInfoManager.MGa(this.onFunctionInfoLoaded),this.functionInfoManager.VJa({}));var ba=this.Za,cb=ba.text;ba=ba.textBox.caretPosition;this.S2&&cb.startsWith("=")&&(this.gNa=!0,
1===cb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.j5||this.lTa?(this.formulaAssistanceTelemetryManager.mA("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),this.F1f(cb,ba)):(this.formulaAssistanceTelemetryManager.mA(["autoCompleteComputation","autoCompleteOverall"]),this.Nnj(cb,ba));this.gmi&&this.Snj(cb,ba)}else this.formulaAssistanceTelemetryManager.Tpb.formulaAssistanceRequestOptimizedCounter++}F1f(ba,
cb){const Kb=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:ba,caretPosition:cb},argumentAssistance:{content:ba,caretPosition:cb}});this.oW+=1;this.pEc&&(this.g6=ba,this.rca=cb);Kb.then(lc=>{--this.oW;0===lc.kind&&(this.Q9e(lc.payload.argumentAssistance),this.v$e(lc.payload.functionSuggestion,ba));return null})}Nnj(ba,cb){const Kb={content:ba,caretPosition:cb};this.pEc&&(this.g6=ba,this.rca=cb);cb=this.Vba?this.pluginScheduler.getRequester().functionSuggestion(Kb,
this.nbb):this.pluginScheduler.requester().functionSuggestion(Kb);this.oW+=1;cb.then(lc=>{--this.oW;0===lc.kind&&this.v$e(lc.payload,ba);return null})}Snj(ba,cb){cb={content:ba,caretPosition:cb,enableAutocompleteWrapperPlugin:this.Kui&&!this.GLj};this.Vba&&(cb=this.pluginScheduler.getRequester().runPerCharacterExperiment(cb,this.nbb),this.oW+=1,cb.then(Kb=>{--this.oW;if(0===Kb.kind)for(const lc of Kb.payload.results)0===lc.kind&&this.gridView.Eaa.hSd(lc.value,ba);return null}))}INd(ba,cb){const Kb=
{content:ba,caretPosition:cb};this.pEc&&(this.g6=ba,this.rca=cb);ba=this.Vba?this.pluginScheduler.getRequester().argumentAssistance(Kb,this.nbb):this.pluginScheduler.requester().argumentAssistance(Kb);this.oW+=1;ba.then(lc=>{--this.oW;0===lc.kind&&this.Q9e(lc.payload)})}WFj(){var ba=this.Za;const cb=ba.text;ba=ba.textBox.caretPosition;if(this.l9.visible&&hb.a.equals(cb,this.g6,!0)&&(!this.hpi||!ya.e(cb))&&ba===this.rca)return!1;this.pEc||(this.g6=cb,this.rca=ba);return!0}vPd(){this.Vba?this.pluginScheduler.getRequester().runExperiment(new Cd,
this.nbb):this.pluginScheduler.requester().runExperiment(new Cd)}Q9e(ba){ba&&this.Za.eb?(this.formulaAssistanceTelemetryManager.Bw(["argumentAssistanceComputation"]),this.Lqa.show(ba,this.Za.textBox.domElement)):this.Lqa.dismiss()}v$e(ba,cb){ba&&0<ba.items.length&&this.Za.eb&&this.Za.text===this.g6?this.D_c&&this.Bb.J5(this.gridView.ha.ra.activeCell)?(this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++,this.l9.dismiss()):(this.formulaAssistanceTelemetryManager.Bw(["autoCompleteComputation"]),
this.l9.show(ba)):this.l9.dismiss();this.gridView.Eaa.hSd(ba,cb)}qPd(ba){ba={content:ba,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Vba?this.pluginScheduler.getRequester().runAuthoringExperiment(ba,this.nbb):this.pluginScheduler.requester().runAuthoringExperiment(ba)}sPa(ba){var cb;const Kb=this.gridView.ha.ra.activeCell;if(Kb){var lc=this.calcManager.Ota(Kb,!this.Upd);if(lc){var Qc=this.$.xa,Rc=lc.sheet.index;0>=Qc.count||0>Rc||Rc>=Qc.count?v.ULS.sendTraceTag(512278608,
0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Qc.count}, currentSheetIndex = ${Rc}.`):(Rc=Qc=null,this.qBd&&void 0!==this.calcManager&&null!==this.calcManager&&(ba=null!==(cb=null===ba||void 0===ba?void 0:ba.cell)&&void 0!==cb?cb:this.gridView.Ea.us(Kb))&&(cb=this.calcManager.rdc(ba.Ek),void 0!==cb&&null!==cb&&(Qc=cb.FormatString,Rc=cb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:lc.range.col,rowIndex:lc.range.row,sheetIndex:this.$.xa.getItem(lc.sheet.index).sheetId,
docName:lc.sheet.document.name,docPath:lc.sheet.document.path,formatString:Qc,builtIn:Rc}),v.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${lc.range.col}, row: ${lc.range.row}, format: ${Qc}`))}else v.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else v.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}ljg(){const ba=
this.functionInfoManager.wbc;this.pluginScheduler.notifier().setFunctionsInfo(ba);v.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===ba||void 0===ba?void 0:ba.length} functions}`)}nod(){this.hBb?this.gridView.fc.Xk(this.rh):this.gridView.ha.lha(this.Ph);const ba=va.a.Vzb()?this.gridView.Sb(null):void 0;this.sPa(ba);va.a.thc&&this.Za.IZa(this.L6);this.vPd();this.l9.hMg(this.yzf);this.pluginScheduler.setServerDataProvider(new Rb(this.Sg,
this.$));this.Vda()}mgb(ba,cb,Kb){Kb=Object(Mc.b)(cb)?this.e5a(cb,Object(Mc.b)(Kb)?Kb:yd.a):this.e5a(ba.text,ba.textBox.selection);return this.Mqa.DWj(ba,cb,Kb)}}Object(d.a)(uc,"FormulaAssistanceManager",null,[529,2]);a(184);class Pc extends Na.a{constructor(ba){super();this.$=ba;this.Fb()}create(){var ba=va.a.EV(this.$);const cb=qa.EwaSettings.ma(369),Kb=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),lc=va.a.DV(this.$),Qc=this.$.da,Rc=m.GetServiceTaskFactory.create(Qc,
134,this.la,this.Ya),zd=m.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya);let ae;ae=va.a.k5(this.$)?m.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):T.Task.Ta(null);let ze;ze=va.a.EV(this.$)?m.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):T.Task.Ta(null);let Be;Be=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&!lc?m.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya):T.Task.Ta(null);if(Kb||ba){const xe=m.GetServiceTaskFactory.Oa(Qc,266,265,this.Ya),
Ce=m.GetServiceTaskFactory.Oa(Qc,219,220,this.Ya),ef=m.GetServiceTaskFactory.Oa(Qc,491,492,this.Ya);ba=[xe,ze,ae,Ce,ef,Be];qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&ba.push(Rc,zd);l.TaskExtensions.Aa(l.TaskExtensions.Fd(ba,this.la),()=>{const Jf=Qc.za(19)||new oe(this.$,ze.result),Ia=Ce.result;if(lc){var Bb=Qc.za(464);Bb||(Bb=new uc(this.$,Jf,xe.result,ze.result,ae.result,ef.result,zd.result.O5c(this.$,Rc.result)),Ia.HZc(Bb.xZe),Ia.IZc(Bb.Jja),
qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Ia.JZc(Bb.Jja))}else Bb=Qc.za(221),Bb||(Bb=new Qd(this.$,Jf,Rc.result,xe.result,null,zd.result,ae.result,ef.result,ze.result,Be.result),Ia.HZc(Bb.yZe),Ia.JZc(Bb.TZe),Ia.IZc(Bb)),cb&&(Qc.za(317)||new Va(this.$));this.ob(Jf)},this.la,3)}else{const xe=m.GetServiceTaskFactory.Oa(Qc,219,220,this.Ya),Ce=m.GetServiceTaskFactory.Oa(Qc,491,492,this.Ya);l.TaskExtensions.Aa(l.TaskExtensions.Fd([xe,ae,ze,Be],this.la),()=>{const ef=
Qc.za(19)||new oe(this.$,ze.result),Jf=xe.result;let Ia=Qc.za(221);Ia||(Ia=new Qd(this.$,ef,Rc.result,null,null,zd.result,ae.result,Ce.result,ze.result,Be.result),Jf.HZc(Ia.yZe),Jf.JZc(Ia.TZe),Jf.IZc(Ia));cb&&(Qc.za(317)||new Va(this.$));this.ob(ef)},this.la,3)}}static ka(ba){ba.da.Ga(153,new Pc(ba))}}Object(d.a)(Pc,"FunctionInfoManagerFactory",Na.a,[]);a.d(D,"a",function(){return Ad});const Ad=()=>{f.a.Fa(ba=>{Fa.ka(ba);dc.ka(ba);Pc.ka(ba)})}},1138:function(u,D,a){var c=a(0),b=a(692),e=a(149),f=
a(7),d=a(15),h=a(83),m=a(4),l=a(157),v=a(1073),t=a(1071),z=a(716),r=a(5),n=a(463),w=a(560),B=a(76),A=a(58),y=a(905),x=a(132),F=a(42),I=a(188),L=a(60),X=a(50),P=a(749),G=a(142),C=a(37),H=a(116),J=a(208),M=a(91),S=a(71),W=a(35),O=a(29),T=a(282),Y=a(1),va=a(183),ca=a(13),V=a(62),ra=a(281),N=a(21),ea=a(133),Ba=a(771),ka=a(772),Ka=a(124),Oa=a(112),wa=a(51),qa=a(34),aa=a(422);class ia{constructor(){this.Sections=this.Id=null}}Object(c.a)(ia,"AutoFilterMenu",null,[]);class Ha{constructor(){this.Disabled=
!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(Ha,"MenuItem",null,[]);class Z{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(Z,"MenuSection",null,[]);class la{constructor(){this.isSuccess=!1}}Object(c.a)(la,"ApplyFilterByValueResponse",null,[]);class Xa{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;
this.indentationLevel=0;this.expanded=!1}}Object(c.a)(Xa,"FilterByValueItem",null,[]);class Za{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(Za,"GetColorsAndIconsResponse",null,[]);class xa{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(xa,"GetFilterByValueItemsResponse",null,[]);class fa{constructor(){this.autoFilterMenu=this.targetPoint=
null}}Object(c.a)(fa,"ShowSortFilterMenuParams",null,[]);class ua{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(ua,"SortFilterControllerFactoryParams",null,[]);class sa{constructor(){this.top=this.left=0}}Object(c.a)(sa,"TargetPoint",null,[]);var sb=a(55),hb=a(184),bb=a(33),lb=a(155),Fa=a(227),Na=a(8);const Mb=r.a.R9g;class dc extends z.a{constructor(wb,
$b,uc,Pc){super(wb,"PopulateAutoFilterContextMenu",1675506831,1651433993,Mb,!0,!1,"AutoFilterContextMenuRoot",$b,uc,!1,Pc);this.VYc=this.KUa=this.sheetName=this.Xsb=null;this.Q3a=this.Gqf=!1;this.X6c=this.abb=this.qKe=this.sQa=this.vdc=this.zbd=this.dfb=this.eIb=null;this.bW=()=>{this.BAc();this.$.ea.lo(this.bW)};this.YCf=Ad=>{this.Q3a||ea.b(this.$).Gd(x.a.ZCf,this.xm(),void 0,!0);var ba={};this.$.jk(ba);var cb=this.$.ea.isNamedObjectViewMode;const Kb=A.a.li(this.VYc);Kb.SheetName=cb?ba.NamedObjectName:
ba.SheetName;Kb.NamedObjectView=cb;ba=!!Ad.searchText;cb=586;this.Q3a&&(ba&&(Kb.ItemListOptions=this.Gbh(Ad.searchText),cb=597),ea.b(this.$).Gd(x.a.ZCf,{["UserOperation"]:cb.toString()},void 0,!0));const lc=this.sDd(ba),Qc=this.gTi(),Rc=this.$.pa.ya.Wb();this.qKe=Rc.RequestId;this.Q3a&&this.vdc&&!this.vdc.dequeueUtcTime&&(this.$.userOperationManager.tua(this.vdc),this.D1g());Ad=new I.a(cb,0,(zd,ae,ze)=>this.X6c=L.n(this.$.pa.ya,Kb,ra.b(zd,lc),this.Q3a?ra.a(ae,Qc):ae,ze,null,Rc),80);this.vdc=this.$.userOperationManager.Kc(Ad,
null);this.abb=this.X6c;this.sQa=this.qKe};this.onMenuItemClick=(Ad,ba,cb)=>{ea.b(this.$).Gd(x.a.fYi,this.xm(),void 0,!0);ba={["CommandValueId"]:ba,["MenuItemId"]:ba,["InputMethod"]:cb,["TopCellAddress"]:this.KUa};const Kb=new M.a(Ad,cb,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(Kb,ba);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${Ad}, ${cb}`)};this.focusShiftOnMenuDismiss=()=>{N.h(this.$).jX();const Ad=N.h(this.$).ha.ra.activeCell;N.h(this.$).pg(F.v(Ad,this.$),Ad,null,
null,3,"OnFilterMenuDismiss")};this.nzf=Ad=>{if(Ad.checkedItems&&Ad.checkedItems.length){ea.b(this.$).Gd(x.a.ozf,this.xm(),void 0,!0);var ba=A.a.li(this.VYc),cb={};this.$.jk(cb);cb.FirstRow=0;cb.FirstColumn=ba.Column;var Kb=this.$.ea.isNamedObjectViewMode;ba.NamedObjectView=Kb;ba.SheetName=Kb?cb.NamedObjectName:cb.SheetName;var lc=zd=>{if(Ba.a.Dzc(zd)){const ae=Ba.a.Ubc(zd);this.JNa?Ba.a.ERa(ka.a.applyItemFilter,ae.MessageIdName,Oa.a.vHa,!0,Ba.a.isSessionEndingError(ae.MessageId)):d.ULS.sendTraceTag(537167129,
0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${ae.MessageIdName}`)}T.a(zd)||(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ea.b(this.$).Gd(x.a.SCf,this.xm(),void 0,!0),zd=Object(f.a)(new la,{isSuccess:!0}),this.dfb.onApplyFilterByValueFinish(zd),this.GS(this.KUa))},Qc=this.B5c(ba,cb),Rc=new I.a(208,0,(zd,ae,ze)=>L.a(this.$.pa.ya,Qc,Ad.checkedItems,ra.b(zd,lc),ae,ze,null,null),6,()=>new y.a(Ad.checkedItems,
Qc));this.bJj(()=>{this.$.userOperationManager.Kc(Rc,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.Rve=Ad=>{const ba=F.o(this.KUa,this.$),cb=F.v(this.KUa,this.$);var Kb=Object(f.a)(new v.a,{SortConditionType:Ad.type,RowColOffset:ba.FirstColumn-cb.FirstColumn,SortColor:Ad.color,SortIconSet:Ad.icon.IconSet,SortIcon:Ad.icon.Icon,IsAscending:!0});Kb=Object(f.a)(new t.a,{OperationType:1,ActiveCell:ba,SelectedRange:cb,
SortConditions:[Kb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const lc={};lc.SortOptions=Kb;lc.SelectedRange=cb;lc.OriginalActiveCell=ba;lc.ShouldRestoreSelection=!1;lc.ShouldPromptNamedSheetViewTeachingDialog=!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${Ad.type}`);this.$.Xc(-1089513346,B.a.Db,19,{["CustomSortCommandData"]:lc})};this.JNa=Ba.a.mpd();this.Gz=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get ax(){return"PopulateAutoFilterContextMenu"}get UB(){return r.a.SQf}executeCommand(wb,
$b,uc){wb=$b.command;switch(wb){case 1701016594:return z.a.CEh(uc),sb.Task.Ta(!0);case 966232027:if(Y.EwaSettings.ol()){const Pc=new l.a;C.TaskExtensions.Aa(X.GetServiceTaskFactory.Oa(this.$.da,8,9,0),Ad=>{this.baf($b,uc,Ad.result);Pc.setResult(!0)},this.la,3).continueWith(()=>{Pc.setResult(!1)},5,this.la,Fa.a.instance);return Pc.task}this.baf($b,uc);return sb.Task.Ta(!0);default:return va.a(wb)}}baf(wb,$b,uc){const Pc=$b.domEvent;if(S.e(Pc.rawEvent)&&(S.g(Pc),Pc.target)){var Ad=new G.a(this.$.xa);
if(Ad.Td(4096)||Ad.Td(2048)){var ba=A.a.li($b[B.a.lg]);this.A7f(ba)&&(this.Gqf?this.tvc(Pc,Pc.target,ba,wb,uc):(this.eIb=()=>{this.A7f(ba)&&(this.Eii(),this.tvc(Pc,Pc.target,ba,wb,uc),this.Q3a=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.Gqf=!0)},this.BAc()))}}}wc(wb,$b,uc){if(wb=!!uc)switch($b.command){case 1701016594:case 966232027:Y.EwaSettings.ol()||n.a(this.$)||(wb=!1,$b=wa.b().uj($b.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${$b}`));
break;default:wb=!1}return wb}UGd(wb){wb.MenuSectionList.push(...this.Xsb)}Eii(){aa.a(()=>{Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7021231_FocusShiftOnAFMenuDismiss_Fix")?this.dfb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ua,{getFilterByValueItemsRequest:this.YCf,applyFilterByValueRequest:this.nzf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:dc.VZc,applySortByColorOrIconRequest:this.Rve})):
this.dfb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ua,{getFilterByValueItemsRequest:this.YCf,applyFilterByValueRequest:this.nzf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:dc.VZc,applySortByColorOrIconRequest:this.Rve}))});this.zbd=h.a.instance.Jh("Common.IExternalUICommandDefinitionMapping")||new w.a(this.$.Eb,this.$)}tvc(wb,$b,uc,Pc,Ad){ea.b(this.$).Gd(x.a.tvc,this.xm(),void 0,!0);if(uc){wb=this.OPh(uc,Ad);Pc=Sys.UI.DomElement.getBounds($b);
$b=Pc.x+Pc.width;Pc=Pc.y;if(this.Gz&&!uc.IsHeaderSnapped){if(!z.a.Spd(this.$,uc.Cell))return;uc=z.a.Lfd(this.$,uc.Cell,!0);$b=uc.x;Pc=uc.y}uc=N.h(this.$).rtl?new Sys.UI.Point($b-qa.a(this.$).cHa(dc.VZc),Pc):new Sys.UI.Point($b,Pc);uc=qa.a(this.$).nka(uc);uc=Object(f.a)(new fa,{targetPoint:Object(f.a)(new sa,{left:uc.x,top:uc.y}),autoFilterMenu:wb});this.dfb.showSortFilterMenu(uc);this.$.Xc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!uc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}A7f(wb){return(null===
wb||void 0===wb?0:wb.Cell.SheetName)?N.h(this.$).D5?wb.Cell.SheetName===this.$.na.name:wb.Cell.SheetName===this.$.na.sheetName:!0}OPh(wb,$b){return(wb=this.PPh(wb,$b))?this.JOf(wb):null}JOf(wb){const $b=[];for(const uc of wb.Sections){if(Object(lb.g)(this.$)&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&uc.Title===ca.a.instance.ga(1940))continue;const Pc=this.l9i(uc);$b.push(Pc)}return Object(f.a)(new ia,{Id:wb.Id,Sections:$b})}l9i(wb){const $b=[];for(const uc of wb.MenuItems)if(2===
uc.Identifier)this.VYc=uc.CommandData;else switch(uc.Type){case 3:case 2:$b.push(this.j9i(uc,2===uc.Type));break;case 1:$b.push(this.k9i(uc))}return Object(f.a)(new Z,{MenuItems:$b,DisplayType:wb.DisplayType,Id:this.kNh(wb)})}k9i(wb){({label:Ad,BMa:Pc}=this.A_e(wb));const $b=this.JOf(wb.SubMenu),uc=this.q_e(wb);var Pc=this.zbd.Jcc(Pc);var Ad=Ad||wb.Label;return Object(f.a)(new Ha,{Disabled:wb.Disabled,Type:wb.Type,Identifier:wb.Identifier,Id:uc,CommandData:wb.CommandData,Label:Ad,SubMenu:$b,IsChecked:wb.IsChecked,
IconName:"MissingIcon_20"===Pc?null:Pc})}j9i(wb,$b){let uc;({label:$b,BMa:Ad,Or:uc}=this.Dbc(wb,$b&&wb.IsChecked));const Pc=this.Fed(wb,$b);var Ad=this.zbd.Jcc(Ad);return Object(f.a)(new Ha,{Disabled:wb.Disabled,Type:wb.Type,Identifier:wb.Identifier,Id:Pc,RibbonCommand:uc,CommandData:wb.CommandData,Label:$b||wb.Label,SubMenu:null,IsChecked:wb.IsChecked,IconName:"MissingIcon_20"===Ad?null:Ad})}PPh(wb,$b){var uc;this.KUa=uc=F.C(wb.Cell);this.sheetName=this.$.na.sheetName;$b=$b||n.a(this.$);if(wb.IsHeaderSnapped)uc=
$b.tac.sXh(uc);else{$b=N.h(this.$).Ea.xLa(uc);if(!$b)return this.JNa?Ba.a.ERa(ka.a.UQf,Ka.a.N8h,Oa.a.Spb,!0,!1):(wb=N.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${uc}, visible range: ${wb}`)),null;uc=$b.autoFilterMenu}if(!uc)return this.JNa?Ba.a.ERa(ka.a.UQf,Ka.a.SHi,Oa.a.Spb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Otb=wb.Cell.FirstRow+"_"+wb.Cell.FirstColumn;return uc}BAc(){if(this.$.ea.qg){const wb=X.GetServiceTaskFactory.Oa(this.$.da,283,284,1);C.TaskExtensions.Aa(wb,()=>{this.JNa?wb.result.pn.loadScript("sortFilter").then(()=>{this.eIb()},$b=>{V.a.Uk($b,"AutoFilterContextMenu.SortFilterScriptLoad");Ba.a.ERa(ka.a.BAc,Ka.a.SLj,Oa.a.Spb,!1,!1)}):C.TaskExtensions.Aa(hb.c(wb.result.pn.loadScript("sortFilter")),()=>{this.eIb()},this.$.la,3)},this.$.la,3)}else this.$.ea.Kk(this.bW)}Gbh(wb){const $b={};
$b.SearchText=wb;$b.Page=1;$b.DateNodeType=-1;return $b}D1g(){this.sQa&&(d.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.sQa}`),L.h(this.$.pa.ya,this.sQa,null,null,null),this.sQa=null);this.abb&&(m.AFrameworkApplication.Bd.Tu(this.abb.nu),this.abb=null)}sDd(wb){return $b=>{this.abb=this.sQa=null;if(Ba.a.Dzc($b)){var uc=Ba.a.Ubc($b);this.JNa?Ba.a.ERa(wb?ka.a.searchAutoFilterItemList:ka.a.getAutoFilterItemList,
uc.MessageIdName,Oa.a.Spb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${uc.MessageIdName}`)}if(!T.a($b)){d.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");$b=$b.Result;uc=new W.a(!0);const Pc=$b.AutoFilterDateNodes?!0:!1;$b.AutoFilterItems&&uc.add("AutoFilterItemsCount",$b.AutoFilterItems.length);Pc&&uc.add("AutoFilterDateItemsCount",$b.AutoFilterDateNodes.length);
uc.add("Location","contextMenu");ea.b(this.$).Gd(x.a.sDd,uc.Gu,void 0,!0);uc=this.Q3a?Object(f.a)(new xa,{filterByValueItems:this.IGe($b),hasMoreRecords:$b.ItemListMaxExceeded,searchText:$b.SearchText}):Object(f.a)(new xa,{filterByValueItems:this.IGe($b),hasMoreRecords:$b.ItemListMaxExceeded});this.dfb.onGetFilterByValueItemsFinish(uc);wb||(d.ULS.shipAssertTag(529063959,0,null!==$b.FontColors&&null!==$b.CellColors&&null!==$b.Icons&&null!==$b.SelectedSortFontColors&&null!==$b.SelectedSortCellColors&&
null!==$b.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),$b=Object(f.a)(new Za,{fontColors:$b.FontColors,cellColors:$b.CellColors,icons:$b.Icons,selectedSortFontColor:0<$b.SelectedSortFontColors.length?$b.SelectedSortFontColors[0]:null,selectedSortCellColor:0<$b.SelectedSortCellColors.length?$b.SelectedSortCellColors[0]:null,selectedSortIcon:0<$b.SelectedSortIcons.length?$b.SelectedSortIcons[0]:null,getColorName:this.getColorName}),
this.dfb.onGetColorsAndIconsFinish($b))}}}gTi(){return wb=>{this.abb=this.sQa=null;wb=H.a.Oe(wb.data);wb=O.a.sc(wb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${wb}].`)}}IGe(wb){const $b=this.s$g(wb),uc=this.A$g(wb.AutoFilterItems),Pc=[],Ad=[];let ba=0,cb=0;wb.HasBlanks&&(wb=dc.P5c(ca.a.instance.ga(782),wb.IsBlanksSelected?1:0,r.a.nxe),Pc[ba++]=wb);for(const Kb of $b)Pc[ba++]=Kb;if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Kb of uc)-1!==
Array.indexOf(Na.a.bad,Kb.displayText)?Ad[cb++]=Kb:Pc[ba++]=Kb;else for(const Kb of uc)Pc[ba++]=Kb;return Array.prototype.concat(Ad,Pc)}s$g(wb){const $b=[];if(!wb.AutoFilterDateNodes||!wb.AutoFilterDateNodes.length)return $b;const uc=[this.j5a(wb.YearKeys,wb.YearValues),this.j5a(wb.MonthKeys,wb.MonthValues),this.j5a(wb.DayKeys,wb.DayValues),this.j5a(wb.HourKeys,wb.HourValues),this.j5a(wb.MinuteKeys,wb.MinuteValues),this.j5a(wb.SecondKeys,wb.SecondValues)];let Pc=!1,Ad=!1,ba=0;var cb=null;const Kb=
Array(6);var lc=null;for(const Qc of wb.AutoFilterDateNodes){Kb[0]&&(lc.Year!==Qc.Year?(Pc=!0,ba=0,cb=null):lc.Month!==Qc.Month?(Ad=!0,ba=1,cb=Kb[0]):lc.Day!==Qc.Day?(ba=2,cb=Kb[1]):wb.ShowTime&&(lc.Hour!==Qc.Hour?(ba=3,cb=Kb[2]):lc.Minute!==Qc.Minute?(ba=4,cb=Kb[3]):(ba=5,cb=Kb[4])));for(;6>ba;){let Rc;switch(ba){case 0:Rc=Qc.Year;lc=uc[0].getItem(Rc.toString());break;case 1:Rc=Qc.Month;lc=uc[1].getItem(Rc.toString());break;case 2:Rc=Qc.Day;lc=uc[2].getItem(Rc.toString());break;case 3:Rc=Qc.Hour;
lc=uc[3].getItem(Rc.toString());break;case 4:Rc=Qc.Minute;lc=uc[4].getItem(Rc.toString());break;case 5:Rc=Qc.Second;lc=uc[5].getItem(Rc.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}lc=dc.P5c(lc,-1!==Qc.NodeType&&ba>=Qc.NodeType?1:0,cb?cb.key+";"+Rc:r.a.WZc+Rc,!1,[]);cb=cb?cb.children:$b;cb=cb[cb.length]=lc;Kb[ba]=lc;switch(ba){case 5:ba=6;break;case 2:ba=wb.ShowTime?ba+1:6;break;default:ba++}}lc=Qc}Pc||(Kb[0].expanded=!0,Ad||(Kb[1].expanded=!0));return $b}A$g(wb){const $b=
[];if(!wb)return $b;let uc=0;for(const Pc of wb)$b[uc++]=dc.P5c(Pc.DisplayString,Pc.Selected?1:0,r.a.XZc+Pc.DisplayString);return $b}j5a(wb,$b){const uc=new W.a(!0);if(!wb||!$b)return uc;const Pc=wb.length<$b.length?wb.length:$b.length;for(let Ad=0;Ad<Pc;Ad++)uc.add(wb[Ad].toString(),$b[Ad]);return uc}B5c(wb,$b){const uc={};uc.Location=$b;uc.FieldId=wb.Id.toString();uc.DataSourceIndex=-1;uc.FilterType=wb.AutoFilterType;uc.AnchorType=0;uc.ChartId=null;uc.AnchorValue1=-1;uc.AnchorValue2=-1;uc.Property=
wb.RichProperty;return uc}GS(wb){bb.a.Ala(this.$)&&C.TaskExtensions.Aa(X.GetServiceTaskFactory.Oa(this.$.da,430,431,1),$b=>{$b.result.Uea(wb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)}xm(){return{["Location"]:"contextMenu"}}getColorName(wb){return P.a.vLa(J.a.IH(wb))}bJj(wb){C.TaskExtensions.Aa(X.GetServiceTaskFactory.Oa(this.$.da,309,310,3),$b=>{$b.result.yTa().continueWith(uc=>{uc.result&&wb()})},
this.$.la,3)}static P5c(wb=null,$b=0,uc=null,Pc=!1,Ad=null){return Object(f.a)(new Xa,{displayText:wb?z.a.Rg(wb):wb,state:$b,key:uc,parent:null,children:Ad,indentationLevel:0,expanded:Pc})}}dc.VZc=268;Object(c.a)(dc,"AutoFilterContextMenu",z.a,[]);var Cb=a(723),Tb=a(82),Jb=a(187),eb=a(70),za=a(19);class ha{}ha.rXe=26;ha.zcd=[228,229,0,99,0,95,94];Object(c.a)(ha,"Constants",null,[]);class fb{constructor(wb,$b,uc,Pc){this.CAg=wb;this.lvg=$b;this.pvg=uc;this.OEg=Pc}get gri(){return 3===this.H6b}get avi(){return 4===
this.H6b&&!!this.subMenu}get subMenu(){return this.OEg}get lvf(){return this.CAg}get H6b(){return this.lvg}get l7c(){return this.pvg}}Object(c.a)(fb,"FiltersMenuData",null,[]);class rb extends fb{constructor(wb,$b){super(wb,2,0,null);this.oxe=$b}}Object(c.a)(rb,"AutoFilterFiltersMenuData",fb,[]);class pa{}pa.UQj=[new fb(100,2,0,null),new fb(101,2,1,null),new fb(0,3,0,null),new fb(170,2,2,null),new fb(172,2,4,null),new fb(0,3,0,null),new fb(174,2,6,null),new fb(175,2,7,null),new fb(0,3,0,null),new fb(108,
0,0,null)];pa.pMi=[new fb(100,2,0,null),new fb(101,2,1,null),new fb(0,3,0,null),new fb(102,2,8,null),new fb(103,2,10,null),new fb(104,2,12,null),new fb(0,3,0,null),new fb(105,1,0,null),new rb(106,1),new rb(107,2),new fb(0,3,0,null),new fb(108,0,0,null)];pa.yjh=[new fb(100,2,0,null),new fb(0,3,0,null),new fb(112,2,10,null),new fb(113,2,8,null),new fb(104,2,12,null),new fb(0,3,0,null),new rb(110,8),new rb(109,9),new rb(111,10),new fb(0,3,0,null),new rb(115,11),new rb(114,12),new rb(116,13),new fb(0,
3,0,null),new rb(117,14),new rb(118,15),new rb(119,16),new fb(0,3,0,null),new rb(120,17),new rb(121,18),new rb(122,19),new fb(0,3,0,null),new rb(123,20),new rb(124,21),new rb(125,22),new fb(0,3,0,null),new rb(126,23),new fb(127,2,12,[new rb(128,24),new rb(129,25),new rb(130,26),new rb(131,27),new fb(0,3,0,null),new rb(132,28),new rb(133,29),new rb(134,30),new rb(135,31),new rb(136,32),new rb(137,33),new rb(138,34),new rb(139,35),new rb(140,36),new rb(141,37),new rb(142,38),new rb(143,39)]),new fb(0,
3,0,null),new fb(108,0,0,null)];Object(c.a)(pa,"Constants",null,[]);var Ma=a(906),Ja=a(79);class Ga extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Ga.kGh,!0,!1,Ga.hLb,$b,uc,!1,Pc);this.vm=null}get ax(){return"PopulateAutoFilterFieldListContextMenu"}get UB(){return r.a.TQf}executeCommand(wb,$b,uc){wb=$b.command;switch(wb){case -699941697:this.applyAutoFilterFieldList($b,uc);break;case 216058793:break;case -1494291901:break;default:return va.a(wb)}return sb.Task.Ta(!0)}Cfd(wb,
$b){return!wb||wb.length<=$b?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(wb[$b],10)}xId(wb,$b,uc,Pc,Ad,ba){const cb=this.Cfd(Ad,ba);0>cb&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(ha.zcd[cb]){case 99:wb=new M.a(-2058042992,$b.method,$b.mode,$b.$e,$b.tabName);this.vm.oH.Zub(this.$,Pc,0,wb);break;case 228:wb=new M.a(504133448,$b.method,$b.mode,$b.$e,$b.tabName);
this.vm.oH.Zub(this.$,Pc,0,wb);break;case 229:wb=new M.a(-798968736,$b.method,$b.mode,$b.$e,$b.tabName);this.vm.oH.Zub(this.$,Pc,0,wb);break;case 233:wb=new M.a(-1677817820,$b.method,$b.mode,$b.$e,$b.tabName);this.vm.oH.Zub(this.$,Pc,0,wb);break;case 95:this.ZOf(wb,$b,Pc,uc,Ad,ba+1);break;case 94:this.vm.oH.Xyi(this.$,Pc)}}ZOf(wb,$b,uc,Pc,Ad,ba){const cb=this.Cfd(Ad,ba);0>cb&&d.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Pc||cb>=
Pc.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Pc=Pc[cb],Pc.H6b){case 1:this.vm.oH.pzi(this.$,uc);break;case 2:(Ad=Object(Tb.a)(rb,Pc))?(wb=new M.a(-2058042992,$b.method,$b.mode,$b.$e,$b.tabName),this.vm.oH.Zub(this.$,uc,Ad.oxe,wb)):this.vm.oH.vpf(this.$,wb,uc,Pc.l7c);break;case 0:this.vm.oH.vpf(this.$,wb,uc,Pc.l7c);break;case 4:this.ZOf(wb,$b,uc,Pc.subMenu,Ad,ba+1)}}applyAutoFilterFieldList(wb,$b){var uc=$b[Cb.a.xG];
if(uc)if(uc=uc.split(eb.a.JU),3>uc.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Pc=this.Cfd(uc,1),Ad=this.iLa(Pc),ba=this.gvf(Pc).returnValue;ba?this.xId($b,wb,ba,Ad,uc,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+Pc.toString()+eb.a.JU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}wc(wb,
$b){if(wb=this.$.isEditMode)switch($b.command){case 216058793:break;case -699941697:break;case -1494291901:wb=!0;break;default:wb=!1}return wb}b1(wb,$b,uc){this.$.isEditMode&&((this.vm=Object(Tb.a)(277,uc))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.kZ(),super.b1(wb,$b,null,null,!0))}I5c(){if(!this.vm||!this.vm.$k||1!==this.vm.$k.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;const wb=this.vm.$k[0];let $b=new Jb.a;$b.add(ca.a.instance.ga(249));$b=Ja.OBc(Ja.concat($b,Ja.select(Ja.asEnumerable(wb.FieldInfoDataList),uc=>uc.Name)),uc=>uc,new Ma.a);return Ja.toArray($b)}fieldIndex(wb){if(!this.vm||!this.vm.$k||1!==this.vm.$k.length||!this.vm.$k[0].FieldInfoDataList)return-1;for(let $b=0;$b<this.vm.$k[0].FieldInfoDataList.length;++$b)if(this.vm.$k[0].FieldInfoDataList[$b].Name===wb)return $b;return-1}iLa(wb){return 0>wb||!this.vm||!this.vm.$k||1!==this.vm.$k.length||!this.vm.$k[0].FieldInfoDataList||
this.vm.$k[0].FieldInfoDataList.length<wb?null:this.vm.$k[0].FieldInfoDataList[wb].Name}kZ(){var wb=this.I5c();if(!wb||!wb.length)return null;const $b=this.Va,uc=$b.Ec();for(let cb=0;cb<wb.length;++cb){const Kb=wb[cb],lc=0<cb?this.fieldIndex(Kb):-1,Qc=Ga.C$f+lc.toString()+eb.a.JU;let Rc=null;const zd=this.vm.oH.xbi(0<cb?Kb:null),ae=this.T5c($b,zd,Ga.C$f+lc.toString(),Kb);for(let ze=0;ze<ha.zcd.length;++ze){var Pc=ha.zcd[ze],Ad=Qc+ze.toString();Rc||(Rc=$b.Ec());switch(Pc){case 228:Rc.buttons.push($b.Nc(223,
Ad,-699941697,this.vm.oH.Lui(0<cb?Kb:null)?za.a.z$b:za.a.cKa,8,228,!1,null));break;case 229:Rc.buttons.push($b.Nc(224,Ad,-699941697,this.vm.oH.Mui(0<cb?Kb:null)?za.a.A$b:za.a.dKa,8,229,!1,null));break;case 233:Rc.buttons.push($b.Nc(225,Ad,-699941697,za.a.x$b,1,233,!1,null));break;case 99:Pc=this.bZg(Kb);Ad=$b.LIa(Ad+(zd?".enabled":".disabled"),Pc,-699941697,null,"None",null,!zd,void 0,!0);Ad.rS("Image16by16",8,za.a.A3a);Rc.buttons.push(Ad);break;case 95:var ba=void 0;const Be=({AXe:ba,isChecked:Pc}=
this.gvf(lc)).returnValue;if(!Be)return null;ba=this.T5c($b,Pc&&zd,Ad,ba);Ad=this.F_e(ba.menu,$b,Ad+eb.a.JU,Be,Pc&&zd);ba.menu.tc.push(Ad);Rc.buttons.push(ba);break;case 0:Rc&&(ae.menu.tc.push(Rc),Rc=null);break;default:Ad=$b.LIa(Ad,ca.a.instance.ga(Pc),-699941697,null,"None",null,!1,void 0,!0),this.a3f(Ad,zd&&94===Pc&&this.vm.oH.filter(),ca.a.instance.ga(Pc)),Rc.buttons.push(Ad)}}ae.menu.tc.push(Rc);uc.buttons.push(ae)}wb=$b.cq(this.menuId);wb.tc.push(uc);return wb}F_e(wb,$b,uc,Pc,Ad){let ba=null;
for(let Rc=0;Rc<Pc.length;++Rc){var cb=Pc[Rc],Kb=uc+Rc.toString(),lc=!1;switch(cb.H6b){case 1:lc=Ad&&this.vm.oH.Uh.IsTop10;break;case 2:lc=Object(Tb.a)(rb,cb);lc=Ad&&this.vm.oH.Lni(lc?lc.oxe:0,cb.l7c);break;case 0:lc=Ad&&this.vm.oH.Uh.IsCustomSupportedAndNotPresent}ba||(ba=$b.Ec());if(cb.gri)ba&&(wb.tc.push(ba),ba=null);else if(cb.avi){var Qc=ca.a.instance.ga(cb.lvf);Qc=this.T5c($b,lc,Kb,Qc);Qc.menu.tc.push(this.F_e(Qc.menu,$b,Kb+eb.a.JU,cb.subMenu,lc));ba.buttons.push(Qc)}else cb=ca.a.instance.ga(cb.lvf),
Kb=$b.LIa(Kb,cb,-699941697,null,"None",null,!1,void 0,!0),this.a3f(Kb,lc,cb),ba.buttons.push(Kb)}return ba}a3f(wb,$b,uc){$b?wb.rS("Image16by16",8,za.a.iva):wb.rS("None",0,null);wb.pS(uc);wb.label=uc}T5c(wb,$b,uc,Pc){return $b?wb.J5c(uc,this.menuId,Pc,798637440,8,za.a.iva):wb.ww(uc,this.menuId,Pc,798637440)}ph(wb){return!wb||!wb.length}gvf(wb){var $b=0>wb?0:this.vm.$k[0].FieldInfoDataList[wb].MajorityDataTypeForField;var uc=null;wb=this.vm.oH.wbi($b);switch($b){case 0:uc=96;$b=pa.UQj;break;case 1:uc=
95;$b=pa.pMi;break;case 2:uc=97;$b=pa.yjh;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,AXe:uc,isChecked:wb}}uc=ca.a.instance.ga(uc);return{returnValue:$b,AXe:uc,isChecked:wb}}bZg(wb){return!wb||this.ph(wb.trim())?ca.a.instance.ga(98):wb.length>ha.rXe?String.format(ca.a.instance.nb(155),wb.substring(0,ha.rXe)):String.format(ca.a.instance.nb(156),wb)}}Ga.kGh=r.a.Q9g;Ga.hLb="AutoFilterFieldListContextMenuRoot";
Ga.C$f="ApplyAutoFilterFieldList.";Object(c.a)(Ga,"AutoFilterFieldListContextMenu",z.a,[]);var La=a(548),nb=a(836),Lb=a(11),ac=a(122),ib=a(372),Ra=a(773);class ya extends z.a{constructor(wb,$b,uc,Pc,Ad="PopulateFloatingObjectContextMenu",ba=-2017893763,cb=1350204367,Kb=r.a.X9g,lc=!0,Qc=!1){super(wb,Ad,ba,cb,Kb,lc,Qc,Kb,$b,uc,!0,Pc);this.floatingObject=null;this.tb=0;this.$mc=!0}get ax(){return"PopulateFloatingObjectContextMenu"}get UB(){return r.a.aRf}executeCommand(wb,$b,uc){wb=Object(Tb.a)(La.a,
uc.eventArgs);switch($b.command){case -1372040782:uc=N.h(this.$).ha.Ra.$b;d.ULS.shipAssertTag(537167048,0,!!uc);uc&&(this.floatingObject=uc.floatingObject,this.tb=$b.method,$b=this.rcc(wb),this.Rp($b,!0,wb.tb));break;case 848910589:wb&&($b=[nb.a.m6f],wb=new Sys.UI.Point(wb.Ca.clientX,wb.Ca.clientY),this.showFloatie($b,new Sys.UI.Bounds(wb.x,wb.y,0,0),2))}return sb.Task.Ta(!0)}wc(wb,$b,uc){switch($b.command){case -1372040782:return!!uc&&this.xmf(wb);case 848910589:return wb=N.h(this.$).ha.Ra.$b,!!uc&&
!!wb&&wb.eb;default:return!1}}xmf(wb){switch(wb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}wWc(wb,$b,uc){ib.a(this.$)?N.h(this.$).ib.tj||(qa.a(this.$).MUd()?uc.buttons.push(wb.pb(265)):uc.buttons.push(wb.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.Xac()&&uc.buttons.push(wb.pb(101)),5!==this.floatingObject.type||ac.a.$H(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.Xsd()?uc.buttons.push(wb.pb(186)):uc.buttons.push(wb.pb(147))),this.Xac()||this.Xsd()||uc.buttons.push(wb.pb(146)),
Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.lMh(uc),this.NNh(uc)),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&uc.buttons.push(wb.pb(287)),Y.EwaSettings.ma(164)&&0===this.floatingObject.type&&uc.buttons.push(wb.pb(249)),5===this.floatingObject.type&&N.h(this.$).ha.Ra.$b.P5()&&this.$.G5&&this.$.c3&&uc.buttons.push(wb.pb(273)))}lLa(wb){const $b=[];if(ib.a(this.$))return $b;3===wb?(wb=!!this.$.he.get(5)&&
this.floatingObject.eYd(),this.Xac()||(this.$.isEditMode?(wb&&$b.push(nb.a.lJh),5===N.h(this.$).ha.Ra.hB.floatingObject.type&&$b.push(nb.a.iDj)):wb&&$b.push(nb.a.copy)),$b.push(nb.a.mJh)):2===wb&&(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?N.h(this.$).ha.Ra.$b&&this.I4e(N.h(this.$).ha.Ra.$b,$b):this.I4e(N.h(this.$).ha.Ra.hB,$b));return $b}kZ(){const wb=this.Va,$b=wb.cq(this.menuId);var uc=ib.a(this.$);if(this.$.isEditMode){var Pc=wb.Ec();this.wWc(wb,
$b,Pc);$b.tc.push(Pc)}this.$.he.get(5)&&this.floatingObject.eYd()&&!this.Xac()&&!uc&&(Pc=wb.Ec(),this.GIg(wb,Pc),$b.tc.push(Pc));(Pc=this.$.xa.na)&&Pc.Ed&&(Pc=Pc.Ed.Iv||Pc.Ed.iI,!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||!Ra.g(this.$)||this.$.ea.isNamedObjectViewMode||uc||this.$.isMobileMode||Pc||(uc=wb.Ec(),this.DKg(wb,uc),$b.tc.push(uc)));return $b}rcc(wb){var $b=N.h(this.$).ha.Ra.$b;wb=wb&&1!==wb.tb&&wb.clientPoint?wb.clientPoint:
Sys.UI.DomElement.getLocation($b.domElement);const uc=this.$.domElement,Pc=N.h(this.$).rtl;($b=Lb.HelperMethods.tD($b.mg.domElement,uc,Pc))?(wb.y=Math.max(wb.y,$b.y),wb.x=Math.max(wb.x,$b.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${m.AFrameworkApplication.Lg}`);return wb}Xsd(){const wb=N.h(this.$).ha.Ra.$b;return!!wb&&wb.eb}GIg(wb,$b){if(this.$.isEditMode){$b.buttons.push(wb.pb(42));
$b.buttons.push(wb.pb(43));const uc=this.$.da.za(254,!0);(uc&&2===uc.QCb()||this.Xsd())&&$b.buttons.push(wb.pb(44))}else $b.buttons.push(wb.pb(43))}DKg(wb,$b){$b.buttons.push(wb.pb(274))}Xac(){return Y.EwaSettings.ma(461)&&!!N.h(this.$).ha.Ra.qo}I4e(wb,$b){5===wb.floatingObject.type?wb.eb?$b.push(nb.a.m6f):$b.push(nb.a.eDj):$b.push(z.a.CYe)}lMh(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(282));$b.buttons.push(this.Va.pb(281));const uc=this.Va.ww("BringToFront","BringToFrontMenuId",ca.a.instance.ga(822),
-1777747317);uc.menu.tc.push($b);wb.buttons.push(uc)}NNh(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(284));$b.buttons.push(this.Va.pb(283));const uc=this.Va.ww("SendToBack","SendToBackMenuId",ca.a.instance.ga(823),-1777747317);uc.menu.tc.push($b);wb.buttons.push(uc)}}Object(c.a)(ya,"FloatingObjectContextMenu",z.a,[]);var Va=a(787),oa=a(101),kb=a(555),Sa=a(516);const U=r.a.T9g;class ta extends ya{constructor(wb,$b,uc,Pc){super(wb,$b,uc,Pc,"PopulateChartContextMenu",-498523270,1640762262,U);
this.isPivotChart=this.refresh=this.EZ=this.Wwa=this.IBa=!1}get ax(){return"PopulateChartContextMenu"}get UB(){return r.a.VQf}executeCommand(wb,$b,uc){const Pc=this.$;this.tb=$b.method;$b=uc[ta.b2c];if(!(wb&68)){if(!$b){if(8===wb)$b=Sa.a(Pc).Vc;else{var Ad=N.h(Pc).ha.Ra.$b;if(null===Ad||void 0===Ad?0:Ad.floatingObject)$b=Ad.floatingObject.Vc}if(!$b)return sb.Task.Ta(!0)}this.isPivotChart=!!($b.Attributes&4)}if(this.isPivotChart||Pc.isEditMode)if(this.refresh=this.EZ=this.Wwa=this.IBa=!1,Ad=N.h(this.$).ha.Ra.$b,
d.ULS.shipAssertTag(537167107,0,!!Ad),Ad){this.floatingObject=Ad.floatingObject;Ad=kb.a(Pc);if(null===Ad||void 0===Ad?0:Ad.gUd)this.IBa=Ad=oa.f(Pc.hg),this.Wwa=!Ad;Ad=Pc.dc;this.EZ=!!Va.a(Pc)&&!!$b&&!!($b.Attributes&512)&&!(wb&8)&&Ad.b3(32768);Ad.allowManualDataRefresh&&Ad.allowInteractivity&&(this.refresh=!0);wb=this.rcc(Object(Tb.a)(La.a,uc.eventArgs));this.Rp(wb,!0)}return sb.Task.Ta(!0)}wc(wb,$b,uc){return-149612405===$b.command&&!!uc&&this.xmf(wb)}wWc(wb,$b,uc){this.isPivotChart&&(this.refresh&&
uc.buttons.push(wb.pb(100)),this.EZ&&uc.buttons.push(wb.pb(99)),this.IBa?uc.buttons.push(wb.pb(59)):this.Wwa&&uc.buttons.push(wb.pb(58)));super.wWc(wb,$b,uc)}static get b2c(){return"chartMetaData"}}Object(c.a)(ta,"ChartContextMenu",ya,[]);var ub=a(12);const hc=r.a.V9g;class Bc extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateFieldListContextMenu",-1045020714,-170383950,hc,!0,!1,hc,$b,uc,!1,Pc);this.XL=this.Co=null;this.gYd=this.isOlap=this.KV=this.q_=!1}get ax(){return"PopulateFieldListContextMenu"}get UB(){return r.a.KJd}executeCommand(wb,
$b,uc){wb=$b.command;switch(wb){case 330754562:$b=uc.domElement;this.isOlap=uc.isOlap;this.XL=uc.versionkey;this.Co=uc.fieldItem;this.q_=uc.isChart;this.KV=uc.isPpm;this.gYd="supportsImplicitMeasures"in uc?uc.supportsImplicitMeasures:!1;N.h(this.$).Uo(!0);$b=ub.DOMElementExtensions.getBounds($b);$b=new Sys.UI.Point($b.x+$b.width,$b.y+$b.height/2);"isKeyboardInput"in uc&&uc.isKeyboardInput?this.Rp($b,!1,1):this.Rp($b,!1);break;case 926905850:this.gYd&&this.Co&&5===this.Co.TypeTag&&!this.Co.IsCollapsible&&
d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");kb.a(this.$).hK(this.Co,8,-1,this.XL,$b);break;case -67292059:kb.a(this.$).hK(this.Co,1,-1,this.XL,$b);break;case 745182485:kb.a(this.$).hK(this.Co,2,-1,this.XL,$b);break;case 359279088:kb.a(this.$).hK(this.Co,4,-1,this.XL,$b);break;case 547535945:kb.a(this.$).ncj(this.Co);break;default:return va.a(wb)}return sb.Task.Ta(!0)}wc(wb,$b,uc){wb=!1;switch($b.command){case 330754562:wb=!!uc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:wb=
!0}return wb}kZ(){const wb=this.Va.cq(this.menuId);this.I6i(wb);this.q_||this.isOlap||this.H6i(wb);return wb}I6i(wb){const $b=this.Va,uc=$b.Ec();let Pc=!1;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Pc=this.isOlap&&!this.KV&&this.gYd&&5===this.Co.TypeTag&&!this.Co.IsCollapsible);3!==this.Co.TypeTag&&37!==this.Co.TypeTag||this.Co.IsSet?17===this.Co.TypeTag||this.KV?(uc.buttons.push($b.pb(79)),uc.buttons.push($b.pb(this.q_?91:80)),uc.buttons.push($b.pb(this.q_?
92:81)),uc.buttons.push($b.pb(82))):13===this.Co.TypeTag||this.Co.IsSet?(uc.buttons.push($b.pb(83)),uc.buttons.push($b.pb(this.q_?91:80)),uc.buttons.push($b.pb(this.q_?92:81)),uc.buttons.push($b.pb(86))):(uc.buttons.push($b.pb(79)),uc.buttons.push($b.pb(this.q_?91:80)),uc.buttons.push($b.pb(this.q_?92:81)),uc.buttons.push($b.pb(Pc?82:86))):(uc.buttons.push($b.pb(83)),uc.buttons.push($b.pb(this.q_?93:84)),uc.buttons.push($b.pb(this.q_?94:85)),uc.buttons.push($b.pb(82)));wb.tc.push(uc)}H6i(wb){const $b=
this.Va.Ec();$b.buttons.push(this.Va.pb(78));wb.tc.push($b)}}Object(c.a)(Bc,"FieldListContextMenu",z.a,[]);var Qa=a(416),na=a(64);class ab{constructor(wb){this.$=wb;this.RN={}}get(wb,$b,uc){const Pc=this.Efg(wb,"PivotFilterContextMenuCache.Get");return Pc&&this.RN[Pc]?this.RN[Pc][ab.zhd($b,this.$,wb,uc)]:null}set(wb,$b,uc,Pc){const Ad=this.Efg(wb,"PivotFilterContextMenuCache.Set");Ad&&(this.RN[Ad]||(this.RN[Ad]={}),this.RN[Ad][ab.zhd($b,this.$,wb,Pc)]=uc)}j9b(wb){wb in this.RN&&this.RN[wb]&&(this.RN[wb]=
null)}Efg(wb,$b){return na.f(this.$.na)?this.$.activeItemName:(wb=this.EVj(wb,$b))?wb.Cd:null}EVj(wb,$b){wb=F.C(wb);wb=N.h(this.$).Ea.hwa(wb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!wb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${$b}`);return wb}static zhd(wb,$b,uc,Pc){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Pc?$b.na.index+"_"+wb.id+
"_"+uc.FirstRow.toString()+"_"+uc.FirstColumn.toString():$b.na.index+"_"+wb.id}}Object(c.a)(ab,"PivotFilterContextMenuCache",null,[]);class Gb{constructor(){this.cell=null;this.dataSourceIndex=0;this.Po=this.pivotName=null}}Object(c.a)(Gb,"ShowPivotFilterData",null,[]);var fc=a(459),pb=a(1293),Ea=a(53);const xb=r.a.wGe;class bc extends z.a{constructor(wb,$b,uc,Pc,Ad,ba,cb,Kb=xb){super(wb,$b,uc,Pc,Kb,!0,!1,"PivotFilterMenuRootName",Ad,ba,!1,cb);this.qoc=this.RBd=this.pivotData=this.xnb=this.Eof=this.S6b=
null;this.JY=this.T3b=this.xFb=0;this.Xsb=null;this.zTi=(lc,Qc)=>{if(Qc)if(T.a(lc))this.Jyd(Qc,!1);else if(lc=lc.Result){this.Otb=ab.zhd(Qc,this.$,this.pivotData.cell,this.JY);var Rc=this.hvf(lc.MenuModel.Sections);this.Xsb=Rc;bc.RN.set(this.pivotData.cell,Qc,Rc,this.JY);pb.a(this.$).rOj(lc);this.Jyd(Qc,!0)}};this.yTi=(lc,Qc)=>{this.Jyd(Qc,!1)};this.sf=(lc,Qc)=>{bc.RN.j9b(Qc.jd.hash)};this.an=(lc,Qc)=>{bc.RN.j9b(Qc.jd.hash)};this.vAa=null;this.cCe=this.T3b=this.SBd=this.xFb=-1;this.Wte=this.JY=0;
this.Gz=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");bc.RN||(bc.RN=new ab(this.$),N.h(this.$).Ea.mt(this.sf),N.h(this.$).Ea.jH(this.an),N.h(this.$).Ea.mha(this.sf))}Fbd(wb,$b){const uc=wb.rawEvent,Pc=wb.cell,Ad=wb.requiresConfirmation;fc.a(this.$).Sx(Ad,ba=>{if(ba){ba=uc?new Sys.UI.DomEvent(uc):null;this.pivotData=new Gb;this.pivotData.pivotName=wb.pivotName;this.pivotData.dataSourceIndex=wb.dataSourceIndex;this.pivotData.cell=Pc;this.pivotData.Po=wb.optionalPivotMenuAnchorParameter;
if(this.pivotData.Po&&0<this.pivotData.Po.AnchorType){this.qoc=wb.objectId;this.xFb=wb.objectVersion;const cb=this.pivotData.Po.AnchorType;if(4===cb||5===cb||6===cb||11===cb||9===cb||10===cb||8===cb)this.xnb=wb.location}else this.RBd=this.qoc=null,this.SBd=this.xFb=-1;N.h(this.$).Uo(!0);this.$.jk(Pc);this.b1(ba,ba?ba.target:wb.domElement,this.pivotData,$b,this.mNa())}});return!0}b1(wb,$b,uc,Pc){if(Object(Qa.a)(Gb,uc)){this.pivotData=uc;this.S6b=$b;this.Eof=wb;this.T3b=this.pivotData.Po?this.pivotData.Po.AnchorValue1:
-1;this.JY=this.pivotData.Po?this.pivotData.Po.AnchorType:0;var Ad=!1,ba=null;ba=bc.RN.get(this.pivotData.cell,$b,this.JY);Ad=!!ba;var cb=!0;switch(this.JY){case 4:case 5:case 6:this.vAa=new Sys.UI.Point(this.xnb.x,this.xnb.y);cb=!1;break;case 7:var Kb=Sys.UI.DomElement.getBounds($b);cb=Kb.x+(0<=Kb.x?0:Kb.width);Kb=Kb.y+(0<=Kb.y?0:Kb.height);this.vAa=new Sys.UI.Point(0<=cb?cb:0,0<=Kb?Kb:0);cb=!1;break;case 8:case 10:case 9:case 11:this.vAa=new Sys.UI.Point(this.xnb.x,this.xnb.y);break;default:this.vAa=
null}Ad&&this.qoc===this.RBd&&this.xFb===this.SBd&&this.T3b===this.cCe&&this.JY===this.Wte?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Xsb=ba,this.vAa?this.Rp(this.vAa,this.mNa()):this.Gz?z.a.Spd(this.$,this.pivotData.cell)&&this.Rp(z.a.Lfd(this.$,this.pivotData.cell,!1),this.mNa()):super.b1(wb,$b,uc,Pc,this.mNa())):1!==bc.zVh($b)&&(cb&&($b.parentNode.menuFetchStates=1,this.Ixj($b),this.J2f(!0)),this.$.userOperationManager.Kc(new I.a(126,
0,(lc,Qc,Rc)=>{const zd=this.$;return L.p(zd.pa.ya,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,zd.domElement.id,zd.isChromeRtl,zd.workbookContext.NovMode,ra.b(lc,this.zTi),ra.a(Qc,this.yTi),Rc,$b,this.pivotData.Po)},16),Pc))}}UGd(wb){wb.MenuSectionList.push(...this.Xsb)}Jyd(wb,$b){wb.parentNode.menuFetchStates=2;this.J2f(!1);if($b){if(this.S6b!==wb||this.THi())this.Rp(this.vAa,this.mNa());else if(this.Gz&&!this.vAa){if(!z.a.Spd(this.$,this.pivotData.cell))return;this.Rp(z.a.Lfd(this.$,
this.pivotData.cell,!1),this.mNa())}else super.b1(this.Eof,wb,null,null,this.mNa());this.RBd=this.qoc;this.SBd=this.xFb;this.Wte=this.JY;this.cCe=this.T3b}}mNa(){return 8!==this.JY&&9!==this.JY&&10!==this.JY&&11!==this.JY}THi(){switch(this.pivotData.Po?this.pivotData.Po.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}J2f(wb){const $b=this.S6b;if($b){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var uc=ub.DOMElementExtensions.OZ($b,
"ewaprevsrc","");uc=!!uc&&"null"!==uc}else uc=!!ub.DOMElementExtensions.OZ($b,"ewaprevsrc","");wb&&uc||!wb&&!uc||(wb?($b.setAttribute("ewaprevsrc",$b.src),$b.src=Ea.a.current.io(99)):(wb=ub.DOMElementExtensions.OZ($b,"ewaprevsrc",""),$b.src=wb,$b.setAttribute("ewaprevsrc",null)))}}Ixj(wb){this.S6b=wb}static zVh(wb){const $b=wb.parentNode.menuFetchStates;void 0===$b&&(wb.parentNode.menuFetchStates=0);return $b}}bc.RN=null;Object(c.a)(bc,"PivotFilterContextMenuBase",z.a,[]);const zb="FieldList"+r.a.wGe;
class Ub extends bc{constructor(wb,$b,uc,Pc){super(wb,"PopulateFieldListPivotMenu",-1793121409,1378457149,$b,uc,Pc,zb)}get ax(){return"PopulateFieldListPivotMenu"}get UB(){return r.a.ZQf}executeCommand(wb,$b,uc){return this.Fbd(uc,$b)?sb.Task.Ta(!0):va.a($b.command)}wc(wb,$b,uc){return-1065117584===$b.command&&!!uc}}Object(c.a)(Ub,"FieldListPivotContextMenu",bc,[]);var wc=a(263),mb=a(30),Db=a(87),Ic=a(752);class Hc{}Object(c.a)(Hc,"PivotValueFieldSettingsApplyData",null,[]);class Ab{}Ab.Tkg="valueFieldSettingTabs";
Ab.bjh="dataFieldCustomLabel";Ab.GKe="dataFieldSourceLabel";Ab.YVd="showValueAsSelect";Ab.WVd="showValueAsBaseFieldSelect";Ab.XVd="showValueAsBaseItemSelect";Ab.w2d="valueFieldsSettingsFieldName";Object(c.a)(Ab,"CssElementIds",null,[]);var db=a(108);class Pb{constructor(wb,$b,uc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=wb;this.baseFieldIndex=$b;this.baseItemIndex=uc}}Object(c.a)(Pb,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class td{constructor(wb,$b,
uc,Pc,Ad){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=wb;this.activeCell=$b;this.pivotFieldTitle=uc;this.summarizeBy=Pc;this.showAsValueParameters=Ad}getActiveCell(){return this.activeCell}}Object(c.a)(td,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[125]);var Vb=a(238);class Ac{}Object(c.a)(Ac,"PivotValueFieldShowValueAsApplyData",null,[]);var Kc=a(735),dd=a(44);const Vd=`<div id='showValueAsControlBody'><label for='${Ab.YVd}' class='${db.a.qp} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Ab.YVd}' class='${db.a.sF}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Ab.WVd}'>{1}</label><div><select size=6 id='${Ab.WVd}' class='${db.a.sF}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Ab.XVd}'>{2}</label><div><select size=6 id='${Ab.XVd}' class='${db.a.sF}'></select></div></div></div>`;
class Jd extends Vb.a{constructor(wb,$b,uc,Pc,Ad,ba,cb,Kb,lc){super(wb);this.htmlSanitizationHelper=this.D8d=this.m6d=this.l6d=this.i2b=this.x7b=this.FD=null;this.kBf=()=>{var Qc=parseInt(this.Z3.ee.value,10);this.r1g(Qc)?(this.VP.Qp.disabled=!0,this.WP.Qp.disabled=!0,this.WP.clear(),Jd.Lgf(Qc)?(this.VP.Qp.disabled=!1,this.fQb(!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):Jd.Mgf(Qc)?(this.VP.Qp.disabled=!1,this.WP.Qp.disabled=!1,this.fQb(!0),this.kqf()):this.fQb(!1)):
(Qc=O.a.Zc(1,0,0,1125,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),dd.a(this.$).Rr([Qc]),this.Z3.Mpj())};this.dOi=()=>{0>this.VP.selectedIndex||this.WP.Qp.disabled||(this.fQb(!0),this.kqf())};this.wUi=Qc=>{this.FD.bUa();this.WP.Qp.style.overflowY="scroll";if(Qc&&!T.a(Qc)){Qc=Qc.Result;this.WP.clear();for(const Rc of Qc.BaseItems)this.WP.DY(Rc.DisplayString,Rc.Id.toString(),Rc.Id===Qc.SelectedBaseItem);this.fQb(!1)}};this.get_visible=this.wka;this.set_visible=this.moa;this.$=$b;this.cell=uc;this.Po=
Pc;this.externalSourceIndex=Ad;this.Wd=ba;this.Kta=cb;this.Eri=Kb;this.htmlSanitizationHelper=lc;this.c0j=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Ska()}wka(){return this.isVisible}moa(wb){return this.isVisible=wb}get title(){return ca.a.instance.ga(1113)}get vxb(){const wb=this.Z3.ee?parseInt(this.Z3.ee.value,10):-1,$b=this.VP.ee?parseInt(this.VP.ee.value,10):-1,uc=this.WP.ee?parseInt(this.WP.ee.value,10):-1;return Object(f.a)(new Ac,{SelectedDataFormat:0<=
wb?wb:-1,SelectedBaseField:$b,SelectedBaseItem:uc})}get VP(){return this.l6d}get WP(){return this.m6d}get Z3(){return this.D8d}setFocus(){ub.DOMElementExtensions.setFocus(this.Z3.Qp)}render(wb){wb.appendChild(this.domElement)}dispose(){Db.a.qc([this.Z3,this.VP,this.WP,this.x7b,this.i2b]);super.dispose()}sAj(wb){Db.a.qc([this.x7b,this.i2b]);this.Z3.clear();for(const $b of wb.DataFormatTypes)this.Z3.DY(Jd.ATh($b),$b.toString(),$b===wb.SelectedDataFormat);this.x7b=this.Be.Zd(this.Z3.domElement);this.x7b.ka("change",
this.kBf);this.VP.clear();for(const $b of wb.BaseFieldList)this.VP.DY($b.DisplayString,$b.Id.toString(),$b.Id===wb.SelectedBaseField);this.i2b=this.Be.Zd(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?this.VP.domElement:this.Z3.domElement);this.i2b.ka("change",this.dOi);this.FD=this.Kta.Rsb(this.WP.Qp.parentNode,1E3,null,"",736);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.FD.bUa();this.kBf(null)}aR(wb){this.Z3.aR(wb);
this.VP.aR(wb);this.WP.aR(wb)}Ska(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.sk(this.domElement,String.format(Vd,ca.a.instance.ga(1114),ca.a.instance.ga(1115),ca.a.instance.ga(1116))):this.domElement.innerHTML=String.format(Vd,ca.a.instance.ga(1114),ca.a.instance.ga(1115),ca.a.instance.ga(1116));this.D8d=new Kc.a(ub.DOMElementExtensions.getElementById(this.domElement,
Ab.YVd),!1);this.l6d=new Kc.a(ub.DOMElementExtensions.getElementById(this.domElement,Ab.WVd),!1);this.m6d=new Kc.a(ub.DOMElementExtensions.getElementById(this.domElement,Ab.XVd),!1)}r1g(wb){return this.Eri||!Jd.Lgf(wb)&&!Jd.Mgf(wb)?!0:!!this.VP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Kc(new I.a(108,0,(wb,$b,uc)=>{var Pc=this.$.pa.ya,Ad=parseInt(this.VP.ee.value,10);wb=ra.b.call(null,wb,this.wUi);const ba=L.L(Pc,this.cell,this.externalSourceIndex,this.Po);
ba.selectedBaseField=Ad;return L.g(Pc,"GetPivotValueFieldSettingsShowValueAsBaseItems",ba,wb,$b,uc,null,4)},16),this.Wd)}kqf(){this.WP.clear();this.VP.ee&&(this.FD.WTa(),this.WP.Qp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}fQb(wb){const $b=document.getElementById("WACDialogActionButton");this.c0j&&$b&&($b.disabled=wb)}static ATh(wb){switch(wb){case 0:return ca.a.instance.ga(1117);case 1:return ca.a.instance.ga(1118);case 2:return ca.a.instance.ga(1119);case 3:return ca.a.instance.ga(1120);
case 4:return ca.a.instance.ga(1121);case 5:return ca.a.instance.ga(1122);case 6:return ca.a.instance.ga(1123);case 7:return ca.a.instance.ga(1124);case 8:return ca.a.instance.ga(1126);case 9:return ca.a.instance.ga(1127);case 10:return ca.a.instance.ga(1128);case 11:return ca.a.instance.ga(1129);case 12:return ca.a.instance.ga(1130);case 13:return ca.a.instance.ga(1131);case 14:return ca.a.instance.ga(1132);default:return""}}static Lgf(wb){return 11===wb||12===wb||14===wb||13===wb||4===wb}static Mgf(wb){return 1===
wb||3===wb||2===wb}}Object(c.a)(Jd,"ShowValueAsControl",Vb.a,[296,2]);class oe{}Object(c.a)(oe,"PivotValueFieldSummarizeValueByApplyData",null,[]);const De="<div id='summarizeValuesByControlBody'>"+`<label class='${db.a.qp} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${db.a.qp} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${db.a.sF}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${r.a.MJ}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class Ke extends Vb.a{constructor(wb,$b){super(wb);this.htmlSanitizationHelper=this.Mhe=null;this.get_visible=this.wka;this.set_visible=this.moa;this.htmlSanitizationHelper=$b;this.Ska()}get vxb(){const wb=this.tl.ee?parseInt(this.tl.ee.value,10):-1;return Object(f.a)(new oe,{Aggregation:0<=wb?wb:-1})}wka(){return this.isVisible}moa(wb){return this.isVisible=wb}get title(){return ca.a.instance.ga(1112)}get enabled(){return!this.tl.Qp.disabled}set enabled(wb){this.tl.Qp.disabled=!wb}get tl(){return this.Mhe}setFocus(){ub.DOMElementExtensions.setFocus(this.tl.Qp)}render(wb){wb.appendChild(this.domElement)}dispose(){Db.a.Ia(this.tl);
super.dispose()}focus(){ub.DOMElementExtensions.setFocus(this.tl.Qp)}rAj(wb){this.tl.VWd();for(const $b of wb.AggregationTypes){const uc=$b===wb.SelectedAggregation;this.tl.tWc(Ke.ZOh($b),$b.toString(),uc,"")}this.tl.n$c();this.tl.Qp.disabled=wb.AggregationsDisabled}Ipj(){this.tl.Jpj()}Ska(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.sk(this.domElement,
String.format(De,ca.a.instance.ga(1097),ca.a.instance.ga(1098))):this.domElement.innerHTML=String.format(De,ca.a.instance.ga(1097),ca.a.instance.ga(1098));this.Mhe=new Kc.a(ub.DOMElementExtensions.getElementById(this.domElement,Ke.hMf),!1)}static ZOh(wb){switch(wb){case 0:return ca.a.instance.ga(1100);case 1:return ca.a.instance.ga(1101);case 2:return ca.a.instance.ga(1102);case 3:return ca.a.instance.ga(1103);case 4:return ca.a.instance.ga(1104);case 5:return ca.a.instance.ga(1105);case 6:return ca.a.instance.ga(1106);
case 7:return ca.a.instance.ga(1107);case 8:return ca.a.instance.ga(1108);case 9:return ca.a.instance.ga(1109);case 10:return ca.a.instance.ga(1110);case 11:return ca.a.instance.ga(1111);default:return""}}}Ke.hMf="pivotDataFieldSelect";Object(c.a)(Ke,"SummarizeValuesByControl",Vb.a,[296,2]);var rd=a(210),bf=a(468),cc=a(1237);class Wc extends Ic.a{constructor(wb,$b,uc,Pc,Ad,ba,cb,Kb,lc,Qc){super(Ad,ca.a.instance.nb(61),!0,2,!0);this.e8f=!0;this.htmlSanitizationHelper=this.YTc=this.w7b=this.mtb=this.lga=
this.FTa=this.pne=null;this.QNi=Rc=>{wc.a.any(Rc.Errors,zd=>-103190598===zd.MessageId)&&this.jUa.Ipj()};this.vUi=Rc=>{Rc&&!T.a(Rc)&&(Rc=Rc.Result,Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.fyj(this.w7b,ca.a.instance.ga(1095)+mb.a.Eg(Rc.ValueFieldSourceName)):this.w7b.innerHTML=ca.a.instance.ga(1095)+mb.a.Eg(Rc.ValueFieldSourceName),this.isOlap&&
!this.KV?(this.jUa.enabled=!1,this.lga.activeTab=this.lga.CBc-1):(this.jUa.enabled=!0,this.lga.activeTab=0),this.jUa.rAj(Rc.PivotValueFieldSettingsSummarizeValueByInfo),this.FTa.sAj(Rc.PivotValueFieldShowValueAsInitialInfo),this.ug())};this.cell=wb;this.Po=$b;this.externalSourceIndex=uc;this.Skg=Pc;this.Wd=ba;this.Kta=cb;this.isOlap=Kb;this.KV=lc;this.htmlSanitizationHelper=Qc}get pc(){return"ValueFieldSettingsDialog"}get UCa(){return this.pne}get TEb(){return this.lga}get jUa(){return this.YTc}get iC(){return 560}dispose(){this.w7b=
this.mtb=this.FTa=this.YTc=null;Db.a.Ia(this.lga);this.lga=null;super.dispose()}initialize(){let wb="<div id='"+Ab.GKe+"' class='"+db.a.qp+"'></div><div id='"+Ab.bjh+"' class='"+db.a.qp+"'><label for='"+Ab.w2d+"'>{0}</label><input type='text' id='"+Ab.w2d+"' value='{1}' class='"+db.a.sF+" UIFont' /></div><div id='"+Ab.Tkg+"'></div>";wb=String.format(wb,ca.a.instance.ga(1096),mb.a.Eg(this.Skg));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
this.htmlSanitizationHelper.sk(this.Qb,wb):this.Qb.innerHTML=wb;this.Mf||(this.vsa(),this.Ot());this.pne=[-103190598];this.b7h();super.initialize()}close(wb){1===wb&&(this.e8f=!1);super.close(wb)}IMe(wb){this.AN=wb;this.domElement.disabled=wb;const $b=["input","option","select"];for(let uc=0,Pc=$b.length;uc<Pc;++uc){const Ad=this.domElement.getElementsByTagName($b[uc]);for(let ba=0;ba<Ad.length;++ba)Ad[ba].disabled=wb}}Ot(){this.mtb=document.getElementById(Ab.w2d);this.w7b=ub.DOMElementExtensions.getElementById(this.Qb,
Ab.GKe);const wb=ub.DOMElementExtensions.getElementById(this.Qb,Ab.Tkg);this.YTc=new Ke(document.createElement("div"),this.htmlSanitizationHelper);this.FTa=new Jd(document.createElement("div"),this.$,this.cell,this.Po,this.externalSourceIndex,this.Wd,this.Kta,!this.isOlap,this.htmlSanitizationHelper);let $b;this.lga=new cc.a(wb,($b=new Jb.a,$b.add(this.jUa),$b.add(this.FTa),$b));this.lga.tWf()}eHd(){const wb=new Wc(this.cell,this.Po,this.externalSourceIndex,this.Skg,this.$,this.Wd,this.Kta,this.isOlap,
this.KV,this.htmlSanitizationHelper);wb.initialize();wb.ug()}YQb(){const wb=new bf.a;if(!this.e8f)return wb.isValid=!0,wb;this.mtb.value.length?wb.isValid=!0:(this.IMe(!0),wb.error=O.a.Zc(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.AN=!0,this.Mf||(this.rz.disabled=!0),wb.isValid=!1);return wb}f$e(){this.AN=!1;this.Mf||(this.rz.disabled=!1);this.IMe(!1)}sza(wb){const $b=new M.a(2105621672,0,this.$.Hc,30,null);this.$.Ka.Lb($b);this.PW(5,wb.tb,"Number Format");return!0}vq(){this.Yoa=
String.format(ca.a.instance.nb(61),null);super.vq()}setFocus(){if(this.Mf){const wb=ub.DOMElementExtensions.getElementById(this.Qb,Ke.hMf);rd.a.j0d(wb)}else this.lga.setFocus()}ek(){const wb=this.FTa.vxb,$b=new Pb(wb.SelectedDataFormat,wb.SelectedBaseField,wb.SelectedBaseItem);return()=>new td(this.externalSourceIndex,this.cell,this.mtb.value,this.jUa.vxb.Aggregation,$b)}pH(){const wb=Object(f.a)(new Hc,{PivotValueFieldSummarizeValueByApplyData:this.jUa.vxb,PivotValueFieldShowValueAsApplyData:this.FTa.vxb,
PivotValueFieldTitle:this.mtb.value});return($b,uc,Pc)=>{var Ad=this.$.pa.ya;$b=ra.b($b,this.QNi);const ba=L.L(Ad,this.cell,this.externalSourceIndex,this.Po);ba.pivotValueFieldSettingsApplyData=wb;return L.g(Ad,"ApplyPivotValueFieldSettings",ba,$b,uc,Pc,null,0)}}aR(wb){this.$.da.$a(40,()=>{this.FTa.aR(wb)})}b7h(){this.$.userOperationManager.Kc(new I.a(123,0,(wb,$b,uc)=>{var Pc=this.$.pa.ya;wb=ra.b.call(null,wb,this.vUi);const Ad=L.L(Pc,this.cell,this.externalSourceIndex,this.Po);return L.g(Pc,"GetPivotValueFieldSettingsInitial",
Ad,wb,$b,uc,null,4)},16),this.Wd)}}Object(c.a)(Wc,"ValueFieldSettingsDialog",Ic.a,[]);const id=r.a.W9g;class Tc extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateFieldWellContextMenu",1374696078,495005930,id,!0,!1,id,$b,uc,!1,Pc);this.Po=this.Co=this.cell=null;this.J3d=this.externalSourceIndex=-1;this.RTa=0;this.CAc=-1;this.XL=null;this.P3a=this.KV=this.isOlap=!1}get ax(){return"PopulateFieldWellContextMenu"}get UB(){return r.a.LJd}executeCommand(wb,$b,uc,Pc){wb=$b.command;switch(wb){case -1453503574:Pc=
uc.domElement;this.Co=uc.fieldItem;this.J3d=uc.zoneCount;this.RTa=uc.sourceAxis;this.CAc=uc.sourceAxisPos;this.Po=uc.optionalPivotMenuAnchorParameter;this.XL=uc.versionkey;this.isOlap=uc.isOlap;this.KV=uc.isPpm;this.P3a="fieldItemsupportsImplicitMeasures"in uc?uc.fieldItemsupportsImplicitMeasures:!1;this.cell=uc.cell;this.externalSourceIndex=uc.externalSourceIndex;N.h(this.$).Uo(!0);Pc=ub.DOMElementExtensions.getBounds(Pc);wb=new Sys.UI.Point(Pc.x,Pc.y+Pc.height);this.$.isChromeRtl&&(wb.x+=Pc.width);
"isKeyboardInput"in uc&&uc.isKeyboardInput?this.Rp(wb,!1,1):this.Rp(wb,!1);break;case 495005930:break;case -1170196828:kb.a(this.$).hK(this.Co,this.RTa,this.CAc-1,this.XL,$b);break;case -889576107:kb.a(this.$).hK(this.Co,this.RTa,this.CAc+2,this.XL,$b);break;case 2033235475:kb.a(this.$).hK(this.Co,this.RTa,this.J3d,this.XL,$b);break;case 389774337:kb.a(this.$).hK(this.Co,this.RTa,0,this.XL,$b);break;case -96230454:kb.a(this.$).hK(this.Co,4,-1,this.XL,$b);break;case 74086617:kb.a(this.$).hK(this.Co,
1,-1,this.XL,$b);break;case 1529312473:kb.a(this.$).hK(this.Co,2,-1,this.XL,$b);break;case 563292088:this.P3a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");kb.a(this.$).hK(this.Co,8,-1,this.XL,$b);break;case -1092351914:kb.a(this.$).hK(this.Co,0,-1,this.XL,$b);break;case -2141589616:const Ad=X.GetServiceTaskFactory.Oa(this.$.da,12,477,Pc.N4()),ba=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
X.GetServiceTaskFactory.Oa(this.$.da,498,499,Pc.N4()):sb.Task.Ta(null);return C.TaskExtensions.Aa(C.TaskExtensions.Fd([Ad,ba],this.$.la),()=>{(new Wc(this.cell,this.Po,this.externalSourceIndex,this.Co.Name,this.$,$b,Ad.result,this.isOlap,this.KV,ba.result)).initialize()},this.la);default:return va.a(wb)}return sb.Task.Ta(!0)}wc(wb,$b,uc){wb=!1;switch($b.command){case -1453503574:wb=!!uc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:wb=
!0}return wb}kZ(){const wb=this.Va.cq(this.menuId);this.P6i(wb,this.CAc,this.J3d);this.Q6i(wb,this.RTa);this.R6i(wb);8===this.RTa&&this.N6i(wb);return wb}P6i(wb,$b,uc){const Pc=this.Va,Ad=Pc.Ec();$b||$b!==uc-1?!$b&&$b<uc-1?(Ad.buttons.push(Pc.pb(64)),Ad.buttons.push(Pc.pb(61)),Ad.buttons.push(Pc.pb(66)),Ad.buttons.push(Pc.pb(63))):0<$b&&$b<uc-1?(Ad.buttons.push(Pc.pb(60)),Ad.buttons.push(Pc.pb(61)),Ad.buttons.push(Pc.pb(62)),Ad.buttons.push(Pc.pb(63))):0<$b&&$b===uc-1&&(Ad.buttons.push(Pc.pb(60)),
Ad.buttons.push(Pc.pb(65)),Ad.buttons.push(Pc.pb(62)),Ad.buttons.push(Pc.pb(67))):(Ad.buttons.push(Pc.pb(64)),Ad.buttons.push(Pc.pb(65)),Ad.buttons.push(Pc.pb(66)),Ad.buttons.push(Pc.pb(67)));wb.tc.push(Ad)}Q6i(wb,$b){const uc=this.Va,Pc=uc.Ec(),Ad=1!==$b&&(!this.isOlap||this.KV||8!==$b||this.P3a),ba=2!==$b&&(!this.isOlap||this.KV||8!==$b||this.P3a),cb=8!==$b&&-2!==this.Co.PivotTableIndex&&(!this.isOlap||this.KV||this.P3a);Pc.buttons.push(uc.pb(4===$b||this.Co.IsSet||-2===this.Co.PivotTableIndex||
this.isOlap&&!this.KV&&8===$b&&!this.P3a?72:68));8===this.Po.AnchorType||10===this.Po.AnchorType?(Pc.buttons.push(uc.pb(Ad?95:97)),Pc.buttons.push(uc.pb(ba?96:98))):(Pc.buttons.push(uc.pb(Ad?69:73)),Pc.buttons.push(uc.pb(ba?70:74)));Pc.buttons.push(uc.pb(cb?71:75));wb.tc.push(Pc)}R6i(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(76));wb.tc.push($b)}N6i(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(77));wb.tc.push($b)}}Object(c.a)(Tc,"FieldWellContextMenu",z.a,[]);var Gd=a(1218);class Wd extends bc{constructor(wb,
$b,uc,Pc){super(wb,"PopulatePivotContextMenu",2123758504,912277356,$b,uc,Pc)}get ax(){return"PopulatePivotContextMenu"}get UB(){return r.a.eRf}executeCommand(wb,$b,uc){let Pc=!1;const Ad=$b.command;switch(Ad){case 37023044:Pc=this.Fbd(uc,$b);break;case 541421805:case -569786022:Pc=this.fld(wb,$b)}return Pc?sb.Task.Ta(!0):va.a(Ad)}wc(wb,$b,uc){wb=!1;switch($b.command){case 37023044:wb=!!uc;break;case 541421805:case -569786022:wb=!0}return wb}fld(wb,$b){var uc=8===wb,Pc=this.$,Ad=Sa.a(Pc),ba=N.h(Pc).ha.Ra.$b;
let cb=wb=null;uc&&Ad?(wb=Ad.chartId,cb=Ad.Vc):!uc&&ba&&(wb=ba.floatingObject.id,cb=ba.floatingObject.Vc);return Wd.Zve(cb,260)?(uc={},Pc.jk(uc),uc.FirstColumn=uc.FirstRow=-1,Pc={["rawEvent"]:null,["pivotName"]:null,["cell"]:uc,["requiresConfirmation"]:Wd.Zve(cb,64),["dataSourceIndex"]:cb.ExternalSourceIndex},ba?(Ad=ba.floatingObject,Pc.domElement=ba.domElement,Pc.objectId=Ad.id,Pc.objectVersion=Ad.version):Ad&&(Pc.domElement=Ad.Fl,Pc.objectId=Ad.chartId,Pc.objectVersion=Ad.fCe),ba={AnchorType:7},
ba.ChartId=wb,ba.AnchorValue1=-1,ba.AnchorValue2=-1,Pc.optionalPivotMenuAnchorParameter=ba,this.Fbd(Pc,$b)):!1}static Zve(wb,$b){return(wb.Attributes&$b)===$b}}Object(c.a)(Wd,"PivotFilterContextMenu",bc,[]);var Dd=a(1292);const Kd=(wb,$b,uc,Pc,Ad,ba,cb,Kb,lc,Qc=null)=>{Qc=wb.Na(41,Qc);Qc.activeCell=$b;Qc.operationType=uc;Qc.fieldCaption=Pc;Qc.prevFieldCaption=Ad;return L.g(wb,"ExecutePivotTableOperation",Qc,ba,cb,Kb,lc,0)},we=(wb,$b,uc,Pc,Ad,ba,cb,Kb=null)=>{Kb=wb.Na(41,Kb);Kb.activeCell=$b;Kb.pivotValueFieldSettingsApplyData=
uc;return L.g(wb,"ApplyValueFieldSettingsToPivotTable",Kb,Pc,Ad,ba,cb,0)};var We=a(148),Od=a(371),le=a(283),de=a(28),Re=a(22);const Ee=r.a.$9g,Te=Ee+".RemoveField",Ae=Ee+".Subtotal",kf=Ee+".ClearFilter",Oe=Ee+".LayoutSameColumn",$a=Ee+".LayoutNextColumn";class Zb extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Ee,!0,!1,"PivotTableContextMenuRootName",$b,uc,!0,Pc);this.l3d=this.activeCell=this.kc=null;this.EZ=this.refresh=this.expandCollapse=this.Kqd=
this.mkc=!1;this.vbb=this.vb=this.H1a=this.sA=this.Ae=null;this.aca=!1;this.LTi=Ad=>{Ad&&!O.a.Zf(Ad.Errors)&&this.kc&&(this.kc.fp=Ad.Result,this.vMb());this.showPivotTableContextMenu()};this.KTi=()=>{};this.CXi=()=>{this.adb()};this.BXi=()=>{this.adb()};this.WNi=()=>{this.adb()};this.VNi=()=>{this.adb()};this.Cy=()=>{this.H0d();this.aca=!1};this.dr=()=>{if(this.aca){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const Ad=this.kc;this.grid.Bb.zp(this.grid.ha.ra.activeCell)!==Ad&&(this.adb(),this.Yci())}};this.Bph=new DOMParser;this.BEj=!0;this.grid=N.h(wb);this.$mc=!0}get ax(){return"PopulatePivotTableContextMenu"}get UB(){return r.a.fRf}executeCommand(wb,$b,uc){$b=$b.command;wb=null;this.grid=N.h(this.$);this.activeCell=F.o(this.grid.ha.ra.activeCell,this.$);if(this.$.isEditMode&&(this.kc=this.grid.Bb.zp(this.grid.ha.ra.activeCell),!this.kc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
C.TaskExtensions.tba();this.l3d=this.$.pa.ya;this.H1a=Object(Tb.a)(La.a,uc.eventArgs);switch($b){case 671488277:this.qGj()?this.C0h():(this.adb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.aTa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.aTa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.aTa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.aTa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.aTa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.aTa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:uc=Number.parseInvariant(uc.MenuItemId.split(".")[2]);this.aTa(11,uc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xc(-1556797033,B.a.Db,8,null);break;case 1514686611:this.dzi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:uc=Number.parseInvariant(uc.MenuItemId);this.e5g(uc);break;case 1778578888:uc=Number.parseInvariant(uc.MenuItemId);this.qSg(uc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:wb=va.a($b)}return wb||C.TaskExtensions.tba()}wc(wb,$b){wb=!1;switch($b.command){case 671488277:wb=
Ra.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:wb=!0;break;case 1600778266:wb=!0;break;case -556893687:wb=!0;break;case -1966978671:wb=!0;break;case -1951357930:wb=!0;break;case -1390365353:case -1457478532:wb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:wb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:wb=
!0;break;case -1007663920:case 234234584:case 1194992911:wb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:wb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:wb=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return wb}qGj(){if(!this.$.isEditMode||this.kc.gic)return!1;let wb=this.c7f(!1);return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.kc.isOlap||wb:!this.kc.cjc()||wb}nc(wb,$b){let uc=!1;switch($b){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:uc=this.uS();break;case -1007663920:case 234234584:uc=this.TEj()||this.uS();break;case 1194992911:uc=this.UEj()||this.uS();break;
case 1217404289:uc=!Dd.j(this.vb.LabelOrDateFilterType)||this.uS();break;case -743135194:uc=!Dd.m(this.vb.ValueFilterType)&&!Dd.l(this.vb.ValueFilterType)||this.uS();break;case 771421327:uc=0===this.vb.LabelOrDateFilterType&&0===this.vb.ValueFilterType&&!this.vb.HasManualFilter||this.uS();break;case 1015867427:uc=!Dd.i(this.vb.LabelOrDateFilterType)||this.uS();break;case 1105960559:uc=!Dd.k(this.vb.LabelOrDateFilterType)||this.uS()}return uc||super.nc(wb,$b)}adb(){this.vbb=this.vb=this.Ae=null}RXd(){this.grid.PT(this.dr);
this.$.Ka.OZa(this.Cy)}H0d(){this.grid.vO(this.dr);this.$.Ka.fKb(this.Cy)}vMb(){if(this.kc&&this.kc.fp){this.Ae=this.kc.fp;this.vb=this.kc.vcc();if(this.Q7f()){const wb=this.kc.yL[4===this.Ae.CellType?this.kc.B7c-1:this.Ae.CurrentFieldIndex-1];wb&&(this.vbb=-2===wb.Index?this.kc.LKe:wb.Caption)}this.Jgi();this.vb&&8===this.Ae.CellArea&&(this.sA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.vb.DataFieldAggregationType,this.sA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.vb.DataFieldFormatType,
this.sA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.vb.BaseFieldIndex,this.sA.PivotValueFieldTitle=this.vb.Caption)}}c7f(wb){return this.kc?this.kc.isOlap&&!this.kc.eOa(!wb):!1}aFj(){const wb=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.vb.MeasureType&&(!this.kc.klf||wb&&2===this.vb.MeasureType)}kZ(){const wb=this.Va.cq(this.menuId),$b=this.Va.Ec(),uc=N.h(this.$).Sb(null);if(this.kc)this.Ae&&this.kc.fp&&this.Ae!==this.kc.fp&&
d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.vb&&this.vb!==this.kc.vcc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return wb;this.pMh(wb);if(this.$.isEditMode){this.refresh&&this.HNh(wb);if(this.Ae&&this.vb){var Pc=this.Va.Ec();this.VNh(Pc);this.EMh(Pc);wb.tc.push(Pc)}this.EZ&&$b.buttons.push(this.Va.pb(99));this.Ae&&this.vb&&this.cNh(wb);if(this.expandCollapse){Pc=this.Va.ww("ContextMenu.PivotExpandCollapse",
null,ca.a.instance.ga(1161),589118293);const Ad=this.Va.Ec();Ad.buttons.push(this.Va.pb(243));Ad.buttons.push(this.Va.pb(244));Ad.buttons.push(this.Va.pb(245));Ad.buttons.push(this.Va.pb(246));Pc.menu.tc.push(Ad);Pc&&0<Ad.buttons.length&&$b.buttons.push(Pc)}this.Ae&&(Pc=this.Va.Ec(),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.nNh(Pc),this.INh(Pc),0<Pc.buttons.length&&wb.tc.push(Pc));this.Ae&&this.vb&&8===this.Ae.CellArea&&8!==this.Ae.CellType&&
(Pc=this.Va.Ec(),this.aFj()&&this.XNh(Pc),3!==this.Ae.CellType&&this.SNh(Pc),wb.tc.push(Pc));!this.kc.cjc()&&""!==(null===uc||void 0===uc?void 0:uc.text)&&this.Ae&&0===this.Ae.CellType&&Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.RNh(wb);this.rsi()?$b.buttons.push(this.Va.pb(257)):$b.buttons.push(this.Va.pb(258));this.Kqd?$b.buttons.push(this.Va.pb(59)):$b.buttons.push(this.Va.pb(58))}wb.tc.push($b);return wb}qTa(){return this.vb&&this.vb.Caption?20<
this.vb.Caption.length:!1}jLa(wb){return this.vb&&this.vb.Caption?wb?this.vb.Caption.substring(0,20)+"...":this.vb.Caption:""}iwa(wb){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Re.a.hashCode(wb).toString():wb}VNh(wb){if(this.Ae&&this.vb&&4!==this.Ae.CellArea){var $b=this.Qja(this.MH("PivotTableContextMenu.Sort",this.iwa(this.vb.Caption)),-1777747317,0,0!==this.vb.SortInfo,ca.a.instance.ga(227)),uc=this.Va.Ec();uc.buttons.push(this.Sd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.vb.SortInfo,ca.a.instance.ga(228)));uc.buttons.push(this.Sd("PivotTableContextMenu.SortDescending",234234584,0,2===this.vb.SortInfo,ca.a.instance.ga(229)));1!==this.Ae.CellArea&&2!==this.Ae.CellArea||uc.buttons.push(this.Sd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.vb.SortInfo||4===this.vb.SortInfo,ca.a.instance.ga(154)));$b.menu.tc.push(uc);$b&&0<uc.buttons.length&&wb.buttons.push($b)}}EMh(wb){if(this.Ae&&this.vb&&(1===this.Ae.CellArea||2===this.Ae.CellArea)){var $b=
this.pGj();const ba=this.Qja(this.MH("PivotTableContextMenu.Filter",this.iwa(this.vb.Caption)),-1777747317,0,$b,ca.a.instance.ga(651)),cb=this.Va.Ec();var uc="",Pc=this.qTa(),Ad=String.format(ca.a.instance.nb(156),this.jLa(Pc));Pc&&(uc=String.format(ca.a.instance.nb(156),this.vb.Caption));$b=this.iwa(this.vb.Caption)+"."+($b?"enabled":"disabled");uc=this.Sd(this.MH(kf,$b),771421327,0,!1,Ad,"0",uc,8,za.a.A3a);$b=this.iwa(this.vb.Caption)+"."+this.vb.LabelOrDateFilterType.toString();this.vb.IsDateField?
(Ad=this.Qja(this.MH("PivotTableContextMenu.DateFilter",$b),-1777747317,0,0!==this.vb.LabelOrDateFilterType,ca.a.instance.ga(97)),this.sMh(Ad.menu)):(Ad=this.Qja(this.MH("PivotTableContextMenu.LabelFilter",$b),-1777747317,0,0!==this.vb.LabelOrDateFilterType,ca.a.instance.ga(649)),this.bNh(Ad.menu));$b=this.iwa(this.vb.Caption)+"."+this.vb.ValueFilterType.toString();$b=this.Qja(this.MH("PivotTableContextMenu.ValueFilter",$b),-1777747317,0,0!==this.vb.ValueFilterType,ca.a.instance.ga(650));this.iOh($b.menu);
Pc=this.Va.Ec();Pc.buttons.push(this.Sd("PivotTableContextMenu.ManualFilter",1514686611,0,this.vb.HasManualFilter,ca.a.instance.ga(94)));cb.buttons.push(uc);cb.buttons.push(Ad);cb.buttons.push($b);ba.menu.tc.push(cb);ba.menu.tc.push(Pc);ba&&0<cb.buttons.length&&wb.buttons.push(ba)}}sMh(wb){wb.tc.push(this.Rcc(!0,!1));wb.tc.push(this.JTh());wb.tc.push(this.ITh());wb.tc.push(this.EVh());wb.tc.push(this.HVh());wb.tc.push(this.FVh());wb.tc.push(this.GVh());wb.tc.push(this.IVh());wb.tc.push(this.JVh());
wb.tc.push(this.rTh())}hMh(wb){wb.tc.push(this.Rcc(!0,!0));wb.tc.push(this.z1h());wb.tc.push(this.MZh())}bNh(wb){wb.tc.push(this.Rcc(!0,!1));wb.tc.push(this.y2e(!0));wb.tc.push(this.UPh());wb.tc.push(this.BSh());wb.tc.push(this.x1e(!0));wb.tc.push(this.B0e(!0))}iOh(wb){wb.tc.push(this.Rcc(!1,!1));wb.tc.push(this.y2e(!1));wb.tc.push(this.x1e(!1));wb.tc.push(this.B0e(!1));wb.tc.push(this.V5h())}V5h(){const wb=this.Va.Ec();wb.buttons.push(this.Sd("PivotTableContextMenu.Top10",-1611233597,0,Dd.l(this.vb.ValueFilterType),
ca.a.instance.ga(105)));return wb}BSh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.Contains",786260386,0,10===this.vb.LabelOrDateFilterType,ca.a.instance.ga(652),"10")),wb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.vb.LabelOrDateFilterType,ca.a.instance.ga(653),"11")));return wb}UPh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.vb.LabelOrDateFilterType,ca.a.instance.ga(654),
"6")),wb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.vb.LabelOrDateFilterType,ca.a.instance.ga(655),"7")),wb.buttons.push(this.Sd("PivotTableContextMenu.EndsWith",786260386,0,8===this.vb.LabelOrDateFilterType,ca.a.instance.ga(656),"8")),wb.buttons.push(this.Sd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.vb.LabelOrDateFilterType,ca.a.instance.ga(657),"9")));return wb}y2e(wb){const $b=this.Va.Ec();if(this.vb){const uc=wb?Dd.c:Dd.f;$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.Equals",
uc),786260386,0,wb?4===this.vb.LabelOrDateFilterType:18===this.vb.ValueFilterType,ca.a.instance.ga(100),wb?"4":"18"));$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.DoesNotEqual",uc),786260386,0,wb?5===this.vb.LabelOrDateFilterType:19===this.vb.ValueFilterType,ca.a.instance.ga(101),wb?"5":"19"))}return $b}x1e(wb){const $b=this.Va.Ec();if(this.vb){const uc=wb?Dd.c:Dd.f;$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.GreaterThan",uc),786260386,0,wb?12===this.vb.LabelOrDateFilterType:
20===this.vb.ValueFilterType,ca.a.instance.ga(102),wb?"12":"20"));$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.GreaterThanOrEqualTo",uc),786260386,0,wb?13===this.vb.LabelOrDateFilterType:21===this.vb.ValueFilterType,ca.a.instance.ga(658),wb?"13":"21"));$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.LessThan",uc),786260386,0,wb?14===this.vb.LabelOrDateFilterType:22===this.vb.ValueFilterType,ca.a.instance.ga(103),wb?"14":"22"));$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.LessThanOrEqualTo",
uc),786260386,0,wb?15===this.vb.LabelOrDateFilterType:23===this.vb.ValueFilterType,ca.a.instance.ga(659),wb?"15":"23"))}return $b}B0e(wb){const $b=this.Va.Ec();if(this.vb){const uc=wb?Dd.c:Dd.f;$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.Between",uc),786260386,0,wb?16===this.vb.LabelOrDateFilterType:24===this.vb.ValueFilterType,ca.a.instance.ga(104),wb?"16":"24"));$b.buttons.push(this.Sd(this.MH("PivotTableContextMenu.NotBetween",uc),786260386,0,wb?17===this.vb.LabelOrDateFilterType:25===
this.vb.ValueFilterType,ca.a.instance.ga(660),wb?"17":"25"))}return $b}Rcc(wb,$b){const uc=this.Va.Ec();if(this.vb){var Pc=ca.a.instance.ga(98);const ba=wb?this.vb.LabelOrDateFilterType.toString():this.vb.ValueFilterType.toString();var Ad=["PivotTableContextMenu.ClearFilter",this.iwa(this.vb.Caption),ba];wb=wb?this.vb.IsDateField?$b?1015867427:1105960559:1217404289:-743135194;Ad.push(wb.toString());Ad=Ad.join(".");Pc=this.Sd(Ad,wb,0,!1,Pc,ba,Pc,8,za.a.A3a);uc.buttons.push(Pc)}return uc}JTh(){const wb=
this.Va.Ec();this.vb&&wb.buttons.push(this.Sd(this.MH("PivotTableContextMenu.Equals",Dd.d),786260386,0,26===this.vb.LabelOrDateFilterType,ca.a.instance.ga(100),"26"));return wb}ITh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.Before",786260386,0,27===this.vb.LabelOrDateFilterType,ca.a.instance.ga(112),"27")),wb.buttons.push(this.Sd("PivotTableContextMenu.After",786260386,0,28===this.vb.LabelOrDateFilterType,ca.a.instance.ga(113),"28")),wb.buttons.push(this.Sd("PivotTableContextMenu.Between",
786260386,0,29===this.vb.LabelOrDateFilterType,ca.a.instance.ga(104),"29")));return wb}EVh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.vb.LabelOrDateFilterType,ca.a.instance.ga(110),"30")),wb.buttons.push(this.Sd("PivotTableContextMenu.Today",1778578888,0,31===this.vb.LabelOrDateFilterType,ca.a.instance.ga(109),"31")),wb.buttons.push(this.Sd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.vb.LabelOrDateFilterType,ca.a.instance.ga(111),
"32")));return wb}HVh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.vb.LabelOrDateFilterType,ca.a.instance.ga(115),"33")),wb.buttons.push(this.Sd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.vb.LabelOrDateFilterType,ca.a.instance.ga(114),"34")),wb.buttons.push(this.Sd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.vb.LabelOrDateFilterType,ca.a.instance.ga(116),"35")));return wb}FVh(){const wb=this.Va.Ec();this.vb&&
(wb.buttons.push(this.Sd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.vb.LabelOrDateFilterType,ca.a.instance.ga(117),"36")),wb.buttons.push(this.Sd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.vb.LabelOrDateFilterType,ca.a.instance.ga(118),"37")),wb.buttons.push(this.Sd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.vb.LabelOrDateFilterType,ca.a.instance.ga(119),"38")));return wb}GVh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.vb.LabelOrDateFilterType,ca.a.instance.ga(120),"39")),wb.buttons.push(this.Sd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.vb.LabelOrDateFilterType,ca.a.instance.ga(121),"40")),wb.buttons.push(this.Sd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.vb.LabelOrDateFilterType,ca.a.instance.ga(122),"41")));return wb}IVh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.NextYear",1778578888,0,42===this.vb.LabelOrDateFilterType,
ca.a.instance.ga(123),"42")),wb.buttons.push(this.Sd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.vb.LabelOrDateFilterType,ca.a.instance.ga(124),"43")),wb.buttons.push(this.Sd("PivotTableContextMenu.LastYear",1778578888,0,44===this.vb.LabelOrDateFilterType,ca.a.instance.ga(125),"44")));return wb}JVh(){const wb=this.Va.Ec();if(this.vb){wb.buttons.push(this.Sd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.vb.LabelOrDateFilterType,ca.a.instance.ga(126),"45"));const $b=this.Qja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Dd.i(this.vb.LabelOrDateFilterType),ca.a.instance.ga(127));this.hMh($b.menu);wb.buttons.push($b)}return wb}rTh(){const wb=this.Va.Ec();this.vb&&wb.buttons.push(this.Sd("PivotTableContextMenu.CustomFilter",786260386,0,this.mGj(this.vb.LabelOrDateFilterType),ca.a.instance.ga(108),"26"));return wb}z1h(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.vb.LabelOrDateFilterType,ca.a.instance.ga(128),"46")),wb.buttons.push(this.Sd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.vb.LabelOrDateFilterType,ca.a.instance.ga(129),"47")),wb.buttons.push(this.Sd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.vb.LabelOrDateFilterType,ca.a.instance.ga(130),"48")),wb.buttons.push(this.Sd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.vb.LabelOrDateFilterType,ca.a.instance.ga(131),"49")));return wb}MZh(){const wb=this.Va.Ec();this.vb&&(wb.buttons.push(this.Sd("PivotTableContextMenu.January",1778578888,0,50===this.vb.LabelOrDateFilterType,ca.a.instance.ga(132),
"50")),wb.buttons.push(this.Sd("PivotTableContextMenu.February",1778578888,0,51===this.vb.LabelOrDateFilterType,ca.a.instance.ga(133),"51")),wb.buttons.push(this.Sd("PivotTableContextMenu.March",1778578888,0,52===this.vb.LabelOrDateFilterType,ca.a.instance.ga(134),"52")),wb.buttons.push(this.Sd("PivotTableContextMenu.April",1778578888,0,53===this.vb.LabelOrDateFilterType,ca.a.instance.ga(135),"53")),wb.buttons.push(this.Sd("PivotTableContextMenu.May",1778578888,0,54===this.vb.LabelOrDateFilterType,
ca.a.instance.ga(136),"54")),wb.buttons.push(this.Sd("PivotTableContextMenu.June",1778578888,0,55===this.vb.LabelOrDateFilterType,ca.a.instance.ga(137),"55")),wb.buttons.push(this.Sd("PivotTableContextMenu.July",1778578888,0,56===this.vb.LabelOrDateFilterType,ca.a.instance.ga(138),"56")),wb.buttons.push(this.Sd("PivotTableContextMenu.August",1778578888,0,57===this.vb.LabelOrDateFilterType,ca.a.instance.ga(139),"57")),wb.buttons.push(this.Sd("PivotTableContextMenu.September",1778578888,0,58===this.vb.LabelOrDateFilterType,
ca.a.instance.ga(140),"58")),wb.buttons.push(this.Sd("PivotTableContextMenu.October",1778578888,0,59===this.vb.LabelOrDateFilterType,ca.a.instance.ga(141),"59")),wb.buttons.push(this.Sd("PivotTableContextMenu.November",1778578888,0,60===this.vb.LabelOrDateFilterType,ca.a.instance.ga(142),"60")),wb.buttons.push(this.Sd("PivotTableContextMenu.December",1778578888,0,61===this.vb.LabelOrDateFilterType,ca.a.instance.ga(143),"61")));return wb}cNh(wb){const $b=this.Va.Ec();if(this.Q7f()){var uc=this.kc.yL[4===
this.Ae.CellType?this.kc.B7c-1:this.Ae.CurrentFieldIndex-1];if(uc&&this.vbb){var Pc=this.Va.ww("ContextMenu.PivotTableLayout",null,ca.a.instance.ga(647),-1777747317);var Ad=this.Va.Ec();const ba=String.format(ca.a.instance.nb(169),this.vbb),cb=String.format(ca.a.instance.nb(170),this.vbb);Ad.buttons.push(this.Sd($a,-1457478532,0,!uc.IsCompactLayout,ba));Ad.buttons.push(this.Sd(Oe,-1390365353,0,uc.IsCompactLayout,cb));Pc.menu.tc.push(Ad);Pc&&$b.buttons.push(Pc)}}if(1===this.Ae.CellArea||2===this.Ae.CellArea)this.vb.Caption&&
(uc="",Ad=this.qTa(),Pc=String.format(ca.a.instance.nb(159),this.jLa(Ad)),Ad&&(uc=String.format(ca.a.instance.nb(159),this.vb.Caption)),1===this.Ae.CellArea?(uc=this.Qja("ContextMenu.PivotTableSubtotal",1801458190,0,this.vb.ShowSubtotal,Pc),Pc=this.Va.Ec(),Pc.buttons.push(this.Va.pb(259)),Pc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.vb.ShowSubtotal&&this.vb.ShowSubtotalAtTop)),Pc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.vb.ShowSubtotal&&
!this.vb.ShowSubtotalAtTop)),uc.menu.tc.push(Pc),uc&&0<Pc.buttons.length&&$b.buttons.push(uc)):(Ad=Ad?this.MH(Ae,this.iwa(Pc)):Ae,$b.buttons.push(this.Sd(Ad,1801458190,0,this.vb.ShowSubtotal,Pc,null,uc)))),$b.buttons.push(this.Sd("ContextMenu.RepeatItemLabels",-556893687,642,this.vb.RepeatItemLabels));1===this.Ae.CellArea&&$b.buttons.push(this.Sd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.vb.ShowBlankLineAfterEachItem));wb.tc.push($b)}RNh(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(247));
wb.tc.push($b)}nNh(wb){if(this.$.isEditMode&&this.grid){var $b=this.grid.ha.ra.activeRange;if($b.top===$b.bottom&&$b.left===$b.right&&0!==this.Ae.MoveItemsMenuState){$b=this.Qja("PivotTableContextMenu.Move",-1777747317,0,!1,ca.a.instance.ga(73));var uc=this.Va.Ec();this.Jva(uc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(ca.a.instance.nb(162),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&1));this.Jva(uc,"PivotTableContextMenu.MoveUp",713270357,String.format(ca.a.instance.nb(163),
this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&2));this.Jva(uc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(ca.a.instance.nb(160),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&4));this.Jva(uc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(ca.a.instance.nb(161),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&8));$b.menu.tc.push(uc);uc=this.Va.Ec();this.Jva(uc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(ca.a.instance.nb(167),this.jLa(this.qTa())),
0===(this.Ae.MoveItemsMenuState&16));this.Jva(uc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(ca.a.instance.nb(164),this.jLa(this.qTa())),0===(this.Ae.MoveItemsMenuState&32));this.Jva(uc,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(ca.a.instance.nb(165),this.jLa(this.qTa())),0===(this.Ae.MoveItemsMenuState&64));this.Jva(uc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(ca.a.instance.nb(166),this.jLa(this.qTa())),0===(this.Ae.MoveItemsMenuState&
128));$b.menu.tc.push(uc);wb.buttons.push($b)}}}INh(wb){var $b="";let uc="";var Pc=!1;3===this.Ae.CellType?$b=ca.a.instance.ga(644):8===this.Ae.CellType?this.kc&&($b=String.format(ca.a.instance.nb(168),this.kc.LKe)):this.vb&&((Pc=this.qTa())&&(uc=String.format(ca.a.instance.nb(168),this.vb.Caption)),$b=String.format(ca.a.instance.nb(168),this.jLa(Pc)));$b&&(Pc=Pc?this.MH(Te,this.iwa($b)):Te,$b=this.Sd(Pc,-1951357930,0,!1,$b,null,uc,8,za.a.bbd),wb.buttons.push($b))}pMh(wb){const $b=this.Va.Ec();$b.buttons.push(this.Va.pb(43));
this.vb&&this.Ae&&this.$.isEditMode&&(0===this.Ae.CellType||4===this.Ae.CellType)&&$b.buttons.push(this.Va.pb(136));if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&Y.EwaSettings.ma(104)&&this.grid&&this.grid.ha){const uc=this.grid.ha.ra.selectedRanges;uc&&1===uc.length&&(uc[0].isSingle||this.grid.Bb.VNa(uc[0]))&&this.grid.Bb.Yxa(uc[0])&&!this.grid.Bb.Xzb(uc[0])&&$b.buttons.push(this.Va.pb(this.grid.Bb.Zgf(uc[0])?217:216))}wb.tc.push($b)}HNh(wb){const $b=
this.Va.Ec();$b.buttons.push(this.Va.pb(100));wb.tc.push($b)}XNh(wb){const $b=2===this.vb.MeasureType&&!this.vb.IsNumeric,uc=this.Va.ww("ContextMenu.SummarizeValuesBy",null,ca.a.instance.ga(645),-249874296),Pc=this.Va.Ec();Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesBySum",-1255320719,1100,0===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,$b));Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCount",1746132849,1101,1===this.vb.DataFieldAggregationType));Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByAverage",
-771066011,1102,2===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,$b));Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMax",835007294,1103,3===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,$b));Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMin",929115636,1104,4===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,$b));Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByProduct",1935475057,1105,5===this.vb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.c7f(!0)||$b));2!==this.vb.MeasureType&&(Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1106,6===this.vb.DataFieldAggregationType)),Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1107,7===this.vb.DataFieldAggregationType)),Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1108,8===this.vb.DataFieldAggregationType)),Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariant",
1668427539,1109,9===this.vb.DataFieldAggregationType)),Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1110,10===this.vb.DataFieldAggregationType)));this.kc&&this.kc.cjc()&&Pc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1111,11===this.vb.DataFieldAggregationType));uc.menu.tc.push(Pc);wb.buttons.push(uc)}SNh(wb){const $b=this.Va.ww("ContextMenu.ShowValuesAs",null,ca.a.instance.ga(646),-1128612833),uc=this.Va.Ec();uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1117,0===this.vb.DataFieldFormatType));uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1124,7===this.vb.DataFieldFormatType));uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1123,6===this.vb.DataFieldFormatType));uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1122,5===this.vb.DataFieldFormatType));uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1127,9===this.vb.DataFieldFormatType));
uc.buttons.push(this.Sd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1128,10===this.vb.DataFieldFormatType));if(this.kc&&this.kc.yL&&0<this.kc.yL.length||this.kc.aaa&&0<this.kc.aaa.length){const Pc=this.Qja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1129,11===this.vb.DataFieldFormatType),Ad=this.Va.Ec(),ba=this.WNh();for(let cb=0;cb<ba.length;cb++){const Kb=ba[cb];Ad.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Kb.Caption,-2031744961,1129,11===this.vb.DataFieldFormatType&&
this.vb.BaseFieldIndex===Kb.Index,Kb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Kb.Index))}Pc.menu.tc.push(Ad);uc.buttons.push(Pc)}$b.menu.tc.push(uc);wb.buttons.push($b)}showPivotTableContextMenu(){this.Kqd=!0;this.expandCollapse=this.EZ=this.refresh=!1;var wb=this.$,$b=N.h(wb),uc=fc.a(wb).CLa();if(uc){var Pc=kb.a(wb);if(null===Pc||void 0===Pc?0:Pc.gUd)this.Kqd=oa.f(wb.hg);Pc=wb.dc;this.EZ=uc.supportsBIExplore&&!!Va.a(wb)&&Pc.b3(32768);Pc.allowInteractivity&&(wb=$b.Sb(null),(null===
wb||void 0===wb?0:wb.cell)&&(wb.cell.X0c||wb.cell.N7f)&&(this.expandCollapse=!0),Pc.allowManualDataRefresh&&(this.refresh=!0))}wb=null;uc=1;this.H1a&&1!==this.H1a.tb?(wb=new Sys.UI.Point(this.H1a.clientPoint.x,this.H1a.clientPoint.y),uc=this.H1a.tb):($b=Ra.e($b,this.$))&&(wb=new Sys.UI.Point($b.x+(this.$.isChromeRtl?0:$b.width),$b.y+$b.height));B.a.Db=uc;this.mkc=3===uc;this.Rp(wb,!0,uc);this.aca=!0;this.RXd()}Yci(){const wb=new M.a(1114549926,0,this.$.Hc,19,null);this.$.Ka.Lb(wb)}C0h(){if(this.kc&&
this.kc.fp){var wb=this.kc.fp.CurrentCol;if(this.kc.fp.CurrentRow===this.activeCell.FirstRow&&wb===this.activeCell.FirstColumn){this.vMb();this.showPivotTableContextMenu();return}}wb=new I.a(228,0,($b,uc,Pc)=>le.l(this.$.pa.ya,this.activeCell,ra.b($b,this.LTi),ra.a(uc,this.KTi),Pc,null),16);this.$.userOperationManager.Kc(wb,null)}rsi(){if(bb.a.gd(this.$)){var wb=this.$.da.za(441);if(wb)return wb.ps}else if(wb=this.$.da.za(346))return wb.ps;return!1}MH(wb,$b){return wb+"."+$b}performPivotTableOperation(wb,
$b){const uc=de.a.Qa.zb;if(!this.kc||!this.vb&&this.Ae&&3!==this.Ae.CellType)this.vj();else{var Pc=this.kc.isOlap;fc.a(this.$).Sx(Pc,Ad=>{Ad&&this.$.Kc(wb,(ba,cb,Kb)=>Kd(this.l3d,this.activeCell,$b,this.vb?this.vb.Caption:null,this.vbb,ra.b(ba,this.CXi),ra.a(cb,this.BXi),Kb,null,this.$.pa.ya.Wb()),uc,0,4,229)})}}applyValueFieldSettingsToPivotTable(wb,$b=!1){const uc=de.a.Qa.zb;this.kc&&this.vb?($b&&2===this.vb.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
$b=this.kc.isOlap,fc.a(this.$).Sx($b,Pc=>{Pc&&this.$.Kc(wb,(Ad,ba,cb)=>we(this.l3d,this.activeCell,this.sA,ra.b(Ad,this.WNi),ra.a(ba,this.VNi),cb,null,this.$.pa.ya.Wb()),uc,0,4,231)})):this.vj()}Sd(wb,$b,uc,Pc,Ad=null,ba=null,cb=null,Kb=8,lc=null,Qc=!1){Pc&&(wb+=".Checked");Qc&&(wb+=".Disabled");this.Va.xpd(wb)&&this.Va.BLd(wb);uc=Ad||ca.a.instance.ga(uc);wb=this.Va.LIa(wb,uc,$b,null,"None",ba,Qc,null);wb.gyc(null);cb&&wb.pS(cb);Pc?wb.rS("Image16by16",3,za.a.Jaa):lc?wb.rS("Image16by16",Kb,lc):wb.o4b();
return wb}Qja(wb,$b,uc,Pc,Ad=null){uc=Ad||ca.a.instance.ga(uc);this.Va.xpd(wb)?this.Va.BLd(wb):this.Va.BLd(wb+".Checked");Pc&&(wb+=".Checked");this.BEj&&(uc=this.Bph.parseFromString(uc,"text/html").body.innerText);wb=this.Va.J5c(wb,null,uc,$b,3,za.a.Jaa);wb.Fdf=Pc;!Pc&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&wb.o4b();return wb}Jgi(){this.sA=Object(f.a)(new Hc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new oe,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new Ac,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}aTa(wb,$b){this.sA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=wb;this.sA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=$b;this.sA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}WNh(){const wb=[];if(this.kc&&this.kc.aaa&&0<this.kc.aaa.length)for(const $b of this.kc.aaa)$b&&wb.push($b);if(this.kc&&this.kc.yL&&0<this.kc.yL.length)for(const $b of this.kc.yL)$b&&wb.push($b);wb.sort(($b,
uc)=>$b.Index-uc.Index);return wb}Q7f(){if(!this.Ae||!this.kc||!this.kc.yL)return!1;const wb=1===this.Ae.CellArea||4===this.Ae.CellType&&this.Ae.IsRowAxis,$b=4===this.Ae.CellType?0<this.kc.B7c:0<this.Ae.CurrentFieldIndex;return 1<this.kc.yL.length&&wb&&$b}lLa(wb){const $b=[];3===wb?this.$.isEditMode?$b.push(...[nb.a.jMf,nb.a.lMf,nb.a.y5i]):$b.push(...[nb.a.copy]):2===wb&&$b.push(nb.a.HBe);return $b}vj(){const wb=O.a.Zc(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");dd.a(this.$).vj(wb)}pGj(){return this.vb?
0!==this.vb.LabelOrDateFilterType||0!==this.vb.ValueFilterType||this.vb.HasManualFilter:!1}mGj(wb){return 62<=wb&&65>=wb}dzi(){if(this.activeCell&&this.vb&&this.kc){var wb={};wb.cell=this.activeCell;wb.dataSourceIndex=this.kc.externalSourceIndex;wb.fieldId=this.vb.Index.toString();wb.isOlap=this.kc.isOlap;wb.confirmationRequired=this.kc.confirmationRequiredForDataOps;var $b={};$b.showPivotFilterDialogCommandData=wb;this.$.Xc(492140419,B.a.Db,19,$b)}}e5g(wb){this.activeCell&&this.vb&&this.kc&&this.$.userOperationManager.Kc(new I.a(153,
0,($b,uc,Pc)=>L.A(this.$.pa.ya,this.activeCell,this.kc.externalSourceIndex,this.vb.Index.toString(),wb,$b,uc,Pc,null,null)),null)}qSg(wb){!(30>wb||61<wb)&&this.activeCell&&this.vb&&this.kc&&this.$.userOperationManager.Kc(new I.a(152,0,($b,uc,Pc)=>L.e(this.$.pa.ya,this.activeCell,this.kc.externalSourceIndex,this.vb.Index.toString(),wb,$b,uc,Pc,null,null)),null)}applyPivotSort(wb){if(this.kc&&this.vb&&this.activeCell&&this.Ae){var $b=1===this.Ae.CellArea||2===this.Ae.CellArea;8===this.Ae.CellArea?Od.a(this.$.userOperationManager,
(uc,Pc,Ad)=>le.b(this.$.pa.ya,this.activeCell,wb,this.vb.Caption,uc,Pc,Ad,null),uc=>new I.a(1015,0,uc,void 0,null),null):$b&&($b=1===this.Ae.CellArea?1:2,this.$.ma(682)?We.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.kc.isOlap?"":this.vb.Caption,$b,1===wb):We.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),1===
wb))}}uS(){return!this.kc||!this.kc.isActionable}TEj(){return(this.Ae||this.kc)&&4!==this.Ae.CellType&&(0!==this.Ae.CellType||8!==this.Ae.CellArea||this.kc.aaa&&this.kc.aaa.length||this.kc.yL&&this.kc.yL.length)?!1:!0}UEj(){return this.Ae&&this.kc&&(1===this.Ae.CellArea||2===this.Ae.CellArea)&&this.kc.aRb&&this.kc.aRb.length?!1:!0}Jva(wb,$b,uc,Pc,Ad){wb.buttons.push(this.Sd($b,uc,0,!1,Pc,null,null,8,null,Ad))}}Object(c.a)(Zb,"PivotTableContextMenu",z.a,[]);class Da{compare(wb,$b){return(wb||"").localeCompare($b||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(Da,"DigitsAsNumberComparer",null,[293]);var Pa=a(1081),tb=a(154),Ib=a(345),Yb=a(262),vc=a(24),Zc=a(145);const nd=r.a.b$g;class hd extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,nd,!0,!1,"TableFieldListContextMenuRoot",$b,uc,!1,Pc);this.X6b=null;this.GBd=0;this.AFa=null;this.grid=N.h(wb)}get ax(){return"PopulateTableFieldListContextMenu"}get UB(){return r.a.hRf}get nL(){this.AFa||(this.AFa=
this.$.da.za(261));return this.AFa}executeCommand(wb,$b,uc){wb=$b.command;switch(wb){case 639960842:this.applyTableFieldList(uc);this.nL.Xda();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.GBd}`);this.nL.Xda();break;case 1833782813:this.nL.showCallout();break;default:return va.a(wb)}return sb.Task.Ta(!0)}applyTableFieldList(wb){var $b=wb.MenuItemId.toString();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
($b=$b.replace("'","''"),$b=$b.replace("[","'["),$b=$b.replace("]","']"));var uc=Object(Tb.a)(String,wb.SourceControlId);const Pc={};Pc.PulloutField=$b;Pc.PulloutCardPath=wb.SourceCardKeyPath;Pc.PulloutCardSourceRow=wb.SourceCardRow;Pc.PulloutCardSourceColumn=wb.SourceCardColumn;if(this.nL.JN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Pc.ParameterType=2;wb=wb.ColumnIndex;if(void 0===wb||null===wb){if(void 0===uc||null===uc){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}wb=0<=this.nL.pPf?this.nL.pPf:parseInt(uc.substring(20+$b.length+1,uc.length),10);if(isNaN(wb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${uc}`);return}}Pc.PulloutRichColumnSourceIndex=wb;if(this.AFa.RPg){this.DQg($b,Pc);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Pc.ParameterType=4,uc=this.nL.selectedRange.right,bb.a.qAb()&&this.AFa.xxa&&(Pc.ParameterType=8,wb=this.nL.rma.top,wb=
vc.Range.QM(uc)+wb,$b==Pa.d?($b="=DAYS("+wb+", TODAY())",Zc.a("DateFormulaPulledOut_DaysFromToday")):$b==Pa.g?($b="=IF(TODAY() < "+wb+", DATEDIF(TODAY(), "+wb+', "Y"), DATEDIF('+wb+', TODAY(), "Y"))',Zc.a("DateFormulaPulledOut_YearsFromToday")):$b==Pa.c?($b="=TEXT("+wb+', "dddd")',Zc.a("DateFormulaPulledOut_DayOfWeek")):$b==Pa.f?($b="=TEXT("+wb+', "mmmm")',Zc.a("DateFormulaPulledOut_MonthOfYear")):$b==Pa.e?($b="EOMONTH("+wb+", 0)",$b="=DATE(YEAR("+$b+"), MONTH("+$b+"), DAY("+$b+"))",Zc.a("DateFormulaPulledOut_EndOfMonth")):
$b==Pa.b&&($b="="+wb+" + 1",Zc.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Pc.PulloutCardSourceColumn&&null!==Pc.PulloutCardSourceColumn&&(uc=Pc.PulloutCardSourceColumn+1),Pc.PulloutRichColumnSourceIndex=uc;this.PRd($b,Pc)}PRd(wb,$b,uc=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.GBd}, SelectedColumnIndex, ${$b.PulloutRichColumnSourceIndex}`);wb=Object(f.a)(new Yb.a,{Text:wb});this.grid.setCell(wb,this.nL.rma,0,127,$b,uc);this.grid.focus();
this.X6b=null;this.nL.Xda();this.nL.Hoj()}wc(wb,$b,uc){if(wb=this.$.isEditMode&&Y.EwaSettings.ma(135)&&!!this.nL)switch($b.command){case -1085236154:break;case 639960842:wb=!!uc;break;case 1833782813:wb=this.nL.oxa&&this.nL.dDb;break;default:wb=!1}return wb}b1(wb,$b,uc){this.$.isEditMode&&(this.X6b=this.iNh(Object(Tb.a)(276,uc)),super.b1(wb,$b,null,null,!1))}kZ(){return this.X6b}I5c(wb){if(!this.nL||!wb||!wb.$k)return d.ULS.shipAssertTag(537166994,0,!!this.nL,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!wb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),wb&&d.ULS.shipAssertTag(537166992,0,!!wb.$k,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let $b=new Jb.a;for(const Pc of wb.$k){wb=new Jb.a;wb.add(Pc.ColumnName);wb.add(Pc.ColumnIndex.toString());let Ad=new Jb.a;var uc=null;bb.a.qAb()&&this.AFa.xxa?Ad=Ja.toList(Ja.select(Ja.asEnumerable(Pc.FieldInfoDataList),ba=>ba.Name)):(uc=
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Da:new Ma.a,Ad=Ja.OBc(Ja.concat(Ad,Ja.select(Ja.asEnumerable(Pc.FieldInfoDataList),ba=>ba.Name)),ba=>ba,uc));uc=new Jb.a;uc.add(Ja.toArray(Ja.concat(wb,Ad)));$b=Ja.toList(Ja.concat($b,uc))}return Ja.toArray($b)}iNh(wb){var $b=this.I5c(wb);if(!$b||!$b.length)return this.X6b=null;wb=this.Va;const uc=wb.cq(this.menuId);let Pc=wb.Ec();const Ad=1<$b.length,ba=bb.a.qAb()&&this.AFa.xxa;this.GBd=$b.length;for(const cb of $b){ba?
Pc.title="Calculate Date Information":Ad||(Pc.title=cb[0]);$b=wb.Ec();for(let Kb=2,lc=cb.length;Kb<lc;++Kb)!ba||cb[Kb]!=Pa.d&&cb[Kb]!=Pa.e||(uc.tc.push(Pc),Pc=wb.Ec()),(Ad?$b.buttons:Pc.buttons).push(wb.LIa("ApplyTableFieldList."+cb[Kb]+"."+cb[1],cb[Kb],639960842,null,"None",cb[Kb],!1,void 0,!0));if(Ad){const Kb=wb.ww("ApplyTableFieldList."+cb[0],this.menuId,cb[0],798637440);Kb.menu.tc.push($b);Pc.buttons.push(Kb)}}uc.tc.push(Pc);return uc}DQg(wb,$b){const uc=O.a.Zc(12,1,0,899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");
if(Y.EwaSettings.Mz()){const Pc=new Ib.a(this.$,uc);Pc.LP(()=>{2===Pc.returnValue&&this.PRd(wb,$b,8)})}else{const Pc=new tb.ErrorDialog(this.$,uc);Pc.LP(()=>{2===Pc.returnValue&&this.PRd(wb,$b,8)});Pc.ug()}}}Object(c.a)(hd,"PulloutFieldListContextMenu",z.a,[]);const Ud=r.a.jRf;class ee extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateRichTextContextMenu",679816325,1151222423,Ud,!0,!1,Ud,$b,uc,!0,Pc);this.grid=N.h(wb)}get ax(){return"PopulateRichTextContextMenu"}get UB(){return r.a.jRf}wc(wb,
$b,uc){return-1687037502===$b.command&&!!uc&&this.grid.eb}executeCommand(wb,$b,uc){this.showRichTextFloatie(uc);return sb.Task.Ta(!0)}lLa(){return[nb.a.E2g]}showRichTextFloatie(wb){var $b=Object(Tb.a)(La.a,wb.eventArgs);$b&&(wb=this.lLa($b.tb),$b=new Sys.UI.Point($b.Ca.clientX,$b.Ca.clientY),this.showFloatie(wb,new Sys.UI.Bounds($b.x,$b.y,0,0),2))}}Object(c.a)(ee,"RichTextContextMenu",z.a,[]);var ec=a(99),Vc=a(573);const ud=r.a.a$g;class ke extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,ud,!0,!1,"SheetTabContextMenuRootName",$b,uc,!1,Pc);this.ekc=this.Dic=!1}get ax(){return"PopulateSheetOpsContextMenu"}get UB(){return r.a.kRf}executeCommand(wb,$b,uc){if(ib.a(this.$))return sb.Task.Ta(!0);this.$.isEditMode&&(wb=uc[r.a.H6f],wb=wb.x&&wb.y?new Sys.UI.Point(wb.x+(this.$.isChromeRtl?10:-10),wb.y):ub.DOMElementExtensions.getLocation(uc[r.a.I6f]),this.Rp(wb,!1));return sb.Task.Ta(!0)}wc(wb,$b,uc){return-1075099431===$b.command&&!!uc}kZ(){const wb=this.Va.cq(this.menuId),
$b=this.$.isEditMode;this.Z0j();this.XMh(wb,$b);this.MMh(wb);this.QNh(wb);return wb}I_b(wb,$b,uc,Pc){wb.push(this.Va.pb($b?uc:Pc))}XMh(wb,$b){var uc=this.Va;const Pc=uc.Ec();Pc.buttons.push(uc.pb(54));this.I_b(Pc.buttons,this.ekc,127,56);Pc.buttons.push(uc.pb(55));$b&&this.I_b(Pc.buttons,this.ekc,126,125);Pc.buttons.push(uc.pb(158));$b=this.$.xa.na;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.LK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
$b&&$b.Ed&&($b.Ed.Iv||$b.Ed.iI||Pc.buttons.push(uc.pb(299)));this.$.ea.eNb&&(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?m.AFrameworkApplication.Wsd(Vc.a):this.$.va.ExcelSheetProtectionSettingsEnabled)&&($b=Object(Tb.a)(ec.a,this.$.na))&&na.p($b)&&this.$.isEditMode&&(Pc.buttons.push(uc.pb(277)),$b.isLockPausedInSession?Pc.buttons.push(uc.pb(279)):$b.ki&&Pc.buttons.push(uc.pb(278)));$b=uc.ww("ContextMenu.TabColor",null,ca.a.instance.ga(518),1841703919);
uc=uc.G5c(467002767,1549407384,541,-221093529,this.UB);$b.menu.tc.push(uc);Pc.buttons.push($b);wb.tc.push(Pc)}MMh(wb){const $b=this.Va.Ec();this.I_b($b.buttons,this.ekc,114,112);this.I_b($b.buttons,!this.Dic,115,113);wb.tc.push($b)}QNh(wb){if(Y.EwaSettings.ma(476)&&!na.e(this.$.xa.na)){var $b=this.Va,uc=$b.Ec();uc.buttons.push($b.pb(263));wb.tc.push(uc)}}Z0j(){let wb,$b;({s5c:wb,oHe:$b}=this.$.r5c());this.ekc=1===wb;this.Dic=0<$b}}Object(c.a)(ke,"SheetOpsContextMenu",z.a,[]);var te=a(517);class pe extends z.a{constructor(wb,
$b,uc,Pc){super(wb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",$b,uc,!0,Pc)}get ax(){return"PopulateSlicerContextMenu"}get UB(){return r.a.lRf}nc(wb,$b){var uc=!0;switch($b){case -231711729:uc=!1;break;case -1909381757:uc=this.Tdc();uc=!!uc&&uc.cpi;break;case 1312363469:uc=!0}return!uc||super.nc(wb,$b)}executeCommand(wb,$b,uc){if(!this.$.isEditMode)return C.TaskExtensions.tba();wb=$b.command;$b=this.Tdc();let Pc=null;switch(wb){case 2108047455:$b&&
$b.EDe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:$b&&$b.w4b();break;case 1312363469:this.showSlicerContextMenu(uc);break;default:Pc=va.a(wb)}return Pc||C.TaskExtensions.tba()}wc(wb,$b,uc){wb=!1;switch($b.command){case -231711729:case 2108047455:case -1909381757:wb=!0;break;case 1312363469:wb=!!uc}return wb}kZ(){const wb=this.Va.cq(this.menuId);var $b=this.Va.Ec();$b.buttons.push(this.Va.pb(252));$b.buttons.push(this.Va.pb(253));
$b.buttons.push(this.Va.pb(254));wb.tc.push($b);$b=this.Va.Ec();this.Gui()?$b.buttons.push(this.Va.pb(266)):$b.buttons.push(this.Va.pb(267));wb.tc.push($b);return wb}Gui(){if(bb.a.gd(this.$)){var wb=this.$.da.za(439);if(wb)return wb.ps}else if(wb=this.$.da.za(371))return wb.ps;return!1}showSlicerContextMenu(wb){var $b=Object(Tb.a)(La.a,wb.eventArgs);wb=this.rcc(Object(Tb.a)(La.a,wb.eventArgs));$b=$b.tb;B.a.Db=$b;this.Rp(wb,!1,$b)}E_e(wb){const $b=this.Va.Ec(),uc=this.Va.Ec();uc.buttons.push(this.Va.pb(255));
uc.buttons.push(this.Va.pb(256));const Pc=this.Va.J5c("ContextMenu.SlicerSort",null,ca.a.instance.ga(2169),-814639094,0,za.a.HTe);Pc.menu.tc.push(uc);$b.buttons.push(Pc);wb.tc.push($b)}GGj(wb){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&wb.Gb.className===za.a.Mad||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===wb.tb}rcc(wb){var $b=N.h(this.$).ha.Ra.$b;let uc=wb&&1!==wb.tb&&
wb.clientPoint?wb.clientPoint:Sys.UI.DomElement.getLocation($b.domElement);if(this.GGj(wb)){var Pc=this.Tdc();Pc&&(wb.Gb.className===za.a.Mad&&(uc=Lb.HelperMethods.Awb(wb.Ca)),1===wb.tb&&(uc=qa.a(this.$).nka(ub.DOMElementExtensions.getLocation(Pc.frame))))}else if(wb=this.Tdc())wb=this.FWh(wb.frame),(Pc=Lb.HelperMethods.tD(this.$.uf,this.$.domElement,N.h(this.$).rtl,!1))?(wb.x=qa.a(this.$).yi(wb.x-Pc.x)+Pc.x,wb.y=qa.a(this.$).yi(wb.y-Pc.y)+Pc.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
uc.y+=wb.y,uc.x+=wb.x;wb=this.$.domElement;Pc=N.h(this.$).rtl;$b=Lb.HelperMethods.tD($b.mg.domElement,wb,Pc);uc.y=Math.max(uc.y,$b.y);uc.x=Math.max(uc.x,$b.x);return uc}Tdc(){const wb=N.h(this.$).ha.Ra.$b;d.ULS.shipAssertTag(537166988,0,!!wb);return te.a(this.$).SH(wb.floatingObject.id)}FWh(wb){let $b=new Sys.UI.Point(wb.offsetParent.offsetLeft,wb.offsetParent.offsetTop);var uc=N.h(this.$);if(!uc)return $b;const Pc=N.h(this.$).rtl;$b=Lb.HelperMethods.tD(wb,this.$.yr.ownerDocument.body,Pc);uc.gHe($b);
$b.x=Pc?this.$.yr.clientWidth-$b.x-wb.clientWidth:$b.x;wb=uc.view.lqb;uc=Pc?-uc.lS.Oca(wb.x):wb.x;$b.x-=uc;$b.y-=wb.y;return $b}}Object(c.a)(pe,"SlicerContextMenu",z.a,[]);class rf{constructor(wb,$b,uc){this.type=wb;this.Z9g=$b;this.Or=uc}}Object(c.a)(rf,"TimeSlicerRibbonButtonParameter",null,[]);class cf extends z.a{constructor(wb,$b,uc,Pc){super(wb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,cf.URj,!0,!1,cf.hLb,$b,uc,!1,Pc);this.e2a=0;this.SOe=this.uLa=this.pta=null}get ax(){return"PopulateTimeSlicerLevelMenu"}get UB(){return r.a.oRf}executeCommand(wb,
$b,uc){wb=$b.command;switch(wb){case 2000085697:wb=uc.DOMElement;this.pta=uc.ChangeLevelCallback;this.uLa=uc.GetLevelLabelCallback;this.e2a=uc.CurrentLevel;const Pc=uc.DomEvent;S.g(Pc);const Ad=uc.location;uc=uc.levelLabelText;this.SOe=ub.DOMElementExtensions.Jz(document.activeElement,"iframe")&&uc?uc.parentNode:null;uc=Sys.UI.DomElement.getBounds(uc);uc.x=Ad.x;uc.y=Ad.y;this.b1(Pc,wb,uc,$b,!0);break;case -649826274:this.pta(0);break;case 149600865:this.pta(1);break;case -2012435159:this.pta(2);break;
case -1979934975:this.pta(3);break;case 1634477200:ub.DOMElementExtensions.setFocus(this.SOe);break;default:return va.a(wb)}return sb.Task.Ta(!0)}wc(wb,$b,uc){wb=!1;switch($b.command){case 2000085697:wb=!!uc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:wb=!0}return wb}b1(wb,$b,uc){wb=Sys.UI.DomElement.getBounds($b);uc.x=qa.a(this.$).yi(uc.x);uc.y=qa.a(this.$).yi(uc.y);wb.x=qa.a(this.$).yi(wb.x);wb.y=qa.a(this.$).yi(wb.y);wb=new Sys.UI.Point(wb.x+uc.x,wb.y+
uc.y);this.showContextMenu(new Sys.UI.Bounds(wb.x,wb.y-uc.height,uc.width,uc.height))}kZ(){const wb=this.Va,$b=wb.cq(this.menuId),uc=wb.Ec();for(let Ad=0;3>=Ad;Ad++){const ba=this.uLa(Ad);var Pc=cf.JQh(Ad);Pc=wb.cbh(Pc.Z9g,Pc.Or,this.e2a===Ad,cf.DCe);Pc.label=ba;Pc.pS(ba);this.e2a===Ad?Pc.rS("Image16by16",8,cf.DCe):Pc.o4b();uc.buttons.push(Pc)}$b.tc.push(uc);return $b}static JQh(wb){let $b=null;switch(wb){case 0:$b=new rf(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:$b=new rf(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:$b=new rf(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:$b=new rf(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return $b}}cf.URj=r.a.c$g;cf.hLb="TimeSlicerLevelMenuRootName";cf.DCe=za.a.iva;Object(c.a)(cf,"TimeSlicerLevelMenu",z.a,[]);var wf=a(317),Ge=a(3);class Ue extends b.a{constructor(wb){super(wb)}nd(){const wb=this.$,$b=Fa.a.Y1a(wa.b(),this.la,"Task","IRootUser"),uc=e.a(wb);let Pc=null;Pc=(cb,Kb)=>{uc.VVf(Pc);
$b.setResult(Kb.H5b)};uc.Zre(Pc);uc.x5e();const Ad=X.GetServiceTaskFactory.create(wb.da,102,wb.la,this.Ya),ba=X.GetServiceTaskFactory.Oa(wb.da,342,338,this.Ya);C.TaskExtensions.Aa(C.TaskExtensions.Fd([$b.task,Ad,ba],this.la),()=>{const cb=Ad.result,Kb=$b.task.result,lc=ba.result;this.Yc([new dc(wb,Kb,cb,lc),new ta(wb,Kb,cb,lc),new Bc(wb,Kb,cb,lc),new Ub(wb,Kb,cb,lc),new Tc(wb,Kb,cb,lc),new ya(wb,Kb,cb,lc),new Gd.GridContextMenu(wb,Kb,cb,lc),new Wd(wb,Kb,cb,lc),new ke(wb,Kb,cb,lc),new cf(wb,Kb,cb,
lc),new hd(wb,Kb,cb,lc),new Ga(wb,Kb,cb,lc),new Zb(wb,Kb,cb,lc),new pe(wb,Kb,cb,lc),new ee(wb,Kb,cb,lc)])},wb.la,3)}static initData(){const wb=wf.a.d$;wb(2000085697,20479,0,0);wb(-227942804,Ge.a.jc|24576,0,0);wb(1634477200,Ge.a.jc|131072,0,0);wb(-649826274,4095,0,0);wb(149600865,4095,0,0);wb(-2012435159,4095,0,0);wb(-1979934975,4095,0,0);wb(1247109494,Ge.a.jc|24576,0,0);wb(-2064931494,Ge.a.jc|131072,0,0);wb(-1396319072,Ge.a.Ha,128,0);wb(-425234874,Ge.a.Ha,128,0);wb(-1253126584,Ge.a.Ha,0,0);wb(274207288,
Ge.a.jc|24576,0,0);wb(-1497523576,Ge.a.jc|131072,0,0);wb(-498523270,Ge.a.jc|24576,64,0);wb(1640762262,Ge.a.jc|131072,64,0);wb(-2017893763,Ge.a.jc|24576,0,0);wb(1350204367,Ge.a.jc|131072,0,0);wb(-889576107,Ge.a.tw,128,0);wb(-1170196828,Ge.a.tw,128,0);wb(389774337,Ge.a.tw,128,0);wb(1529312473,Ge.a.tw,128,0);wb(2033235475,Ge.a.tw,128,0);wb(-96230454,Ge.a.tw,128,0);wb(74086617,Ge.a.tw,128,0);wb(563292088,Ge.a.tw,128,0);wb(-1092351914,Ge.a.tw,128,0);wb(-2141589616,Ge.a.tw|16384,128,0);wb(745182485,Ge.a.tw,
0,0);wb(359279088,Ge.a.tw,128,0);wb(-67292059,Ge.a.tw,128,0);wb(926905850,Ge.a.tw,128,0);wb(547535945,Ge.a.tw,128,0);wb(1374696078,Ge.a.jc|24576,0,0);wb(495005930,Ge.a.jc|212992,0,0);wb(-1045020714,Ge.a.jc|24576,0,0);wb(-170383950,Ge.a.jc|212992,0,0);wb(324156914,Ge.a.Ha,0,0);wb(-1085236154,Ge.a.qv,0,0);wb(-751848458,Ge.a.Al|16384,0,0);wb(216058793,Ge.a.qv,0,0);wb(474690375,Ge.a.Al|16384,0,0);wb(-1920954846,Ge.a.jc|24576,0,0);wb(723126814,Ge.a.jc|131072,0,0);wb(2108047455,128,128,0);wb(-231711729,
128,128,0);wb(-1909381757,128,128,0);wb(-814639094,128,128,0);wb(1701016594,Ge.a.jc|3072,128,0);wb(-1475408662,Ge.a.jc|24576,0,0);wb(1114549926,Ge.a.jc|131072,32,0)}static ka(wb){b.a.Nd(10,new Ue(wb))}}Object(c.a)(Ue,"ContextMenuCommandHandlerFactory",b.a,[]);var gb=a(222),Ob=a(1400),rc=a(92),Oc=a(190);class ld{constructor(wb,$b){this.isb=$b;this.$=wb}dispose(){}waa(){this.isb.c4()}lD(){this.isb.lD()}jVd(wb,$b,uc){Ra.i(this.$,Ra.b);this.isb.showContextMenu(Object(f.a)(new Ob.a,{x:$b.x,y:$b.y}),uc,
wb);rc.EventHandlerManager.instance.Ldd()}Uzc(wb,$b,uc){Ra.i(this.$,Ra.b);this.isb.showFloatie(Object(f.a)(new Ob.a,{x:$b.x,y:$b.y}),wb,uc);Oc.a(()=>{rc.EventHandlerManager.instance.Ldd()},this.$.la)}iVd(wb,$b,uc,Pc){Ra.i(this.$,Ra.b);this.isb.iVd(Object(f.a)(new Ob.a,{x:$b.x,y:$b.y}),wb,uc,Pc)}}Object(c.a)(ld,"ReactContextMenuController",null,[260,2]);class Cd extends gb.a{constructor(wb){super();this.tef=!1;this.Rnd=()=>{let $b;($b=this.$.da.za(342))?this.ob($b):this.$.ny(uc=>{uc.ygc().then(Pc=>
{($b=this.$.da.za(342))?this.ob($b):($b=new ld(this.$,Pc),this.ob(this.$.da.Ga(342,$b)))})})};this.$=wb;this.Fb()}dispose(){this.tef&&this.$&&this.$.ea.lo(this.Rnd);super.dispose()}create(){this.$.ea.qg?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.qg}`),this.Rnd(null,null)):(this.tef=!0,this.$.ea.Kk(this.Rnd))}static ka(wb){wb.da.Ga(338,new Cd(wb))}}Object(c.a)(Cd,"ContextMenuControllerFactory",gb.a,[]);var Qd=
a(156);class re{constructor(){this.dictionary=this.Wd=null}}Object(c.a)(re,"RibbonCommandParams",null,[]);class Ie{constructor(){this.menuModel=null;this.$Je=0}}Object(c.a)(Ie,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class qf{constructor(){this.rfc={}}VQh(wb){return(wb=this.rfc[wb.toString()])?wb.menuModel:null}N_g(wb,$b){this.rfc[$b.toString()]=Object(f.a)(new Ie,{menuModel:wb,$Je:Lb.HelperMethods.Tb()})}j9b(wb){this.rfc[wb.toString()]=null}N5h(wb){return(wb=this.rfc[wb.toString()])?wb.$Je:
-1}}Object(c.a)(qf,"FilterMenuCache",null,[]);var Pe=a(14),of=a(177),Hb=a(224);class mc{constructor(){this.Cd=this.pxe=this.cell=null}}Object(c.a)(mc,"AutoFilterEventRegistrationArgs",null,[]);class Mc{constructor(wb){this.P_a=null;this.yUd=!1;this.fDb=0;this.nad=1;this.jRe=0;this.iGb=$b=>{this.HPf($b.domElement,$b.hashCode)};this.vTf=$b=>{let uc=0;for(;window.performance.now()-$b<this.luh&&0<this.P_a.length;)this.hqe(this.P_a.shift()),uc++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.nad}, Events Registered in this frame: ${uc}, Events in queue: ${this.P_a.length}`);
0<this.P_a.length?this.fDb=window.requestAnimationFrame(this.vTf):($b=window.performance.now()-this.jRe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.nad}, Total time in MS: ${$b}`),this.nad++,this.fDb=0)};this.onPointerDown=$b=>{We.a.slim($b.Ca.rawEvent);return!1};this.$=wb;this.gridView=N.h(this.$);this.Ofi();this.luh=this.$.va.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.fDb);this.gridView&&
this.gridView.Vuc(this.iGb);this.gridView=null}Ofi(){if(this.yUd=Lb.HelperMethods.$7a)this.P_a=[];this.bKg();this.gridView.f0b(this.iGb)}bKg(){for(const wb of this.gridView.Nn){const $b=wb.XCa;for(let uc in $b){const Pc=$b[uc];this.HPf(Pc.domElement,Pc.hashCode)}}}HPf(wb,$b){if(N.h(this.$).Ea.Fm.L2a($b))if(wb){wb=wb.querySelectorAll('[id^="'+r.a.ycd+'"]');for(let Ad=0;Ad<wb.length;Ad++){var uc=wb[Ad],Pc=uc.getAttribute(r.a.oHh);const ba=uc.getAttribute(r.a.hHh);d.ULS.shipAssertTag(537167053,0,!!Pc&&
!!ba,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${uc.id}, BlockHash: ${$b}`);Pc=vc.Range.Qc(parseInt(Pc,10),parseInt(ba,10));uc=Object(f.a)(new mc,{cell:Pc,pxe:uc,Cd:$b});this.yUd?(this.P_a.push(uc),this.fDb||(this.jRe=window.performance.now(),this.fDb=window.requestAnimationFrame(this.vTf))):this.hqe(uc)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${$b}`);
else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${$b}`)}hqe(wb){const $b=this.gridView.Ea.xLa(wb.cell,wb.Cd);$b?this.aKg(wb.pxe,$b):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${wb.Cd}, AutoFilter Cell: ${wb.cell}`)}aKg(wb,$b){$b.hasAutoFilter?this.$Hg(wb,
$b.kvb):$b.Z4?this.ZJg(wb,$b.kvb,$b.fsd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Qd.a.instance.ta(Pe.a.Df,wb,this.onPointerDown);of.a.instance.ta(Pe.a.aza,wb,this.onPointerDown)}$Hg(wb,$b){Hb.a.instance.ta(Pe.a.click,wb,uc=>{$b&&We.a.hrc(uc.Ca.rawEvent,966232027,$b,null);return!0})}ZJg(wb,$b,uc){const Pc=A.a.li($b);Hb.a.instance.ta(Pe.a.click,wb,Ad=>{uc?We.a.spf(document.getElementById(Pc.EwaElementId),
Pc.Cell,Pc.DataSourceIndex,Pc.FieldId,Pc.IsOlap,Pc.RequiresConfirmation,Ad.Ca.rawEvent,Pc.OptionalPivotMenuAnchor):We.a.spfm(Ad.Ca.rawEvent,Pc.RequiresConfirmation,Pc.Cell,Pc.DataSourceIndex,Pc.PivotName,Pc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Mc,"FilterMenuPointerEventsManager",null,[2]);class Rb{constructor(wb){this.vXe=null;this.$=wb;this.Z9a=new qf;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.vXe=new Mc(this.$))}dispose(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.vXe.dispose();this.$=null}sXh(wb){const $b=N.h(this.$).Ea.H$(wb,this.$.activeItemName);return $b&&$b.blockPresentInViewportTimeStamp>this.Z9a.N5h(wb.left)?$b.vs(wb).autoFilterMenu:this.Z9a.VQh(wb.left)}FUi(wb,$b,uc){this.Z9a&&this.Z9a.N_g(wb.menuModel[$b],uc)}GUi(wb){this.Z9a&&this.Z9a.j9b(wb)}}Object(c.a)(Rb,"FilterMenuManager",
null,[248,2]);var xc=a(204),ed=a(167);class xd{constructor(wb,$b,uc){this.rAc={};this.dd=!1;this.am=(Pc,Ad=null)=>{this.showContextMenu(Ad)};this.cBf=(Pc,Ad)=>{Ad.WHi===xd.E8h&&N.h(this.$).focus()};this.ZN=(Pc,Ad)=>{Pc=this.$.Ka.fba(Ad.Wd.command);(null===Pc||void 0===Pc?0:Pc.dismissesContextualUI)&&this.c4()};this.CR=()=>{this.$.da.EU(342);C.TaskExtensions.Aa(X.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),Pc=>{Pc=Pc.result;for(let Ad of this.rAc)Ad.dTf(Pc)},this.$.la)};this.$=wb;this.contextMenuController=
uc;this.u$d=new Rb(this.$);wb.da.Ga(8,this);for(uc=0;uc<$b.length;uc++)this.rAc[xd.d$g[uc]]=$b[uc];this.ha=N.h(wb).ha;this.ha.Z_b(this.am);this.$.Ka.OZa(this.cBf);Qd.a.instance.xBj();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.Asa(this.ZN);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.FY(this.CR)}get tac(){return this.u$d}Kfd(wb){return W.a.Dc(this.rAc,wb)}dispose(){this.dd?
d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.dd=!0,this.$&&(this.$.Kl(xd.ed),this.$.da.EU(8),this.ha&&this.ha.Nuc(this.am),this.$.Ka.fKb(this.cBf),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.HAa(this.ZN),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.C0(this.CR)),this.$=this.ha=null,this.tac.dispose(),
this.rAc=this.u$d=null)}showContextMenu(wb,$b=null,uc=null){this.lGj(wb)&&(Ra.i(this.$,Ra.j),wb=this.qch(wb,$b,uc),this.$.Ka.Lb(wb.Wd,wb.dictionary))}c4(){this.contextMenuController?this.contextMenuController.waa():d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}lGj(wb){return dd.a(this.$).oq()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
dd.a(this.$).BW(ed.a.grid,xc.a.showContextMenu),!1):!this.$.Ka.UEh&&(!wb||wb.Gb!==N.h(this.$).domElement&&!Re.a.equals(wb.Gb.tagName,"INPUT",!0))}qch(wb,$b=null,uc=null){uc={["eventArgs"]:wb,["creationParams"]:uc};wb=wb?wb.tb:-1;const Pc=this.ha.Ra.$b;let Ad=1441131127;Pc?($b=Pc.floatingObject,d.ULS.shipAssertTag(537167059,0,!!$b,"floatingObj shouldn't be null."),xd.ptd($b)?Ad=1312363469:xd.isPivotChart($b)?(uc[ta.b2c]=$b?$b.Vc:null,Ad=-149612405):Ad=-1372040782):xd.Nkf($b)?(uc[ta.b2c]=$b,Ad=-149612405):
!Ra.h(this.$)&&Ra.f(N.h(this.$))&&(Ad=671488277);$b=new M.a(Ad,wb,this.$.Hc,30,null);return Object(f.a)(new re,{Wd:$b,dictionary:uc})}static ka(wb){wb.nl(xd.ed)}static isPivotChart(wb){return!!wb&&0===wb.type&&xd.Nkf(wb.Vc)}static ptd(wb){return!!wb&&2===wb.type}static Nkf(wb){return!!wb&&!!(wb.Attributes&4)}}xd.d$g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
xd.E8h="GridContextMenu";xd.ed=wb=>{(wb=Object(Tb.a)(7,wb))&&X.GetServiceTaskFactory.create(wb.da,9,wb.la,0)};Object(c.a)(xd,"ContextMenuManager",null,[232,2]);class yd extends gb.a{constructor(wb){super();this.$=wb;this.Fb()}create(){const wb=this.$,$b=wb.dc;if($b.allowSelection||$b.allowEdits||$b.allowFiltering||$b.allowSorting||$b.allowPivotSpecificOperations){const uc=X.GetServiceTaskFactory.create(wb.da,10,wb.la,this.Ya),Pc=X.GetServiceTaskFactory.Oa(wb.da,342,338,this.Ya);C.TaskExtensions.Aa(C.TaskExtensions.Fd([uc,
Pc],this.la),()=>{this.ob(n.a(wb)||new xd(wb,uc.result,Pc.result))},this.$.la,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),wb.da.EU(8),this.ob(null)}static ka(wb){wb.da.Ga(9,new yd(wb))}}Object(c.a)(yd,"ContextMenuManagerFactory",gb.a,[]);var Zd=a(9);a.d(D,"a",function(){return me});const me=()=>{Ue.initData();Zd.a.Fa(wb=>{Cd.ka(wb);yd.ka(wb);Ue.ka(wb);xd.ka(wb)})}},1151:function(u,D,a){var c=
a(9);u=a(0);var b=a(692),e=a(15);const f=Za=>{switch(Za){case 0:Za="Between";break;case 1:Za="NotBetween";break;case 2:Za="Equal";break;case 3:Za="NotEqual";break;case 4:Za="GreaterThan";break;case 5:Za="LessThan";break;case 6:Za="GreaterThanOrEqual";break;case 7:Za="LessThanOrEqual";break;default:Za="Unknown"}return Za},d=Za=>{switch(Za){case 0:Za="AnyValue";break;case 1:Za="WholeNumber";break;case 2:Za="Decimal";break;case 3:Za="List";break;case 4:Za="Date";break;case 5:Za="Time";break;case 6:Za=
"TextLength";break;case 7:Za="Custom";break;default:Za="Unknown"}return Za};var h=a(132),m=a(42),l=a(371),v=a(188),t=a(283);class z{constructor(Za=null){this.t5=Za?Za.IsIgnoreBlank:!0;this.u5=Za?Za.IsInCellDropDown:!0;this.kO=Za?Za.LowerBoundary:"";this.lO=Za?Za.UpperBoundary:"";this.WB=Za?Za.ConditionType:0;this.ruleType=Za?Za.RuleType:0;this.p_=Za?Za.IsAlertBlocking:!0;this.VT=Za?Za.AlertTitle:"";this.UT=Za?Za.AlertMessage:"";this.xV=Za?Za.InputMessage:"";this.NF=Za?Za.InputTitle:"";this.S5=Za?
Za.IsShowErrorAlert:!0;this.T5=Za?Za.IsShowInputMessage:!0}isEqual(Za){return Za?this.t5===Za.t5&&this.u5===Za.u5&&this.kO===Za.kO&&this.lO===Za.lO&&this.WB===Za.WB&&this.ruleType===Za.ruleType&&this.p_===Za.p_&&this.VT===Za.VT&&this.UT===Za.UT&&this.xV===Za.xV&&this.NF===Za.NF&&this.S5===Za.S5&&this.T5===Za.T5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(u.a)(z,"DataValidationEditDialogState",null,[]);var r=a(282),n=a(183),w=a(281),
B=a(21),A=a(133),y=a(51),x=a(55);class F{constructor(Za,xa){this.hC=this.o2a=this.selectedRanges=null;this.zOe=!1;this.di=null;this.SSi=fa=>{e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!fa||r.a(fa)?e.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.o2a=fa.Result,this.o8i())};this.bFh=fa=>{this.PW("DataValidationEdit.ExpandExisitngDialog",
fa);this.hC.c=F.Oia(fa);1===fa?this.MIa(new z(this.o2a)):2===fa?this.MIa(new z):this.jsf()};this.e3i=fa=>{this.PW("DataValidationEdit.OverrideExisitngDialog",fa);this.hC.c=F.Oia(fa);1===fa?this.MIa(new z):this.jsf()};this.$=Za;this.E7c=xa}nc(){return!1}executeCommand(Za,xa){-1728432249!==xa.command&&n.a(xa.command);this.selectedRanges=m.r(B.h(this.$).ha.ra.selectedRanges,this.$);B.h(this.$).ATa(!0);this.getDataValidationInitialState();this.di=this.$.Jb.Ac("UserAction","DataValidationEditTimeToDialogOpen");
this.zOe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.zOe=!0);return x.Task.Ta(!0)}wc(Za,xa){return-1728432249===xa.command}Jc(){return!1}getDataValidationInitialState(){const Za=this.$.pa.ya.Wb();l.a(this.$.userOperationManager,(xa,fa,ua)=>t.g(this.$.pa.ya,this.selectedRanges,w.b(xa,this.SSi),w.a(fa),ua,Za),xa=>new v.a(120,0,xa,16),null)}o8i(){var Za=
this.hC={};let xa;switch(this.o2a.Command){case 0:xa="CreateNew";break;case 1:xa="CreateNewFromRule";break;case 2:xa="ExpandExisitng";break;case 3:xa="OverrideExisitng";break;default:xa="Unknown"}Za.a=xa;this.di&&(this.di.stop(),this.hC.r=this.di.id);switch(this.o2a.Command){case 0:this.hC.b=!1;this.hC.c="None";this.MIa(new z);break;case 1:this.hC.b=!1;this.hC.c="None";this.MIa(new z(this.o2a));break;case 2:this.hC.b=!0;this.E7c.lbh(this.$,this.bFh);break;case 3:this.hC.b=!0;this.E7c.nbh(this.$,this.e3i);
break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}MIa(Za){this.E7c.MIa(this.$,this.selectedRanges,Za,this.o2a.Command);this.AEi(Za)}AEi(Za){F.Ftb(Za,this.hC);this.hC.d=!0;y.b().Pe(48,this.hC,!0)}jsf(){this.hC.d=!1;y.b().Pe(48,this.hC,!0)}PW(Za,xa){Za={["ButtonType"]:F.Oia(xa),["DialogName"]:Za,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.zI};A.b(this.$).Gd(h.a.d8b,Za)}static Ftb(Za,xa){xa.e=d(Za.ruleType);
xa.f=f(Za.WB);xa.g=!!Za.kO;xa.h=!!Za.lO;xa.i=Za.t5;xa.j=Za.u5;xa.k=Za.T5;xa.l=!!Za.NF;xa.m=!!Za.xV;xa.n=Za.S5;xa.o=Za.p_;xa.p=!!Za.VT;xa.q=!!Za.UT}static Oia(Za){switch(Za){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(u.a)(F,"DataValidationEditCommandHandler",null,[165]);var I=a(134),L=a(799),X;(function(Za){Za[Za.between=0]="between";Za[Za.notBetween=
1]="notBetween";Za[Za.equal=2]="equal";Za[Za.notEqual=3]="notEqual";Za[Za.greaterThan=4]="greaterThan";Za[Za.lessThan=5]="lessThan";Za[Za.greaterThanOrEqual=6]="greaterThanOrEqual";Za[Za.lessThanOrEqual=7]="lessThanOrEqual"})(X||(X={}));Object(u.b)("DataValidationRuleConditionType",X);var P=a(1084),G=a(146),C=a(185);class H{static get ng(){return G.a.iq(H.pl,"")}static get Hmh(){return G.a.iq(H.Lmh,C.a.ga(1663),C.a.ga(1678),C.a.ga(1679),C.a.ga(1680),C.a.ga(1681),C.a.ga(1682),C.a.ga(1683),C.a.ga(1684),
C.a.ga(1685),C.a.ga(1664),C.a.ga(1688),C.a.ga(1689),C.a.ga(1690),C.a.ga(1691),C.a.ga(1692),C.a.ga(1693),C.a.ga(1694),C.a.ga(1695),C.a.ga(1665),C.a.ga(1666),C.a.ga(1686),C.a.ga(1687),C.a.ga(1677),"255")}static get Omh(){return G.a.iq(H.Mmh,C.a.ga(1700),C.a.ga(1704),C.a.ga(1705),"255","32")}static get Smh(){return G.a.iq(H.Nmh,C.a.ga(1699),C.a.ga(1702),C.a.ga(1701),C.a.ga(1703),C.a.ga(1704),C.a.ga(1705),"255","32")}}H.jdg=255;H.pl="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
H.Lmh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
H.Mmh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
H.Nmh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(u.a)(H,"DataValidationEditDialogHtml",null,[]);var J=a(85),M=a(554),S=a(14),W=a(187),O=a(238),T=a(12),Y=a(13);class va extends O.a{constructor(Za,xa,fa){super(xa);this.wFd=this.drc=this.iQa=this.Hab=this.FOa=this.E6a=this.Oza=this.Nza=this.jL=this.WT=this.qgc=this.fxa=null;this.OIh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Otj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.Bpc=ua=>{let sa=!1;(null===ua||void 0===ua?0:ua.Ca)&&(ua.Ca.keyCode===J.a.xpa||ua.Ca.keyCode===J.a.Sh)&&(sa=this.bda(ua),this.WT.blur(),this.jL.blur());return sa};this.bda=()=>{const ua=this.WT.selectedIndex,sa=this.jL.selectedIndex;this.drc.innerText=this.Swb(ua,sa);this.wFd.innerText=this.Pid(ua,sa);switch(ua){case 0:return this.jL.disabled=!0,T.DOMElementExtensions.setVisible(this.Hab,!1),T.DOMElementExtensions.setVisible(this.iQa,!1),T.DOMElementExtensions.setVisible(this.E6a,
!1),T.DOMElementExtensions.setVisible(this.FOa,!1),this.fxa.disabled=!0,!1;case 3:return this.jL.disabled=!0,T.DOMElementExtensions.setVisible(this.Hab,!0),T.DOMElementExtensions.setVisible(this.iQa,!1),T.DOMElementExtensions.setVisible(this.E6a,!0),T.DOMElementExtensions.setVisible(this.FOa,!0),this.fxa.disabled=!1;case 7:return this.jL.disabled=!0,T.DOMElementExtensions.setVisible(this.Hab,!0),T.DOMElementExtensions.setVisible(this.iQa,!1),T.DOMElementExtensions.setVisible(this.E6a,!1),T.DOMElementExtensions.setVisible(this.FOa,
!1),this.fxa.disabled=!1;default:this.fxa.disabled=!1,T.DOMElementExtensions.setVisible(this.Hab,!0),T.DOMElementExtensions.setVisible(this.FOa,!1)}switch(sa){case 0:case 1:T.DOMElementExtensions.setVisible(this.iQa,!0);break;default:T.DOMElementExtensions.setVisible(this.iQa,!1)}this.jL.disabled=!1;this.drc.disabled=!1;T.DOMElementExtensions.setVisible(this.E6a,!1);T.DOMElementExtensions.setVisible(this.FOa,!1);return!1};this.get_visible=this.wka;this.set_visible=this.moa;this.oR=new W.a;this.oR.add(Y.a.instance.ga(1665));
this.oR.add(Y.a.instance.ga(1666));this.oR.add(Y.a.instance.ga(1669));this.oR.add(Y.a.instance.ga(1667));this.oR.add(Y.a.instance.ga(1668));this.oR.add(Y.a.instance.ga(1670));this.oR.add(Y.a.instance.ga(1671));this.oR.add(Y.a.instance.ga(1672));this.oR.add(Y.a.instance.ga(1673));this.oR.add(Y.a.instance.ga(1674));this.oR.add(Y.a.instance.ga(1675));this.oR.add(Y.a.instance.ga(1676));this.oR.add("");this.$=Za;this.Sk=fa;this.Ska()}get title(){return Y.a.instance.ga(1696)}get A8g(){return this.WT.selectedIndex}oBa(Za){this.WT.selectedIndex=
Za.ruleType;this.jL.selectedIndex=Za.WB;this.qgc.checked=Za.u5;this.fxa.checked=Za.t5;this.Nza.value=Za.kO;this.Oza.value=Za.lO;this.bda(null)}Dqb(Za){Za.t5=this.fxa.checked;Za.u5=this.qgc.checked;Za.WB=this.jL.selectedIndex;Za.ruleType=this.WT.selectedIndex;Za.kO=this.Nza.value;Za.lO=this.Oza.value}dispose(){this.$j();this.Sk=this.wFd=this.drc=this.iQa=this.Hab=this.FOa=this.E6a=this.qgc=this.Oza=this.Nza=this.jL=this.WT=this.fxa=null;super.dispose()}render(Za){Za.appendChild(this.domElement)}wka(){return this.isVisible}moa(Za){return this.isVisible=
Za}setFocus(){}Swb(Za,xa){return this.s5e(Za,xa,this.OIh)}Pid(Za,xa){return 0!==xa&&1!==xa?"":this.s5e(Za,xa,this.Otj)}Ska(){this.domElement.innerHTML=H.Hmh;this.fxa=T.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.WT=T.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.jL=T.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Nza=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.Oza=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.drc=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.wFd=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.E6a=T.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.FOa=T.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.Hab=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.iQa=T.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.qgc=T.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Kj()}s5e(Za,xa,fa){return fa.length<Za||fa[Za].length<xa?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${Za} operatorOption=${xa}, cannot get label.`),""):this.oR.oa(fa[Za][xa])}Kj(){M.a.instance.ta(S.a.Ob,this.WT,this.Bpc);M.a.instance.ta(S.a.Ob,this.jL,
this.Bpc);M.a.instance.ta(S.a.change,this.WT,this.bda);M.a.instance.ta(S.a.change,this.jL,this.bda);M.a.instance.ta(S.a.change,this.jL,this.Sk);M.a.instance.ta(S.a.change,this.WT,this.Sk);M.a.instance.ta(S.a.change,this.Nza,this.Sk);M.a.instance.ta(S.a.Ob,this.Nza,this.Sk);M.a.instance.ta(S.a.change,this.Oza,this.Sk);M.a.instance.ta(S.a.Ob,this.Oza,this.Sk)}$j(){M.a.instance.Ba(S.a.Ob,this.WT,this.Bpc);M.a.instance.Ba(S.a.Ob,this.jL,this.Bpc);M.a.instance.Ba(S.a.change,this.WT,this.bda);M.a.instance.Ba(S.a.change,
this.jL,this.bda);M.a.instance.Ba(S.a.change,this.jL,this.Sk);M.a.instance.Ba(S.a.change,this.WT,this.Sk);M.a.instance.Ba(S.a.change,this.Nza,this.Sk);M.a.instance.Ba(S.a.Ob,this.Nza,this.Sk);M.a.instance.Ba(S.a.change,this.Oza,this.Sk);M.a.instance.Ba(S.a.Ob,this.Oza,this.Sk)}static Sja(){let Za;return Za=new W.a,Za.add("operatorInputId1"),Za.add("operatorInputId2"),Za}}Object(u.a)(va,"DataValidationEditConditionsControl",O.a,[296,2,299]);var ca=a(60);const V=(Za,xa,fa,ua,sa,sb,hb,bb=null)=>{bb=
Za.Na(9,bb);bb.selectedRanges=xa;bb.ruleOptions=fa;return ca.g(Za,"CreateOrEditDataValidation",bb,ua,sa,sb,hb,0)};var ra=a(29),N=a(22),ea=a(173);class Ba extends L.a{constructor(Za,xa,fa,ua){super(Za);this.mQd=this.tvb=null;this.iOa=this.disposed=this.hla=!1;this.di=null;this.e3j=(sa,sb)=>{let hb;this.zcc(sa);if(({errorString:sa,Qq:hb}=this.s2d()).returnValue)return this.TMa(121,this.BTh(this.$,sb),0,this.bca,!1),"";this.Xla("OkInvalidByClient",hb);return sa};this.D7c=sa=>{this.PW(sa);this.di=this.$.Jb.Ac("UserAction",
"DataValidationEditTimeToDialogTryClose");0===sa&&this.Cma()};this.selectedRanges=xa;this.NTb=fa;this.command=ua;3===ua&&(this.hla=!0);this.Rb=2;this.cw=!1}get yd(){return this.NTb}get pc(){return"DataValidationEditDialog"}VVd(){var Za={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.WB,["OperatorInput1"]:this.yd.kO,["OperatorInput2"]:this.yd.lO,["IsIgnoreBlank"]:this.yd.t5,["IsInCellDropDown"]:this.yd.u5,["IsAlertBlocking"]:this.yd.p_,["AlertTitle"]:this.yd.VT,["AlertMessage"]:this.yd.UT,
["InputTitle"]:this.yd.NF,["InputMessage"]:this.yd.xV,["IsShowErrorAlert"]:this.yd.S5,["IsShowInputMessage"]:this.yd.T5};this.oc(2,Y.a.instance.ga(1662));Za={[Ba.vu]:this.pc,["validateDialogValues"]:this.e3j,["RangePickerController"]:B.h(this.$).Gf.Edc(),["isModal"]:!1,["bodyProps"]:Za};this.initializeAndShow(Y.a.instance.ga(1661),this.D7c,Za);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get H3b(){return 3===
this.yd.ruleType}Sja(){return va.Sja()}BTh(Za,xa){return(fa,ua,sa)=>{const sb=Za.pa.ya.Wb();return V(this.$.pa.ya,this.selectedRanges,this.TYg(),this.R0a(fa,this.UCd(xa)),w.a(ua),sa,sb)}}UCd(Za){return xa=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let fa;r.a(xa)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${xa?ra.a.sc(xa.Errors):null}.`),xa.Errors&&1===xa.Errors.length&&
((fa=this.Xfd(xa.Errors[0].MessageId))?this.Xla("OkInvalidByServer",xa.Errors[0].MessageIdName):(this.Xla("OkValid","None"),this.hide()),Za(fa)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ra.a.sc(xa.Errors)}`)):this.hide()}}TYg(){const Za={};Za.Command=this.command;Za.RuleType=this.yd.ruleType;Za.ConditionType=this.yd.WB;Za.IsIgnoreBlank=this.yd.t5;Za.IsInCellDropDown=this.yd.u5;Za.LowerBoundary=this.yd.kO;Za.UpperBoundary=
this.yd.lO;Za.IsAlertBlocking=this.yd.p_;Za.IsShowErrorAlert=this.yd.S5;Za.IsShowInputMessage=this.yd.T5;Za.AlertTitle=this.yd.VT;Za.AlertMessage=this.yd.UT;Za.InputTitle=this.yd.NF;Za.InputMessage=this.yd.xV;Za.ShouldIgnoreFormulaError=this.iOa;return Za}Xfd(Za){switch(Za){case 1173235830:return Y.a.instance.ga(1711);case 43935303:return Y.a.instance.ga(1712);case -1323438439:return Y.a.instance.ga(1714);case 2112020473:return Y.a.instance.ga(1708);case -219503282:return Y.a.instance.ga(1709);case 1689335445:return Y.a.instance.ga(1710);
case 2146493810:return Y.a.instance.ga(1713);case -2104909922:return String.format(Y.a.instance.nb(105),this.tvb,this.mQd);case -869372599:return String.format(Y.a.instance.nb(104),this.tvb);case -1181828368:return Y.a.instance.ga(1716);case -758480861:return Y.a.instance.ga(1717);case -13729088:return Y.a.instance.ga(1718);case -846654055:return Y.a.instance.ga(1719);case 751854001:return Y.a.instance.ga(1720);case -453846397:return Y.a.instance.ga(1721);case 1102013489:return Y.a.instance.ga(1722);
case 835813260:return Y.a.instance.ga(1723);case 1577787509:return Y.a.instance.ga(1724);case 2083564019:return Y.a.instance.ga(1715);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${Za.toString()}.`)}return null}Cma(){this.Xla("Cancel","None")}PW(Za){e.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===Za?"Ok":"Cancel"} was clicked.`);Za={["ButtonType"]:Ba.Oia(Za),["DialogName"]:this.pc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.zI};A.b(this.$).Gd(h.a.d8b,Za)}Xla(Za,xa){const fa={};Ba.Ftb(this.yd,fa);fa.o=Za;fa.p=xa;fa.n=this.hla;this.di&&(this.di.stop(),fa.q=this.di.id);y.b().Pe(49,fa,!0)}zcc(Za){this.yd.ruleType=Za.RuleType;this.yd.WB=Za.RuleOperatorType;this.yd.kO=Za.OperatorInput1;this.yd.lO=Za.OperatorInput2;this.yd.p_=Za.IsAlertBlocking;this.yd.S5=Za.IsShowErrorAlert;this.yd.VT=Za.AlertTitle;this.yd.UT=Za.AlertMessage;this.yd.T5=Za.IsShowInputMessage;this.yd.NF=Za.InputTitle;
this.yd.xV=Za.InputMessage;this.yd.t5=Za.IsIgnoreBlank;this.yd.u5=Za.IsInCellDropDown;this.tvb=Za.firstOperatorLabel;this.mQd=Za.secondOperatorLabel}XQb(Za,xa,fa){let ua,sa;sa=ua=null;if(!Za)return fa?(ua=String.format(Y.a.instance.nb(105),this.tvb,this.mQd),sa="DataValidationEditNoMinMaxError"):(ua=String.format(Y.a.instance.nb(104),this.tvb),sa="DataValidationEditNoValueError"),{returnValue:!1,errorString:ua,Qq:sa};if(Za.length>H.jdg)return ua=Y.a.instance.ga(1715),{returnValue:!1,errorString:ua,
Qq:sa};if(ea.d(Za))return{returnValue:!0,errorString:ua,Qq:sa};if(1===xa||2===xa||6===xa){if(!N.a.E5(Za))return ua=Y.a.instance.ga(1708),{returnValue:!1,errorString:ua,Qq:sa};if(1===xa&&!N.a.isInteger(Za))return ua=Y.a.instance.ga(1709),{returnValue:!1,errorString:ua,Qq:sa};if(6===xa){if(!N.a.isInteger(Za))return ua=Y.a.instance.ga(1709),{returnValue:!1,errorString:ua,Qq:sa};if(0>parseInt(Za,10))return ua=Y.a.instance.ga(1710),{returnValue:!1,errorString:ua,Qq:sa}}}return{returnValue:!0,errorString:ua,
Qq:sa}}s2d(){let Za,xa;xa=Za=null;const fa=this.yd.kO,ua=this.yd.lO,sa=P.a[this.yd.ruleType];var sb=X[this.yd.WB];if(0===sa)return{returnValue:!0,errorString:Za,Qq:xa};sb=(0===sb||1===sb)&&3!==sa&&7!==sa;return!({errorString:Za,Qq:xa}=this.XQb(fa,sa,sb)).returnValue||sb&&!({errorString:Za,Qq:xa}=this.XQb(ua,sa,sb)).returnValue?{returnValue:!1,errorString:Za,Qq:xa}:sb&&(1===sa||2===sa||6===sa)&&!ea.d(fa)&&!ea.d(ua)&&parseFloat(fa)>parseFloat(ua)?(Za=Y.a.instance.ga(1713),{returnValue:!1,errorString:Za,
Qq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:Za,Qq:xa}}static Oia(Za){switch(Za){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Ftb(Za,xa){xa.a=d(Za.ruleType);xa.b=f(Za.WB);xa.c=!!Za.kO;xa.d=!!Za.lO;xa.e=Za.t5;xa.f=Za.u5;xa.g=Za.T5;xa.h=!!Za.NF;xa.i=!!Za.xV;xa.j=Za.S5;xa.k=Za.p_;xa.l=!!Za.VT;xa.m=!!Za.UT}}Object(u.a)(Ba,
"DataValidationEditDialog",L.a,[]);var ka=a(87);L=a(261);class Ka{}Ka.sjh="DataValidationDialogPanel";Ka.rjh="DataValidationButtonPanel";Ka.qjh="DataValidationButtonClearAll";Object(u.a)(Ka,"CssClassNames",null,[]);class Oa extends O.a{constructor(Za,xa){super(Za);this.Iba=this.Jba=this.Hba=null;this.Dpc=()=>{this.Hba.checked?(this.Jba.disabled=!1,this.Iba.disabled=!1):(this.Jba.disabled=!0,this.Iba.disabled=!0);return!1};this.get_visible=this.wka;this.set_visible=this.moa;this.Sk=xa;this.Ska()}get title(){return Y.a.instance.ga(1698)}render(Za){Za.appendChild(this.domElement)}wka(){return this.isVisible}moa(Za){return this.isVisible=
Za}setFocus(){}dispose(){this.$j();this.Sk=this.Jba=this.Iba=this.Hba=null;super.dispose()}Ska(){this.domElement.innerHTML=H.Omh;this.Hba=T.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");T.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Jba=T.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Iba=T.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Hba.checked=!0;this.Kj();this.Dpc(null)}oBa(Za){this.Jba.value=
void 0===Za.NF||null===Za.NF?"":Za.NF;this.Iba.value=void 0===Za.xV||null===Za.xV?"":Za.xV;this.Hba.checked=Za.T5;this.Dpc(null)}Dqb(Za){Za.NF=this.Jba.value;Za.xV=this.Iba.value;Za.T5=this.Hba.checked}Kj(){M.a.instance.ta(S.a.change,this.Hba,this.Dpc);M.a.instance.ta(S.a.change,this.Hba,this.Sk);M.a.instance.ta(S.a.change,this.Jba,this.Sk);M.a.instance.ta(S.a.Ob,this.Jba,this.Sk);M.a.instance.ta(S.a.change,this.Iba,this.Sk);M.a.instance.ta(S.a.Ob,this.Iba,this.Sk)}$j(){M.a.instance.Ba(S.a.change,
this.Hba,this.Dpc);M.a.instance.Ba(S.a.change,this.Hba,this.Sk);M.a.instance.Ba(S.a.change,this.Jba,this.Sk);M.a.instance.Ba(S.a.Ob,this.Jba,this.Sk);M.a.instance.Ba(S.a.change,this.Iba,this.Sk);M.a.instance.Ba(S.a.Ob,this.Iba,this.Sk)}}Object(u.a)(Oa,"DataValidationEditInputControl",O.a,[296,2,298]);class wa extends O.a{constructor(Za,xa){super(Za);this.q$=this.r$=this.vVa=this.Jha=this.p$=null;this.Cpc=()=>{this.p$.checked?(this.Jha.disabled=!1,this.vVa.disabled=!1,this.r$.disabled=!1,this.q$.disabled=
!1):(this.Jha.disabled=!0,this.vVa.disabled=!0,this.r$.disabled=!0,this.q$.disabled=!0);return!1};this.get_visible=this.wka;this.set_visible=this.moa;this.Sk=xa;this.Ska()}get title(){return Y.a.instance.ga(1697)}render(Za){Za.appendChild(this.domElement)}wka(){return this.isVisible}moa(Za){return this.isVisible=Za}setFocus(){}dispose(){this.$j();this.Sk=this.r$=this.q$=this.vVa=this.Jha=this.p$=null;super.dispose()}Ska(){this.domElement.innerHTML=H.Smh;this.p$=T.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.Jha=T.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.vVa=T.DOMElementExtensions.getElementById(this.domElement,"warningId");this.r$=T.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.q$=T.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.p$.checked=!0;this.Jha.checked=!0;this.Kj();this.Cpc(null)}oBa(Za){this.Jha.checked=Za.p_;this.vVa.checked=!Za.p_;this.r$.value=void 0===Za.VT||null===
Za.VT?"":Za.VT;this.q$.value=void 0===Za.UT||null===Za.UT?"":Za.UT;this.p$.checked=Za.S5;this.Cpc(null)}Dqb(Za){Za.VT=this.r$.value;Za.UT=this.q$.value;Za.p_=this.Jha.checked;Za.S5=this.p$.checked}Kj(){M.a.instance.ta(S.a.change,this.p$,this.Cpc);M.a.instance.ta(S.a.change,this.p$,this.Sk);M.a.instance.ta(S.a.change,this.Jha,this.Sk);M.a.instance.ta(S.a.change,this.vVa,this.Sk);M.a.instance.ta(S.a.change,this.r$,this.Sk);M.a.instance.ta(S.a.Ob,this.r$,this.Sk);M.a.instance.ta(S.a.change,this.q$,this.Sk);
M.a.instance.ta(S.a.Ob,this.q$,this.Sk)}$j(){M.a.instance.Ba(S.a.change,this.p$,this.Cpc);M.a.instance.Ba(S.a.change,this.p$,this.Sk);M.a.instance.ta(S.a.change,this.Jha,this.Sk);M.a.instance.ta(S.a.change,this.vVa,this.Sk);M.a.instance.Ba(S.a.change,this.r$,this.Sk);M.a.instance.Ba(S.a.Ob,this.r$,this.Sk);M.a.instance.Ba(S.a.change,this.q$,this.Sk);M.a.instance.Ba(S.a.Ob,this.q$,this.Sk)}}Object(u.a)(wa,"DataValidationEditMessagesControl",O.a,[296,2,297]);class qa{constructor(Za,xa){this.options=
this.cellRange=null;this.cellRange=Za;this.options=xa}}Object(u.a)(qa,"MacroRecorderRangeDataValidationChangedPayload",null,[125]);var aa=a(1237);class ia extends L.a{constructor(Za,xa,fa,ua){super(Za);this.K3=this.Pgc=this.jnc=this.TEb=null;this.iOa=this.disposed=this.hla=!1;this.di=null;this.UCd=sa=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(r.a(sa)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${sa?ra.a.sc(sa.Errors):null}.`);if(sa.Errors&&1===sa.Errors.length){const sb=sa.Errors[0].MessageId,hb=this.Xfd(sb);if(hb){this.XGj(sb)?this.gCj(hb):this.Rr(hb);this.Xla("OkInvalidByServer",sa.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${ra.a.sc(sa.Errors)}`)}this.Xla("OkValid",
"None");this.hide()}};this.D7c=sa=>{this.PW(sa);2!==sa&&(this.di=this.$.Jb.Ac("UserAction","DataValidationEditTimeToDialogTryClose"));1===sa?this.nab():2===sa?this.sza():this.Cma()};this.bda=()=>{this.lZj();this.iOa?this.vDe():this.eDe();return this.hla=!1};this.selectedRanges=xa;this.NTb=fa;this.command=ua;3===ua&&(this.hla=!0);this.Rb=2;this.cw=!1;this.ng=H.ng}get yd(){return this.NTb}get pc(){return"DataValidationEditDialog"}VVd(){const Za={["key"]:this.yd};this.initializeAndShow(Y.a.instance.ga(1661),
this.D7c,Za);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.Pgc=this.jnc=this.K3=null,ka.a.Ia(this.TEb),this.TEb=null,A.b(this.$)&&A.b(this.$).wXd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get By(){return()=>{this.PW(1);this.nab()}}Qv(Za){super.Qv(Za);this.oc(2,Y.a.instance.ga(1662));Za=this.rK(2);var xa=this.rK(1),fa=this.rK(0),ua=xa.parentNode;ua.appendChild(Za);ua.appendChild(xa);ua.appendChild(fa);
Za.parentNode.classList.add(Ka.rjh);Za.classList.add(Ka.qjh);Za=document.getElementById("dataValidationTabsId");xa=new va(this.$,document.createElement("div"),this.bda);fa=new Oa(document.createElement("div"),this.bda);ua=new wa(document.createElement("div"),this.bda);this.Lii(xa,fa,ua);let sa;this.TEb=new aa.a(Za,(sa=new W.a,sa.add(xa),sa.add(fa),sa.add(ua),sa));this.TEb.tWf();this.UU=document.getElementById("validationErrorMessageId");this.oBa();A.b(this.$)&&A.b(this.$).eXd("DataValidationDialogCorellation")}YI(){super.YI();
document.getElementById(this.mi("WACDialogPanel")).classList.add(Ka.sjh)}get TY(){return!1}get H3b(){return 3===this.K3.A8g}Sja(){return va.Sja()}ogd(){return"validationErrorMessageId"}Lii(Za,xa,fa){this.K3=Za;this.Pgc=xa;this.jnc=fa}Ouj(){const Za={};Za.IsClearAll=this.hla;Za.Command=this.command;Za.RuleType=this.yd.ruleType;Za.ConditionType=this.yd.WB;Za.IsIgnoreBlank=this.yd.t5;Za.IsInCellDropDown=this.yd.u5;Za.LowerBoundary=this.yd.kO;Za.UpperBoundary=this.yd.lO;Za.IsAlertBlocking=this.yd.p_;
Za.IsShowErrorAlert=this.yd.S5;Za.IsShowInputMessage=this.yd.T5;Za.AlertTitle=this.yd.VT;Za.AlertMessage=this.yd.UT;Za.InputTitle=this.yd.NF;Za.InputMessage=this.yd.xV;Za.ShouldIgnoreFormulaError=this.iOa;const xa=this.$.pa.ya.Wb(),fa=()=>new qa(this.selectedRanges,Za);l.a(this.$.userOperationManager,(ua,sa,sb)=>V(this.$.pa.ya,this.selectedRanges,Za,w.b(ua,this.UCd),w.a(sa),sb,xa),ua=>new v.a(121,0,ua,void 0,fa),null)}XGj(Za){return 1577787509===Za}gCj(Za){this.UU.innerText=Za;this.VI(this.rK(0));
this.iOa=!0}vDe(){this.iOa=!1;this.UU.innerText=""}Xfd(Za){switch(Za){case 1173235830:return Y.a.instance.ga(1711);case 43935303:return Y.a.instance.ga(1712);case -1323438439:return Y.a.instance.ga(1714);case 2112020473:return Y.a.instance.ga(1708);case -219503282:return Y.a.instance.ga(1709);case 1689335445:return Y.a.instance.ga(1710);case 2146493810:return Y.a.instance.ga(1713);case -2104909922:return String.format(Y.a.instance.nb(105),this.K3.Swb(this.yd.ruleType,this.yd.WB),this.K3.Pid(this.yd.ruleType,
this.yd.WB));case -869372599:return String.format(Y.a.instance.nb(104),this.K3.Swb(this.yd.ruleType,this.yd.WB));case -1181828368:return Y.a.instance.ga(1716);case -758480861:return Y.a.instance.ga(1717);case -13729088:return Y.a.instance.ga(1718);case -846654055:return Y.a.instance.ga(1719);case 751854001:return Y.a.instance.ga(1720);case -453846397:return Y.a.instance.ga(1721);case 1102013489:return Y.a.instance.ga(1722);case 835813260:return Y.a.instance.ga(1723);case 1577787509:return Y.a.instance.ga(1724);
case 2083564019:return Y.a.instance.ga(1715);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${Za.toString()}.`)}return null}nab(){e.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.zcc();let Za,xa;if(!({errorString:Za,Qq:xa}=this.s2d()).returnValue)return this.Rr(Za),this.Xla("OkInvalidByClient",xa),!1;this.Ouj();return!0}Cma(){this.zcc();this.Xla("Cancel","None");this.hide()}sza(){e.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.iOa?this.vDe():this.eDe();this.noj();this.hla=!0}PW(Za){Za={["ButtonType"]:ia.Oia(Za),["DialogName"]:this.pc,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.zI};A.b(this.$).Gd(h.a.d8b,Za)}noj(){this.NTb=new z;this.oBa()}oBa(){this.jnc.oBa(this.yd);this.Pgc.oBa(this.yd);this.K3.oBa(this.yd)}zcc(){this.K3.Dqb(this.yd);this.jnc.Dqb(this.yd);this.Pgc.Dqb(this.yd)}Xla(Za,xa){const fa={};ia.Ftb(this.yd,fa);fa.o=Za;
fa.p=xa;fa.n=this.hla;this.di&&(this.di.stop(),fa.q=this.di.id);y.b().Pe(49,fa,!0)}XQb(Za,xa){let fa,ua;ua=fa=null;if(!Za)return xa?(fa=String.format(Y.a.instance.nb(105),this.K3.Swb(this.yd.ruleType,this.yd.WB),this.K3.Pid(this.yd.ruleType,this.yd.WB)),ua="DataValidationEditNoMinMaxError"):(fa=String.format(Y.a.instance.nb(104),this.K3.Swb(this.yd.ruleType,this.yd.WB)),ua="DataValidationEditNoValueError"),{returnValue:!1,errorString:fa,Qq:ua};if(Za.length>H.jdg)return fa=Y.a.instance.ga(1715),{returnValue:!1,
errorString:fa,Qq:ua};if(ea.d(Za))return{returnValue:!0,errorString:fa,Qq:ua};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!N.a.E5(Za))return fa=Y.a.instance.ga(1708),{returnValue:!1,errorString:fa,Qq:ua};if(1===this.yd.ruleType&&!N.a.isInteger(Za))return fa=Y.a.instance.ga(1709),{returnValue:!1,errorString:fa,Qq:ua};if(6===this.yd.ruleType){if(!N.a.isInteger(Za))return fa=Y.a.instance.ga(1709),{returnValue:!1,errorString:fa,Qq:ua};if(0>parseInt(Za,10))return fa=Y.a.instance.ga(1710),
{returnValue:!1,errorString:fa,Qq:ua}}}return{returnValue:!0,errorString:fa,Qq:ua}}s2d(){let Za,xa;xa=Za=null;if(this.hla||0===this.yd.ruleType)return{returnValue:!0,errorString:Za,Qq:xa};const fa=(0===this.yd.WB||1===this.yd.WB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:Za,Qq:xa}=this.XQb(this.yd.kO,fa)).returnValue||fa&&!({errorString:Za,Qq:xa}=this.XQb(this.yd.lO,fa)).returnValue?{returnValue:!1,errorString:Za,Qq:xa}:fa&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&
!ea.d(this.yd.kO)&&!ea.d(this.yd.lO)&&parseFloat(this.yd.kO)>parseFloat(this.yd.lO)?(Za=Y.a.instance.ga(1713),{returnValue:!1,errorString:Za,Qq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:Za,Qq:xa}}set By(Za){super.By=Za}static Oia(Za){switch(Za){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Ftb(Za,xa){xa.a=
d(Za.ruleType);xa.b=f(Za.WB);xa.c=!!Za.kO;xa.d=!!Za.lO;xa.e=Za.t5;xa.f=Za.u5;xa.g=Za.T5;xa.h=!!Za.NF;xa.i=!!Za.xV;xa.j=Za.S5;xa.k=Za.p_;xa.l=!!Za.VT;xa.m=!!Za.UT}}Object(u.a)(ia,"DataValidationEditDialogDeprecated",L.a,[]);var Ha=a(1);class Z{MIa(Za,xa,fa,ua){Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new Ba(Za,xa,fa,ua)).VVd():(new ia(Za,xa,fa,ua)).VVd()}lbh(Za,xa){const fa=new I.StandardDialog;fa.Rb=3;fa.JBa(Za.rb.Lva,Y.a.instance.ga(1706),xa)}nbh(Za,
xa){const fa=new I.StandardDialog;fa.Rb=1;fa.oX(Za.rb.Lva,Y.a.instance.ga(1707),xa)}}Object(u.a)(Z,"DataValidationEditDialogFactory",null,[257]);class la extends b.a{constructor(Za){super(Za)}nd(){this.Yc([new F(this.$,new Z)])}static ka(Za){b.a.Nd(245,new la(Za))}}Object(u.a)(la,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(D,"a",function(){return Xa});const Xa=()=>{c.a.Fa(la.ka)}},1154:function(u,D,a){function c(Ja,Ga,La,nb,Lb,ac){if(0===nb)return Object(aa.a)(ha.UnsupportedZeroResize);
if(0>nb||0===La.length)return Object(aa.a)(ha.InvalidInput);if(Ja.Ybi())return Object(aa.a)(ha.UnsupportedSkeletonInView);const ib=Ja.Xd;if(!ib)return Object(aa.a)(ha.NullSPD);var Ra=ib.C3e(La);if(Ra&&0<Ra.length)return Object(aa.a)(Ra.length.toString()+" "+ha.UnsupportedHiddenInRange);a:{for(const Va of La)Lb?Va.right=V.a.qh:Va.bottom=V.a.eh;Ra=Ja.laa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",La);try{for(Ra.$$rst();Ra.$$mn();)if(Ra.ao.fMj){var ya=!0;break a}}finally{Ra&&Ra.dispose()}ya=
!1}if(ya)return Object(aa.a)(ha.UnsupportedMergeCell);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Lb&&"undefined"!==typeof gridRenderer)for(const Va of La)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Va.left);Ja=Ja.Ea;ya=za.a.create().toString();ib.jjg(La,nb,Lb);ac=Ja.VYj(Lb,ac);Ga.pej(La,Lb);Ja.uaj(ac,ya,Lb?"row":"column");return Object(aa.d)(nb)}var b=a(9);u=a(0);var e=a(222),f=a(7),d=a(15),h=a(87);a(263);var m=a(187),l=a(416),v=a(82),
t=a(774),z=a(186),r=a(266),n=a(24),w=a(870),B=a(42);class A{}A.XLh="GalleryGeneral";A.ZLh="GalleryNumber";A.VLh="GalleryCurrency";A.TLh="GalleryAccounting";A.bMh="GalleryShortDate";A.YLh="GalleryLongDate";A.dMh="GalleryTime";A.$Lh="GalleryPercentage";A.WLh="GalleryFraction";A.aMh="GalleryScientific";A.cMh="GalleryText";A.e_g="ButtonComma";A.buttonPercentage="ButtonPercentage";A.keyboardNumber="KeyboardNumber";A.keyboardCurrency="KeyboardCurrency";A.keyboardDate="KeyboardDate";A.keyboardTime="KeyboardTime";
A.keyboardPercentage="KeyboardPercentage";Object(u.a)(A,"RibbonFormatKind",null,[]);var y=a(60),x=a(294),F=a(618),I=a(617),L=a(616);class X extends x.a{constructor(Ja,Ga,La,nb,Lb,ac,ib,Ra,ya,Va,oa,kb=null,Sa=null){super(11,0,Ra,oa);this.sKh=Ja;this.Qdd=Ga;this.format=nb;this.activeCell=La;this.Ive=Lb;this.pMf=ac;this.kMf=ib;this.jGa=ya;this.clientCorrelationId=Va;this.Xmb=kb;this.ojb=Sa}get Yt(){return this.Xmb}get Oaa(){return this.ojb}get GEc(){return this.jGa}n3(Ja){return super.n3(Ja)||this.sKh.n3(this.Qdd,
this.activeCell,this.format,this.Ive,this.pMf,this.kMf,this.Y0b,this.jGa,this.clientCorrelationId,this.Xmb,this.ojb)}ek(){const Ja=[];if(this.Fec)for(const Ga of this.Fec)Ja.push(L.a(Ga));else Ja.push(new I.a(this.format,this.Qdd,this.activeCell));return()=>new F.a(Ja)}Rfb(){const Ja={OperationType:0};Ja.FormatCellsMultiRange=this.Qdd;Ja.ActiveCell=this.activeCell;Ja.Format=this.format;Ja.ApplyFormatOnPivotTableValueField=this.Ive;Ja.PivotTableXluid=this.pMf;Ja.PivotTableFieldCaption=this.kMf;return Ja}}
Object(u.a)(X,"FormatCellsBatchOperation",x.a,[]);var P=a(33),G=a(207);class C{}C.editCell="Edited";C.dependentCell="Dependents";Object(u.a)(C,"RecalcPriorityGroupType",null,[]);var H=a(198),J=a(1);const M=Ja=>{switch(Ja.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},S=Ja=>{if(Ja=Ja.color){if("String"===Object.getType(Ja).getName())return H.a.xp(Ja);
if("Number"===Object.getType(Ja).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},W=(Ja,Ga)=>{Ja=excelOnlineCalc.calc.getCellValueKind(Ja.rangeDelta.data.value);switch(Ja){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;Ga.numberOfUnsupportedErrorCellTypes++;
return!1;case "Rich":return Ga.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${Ja}`),!1}},O=Ja=>{Ja=excelOnlineCalc.calc.getCellValueKind(Ja.rangeDelta.data.value);let Ga=0;switch(Ja){case "number":Ga=1;break;case "string":Ga=2;break;case "boolean":Ga=3;break;case "Error":Ga=4;break;case "Blank":Ga=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${Ja}`)}return Ga},
T=Ja=>{const Ga=Ja.value;switch(Ja.type){case 2:return void 0===Ga||null===Ga?"":Ga;case 1:return Ja=parseFloat(Ga),isNaN(Ja)?null:Ja;case 3:return Ja=parseFloat(Ga),isNaN(Ja)?null:1===Ja;case 4:return Ja=parseFloat(Ga),isNaN(Ja)?null:excelOnlineCalc.calc.errorValue(Ja);default:return excelOnlineCalc.calc.blankValue}},Y=(Ja,Ga)=>{const La=va(Ga);var nb=!(void 0===Ga.rangeDelta.data.format||null===Ga.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===La||!nb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Ga.priorityGroup}`);
Ja=Math.max(Ja.cell.Ek,0);nb&&(nb=excelOnlineCalc.calc.getCellFormatKind(Ga.rangeDelta.data.format.format),"number"===nb?Ja=Ga.rangeDelta.data.format.format:"string"===nb?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===nb?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return Ja},va=Ja=>{if(Ja.priorityGroup===C.editCell)return 0;if(Ja.priorityGroup===C.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},ca=Ja=>{Ja=va(Ja);if(0===Ja)return 1;if(1===Ja)return 2;d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var V=a(8);class ra{constructor(Ja=0,Ga="",La=0,nb="",Lb=""){this.PJ=Ja;this.cellValue=Ga;this.ifmt=
La;this.priorityGroup=nb;this.iy=Lb}}Object(u.a)(ra,"RecalcAccuracyObject",null,[]);class N{}N.string="String";N.blank="Blank";N.general="General";N.dJh="Flexible";Object(u.a)(N,"FormattedUnitKind",null,[]);class ea{constructor(Ja=0,Ga=0,La=0,nb=0,Lb=0,ac=0,ib=0,Ra=0,ya=0,Va=0,oa=0,kb=0,Sa=0,U=0,ta=0,ub=!1,hc="",Bc=0,Qa=null,na=null,ab=null,Gb=null,fc=null,pb=null,Ea=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=
this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=
this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=Ja;this.numberOfNonUpdatedCells=Ga;this.numberOfUpdatedCells=La;this.numberOfCellsUpdatedAlreadyByServer=nb;this.numberOfCellsSkippedDueToTimeout=Lb;this.numberOfCellsWithNoFormattedCell=ac;this.numberOfUnsupportedErrorCellTypes=ib;this.numberOfUnsupportedBlankCellTypes=
Ra;this.numberOfUnsupportedRichCellTypes=ya;this.numberOfSkippedCellsDueToMissingLocaleInfo=Va;this.totalExecutionTime=oa;this.originalProcessingTimeLimit=kb;this.newProcessingTimeLimit=Sa;this.numberOfEditedRecalcedCellsInBatch=U;this.numberOfDependentRecalcedCellsInBatch=ta;this.isNewTask=ub;this.lastSetCellInstantaneousOperation=hc;this.taskId=Bc;this.isNewNumberFormatter=Qa;this.numberOfRecalcedCellsWithFormattedValue=na;this.numberOfRecalcedCellsWithoutFormattedValue=ab;this.totalNumberFormatterTime=
Gb;this.newNumberFormatterFinalizeFailures=fc;this.numberOfMeasureTextWidthCalls=pb;this.numberOfHashFormattedValues=Ea}}Object(u.a)(ea,"RecalcResultProcessingStatistics",null,[]);class Ba{constructor(Ja,Ga,La,nb){this.rangeDelta=Ja;this.stateId=Ga;this.isFinished=La;this.priorityGroup=nb}}Object(u.a)(Ba,"RecalcedCellInfo",null,[]);var ka=a(109),Ka=a(11),Oa=a(22),wa=a(55),qa=a(66),aa=a(288);class ia{constructor(Ja,Ga,La){this.Eda=[];this.calcManager=this.sBc=this.lastSetCellInstantaneousOperation=
null;this.WOf=nb=>{var Lb;if(nb&&nb.rangeDeltas){var ac=this.Eda.length;for(let ib=0;ib<nb.rangeDeltas.length;ib++)(null===(Lb=nb.rangeDeltas[ib])||void 0===Lb?0:Lb.data)&&void 0!==nb.rangeDeltas[ib].data.value&&null!==nb.rangeDeltas[ib].data.value&&void 0!==nb.rangeDeltas[ib].range&&null!==nb.rangeDeltas[ib].range&&this.Eda.push(new Ba(nb.rangeDeltas[ib],nb.stateId,nb.isFinished,nb.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${nb.stateId}, priorityGroup=${nb.priorityGroup}, recalcFinished=${nb.isFinished}, cellsFromCalc=${nb.rangeDeltas.length}, initialCellsToRender=${ac}, recalcedCells=${this.Eda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);
!ac&&this.Eda.length&&this.CGf(!1,0)}};this.$=Ja;this.grid=Ga;this.zg=La;this.zda=ia.sLe;this.$.da.$a(268,nb=>{this.sBc=nb});this.$.da.$a(266,nb=>{this.calcManager=nb});this.cCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.qud=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.Twi=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=
this.sBc=this.zg=this.grid=this.$=null}Bcd(Ja,Ga,La,nb,Lb,ac,ib){if(!Ga)return Object(aa.a)("Null");var Ra=excelOnlineCalc.numfmt.renderCallback(nb,Va=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Va,Lb,!0,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),ib);let ya=Ja.renderValue(Ga,Ra);if(!excelOnlineCalc.util.isSuccess(ya))return Object(aa.a)("Finalize");nb=null;if(ib=excelOnlineCalc.numfmt.isHashesValue(ya.value)){if(ya=Ja.renderHashesValue(ya.value,
Ra),!excelOnlineCalc.util.isSuccess(ya))return Object(aa.a)("Hashes")}else nb=ia.DKh(Ga,ya.value);Ra=ya.value;Ja=excelOnlineCalc.numfmt.renderedValueToString(Ra);Ga=M(Ra);Ra=S(Ra);return Object(aa.d)({text:Ja,valueType:La,fontColor:Ra,Ek:ac,tPa:nb,horizontalAlignment:Ga,isHashesValue:ib})}CGf(Ja,Ga){this.$&&this.grid&&this.calcManager&&this.sBc&&this.calcManager.MB?(Ja&&(this.zda=this.sBc.zff),this.J9i(this.grid,this.calcManager.MB,Ja,Ga),!this.zda&&this.Eda.length?wa.Task.delay(0).jp(La=>{this.CGf(!0,
La.id);return!0},0,null,qa.a.current):wa.Task.Ta(!0)):(d.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),wa.Task.Ta(!1))}J9i(Ja,Ga,La,nb){const Lb=Ka.HelperMethods.Tb();for(La=new ea(this.Eda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.zda,void 0,void 0,void 0,La,void 0,nb,!0,0,0,0,0,0,0);0<this.Eda.length;){nb=Ka.HelperMethods.Tb()-Lb;if(!this.zda||nb>this.zda){La.numberOfCellsSkippedDueToTimeout=
this.Eda.length;break}nb=Array.dequeue(this.Eda);if(W(nb,La)){var ac=n.Range.Qc(nb.rangeDelta.range.row+1,nb.rangeDelta.range.column+1);(ac=Ja.Sb(ac))?ia.X0g(nb.stateId,ac.cell)?(ia.coc(Ja,ac,nb,La),this.BSg(Ga,ac,nb,La)):La.numberOfCellsUpdatedAlreadyByServer++:La.numberOfCellsWithNoFormattedCell++}}nb=Math.round(Ka.HelperMethods.Tb()-Lb);this.x1j(nb);this.gPj(La,nb);this.vnj(La)}BSg(Ja,Ga,La,nb){var Lb,ac,ib,Ra,ya=Y(Ga,La);const Va=La.rangeDelta.data.formatted,oa=O(La),kb=va(La);Ja=this.Bcd(Ja,
Va,oa,Ga.cell.cCa,Ga.cell.Fia,ya,!1);ya=Ga.cell.XFc;if(Object(aa.c)(Ja))if(this.cCb&&this.qud){if(0===kb||Ga.text!==Ja.value.text)this.Twi&&0===kb&&this.vUd(ya,Ja.value)&&(Ga.cell.formattedText=ya),this.zg.u_a(Ga,Ja.value),La=ca(La),this.zg.p$c(Ga,this.lastSetCellInstantaneousOperation,1,La,!0,!0),0===kb&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Cxf(Ga.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
nb.numberOfUpdatedCells++}else Ga.text!==Ja.value.text&&(this.zg.u_a(Ga,Ja.value),La=ca(La),this.zg.p$c(Ga,this.lastSetCellInstantaneousOperation,1,La,!0,!0),nb.numberOfUpdatedCells++);else switch(Ja.reason){case "Null":nb.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Lb=nb.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Lb?Lb:0)+1;break;case "Hashes":nb.numberOfHashFormattedValues=(null!==(ac=nb.numberOfHashFormattedValues)&&void 0!==ac?ac:0)+1;break;case "Finalize":nb.newNumberFormatterFinalizeFailures=
(null!==(ib=nb.newNumberFormatterFinalizeFailures)&&void 0!==ib?ib:0)+1}Object(aa.b)(Ja)&&"Null"!==Ja.reason&&(nb.numberOfRecalcedCellsWithFormattedValue=(null!==(Ra=nb.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Ra?Ra:0)+1);nb=0===kb?Ga.cell.userInput:Ga.formulaBarText;Ra=Object(aa.c)(Ja)?Ja.value.text:"";La=Object(aa.b)(Ja)?Ja.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Ga.range.top}, ${Ga.range.left}) 2nd pass formatting, success: ${Object(aa.c)(Ja)}, reason: ${La}, priority: ${kb}, ifmt: ${Ga.cell.Ek}, input: '${nb?
Oa.a.DM(nb):"null"}', prediction: '${Ra?Oa.a.DM(Ra):"null"}',`)}x1j(Ja){this.zda=Math.max(this.zda-Math.max(Ja,1),0)}gPj(Ja,Ga){Ja.numberOfNonUpdatedCells=this.Eda.length;Ja.totalExecutionTime=Ga;Ja.newProcessingTimeLimit=this.zda;Ja.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}vnj(Ja){Ja=Sys.Serialization.JavaScriptSerializer.serialize(Ja);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${Ja}`)}static DKh(Ja,Ga){Ja=Ja.units;var La=
Ga.units;if(Ja.length!==La.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Ga=[];let nb=-1;for(let Lb=0;Lb<Ja.length;Lb++)switch(Ja[Lb].kind){case N.blank:Ga.push(...ka.h(" ",La[Lb].str.length));break;case N.string:Ga.push(Ja[Lb].str);break;case N.dJh:Ga.push("");nb=Lb;break;case N.general:Ga.push(La[Lb].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=nb||""===La[nb].str)return null;La={};La.Start=Ga.slice(0,nb).join("");La.Separator=Ja[nb].str;La.End=Ga.slice(nb+1,Ga.length).join("");return La}static nRh(Ja){return Ja&&Ja&&Ja.py?Ja.py.VE:V.a.pe}static X0g(Ja,Ga){if(!Ga)return!1;Ga=ia.nRh(Ga);return Ga===V.a.pe||Ga===Ja}static coc(Ja,Ga,La,nb){var Lb=La.rangeDelta.data.value.toString();const ac=O(La),ib=Y(Ga,La);Lb=new ra(ac,Lb,ib,La.priorityGroup);Ga.cell.coc(Lb,
Ja.Ea.i6);1===va(La)?nb.numberOfDependentRecalcedCellsInBatch++:nb.numberOfEditedRecalcedCellsInBatch++}vUd(Ja,Ga){return null==Ja?!1:!!Ja.TextRuns&&!!Ja.Fonts&&Ja.Text===Ga.text&&2===Ga.valueType}}ia.sLe=20;Object(u.a)(ia,"CalcResultProcessor",null,[573,2]);class Ha{constructor(Ja,Ga=null,La=""){this.success=Ja;this.hoc=Ga;this.reason=La}}Object(u.a)(Ha,"GetRibbonNumberFormatResult",null,[]);var Z=a(907);class la{constructor(Ja,Ga){this.Kx=null;this.Ea=Ja;this.N3a=Ga}Xdb(Ja,Ga,La,nb,Lb=!1,ac=!1){Ja&&
(Ja.W0(Ga,La,Lb,ac),Ja.verticalAlignment=nb)}rMb(Ja,Ga,La){this.Kx||(this.Kx=new Z.a(this.Ea,this.N3a));this.Kx.rMb(Ja,Ga,La)}}Object(u.a)(la,"FormatCellsActionModelAccessor",null,[572]);var Xa=a(208),Za=a(28),xa=a(29),fa=a(282),ua=a(251),sa=a(281),sb=a(67);class hb{constructor(){this.Wkg=this.I4j=!1;this.source=0;this.Yka=this.zjc=!1}}Object(u.a)(hb,"FormatCellInstantaneousResult",null,[]);class bb{constructor(Ja,Ga){this.success=Ja;this.iy=Ga}}Object(u.a)(bb,"FormatStringResult",null,[]);var lb=
a(21),Fa=a(173),Na=a(1085),Mb=a(44),dc=a(519),Cb=a(51),Tb=a(200),Jb=a(262),eb=a(79),za=a(170),ha;(function(Ja){Ja.InvalidInput="invalid input";Ja.UnsupportedZeroResize="resizing to 0 - ignore";Ja.UnsupportedSkeletonInView="skeleton in view - ignore";Ja.NullSPD="ActiveSheetProcessedData is null";Ja.UnsupportedHiddenInRange="hiddens in resizeRanges";Ja.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ha||(ha={}));Object(u.b)("InstantaneousRowColumnResizeFailureReason",ha);
var fb=a(174);class rb{constructor(Ja){this.Kx=this.calcManager=this.sy=this.JTa=null;this.I3g=Ga=>{if(Ga){const La=Ka.HelperMethods.UO.hasOwnProperty(Ga);Ga=lb.h(this.$).isFontSupported(Ga);return!La&&Ga}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.checkIfNewFont: fontName cannot be null");return!1};this.sSi=(Ga,La)=>{if(Ga&&!fa.a(Ga)&&La){const nb=!!Ga&&!!Ga.RequestTelemetryData;lb.h(this.$).ji.gma(La.toString(),Ga.StateId,nb?Ga.RequestTelemetryData.EcsOperationDuration:0,nb?Ga.RequestTelemetryData.EcsRequestDuration:
0,nb?Ga.RequestTelemetryData.WfeRequestDuration:0)}};this.$=Ja;this.$.da.$a(268,Ga=>{this.sy=Ga});this.tKh=new la(lb.h(this.$).Ea,this.$);this.Xha=new ia(this.$,lb.h(this.$),this);this.$.da.$a(266,Ga=>{this.calcManager=Ga});this.xb=J.EwaSettings.xb();this.Wl=J.EwaSettings.Wl();this.cCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.qud=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.$Na=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.Uwi=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker");this.Gl=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get Cva(){return this.tKh}get MB(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.MB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.qc([this.JTa,this.Xha]);this.$=this.Xha=this.JTa=null}wTa(Ja,
Ga,La,nb=!1,Lb="",ac=0,ib=null){return this.RIj(Ja,Ga,La,nb,ac,Lb,ib)}p$c(Ja,Ga,La,nb,Lb,ac){Ja.cell.py.$J|=nb;rb.m8g(lb.h(this.$),Ja,La,Lb);this.Xha.lastSetCellInstantaneousOperation=Ga;ac&&(lb.h(this.$).ji.yS(Ga,sb.BasicTelemetryCalculator.cR),J.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&(1===La&&1===nb?lb.h(this.$).ji.yS(Ga,sb.BasicTelemetryCalculator.Aff):1!==La&&lb.h(this.$).ji.yS(Ga,sb.BasicTelemetryCalculator.Hod)))}vea(Ja,Ga,La,nb=!1,
Lb=null,ac=null){ac=ac||Ja.ha.ra.selectedRanges;if(!(-1690267012===Ga&&1<ac.length)){-1690267012===Ga&&d.ULS.shipAssertTag(537162176,0,1===ac.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${ac.length}`);ac=Ja.laa("FormatCellsAction.ShowInstantaneousFormatting",ac);try{ac.$$rst();let ib=!1;for(;ac.$$mn();){let Ra;const ya=ac.$$cu().cI?Ja.QLb(ac.$$cu().range):(Ra=new m.a,Ra.add(ac.$$cu()),Ra);for(let Va of ya)if(lb.h(this.$),!Va||ac.hb.contains(Va.range))if(this.S8f(Ga,
Va,La,nb,Lb,ac.$$cu().cI),ib||(Ja.Ea.AV(),ib=!0),Lb)break}}finally{ac&&ac.dispose()}}}u_a(Ja,Ga,La=null){La&&(La.Yka=!0);La=!Ga.text;const nb=Oa.a.ykf(Ga.text);let Lb;const ac=Ja.cI?lb.h(this.$).QLb(Ja.range):(Lb=new m.a,Lb.add(Ja),Lb);for(let ib of ac)this.zSg(this.$,ib,Ga.text,Ga.horizontalAlignment,Ga.fontColor,Ga.Ek,Ja.cell.Ek,La,nb,Ga.valueType,Ga.tPa);Ja.cell.uEc()}F4i(Ja,Ga,La,nb,Lb=null){try{const ac=B.D(Ga);let ib=B.D(La);if(Ja.Bb.M7a(ac)||Ja.Bb.M7a(ib))return 8;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&
-185374993!==nb&&(Ja.Bb.wnf(ac)||Ja.Bb.wnf(ib)))return 18;if(-185374993!==nb&&this.Nui(Ja,ac,ib))return 9;if(-185374993!==nb&&(Ja.Bb.N5(ib)||Ja.Bb.tBb(ac)))return 10;if(1804571062!==nb&&Ja.Bb.J5(ib))return 11;if(this.wph(ib))return 12;if(this.Hvi(ac,ib))return 13;const Ra=this.$.Jb.Ac("UserAction","PasteInstantaneous");Ra.start();dc.a(Ra);Lb&&Cb.b().UA(Ra.id,Lb.id,"actions","actions");!ac.isSingle&&ib.isSingle&&(ib=rb.expandRange(ac,ib),Ja.ha.updateSelection(ib,ib,0));switch(nb){case 237279923:case 808159687:if(!this.X4i(ac,
ib))return 14;this.f5c(Ja,ac,ib,!0,!1);break;case 1804571062:this.f5c(Ja,ac,ib,!0,!1);break;case -185374993:this.f5c(Ja,ac,ib,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(ac){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(ac)}`),15}}h5g(Ja,Ga){for(const La of Ja)this.J2c(La,!0,Ga)}J2c(Ja,Ga,La=""){if(Ja){var nb=lb.h(this.$);
if(Ga){if(Ga=nb.fk("FormatCellsAction.ClearRangeInstantaneous",Ja),nb=Ja.isSingle?null:Ja,Ga.$$mn()&&void 0!==Ga.$$cu()&&null!==Ga.$$cu())for(Ja=Object(f.a)(new Jb.a,{Text:""}),this.wTa(Ga.$$cu(),Ja,!1,P.a.rrd(this.$),La,void 0,nb);Ga.$$mn();)void 0!==Ga.$$cu()&&null!==Ga.$$cu()&&this.wTa(Ga.$$cu(),Ja,!1,!1,La)}else this.vea(nb,-1228228458,{},void 0,void 0,[Ja])}else d.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}pej(Ja,Ga){if(!Ga){Ga=
Ka.HelperMethods.Tb();var La=lb.h(this.$),nb=La.laa("FormatCellsAction.ReformatCells",Ja);try{nb.$$rst();let Lb=!1;for(;nb.$$mn();){const ac=nb.$$cu().cell;if(0===ac.PJ||2===ac.PJ)this.updateSpillInformation(ac,Ja),Lb||(La.Ea.AV(),Lb=!0)}}finally{nb&&nb.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Ka.HelperMethods.Tb()-Ga}.`)}}qld(Ja,Ga){if(this.xb){if(Ja.formulaBarText)return!Oa.a.equals(Ga.Text,Ja.formulaBarText,
!1);let La=Ja.cell.formattedText;La=ua.a(La,Ja.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(La,Ga).isEqual}return!Oa.a.equals(Ga.Text,Ja.text,!1)}tZe(Ja,Ga,La,nb){if(void 0===Ga||null===Ga)return new bb(!1,Ja);const Lb={};Lb.value=Ja;Lb.type=1;Ga=this.g4a(Lb,Ga,La,nb);return Object(aa.b)(Ga)?new bb(!1,Ja):new bb(!0,Ga.value.text)}SIj(Ja,Ga,La,nb){return c(Ja,this,Ga,La,nb,!0)}PIj(Ja,Ga,La){if(!this.qld(Ga,La))return Object(aa.d)("Skip unchanged cell content");
Ga=Ga.cell;La=this.vZe(La.Text,Ga.Ek,Ga.cCa,Ga.Fia,!0);if(Object(aa.b)(La))Ja=La;else{La=La.value;var nb=Ga.hasRichValueIcon?"Unsupported rich value icon":Ga.IX?"Unsupported wrapped text":Ga.qnf||null!=Ga.RL&&0!==Ga.RL?"Unsupported rotated text":!0;!0!==nb?Ja=Object(aa.a)(nb):(Ga.isCellWidthFixed?nb="Skip fixed width cell":(nb=La.valueType,nb=0===nb?"Skip empty cell value":2===nb?"Skip string cell value":Ga.TF&&!Ga.Eui?"Skip merged cell":Ga.iAc?"Skip shrunk to fit":La.isHashesValue?"Skip hashes cell value":
!0),!0!==nb?Ja=Object(aa.d)(nb):(La=Ga.N9g(La.text),La>Ga.offsetWidth?(Ga=[Ga.getRange().clone()],Ja=c(Ja,this,Ga,La,!1,!1),Ja=Object(aa.b)(Ja)?Ja:Object(aa.d)(La)):Ja=Object(aa.d)("Column is wide enough")))}return Ja}sZe(Ja,Ga,La,nb,Lb){const ac={};ac.value=Ja;ac.type=La;Ga=this.g4a(ac,Ga,nb,Lb);return Object(aa.b)(Ga)?new bb(!1,Ja):new bb(!0,Ga.value.text)}updateSpillInformation(Ja,Ga){const La=Ja.getRange();let nb=!1;for(const Lb of Ga)if(La.left===Lb.left){nb=!0;break}Ja.kZj(nb)}RIj(Ja,Ga,La,
nb,Lb,ac="",ib=null){this.cCb&&this.Uwi&&(Ja.cell.XFc=Ga);const Ra=new hb;Ra.source=0;Ra.Yka=!1;Ja.cell.lHb=Ja.cell.Ek;let ya=Ga.Text;const Va=!ya,oa=Oa.a.ykf(ya);Oa.a.Wq(ya)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===ya||null===ya)&&void 0!==Ga.TextRuns&&null!==Ga.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Ga=Object(f.a)(new Jb.a,{Text:""}),ya="");Ja.cell.userInput=ya;if(!this.qld(Ja,Ga))return this.F2g(Ja,Lb,Va,oa,Ra);La?this.y2g(Ja,
ya,this.$.workbookContext.DefaultHyperlinkStyle,Ra):this.s2g(Ja,Ga,ya,Va,oa,nb,Ra,ib);this.p$c(Ja,ac,Lb,1,Ra.zjc,Ra.Yka);return Ra}F2g(Ja,Ga,La,nb,Lb){Lb.Wkg=!0;Lb.zjc=!0;Lb.Yka=!1;0===Ga&&lb.h(this.$).Ea.AV();0===Ja.cell.Pza&&(La?Ja.cell.W0(0,!1):nb&&Ja.cell.W0(1,!1));this.d0d(Ja.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Lb}y2g(Ja,Ga,La,nb){nb.Yka=!0;Ja.insertHyperlink(Ga,G.a.idd(Ga),La);this.d0d(Ja.range,"FormatCellsAction.cellDataEntryCSE")}s2g(Ja,Ga,La,nb,Lb,ac,ib,Ra=null){ib.Yka=
!1;const ya=Ja.cell;let Va=!1;this.sy||(this.sy=this.$.da.za(268));this.UUj(this.sy,ya.Ek);J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&ac&&(Va=this.Weg(this.sy,Ja,La,Ra));nb||Lb?this.u2g(Ja,nb,Lb,ib):(nb=this.vZe(La,ya.Ek,ya.cCa,ya.Fia,!1,Va),Object(aa.c)(nb)?(this.vUd(Ga.TextRuns,Ga.Fonts)&&this.w2g(Ja,Ga,nb.value),this.u_a(Ja,nb.value,ib),this.d0d(Ja.range,"FormatCellsAction.cellDataEntryCSE")):this.cCb&&this.qud?this.C2g(Ja,Ga.Text,ib):this.D2g(Ja,Ga.Text,ib),
Ga=Object(aa.c)(nb)?nb.value.text:"",Lb=Object(aa.b)(nb)?nb.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${Ja.range.top}, ${Ja.range.left}) 1st pass formatting, success: ${Object(aa.c)(nb)}, reason: ${Lb}, ifmt: ${ya.Ek}, input: '${Oa.a.o_a(ya.userInput)}', prediction: '${Oa.a.o_a(Ga)}',`));ya.formulaBarText=La;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||ac&&this.Weg(this.sy,Ja,La,Ra);ib.zjc=!0}u2g(Ja,Ga,La,nb){nb.Yka=!0;Ja.text=
"";Ja.formulaBarText="";Ja.cell.userInput="";this.C3b(Ja,null,null,Ga,La)}w2g(Ja,Ga,La){Ga.Text===La.text&&2===La.valueType&&(Ja.cell.formattedText=Ga)}C2g(Ja,Ga,La){La&&(La.Yka=!0);Ja.text=Ga;Ja.formulaBarText=Ga;this.C3b(Ja,1)}D2g(Ja,Ga,La){La&&(La.Yka=!0);Ja.text=Ga;Ja.formulaBarText=Ga;this.C3b(Ja,1)}C3b(Ja,Ga,La=null,nb=!1,Lb=!1,ac=!1){let ib=Ja.horizontalAlignment;La=null!=La?La:Ja.verticalAlignment;0===Ja.cell.Pza&&(null!=Ga||nb||Lb||ac)&&(nb?ib=0:Lb||ac?ib=1:null!=Ga&&(ib=Ga),this.Cva.Xdb(Ja,
ib,!1,La,!0))}d0d(Ja,Ga){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const La=lb.h(this.$),nb=()=>{this.calcManager?this.calcManager.Cxf(Ja):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Ga}, cell ${Ja}`);La.Vb.Il(nb)};La.Vb.sm(nb)}}UUj(Ja,Ga){(null===Ja||void 0===Ja?0:Ja.hza)&&Ga>=rb.LIh&&Ga>Ja.hza.length-1&&(d.ULS.sendTraceTag(537162141,
0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Ga}. Triggering refresh...`),Ja.lZe())}Weg(Ja,Ga,La,nb=null){if(void 0===Ja||null===Ja)return!1;if(this.sy.God)return d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing"),!1;const Lb=this.$.da.za(266);return Lb?(this.Xha.zda=ia.sLe,Ja&&(this.Xha.zda=Ja.zff),Lb.l0g(Ga,La,this.Xha.WOf,nb)):!1}g4a(Ja,Ga,La,nb){var Lb=this.$.da.za(266);if(!Lb)return Object(aa.a)("calcManager is null");
if(!Lb.MB)return Object(aa.a)("calcManager.NumberFormatter is null");if(!this.sy)return Object(aa.a)("instantaneousManager is null");let ac;if("number"===typeof Ga||"string"===typeof Ga){var ib=Lb.oxb(Ga);if(!Object(aa.c)(ib))return ib;ac=ib.value}else ac=Ga;ib=Lb.MB;const Ra=T(Ja);if(void 0===Ra||null===Ra)return Object(aa.a)("cellValue is null");Lb=excelOnlineCalc.calc.cellValueToReadOper(Lb.config.mathpack,Ra);if(void 0===Lb||null===Lb)return Object(aa.a)("readOper is null");Lb=ib.applyFormat(ac,
Lb,J.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Lb)?this.Xha.Bcd(ib,Lb.value,Ja.type,La,nb,"number"===typeof Ga?Ga:-1,!1):Object(aa.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Lb.reason.kind))}vZe(Ja,Ga,La,nb,Lb,ac){var ib=this.$.da.za(266);if(void 0===ib||null===ib)return Object(aa.a)("calcManager is null");if(void 0===ib.MB||null===ib.MB)return Object(aa.a)("calcManager.NumberFormatter is null");if(void 0===this.sy||
null===this.sy)return Object(aa.a)("instantaneousManager is null");if(this.cCb&&!Lb&&ac)return Object(aa.a)("No main thread number formatter");ac=ib.oxb(Ga);if(!Object(aa.c)(ac))return ac;var Ra=ac.value;ac=ib.MB;Ja=ac.parseEdit(Ja,Ra);if(!excelOnlineCalc.util.isSuccess(Ja))return Object(aa.a)(`ParseEdit failure: reason=${Ja.reason.kind}, features=${Ja.reason.features}`);if(Ja.value.kind===w.a.formula)return Object(aa.a)("Main thread - skipping formula edit");ib=excelOnlineCalc.numfmt.applyValueEdit(ac,
ib.localeInfo,Ra,Ja.value);if(!excelOnlineCalc.util.isSuccess(ib))return Object(aa.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(ib.reason.kind));Ja=Ja.value;d.ULS.shipAssertTag(537162190,0,Ja.kind!==w.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");Ja=excelOnlineCalc.numfmt.getValueEditOperKind(Ja);Ra=0;switch(Ja){case 0:case 128:Ra=0;break;case 1:Ra=1;break;case 2:Ra=2;break;case 4:Ra=3;break;case 8:Ra=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${Ja} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${Ja}`)}return this.Xha.Bcd(ac,ib.value,Ra,La,nb,"number"===typeof Ga?Ga:-1,Lb)}Nui(Ja,Ga,La){if(Ga.width<La.width){const nb=Ja.fk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new n.Range(Ga.top,Ga.left,Ga.bottom,Ga.left,!0,!0));for(;nb.$$mn();){let Lb=nb.$$cu();if(Lb&&
Lb.iMa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Ga.height<La.height)for(Ja=Ja.fk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new n.Range(Ga.top,Ga.left,Ga.top,Ga.right,!0,!0));Ja.$$mn();)if((Ga=Ja.$$cu())&&Ga.mMa())return d.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}f5c(Ja,Ga,La,nb,Lb){const ac=Ga.ES().FirstRow,ib=Ga.ES().LastRow;
var Ra=La.ES().FirstRow;const ya=La.ES().LastRow;let Va=ac;for(;Ra<=ya;Ra++,Va++){Va>ib&&(Va=ac);const oa=Ga.ES();oa.FirstRow=oa.LastRow=Va;const kb=La.ES();kb.FirstRow=kb.LastRow=Ra;this.oah(Ja,z.a.LQ(oa),z.a.LQ(kb),nb,Lb)}}X4i(Ja,Ga){const La=this.$.da.za(266);return void 0!==La&&null!==La?(La.g0g(Ja,Ga.topLeft,this.Xha.WOf),!0):!1}Hvi(Ja,Ga){const La=Ja.right-Ja.left+1;Ja=Ja.bottom-Ja.top+1;const nb=Ga.right-Ga.left+1;Ga=Ga.bottom-Ga.top+1;if(nb>La&&Ga>Ja){if(!(nb%La&&Ga%Ja))return!0}else if(nb===
La&&Ga>Ja){if(!(Ga%Ja))return!0}else if(nb>La&&Ga===Ja&&!(nb%La))return!0;return!1}wph(Ja){if(J.EwaSettings.ma(102)){Ja=lb.h(this.$).C1(Ja).gridView.getRangeInformation(Ja);for(const Ga of Ja)if(Object(l.a)(r.DynamicArrayRange,Ga)&&!Object(v.a)(r.DynamicArrayRange,Ga).Unc)return!0}return!1}cHe(Ja,Ga,La,nb,Lb,ac){for(let ib of Ga)La&&(this.sah(ib,Lb),ib.setCell(!0)),nb&&(ac=this.L$h(Lb,ib)),ac||(Ja.Ea.AV(),ac=!0);return ac}AWh(Ja,Ga,La){Ga=new n.Range(Ga,La,Ga,La,!0,!0);return Ja.Sb(Ga)}oah(Ja,Ga,
La,nb,Lb){if(La){this.JTa&&La.equals(this.JTa.range)||(h.a.Ia(this.JTa),this.JTa=Ja.fk("FormatCellsAction.CopyBetweenRows",La));La=this.JTa;La.$$rst();var ac=!1;if(J.EwaSettings.getBooleanFeatureGate(fb.a.cKe,!1)){var ib=Ga.ES().FirstColumn+1,Ra=Ga.ES().LastColumn+1;Ga=Ga.ES().FirstRow+1;let Va=ib;for(;La.$$mn();){Va>Ra&&(Va=ib);const oa=this.AWh(Ja,Ga,Va);Va+=1;var ya=void 0;const kb=La.$$cu().cI?Ja.QLb(La.$$cu().range):(ya=new m.a,ya.add(La.$$cu()),ya);oa&&(ac=this.cHe(Ja,kb,nb,Lb,oa,ac));eb.lastOrDefault(kb)}}else for(ya=
Ja.fk("FormatCellsAction.CopyBetweenRows2",Ga);La.$$mn();)ya.$$mn()||(ya.$$rst(),ya.$$mn()),Ra=ya.$$cu(),Ga=La.$$cu().cI?Ja.QLb(La.$$cu().range):(ib=new m.a,ib.add(La.$$cu()),ib),Ra&&(ac=this.cHe(Ja,Ga,nb,Lb,Ra,ac)),eb.lastOrDefault(Ga)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}m9f(){const Ja=xa.a.Zc(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Mb.a(this.$).vj(Ja)}oGi(Ja,Ga){const La={ValidMembers:32},nb=Ga.NumberFormat;switch(Ja){case 1890566896:if(1001===
nb||1002===nb||1003===nb){La.NumberFormat=14;La.NumberFormatOptions={};switch(nb){case 1001:La.NumberFormatOptions.TimeType=2;break;case 1002:La.NumberFormatOptions.DateType=7;break;case 1003:La.NumberFormatOptions.DecimalPlaces=0}La.NumberFormatOptions.NumberFormatCategory=this.oSg(nb)}else La.NumberFormat=nb;break;case 1886928607:La.NumberFormat=13;break;case -992833457:La.NumberFormat=11;break;case 218524921:La.NumberFormat=12;break;case 996232352:La.NumberFormat=14;La.NumberFormatOptions=Object(f.a)(new t.a,
{DecimalPlaces:0});La.NumberFormatOptions.NumberFormatCategory=6;break;default:return Ga}return La}formatCells(Ja,Ga,La,nb=null,Lb=null,ac=null,ib=null){var Ra;const ya=this.$.Jb.Ac("UserAction","FormatCellsInstantaneous, command = "+Cb.b().uj(Ja)),Va=this.$.Jb.Ng("UserAction","FormatCellsInstantaneousFrame");Va.start();dc.a(Va);var oa=Cb.b().uj(Ja);const kb=this.$,Sa=lb.h(kb);var U=Sa.ha.ra,ta=Lb||U.selectedRanges,ub=ka.g(ta,ab=>ab.sH);oa=`${oa}, cellCount=${ub}`;lb.h(this.$).ji.g8(1,ya.id,oa);ta=
B.r(ta,this.$);U=U.activeCell;oa=-168056295===La.command;var hc=ub=null;if(oa){hc=Sa.Bb.zp(U);if(!hc){this.m9f();return}ub=hc.pda.substring(1,hc.pda.length-1);hc=hc.vcc();if(!hc){this.m9f();return}hc=hc.Caption}Sa.Gf.tH(!1,!0);const Bc=B.o(U,kb),Qa=kb.pa.ya.Wb({Dca:!0,Nba:1}),na=this.oGi(La.command,Ga);oa||this.vea(Sa,Ja,Ga,!1,nb,Lb);ya.stop();lb.h(this.$).ji.yS(ya.id,sb.BasicTelemetryCalculator.cR);La.Jji=Za.a.Qa.zb;nb=this.$.Jb.Ac("UserAction","FormatCellsUserAction");Lb=this.Gl&&this.I3g(null===
(Ra=null===Ga||void 0===Ga?void 0:Ga.Font)||void 0===Ra?void 0:Ra.FontName);this.CCi(Ja,La.taskId,Ga,ta,U,nb.id,Lb);Cb.b().UA(ya.id,nb.id,"actions","actions");Cb.b().UA(Va.id,nb.id,"actions","actions");kb.userOperationManager.Kc(new X(this,ta,Bc,na,oa,ub,hc,Qa,nb,ya.id,64,ac,ib),La)}n3(Ja,Ga,La,nb,Lb,ac,ib,Ra,ya,Va,oa){const kb=this.$;return(Sa,U,ta)=>{kb.Qy();Sa=[Sa,this.sSi];U=[U];Va&&Sa.push(Va);oa&&U.push(oa);return y.l(kb.pa.ya,Ja,Ga,La,nb,Lb,ac,!1,sa.b(...Sa),sa.a(...U),ta,ya,ib,Ra)}}S8f(Ja,
Ga,La,nb,Lb,ac,ib=null){if(Ga&&La){var Ra=La.Font,ya=La.HorizontalAlignment,Va=La.VerticalAlignment;La.ValidMembers&2||(ya=Ga.horizontalAlignment);La.ValidMembers&1||(Va=Ga.verticalAlignment);var oa=0!==ya;rb.Uli(Ja)&&0===ya&&(ya=this.F3e(Ga));var kb=!1;switch(Ja){case -394785302:this.Cva.Xdb(Ga,ya,oa,0);break;case 1041132226:this.Cva.Xdb(Ga,ya,oa,1);break;case -571165336:this.Cva.Xdb(Ga,ya,oa,2);break;case -1150205178:case -1142465846:case -286432209:this.Cva.Xdb(Ga,ya,oa,Va,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.$Na&&
this.oxj(Ga,La,oa);break;case 1650812936:this.setFillColor(Ga,La,ac);break;case -287251124:Ga.bold=Ra.Bold;break;case -1690267012:lb.h(this.$).ha.ra.Mg&&(Ra=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?ib?ib:lb.h(this.$).ha.ra.$c:lb.h(this.$).ha.ra.$c,this.Cva.rMb(Ga,La,Ra));break;case 1970784898:La=H.a.xp(Ga.color,Ga.backgroundColor);if(Xa.a.compare(La,Xa.a.red)&&(Oa.a.E5(Ga.text)||Oa.a.Baf(Ga.text)))break;La=Xa.a.IH(Ra.FontColor);Ga.color=
Tb.e(H.a.EG(La));break;case -1925065947:Ga.italic=Ra.Italic;break;case -1293291468:Ga.fontName=Ra.FontName;this.Wl&&Ga.X3f(Ra.FontScheme);break;case 862890474:case 963349338:Ga.fontSize=Ra.FontSize;this.$.af();break;case -1077965542:Ga.fontSize=Ra.FontSize;break;case 1764140053:Ga.underline=Ra.Underline;break;case -1685033574:Ga.doubleUnderline=Ra.DoubleUnderline;break;case -1590502662:Ga.fontStrikethrough=Ra.Strikethrough;break;case -848953656:case 2045211913:kb=Ga.prb();break;case 2105621672:La=
Object(v.a)(Na.a,Lb);if(!La)break;Ra=Xa.a.yLh(La.color);Ga.color=Tb.e(H.a.EG(Ra));this.Ove(Ga,La.loc);break;case -1409276245:this.Ove(Ga,La.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.ySg(Ga,La);break;case -1228228458:Ga.prb();Ga.clearFormat();this.YYc(Ga,0);kb=!0;break;case -730106152:Ga.clearFormat();this.YYc(Ga,0);break;case 932244020:this.nxj(Ga,La,ac);break;case -1942512156:case -1920201820:this.mzj(Ga,La)}nb||(kb?Ga.GJb(!0):Ga.setCell(!0))}else d.ULS.shipAssertTag(537162135,
0,!Ga,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!La,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}sah(Ja,Ga){Ja&&Ga?(Ja.yrb(Ga),Ja.c3c(Ga),this.YYc(Ja,Ga.cell.Ek)):d.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}YYc(Ja,Ga){if(0>Ga)this.wca({caller:"ApplyNumberFormatIndexOnCell",cell:Ja,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var La=this.g4a(Ja.sx,Ga,Ja.cell.cCa,Ja.cell.Fia);Object(aa.b)(La)?this.wca({caller:"ApplyNumberFormatIndexOnCell",cell:Ja,kind:"failure",reason:La.reason}):(this.u_a(Ja,La.value),this.wca({caller:"ApplyNumberFormatIndexOnCell",cell:Ja,kind:"success",iy:La.value,format:Ga}))}}Ove(Ja,Ga){if(void 0===Ga||null===Ga)this.wca({caller:"ApplyNumberFormatStringOnCell",cell:Ja,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var La=this.g4a(Ja.sx,Ga,Ja.cell.cCa,
Ja.cell.Fia);Object(aa.b)(La)?this.wca({caller:"ApplyNumberFormatStringOnCell",cell:Ja,kind:"failure",reason:La.reason}):(this.u_a(Ja,La.value),this.wca({caller:"ApplyNumberFormatStringOnCell",cell:Ja,kind:"success",iy:La.value,format:Ga}))}}ySg(Ja,Ga=null){if(Ga)if(Ga=this.Q2h(Ja,Ga),Ga.success){var La=this.g4a(Ja.sx,Ga.hoc,Ja.cell.cCa,Ja.cell.Fia);Object(aa.b)(La)?this.wca({caller:"ApplyNumberFormatCategoryOnCell",cell:Ja,kind:"failure",reason:La.reason,format:Ga.hoc}):(this.u_a(Ja,La.value),this.wca({caller:"ApplyNumberFormatCategoryOnCell",
cell:Ja,kind:"success",iy:La.value,format:Ga.hoc}))}else this.wca({caller:"ApplyNumberFormatCategoryOnCell",cell:Ja,kind:"failure",reason:Ga.reason,format:Ga.hoc});else this.wca({caller:"ApplyNumberFormatCategoryOnCell",cell:Ja,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}oSg(Ja){switch(Ja){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<Ja?-1:Ja}Q2h(Ja,
Ga){if(!this.sy||!this.localeInfo||!Ga)return Ja=this.sy?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Ha(!1,void 0,"GetRibbonNumberFormat: "+Ja);Ga=Ga.NumberFormat;switch(Ga){case 0:Ja=A.XLh;break;case 1:Ja=A.ZLh;break;case 2:Ja=A.VLh;break;case 3:Ja=A.TLh;break;case 4:Ja=A.bMh;break;case 5:Ja=A.YLh;break;case 6:Ja=A.dMh;break;case 7:Ja=A.$Lh;break;case 8:Ja=A.WLh;break;case 9:Ja=A.aMh;break;case 10:Ja=A.cMh;break;case 11:case 12:return this.sy.lZe(),
this.MTh(Ja,Ga);case 13:Ja=A.e_g;break;case 1006:Ja=A.buttonPercentage;break;case 1004:Ja=A.keyboardNumber;break;case 1005:Ja=A.keyboardCurrency;break;case 1002:Ja=A.keyboardDate;break;case 1001:Ja=A.keyboardTime;break;case 1003:Ja=A.keyboardPercentage;break;case 14:return Ja="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,Ja),new Ha(!1,void 0,Ja);default:return Ja="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,
0,!1,Ja),new Ha(!1,void 0,Ja)}return Ja?(Ja=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,Ja))?new Ha(!0,Ja):new Ha(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new Ha(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}MTh(Ja,Ga){if(!this.calcManager||!this.MB)return Ga=this.calcManager?"numberFormatter is null":"calcManager is null",new Ha(!1,void 0,"GetDecimalChangeNumberFormat: "+Ga);Ja=
this.calcManager.oxb(Ja.cell.Ek);if(!Object(aa.c)(Ja))return new Ha(!1,void 0,`getDecimalChangeNumberFormat: ${Ja.reason}`);Ga=this.MB.changeFormatDecimals(Ja.value,11===Ga?1:-1);return excelOnlineCalc.util.isSuccess(Ga)?void 0===Ga.value||null===Ga.value?new Ha(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new Ha(!0,Ga.value):new Ha(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}wca(Ja){const Ga=Ja.caller,La=Ja.cell;var nb=Ja.format;nb=
null==nb?"null":"number"===typeof nb?nb:"string"===typeof nb?Oa.a.o_a(nb):Oa.a.o_a(nb.formatString);const Lb=Oa.a.o_a(La.sx.value)||"null",ac="success"===Ja.kind?Oa.a.o_a(Ja.iy.text):"null";Ja=JSON.stringify({caller:Ga,"range.top":La.range.top,"range.left":La.range.left,result:Ja.kind,reason:"success"===Ja.kind?"":Ja.reason,value:Lb,valueType:La.sx.type,ifmt:nb,prediction:ac});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${Ja}`)}zSg(Ja,Ga,La,nb,Lb,ac,ib,Ra=!1,ya=!1,Va=
0,oa=null){const kb=Ga.cell;kb.PJ=Va;Va=Ga.text;Va!==La&&(kb.text=La);kb.tPa=oa;Fa.f(Va)?Ga.formulaBarText=Va:Ga.formulaBarText="";Ja=lb.h(Ja).Bb.clf(Ga.range);this.C3b(Ga,nb,null,Ra,ya,Ja);Lb&&(Ga.color=Tb.e(H.a.EG(Lb)));Ga.cell.Ek=ac;Ga.cell.lHb=ib;Ga.cell.LAc=ac}CCi(Ja,Ga,La,nb,Lb,ac,ib){const Ra={};Ra.a=this.$.va.UserSessionId;Ra.b=Ga;Ra.c=nb.Ranges.length;Ra.d=this.seh(nb.Ranges);Ra.e=Lb.toString();Ra.f=Ja;Ra.h=ac;1890566896===Ja?Ra.g=La.NumberFormat.toString():2105621672===Ja?Ra.g=La.NumberFormatOptions.NumberFormatCategory.toString():
this.Gl&&-1293291468===Ja&&(Ra.g=`{ "isNewFont": ${ib} }`);Cb.b().Pe(3,Ra,!0)}seh(Ja){let Ga=0,La=0,nb=0;for(let Lb=0;Lb<Ja.length;Lb++){const ac=B.B(Ja[Lb]).sH;Ga+=ac;ac>nb&&(nb=ac,La=Lb)}Ja=B.B(Ja[La]).toString();return"TotalCellCount:"+Ga+"; Max range:"+Ja+"; MaxRangeSize:"+nb+";"}nxj(Ja,Ga,La){64===(Ga.ValidMembers&64)&&this.setFillColor(Ja,Ga,La);16===(Ga.ValidMembers&16)&&rb.Pyj(Ja,Ga);128===(Ga.ValidMembers&128)&&this.Cva.rMb(Ja,Ga,Ja.range);if(2===(Ga.ValidMembers&2)||1===(Ga.ValidMembers&
1)){La=Ga.VerticalAlignment;Ga=Ga.HorizontalAlignment;const nb=0!==Ga;J.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!nb&&this.F3e(Ja);this.Cva.Xdb(Ja,Ga,nb,La)}}setFillColor(Ja,Ga,La){(J.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?Ja.rV:Ja.rV&&Ja.nyb&&!Ja.qyb&&!Ja.tyb)||(Ga=-1===Ga.FillColor?La?H.a.EG(Xa.a.white):null:H.a.EG(Xa.a.IH(Ga.FillColor)),Ja.backgroundColor=Ga?Tb.e(Ga):null)}mzj(Ja,Ga){0!==Ja.horizontalAlignment&&
2!==Ja.horizontalAlignment||Ja.W0(1,!1);0<=Ja.indentation+Ga.IndentationIncrease&&(Ja.indentation+=Ga.IndentationIncrease)}oxj(Ja,Ga,La){const nb=Ga.TextOrientation;nb!==V.a.verticalText&&(0>nb||180<nb)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${nb}`);Ja.RL=Ga.TextOrientation;La||Ja.W0(0<=Ja.RL?1:3,!1)}F3e(Ja){Ja=this.g4a(Ja.sx,Ja.cell.Ek,Ja.cell.cCa,Ja.cell.Fia);return Object(aa.b)(Ja)?0:null!=Ja.value.horizontalAlignment?
Ja.value.horizontalAlignment:0}zAj(Ja,Ga,La){this.Kx||(this.Kx=new Z.a(lb.h(this.$).Ea,this.$));this.Kx.rMb(Ja,Ga,La)}L$h(Ja,Ga){const La=new Jb.a;if(Ja.cell.formulaBarText&&Ja.cell.formulaBarText.startsWith("'"))La.Text=Ja.cell.formulaBarText;else{let nb=Ja.cellValue;nb&&4!==Ja.cell.PJ||(nb=Ja.text);La.Text=nb}this.wTa(Ga,La,!1,P.a.rrd(this.$));return!0}vUd(Ja,Ga){return this.xb&&!!Ja&&!!Ga}static m8g(Ja,Ga,La,nb){nb&&Ga.setCell(!0);0===La&&Ja.Ea.AV()}static expandRange(Ja,Ga){Ga=Ga.clone();Ga.height<
Ja.height&&(Ga.bottom=Ga.top+Ja.height-1);Ga.width<Ja.width&&(Ga.right=Ga.left+Ja.width-1);return Ga}static Uli(Ja){switch(Ja){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static Pyj(Ja,Ga){Ga=Ga.Font;var La=0!==(Ga.ValidMembers&16);const nb=0!==(Ga.ValidMembers&16),Lb=0!==(Ga.ValidMembers&16);Ja.bold=0!==(Ga.ValidMembers&4);Ja.italic=0!==(Ga.ValidMembers&8);La&&(Ja.underline=La);nb&&(Ja.doubleUnderline=nb);Lb&&(Ja.fontStrikethrough=
Lb);Ja.fontName=Ga.FontName;Ja.fontSize=Ga.FontSize;La=H.a.xp(Ja.color,Ja.backgroundColor);Xa.a.compare(La,Xa.a.red)&&(Oa.a.E5(Ja.text)||Oa.a.Baf(Ja.text))||(Ga=Xa.a.IH(Ga.FontColor),Ja.color=Tb.e(H.a.EG(Ga)))}}rb.LIh=36;Object(u.a)(rb,"FormatCellsAction",null,[540,2]);class pa extends e.a{constructor(Ja){super();this.$=Ja;this.Fb()}create(){this.ob(new rb(this.$))}static ka(Ja){Ja.da.Ga(18,new pa(Ja))}}Object(u.a)(pa,"FormatCellsActionFactory",e.a,[]);a.d(D,"a",function(){return Ma});const Ma=()=>
{b.a.Fa(pa.ka)}},1163:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(1),f=a(15),d=a(196),h=a(78),m=a(37),l=a(47),v=a(46),t=a(640),z=a(28),r=a(118);class n{constructor(){this.startTime=z.a.Qa.zb;this.Mx=new t.a}t2e(){return r.a(z.a.Qa,this.startTime)}}Object(u.a)(n,"OngoingAction",null,[]);class w extends h.a{constructor(Ma,Ja,Ga,La,nb=null){super();this.bQa=this.Oob=null;this.u0c=0;this.$qc=null;this.RYi=()=>{const Lb=this.bQa.t2e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.bma}>.OnRunningLong: Operation running for more than ${Lb}ms`);
this.$qc=l.a.instance.create(this.a7,Math.max(this.Dze-Lb,0),v.a.boe)};this.a7=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.bma}>.OnTimeout: Operation running for more than ${this.bQa.t2e()}ms, timing out. Has pending actions: ${this.X6a}`);this.u0c++;this.u0c>this.Cze&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.bma}>.OnTimeout: passed the allowed bypassed count`);this.bQa.Mx.cancel();this.aYe()};this.DR=()=>{this.X6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.bma}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.WMa}, AggregatedActionParams not null: ${this.X6a}`);
this.Nod()};this.dHg=Ma;this.eHg=Ja;this.documentVisibilityObserver=Ga;this.bma=La;this.PL=nb;Ga&&this.documentVisibilityObserver.LGa(this.DR);this.t0c=!!Ga&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.Cze=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);Ja=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.Dze=Ma.Ted(Ja);Ma=
e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.p_g=Math.max(this.Dze-Ja,0)+Ma}get WMa(){return!!this.bQa}get X6a(){return!!this.Oob}WLf(Ma){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.bma}>.PerformThrottledAction: Start. IsActionOngoing: ${this.WMa}, AggregatedActionParams not null: ${this.X6a}`);this.Oob=this.eHg.rYc(Ma,this.Oob);this.Nod()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.xRa(this.DR);
this.kBe();super.dispose()}L4f(Ma){this.t0c?(this.bQa=Ma?new n:null,Ma?this.startTimer():this.kBe()):this.bQa=Ma?{}:null}aYe(Ma=null){this.t0c&&Ma&&Ma.IK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.bma}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.bma}>.FinishedCallback: Start. IsActionOngoing: ${this.WMa}, AggregatedActionParams not null: ${this.X6a}`),this.L4f(!1),this.Nod())}Nod(){if(!this.CNb()){var Ma=this.Oob;this.Oob=null;
this.L4f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.bma}>.InternalPerformAction: Calling PerformAction.`);var Ja=this.t0c?this.bQa.Mx.token:d.a.none;m.TaskExtensions.Aa(this.dHg.xGd(Ma),()=>{this.aYe(Ja)},Ja,0,this.PL)}}CNb(){return!this.X6a||this.WMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.si?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.bma}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}kBe(){this.$qc&&this.$qc.cancel()}startTimer(){this.u0c<=
this.Cze&&(this.$qc=l.a.instance.create(this.RYi,this.p_g,v.a.boe))}}Object(u.a)(w,"ActionAggregator",h.a,[464,2]);var B=a(27),A=a(85),y=a(107),x=a(14),F=a(45),I=a(38),L=a(19),X=a(5),P=a(127),G=a(13),C=a(21),H=a(55);class J extends I.a{constructor(Ma){super();this.Ow=this.firstElement=null;this.tNa=!1;this.Zs=null;this.jEj=B.a.fg;this.oEf=Ja=>{const Ga=Ja.Ca.keyCode;return Ga===A.a.Sh?this.sRi():Ga===A.a.rA&&Ja.Ca.shiftKey?this.XEh(this.firstElement):!1};this.NJf=Ja=>{if(!this.tNa||Ja.Ca.keyCode!==
A.a.kJ)return!1;J.ncf();H.Task.delay(1).jp(()=>{this.Ow.focus();return!0},0,this.la);return!0};this.y1i=()=>{document.activeElement&&document.activeElement.id===this.Ow.id||(J.ncf(),H.Task.delay(1).jp(()=>{this.Ow.focus();return!0},0,this.la))};this.tCf=()=>{this.Qeg(this.Ow)};this.nEf=Ja=>{Ja.stopPropagation();Ja.preventDefault();this.tNa&&(this.tNa=!1)};this.$=Ma;(Ma=this.$.ea.dc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Ma.Fta}; InWebPart = '${Ma.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${Ma.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Ma&&(Ma.inWebPart||Ma.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Ma.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Ma.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.idh(),this.ieh(),y.KeyInputManager.instance.ta(x.a.Ob,this.$.domElement,this.NJf));
this.$.da.Ga(238,this)}sNg(Ma){this.addHandler("KBIS",Ma)}ckj(Ma){this.removeHandler("KBIS",Ma)}dispose(){this.firstElement&&F.a.removeHandler(this.firstElement,x.a.focus,this.tCf);this.Zs&&this.Zs.detach("focus");this.Ow&&(F.a.removeHandler(this.Ow,x.a.focus,this.nEf),F.a.removeHandler(this.Ow,x.a.blur,J.onBlur),y.KeyInputManager.instance.Ba(x.a.Ob,this.Ow,this.oEf));y.KeyInputManager.instance.Ba(x.a.Ob,this.$.domElement,this.NJf);this.Zs=this.Ow=this.firstElement=this.$=null;super.dispose()}idh(){this.jEj?
(this.firstElement=document.documentElement,this.Zs=P.a.instance.wH(document.parentWindow),this.Zs.ka("focus",this.y1i)):(this.firstElement=J.oIe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),F.a.addHandler(this.firstElement,x.a.focus,this.tCf))}ieh(){this.Ow=J.oIe();this.Ow.id=X.a.vPe;this.Ow.setAttribute(X.a.nv,G.a.instance.ga(862));document.body.appendChild(this.Ow);F.a.addHandler(this.Ow,x.a.focus,this.nEf);F.a.addHandler(this.Ow,x.a.blur,J.onBlur);y.KeyInputManager.instance.ta(x.a.Ob,
this.Ow,this.oEf)}XEh(Ma){this.Qeg(Ma);return!1}sRi(){this.tNa=!0;C.h(this.$).focus();C.h(this.$).ha.p$e();this.raiseEvent("KBIS");return!0}Qeg(Ma){this.tNa?this.tNa=!1:(this.tNa=!0,Ma&&Ma.focus())}static oIe(){const Ma=document.createElement("div");Ma.tabIndex=0;return Ma}static ncf(){document.body.classList.add(L.a.URe)}static onBlur(){document.body.classList.remove(L.a.URe)}}Object(u.a)(J,"EmbedViewFocusControl",I.a,[465,2]);var M=a(4),S=a(1081),W=a(61),O=a(521),T=a(24),Y=a(42),va=a(371),ca=a(188),
V=a(283),ra=a(116),N=a(29),ea=a(282),Ba=a(281),ka=a(60);const Ka=(Ma,Ja,Ga,La,nb,Lb,ac,ib,Ra,ya,Va=null)=>{Va=Ma.Na(1,Va);Va.selectedRange=Ja;Va.richValueKeyPath=Ga;Va.singleColumn=La;Va.searchForRange=nb;Va.calculateMajorityDataType=Lb;return ka.g(Ma,"GetRichValueFieldListContextList",Va,ac,ib,Ra,ya,4)};var Oa=a(33);class wa extends I.a{constructor(Ma,Ja){super();this.WKb=this.xgd=this.Rwb=this.xP=null;this.SVb=!1;this.t8d=null;this.kJd=!1;this.$Si=(Ga,La,nb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
nb);this.WKb&&this.WKb.stop();this.xP=null;this.raiseEvent(S.h)};this.aTi=Ga=>{ea.a(Ga)||(this.WKb&&this.WKb.stop(),this.SVb=!1,(this.xP=Ga.Result)&&0<this.xP.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.xP.length} rich value field list context for autocomplete`),this.pXa=!0,this.ptc())};this.pXa=!1;this.jb=Ma;this.EUb=-1;this.tableManager=Ja;this.kJd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Oa.a.DV(Ma)}c0b(Ma){this.addHandler(S.a,
Ma)}Ruc(Ma){this.removeHandler(S.a,Ma)}SMg(Ma){this.addHandler(S.h,Ma)}Kjj(Ma){this.removeHandler(S.h,Ma)}get w7a(){return this.pXa}get aBi(){return this.SVb}get OZe(){return this.EUb}get g7c(){return this.t8d}get $(){return this.jb}get $k(){return this.xP}get AVh(){return!!this.Rwb}dispose(){this.jb=null;this.bdb();super.dispose()}n6i(){var Ma=Array(6);var Ja={};Ja.Name=S.f;Ma[0]=Ja;Ja={};Ja.Name=S.c;Ma[1]=Ja;Ja={};Ja.Name=S.d;Ma[2]=Ja;Ja={};Ja.Name=S.g;Ma[3]=Ja;Ja={};Ja.Name=S.e;Ma[4]=Ja;Ja={};
Ja.Name=S.b;Ma[5]=Ja;Ja={ColumnName:"",ColumnIndex:-1};Ja.FieldInfoDataList=Ma;Ma=[];Ma[0]=Ja;this.NRd(Ma)}SZ(Ma,Ja,Ga,La=null){if(Ma){this.k1c();this.r3b();var nb=null,Lb=!1;if(!La&&({Xab:Lb,$k:nb}=this.HVj(Ma,Ja,Ga)).returnValue)if(this.kJd||this.NRd(nb),this.SVb=!0,this.xP=nb,this.kJd){if(!Lb){this.pXa=!0;this.ptc();return}}else if(this.xP&&0<this.xP.length&&(this.pXa=!0,this.ptc()),!Lb)return;this.Fig(Ma,La,Ja,Ga,!1)}}Fig(Ma,Ja,Ga,La,nb){if(this.$.ea.Zb){this.$.Jb&&(this.WKb=this.$.Jb.Ac("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.Rwb=null;var Lb=this.$.pa.ya.Wb();this.Rwb=Ka(this.$.pa.ya,Ma,Ja,Ga,La,nb,this.aTi,this.$Si,null,Lb)}else this.xP=null}bdb(){this.xP=null;this.pXa=!1;this.k1c();this.r3b();this.Rwb=null;this.EUb=-1}k1c(){wa.Wqb(this.Rwb)}r3b(){wa.Wqb(this.xgd)}ptc(){this.raiseEvent(S.a)}Dn(Ma){Ma=Y.D(Ma);--Ma.left;--Ma.right;return this.tableManager.Dn(Ma)}hLa(Ma){Ma.FirstColumn=Ma.FirstColumn;Ma.LastColumn=Ma.LastColumn;Ma.FirstRow=Ma.FirstRow;Ma.LastRow=Ma.LastRow;this.r3b();
this.xgd=null;return va.a(this.$.userOperationManager,(Ja,Ga,La)=>V.i(this.$.pa.ya,Ma,Ba.b(Ja,nb=>{this.jTi(nb)}),Ba.a(Ga,Ga,nb=>{this.iTi(nb)}),La,null),Ja=>new ca.a(264,0,Ja,80),null)}iTi(Ma){Ma=ra.a.Oe(Ma.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${N.a.sc(Ma)}`)}jTi(Ma){if(ea.a(Ma))-315732528!==Ma.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${N.a.sc(Ma.Errors)}`);
else if(Ma&&Ma.Result){Ma=Ma.Result;var Ja=Ma.HasHeaderRow;Ja=new O.AutofilterRange(Ma.TableRange.FirstRow+(Ja?1:0)+1,Ma.TableRange.FirstColumn+1,Ma.TableRange.LastRow+1,Ma.TableRange.LastColumn+1,null,null,null,0,Ja);this.EUb=Ma.TableRange.FirstColumn;(Ma=this.YOf(!1,!0,Ja))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.NRd(Ma)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}HVj(Ma,
Ja,Ga){let La,nb;nb=null;La=!1;if(Ma.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,Xab:La,hLa:!1,$k:nb};let Lb;this.EUb=-1;if(Ga){Lb=this.Dn(Ma);if(!Lb||!Lb.zba)return{returnValue:!1,Xab:La,hLa:!1,$k:nb};var ac=C.h(this.$).Bb.L6e(Lb);this.t8d=Lb;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&ac&&0<ac.count)return--Ma.FirstColumn,--Ma.LastColumn,this.xgd=this.hLa(Ma),{returnValue:!0,Xab:La,hLa:!0,$k:nb};Lb.top+=1;
Lb.right=Y.D(Ma).right-1}else Lb=new O.AutofilterRange(Ma.FirstRow+1,Ma.FirstColumn+1,Ma.LastRow+1,Ma.LastColumn+1,null,null,null,0,!1);if(Lb.top>Lb.bottom||Lb.left>Lb.right)return{returnValue:!0,Xab:La,hLa:!1,$k:nb};Ma=C.h(this.$);var ib=Ma.ib.width,Ra=Ma.ib.height;ac=Ma.view.visibleArea;ib=new W.a(ac.x-ib,ac.y-Ra,ac.width+ib,ac.height+Ra);Ra=Ma.ag(Lb);if(!ac||!Ra||!Ma.Djc(Lb))return{returnValue:!1,Xab:La,hLa:!1,$k:nb};ib.contains(Ra)||(La=!0);nb=this.YOf(Ja,Ga,Lb);return{returnValue:!0,Xab:La,hLa:!1,
$k:nb}}NRd(Ma){Ma&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Ma.length} rich value field contexts from block cache`);this.SVb=!0;(this.xP=Ma)&&0<this.xP.length&&(this.pXa=!0,this.ptc())}YOf(Ma,Ja,Ga){let La;La=null;const nb=Ga.clone();if(Ja)for(let Lb=Ga.right,ac=0;Lb>=Ga.left;--Lb){if(nb.left=Lb,nb.right=Lb,Ja=this.I2e(nb,!0,Ga.left)){La||(La=[]);La[ac]=Ja;if(Ma)break;++ac}}else if(Ma=this.I2e(nb,!1))La=[],La[0]=Ma;return La}I2e(Ma,Ja,Ga=0){var La=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var nb=
C.h(this.$).Bb.T2h(Ma);if(nb&&0<nb.count){var Lb=Array(nb.count);La=0;for(var ac of nb.values)nb={},nb.Name=ac,Lb[La]=nb,++La;ac="";nb=-1;0<Ma.top&&Ja&&(Ma=new T.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.left,!1,!1),null!=C.h(this.$).Sb(Ma)&&null!=C.h(this.$).Sb(Ma).originalText&&(ac=C.h(this.$).Sb(Ma).originalText),nb=Ma.left-Ga);La={};La.ColumnName=ac;La.ColumnIndex=nb;La.FieldInfoDataList=Lb}}else if((ac=C.h(this.$).Bb.L6e(Ma))&&0<ac.count){Lb=Array(ac.count);La=0;for(nb of ac)ac={},ac.Name=nb,Lb[La]=
ac,++La;ac="";nb=-1;0<Ma.top&&Ja&&(Ma=new T.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.left,!1,!1),ac=C.h(this.$).Sb(Ma).originalText,nb=Ma.left-Ga);La={};La.ColumnName=ac;La.ColumnIndex=nb;La.FieldInfoDataList=Lb}return La}static Wqb(Ma){Ma&&M.AFrameworkApplication.Bd.Tu(Ma.nu)}}Object(u.a)(wa,"FieldInfoManager",I.a,[276,2]);class qa extends wa{constructor(Ma,Ja,Ga,La){super(Ma,Ja);this.W2a=null;this.nCf=()=>{this.Ruc(this.nCf);if(this.$k&&this.$k.length&&this.contextMenuManager){var nb=this.contextMenuManager.Kfd("autoFilterRichFieldList"),
Lb=window.document.getElementById(this.W2a);nb.b1(null,Lb,this,null,!0)}};this.ttg=Ga;this.contextMenuManager=La}get oH(){return this.ttg}KVh(Ma,Ja){this.W2a=Ja;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Ma.FirstRow}, ${Ma.FirstColumn}, ${Ma.LastRow}, ${Ma.LastColumn})`);this.Fig(Ma,null,!0,!1,!0)}}Object(u.a)(qa,"FilterInfoManager",wa,[277,276,2]);var aa=a(837),ia=a(1093),Ha=a(30),
Z=a(87),la=a(8);class Xa{}Xa.bzh="ewa-sharedUi-launchButton";Xa.ezh="ewa-sharedUi-launchButtonWithText";Xa.czh="ewa-sharedUi-launchButtonClick";Xa.fzh="ewa-sharedUi-launchButtonWithTextClick";Xa.dzh="ewa-sharedUi-launchButtonText";Object(u.a)(Xa,"CssClassNames",null,[]);var Za=a(64);a(516);var xa=a(239),fa=a(224);I=a(238);var ua=a(286),sa=a(71),sb=a(11),hb=a(251),bb=a(34);class lb extends I.a{constructor(Ma,Ja,Ga,La,nb,Lb,ac,ib,Ra){super(document.createElement("div"));this.Uof=null;this.ZVd=!1;this.htmlSanitizationHelper=
this.ePb=this.GTa=null;this.fO=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.eO=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.wKj=()=>{this.moe()};this.hd=ya=>{this.raiseEvent(this.XHb,ya);this.WHb();return!0};this.YQi=ya=>{100<r.a(z.a.Qa,this.Uof)&&this.Skd(new Sys.UI.Point(Math.round(ya.clientX),Math.round(ya.clientY)))};this.aO=ya=>{sa.g(ya.Ca,!1);return!1};this.wZ=this.Be.OIa();this.set_visible(!1);this.dkc=nb;this.XHb=Lb;this.Wnc=Ma;this.v4b=Ja;this.htmlSanitizationHelper=Ra;this.dkc&&
(this.GTa=l.a.instance.create(this.wKj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));Ma&&this.domElement.classList.add(Ma);this.KHa=document.createElement("div");this.domElement.appendChild(this.KHa);Ga&&this.KHa.classList.add(Ga);this.S0d(La);ac&&(this.ePb=document.createElement("div"),this.domElement.appendChild(this.ePb),this.ePb.classList.add(ib),this.ePb.innerText=ac,this.domElement.style.padding="3px",xa.a.instance.ta(x.a.pointerDown,this.domElement,this.aO));this.h0a=new ua.a(this.domElement,
7);fa.a.instance.ta(x.a.click,this.domElement,this.hd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&xa.a.instance.ta(x.a.pointerDown,this.domElement,this.aO);Ma=ya=>{sa.g(ya)};this.Gc.ka("mouseup",Ma);this.Gc.ka("click",Ma);this.Gc.ka("dblclick",Ma)}V2(Ma){this.addHandler(this.XHb,Ma)}Pda(Ma){this.get_events().removeHandler(this.XHb,Ma)}JNg(Ma){this.addHandler("OnObjectButtonMouseOver",Ma)}tkj(Ma){this.get_events().removeHandler("OnObjectButtonMouseOver",
Ma)}INg(Ma){this.addHandler("OnObjectButtonMouseOut",Ma)}skj(Ma){this.get_events().removeHandler("OnObjectButtonMouseOut",Ma)}S0d(Ma){Ma&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.sk(this.KHa,Ma):this.KHa.innerHTML=Ma)}$Yj(Ma,Ja,Ga){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?
this.htmlSanitizationHelper.aZ(this.KHa):this.KHa.innerHTML="";Ma?Ma.Kba(Ja,16,16,this.KHa,16,16,void 0,Ga):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}aZj(Ma,Ja){Ma&&(this.ePb.innerText=Ma);this.domElement.title=Ja}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.iD(),Z.a.qc([this.wZ,this.h0a]),fa.a.instance.Ba(x.a.click,this.domElement,this.hd),xa.a.instance.Ba(x.a.pointerDown,this.domElement,this.aO),this.GTa&&this.GTa.dispose(),
super.dispose())}$cb(){this.v4b&&this.domElement.classList.remove(this.v4b);this.Wnc&&this.domElement.classList.add(this.Wnc)}WHb(){this.Wnc&&this.domElement.classList.remove(this.Wnc);this.v4b&&this.domElement.classList.add(this.v4b);this.i3a()}i3a(){this.dkc&&(this.GTa.cancel(),this.Tag(),this.setOpacity(1));this.set_visible(!0)}Rp(Ma,Ja,Ga,La,nb=!1){Ma=bb.a(La).yi(Ma);Ja=bb.a(La).yi(Ja);bb.a(La).Ayc(this.domElement);this.domElement.style.top=sb.HelperMethods.uc(Ja);this.domElement.style.left=this.domElement.style.right=
"";Ja=Ma;nb&&(Ja=Ma-this.domElement.offsetWidth);hb.c(this.domElement.style,Ga,sb.HelperMethods.uc(Ja));this.set_visible(!0);this.setOpacity(1);this.dkc&&(this.ZVd=!1,this.lNj(),this.GTa.tq())}hide(){this.$cb();this.set_visible(!1);this.dkc&&(this.Tag(),this.GTa.cancel())}z9b(){this.Gc.ka("mouseover",this.fO,!0);this.Gc.ka("mouseout",this.eO,!0)}lNj(){this.wZ.Ni("mousemove")||this.wZ.ka("mousemove",this.YQi)}Tag(){this.wZ.Ni("mousemove")&&this.wZ.detach("mousemove")}Skd(Ma){if(this.domElement.parentNode){var Ja=
Sys.UI.DomElement.getBounds(this.domElement);const Ga=new Sys.UI.Point(Math.round(Ja.x+Ja.width),Math.round(Ja.y+Ja.height));Ja=Math.abs(Ga.x-Ma.x);Ma=Math.abs(Ga.y-Ma.y);Ma=Ja>Ma?Ja:Ma;this.ZVd?this.setOpacity(lb.s0g(Ma)):100>=Ma&&this.moe()}}moe(){this.ZVd=!0;this.GTa.cancel()}setOpacity(Ma){B.a.setOpacity(this.domElement,Ma);this.Uof=z.a.Qa.zb}static s0g(Ma){return 100>=Ma?1:250<=Ma?0:.01*(100-(Ma-100)/150*100)}}Object(u.a)(lb,"OnObjectButton",I.a,[418,419,2]);var Fa=a(790);const Na=Xa.dzh;class Mb extends h.a{constructor(Ma,
Ja,Ga,La,nb,Lb,ac,ib,Ra=""){super();this.Wka=null;this.Scf=!1;this.htmlSanitizationHelper=this.unc=this.vnc=null;this.buttons={};this.fRe={};this.$=Ma;this.svgIconProvider=Ja;this.qPi=Ga;this.kgc=La;this.jgc=nb;this.altText=Lb;this.XHb=ac;this.htmlSanitizationHelper=ib;this.buttonText=Ra}get Dz(){return bb.a(this.$).cHa(la.a.gXi)}get S3b(){return la.a.fXi}get buttonWidth(){return bb.a(this.$).cHa(la.a.hXi)}dispose(){this.poh();this.$=null;super.dispose()}getButton(Ma,Ja=!0){return this.Sva(Ma,Ja)}Sva(Ma,
Ja=!0){const Ga=Ma.toString();Ga in this.buttons||this.keh(Ma,Ja);return this.buttons[Ga]}Rp(Ma,Ja,Ga,La,nb=!0,Lb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&Za.i(this.$.na)){var ac=C.h(this.$).lS.domElement;const ib=Ma+this.buttonWidth-ac.scrollWidth;ac=Ja+this.buttonWidth-ac.scrollHeight;Ma=0<ib?Ma-ib:Ma;Ja=0<ac?Ja-ac:Ja}this.Sva(La,nb).Rp(Ma,Ja,Ga,this.$,Lb)}hide(){const Ma=this.buttons;for(let Ja in Ma)Ma[Ja].hide()}z9b(Ma,Ja){!this.Scf&&(Ja=this.buttons[Ja.toString()])&&(this.vnc=(Ga,
La)=>{Ma(La,!0)},Ja.JNg(this.vnc),this.unc=(Ga,La)=>{Ma(La,!1)},Ja.INg(this.unc),this.Scf=!0,Ja.z9b())}keh(Ma,Ja){this.Wka=String.format(this.kgc===L.a.r$b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Ha.a.Eg(this.kgc),Ha.a.Eg(this.jgc),"{0}");var Ga=String.format(this.Wka,Ha.a.Eg(this.altText));Ja=new lb(""===this.buttonText?Xa.bzh:Xa.ezh,""===this.buttonText?Xa.czh:Xa.fzh,L.a.Rx,
Ga,Ja,this.XHb,this.buttonText,Na,this.htmlSanitizationHelper);Ga=(La,nb)=>{this.qPi(nb,Ma)};Ja.V2(Ga);this.buttons[Ma.toString()]=Ja;this.fRe[Ma.toString()]=Ga;Ga=C.h(this.$).Af(Ma);Ga.domElement.insertBefore(Ja.domElement,Ga.domElement.firstChild)}poh(){for(const Ma of Fa.a(this.buttons)){const Ja=this.buttons[Ma];Ja.Pda(this.fRe[Ma]);Z.a.Ia(Ja);delete this.buttons[Ma];this.vnc&&Ja.tkj(this.vnc);this.unc&&Ja.skj(this.unc)}}domElement(Ma){return this.Sva(Ma).domElement}i3a(Ma){this.Sva(Ma).i3a()}Cig(Ma,
Ja){this.kgc=Ma;this.jgc=Ja}EQb(Ma,Ja,Ga=!0){this.Wka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Ha.a.Eg(this.kgc),Ha.a.Eg(this.jgc),"{0}");Ma=String.format(this.Wka,Ha.a.Eg(Ma));this.Sva(Ja,Ga).S0d(Ma)}cVa(Ma,Ja,Ga){this.Sva(Ga,!1).aZj(Ma,Ja)}Aig(){this.Wka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Ha.a.Eg(this.jgc),"{1}");const Ma=String.format(this.Wka,void 0,
Ha.a.Eg(void 0));this.Sva(void 0,!1).S0d(Ma)}Big(Ma,Ja,Ga){this.Sva(Ga,!1).$Yj(this.svgIconProvider,Ma,Ja)}}Object(u.a)(Mb,"OnObjectLaunchButton",h.a,[399,2]);h=a(94);class dc extends h.a{constructor(Ma,Ja){super(Ma);this.ADb=null;this.$nh=()=>{this.display()};this.vfi=Math.max(1,Ja)}dispose(){Z.a.Ia(this.ADb);this.ADb=null;super.dispose()}WTa(){Z.a.Ia(this.ADb);this.ADb=l.a.instance.create(this.$nh,this.vfi,v.a.eBi)}bUa(){Z.a.Ia(this.ADb);this.hide()}}Object(u.a)(dc,"LoadingIndicatorBehavior",h.a,
[414,2]);class Cb extends dc{constructor(Ma,Ja,Ga,La){super(Ma,Ja);this.zDb=null;this.Pvg=Ga;this.Hci=La;this.vJg()}dispose(){this.zDb=null;super.dispose()}display(){this.Pvg(this.zDb)}hide(){this.Hci(this.zDb)}vJg(){this.zDb=document.createElement("div");this.domElement.appendChild(this.zDb)}}Object(u.a)(Cb,"ShimmerLoadingIndicatorBehavior",dc,[]);var Tb=a(68),Jb=a(53),eb=a(12);class za extends dc{constructor(Ma,Ja,Ga,La=null,nb=null,Lb=0){super(Ma,Ja);this.bxa=this.KOa=null;this.bxa=Ga;this.pgc=
La||Jb.a.current.io(104);this.Iqf=Lb;this.k7c=nb;this.uJg()}dispose(){this.KOa=null;super.dispose()}display(){eb.DOMElementExtensions.setVisible(this.KOa,!0)}hide(){eb.DOMElementExtensions.setVisible(this.KOa,!1)}uJg(){this.KOa=document.createElement("div");this.KOa.classList.add(Tb.a.Pxh);const Ma=document.createElement("div");Ma.classList.add(Tb.a.Qxh);this.k7c&&""!=this.k7c&&Ma.classList.add(this.k7c);var Ja=0===this.Iqf?"":G.a.instance.ga(this.Iqf);const Ga=String.format('<div class="'+Tb.a.Rxh+
'">{0}</div>',Ja);this.pgc?(Ja=`<img src="${this.pgc}" alt="${Ja}" title="${Ja}"/>`,this.bxa?this.bxa.sk(Ma,Ja+Ga):Ma.innerHTML=Ja+Ga):this.bxa?this.bxa.sk(Ma,Ga):Ma.innerHTML=Ga;this.KOa.appendChild(Ma);this.domElement.appendChild(this.KOa)}}Object(u.a)(za,"SpinnerLoadingIndicatorBehavior",dc,[]);class ha{constructor(Ma){this.bxa=Ma}l6c(Ma,Ja,Ga){return new aa.a(Ma,Ja,Ga)}t6b(Ma,Ja,Ga,La,nb,Lb,ac,ib,Ra,ya){return new ia.a(Ma,Ja,Ga,La,nb,Lb,ac,ib,Ra,ya)}Rsb(Ma,Ja,Ga,La,nb=0){return new za(Ma,Ja,this.bxa,
Ga,La,nb)}Vhd(Ma){return Ma.da.za(238)||new J(Ma)}w6b(Ma,Ja,Ga,La,nb,Lb,ac,ib=""){return new Mb(Ma,Ja,Ga,La,nb,Lb,ac,this.bxa,ib)}O5c(Ma,Ja){return new wa(Ma,Ja)}ddh(Ma,Ja,Ga,La){return new qa(Ma,Ja,Ga,La)}u5c(Ma,Ja,Ga,La){return new w(Ma,Ja,Ga,La)}}Object(u.a)(ha,"SharedUIControlsFactory",null,[350]);var fb=a(50);class rb extends b.a{constructor(Ma){super();this.$=Ma;this.Fb()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const Ma=
fb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Ya);m.TaskExtensions.Aa(Ma,()=>{e.EwaSettings.ol()?this.ob(this.$.da.za(12)||new ha(Ma.result)):this.ob(new ha(Ma.result))},this.la,3)}else e.EwaSettings.ol()?this.ob(this.$.da.za(12)||new ha(null)):this.ob(new ha(null))}static ka(Ma){Ma.da.Ga(477,new rb(Ma))}}Object(u.a)(rb,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(D,"a",function(){return pa});const pa=()=>{c.a.Fa(rb.ka)}},1167:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(50),f=a(37),
d=a(1),h=a(810);class m extends b.a{constructor(ya){super();this.$=ya;this.Fb()}create(){const ya=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya),Va=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([ya,Va],this.la),()=>{this.ob(this.$.da.za(296)||this.$.da.Ga(296,new h.BorderFormatManager(this.$,ya.result,Va.result)))},this.la,3)}static ka(ya){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&ya.da.Ga(468,
new m(ya))}}Object(u.a)(m,"BorderFormatManagerFactory",b.a,[]);var l=a(692),v=a(15),t=a(263),z=a(170),r=a(823),n=a(27),w=a(40),B=a(30),A=a(95),y=a(260),x=a(354),F=a(351),I=a(97),L=a(187),X=a(8),P;(function(ya){ya[ya.insert=1]="insert";ya[ya.delete=2]="delete";ya[ya.rows=4]="rows";ya[ya.columns=8]="columns";ya[ya.cellsShiftHorizontal=16]="cellsShiftHorizontal";ya[ya.cellsShiftVertical=32]="cellsShiftVertical";ya[ya.insertRows=5]="insertRows";ya[ya.insertColumns=9]="insertColumns";ya[ya.insertCellsShiftRight=
17]="insertCellsShiftRight";ya[ya.insertCellsShiftDown=33]="insertCellsShiftDown";ya[ya.deleteRows=6]="deleteRows";ya[ya.deleteColumns=10]="deleteColumns";ya[ya.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";ya[ya.deleteCellsShiftUp=34]="deleteCellsShiftUp";ya[ya.insertRowsBelow=37]="insertRowsBelow"})(P||(P={}));Object(u.b)("InsertDeleteCellFlags",P);var G=a(5),C=a(423),H=a(64),J=a(76);class M{constructor(ya){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=ya}}Object(u.a)(M,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[125]);var S=a(1079),W=a(42),O=a(371),T=a(188),Y=a(60),va=a(283),ca=a(142),V=a(459),ra=a(113),N=a(53),ea=a(198),Ba=a(91),ka=a(35),Ka=a(29),Oa=a(282),wa=a(257),qa=a(11),aa=a(183),ia=a(22),Ha=a(281);class Z{constructor(ya,Va,oa,kb,Sa=0){this.Xwg=ya;this.Ywg=Va;this.KEg=oa;this.CYb=kb;this.iKh=Sa}get Gja(){return this.Xwg}get formattedText(){return this.Ywg}get style(){return this.KEg}get size(){return this.CYb}get MZ(){return this.iKh}static ZYg(ya,
Va){return new Z(ya,Va,null,null,null)}static m0c(ya,Va){return new Z(ya,null,Va,null,null)}static $Yg(ya,Va){return new Z(ya,null,null,Va,null)}static YYg(ya,Va,oa){return new Z(ya,null,Va,null,oa)}}Object(u.a)(Z,"CachedPreviewCellGroup",null,[]);var la=a(82);b=a(284);var Xa=a(99),Za=a(13);class xa extends b.a{constructor(ya,Va,oa){super(ya);this.Ql=null;this.D8c=0;this.qji=(kb,Sa)=>{if(0===kb)v.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");
else{kb={};var U="",ta=1035996630;switch(Sa.selectedKey){case 0:U=1896159024===this.Or?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:U=1896159024===this.Or?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Or?(U="InsertRows",ta=-1113896058):(U="DeleteRows",ta=1554436520);break;case 3:1896159024===this.Or?(U="InsertColumns",ta=1415868706):(U="DeleteColumns",ta=674605324)}v.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${U}`);
Sa=new Ba.a(ta,1,2,8,null);kb[J.a.Ic]=U;this.$.Ka.Lb(Sa,kb)}};this.Or=Va;this.selectedRanges=oa;this.isRtl=Object(la.a)(Xa.a,this.$.xa.na).displayRtl}get pc(){return"InsertDeleteCellsDialog"}dg(){1896159024===this.Or?(this.Ql=Za.a.instance.ga(23),this.D8c=0):(this.Ql=Za.a.instance.ga(22),this.D8c=1);const ya=this.selectedRanges[0].E_&&!this.selectedRanges[0].V5?0:1;this.Rb=1;this.initializeAndShow(this.Ql,this.qji,{[xa.vu]:this.pc,["dialogToDisplay"]:this.D8c,["defaultSelectedKey"]:ya,["isRtl"]:this.isRtl})}}
Object(u.a)(xa,"InsertDeleteCellsDialog",b.a,[]);const fa=(ya,Va,oa,kb,Sa,U,ta=null)=>{ta=ya.Na(41,ta);ta.insertDeleteMultiRangeParameters=Va;return Y.g(ya,"InsertDeleteCells",ta,oa,kb,Sa,U,0)};class ua{constructor(ya,Va,oa,kb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=ya;this.targetSheetRange=Va;this.fillRangeType=oa;this.fillRangeDirection=kb}}Object(u.a)(ua,"MacroRecorderRangeFilledPayload",null,[125]);var sa=a(7),sb=a(24);
class hb{constructor(){this.XRa=this.EHa=this.yOa=this.JUa=0}}Object(u.a)(hb,"RangeBorders",null,[]);class bb{constructor(){this.scenario=0;this.JQ=null}}Object(u.a)(bb,"ScenarioInfo",null,[]);var lb=a(907),Fa=a(21),Na=a(262),Mb=a(208),dc=a(79);class Cb{constructor(ya,Va){this.$=ya;this.zg=Va;this.Kx=new lb.a(Fa.h(this.$).Ea,this.$);this.lAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Drd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.Tic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.ajf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Oni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.dnf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.Cjc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.aBb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Uic=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.hri=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Xni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Ygf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.Xif=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Ari=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.Pwi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Wni(ya,Va){return!(void 0===Va||null===Va)&&!!(Va.scenario&16384)&&!this.Yni(ya,Va)&&this.Rgf(Va,ya)}B4e(){var ya=w.a.Ud(),Va=Fa.h(this.$),oa=Va.ha.ra.selectedRanges;let kb=0;var Sa=
0,U=oa.length;const ta=new bb;if(1<U)return ta.scenario=4,ta;if(this.Xif&&Va.Xd.jjc(oa[0]))return ta.scenario=262144,ta;this.Drd&&Fa.h(this.$).rtl&&(kb|=65536);if(!Va.MK(oa[0]))if(this.lAb)kb|=32;else return ta.scenario=32,ta;if(Va=Va.Ea.gwa(oa[0],this.$.activeItemName)){ta.H_c=Va;for(var ub of Va)if(Sa+=1,1<Sa){this.lAb?(kb|=256,ta.scenario=kb):ta.scenario=256;if(!this.aBb)return ta;break}}Sa=Fa.h(this.$).Ea.Rja(oa[0]);if(!Sa)return ta.scenario=32768,ta;ub=Sa.length;oa=oa[0];Va=oa.bottom-oa.top+
1;U=oa.right-oa.left+1;const hc=new hb;for(let Bc=0;Bc<ub;Bc++)if(this.H1h(Sa[Bc],oa,hc),kb=kb|(void 0!==Sa[Bc].text&&null!==Sa[Bc].text&&""!==Sa[Bc].text?1:0)|(Sa[Bc].TF?2:0)|(Sa[Bc].Nwa?8:0)|(Sa[Bc].oyb?16:0)|(Sa[Bc].wB?64:0)|(Sa[Bc].rV?128:0),void 0!==Sa[Bc].text&&null!==Sa[Bc].text&&""!==Sa[Bc].text||Sa[Bc].Nwa)if(void 0===ta.JQ||null===ta.JQ)ta.JQ=Fa.h(this.$).Sb(Sa[Bc].getRange());else{if(Sa[Bc].getRange().top<ta.JQ.range.top||Sa[Bc].getRange().top==ta.JQ.range.top&&Sa[Bc].getRange().left<ta.JQ.range.left)ta.JQ=
Fa.h(this.$).Sb(Sa[Bc].getRange());kb|=16384}hc.JUa===U&&(kb|=512);hc.EHa===U&&(kb|=2048);hc.yOa===Va&&(kb|=4096);hc.XRa===Va&&(kb|=1024);if(0<hc.JUa&&hc.JUa<U||0<hc.EHa&&hc.EHa<U||0<hc.yOa&&hc.yOa<Va||0<hc.XRa&&hc.XRa<Va)kb|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||oa.right!==oa.maxColumns&&oa.bottom!==oa.maxRows||(kb|=131072);ya=w.a.Ud()-ya;v.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${ya}`);ta.scenario=
kb;return ta}nvf(ya,Va){const oa=ya.command;if(void 0===Va||null===Va)Va=this.B4e();if(!this.Rgf(Va,oa))return!1;ya=Fa.h(this.$).ha.ra.selectedRanges;var kb=Fa.h(this.$).Ea.Rja(ya[0]);if(!kb)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===kb.length&&!kb[0].TF)return-167499203===oa?(kb[0].W0(2,!0),!0):!1;kb=Fa.h(this.$).ha.ra.Cs;const Sa=this.$.na.sheetName;let U=!0;switch(oa){case -167499203:2===(Va.scenario&2)&&this.Tic?this.Lgg(Va.scenario,ya,
oa):U=this.XHi(Va,ya);break;case 1097660126:(Va=this.ovf(Va,ya))&&0!=Va.length||(U=!1);break;case 155820588:this.Lgg(Va.scenario,ya,oa);break;default:return!1}Fa.h(this.$).U4(ya,kb,Sa,null,ya[0],null,null,0,"MergeCellCommandAction");return this.aBb?U:!0}Rgf(ya,Va){const oa=this.Fmi(ya,Va);if(!this.ajf)return oa;const kb=Fa.h(this.$).ha.ra.selectedRanges[0].Cz(!1);v.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${Va.toString()}; Scenario Number: ${ya.scenario}; IsCSEPossible result: ${oa}; Range: ${kb}`);
return oa}Fmi(ya,Va){if(-255094134===Va)return!1;var oa=ya.scenario;if(this.Xif&&262144===oa||this.Drd&&65536===(oa&65536))return!1;if(this.cnf(Va,ya))return oa=Fa.h(this.$).ha.ra.selectedRanges,0===oa.length?!1:this.Wvi(Va,ya,oa[0]);this.lAb&&32===(oa&32)&&(oa&=-33);if(256==(oa&256))if(this.zri(ya))oa&=-257;else return!1;return 32768===oa||4===oa||128===(oa&128)||!this.lAb&&32===oa?!1:-167499203!=Va&&1097660126!==Va||!this.vpd(ya)?void 0!==ya.JQ&&null!==ya.JQ&&ya.JQ.IX?!1:0===oa?!0:16384===(oa&16384)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(oa&1)&&8!==(oa&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Uic}Koi(ya){return 131072===(ya.scenario&131072)?!0:!1}zri(ya){if(!this.aBb)return!1;let Va="Multi block",oa=!0;this.vpd(ya)&&(Va+=" with border",oa=!1);this.Koi(ya)&&(oa=!1,Va+=" with entire row or column selected",16384===(ya.scenario&16384)&&(Va+=" and a data loss scenario"));
oa||v.ULS.sendTraceTag(523511383,0,50,`CSE for ${Va}, is not enabled`);return oa}vpd(ya){return 16===(ya.scenario&16)||this.pld(ya.scenario)||this.Ild(ya.scenario)||this.Bld(ya.scenario)||this.Kld(ya.scenario)||8192===(ya.scenario&8192)?!0:!1}Yni(ya,Va){return this.Xni?this.cnf(ya,Va):155820588===ya}cnf(ya,Va){return 155820588===ya||(-167499203===ya||1097660126===ya)&&2===(Va.scenario&2)&&this.Tic?!0:!1}Vvi(ya){return this.Kld(ya.scenario)||this.Bld(ya.scenario)||this.pld(ya.scenario)||this.Ild(ya.scenario)?
!0:!1}Jbi(ya){ya=Fa.h(this.$).Ea.Rja(ya);if(!ya||0===ya.length)return!1;for(let Va=0;Va<ya.length;Va++)if(ya[Va].TF&&ya[Va].IX)return!0;return!1}Wvi(ya,Va,oa){if(1097660126===ya&&2===(Va.scenario&2))return!1;if(this.Pwi){if(this.Jbi(oa))return!1}else if(this.Oni&&void 0!==Va.JQ&&null!==Va.JQ&&Va.JQ.IX)return!1;this.lAb&&32===(Va.scenario&32)&&(Va.scenario&=-33);return 32768===Va.scenario||4===Va.scenario||256===(Va.scenario&256)&&this.hri||128===(Va.scenario&128)?!1:2===(Va.scenario&2)?this.Vvi(Va)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}H1h(ya,Va,oa){const kb=ya.getRange();if(kb.top===Va.top)if(ya.mMa)oa.JUa+=kb.right-kb.left+1;else{var Sa=this.Kx.NQ(kb,0);if(Sa)for(const ta of Sa)ta.gMa&&(oa.JUa+=ta.getRange().right-ta.getRange().left+1)}if(kb.left===Va.left)if(ya.iMa)oa.yOa+=kb.bottom-kb.top+1;else if(Sa=this.Kx.NQ(kb,
2))for(var U of Sa)U.kMa&&(oa.yOa+=U.getRange().bottom-U.getRange().top+1);if(kb.bottom===Va.bottom)if(ya.gMa)oa.EHa+=kb.right-kb.left+1;else if(U=this.Kx.NQ(kb,1))for(const ta of U)ta.mMa&&(oa.EHa+=ta.getRange().right-ta.getRange().left+1);if(kb.right===Va.right)if(ya.kMa)oa.XRa+=kb.bottom-kb.top+1;else if(ya=this.Kx.NQ(kb,3))for(const ta of ya)ta.iMa&&(oa.XRa+=ta.getRange().bottom-ta.getRange().top+1)}vhj(ya,Va){for(let oa of Va.H_c){Va=ya.Ke(oa.pf);Va=Fa.h(this.$).Ea.Rja(Va);const kb=Va.length;
for(let Sa=1;Sa<kb;Sa++){const U=Fa.h(this.$).Sb(Va[Sa].getRange());this.Uic?U.cell.deleteCellFromModel():(U.prb(),U.clearFormat(),U.cell.whj());U.GJb(!0)}}}v1j(ya,Va){ya.backgroundColor=Va.backgroundColor;ya.color=Va.color}kog(ya,Va){return{SpansBlocks:!0,OriginRow:ya,OriginColumn:Va,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}eIg(ya,Va,oa,kb,Sa){oa=ya.Ke(oa.pf);if(!oa)return v.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var U=new sb.Range(ya.top,ya.left,oa.top,oa.left,!1,!1);let ta;oa.top==ya.top?ta=0:(U.bottom=oa.top-1,ta=Va.wid(U));oa.left==ya.left?U=0:(U.right=oa.left-1,U=Va.xid(U));Va=this.kog(ya.top-1,ya.left-1);Va.OriginDeltaY=ta;Va.OriginDeltaX=U;Va.Rows=oa.bottom-oa.top;Va.Columns=oa.right-oa.left;Va.Height=Sa;Va.Width=kb;oa.top==ya.top&&oa.left==ya.left&&(Va.IsOrigin=!0);ya=Fa.h(this.$).Sb(oa.topLeft);ya.cell.z4f(Va);return ya}oSd(ya,Va){let oa=[];const kb=Fa.h(this.$).Xd;if(!kb)return oa;const Sa=
kb.wid(ya),U=kb.xid(ya);if(Va.H_c)for(const ta of Va.H_c)if(Va=this.eIg(ya,kb,ta,U,Sa))oa.push(Va);else{oa=[];break}return oa}K2h(ya,Va,oa,kb){var Sa=oa.bottom-oa.top,U=oa.right-oa.left;let ta=[];const ub=kb.scenario;if(256===(ub&256)){if(ta=this.oSd(oa,kb),!ta||0==ta.length)return ta}else Va.cell.oSd(Sa,U),ta.push(Va);Sa=this.v3(this.m5(Va),!0,0,ub,"merge");if(void 0!==ya&&null!==ya)for(const hc of ta){U=ya.cell.formattedText;const Bc=Object(sa.a)(new Na.a,{TextRuns:U.TextRuns,Fonts:U.Fonts});Bc.Text=
void 0!==ya.cell.originalText&&null!==ya.cell.originalText?ya.cell.originalText:void 0!==ya.cell.userInput&&null!==ya.cell.userInput?ya.cell.userInput:U.Text;Sa=this.v3(this.m5(hc),Sa,1,ub,"merge");this.zg.wTa(hc,Bc,!1,!0,"MergeCells",1);Sa=this.v3(this.m5(hc),Sa,2,ub,"merge");this.Drd?hc.yrb(ya):this.v1j(hc,ya);Sa=this.v3(this.m5(hc),Sa,3,ub,"merge");hc.cell.qah(ya.cell);Sa=this.v3(this.m5(hc),Sa,4,ub,"merge");hc.cell.uEc(!1);Sa=this.v3(this.m5(hc),Sa,6,ub,"merge")}this.vhj(oa,kb);this.v3(this.m5(Va),
Sa,5,ub,"merge");return ta}Bld(ya){return 4096===(ya&4096)}Kld(ya){return 512===(ya&512)}pld(ya){return 2048===(ya&2048)}Ild(ya){return 1024===(ya&1024)}$bc(ya,Va){let oa=null;for(let kb=0;kb<ya.length;kb++)if(ya[kb].BorderPosition===Va){oa=ya[kb];break}return oa}LYh(ya,Va){this.Cjc?(Va=this.$bc(Va.cell.iN().Borders,2))&&ya.push(Va):(Va=Va.cell.iN().Borders,1<Va.length&&(Va=[Va[1]]),ya=[...Va,...ya]);return ya}W5h(ya,Va){this.Cjc?(Va=this.$bc(Va.cell.iN().Borders,0))&&ya.push(Va):(Va=Va.cell.iN().Borders,
1<Va.length&&(Va=[Va[0]]),ya=[...Va,...ya]);return ya}sQh(ya,Va){Va=this.Kx.NQ(Va.cell.getRange(),1);if(!Va||0===Va.length)return ya;if(this.Cjc){if(Va=Va[0].iN().Borders,Va=this.$bc(Va,0))Va.BorderPosition=1,ya.push(Va)}else{let oa=[];0<Va.length&&(oa=Va[0].iN().Borders);oa[0].BorderPosition=1;ya=[...oa,...ya]}return ya}U2h(ya,Va){Va=this.Kx.NQ(Va.cell.getRange(),3);if(!Va||0===Va.length)return ya;if(this.Cjc){if(Va=Va[0].iN().Borders,Va=this.$bc(Va,2))Va.BorderPosition=3,ya.push(Va)}else{let oa=
[];0<Va.length&&(oa=Va[0].iN().Borders);oa[0].BorderPosition=3;ya=[...oa,...ya]}return ya}I1h(ya,Va,oa){this.Bld(ya.scenario)&&(Va=this.LYh(Va,oa));this.Kld(ya.scenario)&&(Va=this.W5h(Va,oa));this.pld(ya.scenario)&&(Va=this.sQh(Va,oa));this.Ild(ya.scenario)&&(Va=this.U2h(Va,oa));return Va}PZ(ya){if(0===ya.length)return null;let Va=[0,0,0,0],oa=[1,1,1,1],kb=0;ya.forEach(function(U){let ta=U.BorderPosition;oa[ta]=U.BorderLineStyle;let ub=new Mb.a(U.Color.Red,U.Color.Green,U.Color.Blue);Va[ta]=ub.DS();
kb|=qa.HelperMethods.K4a(U.BorderPosition)});ya={};ya.LineStyle=oa;ya.Color=Va;let Sa={};Sa.BorderFormat=ya;Sa.Border=kb;return Sa}W4d(ya,Va,oa=null){let kb=[];kb=null!==oa?[...oa]:this.I1h(Va,kb,ya);if(Va=this.PZ(kb))ya.cell.ucb(ya.cell.getRange()),this.Kx.FJb(ya.cell.getRange()),this.zg.vea(Fa.h(this.$),-1690267012,Va,!1,null,[ya.cell.getRange()])}Nsi(ya){return 512===(ya.scenario&512)||4096===(ya.scenario&4096)||1024===(ya.scenario&1024)||2048===(ya.scenario&2048)?!0:!1}X5h(ya){ya=this.Kx.NQ(ya.cell.getRange(),
1);return ya&&0!==ya.length?ya[0].mMa?(ya=ya[0].iN().Borders[0],ya.BorderPosition=1,ya):null:null}Y5h(ya){ya=this.Kx.NQ(ya.cell.getRange(),3);return ya&&0!==ya.length?ya[0].iMa?(ya=ya[0].iN().Borders[0],ya.BorderPosition=3,ya):null:null}u$h(ya,Va,oa,kb,Sa){Va.cell.Oig();if(this.Nsi(ya))this.W4d(Va,ya);else{const U=8192===(ya.scenario&8192),ta=Va.cell.getRange();U&&this.Ygf?(Va.cell.ucb(),this.Kx.FJb(ta)):Sa?(Sa=[],null!==oa&&Sa.push(oa),null!==kb&&Sa.push(kb),0<Sa.length?this.W4d(Va,ya,Sa):(Va.cell.ucb(),
this.Kx.FJb(ta))):U&&!this.Ygf&&(Va.cell.ucb(),this.Kx.FJb(ta))}}fYh(ya,Va){return null===ya||void 0===ya?!0:ya.cell.getRange().top===Va.topLeft.top&&ya.cell.getRange().left===Va.topLeft.left&&ya.cell.getRange().bottom===Va.topLeft.bottom&&ya.cell.getRange().right===Va.topLeft.right?!0:!1}XHi(ya,Va){Va=this.ovf(ya,Va);if(this.aBb&&(!Va||0==Va.length))return!1;for(let oa=0;oa<Va.length;oa++)Va[oa].W0(2,!0),this.v3(this.m5(Va[oa]),!0,8,ya.scenario,"merge");return!0}U_j(ya){const Va=Fa.h(this.$).Ea.gwa(ya,
this.$.activeItemName);if(Va&&dc.Ct(Va))for(let oa of Va)oa.q1d(ya,!0)}ovf(ya,Va){const oa=ya.JQ,kb=Fa.h(this.$).Sb(Va[0]);let Sa=null,U=null;this.Uic&&(Sa=this.X5h(kb),U=this.Y5h(kb));const ta=this.K2h(oa,kb,Va[0],ya);if(this.aBb&&(!ta||0==ta.length))return ta;this.Ari?this.U_j(Va[0]):Fa.h(this.$).Ea.H$(Va[0],this.$.activeItemName).q1d(Va[0],!0);this.v3(this.m5(kb),!0,9,ya.scenario,"merge");if(this.Uic&&this.vpd(ya)){Va=this.fYh(oa,Va[0]);for(const ub of ta)this.u$h(ya,ub,Sa,U,Va)}return ta}mSg(ya,
Va,oa){if(!(1>ya.Borders.length)){var kb=this.PZ(ya.Borders);oa.forEach(Sa=>{Sa=Fa.h(this.$).Sb(Sa.getRange());this.zg.S8f(-1690267012,Sa,kb,!1,null,!1,Va)})}}uXj(ya,Va,oa){const kb=ya.length;for(let U=0;U<kb;U++){ya[U].cell.uEc();const ta=ya[U].cell.getRange(),ub=Fa.h(this.$).Ea.Rja(ta),hc=ub.length;if(-167499203===Va&&this.Tic){var Sa=0;2===ya[U].cell.dKd||1===ya[U].cell.PJ?Sa=3:2===ya[U].cell.PJ&&(Sa=1);ya[U].W0(Sa,!1)}for(Sa=1;Sa<hc;Sa++)ub[Sa].attachCellToModel(),ub[Sa].yrb(ya[U]),-167499203===
Va&&this.Tic&&ub[Sa].W0(null,!1);this.dnf&&oa&&this.mSg(oa[U],ta,ub)}}X_e(ya,Va){let oa=null;for(let kb=0;kb<ya.length;kb++)if(ya[kb].BorderPosition===Va){oa=ya[kb];break}return oa}rQh(ya,Va){let oa=ya.cell.iN();ya.gMa()&&ya.cell.rRa(1);ya.kMa()&&ya.cell.rRa(3);if((ya=this.Kx.NQ(Va,0))&&ya[0].gMa){var kb=ya[0].iN().Borders;kb=this.X_e(kb,1);kb.BorderPosition=0;oa.Borders.push(kb);ya.forEach(Sa=>{Sa.rRa(1)})}(Va=this.Kx.NQ(Va,2))&&Va[0].kMa&&(ya=Va[0].iN().Borders,ya=this.X_e(ya,3),ya.BorderPosition=
2,oa.Borders.push(ya),Va.forEach(Sa=>{Sa.rRa(3)}));return oa}Lgg(ya,Va,oa){var kb=Fa.h(this.$).Ea.hwa(Va[0],this.$.activeItemName);const Sa=Fa.h(this.$).Ea.H$(Va[0],this.$.activeItemName),U=[];if(void 0!==kb&&null!==kb&&(Va=Fa.h(this.$).aka(Va[0],kb),void 0!==Va&&null!==Va)){Va=Va.$$ge();for(kb=[];Va.$$mn();){var ta=Va.$$cu();if(ta.cI){U.push(ta);this.v3(this.m5(ta),!0,10,ya,"unmerge");ta.cell.X4g();const ub=ta.cell.getRange();this.v3(this.m5(ta),!1,11,ya,"unmerge");Sa.q1d(ub,!1);this.dnf&&(ta=this.rQh(ta,
ub),kb.push(ta))}}0<U.length&&(Sa.rf.resetCellLookup(),this.uXj(U,oa,kb))}}v3(ya,Va,oa,kb,Sa){if(!this.ajf)return!1;ya!==Va&&v.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${oa}; Scenario: ${kb}; Command: ${Sa}; Expected: ${Va?"populated":"empty"}; Actual: ${ya?"populated":"empty"}`);return ya}m5(ya){return!!ya.cell.cell.Merge}}Object(u.a)(Cb,"MergeCellCommandAction",null,[]);var Tb=a(67),Jb=a(173),eb=a(44),za=a(461),ha=a(377),fb=a(51),rb=
a(69),pa=a(55),Ma=a(1087),Ja=a(33),Ga=a(343),La=a(145),nb=a(211),Lb=a(4);class ac{constructor(ya,Va,oa,kb,Sa,U,ta){this.$=ya;this.gridView=Va;this.zg=oa;this.SB=kb;this.borderFormatManager=Sa;this.moreColorsHelper=U;this.fontDropdownHelper=ta;this.RC=null;this.z0a=1461300262;this.Dx=this.w0a=this.b$a=this.kbc=null;this.iVi=(ub,hc,Bc)=>{const Qa=!!ub&&!!ub.RequestTelemetryData;!Oa.a(ub)&&hc&&Fa.h(this.$).ji.gma(hc,ub.StateId,Qa?ub.RequestTelemetryData.EcsOperationDuration:0,Qa?ub.RequestTelemetryData.EcsRequestDuration:
0,Qa?ub.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){hc=1;if(33===Bc||17===Bc||9===Bc||5===Bc||37===Bc)hc=0;this.q1(hc,ub)}};this.SRi=ub=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.q1(3,ub)};this.trb=()=>{if(this.gridView.y7a){const ub=this.$.da.za(254,!0);ub&&ub.Fkj(this.trb);this.gridView.y7a=
!1;this.gridView.Gf.gm(G.a.TQ);this.gridView.ha.MW(this.Rdd);Fa.h(this.$).$.af()}};this.Rdd=()=>{var ub=this.kbc;this.kbc=H.d(this.$.xa.na);ub===this.kbc&&(this.gridView.ha.MW(this.Rdd),(ub=this.$.da.za(254,!0))&&ub.Z0c(36,Fa.h(this.$).ha.ra.selectedRanges)?(ub=new Ba.a(1804571062,2,2,0,null),this.$.Ka.Lb(ub,{[G.a.skipClipboardAccess]:!0,[G.a.z2c]:!0,[G.a.isFormatPainter]:!0}).continueWith(()=>{this.trb()})):this.gridView.Gf.tH(!1))};this.xb=d.EwaSettings.xb();this.mergeCellCommandAction=new Cb(this.$,
oa);this.ED=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Wl=d.EwaSettings.Wl();this.Gl=Ja.a.Gl();this.AB=Ja.a.AB(this.$)}get Tlf(){return t.a.all(this.gridView.ha.ra.selectedRanges,ya=>ya.isRow)}get Plf(){return t.a.all(this.gridView.ha.ra.selectedRanges,ya=>ya.hf)}get themesManager(){this.Dx||(this.Dx=this.$.da.za(422));return this.Dx}q1(ya,Va){const oa=this.$.da.za(465);oa&&oa.q1(ya,Va)}zqi(ya){return 1896159024===ya||-1554384558===ya||-1113896058===ya||1554436520===
ya||1415868706===ya||674605324===ya||1035996630===ya}nc(ya,Va){return 2054778433===Va&&ya&1?!V.a(this.$).Fjc:600686207===Va?!1:this.zqi(Va)&&t.a.any(this.gridView.ha.ra.selectedRanges,oa=>oa.hf||oa.isRow)&&!this.Tlf&&!this.Plf?!0:this.bkc(ya,Va)}executeCommand(ya,Va,oa){return this.Lb(Va,oa)}wc(ya,Va,oa){if(ya=1===ya)switch(Va.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:ya=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:ya=
!!oa;break;case 862825906:case 1532790410:case 46555851:case -1522760979:ya=!0;break;default:ya=!1}return ya}Jc(ya,Va,oa){switch(Va){case "PopulateFontColor":oa.MenuItems=this.SB.kcc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,oa.MenuId);break;case "PopulateFillColor":oa.MenuItems=this.SB.kcc(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,oa.MenuId);break;case "PopulateBorderColor":oa.MenuItems=this.SB.kcc(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,oa.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.P$h(oa);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.Gl&&(this.fontDropdownHelper.Ozj(oa.MenuId),!this.fontDropdownHelper.rpi()))return!1;oa.MenuItems=this.fontDropdownHelper.r_e(-1293291468,324978188,-1428968098,oa.MenuId);break;default:return!1}return!0}bkc(ya,Va){const oa=Fa.h(this.$).ha.ra.selectedRanges;return!(new ca.a(this.$.xa)).zm(ya,Va,oa,this.gridView)}Lb(ya,
Va){var oa=this.gridView;const kb=ya.command;var Sa=f.TaskExtensions.Rj();let U=!0;switch(kb){case -1077965542:U=this.t$e(Va,ya,!1);break;case 909774670:this.Eqb(kb);U=this.t$e(Va,ya,!0);break;case -1293291468:U=this.r$e(Va,ya,!1);break;case 324978188:this.Eqb(kb);U=this.r$e(Va,ya,!0);break;case 862890474:case 963349338:U=this.h$h(ya);break;case -1832800737:U=this.Pec(kb,Va,!1,ya);break;case 1970784898:U=this.Pec(kb,Va,!1,ya);break;case -803000997:U=this.Pec(kb,Va,!1,ya);break;case -128950598:case 1688184685:this.Eqb(kb);
U=this.Pec(kb,Va,!0,ya);break;case 1597684571:U=this.dyb(kb,Va,!1,ya);break;case 87208751:Va.Color="-1";Va.IntColor=!0;U=this.dyb(kb,Va,!1,ya);break;case -446735083:this.Eqb(kb);Va.Color="-1";Va.IntColor=!0;U=this.dyb(kb,Va,!0,ya);break;case 1650812936:U=this.dyb(kb,Va,!1,ya);break;case 673562736:this.Eqb(kb);U=this.dyb(kb,Va,!0,ya);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.$Yf(kb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:U=
this.T9h(kb,ya);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:U=this.e9h(kb,ya);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:U=this.K$h(kb,ya);break;case -1803452024:case -236759591:U=this.Bkd(kb,Va,ya);break;case -2118943501:U=this.borderFormatManager.l9h(Va,ya);break;case 1012765228:U=this.borderFormatManager.fai(Va,ya);break;case 1256700402:U=this.borderFormatManager.Fkd(ya);
break;case -1756763834:U=this.borderFormatManager.Gkd(ya);break;case -1418159950:U=this.borderFormatManager.e$e(ya);break;case -1920201820:case -1942512156:U=this.i$h(kb,ya);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:U=this.borderFormatManager.R9e(Va,ya);this.fHh(Va);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:U=this.G$h(kb,Va,ya);break;case -693675336:case 322710748:break;case 1696566924:U=this.U9h(ya);break;case -167499203:case -255094134:case 1097660126:case 155820588:Sa=
this.handleMergeCellsCommand(this.gridView,ya);break;case 1896159024:case -1554384558:Va=this.gridView.ha.ra.selectedRanges;if(this.sGj(ya,Va))v.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new xa(this.$,kb,Va)).dg(),U=!0;else if(t.a.any(Va,ta=>this.gridView.Bb.K5(ta))){oa="";Sa=1461300262;const ta=-1554384558===kb&&this.gridView.Bb.Osi(Va[0]);Va=Va[0].height>Va[0].width&&!ta;switch(kb){case 1896159024:oa=Va?"InsertColumnsTable":"InsertRowsTable";
Sa=Va?622604322:942362098;break;case -1554384558:oa=Va?"DeleteColumnsTable":"DeleteRowsTable",Sa=Va?284490184:1405456548}Va=ka.a.xq(ac.zod,oa,1);new Ba.a(Sa,1,2,6,null);Sa=this.insertOrDeleteCells(Va,ya,!0)}else Sa=this.insertOrDeleteCells(1896159024===kb?1:2,ya,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Sa=this.insertOrDeleteCells(ka.a.xq(ac.zod,Va[J.a.Ic],1),ya,!0);this.AB&&(ya=Fa.h(this.$),nb.d(this.$,ya.ha.ra.activeCell,kb,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Sa=
this.insertOrDeleteCells(ka.a.xq(ac.zod,Va[J.a.Ic],1),ya,!1);break;case 504848446:Sa=oa.startEdit(!1,1,Va[G.a.event],void 0,void 0,!0);break;case 1504715724:if(Fa.h(this.$).Hz&&this.borderFormatManager.MU.CB)break;Sa=oa.startEdit(!0,0,Va[G.a.event],void 0,void 0,!0);break;case 1872288872:this.trb();break;case 41465729:Sa=this.fill(oa.ha.ra.$c,null,0,1,ya);break;case -1451655532:case 1972143101:Sa=this.fillDownAbsoluteValueAndStartEdit(oa,Va[G.a.event],-1451655532===kb);break;case -475861485:Sa=this.fill(oa.ha.ra.$c,
null,oa.rtl?1:2,1,ya);break;case -978843926:Sa=this.fill(oa.ha.ra.$c,null,3,1,ya);break;case 2098035706:Sa=this.fill(oa.ha.ra.$c,null,oa.rtl?2:1,1,ya);break;case -2142700828:Sa=this.fill(oa.ha.sourceRange,oa.ha.ra.$c,ac.L2e(oa.ha.ra.$c,oa.ha.sourceRange),2,ya);break;case 1405660955:Sa=this.fill(oa.ha.sourceRange,oa.ha.ra.$c,ac.L2e(oa.ha.ra.$c,oa.ha.sourceRange),4,ya);break;case 1983983164:Sa=this.fill(oa.ha.ra.$c,null,0,0,ya);break;case 478842689:(ya=this.$.da.za(376))?(ya.Laj(),U=!0):v.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:U=oa.ha.Lb(null,kb);break;case -208772570:this.B$h();U=!0;break;case -987339782:this.t9h();U=!0;break;case -1770246794:oa.ha.u9h();U=!0;break;case 748067091:case -381232414:this.x9h(kb);U=!0;break;case -1522760979:this.gridView.toggleFormulaView();U=!0;break;case 886009118:Sa=this.f$h();break;case 894341014:this.k$h();
U=!0;break;case 862825906:Sa=this.J$e(1970784898,ya);break;case 1532790410:Sa=this.J$e(1650812936,ya);break;case 46555851:Sa=this.x$h(ya);break;default:U=!1}U||(Sa=aa.a(kb));return Sa}fHh(ya){ya&&ya.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(ya.MenuItemId)&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.EWg(new Ga.a(this.gridView.ha.ra.activeRange,H.d(this.$.xa.na)))}EWg(ya){f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
426,427,1),Va=>{void Va.result.OCc(ya,"BorderActions")},this.$.la,3)}sGj(ya,Va){const oa=t.a.all(Va,U=>!this.gridView.Bb.K5(U)),kb=1<Va.length&&!!this.gridView.Bb.sjd(Va),Sa=t.a.all(Va,U=>!this.gridView.Bb.J5(U));Va=!t.a.any(Va,U=>U.isRow||U.hf);return 1===ya.method&&6===ya.$e&&(oa||kb)&&Sa&&Va}fillDownAbsoluteValueAndStartEdit(ya,Va,oa){const kb=ya.ha.ra.activeCell,Sa=W.E(kb,this.gridView.jt);return ya.startEdit(!0,0,Va).jp(()=>{const U=ya.Sb(Sa),ta=ya.Sb(kb);if(!U||!ta)return v.ULS.shipAssertTag(537159507,
0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${kb.toString()} and above cell: ${Sa.toString()}`),pa.Task.Ta(!1);this.gridView.Vb.text=oa?U.AX:U.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return pa.Task.Ta(!0)})}insertOrDeleteCells(ya,Va,oa){const kb=z.a.create().toString();var Sa=Enum.toString(P,ya);this.gridView.ji.g8(17,kb,Sa);Sa=this.gridView.ha.ra.selectedRanges;var U=this.Tlf,ta=this.Plf;if(!this.$.Zp(null,!1,void 0,Va.$e)&&!ta&&!U&&
5!==ya&&9!==ya)return pa.Task.Ta(!0);2===ya?ya=ta?10:U?6:Sa[0].height>Sa[0].width?18:34:1===ya?ya=ta?9:U?5:Sa[0].height>Sa[0].width?17:33:18===ya&&U?ya=34:34===ya&&ta&&(ya=18);Sa=this.fQg(Sa,ya);if((10===ya||6===ya)&&!this.$.Zp(Sa,!0,1,Va.$e))return pa.Task.Ta(!0);const ub={};ub.InsertDeleteRangeItems=Array(Sa.length);ub.SheetName=this.$.na.sheetName;ub.IsTableCommand=oa;for(oa=0;oa<Sa.length;oa++){U=Sa[oa];ta={};let na,ab;ya&4?(ta.FirstRow=U.top-1,ta.LastRow=X.a.Pz,ta.FirstColumn=0,ta.LastColumn=
X.a.Rw,na=U.bottom-U.top+1,ab=0,6===ya?(U.hf||(ta.FirstRow=U.bottom),na=-na):La.b("InsertRowsAbove"),37===ya&&(ta.FirstRow=U.bottom,La.b("InsertRowsBelow"))):ya&8?(ta.FirstRow=0,ta.LastRow=X.a.Pz,ta.FirstColumn=U.left-1,ta.LastColumn=X.a.Rw,na=0,ab=U.right-U.left+1,10===ya&&(U.isRow||(ta.FirstColumn=U.right),ab=-ab)):ya&16?(ta.FirstRow=U.top-1,ta.LastRow=U.bottom-1,ta.FirstColumn=U.left-1,ta.LastColumn=X.a.Rw,na=0,ab=U.right-U.left+1,18===ya&&(ta.FirstColumn=U.right,ab=-ab)):(ta.FirstRow=U.top-1,
ta.LastRow=X.a.Pz,ta.FirstColumn=U.left-1,ta.LastColumn=U.right-1,na=U.bottom-U.top+1,ab=0,34===ya&&(ta.FirstRow=U.bottom,na=-na));const Gb={};Gb.InsertDeleteRange=ta;Gb.DeltaRow=na;Gb.DeltaColumn=ab;Gb.AdjustedSelectedRange=W.j(U);ub.InsertDeleteRangeItems[oa]=Gb}this.gridView.Gf.tH(!1);const hc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");ub.IsDecoupleRecalc=hc;const Bc=this.$.pa.ya.Wb(),Qa=()=>new M(ub);return O.a(this.$.userOperationManager,(na,ab,Gb)=>{hc&&
!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.Qy();return fa(this.$.pa.ya,ub,Ha.b(na,(fc,pb)=>{this.iVi(fc,pb,ya)},()=>{this.XUj(ya,ub)}),ab,Gb,kb,Bc)},na=>new T.a(237,0,na,void 0,Qa),Va)}XUj(ya,Va){const oa=this.r5h(ya);if(oa&&1===Va.InsertDeleteRangeItems.length){var kb=Va.InsertDeleteRangeItems[0];1<kb.DeltaColumn||1<kb.DeltaRow||(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:7334505_FixLatePSCardFlightCheck")||this.Etd(oa))&&f.TaskExtensions.Aa(e.GetServiceTaskFactory.Oa(this.$.da,
426,427,1),Sa=>{const U=new Ga.a(W.B(kb.AdjustedSelectedRange),H.d(this.$.xa.na));void Sa.result.OCc(U,oa)},this.$.la,3)}}Etd(ya){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===ya||"DeleteRow"===ya?(Lb.AFrameworkApplication.Rt("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",
!1)):"InsertColumn"===ya||"InsertRow"===ya?(Lb.AFrameworkApplication.Rt("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):!1:(Lb.AFrameworkApplication.Rt("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),!1)}r5h(ya){let Va;switch(ya){case 5:Va="InsertRow";break;
case 9:Va="InsertColumn";break;case 6:Va="DeleteRow";break;case 10:Va="DeleteColumn"}return Va}fQg(ya,Va){return Va&32?this.b_a(ya,oa=>oa.bottom,oa=>oa.top,(oa,kb)=>{oa.bottom=kb},!1,!0):Va&16?this.gridView.rtl?this.b_a(ya,oa=>oa.left,oa=>oa.right,(oa,kb)=>{oa.left=kb},!1,!1):this.b_a(ya,oa=>oa.right,oa=>oa.left,(oa,kb)=>{oa.right=kb},!1,!1):Va&4?this.b_a(ya,oa=>oa.bottom,oa=>oa.top,(oa,kb)=>{oa.bottom=kb},!0,!0):Va&8?this.gridView.rtl?this.b_a(ya,oa=>oa.left,oa=>oa.right,(oa,kb)=>{oa.left=kb},!0,
!1):this.b_a(ya,oa=>oa.right,oa=>oa.left,(oa,kb)=>{oa.right=kb},!0,!1):ya}b_a(ya,Va,oa,kb,Sa,U){ya=W.d(ya);ya.sort((ta,ub)=>Va(ub)-Va(ta));if(Sa){Sa=[];U=U?X.a.eh+1:X.a.qh+1;for(let ta=0;ta<ya.length;ta++){const ub=ya[ta];oa(ub)<U&&(kb(ub,Math.min(Va(ub),U-1)),Sa.push(ub),U=oa(ub))}ya=Sa}return ya}fill(ya,Va,oa,kb,Sa){const U=this.$;if(!U.Zp([Va],!0))return pa.Task.Ta(!0);const ta=W.v(ya,U),ub=Va?W.v(Va,U):ta,hc=this.$.pa.ya.Wb(),Bc=()=>new ua(ta,ub,kb,oa);return O.a(this.$.userOperationManager,(Qa,
na,ab)=>{this.$.Qy();var Gb=this.$.pa.ya;Qa=Ha.b(Qa,this.SRi);const fc=Gb.Na(9,hc);fc.sourceRange=ta;fc.targetRange=ub;fc.fillDirection=oa;fc.fillType=kb;return Y.g(Gb,"FillRange",fc,Qa,na,ab,null,0)},Qa=>new T.a(155,0,Qa,void 0,Bc),Sa)}G$h(ya,Va,oa){const kb={ValidMembers:32};switch(ya){case 1890566896:ya=parseInt(Va[J.a.Ic].toString(),10);if(14===ya)return oa=new Ba.a(2105621672,oa.method,oa.mode,oa.$e,oa.tabName),Va[J.a.Ic]=null,this.$.Ka.Lb(oa,Va),v.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;kb.NumberFormat=ya;break;case 1886928607:kb.NumberFormat=13;break;case -992833457:kb.NumberFormat=11;break;case 218524921:kb.NumberFormat=12;break;case 996232352:kb.NumberFormat=1006;break;default:return v.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+fb.b().uj(oa.command)),!1}v.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${fb.b().uj(oa.command)} command, with menu item ${Va[J.a.Ic]}.`);this.zg.formatCells(1890566896,kb,oa);
this.$.af();return!0}h$h(ya){var Va=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(this.xb&&this.gridView.eb){Va=this.gridView.zi.d5a(Va?Jb.a(Va).Font:null);if(!Va)return v.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.ra.activeCell.toString()} is null while editing`),!1;var oa=Va.FontSize}else if(Va)oa=Va.fontSize;else return!1;Va=ya.command;let kb=0;if(862890474===Va)for(;kb<ac.FKa.length-1&&ac.FKa[kb]<=oa;)kb++;
else if(963349338===Va)for(kb=ac.FKa.length-1;0<kb&&ac.FKa[kb]>=oa;)kb--;v.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${oa} to size ${ac.FKa[kb]}`);if(oa===ac.FKa[kb])return!0;oa=ac.$xc(2);oa.Font.FontSize=ac.FKa[kb];this.xb&&this.gridView.eb?(this.fpb(ya,!1,oa),this.$.af()):this.zg.formatCells(Va,oa,ya);return!0}t$e(ya,Va,oa){ya=ya[ya[r.a.IsFreeForm]?r.a.Value:J.a.lg].toString();if(!ac.d7i.test(ya))return v.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;ya=parseFloat(ya);if(8>ya||72<ya)return v.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const kb=Math.round(2*ya)/2,Sa=ac.$xc(2);Sa.Font.FontSize=kb;this.xb&&this.gridView.eb?(this.fpb(Va,oa,Sa,!0),kb===ya||oa||this.$.af()):oa?this.zg.vea(this.gridView,-1077965542,Sa,oa):(this.zg.formatCells(-1077965542,Sa,Va),this.$0a());
return!0}r$e(ya,Va,oa){var kb=ya[J.a.lg];if(this.Gl){var Sa=this.fontDropdownHelper.tBc?this.fontDropdownHelper.tBc[kb]:null;Sa||(v.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${kb}`),Sa=qa.HelperMethods.UO[kb])}else Sa=qa.HelperMethods.UO[kb];let U=0;this.Wl&&(ya=ya.MenuItemId,ya===Ma.b?(kb==this.themesManager.CG.Izd&&(Sa=kb),U=2):ya===Ma.a&&(kb==this.themesManager.CG.tyd&&(Sa=kb),U=1),v.ULS.sendTraceTag(510247702,
1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==U}`));if(!Sa)return!0;kb=ac.$xc(1);kb.Font.FontName=Sa;this.Wl&&(kb.Font.FontScheme=U);this.xb&&this.gridView.eb?(this.fpb(Va,oa,kb),this.$.af()):oa?this.zg.vea(this.gridView,-1293291468,kb,oa):(this.zg.formatCells(-1293291468,kb,Va),this.$0a());return!0}Pec(ya,Va,oa,kb){let Sa=-803000997===ya||1688184685===ya?"black":Va.Color;this.moreColorsHelper&&(-1832800737===ya?Sa=ia.a.compare(Sa,"WindowText",!0)?this.moreColorsHelper.dcb:
"black":oa||(this.moreColorsHelper.dcb=Sa,this.moreColorsHelper.Fda(Va,Sa,kb)));ya=ac.$xc(32);ya.Font.FontColor=ea.a.JH(Sa,ka.a.wg(Va,"IntColor"));this.xb&&this.gridView.eb?this.fpb(kb,oa,ya,17===kb.$e):oa?this.zg.vea(this.gridView,1970784898,ya,oa):(this.ED&&({themeColor:Va}=this.getThemeColor(Va)).returnValue&&(ya.Font.ThemeFontColor=Va,ya.Font.ColorTypeOption=1),this.zg.formatCells(1970784898,ya,kb),this.$0a());return!0}x9h(ya){var Va=(new Date).format(748067091===ya?this.$.va.ShortDateFormat:
this.$.va.ShortTimeFormat);const oa=this.gridView.Vl?ra.a(this.gridView.$):this.gridView.Vb;ya=oa.textBox;this.gridView.eb?oa.insertText(Va):(this.gridView.startEdit(!0,0),oa.text=Va,Va=Va.length,ya.Wdb(Va),ya.caretPosition=Va)}B$h(){this.gridView.MK(this.gridView.ha.ra.activeCell)||this.gridView.uxc||this.gridView.GNa()||this.gridView.Ht(this.gridView.ha.ra.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}t9h(){if(!(this.gridView.uxc||this.gridView.GNa()||this.gridView.eb&&n.a.isMac)){const ya=
this.gridView.ha.ra.E4;this.gridView.pg(W.v(ya,this.$),ya,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}U9h(ya){this.kbc=H.d(this.$.xa.na);const Va=this.$.da.za(254,!0);if(this.gridView.y7a)return this.gridView.Gf.tH(!1),!!Va;if(!Va)return v.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.HY(this.Rdd);const oa=String.format(G.a.hua,N.a.current.io(108));this.gridView.Gf.gm(oa);ya=new Ba.a(-911352779,
ya.method,ya.mode,ya.$e,ya.tabName);this.$.Ka.Lb(ya,{[G.a.silentClipboardAccessFailures]:!0,[G.a.isFormatPainter]:!0}).continueWith(kb=>{(6>kb.status||6===kb.status&&!kb.result)&&this.trb()});this.gridView.y7a=!0;Va.cOg(this.trb);return!0}dyb(ya,Va,oa,kb){let Sa=87208751===ya?"-1":Va.Color;this.moreColorsHelper&&(1597684571===ya?Sa=this.moreColorsHelper.cRa:oa||(this.moreColorsHelper.cRa=Sa===ac.notSet?ac.y_d:Sa,this.moreColorsHelper.Fda(Va,Sa,kb)));ya={ValidMembers:64};ya.FillColor=ea.a.JH(Sa,ka.a.wg(Va,
"IntColor"));oa?this.zg.vea(this.gridView,1650812936,ya,!0):(this.ED&&({themeColor:Va}=this.getThemeColor(Va)).returnValue&&(ya.ThemeFillColor=Va,ya.ColorTypeOption=1),this.zg.formatCells(1650812936,ya,kb),this.$0a());return!0}k$h(){v.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const ya=this.$.da.za(221);if(ya){var Va=this.gridView.zi;if(Va){var oa,kb,Sa=({Vwf:oa,mYe:kb}=ya.sji(Va.text,Va.textBox.caretPosition)).returnValue;
Sa?(ya.qe=!1,Va.text=Sa,Va.textBox.selectRange(oa,oa+kb),v.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):v.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else v.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else v.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}T9h(ya,Va){let oa=0;const kb=this.gridView,Sa=Jb.a(kb.Sb(null));this.xb&&kb.eb&&(Sa.Font=kb.zi.d5a(Sa.Font));let U=Sa.Font;U||(U={ValidMembers:0});switch(ya){case -287251124:oa|=4;wa.e(U,4)?U.Bold=!U.Bold:U.Bold=!0;break;case -1925065947:oa|=8;wa.e(U,8)?U.Italic=!U.Italic:U.Italic=!0;break;case 1764140053:oa|=16;wa.e(U,16)?U.Underline=!U.Underline:U.Underline=!0;break;case -1685033574:oa|=64;wa.e(U,64)?
U.DoubleUnderline=!U.DoubleUnderline:U.DoubleUnderline=!0;break;case -1590502662:oa|=128,wa.e(U,128)?U.Strikethrough=!U.Strikethrough:U.Strikethrough=!0}if(!oa)return!1;U.ValidMembers=oa;Sa.Font=U;Sa.ValidMembers=16;this.xb&&this.gridView.eb?this.fpb(Va,!1,Sa):(d.EwaSettings.ma(647)||kb.Gf.tH(!1),this.zg.formatCells(ya,Sa,Va));this.$.af();return!0}e9h(ya,Va){let oa=0;const kb=this.gridView,Sa=Jb.a(kb.Sb(null));-571165336===ya||1041132226===ya||-394785302===ya?(oa|=1,Sa.VerticalAlignment=ka.a.xq(ac.k_a,
ya.toString(),2)):ac.fqi(ya)?(oa|=2,this.c$h(Sa,ya)):-1116189897===ya&&(oa|=8,Sa.Wrap=Sa.ValidMembers&8?!Sa.Wrap:!0);if(!oa)return!1;Sa.ValidMembers=oa;d.EwaSettings.ma(647)||kb.Gf.tH(!1);this.zg.formatCells(ya,Sa,Va);this.$.af();return!0}c$h(ya,Va){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==Va&&(Va=-1150205178===Va?-286432209:-1150205178);Va=ka.a.xq(ac.k_a,Va.toString(),0);ya.HorizontalAlignment=Va===ya.HorizontalAlignment?
0:Va}SOf(ya,Va,oa,kb){let Sa=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Sa=this.mergeCellCommandAction.nvf(Va,oa))&&Fa.h(this.$).ji.yS(this.b$a,Tb.BasicTelemetryCalculator.cR);return this.xub(ya,Va,!1,Sa,U=>{this.rWi(U,oa,Va,Sa,kb)})}handleMergeCellsCommand(ya,Va){this.b$a=z.a.create().toString();let oa=null;oa=this.mergeCellCommandAction.B4e();var kb=C.a(Va.command);const Sa=this.mergeCellCommandAction.Wni(Va.command,oa);let U=0;Sa?U=w.a.Ud():Fa.h(this.$).ji.g8(4,
this.b$a,kb+", Scenario = "+oa.scenario.toString());kb=ya.ha.ra.selectedRanges;v.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${fb.b().uj(Va.command)}, Number of ranges: ${kb.length}, Ranges: ${W.i(kb,",",this.$,!1)}`);kb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);ya.Gf.tH(!1,kb);if(10===ka.a.xq(ac.pvf,Va.command.toString(),10))return pa.Task.Ta(!1);const ta=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",
!1);if(kb&&ta)return Sa?(this.x8f(oa,Va,!0,!0,U),pa.Task.Ta(!0)):this.SOf(ya,Va,oa,!1);let ub=!1;kb&&(ub=this.mergeCellCommandAction.nvf(Va,oa))&&Fa.h(this.$).ji.yS(this.b$a,Tb.BasicTelemetryCalculator.cR);return this.xub(ya,Va,!1,ub,hc=>{this.sWi(hc,Va,ub)})}xub(ya,Va,oa,kb,Sa=null){const U=this.$.pa.ya.Wb(),ta=ka.a.xq(ac.pvf,Va.command.toString(),10),ub=W.r(ya.ha.ra.selectedRanges,ya.$),hc=()=>new S.a(ta,ub),Bc=Qa=>{const na=!!Qa&&!!Qa.RequestTelemetryData;Fa.h(this.$).ji.gma(this.b$a,Qa.StateId,
na?Qa.RequestTelemetryData.EcsOperationDuration:0,na?Qa.RequestTelemetryData.EcsRequestDuration:0,na?Qa.RequestTelemetryData.WfeRequestDuration:0)};ya=(Qa,na,ab)=>{this.$.Qy();Qa=Sa?Ha.b(Qa,Sa):Qa;Qa=Ha.b(Qa,Bc);return Y.d(this.$.pa.ya,ta,ub,oa,Qa,na,ab,null,U)};return kb?O.a(this.$.userOperationManager,ya,Qa=>new T.a(156,0,Qa,64,hc),Va):O.a(this.$.userOperationManager,ya,Qa=>new T.a(156,0,Qa,void 0,hc),Va)}x8f(ya,Va,oa,kb=!1,Sa=0){v.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${oa}`);
var U=Fa.h(this.$).rtl;U=Ka.a.Zc(3,2,0,U?635:634,0,514846606,"MergeCellsLoseData");f.TaskExtensions.Aa(eb.a(this.$).vj(U),ta=>{ta=ta.result;if(kb){const ub=w.a.Ud()-Sa;v.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${ub}, and the user action is : ${ta}`)}0===ta?(v.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),oa?(kb&&(ta=C.a(Va.command),Fa.h(this.$).ji.g8(4,this.b$a,ta+", Scenario = "+ya.scenario.toString())),this.SOf(Fa.h(this.$),
Va,ya,!0)):this.xub(this.gridView,Va,!0,!1)):1===ta&&v.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}bCi(ya,Va,oa,kb){Va!==ya&&v.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${Va} and as per server is ${ya}. The scenario is:- ${oa}, The CSE is done:- ${kb}`)}sWi(ya,Va,oa){Oa.b(ya,514846606)&&(v.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),
rb.a(this.$).fd.xM(514846606),ya=Fa.h(this.$).rtl,ya=Ka.a.Zc(3,2,0,ya?635:634,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.Aa(eb.a(this.$).vj(ya),kb=>{kb=kb.result;0===kb?(v.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.xub(this.gridView,Va,!0,oa)):1===kb&&v.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}rWi(ya,Va,oa,kb,Sa){let U=!1;Oa.b(ya,514846606)&&(U=!0,rb.a(this.$).fd.xM(514846606),kb&&Sa?window.setTimeout(()=>
{this.xub(this.gridView,oa,!0,!0)},0):this.x8f(Va,oa,!1));this.bCi(U,Sa,Va.scenario,kb)}Eqb(ya){if(this.z0a!==ya&&1461300262!==this.z0a){this.$Yf(this.z0a);var Va=fb.b().uj(ya);const oa=fb.b().uj(this.z0a);v.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${oa} was restored before caching the style for ${Va} command.`)}this.z0a=ya;if(this.xb&&this.gridView.eb)this.w0a||(this.w0a=this.gridView.zi.formattedText);else if(!this.RC){this.RC=[];Va=this.gridView.laa("GridCommandHandler.CacheFontStyles",
this.gridView.ha.ra.selectedRanges);try{for(Va.$$rst();Va.$$mn();){const oa=Va.$$cu();if(oa.cell.hasRichText)this.RC.push(Z.ZYg(oa,oa.cell.formattedText));else switch(ya){case 673562736:case -446735083:this.RC.push(Z.m0c(oa,oa.backgroundColor));break;case -128950598:case 1688184685:this.RC.push(Z.m0c(oa,oa.color));break;case 909774670:this.RC.push(Z.$Yg(oa,oa.fontSize));break;case 324978188:this.Wl?this.RC.push(Z.YYg(oa,oa.fontName,oa.MZ)):this.RC.push(Z.m0c(oa,oa.fontName))}}}finally{Va&&Va.dispose()}}}SKj(){return this.xb&&
this.gridView.eb?!this.w0a:!this.RC}Kmi(ya){return!!this.RC&&this.RC.length>ya&&!!this.RC[ya].formattedText}pfd(ya){return this.RC[ya].style}XQh(ya){return this.RC[ya].size}WQh(ya){return this.RC[ya].MZ}$Yf(ya){if(!this.SKj()){if(this.xb&&this.gridView.eb)this.w0a&&(this.gridView.Vb.formattedText=this.w0a);else{const oa=this.RC.length;for(let kb=0;kb<oa;kb++){let Sa;var Va=this.RC[kb].Gja.cell.getRange();Sa=this.gridView.Sb(Va);if(!Sa){v.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${Va.Cz(!1)}`);
continue}let U;Va=Sa.cI?this.gridView.QLb(Sa.range):(U=new L.a,U.add(Sa),U);for(let ta of Va)if(ta.cell.hasRichText&&1457172838!==ya)this.Kmi(kb)&&(ta.cell.formattedText=this.RC[kb].formattedText);else switch(ya){case 1457172838:ta.backgroundColor=this.pfd(kb);break;case 2036397036:ta.color=this.pfd(kb);break;case -1904244080:ta.fontSize=this.XQh(kb);break;case -1428968098:ta.fontName=this.pfd(kb),this.Wl&&ta.X3f(this.WQh(kb))}}}this.z0a=1461300262;this.$0a()}}$0a(){this.xb&&this.gridView.eb?this.w0a=
null:this.RC=null}i$h(ya,Va){const oa={IndentationIncrease:0};if(-1942512156===ya)oa.IndentationIncrease=1;else if(-1920201820===ya)oa.IndentationIncrease=-1;else return!0;oa.ValidMembers=256;this.zg.formatCells(ya,oa,Va);return!0}K$h(ya,Va){var oa=this.gridView.Sb(null);oa=Jb.a(oa);var kb=ya;!Fa.h(this.$).rtl||-1649235364!==ya&&524773427!==ya||(kb=-1649235364===ya?524773427:-1649235364);switch(kb){case -1649235364:kb=X.a.rotateTextUp45;break;case 524773427:kb=X.a.vwc;break;case 1886217042:kb=X.a.rotateTextUp90;
break;case 928057943:kb=X.a.xwc;break;case -1526602249:kb=X.a.verticalText;break;default:return!1}oa.ValidMembers=512;const Sa=oa.TextOrientation;oa.TextOrientation=kb===Sa||Sa===X.a.uwc&&kb===X.a.vwc||Sa===X.a.wwc&&kb===X.a.xwc?0:kb;this.zg.formatCells(ya,oa,Va);return!0}f$h(){const ya=Fa.h(this.$),Va=W.r(ya.ha.ra.selectedRanges,this.$),oa=W.o(ya.ha.ra.activeCell,this.$);v.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return O.a(this.$.userOperationManager,
(kb,Sa,U)=>va.r(this.$.pa.ya,oa,Va,kb,Sa,U,null),kb=>new T.a(201,0,kb),null)}J$e(ya,Va){let oa=null;var kb=Fa.h(this.$).ha.ra.selectedRanges;kb=this.gridView.laa("MoreColors",kb,1,!0);try{for(kb.$$rst();kb.$$mn();){const Sa=kb.$$cu().cell;if(!Sa)continue;let U=ac.black;if(1970784898===ya)U=Sa.color;else if(1650812936===ya){const ta=Sa.backgroundColor;U=ia.a.compare(ta,ac.y_d,!0)&&ia.a.compare(ta,ac.empty,!0)?Sa.backgroundColor:ac.white}if(!oa)oa=U;else if(oa!==U){oa=ac.black;break}}}finally{kb&&kb.dispose()}this.xb&&
this.gridView.eb&&1970784898===ya&&this.gridView.zi.textBox.kye();return this.moreColorsHelper.eDb(ya,Va,oa)}x$h(ya){const Va=B.a.u5a(this.borderFormatManager.T3);return this.moreColorsHelper.eDb(-236759591,ya,Va)}fpb(ya,Va,oa,kb=!1){Va?this.gridView.zi.ZNf(oa.Font):(this.oEi(ya),kb?window.requestAnimationFrame(()=>{A.FocusManager.instance().tk(y.AFrame.xaa);this.gridView.zi.uZe(oa.Font)}):(A.FocusManager.instance().tk(y.AFrame.xaa),this.gridView.zi.uZe(oa.Font)),this.$0a())}oEi(ya){const Va=C.a(ya.command);
ya=x.a[ya.$e]+"_"+F.a[ya.method];const oa=this.gridView.fc.MBe.toString(),kb=new Map;kb.set("Command",Va);kb.set("Source",ya);kb.set("Ribbon","React");kb.set("CellTextRuns",oa);I.Health.instance.recordKpiUsage(ha.a.vKh,0,za.a.FZf,kb)}Bkd(ya,Va,oa){ya=this.borderFormatManager.Bkd(ya,Va,oa);this.moreColorsHelper&&this.moreColorsHelper.Fda(Va,this.borderFormatManager.T3,oa);return ya}getThemeColor(ya){let Va;Va={};let oa=!1;if((ya.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return v.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Va};let kb;({themeIndex:ya,hCa:kb,returnValue:oa}=this.themesManager.getThemeColor(ya.Color));oa&&(Va.ThemeColorIndex=ya,Va.ThemeColorRow=kb)}return{returnValue:oa,themeColor:Va}}static get d7i(){return ac.Vhe||(ac.Vhe=RegExp("^[0-9]+[.]?[0-9]*$"))}static get zod(){return ac.ube||(ac.ube={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get k_a(){return ac.Bhb||(ac.Bhb={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get pvf(){return ac.kfe||(ac.kfe={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static fqi(ya){return-1150205178===ya||-1142465846===
ya||-286432209===ya||2007171328===ya}static $xc(ya){const Va={},oa={};Va.ValidMembers=16;Va.Font=oa;oa.ValidMembers=ya;return Va}static L2e(ya,Va){let oa;oa=ya.top<Va.top?3:ya.bottom>Va.bottom?0:-1;return oa=ya.left<Va.left?1:ya.right>Va.right?2:oa}}ac.y_d="transparent";ac.notSet="-1";ac.black="#000000";ac.empty="";ac.white="#FFFFFF";ac.ube=null;ac.Bhb=null;ac.kfe=null;ac.Vhe=null;ac.FKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(u.a)(ac,"GridCommandHandler",null,[165]);class ib extends l.a{constructor(ya){super(ya)}nd(){const ya=
e.GetServiceTaskFactory.create(this.$.da,111,this.la,this.Ya),Va=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya),oa=e.GetServiceTaskFactory.create(this.$.da,397,this.la,this.Ya),kb=e.GetServiceTaskFactory.Oa(this.$.da,502,503,this.Ya);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const Sa=e.GetServiceTaskFactory.Oa(this.$.da,296,468,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([ya,Va,oa,Sa,kb],this.la),()=>{this.Yc([new ac(this.$,Fa.h(this.$),
Va.result,ya.result,Sa.result,oa.result,kb.result)])},this.la,3)}else{const Sa=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([ya,Va,Sa,oa,kb],this.la),()=>{this.Yc([new ac(this.$,Fa.h(this.$),Va.result,ya.result,new h.BorderFormatManager(this.$,Va.result,Sa.result),oa.result,kb.result)])},this.la,3)}}static ka(ya){l.a.Nd(80,new ib(ya))}}Object(u.a)(ib,"GridCommandHandlerFactory",l.a,[]);a.d(D,"a",function(){return Ra});const Ra=()=>{c.a.Fa(ib.ka);
c.a.Fa(m.ka)}},1173:function(u,D,a){function c(wa){return Object(z.c)(wa)?"cache":"client"===wa.origin||wa.cached?"client":"server"}function b({x:wa,y:qa},aa,ia=document){let Ha=-1,Z=null;void 0!==ia.caretPositionFromPoint?(wa=ia.caretPositionFromPoint(wa,qa),null!==wa&&(Ha=wa.offset,Z=wa.offsetNode)):void 0!==ia.caretRangeFromPoint&&(wa=ia.caretRangeFromPoint(wa,qa),null!==wa&&(Ha=wa.startOffset,Z=wa.startContainer));return null===Z||-1===Ha?(n.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
-1):aa.contains(Z)?e(aa,Z,Ha):(n.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(wa,qa,aa){if(wa===qa)return aa;if(qa.textContent!==qa.parentElement.textContent)for(;null!==qa.previousSibling;)qa=qa.previousSibling,aa+=qa.textContent.length,"div"===qa.nodeName.toLowerCase()&&(aa+=1);return e(wa,qa.parentElement,aa)}function f(wa,qa){return wa.text===qa.text&&wa.start===qa.start&&wa.length===qa.length}function d(wa,qa,aa){if(wa.has(qa))return wa.get(qa);
aa=aa();wa.set(qa,aa);return aa}function h(wa){return JSON.stringify({text:wa.text,start:wa.start,length:wa.length})}function m(wa){return Object(z.c)(wa)?"Undefined text":""===wa?"Empty text":null}var l=a(9);u=a(0);var v=a(222),t=a(163),z=a(725),r=a(21),n=a(15),w=a(11),B=a(22),A=a(13),y=a(216),x=a(34),F=a(33),I=a(1094),L=a(1);class X{constructor(wa){this.$=wa;this.eJa=this.etb=null;this.usage={};this.results={};this.performance={};this.Wrc=-1;this.isEnabled=!1;this.d_c=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");
this.Bc=(qa,aa)=>{this.d_c&&(aa.Lf||aa.Thf)||this.$.sendBeaconTraceTag(388818255,50,!1,this.DZd())};if(this.isEnabled=L.EwaSettings.isChangeGateEnabled("OfficeVSO:7147898_ValuePreviewTelemetry"))this.editBox=Object(r.h)(this.$).Vb,wa.dk(this.Bc)}static getInstance(wa){return X.instance||(X.instance=new X(wa))}set trigger(wa){this.isEnabled&&(this.etb=wa,this.Wrc=I.a.kZd)}set JOd(wa){this.isEnabled&&(this.eJa=wa)}setResult(wa,qa){if(this.isEnabled)if(Object(z.c)(this.etb))n.ULS.sendTraceTag(512258439,
0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var aa=qa===this.editBox?"cellEditor":"formulaBar",ia=this.etb;qa=this.eJa;var Ha=this.Wrc;Object(z.c)(this.usage[aa])&&(this.usage[aa]={});Object(z.c)(this.usage[aa][ia])&&(this.usage[aa][ia]={success:0,error:0,unavailable:0});aa=this.usage[aa][ia];switch(wa.kind){case 1:this.CKd(wa.text);aa.success++;this.etb=this.eJa=null;this.Wrc=-1;break;case 2:aa.error++;this.etb=null;this.Wrc=-1;break;case 3:aa.unavailable++}this.Bw(qa,
Ha)}}CKd(wa){if(!Object(z.c)(this.eJa)){Object(z.c)(this.results[this.eJa.origin])&&(this.results[this.eJa.origin]=[]);var qa=this.results[this.eJa.origin];1E3>qa.length&&qa.push(wa.length)}}Bw(wa,qa){if(-1!==qa){wa=c(wa);this.z5e(`${wa}_request`).o4(!0,qa);var aa=this.z5e(`${wa}_overall`);window.requestAnimationFrame(()=>{aa.o4(!0,qa)})}}z5e(wa){return this.performance[wa]=this.performance[wa]||new I.a(P)}DZd(){const wa={};Object.keys(this.performance).forEach(qa=>{this.performance[qa].CXe();var aa=
this.performance[qa];wa[qa]={metrics:aa.pW,durations:aa.eub}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(wa)}}`}}Object(u.a)(X,"ValuePreviewTelemetry",null,[]);const P=[50,80,100,130,150,170,200];class G{constructor(wa,qa,aa){this.$=wa;this.HKa=qa;this.ariaLiveNotifier=aa;this.Ggi();this.editBox=Object(r.h)(this.$).Vb;this.XFj=F.a.hR(this.$)}get telemetry(){return X.getInstance(this.$)}get zoomManager(){this.Rne||(this.Rne=
Object(x.a)(this.$));return this.Rne}dispose(){this.hide()}show(wa,qa,aa){const ia=Object.assign(Object.assign({},qa),{$M:wa,q3d:aa});this.Eeb(ia)&&(this.voa(ia)&&this.hide(),this.gD=ia,this.telemetry.setResult(qa,wa),this.Wy(),aa&&this.zdi())}hide(){if(this.gD){var wa=this.gD.q3d;this.Onh();wa&&this.Uhj();this.gD=void 0}}Eeb(wa){var qa;(qa=!this.gD)||(qa=this.gD,qa=!(qa.$M===wa.$M&&qa.kind===wa.kind&&qa.text===wa.text&&qa.start===wa.start&&qa.length===wa.length&&qa.q3d===wa.q3d));return qa}voa(wa){var qa;
if(qa=this.gD)qa=this.gD,qa=!(qa.$M===wa.$M&&qa.start===wa.start&&qa.length===wa.length);return qa}zdi(){this.gD.$M.textBox.formatText(this.gD.start,this.gD.length,{background:"rgba(202,234,216,0.6)"})}Uhj(){const wa=this.gD.$M,qa=this.gD.start,aa=this.gD.length,ia=wa.text;ia.length<qa+aa?n.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${ia.length}:${qa}:${aa}`):(wa.textBox.formatText(qa,aa,{background:!1}),this.XFj&&wa.fC(null))}Wy(){var wa=
this.gD.text;switch(this.gD.kind){case 1:case 2:wa={isLoaded:!0,value:wa};break;case 3:wa={isLoaded:!1,value:null};break;default:return}this.B1j();this.HKa.renderValuePreview(this.Us,this.DPb,wa);this.Y4i(wa)}Onh(){this.HKa.dismiss(this.Us)}Ggi(){this.Us=document.createElement("div");this.DPb=document.createElement("div");this.DPb.style.position="absolute";this.DPb.style.visibility="hidden";this.$.domElement.appendChild(this.DPb)}B1j(){var wa=this.gD.$M,qa=this.gD.start;const aa=this.gD.length,ia=
B.a.contains(wa.text.substring(qa,qa+aa),"\n",!0);wa=excelOnline.utils.getBoundingRectForText(wa.textBox.Qe,qa,ia?qa:qa+aa,!1);qa=new y.a(this.DPb.style);qa.cC.left=this.nAc(wa.left);qa.cC.top=this.nAc(wa.top);qa.cC.width=this.nAc(wa.width);qa.cC.height=this.nAc(wa.height);qa.a3()}nAc(wa){var qa=this.gD.$M;qa=Object(z.b)(this.zoomManager)&&qa===this.editBox;return w.HelperMethods.uc(qa?this.zoomManager.yi(wa):wa)}Y4i({isLoaded:wa,value:qa}){wa?this.ariaLiveNotifier.readText(String.format(A.a.instance.nb(179),
qa)):this.ariaLiveNotifier.readText(A.a.instance.ga(865))}}Object(u.a)(G,"FormulaAssistanceValuePreviewControl",null,[2]);var C=a(113);class H{constructor(wa){this.cache=wa}clearCache(){this.cache=void 0}}Object(u.a)(H,"Cacheable",null,[]);class J extends H{constructor(wa,qa){super();this.$=wa;this.callbacks=qa;this.YBf=(aa,ia)=>{const Ha=this.gridView.zi;if(!(0<(Ha.eb?Ha.textBox.selection:{index:0,length:0}).length))switch(ia.state){case 0:this.onHoverEnter(aa,ia.event);break;case 1:this.onHoverLeave(aa);
break;default:return n.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),ia}};this.XBf=(aa,ia)=>{const Ha=ia.selection;ia={kind:"selection",text:ia.text,start:Ha.index,length:Ha.length};if(0<Ha.length)this.onSelectionChange(aa,ia);else this.KHf(aa,ia)};this.gridView=Object(r.h)(this.$);this.editBox=this.gridView.fc;this.Kj(this.editBox);this.formulaBar=Object(C.a)(this.$);Object(z.b)(this.formulaBar)?this.Kj(this.formulaBar):Object(C.b)(this.$,
aa=>{this.formulaBar=aa;this.Kj(this.formulaBar);n.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return X.getInstance(this.$)}dispose(){this.$j(this.editBox);this.$j(this.formulaBar)}trigger(){const wa=this.gridView.zi,qa=wa.textBox.selection;this.onSelectionChange(wa,{kind:"shortcut",text:wa.text,start:qa.index,length:qa.length})}Kj(wa){wa.Ere(this.YBf);wa.lMg(this.XBf)}$j(wa){null===wa||void 0===wa?void 0:wa.GVf(this.YBf);null===wa||
void 0===wa?void 0:wa.hjj(this.XBf)}onHoverEnter(wa,qa){qa=new Sys.UI.Point(qa.clientX,qa.clientY);qa=b(qa,wa.textBox.Qe);if(-1!==qa)this.onSelectionChange(wa,{kind:"hover",text:wa.text,start:qa,length:0})}onHoverLeave(wa){this.KHf(wa)}onSelectionChange(wa,qa){this.mFj(qa)&&(this.cache=qa,this.callbacks.HEd(wa,{index:qa.start,length:qa.length}),this.telemetry.trigger=qa.kind)}KHf(wa,qa){this.iFj(qa)&&(this.clearCache(),this.callbacks.K6(wa))}mFj(wa){return!this.cache||!f(this.cache,wa)}iFj(wa){return this.cache&&
wa?"shortcut"!==this.cache.kind||!f(this.cache,wa):!0}}Object(u.a)(J,"FormulaAssistanceValuePreviewHandler",H,[2]);var M;(function(wa){wa[wa.Failure=0]="Failure";wa[wa.Success=1]="Success";wa[wa.Error=2]="Error";wa[wa.Unavailable=3]="Unavailable"})(M||(M={}));Object(u.b)("ValuePreviewResultKind",M);var S=a(42),W=a(60);class O{constructor(wa,qa){this.$=wa;this.pluginScheduler=qa;this.cS=new Y(h);this.l2f=new Y(h);this.DZi=(aa,ia)=>Ha=>{if(Object(z.c)(Ha.Result))ia("No result");else if(Ha=JSON.parse(Ha.Result),
Object(z.c)(Ha))ia("Failed to deserialize");else if(1!==Object.keys(Ha).length)ia("Invalid response");else{for(var Z in Ha)var la=Ha[Z];Z=m(la);Object(z.b)(Z)?ia(Z):aa(la)}};this.CZi=aa=>()=>{aa("Request failed")};this.gridView=Object(r.h)(this.$);if(this.Svb=F.a.DV(this.$))this.formulaAssistanceManager=wa.da.za(464)}get telemetry(){return X.getInstance(this.$)}clearCache(){this.cS.clear();this.l2f.clear()}request(wa){return Object(t.a)(this,void 0,void 0,function*(){return d(this.cS,wa,()=>Object(t.a)(this,
void 0,void 0,function*(){const {kind:qa,payload:aa}=yield this.pluginScheduler.getRequester().valuePreview(wa,this.formulaAssistanceManager?this.formulaAssistanceManager.nbb:0);if(0!==qa)return null;if(Object(z.c)(aa))return{kind:0};this.telemetry.JOd={origin:"client"};switch(aa.kind){case 0:return{kind:0};case 1:case 2:return this.d3j(aa);case 3:const ia={text:wa.text,start:aa.start,length:aa.length};return this.cS.has(ia)?(this.telemetry.JOd={origin:"server",cached:!0},yield this.cS.get(ia)):Object.assign(Object.assign({},
aa),{kind:3,next:()=>this.Mnj(ia,wa,aa.text)})}}))})}d3j(wa){const qa=m(wa.text);return Object(z.b)(qa)?(n.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${qa}, kind:${M[wa.kind]}`),{kind:0}):wa}Mnj(wa,qa,aa){return Object(t.a)(this,void 0,void 0,function*(){return d(this.l2f,wa,()=>{const ia=new Promise(Ha=>Object(t.a)(this,void 0,void 0,function*(){try{const Z=yield this.r0h(aa);this.telemetry.JOd={origin:"server"};Ha({kind:1,
text:Z,start:wa.start,length:wa.length})}catch(Z){n.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${Z}`),Ha({kind:0})}}));ia.then(()=>{this.cS.set(wa,ia);this.cS.set(qa,ia)}).catch(Ha=>{n.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Ha}`)});return ia})})}r0h(wa){return Object(t.a)(this,void 0,void 0,function*(){return new Promise((qa,aa)=>{const ia={Formula:wa,
PartialFormula:wa,SourceRange:Object(S.v)(this.gridView.ha.ra.activeCell,this.$)};T(this.$.pa.ya,ia,this.DZi(qa,aa),this.CZi(aa),null,null)})})}}Object(u.a)(O,"FormulaAssistanceValuePreviewRequester",null,[]);const T=(wa,qa,aa,ia,Ha,Z,la=null)=>{la=wa.Na(1,la);la.getPartialCalcResultsParameters=qa;return Object(W.g)(wa,"GetPartialCalcResults",la,aa,ia,Ha,Z,4)};class Y{constructor(wa){this.EZd=wa;this.map=new Map}has(wa){wa=this.EZd(wa);return this.map.has(wa)}get(wa){wa=this.EZd(wa);return this.map.get(wa)}set(wa,
qa){wa=this.EZd(wa);this.map.set(wa,qa);return this}clear(){this.map.clear()}}Object(u.a)(Y,"RequestMap",null,[]);class va{constructor(wa,qa,aa,ia){this.$=wa;this.HEd=(Ha,Z)=>Object(t.a)(this,void 0,void 0,function*(){const la={text:Ha.text,start:Z.index,length:Z.length};void this.VOf(la,this.requester.request.bind(this.requester),Ha,0===la.length)});this.K6=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.Ey=()=>{this.handler.clearCache();
this.requester.clearCache()};this.gridView=Object(r.h)(this.$);this.control=new G(this.$,aa,ia);this.requester=new O(this.$,qa);this.handler=new J(this.$,{HEd:this.HEd,K6:this.K6});this.Kj()}trigger(){this.handler.trigger()}dispose(){this.$j();this.handler.dispose();this.control.dispose()}Kj(){this.gridView.Vb.sm(this.reset);this.gridView.ha.lha(this.reset);this.$.ea.PE(this.Ey)}$j(){this.gridView.Vb.Il(this.reset);this.gridView.ha.Ana(this.reset);this.$.ea.dE(this.Ey)}VOf(wa,qa,aa,ia){return Object(t.a)(this,
void 0,void 0,function*(){const Ha=Object.assign(Object.assign({},wa),{$M:aa,oUd:ia});this.cJa=Ha;const Z=yield qa(wa);Object(z.c)(Z)||this.rti(Ha)&&void this.rai(Z)})}rai(wa){return Object(t.a)(this,void 0,void 0,function*(){const qa=this.cJa.text,aa=this.cJa.$M,ia=this.cJa.oUd;switch(wa.kind){case 0:this.hide();break;case 1:case 2:this.show(aa,wa,ia);break;case 3:if(!this.Svi(wa))break;this.show(aa,wa,ia);void this.VOf({text:qa,start:wa.start,length:wa.length},wa.next,aa,ia);break;default:return wa}})}show(wa,
qa,aa){this.cJa=void 0;this.yti(qa)&&(this.control.show(wa,qa,aa),this.Zsb=qa)}hide(){this.control.hide();this.Zsb=this.cJa=void 0}rti(wa){var qa;if(qa=this.cJa)qa=this.cJa,qa=qa.text===wa.text&&qa.start===wa.start&&qa.length===wa.length&&qa.$M===wa.$M&&qa.oUd===wa.oUd;return qa}yti(wa){return Object(z.b)(wa.text)&&""!==wa.text}Svi(wa){return!this.Zsb||this.Zsb.start!==wa.start||this.Zsb.length!==wa.length||3===this.Zsb.kind}}Object(u.a)(va,"FormulaAssistanceValuePreview",null,[258,2]);var ca=a(50),
V=a(37);class ra extends v.a{constructor(wa){super();this.$=wa;this.Fb()}static ka(wa){wa.da.Ga(497,new ra(wa))}create(){let wa=this.$.da.za(496);wa&&this.ob(wa);const qa=ca.GetServiceTaskFactory.Oa(this.$.da,413,414,this.Ya),aa=ca.GetServiceTaskFactory.Oa(this.$.da,448,449,this.Ya),ia=ca.GetServiceTaskFactory.Oa(this.$.da,19,153,this.Ya),Ha=ca.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Ya);V.TaskExtensions.Aa(V.TaskExtensions.Fd([qa,aa,ia,Ha],this.la),()=>{wa=this.$.da.za(496);wa||(wa=new va(this.$,
qa.result,aa.result,Ha.result),this.$.da.Ga(496,wa));this.ob(wa)},this.la,3)}}Object(u.a)(ra,"FormulaAssistanceValuePreviewFactory",v.a,[]);var N=a(692),ea=a(183),Ba=a(55);class ka{constructor(wa,qa){this.formulaAssistanceValuePreview=qa;this.gridView=Object(r.h)(wa)}nc(){return!1}executeCommand(wa,qa){wa=!1;qa=qa.command;switch(qa){case -46938080:this.formulaAssistanceValuePreview.trigger(),wa=!0}return wa?Ba.Task.Ta(!0):ea.a(qa)}wc(wa,qa){return-46938080===qa.command}Jc(){return!1}}Object(u.a)(ka,
"FormulaAssistanceValuePreviewCommandHandler",null,[165]);class Ka extends N.a{constructor(wa){super(wa)}nd(){const wa=ca.GetServiceTaskFactory.Oa(this.$.da,496,497,this.Ya);V.TaskExtensions.Aa(wa,()=>{this.Yc([new ka(this.$,wa.result)])},this.la)}static ka(wa){N.a.Nd(515,new Ka(wa))}}Object(u.a)(Ka,"FormulaAssistanceValuePreviewCommandHandlerFactory",N.a,[]);a.d(D,"a",function(){return Oa});const Oa=()=>{l.a.Fa(wa=>{ra.ka(wa);Ka.ka(wa)})}},1179:function(u,D,a){u=a(0);var c=a(15),b=a(187),e=a(84),
f=a(82),d=a(384),h=a(98),m=a(45);class l{constructor(){this.Gda=this.L_e=null}}Object(u.a)(l,"GestureAdapterInfo",null,[]);var v=a(4),t=a(374),z=a(228);class r{constructor(){this.JJc=null}yAi(){if(!this.JJc){var S="hammer.min.js";v.AFrameworkApplication.fa.$p("IsServerFlavorDebug")&&(S=v.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");S=v.AFrameworkApplication.CL(String.format("{0}",S),5);S=z.a.create(S,null,null);t.a.bja(S);this.JJc=S.v9a}return this.JJc}static get instance(){r.Ma||
(r.Ma=new r);return r.Ma}}r.Ma=null;Object(u.a)(r,"HammerJsDependencyLoader",null,[571]);var n=a(14);const w=(S,W,O=null)=>{if(void 0===W||null===W)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let T=null;switch(S){case n.a.pinch:T=new Hammer.Pinch(O);break;case n.a.pan:T=new Hammer.Pan(O)}T&&(T.manager=W);return T};var B;(function(S){S[S.none=-1]="none";S[S.pinch=0]="pinch";S[S.pan=1]="pan";S[S.swipe=2]="swipe"})(B||(B={}));Object(u.b)("GestureEvent",
B);var A=a(77);class y extends A.a{constructor(S,W,O,T,Y,va,ca,V){super(S,O,T,va);this.gib=W;this.Jga=ca;this.UX=V;this.hxg=Y}get shiftKey(){return this.Jga}get ctrlKey(){return this.UX}get clientPoint(){return this.gib}get Mva(){return this.hxg}static create(S,W,O,T,Y,va){if(O.rawEvent)if(va){var ca=O.rawEvent;ca=new Sys.UI.Point(ca.clientX,ca.clientY)}else ca=A.a.Bwb(O);else ca=new Sys.UI.Point(O.clientX,O.clientY);return new y(S,ca,W,O,T,Y,O.shiftKey,O.ctrlKey,va)}}Object(u.a)(y,"GestureEventArgs",
A.a,[]);class x{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(u.a)(x,"GestureManagerData",null,[]);class F{}F.Xqg=2;F.Yqg=4;F.Zqg=8;F.$qg=8;Object(u.a)(F,
"HammerConstants",null,[]);var I=a(92),L=a(205),X=a(30),P=a(79);class G extends m.a{constructor(S,W){super();this.Sqa=d.a.mOh;this.hRc=!!window.PointerEvent;this.Cme=window.hasOwnProperty("ontouchstart");this.aXa=this.ulb=null;this.o9=!1;this.oT=new h.a;this.Plb=new h.a;this.ixg=new b.a;this.mqa=null;this.fWa=this.zLc=this.k7d=this.sIc=this.bPc=this.cje=this.q7d=this.rnb=!1;this.Xkb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.PTc=null;this.Md=I.EventHandlerManager.instance;
this.hRc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.ulb=Object(e.a)(this,this.lqc,"onPointerEvent"),this.aXa=n.a.oOh):this.Cme?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.ulb=Object(e.a)(this,this.Iza,"onTouchEvent"),this.aXa=n.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.ulb=Object(e.a)(this,this.Wpc,"onMouseEvent"),this.aXa=n.a.nOh);this.Bh=W;this.Lfa=S;v.AFrameworkApplication.fa&&(this.rnb=v.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),
this.q7d=v.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.cje=v.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.bPc=v.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.sIc=v.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.k7d=v.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.zLc=v.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.fWa=this.rnb&&v.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&
v.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}TWh(){return this.hRc?0:this.Cme?1:2}En(S){super.En(S);this.Md.Tka(this.aXa,S,0,this.ulb)}tm(S){super.tm(S);this.Md.qJa(S,this.aXa)}xfj(S,W,O=null){v.AFrameworkApplication.Yic()?r.instance.yAi().continueWith(T=>{this.vNj();if(T.Wf||T.Ch)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",T.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",T.status);if(this.k7d){T=window.Hammer;
if("undefined"===typeof T){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.cBc();return}if("undefined"===typeof T.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.cBc();return}}if(!S)throw this.cBc(),Error.argumentNull("source element can not be null");T=L.a.mwa(S,this.Sqa);if(void 0===T||null===T)T=new h.a,L.a.ceb(S,this.Sqa,T),this.yfj(S);var Y=null;T.lb(B[0])||(Y=Object.assign(new l,{Gda:w(B[0],this,null),L_e:W}),T.add(B[0],Y));if(void 0!==
O&&null!==O)for(let va=0;va<O.length;va++)if(T.lb(B[O[va]])){const ca=T.oa(B[O[va]]);Y.Gda.recognizeWith(ca.Gda)}}this.cBc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}vNj(){this.zLc&&(this.Bh?this.PTc=this.Bh.Ac("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}cBc(){this.zLc&&(this.PTc?this.PTc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}yfj(S){this.ixg.add(S);
this.Md.Tka(this.aXa,S,0,this.ulb)}recognize(S){var W=Array(S.pointers.length);for(var O=0;O<S.pointers.length;O++)W[O]=S.pointers[O].target;O=null;for(this.mqa=this.mZh(W);void 0!==this.mqa&&null!==this.mqa&&(O=L.a.mwa(this.mqa,this.Sqa),void 0===O||null===O);this.mqa=this.mqa.parentNode);if(void 0!==O&&null!==O){this.curRecognizer&&this.curRecognizer.state===F.$qg&&(this.curRecognizer=null);W=O.keys;for(let T of W){W=O.oa(T);void 0!==W&&null!==W&&void 0!==W.Gda&&null!==W.Gda&&(void 0===this.curRecognizer||
null===this.curRecognizer||W.Gda===this.curRecognizer||W.Gda.canRecognizeWith(this.curRecognizer))&&W.Gda.recognize(S);const Y=W.Gda.state;this.curRecognizer||F.Xqg!==Y&&F.Yqg!==Y&&F.Zqg!==Y||(this.curRecognizer=W.Gda)}}}emit(S,W){if("hammer.input"!==S){this.o9=!1;W=y.create(S,this.mqa,W.srcEvent,W,3,this.hRc);var O=L.a.mwa(this.mqa,this.Sqa);if(this.osi(S))var T=0;else if(this.esi(S))T=1;else if(this.jvi(S))T=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:O}=O.Dc(B[T]));void 0!==O&&null!==O&&((O=O.L_e,O.Opi())?S.endsWith("start")?this.o9=O.FSi(W):S.endsWith("end")?(O.DSi(W),this.o9=!0):S.endsWith("cancel")?(O.CSi(W),this.o9=!0):S.endsWith("move")&&(this.o9=O.ESi(W)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",S))}}get(S){return Object(f.a)(Hammer.Recognizer,S)}mZh(S){if(1>S.length)return null;if(1===S.length)return S[0];var W=S[0],O=!0;for(let T=1;T<S.length;T++){if(!S[T])return null;if(W!==S[T]){O=
!1;break}}if(O)return W;W=this.d0e(S[0]);O=0;for(const T of S){S=this.d0e(T);if(W.oa(W.count-1)!==S.oa(S.count-1))return null;for(let Y=W.count-2,va=S.count-2;Y>=O&&0<=va;Y--,va--)if(W.oa(Y)!==S.oa(va)){O=Y+1;break}}return W.oa(O)}d0e(S){const W=new b.a;for(;void 0!==S&&null!==S;S=S.parentNode)W.add(S);return W}T3e(S){switch(S){case n.a.Df:case n.a.I$:return 1;case n.a.Yf:case n.a.Nha:return 2;case n.a.we:case n.a.HHa:return 4;case n.a.GCc:case n.a.V_c:return 8}return 0}Iza(S,W,O){S=this.T3e(S);W=
this.TXh(O);Hammer.inputHandler(this,S,W);this.o9&&O.preventDefault();return this.o9}naf(){return 1<this.oT.count}t3b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.rnb)for(let S of this.oT)this.FUf(S.key);else this.oT=new h.a;this.session=null}LJg(S,W,O){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",S);if(!this.Plb.lb(S)){try{W.setPointerCapture(S)}catch(T){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",T)}this.Plb.add(S,W)}this.oT.ia(S,
O);this.fWa&&1<this.oT.count&&this.Lfa&&!this.Lfa.Tqb&&(this.Lfa.Tqb=!0)}FUf(S){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",S);if(this.Plb.lb(S)){try{this.Plb.oa(S).releasePointerCapture(S)}catch(W){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",W)}this.Plb.remove(S)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",S);this.oT.remove(S);this.fWa&&1>=this.oT.count&&this.Lfa&&this.Lfa.Tqb&&(this.Lfa.Tqb=!1)}lqc(S,
W,O){var T=O.rawEvent.pointerType.toString();const Y=O.rawEvent.pointerId.toString();if("touch"!==T)return!1;S=this.T3e(S);if(1!==S&&!this.oT.lb(Y))return!1;this.q7d&&1===S&&O.rawEvent.isPrimary&&this.oT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.t3b());this.rnb?this.LJg(Y,W,O):this.oT.ia(Y,O);this.bPc&&2===S&&(!this.sIc||this.sIc&&"function"===typeof O.rawEvent.getCoalescedEvents)&&(W=O.rawEvent.getCoalescedEvents())&&this.naf()&&(this.Xkb=Math.max(this.Xkb,
W.length));this.cje&&(this.o9=!1);T=this.SXh(this.oT,O,T);Hammer.inputHandler(this,S,T);if(4===S||8===S)this.rnb?this.FUf(Y):this.oT.remove(Y),this.oT.count||(this.session=null,this.bPc&&-1!==this.Xkb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Xkb),this.Xkb=-1));this.o9&&O.preventDefault();return this.o9}Wpc(){return!1}TXh(S){const W=new x;var O=S.rawEvent;const T=O.touches;O=O.changedTouches;W.pointers=Array.clone(T);W.pointers=Array.clone(0<T.length?T:O);W.changedPointers=
Array.clone(O);W.srcEvent=S;W.pointerType="touch";return W}SXh(S,W,O){const T=new x;T.pointers=P.toArray(S.values);T.changedPointers=[W];T.pointerType=O;T.srcEvent=W;return T}osi(S){return X.a.startsWith(S,n.a.pinch)}esi(S){return X.a.startsWith(S,n.a.pan)}jvi(S){return X.a.startsWith(S,n.a.swipe)}}Object(u.a)(G,"GestureInputManager",m.a,[542,543]);var C=a(276),H=a(248);class J{constructor(){this.gb=null;this.vx=!1}get name(){return"Common.App.GestureInputManager"}Vh(S){S.register(G,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").xc().Fc(()=>
new G(C.a.instance,v.AFrameworkApplication.sa.mE));this.gb=S}init(){this.vx||(this.gb.resolve("Common.App.GestureManager.GestureInputManager"),this.vx=!0)}dispose(){}static main(){H.a.instance.Ei(new J)}}Object(u.a)(J,"GestureInputManagerPackage",null,[4,5]);a.d(D,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.GestureManager");J.main()}},1190:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(27),f=a(87),d=a(30),h=a(416),m=a(238);class l{}l.qwh="ewa-dv";l.rwh="ewa-dv-buttonarea";
l.uvh="ewa-dlb";l.sDb="list-table";l.listItem="list-item";l.pDb="list-item-selected";l.tDb="list-table-touch";l.pwh="ewa-dpb";l.oqh="dv-prompt-title";l.nqh="dv-prompt-message";Object(u.a)(l,"CssClassNames",null,[]);var v=a(31),t=a(732),z=a(19),r=a(49),n=a(426),w=a(76),B=a(7),A=a(15),y=a(154),x=a(819),F=a(37),I=a(13),L=a(21),X=a(262),P=a(66);class G extends y.ErrorDialog{constructor(lb,Fa,Na){super(lb,G.PQ(Fa,lb,Na));this.Pc=()=>{this.setFocus()};L.h(this.$).ha.kH(this.Pc);(lb=lb.da.za(14).S4a(Na))&&
lb.options&1&&A.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){L.h(this.$).ha.mG(this.Pc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var lb=4;break;case 1:lb=3;break;case 2:lb=0;break;default:lb=this.OM}(lb=this.getButton(lb))?lb.get_element().focus():super.setFocus()}Nrb(){const lb=L.h(this.$);lb.eb&&lb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",
0);4===this.returnValue&&this.$Wd(1);if(2===this.returnValue||0===this.returnValue){const Fa=lb.Sb(null);if(Fa){lb.Ea.AV();const Na=Object(B.a)(new X.a,{Text:Fa.originalText});lb.setCell(Na,Fa.range,0,63,null)}this.$.Xc(-798660877,w.a.Db,8,null)}super.Nrb()}jta(){const lb=L.h(this.$);lb.eb&&lb.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.$Wd(0);super.jta()}$Wd(lb){const Fa=L.h(this.$);F.TaskExtensions.Aa(Fa.startEdit(!1,lb),()=>{const Na=Fa.Vb.textBox;
Na.text&&Na.selectRange(0,Na.text.length)},this.la,11,P.a.current)}static PQ(lb,Fa,Na){Na=Fa.da.za(14).S4a(Na);lb.MessageId=-1083021405;lb.MessageIdName="DataValidationError";lb.MessageIdHash=d.a.qw(lb.MessageIdName);lb.Severity=Na?Na.cad:1;Fa=(null===Na||void 0===Na?0:Na.ZJa)?d.a.Eg(Na.ZJa):null;Na=(null===Na||void 0===Na?0:Na.error)?d.a.Eg(Na.error):String.format("<p>{0}</p><p>{1}</p>",I.a.instance.ga(895),I.a.instance.ga(896));switch(lb.Severity){case 0:lb.Appearance=18;break;case 1:lb.Appearance=
12;Na+=String.format("<p>{0}</p>",I.a.instance.ga(897));break;default:lb.Appearance=3}lb.Caption=Fa;lb.Description=Na;lb.HelpDescription=I.a.instance.ga(1313);lb.HelpTopicId=x.a.NKe;return lb}}Object(u.a)(G,"DataValidationErrorDeprecatedDialog",y.ErrorDialog,[]);y=a(284);var C=a(1084),H=a(5),J=a(42),M=a(283),S=a(192),W=a(53),O=a(29),T=a(282),Y=a(1),va=a(11),ca=a(281),V=a(159);class ra extends y.a{constructor(lb,Fa,Na){super(lb);this.TU=this.Pq=null;this.wlf=!1;this.rX=this.Tm=this.Fbf=this.errorMessage=
null;this.OKe=Mb=>{const dc=this.$;var Cb=this.wlf;this.hide();const Tb=L.h(dc);Tb.eb&&Tb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Mb&&Cb&&F.TaskExtensions.Aa(Tb.startEdit(!1,1),()=>{const Jb=Tb.Vb.textBox;Jb.text&&Jb.selectRange(0,Jb.text.length)},this.la,11,P.a.current);if(1===Mb&&!Cb){if(Cb=Tb.Sb(null)){Tb.Ea.AV();const Jb=Object(B.a)(new X.a,{Text:Cb.cell.userInput});Tb.setCell(Jb,Cb.range,0,63,null)}dc.Xc(-798660877,w.a.Db,8,null)}2===Mb&&F.TaskExtensions.Aa(Tb.startEdit(!1,
0),()=>{const Jb=Tb.Vb.textBox;Jb.text&&Jb.selectRange(0,Jb.text.length)},this.la,11,P.a.current)};this.ADd=()=>{va.HelperMethods.hW(this.$.JG,this.error.HelpTopicId,this.$.KS)};this.xUi=()=>{this.Wyb();this.$.Xc(802602464,2,8,this.TU)};this.TSi=()=>{A.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.USi=Mb=>{!Mb||T.a(Mb)?A.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(Mb=this.b3h(Mb.Result),this.Pq.errorInformation=Mb,this.YUa(this.ZJa,this.y5a(this.OKe),this.Pq))};this.jDd=()=>{this.show(this.OTb)};this.UQe=Na;this.sqmManager=V.a(this.$);this.error=ra.PQ(Fa,lb,Na);this.rb.kp=this;this.ZJa=(this.uv=lb.da.za(14).S4a(this.UQe))&&this.uv.ZJa?this.uv.ZJa:I.a.instance.ga(1725);this.Yxj();this.initializeAndShow(this.ZJa,this.OKe,this.Pq)}get pc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.kp&&(this.rb.kp=null);f.a.Ia(this.Tm);this.Tm=null;super.dispose()}Yxj(){this.uv&&
this.uv.error?this.errorMessage=this.uv.error:this.uv&&this.uv.options&1?(A.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=I.a.instance.ga(1727),this.Fbf=W.a.current.io(120)):(this.errorMessage=I.a.instance.ga(1726),this.CTh(this.UQe));var lb=this.uv?this.uv.cad:1;this.Pq={[ra.vu]:this.pc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Fbf};switch(lb){case 0:this.Rb=1;this.oc(1,"Retry");this.Pq.dialogIcon=
2;this.wlf=!0;break;case 1:this.Rb=4;this.Pq.dialogIcon=1;this.Pq.additionalInformation=I.a.instance.ga(897);break;default:this.Rb=1,this.Pq.dialogIcon=3}this.Pq.helpLink={["type"]:"AppLinkProps",[ra.vu]:this.error.HelpTopicId,["text"]:I.a.instance.ga(1313),["handler"]:this.ADd};lb=O.a.dZc([this.error]);this.TU={[H.a.hac]:!0,[H.a.jcd]:lb,[H.a.kcd]:V.a(this.$).Eub(this.error.MessageIdHash),[H.a.GQ]:this.pc,["DismissHandler"]:this.jDd};this.Pq.giveFeedbackLink={["type"]:"AppLinkProps",[ra.vu]:H.a.hkd,
["text"]:I.a.instance.ga(1764),["handler"]:this.xUi}}CTh(lb){const Fa=this.$.pa.ya.Wb();M.g(this.$.pa.ya,J.q(lb,this.$),ca.b(this.USi),ca.a(this.TSi),null,Fa)}b3h(lb){let Fa;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");A.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${C.a[lb.RuleType].toString()}`);switch(lb.RuleType){case 1:switch(lb.ConditionType){case 0:return Fa=I.a.instance.nb(108),
String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 1:return Fa=I.a.instance.nb(109),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 2:return Fa=I.a.instance.nb(110),String.format(Fa,lb.LowerBoundary);case 3:return Fa=I.a.instance.nb(111),String.format(Fa,lb.LowerBoundary);case 4:return Fa=I.a.instance.nb(112),String.format(Fa,lb.LowerBoundary);case 5:return Fa=I.a.instance.nb(113),String.format(Fa,lb.UpperBoundary);case 6:return Fa=I.a.instance.nb(114),String.format(Fa,lb.LowerBoundary);
case 7:return Fa=I.a.instance.nb(115),String.format(Fa,lb.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(lb.ConditionType){case 0:return Fa=I.a.instance.nb(116),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 1:return Fa=I.a.instance.nb(117),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 2:return Fa=I.a.instance.nb(118),String.format(Fa,lb.LowerBoundary);case 3:return Fa=I.a.instance.nb(119),String.format(Fa,lb.LowerBoundary);case 4:return Fa=I.a.instance.nb(120),
String.format(Fa,lb.LowerBoundary);case 5:return Fa=I.a.instance.nb(121),String.format(Fa,lb.UpperBoundary);case 6:return Fa=I.a.instance.nb(122),String.format(Fa,lb.LowerBoundary);case 7:return Fa=I.a.instance.nb(123),String.format(Fa,lb.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(lb.ConditionType){case 0:return Fa=I.a.instance.nb(124),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 1:return Fa=I.a.instance.nb(125),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);
case 2:return Fa=I.a.instance.nb(126),String.format(Fa,lb.LowerBoundary);case 3:return Fa=I.a.instance.nb(127),String.format(Fa,lb.LowerBoundary);case 4:return Fa=I.a.instance.nb(128),String.format(Fa,lb.LowerBoundary);case 5:return Fa=I.a.instance.nb(129),String.format(Fa,lb.UpperBoundary);case 6:return Fa=I.a.instance.nb(130),String.format(Fa,lb.LowerBoundary);case 7:return Fa=I.a.instance.nb(131),String.format(Fa,lb.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(lb.ConditionType){case 0:return Fa=
I.a.instance.nb(132),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 1:return Fa=I.a.instance.nb(133),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 2:return Fa=I.a.instance.nb(134),String.format(Fa,lb.LowerBoundary);case 3:return Fa=I.a.instance.nb(135),String.format(Fa,lb.LowerBoundary);case 4:return Fa=I.a.instance.nb(136),String.format(Fa,lb.LowerBoundary);case 5:return Fa=I.a.instance.nb(137),String.format(Fa,lb.UpperBoundary);case 6:return Fa=I.a.instance.nb(138),String.format(Fa,
lb.LowerBoundary);case 7:return Fa=I.a.instance.nb(139),String.format(Fa,lb.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(lb.ConditionType){case 0:return Fa=I.a.instance.nb(140),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 1:return Fa=I.a.instance.nb(141),String.format(Fa,lb.LowerBoundary,lb.UpperBoundary);case 2:return Fa=I.a.instance.nb(142),String.format(Fa,lb.LowerBoundary);case 3:return Fa=I.a.instance.nb(143),String.format(Fa,lb.LowerBoundary);case 4:return Fa=
I.a.instance.nb(144),String.format(Fa,lb.LowerBoundary);case 5:return Fa=I.a.instance.nb(145),String.format(Fa,lb.UpperBoundary);case 6:return Fa=I.a.instance.nb(146),String.format(Fa,lb.LowerBoundary);case 7:return Fa=I.a.instance.nb(147),String.format(Fa,lb.UpperBoundary);default:return"we couldn't get the details"}case 3:return Fa=I.a.instance.nb(106),String.format(Fa,lb.LowerBoundary);case 7:return Fa=I.a.instance.nb(107),String.format(Fa,lb.LowerBoundary);default:return"we couldn't get the details"}}$Wd(lb){const Fa=
L.h(this.$);F.TaskExtensions.Aa(Fa.startEdit(!1,lb),()=>{const Na=Fa.Vb.textBox;Na.text&&Na.selectRange(0,Na.text.length)},this.la,11,P.a.current)}get la(){this.Tm=this.Tm||new S.a;return this.Tm.token}static PQ(lb,Fa,Na){Fa=Fa.da.za(14).S4a(Na);lb.MessageId=-1083021405;lb.MessageIdName="DataValidationError";lb.MessageIdHash=d.a.qw(lb.MessageIdName);lb.Severity=Fa?Fa.cad:1;lb.HelpDescription=I.a.instance.ga(1313);lb.HelpTopicId=x.a.NKe;return lb}}Object(u.a)(ra,"DataValidationErrorDialog",y.a,[93,
94,2,95]);y=a(909);var N=a(382);class ea extends y.a{constructor(lb,Fa,Na){super(lb,Fa);this.dataValidationControl=Na}get sAb(){return Object(h.a)(ra,this.$.rb.Ih)}get KK(){return this.dataValidationControl.qe}set KK(lb){this.dataValidationControl.qe=lb}get F6a(){return!1}get key(){return N.a.F7c}dispose(){this.dataValidationControl=null;super.dispose()}Xh(lb,Fa){this.dataValidationControl.Za=this.Za;const Na=lb.keyCode;return 1461300262!==Fa||16!==Na&&17!==Na&&18!==Na?super.Xh(lb,Fa):!1}kCd(){this.KK&&
(this.dataValidationControl.Za=this.Za,this.dataValidationControl.show(this.dataValidationControl.GN,!0,!0,e.a.Fp||3===w.a.Db))}Nf(){}rh(){this.dataValidationControl.show(this.dataValidationControl.GN,!0,!0,e.a.Fp||3===w.a.Db)}QId(lb,Fa){return this.dataValidationControl.Xh(Fa)}}Object(u.a)(ea,"DataValidationListAutoCompleteBehavior",y.a,[]);var Ba=a(263);y=a(837);var ka=a(12),Ka=a(117),Oa=a(22),wa=a(908);class qa extends y.a{constructor(lb,Fa,Na,Mb){super(lb,Fa,new wa.a(l.listItem,l.pDb,l.sDb,l.tDb));
this.lJa=this.VV=this.eea=this.ee=this.Dmb=null;this.GOa=0;this.mHb=[];this.PZj=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.rDb=Na;this.htmlSanitizationHelper=Mb}get Nj(){return this.Dmb}set Nj(lb){this.mCa(this.Dmb);if(lb){this.Dmb=lb;this.rDb.innerText="";this.mCa(this.Dmb);const Fa=this.mHb[lb.rowIndex];this.ee=this.VV[Fa];this.lJa&&(this.eea=this.lJa[Fa],A.ULS.shipAssertTag(537163286,0,!this.mHb.length||!!this.eea,
"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.rDb.innerText=this.ee;this.cxc(lb)}else this.eea=this.ee=null}get eb(){return L.h(this.$).eb}get editText(){return L.h(this.$).Vb.text}dispose(){super.dispose();this.rDb=this.Dmb=null}Xea(lb,Fa,Na,Mb){if(lb&&(!lb||lb.length)){this.l8(!1);this.lJa=lb;this.VV=[];for(var dc=0;dc<lb.length;dc++)this.VV[dc]=lb[dc]?lb[dc].Name:null;dc=`<table class='${this.m6}' aria-live='polite'><tbody>`;var Cb="",Tb="";lb=0;
var Jb=L.h(this.$).Sb(null);Mb=this.eb?Mb?Mb.text:this.editText:Jb?Jb.originalText:null;Jb=!Mb;var eb=0;this.mHb.length=0;var za=[],ha=[],fb=[],rb=Mb?Mb.split(" "):[""];Mb=Mb.trim();for(let Ma=0;Ma<this.VV.length;Ma++){const Ja=this.VV[Ma];var pa=void 0;const Ga=Ja.split(" ");pa=Ba.a.all(rb,Lb=>Ba.a.any(Ga,ac=>Oa.a.zG(ac,Lb)));const La=!Ja,nb=fb.includes(Ja);La||nb||this.eb&&!pa||(pa=Ja?d.a.Eg(d.a.l$c(Ja)):"",pa=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.UV,pa),fb.push(Ja),this.eb&&
Oa.a.zG(Ja,Mb)?(Cb+=pa,za.push(Ma)):(Tb+=pa,ha.push(Ma)),!Jb&&Oa.a.equals(Mb,Ja,!0)&&(lb=this.eb?za.length-1:eb,Jb=!0),eb++)}this.GOa=eb;this.mHb.push(...za);this.mHb.push(...ha);dc+=Cb+Tb+"</tbody></table>";Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(this.If,dc):this.If.innerHTML=dc;dc=this.Ln=ka.DOMElementExtensions.ik(this.domElement,
this.m6);this.kob(dc,Fa);this.l8(!0);this.Fsa(Fa,Na);this.Nj=0<this.GOa?dc.rows[lb]:null}}JSa(lb){var Fa=!1;this.eb&&lb&&(Fa=!this.GOa,lb.endEdit(Fa,"DataValidationListBox.SetCellContent",0));if(!Fa&&(lb=L.h(this.$),Fa=lb.Sb(null))){let Mb=null;if(this.eea&&-1!==this.eea.SheetId&&-1!==this.eea.Row&&-1!==this.eea.Column){var Na={};Na.SheetName=this.eea.SheetId.toString();Na.FirstRow=this.eea.Row;Na.FirstColumn=this.eea.Column;Mb={ParameterType:6};Mb.SourceRange=Na}Na=Object(B.a)(new X.a,{Text:this.ee});
lb.setCell(Na,Fa.range,0,63,Mb)}return!0}Fsa(lb,Fa){const Na=lb?this.oEb:this.sI;lb=lb?this.Olc:this.Plc;0>=this.GOa?this.If.style.height=va.HelperMethods.uc(lb):(this.If.style.height="auto",this.GOa>Na?(ka.DOMElementExtensions.iJ(this.If,this.PZj?Math.floor(lb*Na):Math.floor(this.If.offsetHeight*Na/this.GOa)),this.If.style.overflowY="auto"):(this.If.style.height="auto",this.If.style.overflowY="hidden"));ka.DOMElementExtensions.Xv(this.If,Fa);ka.DOMElementExtensions.Xv(this.Ln,Fa-(this.GOa>Na?Ka.a.Ou:
0))}}Object(u.a)(qa,"DataValidationListBox",y.a,[]);var aa=a(113),ia=a(251),Ha=a(254),Z=a(1093);const la=`<p class='${l.oqh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,Xa=`<p class='${l.nqh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var Za=z.a.TRe,xa=z.a.TRe,fa=z.a.L5g;class ua extends m.a{constructor(lb,Fa){super(document.createElement("div"));this.S2b=this.VQ=this.rR=!1;this.$h=this.Oh=null;this.aoi=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
this.boi=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.ypd=this.qsd=this.xrd=!1;this.z7b=[];this.htmlSanitizationHelper=null;this.Ph=()=>{this.y8f(!1)};this.OPa=(Na,Mb)=>{this.show(this.GN,!this.qe,!0,e.a.Fp||3===Mb.tb||3===w.a.Db);this.VCd(null,null)};this.VCd=()=>{this.gridView.setFocus()};this.FMa=()=>{this.Za.textBox.LF=!0};this.Tt=()=>{this.Tig()};this.onContentReady=()=>{this.y8f(this.qe)};this.Bc=()=>{this.qy()};this.Fza=()=>{this.JSa()};this.QBf=
()=>{this.Tig()};this.$=lb;this.gridView=L.h(this.$);this.rJ=this.gridView.Vb;this.htmlSanitizationHelper=Fa;Fa="<div id='dv_reader_description' class='"+v.a.jSe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+l.rwh+" "+z.a.hq+"'></div>\r\n<div id='dv_list_box' class='"+l.uvh+" "+z.a.rp+" "+z.a.hq+"'></div>\r\n<div id='dv_prompt_box' class='"+l.pwh+" "+z.a.hq+"'></div>";this.domElement.className=l.qwh;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(this.domElement,Fa):this.domElement.innerHTML=Fa;ia.d(this.style,this.isGridRtl);this.If=$get("dv_list_box",this.domElement);this.zW=$get("dv_prompt_box",this.domElement);this.eta=$get("dv_list_button",this.domElement);this.rDb=$get("dv_reader_description",this.domElement);(Fa=aa.a(lb))&&this.z7b.push(new ea(lb,Fa,this));this.z7b.push(new ea(lb,
this.gridView.Vb,this));this.gridView.ha.iH(this.Ph);this.gridView.mv(this.onContentReady);this.gridView.fc.yMg(this.QBf);this.$.dk(this.Bc);Fa=this.gridView.zj;Fa.insertBefore(this.domElement,Fa.firstChild);this.onContentReady(null,null);lb.da.Ga(14,this)}get $Bb(){return!!(this.$.rd&16)}get Rvi(){return this.qe||this.GN||this.rxa}get qe(){return ka.DOMElementExtensions.isVisible(this.If)}set qe(lb){ka.DOMElementExtensions.setVisible(this.If,lb)}get GN(){return ka.DOMElementExtensions.isVisible(this.zW)}set GN(lb){ka.DOMElementExtensions.setVisible(this.zW,
lb)}get rxa(){return ka.DOMElementExtensions.isVisible(this.eta)&&!!this.Oh&&ka.DOMElementExtensions.isVisible(this.Oh.domElement)}set rxa(lb){ka.DOMElementExtensions.setVisible(this.eta,lb);this.Oh&&ka.DOMElementExtensions.setVisible(this.Oh.domElement,lb)}get Za(){return this.rJ}set Za(lb){this.rJ=lb}get a6a(){return!!this.activeCell&&this.k9c(this.activeCell.range)}get activeCell(){return this.gridView.Sb(null)}get Xaf(){return this.a6a&&!!this.uv&&!!(this.uv.options&2)&&!!this.uv.prompt}get uyb(){return this.a6a&&
!!this.uv&&!!(this.uv.options&1)}get isGridRtl(){return this.gridView.rtl}get uv(){return this.S4a(this.activeCell.range)}get yPa(){const lb=this.activeCell;return lb?this.nwa(this.gridView,lb):null}dispose(){this.$&&(this.zOb(!1),this.gridView.ha.rL(this.Ph),this.gridView.Oy(this.onContentReady),this.gridView.fc.ujj(this.QBf),this.$.Jl(this.Bc));this.ZIe(!1);this.$Ie(!1);f.a.qc(this.z7b);this.z7b=this.eta=this.If=this.zW=this.rJ=this.gridView=this.$=null;super.dispose()}k9c(lb){return!!this.S4a(lb)}ysb(lb,
Fa){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new ra(this.$,lb,Fa):new G(this.$,lb,Fa)}S4a(lb){lb=this.gridView.getRangeInformation(lb);for(let Fa=0;Fa<lb.length;Fa++){const Na=lb[Fa];if(Object(h.a)(n.DataValidationRange,Na))return Na}return null}APh(){if(!this.a6a)return"";const lb=this.Xaf?`${this.uv.hPf} ${this.uv.prompt}`:"",Fa=this.uyb?I.a.instance.ga(842):"";return String.format(I.a.instance.nb(17),lb,Fa)}Xh(lb){let Fa=!1;if(this.qe||(-569786022===
lb||541421805===lb)&&this.uyb||1872288872===lb&&this.GN)switch(lb){case -569786022:case 541421805:this.show(this.GN,!this.qe,!0,e.a.Fp||3===w.a.Db);Fa=!0;break;case 1872288872:this.qe?(this.show(this.GN,!1,!0,!1),Fa=!0):this.GN?(this.show(!1,!1,!0,!1),Fa=!0):this.Za&&(this.Za.endEdit(!1,"DataValidationControl.HandleKeyDown",0),Fa=!0);break;case -798660877:this.$h.IB(1);Fa=!0;break;case 137938150:this.$h.IB(-1);Fa=!0;break;case 2091832999:this.$h.IB(this.$h.sI-1);Fa=!0;break;case 742457698:this.$h.IB(-(this.$h.sI-
1));Fa=!0;break;case 125627505:case 267796030:Fa=this.JSa()}return Fa}show(lb,Fa,Na,Mb){this.qy();if(this.$Bb&&this.a6a){var dc=this.yPa;if(dc){if(lb||Fa||Na)this.isVisible=!0;ia.d(this.style,this.isGridRtl);Na&&this.uyb&&(this.$Ie(!0),this.Kig(dc,!1));Fa&&this.uyb&&this.xTa(Mb,dc);lb&&this.Xaf&&this.FJj(dc);this.Rvi||(this.isVisible=!1)}}}nwa(lb,Fa){if(!Fa||!Fa.cell.Pk)return null;var Na=this.gridView.fc.textBox.domElement;var Mb=0<ka.DOMElementExtensions.getHeight(Na)&&0<ka.DOMElementExtensions.getWidth(Na)&&
0<=Na.offsetTop&&0<=Na.offsetLeft;if(Mb)Na=ka.DOMElementExtensions.nwa(Na,lb.zj);else{Na=lb.getCellBounds(Fa.cell);var dc=ka.DOMElementExtensions.getBoundingClientRect(lb.zj);Na=new Sys.UI.Bounds(Na.x-dc.x,Na.y-dc.y,Na.width,Na.height)}if(Na)if(Mb)2<Na.height&&2<Na.height&&(Na.x+=1,Na.y+=1,Na.height-=2,Na.width-=2);else if(Mb=L.h(this.$).sK(Fa.cell))Mb=Mb.width+1,dc=Oa.a.equals(Ha.a.Hwb(Fa.cell,lb.rtl),"right",!0),lb.rtl&&dc&&(Na.x=Na.x+Na.width-Mb),Fa.Ela&&lb.rtl===dc&&(Na.width=Mb);else return null;
return Na}y8f(lb){const Fa=this.a6a;this.zOb(Fa);Fa?this.show(!0,lb,!0,!1):this.qy()}JSa(){let lb=!1;this.qe&&(lb=this.$h.JSa(this.Za),this.show(this.GN,!1,!0,!1));return lb}qy(){this.aoi?(this.qe&&(this.qe=!1),this.rxa&&(this.rxa=!1),this.GN&&(this.GN=!1),this.isVisible&&(this.isVisible=!1)):this.qe=this.rxa=this.GN=this.isVisible=!1;this.xrd=this.ypd=this.qsd=!1}xTa(lb,Fa){this.uyb&&!this.uv.lJa?this.rxa&&this.Oh.disable():(this.ZIe(!0),this.$h.Xea(this.uv.lJa,lb,this.XYh(Fa),this.Za),this.ECa(Fa,
!1))}FJj(lb){this.uv.prompt&&(this.GN=!0,this.G0j(this.uv.hPf,this.uv.prompt),this.djg(lb,!1))}Kig(lb,Fa){const Na=lb.y;this.eta.style.top=va.HelperMethods.uc(Na);lb=this.isGridRtl?lb.x-this.eta.offsetWidth+1:lb.x+lb.width+1;this.eta.style.left=va.HelperMethods.uc(lb);Fa?this.rxa=this.gridView.xkc(new r.a(lb,Na))&&this.ypd:this.ypd=!0}ECa(lb,Fa){const Na=lb.y+lb.height;lb=this.isGridRtl?lb.x+lb.width-this.If.offsetWidth:lb.x;this.If.style.top=va.HelperMethods.uc(Na);this.If.style.left=va.HelperMethods.uc(lb);
Fa?this.qe=this.gridView.xkc(new r.a(lb,Na))&&this.xrd:this.xrd=!0}djg(lb,Fa){const Na=lb.y+lb.height+5;var Mb=this.activeCell;Mb=Mb?Mb.width/2:32;lb=this.isGridRtl?lb.x-this.zW.offsetWidth+Mb:lb.x+lb.width-Mb;this.zW.style.top=va.HelperMethods.uc(Na);this.zW.style.left=va.HelperMethods.uc(lb);Fa?this.GN=this.gridView.xkc(new r.a(lb,Na))&&this.qsd:this.qsd=!0}G0j(lb,Fa){if(Fa){var Na="";lb&&(Na+=String.format(la,d.a.Eg(lb)));Na+=String.format(Xa,d.a.Eg(Fa));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.sk(this.zW,Na):this.zW.innerHTML=Na;lb=ka.DOMElementExtensions.ik(this.zW,"dv-prompt-titletext");if(Fa=ka.DOMElementExtensions.ik(this.zW,"dv-prompt-messagetext")){lb=lb?parseInt(String(Math.max(lb.offsetWidth,Fa.offsetWidth)),10):Fa.offsetWidth;lb+=6;ka.DOMElementExtensions.Xv(this.zW,lb);for(let Mb=0,dc=this.zW.children.length;Mb<dc;Mb++)ka.DOMElementExtensions.Xv(this.zW.children[Mb],
lb)}}}XYh(lb){return this.boi?lb.width+17-2+1:lb.width+this.eta.clientWidth-2+1}$Ie(lb){this.$&&!this.$Bb||!lb?(this.Fbg(!1),f.a.Ia(this.Oh),this.Oh=null):(this.Oh||(this.Oh=new Z.a(this.eta,Za,t.a.Gia,1,xa,I.a.instance.ga(894),fa,I.a.instance.ga(893),"",-1),this.Fbg(!0)),this.rxa=!0,this.uv.lJa?this.Oh.isEnabled||this.Oh.enable():this.Oh.disable())}ZIe(lb){this.$&&!this.$Bb||!lb?(this.fUa(!1),f.a.Ia(this.$h),this.$h=null):(this.$h||(this.$h=new qa(this.$,this.If,this.rDb,this.htmlSanitizationHelper),
this.fUa(!0)),this.qe=!0)}fUa(lb){this.$h&&(lb&&!this.rR?(this.$h.i$(this.VCd),this.$h.g0b(this.FMa),this.$h.Dob(this.Fza),this.rR=!0):!lb&&this.rR&&(this.$h.Qda(this.VCd),this.$h.Wuc(this.FMa),this.$h.nKb(this.Fza),this.rR=!1))}zOb(lb){lb&&!this.VQ?(this.gridView.view.nt(this.Tt),this.VQ=!0):!lb&&this.VQ&&(this.gridView.view.ir(this.Tt),this.VQ=!1)}Fbg(lb){this.Oh&&(lb&&!this.S2b?(this.Oh.lXc(this.OPa),this.Oh.xXc(this.OPa),this.Oh.qob(this.FMa),this.S2b=!0):!lb&&this.S2b&&(this.Oh.gMd(this.OPa),
this.Oh.tMd(this.OPa),this.Oh.ZJb(this.FMa),this.S2b=!1))}Tig(){if(this.a6a){var lb=this.yPa;lb&&(this.Kig(lb,!0),this.ECa(lb,!0),this.djg(lb,!0))}}}Object(u.a)(ua,"DataValidationControl",m.a,[255,2]);var sa=a(50),sb=a(55);class hb extends b.a{constructor(lb){super();this.$=lb;this.Fb()}create(){const lb=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?sa.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Ya):sb.Task.Ta(null);F.TaskExtensions.Aa(lb,()=>{this.ob(this.$.da.za(14)||new ua(this.$,lb.result))},this.la,3)}}Object(u.a)(hb,"DataValidationControlFactory",b.a,[]);a.d(D,"a",function(){return bb});const bb=()=>{c.a.Fa(lb=>{lb.da.Ga(150,new hb(lb))})}},1214:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(187);const f={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,
dismissSmartSuggestionImplicitlyCounter:0},d={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},h={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},
m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},l={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},v={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},t={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,
smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0};var z=a(58),r=a(1094),n=a(1),w=a(22),B=a(41),A=a(21),y=a(98),x;(function(G){G[G.function=3]="function";G[G.namedRange=100]="namedRange";G[G.tableHeader=101]="tableHeader";G[G.letVariable=102]="letVariable";
G[G.richEntity=103]="richEntity";G[G.lambda=104]="lambda";G[G.customFunction=105]="customFunction";G[G.table=106]="table";G[G.tableSpecialStructRef=107]="tableSpecialStructRef";G[G.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(x||(x={}));Object(u.b)("CompletionItemKind",x);var F=a(33);const I={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,
80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class L{constructor(G){this.$=G;this.mI=null;this.aDb=-1;this.vlc=null;this.wlc=0;this.SP=Object.assign({},h);this.qK=Object.assign({},m);this.OJ=Object.assign({},f);this.Tpb=Object.assign({},d);this.pbc=Object.assign({},l);this.hX=Object.assign({},t);this.Upb={};this.p4a=Object.assign(Object.assign({},v),{isReactDialog:F.a.lkf()});this.d_c=
n.EwaSettings.isChangeGateEnabled("OfficeVSO:7190603_FATMAvoidSilentReopen");this.Nf=(C,H)=>{null!=this.mI&&(1==Math.abs(this.aDb-this.$.ea.ye)&&(C=this.$.xa.na.sheetId,H.Qrb&&H.Ok.equals(this.mI.Ok)&&this.vlc===C&&this.mI.brb!==H.brb&&this.wlc++),1<=Math.abs(this.aDb-this.$.ea.ye)&&(this.mI=null,this.aDb=-1,this.vlc=null))};this.Bc=(C,H)=>{this.d_c&&(H.Lf||H.Thf)||(this.sBj(),this.f$&&this.CBj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.f$=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
this.fbb=new y.a;G.dk(this.Bc);this.f$&&A.h(this.$).zi.sm(this.Nf)}dispose(){this.$&&this.f$&&A.h(this.$).zi.Il(this.Nf)}mA(G){G.forEach(C=>{this.fbb.lb(C)||this.fbb.ia(C,new r.a(I[C]));this.fbb.oa(C).XTa()})}Bw(G,C=!0){G.forEach(H=>{this.fbb.lb(H)&&this.fbb.oa(H).o4(C)})}H2f(G){let C="Undefined";switch(G){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.SP.argumentAssistanceCardInitialMode=C}Uwj(G){this.SP.argumentAssistanceCardInitialMode=G?"Expanded":"Collapsed"}G2f(){this.SP.argumentAssistanceCardIsInitialModeDefault=
!0}Wua(G){window.requestAnimationFrame(()=>{this.Bw([G])})}Udf(G){G.forEach(C=>{C=x[C.kind];this.blg(C);this.Upb[C].shownCounter++})}Tdf(G){G=x[G];this.blg(G);this.Upb[G].committedCounter++}getJsonForLogging(){return"{"+this.lQ("SessionDetails",this.hX)+","+this.lQ("ArgumentAssistanceUsage",this.SP)+","+this.lQ("FormulaSuggestionsUsage",this.qK)+","+this.lQ("FunctionDialogUsage",this.p4a)+","+this.lQ("AutocompleteCardInteraction",this.OJ)+","+this.lQ("AutocompleteRenderOptimization",this.Tpb)+","+
this.lQ("AutocompleteUsageByKind",this.Upb)+","+(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7223831_logFormulaSuggestionUsage")?this.lQ("FormulaHighlightsUsage",this.pbc)+",":"")+this.G3h()+"}"}CBj(){this.qK.smartSuggestionKeptCounter=this.qK.smartSuggestionCommittedCounter-this.wlc}sBj(){this.hX.argumentAssistanceFlight=this.dwa("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.hX.autoCompleteUIFlight=this.dwa("Microsoft.Office.Excel.","AutoCompleteNewUI");this.hX.smartFormulaBarAutoCompleteFlight=
this.dwa("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.hX.smartFormulaBarAutoCompletePluginFlight=this.dwa("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.hX.formulaAssistanceRedesignFlight=this.dwa("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.hX.NewInsertFunctionDialogFlight=this.dwa("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.hX.coloredReferencesFlight=this.dwa("Microsoft.Office.Excel.","ColoredReferences");this.hX.parenthesesCouplingFlight=
this.dwa("Microsoft.Office.Excel.","ParenthesesCoupling");this.hX.smartFormulaSuggestionsFeatureEnabled=F.a.vNa(this.$)}G3h(){const G=new e.a;for(let C of this.fbb)C.value.CXe(),G.add(`"${C.key}":${z.a.hc(C.value.pW)}`);return`"PerfMeasurements": {${G.toArray().join(",")}}`}dwa(G,C){return w.a.contains(this.$.va.FlightHolder.FlightId,C,!0)?n.EwaSettings.getBooleanFeatureGate(G+C,!1)?"T":"C":"None"}lQ(G,C){return`"${G.toString()}":${B.c(C)}`}blg(G){this.Upb[G]||(this.Upb[G]={shownCounter:0,committedCounter:0})}}
Object(u.a)(L,"FormulaAssistanceTelemetryManager",null,[253]);class X extends b.a{constructor(G){super();this.$=G;this.Fb()}static ka(G){G.da.Ga(492,new X(G))}create(){var G;this.ob(null!==(G=this.$.da.za(491))&&void 0!==G?G:this.$.da.Ga(491,new L(this.$)))}}Object(u.a)(X,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(D,"a",function(){return P});const P=()=>{c.a.Fa(G=>{X.ka(G)})}},1218:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(276),e=a(92),f=a(40),d=a(263),h=a(548),m=a(4),l=a(82),v=a(416),
t=a(716),z=a(8),r=a(31),n=a(19),w=a(61),B=a(5),A=a(787),y=a(1047),x=a(836),F=a(13),I=a(33);class L{constructor(Jb,eb,za,ha,fb,rb,pa,Ma){this.$=eb;this.Va=za;this.ul=ha;this.selectedRanges=fb;this.grid=rb;this.Vy=Ma;this.h5=pa;this.uha=d.a.all(fb,Ja=>Ja.isRow);this.Jsa=d.a.all(fb,Ja=>Ja.hf);this.jFb=d.a.all(fb,Ja=>!Ja.isRow&&!Ja.hf);eb=rb.Bb.sjd(fb);this.Fsb=!!eb;this.YWf=!!eb&&eb.hasActiveFilter;this.menuSection=za.Ec();Jb.tc.push(this.menuSection);this.Lba=this.uha||this.Jsa?this.menuSection:za.Ec();
this.sua=this.uha||this.Jsa?this.menuSection:za.Ec()}zed(){this.TMh();this.wMh();const Jb=this.Vy.n8a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(Jb?149:148))}ZMh(){let Jb=0;this.Fsb?this.h5.zm(942362098)?Jb=this.Vy.zm(this.ul,942362098,this.selectedRanges,this.grid)?161:169:this.YWf&&(Jb=this.Vy.zm(this.ul,-1113896058,this.selectedRanges,this.grid)?177:181):this.h5.zm(-1113896058)&&(Jb=this.uha?this.Vy.zm(this.ul,-1113896058,this.selectedRanges,this.grid)?49:116:this.Vy.zm(this.ul,
-1113896058,this.selectedRanges,this.grid)?177:181);0!==Jb&&this.Lba.buttons.push(this.Va.pb(Jb))}YMh(){let Jb;!this.Fsb&&this.h5.zm(-1113896058)&&(Jb=this.uha?this.Vy.zm(this.ul,-1113896058,this.selectedRanges,this.grid)?295:296:this.Vy.zm(this.ul,-1113896058,this.selectedRanges,this.grid)?297:298,this.Lba.buttons.push(this.Va.pb(Jb)))}UMh(){let Jb=0;this.Fsb?this.h5.zm(622604322)&&(Jb=this.grid.rtl?this.Vy.zm(this.ul,622604322,this.selectedRanges,this.grid)?191:192:this.Vy.zm(this.ul,622604322,
this.selectedRanges,this.grid)?162:170):this.h5.zm(1415868706)&&(Jb=this.Jsa?this.Vy.zm(this.ul,1415868706,this.selectedRanges,this.grid)?50:117:this.Vy.zm(this.ul,1415868706,this.selectedRanges,this.grid)?178:182);0!==Jb&&this.Lba.buttons.push(this.Va.pb(Jb))}SMh(){this.h5.zm(1035996630)&&(this.Vy.zm(this.ul,1035996630,this.selectedRanges,this.grid)?(this.Lba.buttons.push(this.Va.pb(this.grid.rtl?187:165)),this.Lba.buttons.push(this.Va.pb(166))):(this.Lba.buttons.push(this.Va.pb(this.grid.rtl?188:
173)),this.Lba.buttons.push(this.Va.pb(174))))}TMh(){const {GridContextMenu:Jb}=a(1218);let eb=null;this.jFb&&(eb=this.Va.ww("ContextMenu.InsertCells",null,F.a.instance.ga(345),1896159024),eb.menu.tc.push(this.Lba));Jb.VMh(this.Lba,this.Va,this.$);this.ZMh();m.AFrameworkApplication.Rt("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");I.a.ord()&&this.YMh();this.UMh();this.SMh();eb&&0<this.Lba.buttons.length&&this.menuSection.buttons.push(eb)}yMh(){let Jb=0;this.Fsb?this.h5.zm(1405456548)?
Jb=this.Vy.zm(this.ul,1405456548,this.selectedRanges,this.grid)?163:171:this.YWf&&(Jb=this.Vy.zm(this.ul,1554436520,this.selectedRanges,this.grid)?179:183):this.h5.zm(1554436520)&&(Jb=this.uha?this.Vy.zm(this.ul,1554436520,this.selectedRanges,this.grid)?51:118:this.Vy.zm(this.ul,1554436520,this.selectedRanges,this.grid)?179:183);0!==Jb&&this.sua.buttons.push(this.Va.pb(Jb))}xMh(){let Jb=0;this.Fsb?this.h5.zm(284490184)&&(Jb=this.Vy.zm(this.ul,284490184,this.selectedRanges,this.grid)?164:172):this.h5.zm(674605324)&&
(Jb=this.Jsa?this.Vy.zm(this.ul,674605324,this.selectedRanges,this.grid)?52:119:this.Vy.zm(this.ul,674605324,this.selectedRanges,this.grid)?180:184);0!==Jb&&this.sua.buttons.push(this.Va.pb(Jb))}vMh(){this.h5.zm(1035996630)&&(this.Vy.zm(this.ul,1035996630,this.selectedRanges,this.grid)?(this.sua.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.sua.buttons.push(this.Va.pb(168))):(this.sua.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.sua.buttons.push(this.Va.pb(176))))}wMh(){let Jb=null;
this.jFb&&(Jb=this.Va.ww("ContextMenu.DeleteCells",null,F.a.instance.ga(409),-1554384558),Jb.menu.tc.push(this.sua));this.yMh();this.xMh();this.vMh();Jb&&0<this.sua.buttons.length&&this.menuSection.buttons.push(Jb)}}Object(u.a)(L,"CellsContextMenuGenerator",null,[]);var X=a(773);class P{constructor(Jb){this.ranges=null;this.ranges=Jb}}Object(u.a)(P,"MacroRecorderRangeHyperlinkRemovedPayload",null,[125]);var G=a(525),C=a(24),H=a(101),J=a(76),M=a(74),S=a(42),W=a(188),O=a(60),T=a(604),Y=a(142),va=a(37),
ca=a(459),V=a(555),ra=a(1),N=a(183),ea=a(21),Ba=a(372),ka=a(34),Ka=a(50),Oa=a(211),wa=a(22),qa=a(30),aa=a(1072),ia=a(905),Ha=a(132),Z=a(371),la=a(283),Xa=a(162),Za=a(154),xa=a(345),fa=a(91),ua=a(29),sa=a(282),sb=a(281),hb=a(133),bb=a(771),lb=a(772),Fa=a(112),Na=a(41),Mb=a(55),dc;(function(Jb){Jb[Jb.none=0]="none";Jb[Jb.once=1]="once";Jb[Jb.twice=2]="twice"})(dc||(dc={}));Object(u.b)("ToggleState",dc);class Cb{constructor(Jb,eb,za,ha){this.WYc=this.Sfb=this.Ufb=0;this.$=Jb;this.gridView=ea.h(this.$);
this.namedSheetViewPublic=eb;this.zg=za;this.instantaneousSupportInformationManager=ha;this.JNa=bb.a.mpd()}Poh(){var Jb=this.gV();Jb={["CommandValueId"]:Na.c(Jb)};const eb=new fa.a(-2058042992,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Lb(eb,Jb)}eph(){const Jb=new fa.a(644342024,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ka.Lb(Jb)}Uoh(){const Jb=this.gridView.ha.ra.activeCell,eb=this.$.da.za(66).Ig,za=this.$.da.za(66).pwb(Jb);return eb||za?this.Woh(eb,za,Jb):this.Voh(Jb)}Woh(Jb,eb,za){if(this.l3g(Jb,eb,za))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Mb.Task.Ta(!1);if(null!=Jb&&Jb.hasAutoFilter||null!=eb&&eb.u0a.every(ha=>0!=ha.length))return this.Ufb=dc.none,this.UYc();this.Ufb=dc.once;return this.R8b(dc.once)}Voh(Jb){var eb=
S.v(this.gridView.ha.ra.$c,this.$);eb=this.gridView.$.xa.getItemByName(eb.SheetName);const za=S.D(eb.$0);if(this.k3g(za,Jb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Mb.Task.Ta(!1);if(eb.hasAutoFilter){if(za&&za.contains(this.gridView.ha.ra.activeCell))return this.Ufb=dc.none,this.UYc();this.Ufb=dc.twice;return this.R8b(dc.twice)}this.Ufb=dc.once;return this.R8b(dc.once)}R8b(Jb){const eb=S.v(this.gridView.ha.ra.$c,
this.$);if(!eb)return Mb.Task.Ta(!1);this.Sfb||(this.Sfb=Date.now());const za=new fa.a(368460465,2,this.$.Hc,19,null),ha=this.$.pa.ya.Wb(),fb=()=>new aa.a(eb),rb=pa=>{sa.a(pa)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Jb===dc.twice?this.R8b(dc.once):this.UYc())};return Z.a(this.$.userOperationManager,(pa,Ma,Ja)=>la.B(this.$.pa.ya,eb,sb.b(pa,
rb),Ma,Ja,null,ha),pa=>new W.a(516,0,pa,64,fb),za)}l3g(Jb,eb,za){return null!=Jb&&Xa.d(Jb)&&za.top===Jb.usedRange.top||null!=eb&&eb.zba&&za.top===eb.top?(this.qtc(this.$,223),!0):null!=Jb&&Xa.g(Jb)&&za.top===Jb.usedRange.bottom?(this.qtc(this.$,224),!0):!1}k3g(Jb,eb){if(Jb&&Jb.contains(eb)&&eb.top===Jb.top||!Jb&&this.p2g(eb.top,eb.left))return this.qtc(this.$,225),!0;Jb=new C.Range(eb.top,eb.left,eb.top+1,eb.left+1,!1,!1);return this.gridView.Bb.Sxa(Jb)?(this.qtc(this.$,226),!0):!1}qtc(Jb,eb){eb=
ua.a.Zc(1,1,751,eb,0,147079615,"ContextMenuFilterByCellValueError");ra.EwaSettings.Mz()?new xa.a(Jb,eb):(Jb=new Za.ErrorDialog(Jb,eb),Jb.initialize(),Jb.ug())}UYc(){this.WYc=Date.now();const Jb=this.c7h();if(!Jb)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Mb.Task.Ta(!1);const eb=this.gV(),za={FirstRow:0};za.FirstColumn=eb.Column;za.SheetName=eb.SheetName;hb.b(this.$).Gd(Ha.a.ozf,this.xm(),void 0,!0);const ha=this.B5c(eb,za),fb=
pa=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Ufb,["ApplyFilterTime"]:this.WYc?Date.now()-this.WYc:-1,["ToggleAndApplyFilterTime"]:this.Sfb?Date.now()-this.Sfb:-1,["FilterByValueType"]:eb.AutoFilterType})}`);this.Sfb&&(this.Sfb=0);if(bb.a.Dzc(pa)){const Ma=bb.a.Ubc(pa);this.JNa?bb.a.ERa(lb.a.filterByCellValue,Ma.MessageIdName,Fa.a.vHa,!0,bb.a.isSessionEndingError(Ma.MessageId)):c.ULS.sendTraceTag(527500294,
0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Ma.MessageIdName}`)}sa.a(pa)?(pa=ua.a.sc(pa.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${pa}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),hb.b(this.$).Gd(Ha.a.SCf,this.xm(),void 0,!0),pa={},pa.FirstRow=this.LVh(),pa.FirstColumn=eb.Column,-1!==pa.FirstRow&&(pa=S.C(pa),this.GS(pa)))},rb=
new W.a(208,0,(pa,Ma,Ja)=>O.a(this.$.pa.ya,ha,Jb,sb.b(pa,fb),Ma,Ja,null,null),6,()=>new ia.a(Jb,ha));this.namedSheetViewPublic?this.namedSheetViewPublic.yTa().continueWith(pa=>{pa.result&&this.$.userOperationManager.Kc(rb,null)}):this.$.userOperationManager.Kc(rb,null);return Mb.Task.Ta(!0)}GS(Jb){I.a.Ala(this.$)&&va.TaskExtensions.Aa(Ka.GetServiceTaskFactory.Oa(this.$.da,430,431,1),eb=>{eb.result.Uea(Jb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)}xm(){return{["Location"]:"contextMenu"}}gV(){var Jb=0,eb=this.gridView.ha.ra.activeCell;var za=this.$.da.za(66).Ig;const ha=this.$.da.za(66).pwb(eb);if(za){var fb="Table";Jb=za.objectId}else ha?(fb="Table",Jb=ha.id):fb="Sheet";za=eb.left;eb={};eb.AutoFilterType=fb;eb.Column=za;eb.Id=Jb;fb={};this.$.jk(fb);fb.FirstRow=0;fb.FirstColumn=eb.Column;Jb=this.$.ea.isNamedObjectViewMode;eb.NamedObjectView=Jb;eb.SheetName=Jb?fb.NamedObjectName:fb.SheetName;eb.ItemListOptions=null;return eb}p2g(Jb,
eb){Jb=C.Range.Qc(Jb,eb);return this.gridView.Ea.H$(Jb,this.$.na.name)&&(Jb=this.gridView.Ea.xLa(Jb))&&Jb.autoFilterMenu?!0:!1}c7h(){var Jb=null;const eb=this.gridView.Sb(this.gridView.ha.ra.activeCell);if(!eb)return null;const za=eb.cell.LAc;let ha;({category:ha}=this.instantaneousSupportInformationManager.yCa(za,!1));if(1===eb.sx.type)if(3===ha){if(!eb.cell.tPa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${ha}. NumFmt is null. `),null;Jb=(eb.cell.tPa.Start+
eb.cell.tPa.End).trim()}else if(!ha&&(wa.a.F1a(eb.sx.value,"E")||wa.a.F1a(eb.originalText,"E"))){Jb=this.zg.sZe(eb.sx.value,za,1,Number.POSITIVE_INFINITY,eb.cell.Fia);if(!Jb.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${ha}. Failed to acquire formatted value`),null;Jb=Jb.iy}Jb||(Jb=eb.originalText);return qa.a.p2c(Jb)?["[Blanks]"]:["i"+Jb.trim()]}LVh(){const Jb=this.gridView.ha.ra.activeCell;var eb=this.$.da.za(66).Ig;const za=this.$.da.za(66).pwb(Jb);
if(eb)return eb.usedRange.top;if(null!=za)return za.top;eb=this.$.xa.getItemByName(this.$.na.sheetName);return(eb=S.D(eb.$0))&&eb.contains(Jb)?eb.top:-1}B5c(Jb,eb){const za={};za.Location=eb;za.FieldId=Jb.Id.toString();za.DataSourceIndex=-1;za.FilterType=Jb.AutoFilterType;za.AnchorType=0;za.ChartId=null;za.AnchorValue1=-1;za.AnchorValue2=-1;za.Property=Jb.RichProperty;return za}}Object(u.a)(Cb,"GridContextMenuFilter",null,[]);a.d(D,"GridContextMenu",function(){return Tb});class Tb extends t.a{constructor(Jb,
eb,za,ha){super(Jb,"PopulateGridContextMenu",1247109494,-2064931494,Tb.M8h,!0,!1,Tb.hLb,eb,za,!0,ha);this.mkc=this.expandCollapse=this.refresh=this.EZ=this.Wwa=this.IBa=!1;this.NIe=!0;this.grid=ea.h(Jb);this.$mc=!0;if(this.Nhc=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const fb=Ka.GetServiceTaskFactory.Oa(this.$.da,309,310,3),rb=Ka.GetServiceTaskFactory.create(this.$.da,18,this.la,3);va.TaskExtensions.Aa(va.TaskExtensions.Fd([fb,rb],this.la),()=>
{this.$.da.$a(268,pa=>{this.P5a=new Cb(Jb,fb.result,rb.result,pa)})},this.la,3)}}get ax(){return"PopulateGridContextMenu"}get UB(){return B.a.cRf}dispose(){super.dispose();this.grid=null}nc(Jb,eb){Jb=!this.Lsd(Jb,eb);if(!Jb)switch(eb){case -1977666927:Jb=null==this.P5a||this.IEj();break;case 1549396389:Jb=null==this.P5a||!this.Smi();break;case 2045563128:case 1803952894:Jb=null==this.P5a||!this.$.isEditMode&&!this.Tmi();break;case -425234874:Jb=this.MEj()}return Jb}Lsd(Jb,eb){const za=this.grid.ha.ra.selectedRanges;
return(new Y.a(this.$.xa)).zm(Jb,eb,za,this.grid)}executeCommand(Jb,eb,za){const ha=eb.command;Jb=null;switch(ha){case -1396319072:if(eb=this.grid.Sb(null))b.a.instance.i1c(!0),e.EventHandlerManager.instance.Ldd(),Tb.U1i(eb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ra.selectedRanges,eb);break;case 324156914:Jb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(za);break;case -1977666927:Jb=this.P5a.Poh();break;case 1549396389:Jb=this.P5a.eph();break;
case 1803952894:Jb=this.P5a.Uoh();break;default:Jb=N.a(ha)}return Jb||va.TaskExtensions.tba()}wc(Jb,eb,za){Jb=!1;switch(eb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Jb=!0;break;case 1441131127:Jb=!!za}return Jb}kZ(Jb=!1){let eb=!1,za=!1,ha=0;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ha=f.a.Ud());const fb=this.Va.cq(this.menuId);var rb=this.grid.ha.ra;const pa=rb.Mg,Ma=pa&&rb.$c.hf,
Ja=pa&&rb.$c.isRow;rb=rb.selectedRanges;const Ga=d.a.all(rb,ac=>ac.hf),La=d.a.all(rb,ac=>ac.isRow),nb=S.O(rb),Lb=S.P(rb);this.Okf(Ma,Ja)?(eb=!0,this.DNh(fb)):this.$.isEditMode?Ba.a(this.$)?this.ENh(fb,Ma,Ja):(this.zMh(fb,!(Ja||Ma||!this.mkc)),this.WMh(fb,rb,Jb),this.LMh(fb,Ga,La,nb,Lb),this.E_e(fb,pa,Ma,Ja),this.UNh(fb),this.j_e(fb,Ma,Ja),this.tNh(fb,pa,Ma,Ja,rb),this.CMh(fb),this.AMh(fb,rb),this.dNh(fb),this.PNh(fb,pa),ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.QMh(fb)):(za=!0,Ba.a(this.$)?this.z_e(fb):this.jOh(fb,pa,Ma,Ja,rb));ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Jb=f.a.Ud()-ha,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Jb}, isPivotMenu: ${eb}, isViewMenu: ${za}, firstTimeEntry: ${this.NIe}`));this.NIe=!1;return fb}lLa(Jb){const eb=[];if(Ba.a(this.$))return eb;if(3===Jb){Jb=this.grid.ha.ra;const ha=Jb.Mg,fb=ha&&Jb.$c.hf,rb=ha&&Jb.$c.isRow;
let pa=!1;var za=!1;let Ma=!1;this.$.isMobileMode&&(za=Jb.selectedRanges,pa=S.O(za),za=S.P(za));if(ha){const Ja=ea.f(this.grid);Ja&&Ja.range.contains(Jb.$c)&&this.IV(Ja)&&(Ma=!0)}this.$.isEditMode?this.Okf(fb,rb)?eb.push(...[x.a.jMf,x.a.lMf]):fb||rb?(eb.push(x.a.clipboard),rb?eb.push(x.a.drj):fb&&eb.push(x.a.O6g)):(eb.push(...[x.a.edit,x.a.clipboard]),Ma?eb.push(x.a.hyperlink):eb.push(x.a.color),ha&&eb.push(x.a.MUg)):(eb.push(x.a.copy),Ma&&eb.push(x.a.openHyperlink),!rb||this.$.isMobileMode&&za?!fb||
this.$.isMobileMode&&pa||eb.push(x.a.$3j):eb.push(x.a.a4j));eb.push(x.a.D8h)}else 2===Jb&&eb.push(x.a.HBe);return eb}Okf(Jb,eb){return(this.IBa||this.Wwa||this.EZ||this.refresh||this.expandCollapse)&&!(Jb||eb)}showGridContextMenu(Jb){this.expandCollapse=this.refresh=this.EZ=this.Wwa=this.IBa=!1;var eb=this.$,za=ca.a(eb).CLa(),ha=this.grid.ha.ra;const fb=ha.Mg;var rb=fb&&ha.$c.hf;ha=fb&&ha.$c.isRow;if(za&&!rb&&!ha){rb=V.a(eb);if(null===rb||void 0===rb?0:rb.gUd)this.IBa=rb=H.f(eb.hg),this.Wwa=!rb;rb=
eb.dc;this.EZ=za.supportsBIExplore&&!!A.a(eb)&&rb.b3(32768);rb.allowInteractivity&&(eb=this.grid.Sb(null),(null===eb||void 0===eb?0:eb.cell)&&(eb.cell.X0c||eb.cell.N7f)&&(this.expandCollapse=!0),rb.allowManualDataRefresh&&(this.refresh=!0))}eb=null;za=1;rb=Object(l.a)(h.a,Jb.eventArgs);Jb=Object(l.a)(y.a,Jb.creationParams);ha=this.FSh();Jb?(eb=Jb.clientPoint,za=Jb.inputMethod):rb&&1!==rb.tb?(eb=new Sys.UI.Point(rb.clientPoint.x,rb.clientPoint.y),za=rb.tb):ha&&(eb=new Sys.UI.Point(ha.x+(this.$.isChromeRtl?
0:ha.width),ha.y+ha.height));J.a.Db=za;this.mkc=3===za;Jb=r.a.Vub;this.Rp(eb,!rb||rb.Ca.target.className!==Jb,za)}removeHyperlinksFromRange(Jb,eb){if(!ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Zp(Jb,!0)){var za=S.r(Jb,this.$),ha=this.$.pa.ya.Wb();this.$.userOperationManager.Kc(new W.a(125,0,(fb,rb,pa)=>{this.$.Qy();return O.b(this.$.pa.ya,za,"","",!0,!1,127,fb,rb,pa,null,ha)},void 0,()=>new P(za)),eb);this.grid.Gf.tH(!1)}}FSh(){var Jb=
this.grid.Sb(null);if((null===Jb||void 0===Jb?0:Jb.cell.Pk)&&this.Xjf(Jb))return this.grid.getCellBounds(Jb.cell);Jb=this.grid.ha.ra.activeCell;return(Jb=this.Eac(new C.Range(Jb.top,Jb.left,z.a.eh,Jb.left,!1,!1),2,!0)||this.Eac(new C.Range(1,Jb.left,Jb.top,Jb.left,!1,!1),2,!1)||this.Eac(new C.Range(Jb.top,Jb.right,Jb.top,z.a.qh,!1,!1),1,!0)||this.Eac(new C.Range(Jb.top,1,Jb.top,Jb.right,!1,!1),1,!1)||null)&&Jb.Pk?this.grid.getCellBounds(Jb):Sys.UI.DomElement.getBounds(this.grid.Rwa.mc)}Xjf(Jb){var eb=
this.grid.rtl,za=this.$.isChromeRtl;Jb=Jb.cell;var ha=ea.h(this.$).sK(Jb);return ha?(ha=ha.topLeft,eb=ha.x+=eb===za?Jb.offsetWidth:0,za=ha.y+=Jb.offsetHeight,this.grid.view.visibleArea.contains(new w.a(eb,za,0,0))):!1}Eac(Jb,eb,za){Jb=this.grid.fk("GridContextMenu.FindFirstCellInViewportArea",Jb,eb,za);try{for(Jb.$$rst();Jb.$$mn();){const ha=Jb.$$cu();if(ha&&this.Xjf(ha))return ha.cell}}finally{Jb&&Jb.dispose()}return null}DNh(Jb){const eb=this.Va,za=eb.Ec();this.refresh&&za.buttons.push(eb.pb(100));
this.EZ&&za.buttons.push(eb.pb(99));this.IBa?za.buttons.push(eb.pb(59)):this.Wwa&&za.buttons.push(eb.pb(58));if(this.expandCollapse){let ha;ha=eb.ww("ContextMenu.PivotExpandCollapse",null,F.a.instance.ga(1161),589118293);const fb=eb.Ec();fb.buttons.push(eb.pb(243));fb.buttons.push(eb.pb(244));fb.buttons.push(eb.pb(245));fb.buttons.push(eb.pb(246));ha.menu.tc.push(fb);ha&&0<fb.buttons.length&&za.buttons.push(ha)}Jb.tc.push(za)}E_e(Jb,eb,za,ha){if(eb&&!za&&!ha){eb=this.Va.Ec();this.Nhc&&!this.$.LK&&
this.Ded(eb);this.Med(eb);this.YNh(eb);if(ra.EwaSettings.ma(475)&&ea.h(this.$).ha.ra.HK()&&ea.h(this.$).ha.ra.U5)switch(ra.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:eb.buttons.push(this.Va.pb(237));break;case 2:eb.buttons.push(this.Va.pb(238));break;default:eb.buttons.push(this.Va.pb(236))}Jb.tc.push(eb)}}Med(Jb){if(this.$.dc.allowSorting&&(!this.$.isMobileMode||(new Y.a(this.$.xa)).Td(2048))){var eb=this.Va.Ec();eb.buttons.push(this.Va.pb(223));
eb.buttons.push(this.Va.pb(224));eb.buttons.push(this.Va.pb(292));eb.buttons.push(this.Va.pb(293));eb.buttons.push(this.Va.pb(294));this.$.isMobileMode||eb.buttons.push(this.Va.pb(225));var za=this.Va.ww("ContextMenu.sort",null,F.a.instance.ga(227),-864298118);za.menu.tc.push(eb);Jb.buttons.push(za)}}Ded(Jb){const eb=this.Va.ww("ContextMenu.filter",null,F.a.instance.ga(1960),2045563128),za=this.Va.Ec();var ha=this.pXh();const fb=this.Va.pb(234);fb.label=ha;za.buttons.push(fb);za.buttons.push(this.Va.pb(235));
ha=this.Va.Ec();ha.buttons.push(this.Va.pb(233));eb.menu.tc.push(za);eb.menu.tc.push(ha);Jb.buttons.push(eb)}YNh(Jb){if(ea.h(this.$).ha.ra.HK()){const eb=this.Va.Ec();eb.buttons.push(this.Va.pb(232));eb.buttons.push(this.Va.pb(285));eb.buttons.push(this.Va.pb(286));const za=this.Va.ww("ContextMenu.table",null,F.a.instance.ga(1959),-697806646);za.menu.tc.push(eb);Jb.buttons.push(za)}}u_e(Jb,eb,za,ha,fb){if(eb){const pa=S.K(fb);var rb=ea.f(this.grid);if(rb&&!za&&!ha){za=new Y.a(this.$.xa);if(rb.range.contains(pa)&&
this.IV(rb)){(eb=!rb.Ixa&&!za.ki)&&this.$.isEditMode&&Jb.buttons.push(this.Va.pb(45));rb.xba&&Jb.buttons.push(this.Va.pb(53));eb&&this.$.isEditMode&&Jb.buttons.push(this.Va.pb(47));return}!rb.Ixa&&this.$.isEditMode&&(rb=za.Td(128),Jb.buttons.push(this.Va.pb(rb?46:121)))}}this.Sbj(fb)&&Jb.buttons.push(this.Va.pb(48));(rb=this.$.xa.na)&&rb.Ed&&(rb=rb.Ed.Iv||rb.Ed.iI,!eb||this.$.LK||!ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||!X.g(this.$)||this.$.ea.isNamedObjectViewMode||
this.$.isMobileMode||rb||(eb=S.K(fb),this.Rbj(eb)?Jb.buttons.push(this.Va.pb(276)):eb.hf||eb.isRow||Jb.buttons.push(this.Va.pb(275))))}Sbj(Jb){for(const eb of Jb){Jb=this.grid.getRangeInformation(eb);for(let za=0;za<Jb.length;za++)if(Object(v.a)(G.HyperlinkRange,Jb[za])){const ha=this.grid.Sb(Jb[za]);if(ha&&this.IV(ha)&&!ha.Ixa)return!0}}return!1}Rbj(Jb){if(ea.h(this.$).ha.ra.HK()){const eb=ea.h(this.$).Bb.Bj(Jb);if(eb&&eb.usedRange.equals(Jb))return!0}return!1}j_e(Jb,eb,za){var ha,fb;if(1===ea.h(this.$).ha.Ne&&
!eb&&!za){eb=Ba.a(this.$);za=this.Va;var rb=za.Ec(),pa=this.$.da.za(65);(null===(ha=null===pa||void 0===pa?void 0:pa.$m)||void 0===ha?0:ha.FF)&&!eb&&rb.buttons.push(za.pb(227));pa&&pa.isCommentOperationEnabled(3)&&rb.buttons.push(za.pb(221));(null===(fb=null===pa||void 0===pa?void 0:pa.$m)||void 0===fb?0:fb.Fld)&&!eb&&rb.buttons.push(za.pb(228));(null===pa||void 0===pa?0:pa.hasCommentAtActiveCell)?pa.ZC.isResolved||rb.buttons.push(za.pb(159)):pa&&pa.hasCommentAtActiveCell||(pa&&pa.$m&&pa.$m.FF?eb||
(rb.buttons.push(za.pb(229)),rb.buttons.push(za.pb(230))):(rb.buttons.push(za.pb(160)),eb||rb.buttons.push(za.pb(226))));Jb.tc.push(rb)}}UNh(Jb){if(ra.EwaSettings.ma(134)){const eb=this.Va,za=eb.Ec();za.buttons.push(eb.pb(250));Jb.tc.push(za)}}WMh(Jb,eb,za){if(!za){za=this.$.Ka.NH();var ha=new Y.a(this.$.xa),fb=new T.a(za,eb,this.grid);(new L(Jb,this.$,this.Va,za,eb,this.grid,fb,ha)).zed()}}LMh(Jb,eb,za,ha,fb){const rb=(new Y.a(this.$.xa)).Td(8),pa=this.Va,Ma=pa.Ec();eb&&Ma.buttons.push(pa.pb(rb?
152:153));za&&Ma.buttons.push(pa.pb(rb?150:151));eb&&(ha||Ma.buttons.push(pa.pb(rb?109:155)),Ma.buttons.push(pa.pb(rb?111:157)));za&&(fb||Ma.buttons.push(pa.pb(rb?108:154)),Ma.buttons.push(pa.pb(rb?110:156)));Jb.tc.push(Ma)}zMh(Jb,eb){const za=this.Va,ha=za.Ec();Jb.tc.push(ha);eb&&ha.buttons.push(za.pb(102));ha.buttons.push(za.pb(42));ha.buttons.push(za.pb(43));eb=this.ANh(za);Jb.tc.push(eb)}ANh(Jb){const eb=Jb.Ec();eb.title=F.a.instance.ga(1141);eb.K9f=!1;eb.J9f=!1;eb.Udg=!1;let za=5;const ha=I.a.lud(this.$);
ha&&(za=6);Jb=Jb.gB("PasteOptionsGallery",za,"Size24by24",eb.title);eb.buttons.push(Jb);Jb.ku("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1142,void 0,"Paste_24",1,n.a.BAh);Jb.ku("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1143,void 0,"PasteValues_24",1,n.a.GAh);Jb.ku("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1144,void 0,"PasteFormulas_24",1,n.a.DAh);Jb.ku("ContextMenu.PasteTranspose",-958589048,
"QueryAdvancedPasteContextMenuGalleryIcon",1145,void 0,"PasteTranspose_24",1,n.a.FAh);Jb.ku("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"PasteFormatting_24",1,n.a.CAh);ha&&Jb.ku("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteLink_24",1,n.a.EAh);return eb}jOh(Jb,eb,za,ha,fb){var rb;const pa=this.Va;var Ma=pa.Ec();Ma.buttons.push(pa.pb(43));Jb.tc.push(Ma);this.Nhc&&!this.$.LK&&(Ma=this.Va.Ec(),this.Ded(Ma),
Jb.tc.push(Ma));ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.dc.isMobileMode&&this.$.ea.dc.isReadOnlyEditMode&&!this.$.va.IsMeetingLiveSession||(Ma=this.Va.Ec(),this.Med(Ma),Jb.tc.push(Ma),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Ma=this.$.da.za(65);if(null===(rb=null===Ma||void 0===Ma?void 0:Ma.$m)||
void 0===rb?0:rb.FF)rb=this.Va.Ec(),rb.buttons.push(pa.pb(229)),Jb.tc.push(rb);rb=this.Va.Ec();this.u_e(rb,eb,za,ha,fb);Jb.tc.push(rb);m.AFrameworkApplication.isMobileMode&&!M.a(this.$.va,29)&&(eb=pa.Ec(),eb.buttons.push(pa.pb(272)),Jb.tc.push(eb))}tNh(Jb,eb,za,ha,fb){const rb=this.Va.Ec();this.uNh(rb);this.u_e(rb,eb,za,ha,fb);0<rb.buttons.length&&Jb.tc.push(rb)}uNh(Jb){Jb.buttons.push(this.Va.pb(135))}QMh(Jb){const eb=this.Va.Ec();eb.buttons.push(this.Va.pb(185));Jb.tc.push(eb)}PNh(Jb,eb){ra.EwaSettings.ma(476)&&
eb&&(eb=this.Va.Ec(),eb.buttons.push(this.Va.pb(262)),Jb.tc.push(eb))}dNh(Jb){var eb=this.grid.ha.ra.selectedRanges;if(eb&&eb.length){var za=!1;for(var ha=0;ha<eb.length;ha++)if(this.grid.Bb.Yxa(eb[ha])){za=!0;break}if(za){za=!1;for(ha=0;ha<eb.length;ha++){var fb=this.grid.Bb.F0h(eb[ha]);if(null!=fb&&null!=fb[0]){for(var rb=0;rb<fb.length;rb++)if(this.grid.Bb.Yxa(fb[rb])){za=!0;break}if(za)break}}rb=this.Va;ha=rb.Ec();fb=rb.Ec();var pa=1===eb.length&&(eb[0].isSingle||this.grid.Bb.VNa(eb[0])),Ma=!1,
Ja=!1,Ga=!1,La=!1;for(let nb=0;nb<eb.length&&!(Ma&&Ga&&Ja&&La);nb++)!Ma&&this.grid.Bb.Mri(eb[nb])&&(Ma=!0),!Ga&&this.grid.Bb.Ojf(eb[nb],!1)&&(Ga=!0),!Ja&&this.grid.Bb.Asd(eb[nb])&&(Ja=!0),!La&&this.grid.Bb.Zgf(eb[nb])&&(La=!0);ra.EwaSettings.ma(104)&&pa&&!this.grid.Bb.Xzb(eb[0])&&(La?ha.buttons.push(rb.pb(217)):ha.buttons.push(rb.pb(216)));La=Ma;La=!(new Y.a(this.$.xa)).ki&&La;Ga&&!za&&(ra.EwaSettings.ma(130)&&H.l(this.$.hg)&&(ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?fb.buttons.push(rb.pb(220)):fb.buttons.push(rb.pb(La?220:271))),Ja&&fb.buttons.push(rb.pb(La?218:269)),pa&&(this.grid.Bb.Asd(eb[0])||this.grid.Bb.Xzb(eb[0]))&&fb.buttons.push(rb.pb(La?219:270))),fb.buttons.push(rb.pb(La?215:268)));0<fb.buttons.length&&(eb=rb.ww(Ma?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,F.a.instance.ga(1772),798637440),
eb.menu.tc.push(fb),ha.buttons.push(eb));0<ha.buttons.length&&Jb.tc.push(ha)}}}AMh(Jb,eb){this.grid.Bb.eif(eb)&&(eb=this.Va.Ec(),this.grid.ha.ra.gca()?(eb.buttons.push(this.Va.pb(241)),eb.buttons.push(this.Va.pb(239))):eb.buttons.push(this.Va.pb(240)),Jb.tc.push(eb))}IV(Jb){return Jb.cell.hasHyperlink}z_e(Jb){this.FNh(Jb);var eb=this.Va.Ec();this.Med(eb);Jb.tc.push(eb);this.Nhc&&(eb=this.Va.Ec(),this.Ded(eb),Jb.tc.push(eb))}ENh(Jb,eb,za){this.z_e(Jb);this.j_e(Jb,eb,za)}FNh(Jb){if(this.grid.ha.ra.Mg&&
!this.grid.ib.tj){var eb=this.Va,za=eb.Ec();ka.a(this.$).MUd()?za.buttons.push(eb.pb(265)):za.buttons.push(eb.pb(264));Jb.tc.push(za)}}static U1i(Jb){const eb=Jb.sLa(Tb.Smd);eb&&eb.Lod&Tb.Smd&&Jb.invoke(Tb.Smd,null)}static VMh(Jb,eb,za){(za=za.da.za(254))?(za.nrd()&&za.Vof()&&Jb.buttons.push(eb.pb(212)),za.nrd()&&za.hlc()&&Jb.buttons.push(eb.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}IEj(){const Jb=
this.$.da.za(66).Ig,eb=this.grid.ha.ra.activeCell;return null!=Jb&&!Jb.hasActiveFilter||Oa.c(this.$,eb)||!this.Umi(eb)}Umi(Jb){const eb=Jb.left;var za=this.$dc();if(null!=za&&null!=za.uac&&za.uac.includes(eb-1))return!0;za=this.Rdc();return null!=za&&S.D(za).contains(Jb)&&null!=za.FilteredColumns&&za.FilteredColumns.includes(eb-1)?!0:!1}Smi(){var Jb=this.$.da.za(66).Ig;const eb=this.$dc();if(null!=Jb)return Jb.hasAutoFilter&&Jb.hasActiveFilter;if(null!=eb)return null!=eb.uac&&0<eb.uac.length;Jb=this.Rdc();
return null!=Jb&&null!=Jb.FilteredColumns&&0<Jb.FilteredColumns.length}Tmi(){var Jb=this.$.da.za(66).Ig;const eb=this.$dc();if(null!=Jb&&Jb.hasAutoFilter||null!=eb&&eb.u0a.every(za=>0!=za.length))return!0;Jb=S.D(this.Rdc());return null!=Jb&&Jb.contains(this.grid.ha.ra.activeCell)?!0:!1}$dc(){const Jb=this.$.da.za(66);Jb.Dn(this.grid.ha.ra.activeCell);return Jb.pwb(this.grid.ha.ra.activeCell)}Rdc(){return this.$.xa.getItemByName(this.$.na.sheetName).$0}pXh(){var Jb=this.grid.ha.ra.activeCell,eb=0,
za=!1,ha=this.$.da.za(66),fb=this.$dc();ha=ha.Ig;null!=ha?(eb=ha.usedRange.top,za=!0):null!=fb?(eb=fb.top,za=!0):(fb=this.Rdc(),null!=fb&&S.D(fb).contains(Jb)&&(eb=fb.FirstRow+1,za=!0));return za?(Jb=Jb.left,eb=C.Range.Qc(eb,Jb),eb=this.grid.Sb(eb),za="",null!=eb&&(za=eb.text),this.UXg(za,Jb)):F.a.instance.ga(220)}UXg(Jb,eb){return null==Jb||wa.a.ph(Jb.trim())?String.format(F.a.instance.nb(157),C.Range.QM(eb)):Jb.length>Tb.B4d?String.format(F.a.instance.nb(155),Jb.substring(0,Tb.B4d)):String.format(F.a.instance.nb(156),
Jb)}MEj(){const Jb=this.grid.ha.ra.selectedRanges;if(!Jb||!Jb.length)return!0;for(let eb=0;eb<Jb.length;eb++)if(!this.grid.Bb.Sxa(Jb[eb]))return!1;return!0}}Tb.hLb="GridContextMenuRootName";Tb.M8h=B.a.vGe;Tb.Smd=192;Tb.B4d=26;Object(u.a)(Tb,"GridContextMenu",t.a,[])},1219:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(87),e=a(1090),f=a(8),d=a(775);class h{}h.cYd="suggested_cells_list_box";Object(u.a)(h,"CssElementIds",null,[]);var m=a(5),l=a(1091);class v{constructor(va,ca){this.stg=va;this.rtg=ca}get D$(){return this.stg}get RZc(){return this.rtg}}
Object(u.a)(v,"CellAutoCompleteItem",null,[556]);var t=a(4),z=a(82),r=a(909),n=a(382),w=a(42),B=a(1),A=a(22),y=a(21);class x extends r.a{constructor(va,ca,V){super(va,ca);this.SSb=null;this.blc=0;this.k1=this.j9a=null;this.L6=(ra,N)=>{if(ra=this.cellAutoCompleteControl.items)if(1===ra.length&&this.cellAutoCompleteControl.b2a.length<ra[0].D$.length&&this.cellAutoCompleteControl.Zwa&&A.a.zG(ra[0].D$,this.cellAutoCompleteControl.b2a)&&(N.newValue=ra[0].D$),this.Za&&B.EwaSettings.ma(135)){let ea=-1;1<
ra.length?ea=this.cellAutoCompleteControl.Xdc(this.Za.text,!0):1===ra.length&&(this.cellAutoCompleteControl.Zwa||this.cellAutoCompleteControl.Qfc)&&(ea=0);if(0<=ea&&ra.length>ea&&ra[ea].RZc){const Ba=w.C(ra[ea].RZc);Ba&&y.h(this.$).Bb.Yxa(Ba)&&(N.Xgf=!0,N.CBe=ra[ea].RZc)}}};this.SGb=()=>{this.cellAutoCompleteControl.Zwa=!1};this.Za.IZa(this.L6);if(this.bAb=B.EwaSettings.ol())this.SSb=V;this.k1=this.Be.Zd(this.Za.textBox.domElement);this.k1.ka("mousedown",this.SGb)}get sAb(){return!1}get KK(){return this.cellAutoCompleteControl.qe}set KK(va){this.cellAutoCompleteControl.qe=
va}get F6a(){return!1}get key(){return n.a.M1c}get cellAutoCompleteControl(){if(this.bAb)return this.SSb;const {CellAutoCompleteControl:va}=a(1219);return this.SSb||(this.SSb=Object(z.a)(va,this.$.da.za(1)))}dispose(){this.Za.$Jb(this.L6);super.dispose()}ZY(va){va&&!this.cellAutoCompleteControl.qe||super.ZY(va)}Xh(va,ca){this.cellAutoCompleteControl.Za=this.Za;this.blc=va.keyCode;if(this.Za.eb){const V=this.Za.text;A.a.equals(this.j9a,V,!1)||(this.j9a=V)}else this.j9a=null;if(237279923===ca)return this.cellAutoCompleteControl.qe=
!1;B.EwaSettings.ma(135)&&17===this.blc&&this.cellAutoCompleteControl.Zwa&&(this.cellAutoCompleteControl.Qfc=!0);return super.Xh(va,ca)}kCd(){var va;if(!B.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!t.AFrameworkApplication.Lg)if(this.cellAutoCompleteControl.Za=this.Za,this.cellAutoCompleteControl.Zwa=!1,this.Za.eb){const ca=!A.a.equals(this.j9a,this.Za.text,!0),V=this.Za.oqd;V||!ca&&229!==this.blc?V&&(this.cellAutoCompleteControl.qe&&(this.cellAutoCompleteControl.qe=
!1),null===(va=this.cellAutoCompleteControl.EOa)||void 0===va?void 0:va.cancel()):this.cellAutoCompleteControl.ATg(this.blc)}else this.j9a=null}rh(){}Nf(){this.KK=!1;this.cellAutoCompleteControl.set_visible(!1);this.j9a=null;this.cellAutoCompleteControl.Zwa=!1;this.cellAutoCompleteControl.Qfc=!1;this.cellAutoCompleteControl.EOa&&this.cellAutoCompleteControl.EOa.cancel()}QId(va,ca){return this.cellAutoCompleteControl.Xh(va,ca)}}Object(u.a)(x,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var F=
a(30);r=a(1092);var I=a(12),L=a(11),X=a(117);class P extends r.a{constructor(va,ca,V,ra){super(va,ca);this.htmlSanitizationHelper=this.Sra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=V;if(this.bAb=B.EwaSettings.ol())this.cellAutoCompleteControl=ra;this.vp=[]}get Nj(){return this.Sra}set Nj(va){this.mCa(this.Nj);this.Sra=va;const ca=this.mCa(this.Nj);this.ee=va?ca.innerText:null;this.cxc(va)}get qe(){return super.qe}set qe(va){super.qe=va;va||(this.Nj=null)}get HUa(){return null}get tHa(){return this.bAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}dispose(){super.dispose();this.Sra=null}ABc(va){this.l8(!1);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var ca=document.createElement("table");ca.classList.add(this.m6);ca.Dik=m.a.pHa;var V=document.createElement("tbody");for(let ra=0,N=this.vp.length;ra<N;ra++){const ea=
document.createElement("tr"),Ba=document.createElement("td");Ba.classList.add(this.UV);const ka=document.createElement("span");ka.classList.add(P.D3b);ka.setAttribute(m.a.AYc,va[this.vp[ra]].D$);ka.innerText=va[this.vp[ra]].D$;Ba.appendChild(ka);ea.appendChild(Ba);V.appendChild(ea)}ca.appendChild(V);this.htmlSanitizationHelper.aZ(this.If);this.If.appendChild(ca)}else{ca=`<table class='${this.m6}' aria-live='polite'><tbody>`;for(let ra=0,N=this.vp.length;ra<N;ra++)V=F.a.Eg(va[this.vp[ra]].D$),V=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.UV,P.D3b,m.a.AYc,V,F.a.l$c(V)),ca+=V;ca+="</tbody></table>";this.If.innerHTML=ca}this.Ln=I.DOMElementExtensions.ik(this.domElement,this.m6);this.l8(!0);this.Fsa()}wKa(va,ca){if(va&&va.length){var V=[];if(ca)for(let ra=0,N=va.length;ra<N;ra++)A.a.zG(va[ra].D$,ca)&&V.push(ra);this.vp=V;this.ABc(va)}else this.qe=!1,this.Sra=null}Xya(){}a0g(va,ca,V){let ra=Math.min(va,Math.max(200,V));ca&&va<V&&(ra+=X.a.Ou);I.DOMElementExtensions.Xv(this.If,ra);ca&&(ra-=X.a.Ou);return ra}Fsa(){super.Fsa();var va=
I.DOMElementExtensions.ik(this.get_element(),this.m6),ca=this.vp.length>this.sI,V=y.h(this.$);if(V=V.Sb(V.ha.ra.activeCell))for(va=this.a0g(va.offsetWidth,ca,V.width),ca=this.If.getElementsByClassName(P.D3b),V=0;V<ca.length;V++)ca[V].style.maxWidth=L.HelperMethods.uc(va);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(va){if(va=super.onItemClick(va)){const ca=y.h(this.$);ca.Uo(!1);ca.focus()}return va}}
P.D3b=d.a.Vzh;Object(u.a)(P,"CellAutoCompleteListBox",r.a,[]);var G=a(24),C=a(64),H=a(113),J=a(171),M=a(46),S=a(35),W=a(251),O=a(19);a.d(D,"CellAutoCompleteControl",function(){return Y});const T=`<div id='${h.cYd}' class='${d.a.k$b} ${O.a.rp}' ></div>`;class Y extends e.a{constructor(va,ca,V){super(va);this.UDa=null;this.L1c=[];this.G8d=null;this.Qfc=this.Zwa=!1;this.uee=this.Dq=null;this.qOe=()=>{this.WY.wKa(this.items,this.UDa);this.raiseEvent("ACLBUpdated",new l.a(this.items.length));this.show()};
this.tableManager=ca;this.domElement.className=d.a.rRe;B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(ca=document.createElement("div"),ca.classList.add(d.a.k$b),ca.classList.add(O.a.rp),ca.id=h.cYd,this.domElement.appendChild(ca)):this.domElement.innerHTML=T;I.DOMElementExtensions.setVisible(this.domElement,!1);W.d(this.style,this.$.isChromeRtl);this.Aif=B.EwaSettings.ol();this.BBe=
$get(h.cYd,this.domElement);this.WY=new P(this.$,this.BBe,V,this);this.fUa(!0);this.$.domElement.appendChild(this.domElement);this.Ipb(va,H.a(va));this.Ipb(va,y.h(va).Vb);this.Aif||this.$.da.Ga(1,this);this.Ymi=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}l0b(va){this.addHandler("ACLBUpdated",va)}Zuc(va){this.removeHandler("ACLBUpdated",va)}X2(va){this.addHandler("ACLBSelectionChanged",va)}Sda(va){this.removeHandler("ACLBSelectionChanged",va)}nNg(va){this.addHandler("ACLBMatchedItem",
va)}Yjj(va){this.removeHandler("ACLBMatchedItem",va)}get ou(){return this.WY}get b2a(){return this.UDa}get ee(){return this.WY.ee}get items(){return this.Dq}get EOa(){return this.uee}get activeCell(){return y.h(this.$).ha.ra.activeCell}get dataValidationControl(){return this.G8d||(this.G8d=this.$.da.za(14))}ebg(va){for(let ca=0;ca<va.length;ca++){const V=va.charCodeAt(ca);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?A.a.isLetter(V):
A.a.vrd(V))return!0}return!1}Kxa(){return!this.items}dispose(){if(this.$){this.fUa(!1);const va=y.h(this.$);va&&va.view.ir(this.wpc)}b.a.qc([this.WY,this.EOa]);b.a.qc(this.L1c);this.L1c=this.BBe=this.WY=this.Za=null;super.dispose()}Xh(va,ca){let V=!1;if(this.jFj())switch(ca){case -798660877:if(1===this.items.length&&this.ee)break;this.ou.IB(1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.Xdc(this.ee),this.ee));V=this.mz(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;
this.ou.IB(-1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.Xdc(this.ee),this.ee));V=this.mz(!1);break;case 2091832999:this.ou.IB(this.sI-1);V=this.mz(!1);break;case 742457698:this.ou.IB(-(this.sI-1));V=this.mz(!1);break;case 125627505:this.Za.textBox.caretPosition=this.Za.text.length;this.qe=!1;V=!0;break;case 267796030:this.mz(!0);break;default:V=super.Xh(va,ca)}return V}show(){this.items&&this.items.length&&(this.WY.Nj=this.ee?this.ou.Ln.rows[this.Xdc(this.ee)]:null,this.qe=
0<this.WY.vp.length,this.ECa(!0),this.WY.Xya())}ATg(va){const ca=!!this.Za&&!C.f(this.$.na);this.Qfc=this.Zwa=!1;this.Za&&!this.Za.eb?this.set_visible(!1):ca&&!this.tjh(this.activeCell)&&this.UIj(va)}tjh(va){return!!this.dataValidationControl&&this.dataValidationControl.k9c(va)}mz(va){if(!this.Za||!this.qe)return!1;const ca=this.UDa;if(this.ee){var V=I.DOMElementExtensions.OZ(I.DOMElementExtensions.ik(this.WY.Nj,P.D3b),m.a.AYc,"");const ra=V.substring(ca.length,V.length);va?this.Za.text=V:this.Za.insertTextAt(ra,
ca.length,this.Za.text.length)}V=y.h(this.$);V.Vl&&(V=V.Vb,V.text=this.Za.text,V.setCaretPosition(this.Za.textBox.caretPosition));va?this.qe=!1:this.Za.textBox.selectRange(ca.length,this.Za.text.length);return!0}Xdc(va,ca=!1){if(!this.WY.Ln)return-1;const V=this.WY.Ln.children[0],ra=V.children.length;let N;for(let ea=0;ea<ra;++ea)if(N=V.children[ea],A.a.equals(N.innerText.trim(),va,ca))return ea;return-1}rIg(va,ca,V,ra,N,ea,Ba){const ka=V.originalText.replace(Y.rxf,String.fromCharCode(32)),Ka=new G.Range(va.top-
1,va.left,va.bottom-1,va.right,!1,!1),Oa=Ba?Ba.Dn(V.range):null;(!V.cI||V.range.left===va.left)&&1<ka.length&&!ra.lb(ka.toUpperCase())&&A.a.zG(ka,ca)&&!A.a.equals(ka,ca,!0)&&!Y.jYe(ca)&&this.ebg(ka)&&(!N&&!Oa||!N&&Oa.equals(Ba.Dn(Ka))||N&&V.range.Ad(ea)&&V.range.top!==ea.top)&&(va=V.formulaBarText,A.a.equals(va,V.text,!1)||!va)&&(va={},va.FirstRow=V.range.top-1,va.FirstColumn=V.range.left-1,V=new v(ka,va),ra.add(ka.toUpperCase(),V))}UIj(va){this.Dq=this.X4h();this.EOa&&this.EOa.cancel();0<this.Za.text.length&&
0!==va?this.items&&((1<this.items.length||this.qe)&&this.$ph(),8!==va&&127!==va&&46!==va&&(1===this.items.length?this.rnd(!1):this.WY.Nj&&this.mz(!1))):this.qe=!1}$ph(){this.qe?this.qOe():this.uee=J.AsyncMethodContext.Gr(this.qOe,500,M.a.n2g,this.EOa)}rnd(va){c.ULS.shipAssertTag(537167966,0,!this.Kxa()&&1===this.items.length,"Invalid Items");let ca=this.items[0].D$,V=this.Za.text,ra=ca.substring(V.length,ca.length);if(va&&!ra.length)this.Za.text=ca;else if(!va&&0<ra.length)this.Za.appendText(ra),
this.Za.textBox.selectRange(V.length,this.Za.text.length);else return;this.raiseEvent("ACLBMatchedItem",new l.a(this.items.length,0,ca));this.Zwa=!0}X4h(){this.Dq=null;const va=new S.a(!1);var ca=this.activeCell;this.UDa=this.Za.text.replace(Y.rxf,String.fromCharCode(32));const V=this.tableManager.Dn(ca),ra=ca.Ad(V);if(Y.jYe(this.UDa)||!this.ebg(this.UDa))return this.items;const N=new G.Range(1,ca.left,ca.top-1,ca.left,!1,!1);var ea=new G.Range(ca.top+1,ca.left,f.a.eh,ca.left,!1,!1);let Ba;const ka=
y.h(this.$);ea=ka.fk("CellAutoCompleteControl.GetSuggestedCells",ea);try{const Ka=ka.fk("CellAutoCompleteControl.GetSuggestedCells2",N);try{for(const Oa of[Ka,ea])for(;Oa.$$mn();)Ba=Oa.$$cu(),this.rIg(ca,this.UDa,Ba,va,ra,V,this.tableManager)}finally{Ka&&Ka.dispose()}}finally{ea&&ea.dispose()}this.Dq=Array(va.values.length);for(ca=0;ca<this.items.length;ca++)this.items[ca]=va.values[ca];this.items.sort((Ka,Oa)=>Ka.D$.localeCompare(Oa.D$));return this.items}Ipb(va,ca){va&&ca&&this.L1c.push(new x(va,
ca,this.Aif?this:void 0))}jFj(){return this.Ymi?this.b2a&&!this.Kxa()&&this.qe?this.get_visible():!1:this.b2a&&!this.Kxa()&&this.get_visible()&&this.qe}static get rxf(){return Y.$fe||(Y.$fe=new RegExp(String.fromCharCode(160),"g"))}static jYe(va){va=0<va.length?va.charCodeAt(0):-1;return 35===va||61===va||43===va||45===va||64===va}}Y.$fe=null;Object(u.a)(Y,"CellAutoCompleteControl",e.a,[520,521,522,2])},1226:function(u,D,a){u=a(0);var c=a(566),b=a(561),e=a(558),f=a(1E3);class d{Tfh(I,L){if(I&&!(1>
I.length)&&L){var X=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.ndh(I,X.ControlList);L.push(X)}}ndh(I,L){const X=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(L,X);L=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(X.Menu.MenuSectionList,L);this.yfh(I,L.ControlList)}yfh(I,
L){for(let X=0;X<I.length;X++){const P=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",X),Command:"336231556",DisplayName:I[X].userName,LabelText:I[X].userName,ImageBackColor:I[X].color,PersonaId:I[X].email,IsAnonymous:I[X].isAnonymous});Array.add(L,P)}}}Object(u.a)(d,"PresenceContextMenuSectionBuilder",null,[351]);var h=a(84),m=a(4),l=a(175),v=a(559),t=a(106),z=a(134),r=a(87),n=a(83),w=a(105),B=a(25);class A{constructor(I,L,X,P){this.F6d=this.L1=this.Wi=this.wE=this.S8=null;
this.AYb=I;this.WDg=P;this.AYb.dNa&&(this.Wi=new t.a(3,2,5E3,Object(h.a)(this,this.DUg,"authenticationCheckTask"),2),m.AFrameworkApplication.Fi.Cg(this.Wi),this.Fg(L,X));this.AYb.pob(()=>{this.wzf()});this.AYb.GZa(()=>{this.xzf()})}get businessBar(){return this.L1||(this.L1=n.a.instance.Jh("CommonUI.IBusinessBar"))}get oze(){return this.F6d||(this.F6d=n.a.instance.Jh("CommonUI.IBusinessBarEntryFactory"))}Fg(I,L){const X=m.AFrameworkApplication.ub;X.Me(B.a.authenticationLost,w.a.frame,I,96);X.Me(B.a.ixe,
w.a.frame,L,96);X.Mb(B.a.iBe,w.a.frame,l.ActionManager.d9c);X.Mb(B.a.jBe,w.a.frame,l.ActionManager.d9c);X.Mb(B.a.Gvd,w.a.frame,l.ActionManager.d9c)}wzf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);m.AFrameworkApplication.ub.processAction(B.a.authenticationLost,2)}xzf(){this.DQj();m.AFrameworkApplication.ub.processAction(B.a.ixe,2)}DUg(){this.AYb.authenticationCheck()}DQj(){this.wE&&(this.wE.hide(),this.wE.dispose(),this.wE=null);this.S8&&this.businessBar&&(m.AFrameworkApplication.Lg||
this.businessBar.removeEntry(this.S8),this.S8.dispose(),this.S8=null)}showDialog(I){r.a.Ia(this.wE);this.wE=new z.StandardDialog;this.WDg||(this.wE.Jt=!1,this.wE.Rb=0);this.wE.oc(1,CommonUIStrings.l_SignIn);this.wE.oX(CommonUIStrings.l_DefaultDialogTitle,I,Object(h.a)(this,this.yw,"dialogHandler"))}yw(I){1===I?(v.a.h7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),m.AFrameworkApplication.ub.processAction(B.a.Gvd,2)):(this.ZUd(),m.AFrameworkApplication.ub.processAction(B.a.jBe,
2))}ZUd(){this.businessBar&&this.oze&&(this.S8=this.oze.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.S8.closeable=!0,this.S8.addButton(CommonUIStrings.l_SignIn,A.ZZg,""),this.S8.X$=Object(h.a)(this,this.b_g,"businessBarEntryCloseHandler"),this.businessBar.HC(this.S8,!1))}b_g(){this.znh();m.AFrameworkApplication.ub.processAction(B.a.iBe,2)}znh(){this.Wi&&(m.AFrameworkApplication.Fi.np(this.Wi),this.Wi=null)}dispose(){this.Wi=this.wE=this.S8=
null}static ZZg(){v.a.h7();m.AFrameworkApplication.ub.processAction(B.a.Gvd,2)}}Object(u.a)(A,"SignOutResponseUI",null,[2]);var y=a(248);class x{get name(){return"Common.App.UI"}Vh(I){I.register(d,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").xc()}init(){}dispose(){r.a.Ia(x.v2);x.v2=null}static main(){y.a.instance.Ei(new x)}}x.v2=null;Object(u.a)(x,"CommonAppUIPackage",null,[4,5]);a.d(D,"a",function(){return F});const F=()=>{Type.registerNamespace("CAUI");
x.main()}},1227:function(u,D,a){u=a(0);var c=a(55),b=a(222),e=a(1219),f=a(50),d=a(37),h=a(1),m=a(695);class l extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=this.$.da,A=f.GetServiceTaskFactory.create(B,134,this.la,this.Ya),y=f.GetServiceTaskFactory.Oa(B,213,214,this.Ya),x=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Ya):c.Task.Ta(null);d.TaskExtensions.Aa(d.TaskExtensions.Fd([A,y,x],this.la),()=>{if(h.EwaSettings.ol())this.ob(Object(m.a)(this.$.da,1,()=>{const F=new e.CellAutoCompleteControl(this.$,A.result,x.result);y.result.ka(F);return F}));else{let F=B.za(1);F||(F=new e.CellAutoCompleteControl(this.$,A.result,x.result),y.result.ka(F));this.ob(F)}},this.la,3)}static ka(B){B.da.Ga(151,new l(B))}}Object(u.a)(l,"CellAutoCompleteControlFactory",b.a,[]);var v=a(15),t=a(13);class z{constructor(B,A){this.O_a=
null;this.tGf=(y,x)=>{1<x.length&&(y=t.a.instance.ga(857),this.ariaLiveNotifier.tRf(y,x.length))};this.uGf=(y,x)=>{v.ULS.shipAssertTag(537167961,0,0<=x.selectedIndex&&0<=x.length&&x.selectedIndex<x.length,"Invalid ListEventArgs: SelectedIndex/Length");v.ULS.shipAssertTag(537167960,0,!!x.tG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.Ycj(x.tG,x.selectedIndex+1,x.length)};this.vGf=(y,x)=>{this.ariaLiveNotifier.WQa(x.tG)};this.ariaLiveNotifier=B;h.EwaSettings.ol()||A.Ga(213,
this)}dispose(){this.z0d();this.O_a=null}ka(B){B&&(this.O_a=B,B.l0b(this.tGf),B.X2(this.uGf),B.nNg(this.vGf))}z0d(){this.O_a&&(this.O_a.Zuc(this.tGf),this.O_a.Sda(this.uGf),this.O_a.Yjj(this.vGf))}}Object(u.a)(z,"CellAutoCompleteReadoutHandler",null,[523,2]);class r extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=this.$.da;d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(B,211,212,this.Ya),A=>{if(h.EwaSettings.ol())this.ob(Object(m.a)(B,213,()=>new z(A.result,B)));else{const y=
B.za(213)||new z(A.result,B);this.ob(y)}},this.la,3)}static ka(B){B.da.Ga(214,new r(B))}}Object(u.a)(r,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var n=a(9);a.d(D,"a",function(){return w});const w=()=>{n.a.Fa(l.ka);n.a.Fa(r.ka)}},1228:function(u,D,a){var c=a(9);u=a(0);var b=a(235),e=a(222),f=a(50),d=a(37),h=a(1),m=a(15),l=a(87),v=a(4),t=a(78),z=a(8),r=a(24),n=a(64),w=a(42),B=a(142),A=a(47),y=a(46),x=a(12),F=a(13),I=a(21),L=a(27),X=a(19),P=a(53);class G extends t.a{constructor(W,O,T,Y){super();
this.isMac=L.a.isMac;this.xxa=!1;this.$=W;this.ariaLiveNotifier=Y;this.yo=T.w6b(W,null,O,X.a.LTe,P.a.Ge(9),F.a.instance.ga(1729),"PulloutPointerDown")}Jhg(W){this.xxa!==W&&(this.hide(),(this.xxa=W)?this.yo.Cig(X.a.HBh,P.a.Ge(3)):this.yo.Cig(X.a.LTe,P.a.Ge(9)))}get Dz(){return this.yo.Dz}get buttonWidth(){return this.yo.buttonWidth}dispose(){this.yo.dispose();this.$=null;super.dispose()}domElement(W){return this.yo.domElement(W)}getButton(W){return this.yo.getButton(W,!1)}EQb(W,O){this.yo.EQb(W,O,
!1)}HBa(W,O){const T=I.h(this.$),Y=T.ib.Li(W);this.yo.EQb(this.xxa?F.a.instance.ga(1731):O?F.a.instance.ga(1729):F.a.instance.ga(1730),Y);O=this.isMac?O?F.a.instance.ga(1734):F.a.instance.ga(1735):O?F.a.instance.ga(1732):F.a.instance.ga(1733);var va=T.ag(W,Y);W=T.Af(Y).Cm;if(va&&0<=va.x&&0<=va.y){const ca=va.bottomRight.x+this.Dz;va=va.topLeft.y-this.Dz-this.buttonWidth;if(va<W.topLeft.y+this.Dz){if(T.ib.pCa){this.hide();return}va=W.topLeft.y+this.Dz}this.Rp(ca,va,T.rtl,Y);this.ariaLiveNotifier.WQa(O)}else this.hide()}Rp(W,
O,T,Y){this.yo.Rp(W,O,T,Y,!1)}hide(){this.yo.hide()}}Object(u.a)(G,"PulloutLaunchButton",t.a,[]);var C=a(33),H=a(22);class J extends t.a{constructor(W,O,T,Y,va){super();this.HYa=this.dQc=this.hxc=this.vGa=this.gS=this.gP=null;this.sie=0;this.LDb=this.pAb=this.RGc=!1;this.Ag=()=>{this.oxa&&(this.gridView?1===this.gridView.ha.Ne?(this.gridView.ha.ra.activeCell.equals(this.vGa)||this.JN||this.qy(),this.Dpb.tq()):this.qy():m.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.rh=
()=>{this.qy()};this.ed=()=>{this.mX()};this.Bc=()=>{this.qy()};this.hd=()=>{this.showCallout()};this.vza=()=>{if(this.Sg.$k&&this.Sg.$k.length)if(this.r0c)this.Sg.aBi||(this.RGc=this.Sg.$k[0].BlockingDataForExpand),this.Sg.AVh&&m.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.sie=this.Sg.g7c&&this.Sg.OZe<this.Sg.g7c.left-1?this.Sg.g7c.left-1-this.Sg.OZe:-1,this.showCallout();else if(this.gridView.ha.ra.Mg){var ca=this.gridView.ha.ra.activeCell;
if(ca&&this.gS){var V=this.tableManager.Dn(ca);this.TNc=!!V;const ra=this.gridView.ha.ra.$c;V=this.JN&&this.gS.Ad(V);const N=this.skd&&!this.JN&&ra.equals(this.selectedRange);V||N?(m.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.kac=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.JN&&this.tableManager.lka(ca)?m.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.JN?this.Dh.HBa(this.gS,this.JN):this.Dh.HBa(ra,this.JN):this.Dh.HBa(this.gS,this.JN),this.Rvc())):m.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.ij=()=>{this.R7a()&&this.Dh.hide();1===this.gridView.ha.Ne&&this.mX()};this.ER=()=>{const ca=this.gridView.ha.Ne;this.gridView.ha.ra.activeCell&&1===ca&&this.mX()};this.Tt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.JN){if(this.gS&&
this.vGa){var ca=this.tableManager.Dn(this.vGa);ca&&1<ca.bottom-ca.top&&(--ca.bottom,this.gridView.L5(ca)&&this.Dpb.tq())}}else this.gridView.ha.ra.Mg&&this.gridView.L5(this.gridView.ha.ra.$c)&&this.Dpb.tq();else this.gS&&this.vGa&&this.JN&&(ca=this.tableManager.Dn(this.vGa))&&1<ca.bottom-ca.top&&(--ca.bottom,this.gridView.L5(ca)&&this.Dpb.tq())};this.mX=()=>{if(this.$&&this.gridView){if(this.kac&&this.JN){const ca=this.gridView.ha.ra.activeCell;this.gS=this.TXe();const V=!!this.hxc&&this.hxc.contains(ca);
if(this.gS&&(ca.equals(this.vGa)||V)){this.Dh.HBa(this.gS,this.JN);return}}this.kac=!1;(this.gS=this.TXe())&&this.rma&&this.gridView&&this.gridView.Ea.us(this.rma)?(this.r0c=!1,this.SZ()):(this.Sg.k1c(),this.Sg.r3b());this.kac||this.Dh.hide()}};this.$=W;this.tableManager=T;this.contextMenuManager=Y;this.Dh=new G(W,this.hd,O,va);this.Sg=O.O5c(W,T);this.kac=this.r0c=!1;this.skd=h.EwaSettings.ma(135);this.TNc=!0;this.LEa=!1;this.gridView=I.h(this.$);this.gridView.Vb.Xk(this.rh);this.gridView.mv(this.ER);
this.$.nl(this.ed);this.$.dk(this.Bc);this.$.VA(this.ij);this.gridView.view.nt(this.Tt);this.gridView.ha.RT(this.Ag);this.Dpb=A.a.instance.create(this.mX,250,y.a.o$i);m.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Sg.c0b(this.vza);C.a.qAb()&&(this.pAb=!0);this.mX();W.da.Ga(261,this)}get mc(){return this.Dh.domElement(1)}get rma(){return this.dQc}get selectedRange(){return this.HYa}get JN(){return this.TNc}get xxa(){return this.LEa}get pPf(){return this.sie}get dDb(){const W=
this.Dh.domElement(this.dfa);return W?x.DOMElementExtensions.isVisible(W):!1}get oxa(){return this.$.isEditMode&&h.EwaSettings.ma(135)?!(new B.a(this.$.xa)).ki:!1}get RPg(){return this.RGc}get dfa(){return this.rma?this.gridView.ib.Li(this.gP):1}dispose(){this.gridView&&(this.gridView.ha.aS(this.Ag),this.gridView.view.ir(this.Tt),this.gridView.Vb&&this.gridView.Vb.Fk(this.rh));if(this.$){const W=this.$;W.Kl(this.ed);W.Jl(this.Bc);W.bE(this.ij);I.h(W).Oy(this.ER)}this.Sg&&this.Sg.Ruc(this.vza);l.a.Ia(this.Dh);
this.Sg=this.$=this.gridView=this.Dpb=this.Dh=null;super.dispose()}qy(){this.Dh.hide()}Xda(){this.Dh?this.Dh.getButton(this.dfa).$cb():m.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Hoj(){this.gS=null}KOf(){this.Dh&&this.Dh.hide()}$6h(){if(!this.skd||1!==this.selectedRange.width)return null;const W=this.selectedRange.clone();for(;this.gridView.L5(W);){W.left+=1;W.right+=1;if(!this.gridView.Af(this.gridView.ib.Li(W)).ui.Ke(W))break;if(!this.gridView.Ea.us(W))continue;
const O=this.gridView.fk("PulloutManager.GetValidatedRangeToFill",W,2);try{if(J.T2j(O))return W}finally{O&&O.dispose()}}return null}Rvc(){this.Sg.bdb()}showCallout(){this.oxa&&(this.Sg.w7a?(this.Dh.getButton(this.dfa).WHb(),h.EwaSettings.ol()?d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,8,9,0),W=>{this.l8f(W.result)},this.$.la,3):this.l8f(this.contextMenuManager)):(this.r0c=!0,this.SZ()))}l8f(W){W.Kfd("tableFieldList").b1(null,this.Dh.domElement(this.dfa),this.Sg,null,!0);this.Rvc()}TXe(){if(!this.oxa||
!this.gridView||this.gridView.ha.Ra.$b||!this.gridView.ha.ra.Mg)return null;var W=this.gridView.ha.ra.activeCell,O=I.h(this.$).ib.Li(W);if(!W)return null;this.vGa=W.clone();var T=this.tableManager.Dn(W);this.TNc=!!T;if(this.JN){this.Dh.EQb(F.a.instance.ga(1729),O);this.gP=J.Nkg(T);if(!this.gP)return null;W=!1;O=({PY:W}=this.tableManager.lHe(T,this.gridView)).returnValue||W;this.RGc=W;if(O)return this.hxc=new r.Range(T.top,T.left,T.bottom,T.right,!1,!1),this.dQc=new r.Range(this.gP.top,this.gP.right+
1,this.gP.top,this.gP.right+1,!1,!1),this.pAb&&(this.LEa=!1,this.Dh.Jhg(this.LEa)),this.gP}else if(this.skd){this.HYa=this.gridView.ha.ra.$c.clone();T=this.selectedRange.isSingle&&I.h(this.$).Bb.Ghf(this.selectedRange);const Y=I.h(this.$).Bb.Yxa(this.selectedRange);this.pAb&&(this.LEa=T&&!Y);this.Dh.EQb(this.LEa?F.a.instance.ga(1731):F.a.instance.ga(1730),O);T&&!Y&&!this.LDb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&H.a.equals(v.AFrameworkApplication.uiCulture,
"en-us",!0)&&(v.AFrameworkApplication.Rt("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.LDb=!0);this.gP=J.Nkg(this.selectedRange);if(!(this.pAb&&T||Y)||!this.gP||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.lka(this.selectedRange))return null;this.dQc=this.$6h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.L5(this.selectedRange):
this.gridView.L5(this.gP))&&this.rma)return this.pAb&&this.Dh.Jhg(this.LEa),this.hxc=this.gP,m.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.rma?this.rma.toString():"null"}, RightColumnHeader, ${this.gP?this.gP.toString():"null"}, ActiveCell, ${W?W.toString():"null"}`),this.gP}return null}SZ(){this.JN?this.Sg.SZ(w.v(this.rma,this.$),!1,!0):this.LEa?this.Sg.n6i():h.EwaSettings.ma(135)&&this.Sg.SZ(w.v(this.selectedRange,this.$),!0,!1)}R7a(){return this.$.ea.isNamedObjectViewMode&&
n.f(this.$.na)}static T2j(W){for(;W.$$mn();)if(W.$$cu().text||W.$$cu().cI||W.$$cu().si||W.ao.Qaf)return!1;return!0}static Nkg(W){return W.right===z.a.qh?null:new r.Range(W.top,W.right,W.top,W.right,!1,!1)}}Object(u.a)(J,"PulloutManager",t.a,[252,2]);class M extends e.a{constructor(W){super();this.$=W;this.Fb()}create(){c.a.Fa(W=>{const O=f.GetServiceTaskFactory.Oa(W.da,12,477,this.Ya),T=f.GetServiceTaskFactory.Oa(W.da,66,134,this.Ya),Y=f.GetServiceTaskFactory.Oa(W.da,211,212,this.Ya);let va=b.a.Ta(null);
const ca=!h.EwaSettings.ol();ca&&(va=f.GetServiceTaskFactory.Oa(W.da,8,9,this.Ya));d.TaskExtensions.Aa(d.TaskExtensions.Fd([O,T,va,Y],W.la),()=>{ca?this.ob(this.$.da.za(261)||new J(this.$,O.result,T.result,va.result,Y.result)):this.ob(this.$.da.za(261)||new J(this.$,O.result,T.result,null,Y.result))},W.la)})}static ka(W){W.da.Ga(262,new M(W))}}Object(u.a)(M,"PulloutManagerFactory",e.a,[]);a.d(D,"a",function(){return S});const S=()=>{c.a.Fa(W=>{W.ma(135)&&M.ka(W)})}},1237:function(u,D,a){u=a(0);var c=
a(187);class b{GPj(r,n){r.set_visible(!1);n.set_visible(!0)}}Object(u.a)(b,"DefaultTabSwitchBehaviour",null,[307]);class e{}e.pQj="TabsContainer";e.cQj="TabTitlesContainer";e.aQj="TabTitle";e.bQj="TabTitleText";e.CYd="TabTitleActive";Object(u.a)(e,"MultitabControlStyles",null,[]);var f=a(84),d=a(45),h=a(85),m=a(86),l=a(56);class v{constructor(r,n,w){this.uk=r;this.Xp=n;this.AIc=w;this.aga=document.createElement("a");l.a.lyc(this.aga,this.Xp);Sys.UI.DomElement.addCssClass(this.aga,e.bQj);Sys.UI.DomElement.addCssClass(this.uk,
e.aQj);this.uk.appendChild(this.aga);this.aga.tabIndex=0;this.ADc();d.a.addHandler(this.uk,"click",this.AIc);d.a.addHandler(this.uk,"keyup",Object(f.a)(this,this.vab,"onTitleKeyUp"))}get mc(){return this.uk}get title(){return this.Xp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.uk,e.CYd)}set isActive(r){this.setActive(r)}dispose(){d.a.removeHandler(this.uk,"keyup",Object(f.a)(this,this.vab,"onTitleKeyUp"));d.a.removeHandler(this.uk,"click",this.AIc);this.uk=this.aga=null}setActive(r){r?
Sys.UI.DomElement.addCssClass(this.uk,e.CYd):Sys.UI.DomElement.removeCssClass(this.uk,e.CYd);this.aga&&this.aga.setAttribute(m.a.Bha,r)}vab(r){r.keyCode!==h.a.Sh&&r.keyCode!==h.a.xpa||this.AIc(r)}ADc(){this.uk.setAttribute(m.a.Ld,m.a.es);this.aga.setAttribute(m.a.nv,this.Xp);this.aga.setAttribute(m.a.Ld,m.a.vpb)}}Object(u.a)(v,"TabTitleControl",null,[2]);var t=a(40);a.d(D,"a",function(){return z});class z{constructor(r,n=null,w=null){this.$mb=this.hnb=null;this.G1=-1;this.uk=r;this.Pga=n||new c.a;
this.VEg=w||new b;this.YFa=new c.a;r=0;for(let B of this.Pga)this.dud(this.G1)||(this.G1=r),n=r++,this.YFa.add(new v(document.createElement("li"),B.title,this.Zch(n)))}get CBc(){return this.Pga.count}get activeTab(){return this.G1}set activeTab(r){this.mcg(r)}get mc(){return this.uk}get visible(){return t.a.isVisible(this.uk)}set visible(r){this.uk.style.visibility=r?"visible":"hidden"}tWf(){this.hnb=document.createElement("ul");this.hnb.className=e.cQj;this.$mb=document.createElement("div");this.$mb.className=
e.pQj;for(let r=0;r<this.CBc;++r){const n=this.Pga.oa(r),w=this.YFa.oa(r);n.set_visible(!1);w.isActive=!1;const B=document.createElement("div");n.render(B);this.$mb.appendChild(B);this.hnb.appendChild(w.mc)}this.mc.appendChild(this.hnb);this.mc.appendChild(this.$mb);this.dud(this.G1)&&(this.YFa.oa(this.G1).isActive=!0,this.Pga.oa(this.G1).set_visible(!0))}dispose(){for(let r=0;r<this.CBc;++r)this.Pga.oa(r).dispose(),this.YFa.oa(r).dispose();this.YFa=this.Pga=this.uk=this.$mb=this.hnb=null}setFocus(){this.Pga.oa(this.G1).setFocus()}dud(r){return 0<=
r&&r<this.CBc}mcg(r){this.G1!==r&&this.dud(r)&&(this.VEg.GPj(this.Pga.oa(this.G1),this.Pga.oa(r)),this.YFa.oa(this.G1).isActive=!1,this.YFa.oa(r).isActive=!0,this.G1=r,this.setFocus())}Zch(r){return()=>{this.mcg(r)}}}Object(u.a)(z,"MultitabControl",null,[300,2])},1250:function(u,D,a){var c=a(9);u=a(0);var b=a(7),e=a(222),f=a(50),d=a(37);class h{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(u.a)(h,"FormulaAssistanceUIContext",null,[]);var m=a(184);class l extends e.a{constructor(t){super();
this.jtj="formulaAssistance";this.$=t;this.Fb()}create(){let t=this.$.da.za(448);if(t)this.ob(t);else{var z=f.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Ya);d.TaskExtensions.Aa(z,()=>{d.TaskExtensions.Aa(m.c(z.result.pn.loadScript(this.jtj)),()=>{t=this.$.da.za(448);if(!t){const r=Object(b.a)(new h,{isFeedbackAllowed:this.$.isFeedbackEnabled});t=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(r));this.$.tCe(()=>{const n={};n.isFeedbackAllowed=this.$.isFeedbackEnabled;
t.updateContext(n)})}this.ob(t)},this.$.la,3)},this.$.la,3)}}static ka(t){t.da.Ga(449,new l(t))}}Object(u.a)(l,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(D,"a",function(){return v});const v=()=>{c.a.Fa(t=>{l.ka(t)})}},1251:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(50),f=a(37),d=a(21),h=a(15),m=a(31),l=a(209),v=a(24),t=a(64),z=a(1088),r=a(11);class n{constructor(A,y){this.uOa=1;this.a$=[];this.PAb=this.active=!1;this.Xw=()=>{const x=this.gridView.Jjd();if(!(0>=x||x===this.uOa||this.gridView.Ur)){var F=
!1,I=[],L=[];for(var X=this.a$.length-1;0<=X;X--){var P=this.a$[X];if(this.Ijd(P)>x||P.bottom<x)I.push(P),this.a$.splice(X,1),F=!0}for(X=this.tableManager.rangeList.length-1;0<=X;X--){P=this.tableManager.rangeList[X];const G=this.Ijd(P);G<=x&&P.bottom>=x&&!(G<=this.uOa&&P.bottom>=this.uOa)&&P.zba&&(L.push(P),F=!0)}if(F){P=this.gridView.vrc;for(let G of P)for(let C of G)for(let H of C)this.PAb?this.Q3g(H,I,L):this.R3g(H,I,L,F)}else h.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.uOa=x}};this.CDf=(x,F)=>{F.isRow||F.UXc(this.nfc)};this.DDf=(x,F)=>{F.isRow||(this.tableManager.rangeList.length||this.deactivate(),F.QMd(this.nfc))};this.nfc=(x,F)=>{if(this.Td())this.activate();else if(x=this.active,this.deactivate(),!x){h.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(F=F.Lt)&&this.z$f(F.b5,F)};this.nGf=(x,F)=>{!this.gridView.Ur&&(this.Td()?this.activate():(x=this.active,this.deactivate(),
x||h.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),F=F.Lt)&&(x=z.a(F.b5),this.z$f(x,F)&&F.aSd(x))};this.se=()=>{this.gridView.ib.Y4?this.deactivate():this.activate()};this.tableManager=A;this.gridView=y;this.$=y.$;A.jse(this.nGf);y.WMg(this.CDf);y.XMg(this.DDf);this.$.xa.Uf(this.se);this.$.Cb.Uf(this.se);this.Nve(x=>{x.UXc(this.nfc)});this.PAb=this.gridView.dla;this.Td()&&(this.activate(),this.Xw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();
this.gridView&&(this.tableManager.XVf(this.nGf),this.gridView.Mjj(this.CDf),this.gridView.Njj(this.DDf),this.$.xa.Bg(this.se),this.$.Cb.Bg(this.se),this.Nve(A=>{A.QMd(this.nfc)}));this.gridView=this.tableManager=this.a$=null}sCc(A,y,x){if(!t.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.pCa)return!0;const F=x.D8e();var I=F.length;if(F[I-1]<A.left)return!1;var L=r.HelperMethods.lw(new l.a(F),0,I,A.left,r.HelperMethods.LB);if(0>L)return!1;const X=A.CZd;I=Math.min(X.length+L,I);let P=
0;for(;L<I;L++){const G=F[L];y?(x.updateCellText(L,X[P]),this.Wpe(A,P,G)):(x.updateCellText(L,v.Range.QM(G)),this.rOe(G));x.hn("HeaderSnappingFeature::toggleHeaderSnapping",L);P++}A.OBa=y;return!0}tCc(A,y,x,F){if(!t.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.pCa)return!0;if(!x.length)return!1;var I=F.length;if(F[I-1]<A.left)return!1;var L=r.HelperMethods.lw(new l.a(F),0,I,A.left,r.HelperMethods.LB);if(0>L)return!1;const X=A.CZd,P=!!A.u0a&&0<A.u0a.length,G=!!A.menuModel&&0<A.menuModel.length;
for(let H=L,J=0,M=Math.min(X.length+L,I);H<M;H++,J++)if(I=x[H]){L=null;var C=I.getElementsByClassName(m.a.pbd);C&&(L=C[0]);if(L&&L.innerText){if(C=I.getElementsByClassName(m.a.rte))for(let S=C.length-1;0<=S;S--)I.removeChild(C[S]);C=F[H];y?(L.innerText=X[J],I.classList.add(m.a.fVe),P&&A.u0a[J]&&(L=document.createElement("div"),L.innerHTML=A.u0a[J],G&&A.menuModel[J]&&this.Wpe(A,J,C),I.appendChild(L.firstChild))):(I.classList.remove(m.a.fVe),L.textContent=v.Range.QM(C),this.rOe(C))}}A.OBa=y;return!0}Wpe(A,
y,x){this.$.da.$a(8,F=>{F.tac.FUi(A,y,x)})}rOe(A){this.$.da.$a(8,y=>{y.tac.GUi(A)})}R3g(A,y,x,F){const I=A.Kt,L=z.a(A.b5);let X;for(let P=y.length-1;0<=P;P--)X=y[P],this.tCc(X,!1,L,I)&&y.splice(P,1);for(y=x.length-1;0<=y;y--)X=x[y],this.tCc(X,!0,L,I)&&this.a$.push(X);F&&A.aSd(L)}Q3g(A,y,x){if(A.U0g()){for(var F=y.length-1;0<=F;F--)this.sCc(y[F],!1,A)&&y.splice(F,1);for(y=x.length-1;0<=y;y--)F=x[y],this.sCc(F,!0,A)&&this.a$.push(F)}}z$f(A,y){const x=this.PAb?y.D8e():y.Kt;var F=x[0];const I=x[x.length-
1],L=this.y6h(F,I);let X=!1;for(let P=this.a$.length-1;0<=P;P--){const G=this.a$[P];I>=G.left&&F<=G.right&&(this.PAb?this.sCc(G,!1,y):this.tCc(G,!1,A,x),this.a$.splice(P,1),X=!0)}for(let P=0,G=L.length;P<G;P++)if(F=L[P],this.PAb?this.sCc(F,!0,y):this.tCc(F,!0,A,x))this.a$.push(L[P]),X=!0;return X}activate(){this.Td()&&!this.active&&(this.gridView.view.nt(this.Xw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.ir(this.Xw),this.active=!1)}Td(){return t.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.ib.kP&&0<this.tableManager.rangeList.length}Nve(A){const y=this.gridView.vrc;for(let x of y)for(let F of x)for(let I of F)A(I)}y6h(A,y){const x=[];if(!this.active)return x;this.uOa=this.gridView.Jjd();for(let F=this.tableManager.rangeList.length-1;0<=F;F--){const I=this.tableManager.rangeList[F];I.bottom>=this.uOa&&this.Ijd(I)<=this.uOa&&I.left>=A&&I.right<=y&&I.zba&&x.push(I)}return x}Ijd(A){const y=this.gridView.Bb.Bj(A);return y&&this.tableManager.Tif(A,y.usedRange.topLeft)?A.top+
1:A.top}}Object(u.a)(n,"HeaderSnappingFeature",null,[2]);class w extends b.a{constructor(A){super();this.$=A;this.Fb()}create(){const A=e.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Ya);f.TaskExtensions.Aa(f.TaskExtensions.Fd([A],this.la),()=>{this.ob(this.$.da.za(68)||new n(A.result,d.h(this.$)))},this.la,11)}static ka(A){A.da.Ga(67,new w(A))}}Object(u.a)(w,"HeaderSnappingFactory",b.a,[]);a.d(D,"a",function(){return B});const B=()=>{c.a.Fa(w.ka)}},1276:function(u,D,a){var c=a(9);u=a(0);
var b=a(15),e=a(872),f=a(27),d=a(196),h=a(222),m=a(227),l=a(1),v=a(51),t=a(55),z=a(184),r=a(33);class n{constructor(){this._list={}}addHandler(x,F){var I;this._list[x]=[...(null!==(I=this._list[x])&&void 0!==I?I:[]),F]}removeHandler(x,F){const I=this._list[x];void 0!==I&&(F=I.indexOf(F),0<=F&&(this._list[x]=[...I.slice(0,F),...I.slice(F+1)]))}getHandler(x){const F=this._list[x];return F&&0!==F.length?(I,L)=>{for(const X of F)X(I,L)}:null}static yKb(){Sys.EventHandlerList.prototype.addHandler=n.prototype.addHandler;
Sys.EventHandlerList.prototype.getHandler=n.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=n.prototype.removeHandler}}Object(u.a)(n,"EventHandlerListOptimized",null,[]);class w{constructor(){this._list={}}addHandler(x,F){this.invalidate(x);void 0===this._list[x]?this._list[x]=[F]:this._list[x].push(F)}invalidate(x){void 0!==this.FA&&this.FA.delete(x)}removeHandler(x,F){const I=this._list[x];void 0!==I&&0!==I.length&&(F=I.indexOf(F),0<=F&&(this.invalidate(x),I.splice(F,1)))}getHandler(x){void 0===
this.FA&&(this.FA=new Map);var F=this.FA.get(x);return void 0===F?(F=this.makeHandler(x),this.FA.set(x,F),F):F}makeHandler(x){x=this._list[x];if(!x||0===x.length)return null;const F=[...x];return(I,L)=>{for(let X=0;X<F.length;++X)F[X](I,L)}}static yKb(){Sys.EventHandlerList.prototype.addHandler=w.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=w.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=w.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=w.prototype.makeHandler;
Sys.EventHandlerList.prototype.invalidate=w.prototype.invalidate}}Object(u.a)(w,"EventHandlerListMemoized",null,[]);class B{constructor(x){this.a=x;this.preventDefault=B.CKf.preventDefault;this.stopPropagation=B.CKf.stopPropagation;const F=this.type=x.type.toLowerCase();this.rawEvent=x;this.altKey=x.altKey;"undefined"!==typeof x.button&&(this.button="undefined"!==typeof x.which?x.button:4===x.button?Sys.UI.MouseButton.middleButton:2===x.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);
"keypress"===F?this.charCode=x.charCode||x.keyCode:this.keyCode=x.keyCode&&46===x.keyCode?127:x.keyCode;this.clientX=x.clientX;this.clientY=x.clientY;this.ctrlKey=x.ctrlKey;this.target=x.target?x.target:x.srcElement;this.screenX=x.screenX;this.screenY=x.screenY;this.shiftKey=x.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const x=Sys.UI.DomElement.getLocation(this.target);
return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-x.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const x=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-x.y}}}static yKb(){Sys.UI.DomEvent=B;B.registerClass("Sys.UI.DomEvent",void 0,void 0)}}B.addHandler=Sys.UI.DomEvent.addHandler;
B.addHandlers=Sys.UI.DomEvent.addHandlers;B.removeHandler=Sys.UI.DomEvent.removeHandler;B.clearHandlers=Sys.UI.DomEvent.clearHandlers;B._removeHandler=Sys.UI.DomEvent._removeHandler;B._clearHandlers=Sys.UI.DomEvent._clearHandlers;B._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;B.CKf=Sys.UI.DomEvent.prototype;B.registerClass=function(x,F,I){this.prototype.constructor=this;this.__typeName=x;this.__class=!0;F&&(this.__baseType=F,this.__basePrototypePending=!0);Sys.__upperCaseTypes[x.toUpperCase()]=
this;if(I){this.__interfaces=[];for(let L=2,X=arguments.length;L<X;L++)this.__interfaces.push(arguments[L])}return this};Object(u.a)(B,"DomEventLazy",null,[485]);class A extends h.a{constructor(x){super();this.$=x;this.y6b=null;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.Gfh(),x=>{this.ob(x)})}Gfh(){if(this.y6b)return this.y6b;const x=m.a.Y1a(v.b(),d.a.none,"LoadResource","x10Scheduler loading");if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",
!1)){var F=String.prototype;if(void 0===F.startsWithOriginal||void 0===F.endsWithOriginal)if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const I=document.createElement("frame");document.body.appendChild(I);const L=I.contentWindow.String.prototype;document.body.removeChild(I);F.startsWithOriginal=L.startsWith;F.endsWithOriginal=L.endsWith}else F.startsWithOriginal=function(I,L=0){return this.lastIndexOf(I,L)===L},F.endsWithOriginal=function(I){return-1!==
this.indexOf(I,this.length-I.length)};F.startsWith=F.startsWithOriginal;F.endsWith=F.endsWithOriginal}l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&n.yKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&w.yKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&B.yKb();if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.vy)return F=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),
this.$.da.Ga(413,F),x.setResult(F),this.y6b=x.task;this.$.da.$a(266,()=>{this.$.da.$a(283,I=>{const L=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();I=z.b(t.Task.Ta(I.pn));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(I,0),r.a.Mpb(this.$)?excelOnlineCalc.x10.ensureGroupAttached(I,2):0]).then(X=>X.some(P=>0<P)).then(X=>{this.$.da.Ga(413,L);x.setResult(L);l.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&this.$.da.$a(491,P=>{P.hX.anyPluginInitialized=X})})})});
return this.y6b=x.task}static ka(x){x.da.Ga(414,new A(x))}}Object(u.a)(A,"PluginSchedulerFactory",h.a,[]);a.d(D,"a",function(){return y});const y=()=>{c.a.Fa(x=>{A.ka(x)})}},1277:function(u,D,a){var c=a(9);u=a(0);var b=a(222),e=a(695),f=a(50),d=a(37);class h extends b.a{constructor(l){super();this.$=l;this.Fb()}static ka(l){l.da.Ga(521,new h(l))}create(){const l=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();d.TaskExtensions.Aa(f.GetServiceTaskFactory.Oa(this.$.da,266,265,0),
()=>{this.ob(Object(e.a)(this.$.da,520,l))},this.$.la,3)}}Object(u.a)(h,"FormulaAuthoringHelperFactory",b.a,[]);a.d(D,"a",function(){return m});const m=()=>{c.a.Fa(l=>{h.ka(l)})}},1440:function(u,D,a){a.r(D);var c=a(1078),b=a(0),e=a(692),f=a(15),d=a(178),h=a(60);const m=(zb,Ub,wc,mb,Db,Ic)=>{if(Ub){const Hc=zb.textBox;zb.eb||zb.startEdit(Ub,!0);zb.psd=!0;zb.text=wc;Hc.caretPosition=Db;Db<Ic&&(mb&&zb.QBa(),Hc.selectRange(0,Ic+1),Hc.selectRange(Db,Ic))}};var l=a(76);class v{constructor(zb,Ub){this.sharedSheetRange=
null;this.type=0;this.sharedSheetRange=zb;this.type=Ub}z5a(){return this.sharedSheetRange}}Object(b.a)(v,"MacroRecorderAutoSumPayload",null,[125]);var t=a(42),z=a(371),r=a(188),n=a(50),w=a(37),B=a(154),A=a(345),y=a(29),x=a(1),F=a(183),I=a(281),L=a(21),X=a(124),P=a(563),G=a(55);class C extends d.a{constructor(zb){super();this.bOi=Ub=>{const wc=L.h(this.$);if(Ub=Ub.Result){let mb=t.D(Ub.NewSelection),Db=t.D(Ub.NewActiveCell);if(mb&&Db)if(!Ub.Committed&&Ub.AutoSumFormula){const Ic=wc.Sb(Db);Ic&&(wc.ha.updateSelection(mb,
Db,60),mb=Db=t.D(Ub.MarkedArea),wc.iK=2,m(wc.fc,Ic,Ub.AutoSumFormula,!!mb,Ub.FormulaMarkStart,Ub.FormulaMarkEnd),mb&&Db&&wc.ha.updateSelection(mb,Db,0),wc.fc.psd=!1,w.TaskExtensions.Aa(n.GetServiceTaskFactory.create(this.$.da,153,this.la,0),Hc=>{Hc.result.VJa(null)},this.la,3))}else wc.ha.updateSelection(mb,Db,60)}};this.$=zb}nc(){return!1}executeCommand(zb,Ub,wc){zb=Ub.command;switch(zb){case 1220954656:case 505713221:Ub=this.zNe(0,Ub);break;case -1537138325:Ub=this.zNe(parseInt(wc[l.a.Ic].toString(),
10),Ub);break;default:Ub=F.a(zb)}return Ub}wc(zb,Ub){if(zb=1===zb)switch(Ub.command){case 1220954656:case 505713221:case -1537138325:break;default:zb=!1}return zb}Jc(){return!1}zNe(zb,Ub){const wc=L.h(this.$);wc.Gf.tH(!1);if(!L.h(this.$).ha.ra.Mg)return Ub=L.h(this.$).ha.ra.zI,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${zb} due to discontinuous selection. Number of selected ranges is ${Ub}`),this.bAa(),G.Task.Ta(!1);const mb=wc.EF();if(!mb)return null;
const Db=t.v(wc.ha.ra.$c,this.$),Ic=t.o(wc.ha.ra.activeCell,this.$),Hc=t.o(mb,this.$),Ab=this.$.pa.ya.Wb(),db=()=>new v(Db,zb);return this.$.Zp(wc.ha.ra.selectedRanges,!0)?z.a(this.$.userOperationManager,(Pb,td,Vb)=>{var Ac=this.$.pa.ya;Pb=I.b(Pb,this.bOi);const Kc=Ac.Na(9,Ab);Kc.selectedRange=Db;Kc.activeCell=Ic;Kc.autoSumType=zb;Kc.topLeftCell=Hc;return h.g(Ac,"AutoSum",Kc,Pb,td,Vb,zb,0)},Pb=>new r.a(502,0,Pb,64,db),Ub):G.Task.Ta(!1)}bAa(){P.a(X.a.discontinuousSelectionBlocking,["OtherICE"],!0,
!0,!1,!1,null);var zb=y.a.Zc(1,1,751,2182,0,371863010,"DiscontinuousSelectionBlocking");x.EwaSettings.Mz()?new A.a(this.$,zb):(zb=new B.ErrorDialog(this.$,zb),zb.initialize(),zb.ug())}}Object(b.a)(C,"AutoSumCommandHandler",d.a,[165]);class H extends e.a{constructor(zb){super(zb)}nd(){this.Yc([new C(this.$)])}static ka(zb){e.a.Nd(96,new H(zb))}}Object(b.a)(H,"AutoSumCommandHandlerFactory",e.a,[]);var J=a(9),M=a(170),S=a(263),W=a(38),O=a(322),T=a(1079),Y=a(282),va=a(67);class ca extends W.a{constructor(zb,
Ub,wc){super();this.kPi=(mb,Db)=>{if(!Y.a(mb)&&Db){const Ic=!!mb&&!!mb.RequestTelemetryData;L.h(this.$).ji.gma(Db.toString(),mb.StateId,Ic?mb.RequestTelemetryData.EcsOperationDuration:0,Ic?mb.RequestTelemetryData.EcsRequestDuration:0,Ic?mb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=zb;this.tableManager=Ub;this.zg=wc}ZLg(zb){this.addHandler("ekcvc",zb)}Wij(zb){this.removeHandler("ekcvc",zb)}nc(){return!1}executeCommand(zb,Ub){zb=Ub.command;switch(zb){case -730106152:Ub=this.Ckd(Ub,3);break;
case -1228228458:Ub=this.Ckd(Ub,4);break;case -848953656:case 2045211913:if(this.zsi()){Ub=G.Task.Ta(!0);break}Ub=this.Ckd(Ub,1);break;default:Ub=F.a(zb)}return Ub}wc(zb,Ub){if(zb=1===zb)switch(Ub.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:zb=!1}return zb}Jc(){return!1}Ckd(zb,Ub){const wc=L.h(this.$),mb=wc.ha.ra.selectedRanges,Db=zb.command,Ic=M.a.create().toString();if(!this.$.Zp(mb,!0)&&-730106152!==Db)return G.Task.Ta(!0);const Hc=t.r(mb,this.$);this.QIj(Db,
wc,mb,Ic);x.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.xaj();const Ab=this.$.pa.ya.Wb({Dca:!0,Nba:1}),db=()=>new T.a(Ub,Hc);return z.a(this.$.userOperationManager,(Pb,td,Vb)=>{this.$.Qy();return h.d(this.$.pa.ya,Ub,Hc,!1,I.b(Pb,this.kPi),td,Vb,Ic,Ab)},Pb=>new r.a(508,0,Pb,67,db),zb)}QIj(zb,Ub,wc,mb){if(-848953656!==zb&&2045211913!==zb&&-730106152!==zb&&-1228228458!==zb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${zb}.`);
else if(!S.a.any(wc,Ic=>0<Ub.getRangeInformation(Ic).length)){var Db=S.a.any(wc,Ic=>this.tableManager.Ctd(Ic));if(-730106152!==zb&&-1228228458!==zb||!Db)this.MMj(Ub,zb,mb,wc),-730106152!==zb&&-1228228458!==zb||this.zg.vea(Ub,-730106152,{}),-1228228458!==zb&&2045211913!==zb&&-848953656!==zb||this.zg.h5g(wc,mb),Ub.ji.yS(mb,va.BasicTelemetryCalculator.cR)}}MMj(zb,Ub,wc,mb){let Db="";switch(Ub){case -1228228458:Db="ClearAll";break;case 2045211913:case -848953656:Db="ClearContent";break;case -730106152:Db=
"ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Ub}.`)}Ub=mb.length;mb=t.b(mb);zb.ji.g8(15,wc,Db+(", ranges to clear: "+Ub+", cells to clear: "+mb))}xaj(){this.raiseEvent("ekcvc",new O.a)}zsi(){if(L.h(this.$).Hz){const zb=this.$.da.za(296);return!!zb&&zb.MU.CB}return!1}}Object(b.a)(ca,"ClearCommandHandler",W.a,[165,832]);class V extends e.a{constructor(zb){super(zb)}nd(){const zb=n.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.Ya),Ub=n.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Ya);w.TaskExtensions.Aa(w.TaskExtensions.Fd([zb,Ub],this.la),()=>{const wc=new ca(this.$,zb.result,Ub.result);this.Yc([wc]);this.$.da.Ga(313,wc)},this.la,3)}static ka(zb){e.a.Nd(101,new V(zb))}}Object(b.a)(V,"ClearCommandHandlerFactory",e.a,[]);var ra=a(1226),N=a(1080),ea=a(1138),Ba=a(1082),ka=a(1083),Ka=a(1151),Oa=a(87),wa=a(222),qa=a(4),aa=a(105),ia=a(45),Ha=a(11),Z=a(84),la=a(146);class Xa{}Xa.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(Xa,"FileUploadDialogHTML",null,[]);var Za=a(152),xa=a(25);class fa extends la.a{constructor(zb){super(!1,!1,fa.Wu);this.Zxd=!1;this.Utf=!0;this.ctf=0;this.Rb=1;this.oc(1,CommonUIStrings.l_Send);this.oc(0,CommonUIStrings.l_NoThanks);this.ng=Xa.HTML;this.Wsf=zb;this.Ee=fa.z_g}vj(zb,Ub,wc,mb=!1,Db=!0){this.Zxd=mb;this.$Hj(Ub);this.ctf=zb;Db&&qa.AFrameworkApplication.oG(zb)}$Hj(zb){if(fa.Wu)this.HJj(zb);else{var Ub={};Ub[fa.v_g]=zb;Ub[fa.B_g]=CommonUIStrings.l_SendFileErrorReportMessage;Ub[fa.C_g]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Ub[fa.D0c]="";Ub[fa.y_g]=CommonUIStrings.l_UserReportLinkText;Ub[fa.X2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Z.a)(this,this.Ezi,"legacyDialogHandler"),Ub);this.iX(fa.H_g)}}HJj(zb){zb={["id"]:this.Ee,["bodyControls"]:{["reportErrorCheckboxProps"]:this.Zxd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.Utf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:qa.AFrameworkApplication.nna,["target"]:"_blank"}}},["errorMessage"]:zb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Z.a)(this,this.JJd,"reactDialogHandler"),zb)}$$a(){if(!fa.Wu){var zb=document.getElementById(fa.E_g);zb&&(zb.className=fa.D_g,zb.appendChild(Za.createClusteredImage(32,32,fa.A_g,null,!0,CommonUIStrings.l_DialogError)));
if(zb=document.getElementById(fa.F_g))zb.innerText=CommonUIStrings.l_PrivacyStatement,zb.href=qa.AFrameworkApplication.nna,ia.a.addHandler(zb,"click",Object(Z.a)(this,this.TXi,"onPrivacyClickHandler"));this.Utf||(zb=document.getElementById(fa.D0c))&&zb.parentNode&&zb.parentNode.removeChild(zb);this.Zxd||(zb=document.getElementById(fa.x_g))&&zb.parentNode&&zb.parentNode.removeChild(zb)}}YI(){fa.Wu||(super.YI(),document.getElementById(this.mi("WACDialogPanel")).style.width=String.format("{0}px",400))}Ezi(zb,
Ub){const wc=Ub[fa.D0c]||"";let mb=!0;void 0!==Ub[fa.X2b]&&null!==Ub[fa.X2b]&&(mb=Ub[fa.X2b]);this.yw(zb,wc,mb)}JJd(zb,Ub){this.yw(zb,Ub.text||"",Ub.reportErrorChecked)}yw(zb,Ub,wc){this.Wsf&&(wc&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.ctf),this.Wsf(zb,Ub,wc))}TXi(zb){qa.AFrameworkApplication.ub.ae(xa.a.zIb,2,zb)}get TY(){return!1}static get Wu(){return qa.AFrameworkApplication.sa.Pa.Jv&&qa.AFrameworkApplication.sa.Pa.bti}}fa.v_g="WACDialogErrorMessage";fa.B_g=
"WACDialogErrorReportMessage";fa.C_g="WACDialogErrorTextPrompt";fa.D0c="WACDialogInput";fa.F_g="WACDialogPrivacyText";fa.E_g="WACDialogIconPanel";fa.A_g="CancelRequest_32x32x32";fa.D_g="WACDialogIcon";fa.H_g="WACDialogTextPanel";fa.X2b="WACDialogSendFileCheckbox";fa.x_g="WACDialogSendFileCheckboxContainer";fa.y_g="WACDialogSendFileCheckboxText";fa.z_g="FileUploadErrorDialog";Object(b.a)(fa,"FileUploadErrorDialog",la.a,[]);class ua extends W.a{constructor(zb){super();this.dOf=0;this.DH=null;this.Ohj=
Ub=>{this.ejj(Ub)};this.B6g=(Ub,wc)=>{if(1===Ub&&this.DH.FileCollectionErrorStateId){Ub=this.$.pa.ya;var mb=this.DH.MessageId,Db=this.DH.OriginalEcsServerId,Ic=this.DH.FileCollectionErrorStateId;const Hc=Ub.Na(0);Hc.errorMessageId=mb;Hc.ecsServerId=Db;Hc.fileCollectionErrorStateId=Ic;Hc.userComment=wc;Ub.T0c("CollectFile",Hc,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=zb}iMg(zb){this.addHandler("fileCollectionComplete",zb)}ejj(zb){this.removeHandler("fileCollectionComplete",
zb)}A6g(zb,Ub,wc){this.dOf=Ub;this.DH=zb;this.iMg(wc);qa.AFrameworkApplication.nna=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;zb=new fa(this.B6g);qa.AFrameworkApplication.ub.Mb(xa.a.zIb,aa.a.frame,ua.f9i);zb.vj(0,"",null,!1,!1)}static f9i(zb,Ub,wc,mb,Db){ia.a.qu(Db);qa.AFrameworkApplication.nna&&Ha.HelperMethods.lf(qa.AFrameworkApplication.nna,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(ua,"FileCollectionOperation",W.a,[840,2]);class sa extends wa.a{constructor(zb){super();
this.pUb=null;this.$=zb;this.Fb()}get rGh(){return this.pUb||(this.pUb=new ua(this.$))}create(){w.TaskExtensions.Aa(n.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Ya),()=>{this.ob(this.rGh)},this.la,3)}dispose(){Oa.a.Ia(this.pUb);this.pUb=null;super.dispose()}static ka(zb){zb.da.Ga(125,new sa(zb))}}Object(b.a)(sa,"FileCollectionCommandHandlerFactory",wa.a,[]);var sb=a(1154),hb=a(1086),bb=a(1250),lb=a(7),Fa=a(643);class Na{}Object(b.a)(Na,"FreezePanesCommandParameters",null,[]);var Mb=a(8),
dc=a(182),Cb=a(24),Tb=a(386),Jb=a(28),eb=a(268),za=a(270),ha=a(117);const fb=(zb,Ub,wc,mb,Db,Ic,Hc=null)=>{Hc=zb.Na(9,Hc);Hc.freezeSettings=Ub;return h.g(zb,"FreezeOrUnfreezePanes",Hc,wc,mb,Db,Ic,0)};class rb{constructor(zb){this.freezeOptions=null;this.freezeOptions=zb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(rb,"MacroRecorderSheetPaneFrozenPayload",null,[125]);var pa=a(44);class Ma{constructor(zb,Ub){this.sbc=this.MId=null;this.KCf=()=>{x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Tvc();if(this.sbc){const wc=eb.a(Jb.a.Qa.ue,this.sbc);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${wc}`);this.sbc=null}this.sKf()};this.$=zb;this.gridView=L.h(zb);this.FD=Ub.Rsb(this.$.domElement,500,null,null);this.VLa=this.ULa=-1}nc(zb,Ub){let wc=!1;switch(Ub){case 1844679312:wc=1!==zb&&!this.gridView.ib.Y4}return wc}executeCommand(zb,Ub){zb=this.gridView.ib;const wc=this.gridView.Zjd();
qa.AFrameworkApplication.sa.Pa.Mw&&this.$.D_&&(1844679312===Ub.command||340334732===Ub.command||-806625837===Ub.command)&&Fa.ShyRibbon.QJ(1,2);switch(Ub.command){case 1844679312:return this.setFreezePanes(Ub,wc,zb.tj);case 340334732:return zb.Mac?G.Task.Ta(!1):this.Uyj(Ub,wc);case -806625837:return zb.pCa?G.Task.Ta(!1):this.Vyj(Ub,wc)}return G.Task.Ta(!1)}wc(zb,Ub){zb=!1;switch(Ub.command){case 1844679312:case 340334732:case -806625837:case 1745254833:zb=!0}return zb}Jc(){return!1}setFreezePanes(zb,
Ub,wc){if(wc)return this.yxc(zb,!1,0,0,0,0,Ub,null);var mb=this.gridView.ha.ra;wc=mb.activeCell.clone();mb=mb.activeRange;mb.hf&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${wc.top}) and firstUnfreezeCell.Bottom (${wc.bottom}) to equal topLeftRange.Top (${Ub.top})`),wc.top=wc.bottom=Ub.top);mb.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${wc.left}) and firstUnfreezeCell.Right (${wc.right}) to equal topLeftRange.Left (${Ub.left})`),
wc.left=wc.right=Ub.left);wc.top===Ub.top&&wc.left===Ub.left&&(wc=Cb.Range.Qc(wc.top+1,wc.left));mb=wc.top-1;const Db=wc.left-1,Ic=mb-(Ub.top-1),Hc=Db-(Ub.left-1);return this.g3j(wc,Ic,Hc)?this.yxc(zb,!0,mb,Db,Ic,Hc,Ub,wc):(this.$.af(),this.sKf(),G.Task.Ta(!0))}Uyj(zb,Ub){return this.yxc(zb,!0,0,Ub.left,0,1,Ub,null)}Vyj(zb,Ub){return this.yxc(zb,!0,Ub.top,0,1,0,Ub,null)}g3j(zb,Ub,wc){const mb=this.gridView.ag(zb),Db=this.gridView.view.visibleArea;return!mb||Db.topLeft.y>mb.bottomRight.y||Db.topLeft.x>
mb.bottomRight.x||Db.bottomRight.y<mb.bottomRight.y||Db.bottomRight.x<mb.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${zb}, rangeViewportArea=${mb?mb.toString():"null"}, visibleArea=${Db.toString()}`),zb=y.a.Zc(1,0,26,1484,0,2105967339,"FreezePaneSelectionNotInViewErr"),x.EwaSettings.Mz()?new A.a(this.$,zb):(zb=new B.ErrorDialog(this.$,zb),zb.initialize(),zb.ug()),!1):0>=
Ub&&0>=wc?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),zb=L.h(this.$).rtl?1486:1485,Ub=L.h(this.$).rtl?-2131054257:-1953454131,zb=y.a.Zc(1,0,26,zb,0,Ub,"FreezePaneA1SelectedErr"),x.EwaSettings.Mz()?new A.a(this.$,zb):(zb=new B.ErrorDialog(this.$,zb),zb.initialize(),zb.ug()),!1):!0}yxc(zb,Ub,wc,mb,Db,Ic,Hc,Ab){this.MId=pa.a(this.$).h$(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.PT(this.KCf);this.FD.WTa();
this.gridView.pNj(Ub?"":"UnsetFreezePane");this.nBj(zb,Ub,this.gridView.ib);const db=Object(lb.a)(new Na,{SheetName:this.$.na.name,Freeze:Ub,FrozenRows:Db,FrozenColumns:Ic,FirstRow:wc,FirstColumn:mb});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Ub}, FrozenRows=${Db}, FrozenColumns=${Ic}, FirstRow=${wc}, FirstColumn=${mb} `);const Pb=()=>new rb(db);this.sbc=Jb.a.Qa.ue;return z.a(this.$.userOperationManager,(td,Vb,Ac)=>{if(x.EwaSettings.ma(60)){var Kc=
window.performance;Kc.clearMarks();Kc.mark("FreezePanes request sent")}(Kc=this.gridView.jt)?(Kc=this.Xth(db,Kc,Hc,Ab),this.xUj(Kc)):this.$.Qy();return fb(this.$.pa.ya,db,td,Vb,Ac,Ub)},td=>new r.a(151,0,td,void 0,Pb),zb)}Xth(zb,Ub,wc,mb){f.ULS.shipAssertTag(537159580,1,!!Ub,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!zb.Freeze)return null;const Db=za.a();Db.State=1;Db.IsEstimated=!0;let Ic=!1,Hc=!1;const Ab=Ub.hV(Cb.Range.Qc(wc.top,wc.left));
let db=zb.FrozenRows;var Pb=zb.FrozenColumns;1!==zb.FrozenRows||zb.FrozenColumns?zb.FrozenRows||1!==zb.FrozenColumns?(Pb=Ub.hV(Cb.Range.Qc(zb.FirstRow+1,zb.FirstColumn+1)),Ub=Ub.hV(Cb.Range.Qc(wc.top,wc.left)),Db.Width=Pb.yj-Ab.yj,Db.Height=Pb.Mj-Ab.Mj,0<zb.FrozenRows&&(Db.AbsoluteTop=Pb.Mj,Hc=!0),0<zb.FrozenColumns&&(Db.AbsoluteLeft=Pb.yj,Ic=!0),db=Pb.zL-Ub.zL,Pb=Pb.UJ-Ub.UJ):(Db.Width=Ub.xid(dc.a.Qc(wc.top,wc.left)),mb=Cb.Range.Qc(wc.top,wc.left+1),Db.AbsoluteLeft=Ab.yj+Db.Width,Ic=!0):(Db.Height=
Ub.wid(dc.a.Qc(wc.top,wc.left)),mb=Cb.Range.Qc(wc.top+1,wc.left),Db.AbsoluteTop=Ab.Mj+Db.Height,Hc=!0);Hc&&(Db.FirstFrozenRow=wc.top,Db.FirstScrollableRow=mb.top);Ic&&(Db.FirstFrozenColumn=wc.left,Db.FirstScrollableColumn=mb.left);Db.VisibleRows=db;Db.VisibleColumns=Pb;return Db}xUj(zb){G.Task.delay(this.$.va.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.BX(Mb.a.pe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Tb.b(this.$.na,zb,-1,void 0,!0))})}nBj(zb,
Ub,wc){if(!x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(zb.command){case 1844679312:if(Ub||-1===this.ULa&&-1===this.VLa)this.ULa=wc.Hx-wc.width+this.gridView.scrollLeft,this.VLa=wc.Ix-wc.height+this.gridView.scrollTop;break;case 340334732:if(Ub||-1===this.ULa)this.ULa=wc.Hx-wc.width+this.gridView.scrollLeft;break;case -806625837:if(Ub||-1===this.VLa)this.VLa=wc.Ix-wc.height+this.gridView.scrollTop}}Tvc(){const zb=this.gridView.ib;0<zb.width?
this.gridView.scrollLeft=ha.a.G2b(this.gridView.domElement,L.h(this.$).rtl,0):-1!==this.ULa&&(this.gridView.scrollLeft=this.ULa,this.ULa=-1);0<zb.height?this.gridView.scrollTop=0:-1!==this.VLa&&(this.gridView.scrollTop=this.VLa,this.VLa=-1)}sKf(){this.FD.bUa();Oa.a.Ia(this.MId);this.MId=null;this.gridView.vO(this.KCf)}}Object(b.a)(Ma,"FreezePanesCommandHandler",null,[165]);class Ja extends e.a{constructor(zb){super(zb)}nd(){w.TaskExtensions.Aa(n.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Ya),
zb=>{this.Yc([new Ma(this.$,zb.result)])},this.$.la)}static ka(zb){zb.da.Ga(116,new Ja(zb))}}Object(b.a)(Ja,"FreezePanesCommandHandlerFactory",e.a,[]);var Ga=a(1167),La=a(27),nb=a(561),Lb=a(558),ac=a(30),ib=a(994),Ra=a(1087);a(313);var ya=a(13),Va=a(33);class oa{constructor(zb,Ub){this.$=zb;this.fontServiceManager=Ub;this.menuId=this.s0c=this.UO=this.Ava=null;this.Fdd=0;this.EIi="+mn-lt";this.HFi="+mj-lt";this.rSi=()=>{this.v3f()};this.QXi=wc=>{this.Rkf=!0;this.$.ny(mb=>{mb.AQa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${wc}`)};this.Bmi=!!String.fromCodePoint&&!La.a.Hv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Rkf=!1;this.Wl=x.EwaSettings.Wl();this.gridView=L.h(this.$);(this.Gl=Va.a.Gl())&&this.fontServiceManager&&(this.fontServiceManager.pic?this.v3f():this.fontServiceManager.ase(this.rSi))}get themesManager(){this.Dx||(this.Dx=this.$.da.za(422));return this.Dx}v3f(){this.UO=this.fontServiceManager.tBc;this.Ava=
this.fontServiceManager.hKh;this.Fdd=2}get tBc(){return this.UO}r_e(zb,Ub,wc,mb=null){const Db=Object.assign(new nb.a,{Id:"FontDropdownMenu"});Db.MenuSectionList=[];if(this.Wl&&this.themesManager){this.themesManager.scd(mb);if(null==this.themesManager.CG||this.themesManager.Itd)return Db;mb=Object.assign(new Lb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:ya.a.instance.ga(1330),ControlList:this.E5h(zb,Ub,wc)});Db.MenuSectionList.push(mb)}mb=Object.assign(new Lb.a,{ControlsId:"FontsMenuSectionControl"});
if(this.Wl||this.Gl)mb.Title=ya.a.instance.ga(1331);mb.ControlList=this.nWh(zb,Ub,wc);Db.MenuSectionList.push(mb);return Db}E5h(zb,Ub,wc){var mb;const Db=[];var Ic=this.gridView.ha.Ra.$b;Ic=5===(null===(mb=null===Ic||void 0===Ic?void 0:Ic.floatingObject)||void 0===mb?void 0:mb.type);let Hc,Ab;this.themesManager.CG?(Hc=this.themesManager.CG.Izd,Ab=this.themesManager.CG.tyd):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Ab?(mb=this.PJe(Ab,1,Ic,zb,Ub,wc),Db.push(mb)):f.ULS.sendTraceTag(520710164,
1,15,"Major Theme Font is Null");null!=Hc?(zb=this.PJe(Hc,2,Ic,zb,Ub,wc),Db.push(zb)):f.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return Db}PJe(zb,Ub,wc,mb,Db,Ic){var Hc=2===Ub?this.EIi:this.HFi;wc=wc?Hc:ac.a.df(zb);Hc=ac.a.df(Ha.HelperMethods.dec(zb,Ub));zb=ac.a.df(zb);return Object.assign(new ib.a,{MenuItemId:2===Ub?Ra.b:Ra.a,CommandValueId:wc,LabelText:Hc,LabelCss:String.format("font-size:12pt;font-family:{0};",zb),Styles:oa.sxb(zb),AriaLabel:Hc,Alt:Hc,Command:mb.toString(),CommandPreviewId:Db.toString(),
CommandRevertId:Ic.toString()})}nWh(zb,Ub,wc){if(this.s0c)return this.s0c.P7c;let mb;const Db=Ha.HelperMethods.y6(()=>{const Ic=this.Bmi&&!this.Rkf;let Hc=!1;this.Ava||(this.Nef(),Hc=!0);mb=this.pIe(zb,Ub,wc,this.Ava,Ic,Hc);mb.tzc&&!Hc&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Nef(),mb=this.pIe(zb,Ub,wc,this.Ava,Ic,mb.tzc));this.Gl&&!mb.tzc&&(this.s0c=mb);Ic&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.QXi)});
10<Db&&f.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Db}`);return mb.P7c}pIe(zb,Ub,wc,mb,Db,Ic){const Hc=[];let Ab;const db=this.Gl&&!Ic;Ab=db?"msofpNew":"msofp";for(let Kc in mb){var Pb=Kc,td=mb[Kc],Vb=ac.a.df(Pb),Ac=void 0;if(db)if(Ac=this.UO?this.UO[Pb]:null)Ac=ac.a.df(Ac);else return f.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Pb}`),
{tzc:!0,P7c:[]};else Ac=ac.a.df(Ha.HelperMethods.UO[Pb]);Pb=ac.a.df(Pb);Db||(td=0);Vb=Object.assign(new ib.a,{MenuItemId:Vb,CommandValueId:Vb,LabelText:Db&&0<td?ac.a.df(String.fromCodePoint(td)):Ac,LabelCss:String.format("font-size:12pt;font-family:{0};",Db&&0<td?Ab:Pb),Styles:oa.sxb(Db&&0<td?Ab:Pb),AriaLabel:Ac,Alt:Ac,Command:zb.toString(),CommandPreviewId:Ub.toString(),CommandRevertId:wc.toString()});Hc.push(Vb)}return{tzc:Ic,P7c:Hc}}Ozj(zb){this.menuId=zb}rpi(){return 2!==this.Fdd&&3!==this.Fdd?
!1:!0}Nef(){this.Ava={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,
["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,
["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static sxb(zb){const Ub={};Ub["font-family"]=zb;Ub["font-size"]="12pt";zb={};zb.optionText=Ub;return zb}}Object(b.a)(oa,"FontDropdownHelper",null,[686]);var kb=a(695);class Sa extends wa.a{constructor(zb){super();this.$=zb;this.Fb()}create(){x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.$a(504,zb=>{this.ob(Object(kb.a)(this.$.da,502,()=>new oa(this.$,zb)))}):this.ob(Object(kb.a)(this.$.da,502,()=>new oa(this.$,
null)))}static ka(zb){zb.da.Ga(503,new Sa(zb))}}Object(b.a)(Sa,"FontDropdownHelperFactory",wa.a,[]);var U=a(1251),ta=a(1089),ub=a(1227),hc=a(1190),Bc=a(1137),Qa=a(1163),na=a(1276),ab=a(1228),Gb=a(1214);class fc{constructor(zb){this.$=zb}nc(){return!1}executeCommand(zb,Ub){zb=!1;Ub=Ub.command;switch(Ub){case 1910465940:zb=!0}return zb?G.Task.Ta(!0):F.a(Ub)}wc(zb,Ub){switch(Ub.command){case 1910465940:return!0;default:return!1}}Jc(){return!1}}Object(b.a)(fc,"NameManagerCommandHandler",null,[165]);class pb extends e.a{constructor(zb){super(zb)}nd(){this.Yc([new fc(this.$)])}static ka(zb){e.a.Nd(493,
new pb(zb))}}Object(b.a)(pb,"NameManagerCommandHandlerFactory",e.a,[]);var Ea=a(1173),xb=a(1179),bc=a(1277);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(c.a)();J.a.Fa(H.ka);J.a.Fa(V.ka);Object(ra.a)();Object(N.a)();Object(ea.a)();Object(Ba.a)();Object(ka.a)();Object(Ka.a)();J.a.Fa(sa.ka);Object(sb.a)();Object(hb.a)();Object(bb.a)();(()=>{J.a.Fa(zb=>{Ja.ka(zb)})})();Object(Ga.a)();Object(U.a)();Object(ta.a)();Object(ub.a)();Object(hc.a)();Object(Bc.a)();Object(Qa.a)();Object(na.a)();Object(ab.a)();Object(xb.a)();Object(Gb.a)();Object(Ea.a)();Object(bc.a)();(()=>{J.a.Fa(zb=>{pb.ka(zb)})})();(()=>{J.a.Fa(zb=>{Sa.ka(zb)})})()},
716:function(u,D,a){a.d(D,"a",function(){return M});u=a(0);var c=a(7),b=a(15),e=a(561),f=a(87),d=a(558),h=a(375),m=a(590),l=a(566),v=a(111),t=a(263),z=a(83),r=a(416),n=a(1399);D=a(78);var w=a(19),B=a(5),A=a(773),y=a(76),x=a(42),F=a(59),I=a(142),L=a(113),X=a(1),P=a(11),G=a(22),C=a(13),H=a(21),J=a(34);class M extends D.a{constructor(S,W,O,T,Y,va,ca,V,ra,N,ea,Ba){super();this.$mc=!1;this.nIc=this.dLc=this.contextMenuController=null;this.Pqd=!1;this.qwc=this.Otb=null;this.lD=()=>{this.contextMenuController?
this.contextMenuController.lD():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Ygg()};this.jb=S;this.kvf=Y;this.pmb=N;this.GMf=va;this.populateOnlyOnce=ca;this.ybi=ea;this.dTf(Ba)}get contextMenuRoot(){return this.qwc}get $(){return this.jb}get Va(){return this.pmb}get menuId(){return this.$.Eb+this.kvf}get Uvb(){this.dLc||(this.dLc=L.a(this.$));return this.dLc}get crb(){this.nIc||(this.nIc=
H.h(this.$).Vb);return this.nIc}nc(S,W){S=!0;switch(W){case 1651433993:case 1675506831:case 966232027:S=this.Td(4096)||this.Td(2048);break;case 2045563128:S=this.Td(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:S=this.Td(8192)}return!S}Jc(S,W,O){O.IsShadowMenuOpen||A.i(this.$,A.d);S=!1;W===this.ax&&(O.IsShadowMenuOpen||A.i(this.$,A.a),W=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.UGd(W,O.IsShadowMenuOpen),O.MenuItems=W,
O.IsShadowMenuOpen||A.i(this.$,A.c),S=!0);S&&this.$mc&&P.HelperMethods.H2b&&!O.IsShadowMenuOpen&&A.k(this.$);return S}UGd(S,W){(W=this.kZ(W))?(this.Ycf(W),S.MenuSectionList.push(...W.QC().MenuSectionList),this.eKg(S)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}kZ(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}b1(S,W,O,T,Y){S=Sys.UI.DomElement.getBounds(W);W=new Sys.UI.Point(S.x,S.y+S.height);this.$.isChromeRtl&&(W.x+=S.width);this.Rp(W,Y)}Rp(S,W,O=0){W&&(S=J.a(this.$).nka(S));W=!0;if(this.ybi){let T;3===O?(T=this.lLa(3))&&0<T.length?(W=!1,this.showFloatie(T,new Sys.UI.Bounds(S.x,S.y,0,0),O)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===O&&this.$.isEditMode&&
((T=this.lLa(2))&&0<T.length?T[0]!==M.CYe?(W=!1,this.kVd(T,new Sys.UI.Bounds(S.x,S.y,0,0),O)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}W&&this.showContextMenu(new Sys.UI.Bounds(S.x,S.y,0,0),O)}lLa(){return null}lid(S,
W=null){let O="";3===S?O="touch":2===S&&(O="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!F.a.yg&&F.a.yg.PK,["IsReactMLR"]:!!F.a.yg&&F.a.yg.LV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:O,["FloatieGroups"]:JSON.stringify(W)}}showContextMenu(S,W=0){const O=this.lid(W);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(O)}`);this.contextMenuController?this.UB!==B.a.KJd&&this.UB!==B.a.LJd||0===
W?this.contextMenuController.jVd(this.UB,S,y.a.Db):this.contextMenuController.jVd(this.UB,S,W):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(S,W,O){const T=this.lid(O,S);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(T)}`);this.contextMenuController?(this.lTf(),this.contextMenuController.Uzc(S,W,O)):(S=JSON.stringify(S),
b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${S}.`))}kVd(S,W,O){var T=this.lid(O,S);T=JSON.stringify(T);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${T}`);this.contextMenuController?(this.lTf(),this.contextMenuController.iVd(S,W,O,this.UB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}dTf(S){this.contextMenuController=
S}dispose(){this.$&&this.$.Ka.vcb(this);this.jb=null;this.Ygg();this.qwc&&(f.a.Ia(this.qwc),this.qwc=null);super.dispose()}CMh(S){var W=this.$.da.za(204);W&&(W=W.jNh(this.kvf))&&S.tc.push(W)}Td(S){return(new I.a(this.$.xa)).Td(S)}Ycf(S){for(const W of S.tc)if(Object(r.a)(288,W)){S=W;S.title&&(S.title=M.Rg(S.title));for(const O of S.buttons)Object(r.a)(289,O)?(S=O,S.label=M.Rg(S.label),S.pS(M.Rg(S.alt))):Object(r.a)(290,O)&&this.Ycf(O.menu)}}hvf(S,W=!1){const O=[];for(const T of S)O.push(this.jF(T,
W));return O}jF(S){const W=[];for(const O of S.MenuItems)switch(O.Type){case 3:W.push(this.Pbh(O));break;case 2:W.push(this.Bhh(O));break;case 1:W.push(this.odh(O))}return Object(c.a)(new d.a,{ControlList:W,Title:S.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Fed(S,W){W=[this.Otb,S.RibbonCommand.toString(),W?this.v3e(W):this.v3e(S.Label),S.Disabled?S.Disabled.toString():"False"];let O=S.CommandData;O=G.a.hashCode(O).toString();
W.push(O,S.Identifier.toString());W=W.join("_");S.IsChecked&&(W+="_Checked");return W}kNh(S){const W=[this.Otb,G.a.hashCode(S.Title).toString()];for(const O of S.MenuItems)W.push(O.RibbonCommand.toString());return W.join("_")}q_e(S){var W=S.Label;W=G.a.hashCode(W).toString();W=[this.Otb,W];X.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&S.Id&&W.push(G.a.hashCode(S.Id).toString());W=W.join("_");S.IsChecked&&(W+="_Checked");return W}Pbh(S){let W,
O,T;({label:O,BMa:T,Or:W}=this.Dbc(S,!1));const Y=this.Fed(S,O);return Object(c.a)(new h.a,{Command:S.Disabled?(-251203935).toString():W.toString(),ExternalId:Y,Id:Y,Image16by16Class:T,LabelText:O||S.Label,MenuItemId:S.CommandData,CommandValueId:S.CommandData})}Bhh(S){let W,O,T;({label:O,BMa:T,Or:W}=this.Dbc(S,S.IsChecked));const Y=this.Fed(S,O);return Object(c.a)(new m.a,{Command:S.Disabled?(-251203935).toString():W.toString(),ExternalId:Y,Id:Y,Image16by16Class:T,LabelText:O||S.Label,MenuItemId:S.CommandData,
CommandValueId:S.CommandData,IsChecked:S.IsChecked})}odh(S){let W;var O;({label:W,BMa:O}=this.A_e(S));const T=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});T.MenuSectionList.push(...this.hvf(S.SubMenu.Sections,!0));const Y=this.q_e(S);S=W||S.Label;return Object(c.a)(new l.a,{ExternalId:Y,Id:Y,LabelText:S,PopulateOnlyOnce:!1,Menu:T,Image16by16Class:O,ImageIsVisible:!!O})}A_e(S){let W,O;({label:S,BMa:W,Or:O}=this.Dbc(S,!0));return{label:S,BMa:W,Or:O}}Dbc(S,W){let O;switch(S.Identifier){case 26:O=
912804500;W=w.a.OUe;S=C.a.instance.ga(1940);break;case 3:O=-1902148570;W=W?w.a.Jaa:null;S=C.a.instance.ga(1900);break;case 4:O=-1902148570;W=W?w.a.Jaa:null;S=C.a.instance.ga(1901);break;case 5:O=-1902148570;W=W?w.a.Jaa:null;S=null;break;case 1:O=-1677817820;W=w.a.x$b;S=C.a.instance.ga(233);break;case 2:O=-1649376918;W=S.IsChecked?w.a.iva:null;S=C.a.instance.ga(2112);break;case 23:O=1701016594;W=S.IsChecked?w.a.iva:null;S=C.a.instance.ga(2112);break;case 6:O=-87741481;W=null;S=C.a.instance.ga(2113);
break;case 7:O=1948650742;W=w.a.zTe;S=C.a.instance.ga(1938);break;case 8:O=1933713114;W=w.a.yTe;S=C.a.instance.ga(1939);break;case 14:O=504133448;W=w.a.cKa;S=C.a.instance.ga(145);break;case 30:O=504133448;W=w.a.cKa;S=C.a.instance.Ua(742);break;case 32:O=504133448;W=w.a.cKa;S=C.a.instance.ga(149);break;case 34:O=504133448;W=w.a.cKa;S=C.a.instance.ga(151);break;case 27:O=1701016594;W=W?w.a.z$b:w.a.cKa;S=C.a.instance.ga(145);break;case 15:O=-798968736;W=w.a.dKa;S=C.a.instance.ga(147);break;case 31:O=
-798968736;W=w.a.dKa;S=C.a.instance.Ua(743);break;case 33:O=-798968736;W=w.a.dKa;S=C.a.instance.ga(150);break;case 35:O=-798968736;W=w.a.dKa;S=C.a.instance.ga(152);break;case 28:O=1701016594;W=W?w.a.A$b:w.a.dKa;S=C.a.instance.ga(147);break;case 21:O=-2058042992;W=w.a.A3a;S=null;break;case 29:O=1701016594;W=w.a.A3a;S=null;break;case 9:O=1701016594;S=W=null;break;case 11:O=-1494291901;S=W=null;break;case 25:O=-1045020714;W=S.IsChecked?w.a.iva:null;S=null;break;case 13:O=1701016594;W=S.IsChecked?w.a.iva:
null;S=C.a.instance.ga(154);break;case 16:O=1701016594;W=w.a.p$b;S=C.a.instance.ga(1076);break;case 17:O=1701016594;W=w.a.z3a;S=null;break;case 18:O=1701016594;W=w.a.y3a;S=null;break;case 19:O=1701016594;W=w.a.q$b;S=C.a.instance.ga(1081);break;case 20:O=1701016594;W=w.a.Lad;S=C.a.instance.ga(1082);break;case 24:O=1675506831;S=W=null;break;case 22:O=S.RibbonCommand;W=S.IsChecked?w.a.Jaa:null;S=null;break;case 36:O=1461300262;W=null;S=C.a.instance.ga(153);break;case 38:O=S.RibbonCommand;W=w.a.abd;S=
C.a.instance.ga(1811);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(S)}`),O=1461300262,S=W=null}return{label:S,BMa:W,Or:O}}v3e(S){return G.a.hashCode(S+P.HelperMethods.Ewj).toString()}eKg(S){if(!this.$.ea.amIAlone){var W=this.$.da.za(25);if((void 0!==W&&null!==W||!X.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!v.a.isEmpty(W.QCa)&&(W=W.o7h(),!t.a.ph(W))){var O=[];z.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").Tfh(W,
O);S.MenuSectionList.push(...O)}}}lTf(){this.Pqd||(this.Uvb&&this.Uvb.j0b(this.lD),this.crb&&this.crb.j0b(this.lD),this.Pqd=!!this.Uvb||!!this.crb)}Ygg(){this.Uvb&&this.Uvb.Yuc(this.lD);this.crb&&this.crb.Yuc(this.lD);this.Pqd=!1}static Spd(S,W){W=x.C(W);S=H.h(S).Ea.xLa(W);return!(null===S||void 0===S||!S.Pk)}static Lfd(S,W,O){W=x.C(W);var T=H.h(S).Ea.xLa(W);W=H.h(S).getCellBounds(T);const Y=T.PUg;T=T.OUg;let va=W.x+Y.x;W=W.y+Y.y;O&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&
(H.h(S).rtl||(va+=T),W-=T);return new Sys.UI.Point(va,W)}static CEh(S){try{Object(n.a)(S.CommandValueId)}catch(W){}}static Rg(S){const W=M.Gua.parseFromString(S,"text/html");return W?W.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),S)}}M.Gua=new DOMParser;M.CYe="Unsupported";Object(u.a)(M,"ContextMenuBase",D.a,[165,291,2])},773:function(u,D,a){a.d(D,"j",function(){return"ContextMenuPerf.A"});a.d(D,"b",function(){return"ContextMenuPerf.B"});a.d(D,"d",function(){return"ContextMenuPerf.C1"});
a.d(D,"a",function(){return"ContextMenuPerf.C2"});a.d(D,"c",function(){return"ContextMenuPerf.D"});a.d(D,"e",function(){return v});a.d(D,"f",function(){return r});a.d(D,"h",function(){return n});a.d(D,"i",function(){return w});a.d(D,"k",function(){return B});a.d(D,"g",function(){return y});var c=a(15),b=a(321),e=a(8),f=a(61),d=a(24),h=a(11),m=a(21),l=a(1);const v=(x,F)=>{var I=x.Sb(null);if((null===I||void 0===I?0:I.cell.Pk)&&t(I,x,F))return x.getCellBounds(I.cell);I=x.ha.ra.activeCell;return(F=z(new d.Range(I.top,
I.left,e.a.eh,I.left,!1,!1),2,!0,x,F)||z(new d.Range(1,I.left,I.top,I.left,!1,!1),2,!1,x,F)||z(new d.Range(I.top,I.right,I.top,e.a.qh,!1,!1),1,!0,x,F)||z(new d.Range(I.top,1,I.top,I.right,!1,!1),1,!1,x,F)||null)&&F.Pk?x.getCellBounds(F):Sys.UI.DomElement.getBounds(x.Rwa.mc)},t=(x,F,I)=>{var L=F.rtl,X=I.isChromeRtl;x=x.cell;return(I=m.h(I).sK(x))?(I=I.topLeft,L=I.x+=L===X?x.offsetWidth:0,X=I.y+=x.offsetHeight,F.view.visibleArea.contains(new f.a(L,X,0,0))):!1},z=(x,F,I,L,X)=>{x=L.fk("ContextMenuHelper.FindFirstCellInViewportArea",
x,F,I);try{for(x.$$rst();x.$$mn();){const P=x.$$cu();if(P&&t(P,L,X))return P.cell}}finally{x&&x.dispose()}return null},r=x=>x.Bb.J5(x.ha.ra.activeCell),n=x=>{x=m.h(x).ha.ra;return x.Mg&&(x.$c.isRow||x.$c.hf)},w=(x,F)=>{h.HelperMethods.Y_c&&window.performance.mark(F)},B=()=>{if(b.a.mqb){const x=A("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),F=A("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),I=A("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,
0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${x}], PrepInfraWork=[${F}], EWAPopulation =[${I}]`)}},A=(x,F,I)=>{window.performance.measure(x,F,I);F=window.performance.getEntriesByName(x);F.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${x}] returned no measures.`);return F[F.length-1]?F[F.length-1].duration:-1},y=x=>l.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?x.rd&33554432?!0:!1:!0},775:function(u,
D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.rRe="ewa-ac";c.quh="ewa-ac-param";c.fSe="ewa-function-help-link";c.k$b="ewa-lb";c.aSe="ewa-fb-refactor";c.listItem="list-item";c.pDb="list-item-selected";c.tDb="list-table-touch";c.sDb="list-table";c.Vzh="ewa-suggested-cell-name";c.N6g="columnName-header";c.dTe="ewa-tt";c.vxh="ewa-function-link-container";c.gSe="ewa-function-udf-name";c.rtl="rtl";Object(u.a)(c,"CssClassNames",null,[])},810:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(815),e=
a(723),f=a(5),d=a(76),h=a(53),m=a(198),l=a(35),v=a(1),t=a(13);class z{constructor(S,W,O,T,Y,va,ca,V){this.Htg=S;this.Itg=W;this.Gtg=O;this.Yga=T;this.HEg=Y;this.YAg=va;this.Hkb=ca;this.Yzg=V}get uye(){return this.Htg}get y2b(){return this.Itg}get tye(){return this.Gtg}get width(){return this.Yga}get COj(){return this.HEg}get BMi(){return this.YAg}get lineHeight(){return this.Hkb}get aAi(){return this.Yzg}static IXg(){return new z("BorderStyleSolidLine",1953,1,"1","",1,8,0)}static EXg(){return new z("BorderStyleDashedLine",
1954,3,"1","5,3",1,8,0)}static FXg(){return new z("BorderStyleDottedLine",1955,4,"1","1,1",1,8,0)}static HXg(){return new z("BorderStyleMediumLine",1956,2,"2","",1,8,0)}static JXg(){return new z("BorderStyleThickLine",1957,5,"3","",1,8,0)}static GXg(){return new z("BorderStyleDoubleLine",1958,6,"1","",2,8,3)}}Object(u.a)(z,"BorderLineStyleProperties",null,[]);class r{constructor(){this.iconName=this.title=this.key=null}}Object(u.a)(r,"BorderLineStyleProps",null,[]);class n{constructor(S){S.wTf()}getBorderLineStyleProps(){const S=
a(810).BorderFormatManager.e0a,W=Array(Object.keys(S).length);let O=0;for(let va in S){var T=va,Y=S[va];W[O]=new r;W[O].key=T;T=Y;W[O].title=t.a.instance.ga(T.y2b);W[O].iconName=T.uye;O++}return W}}Object(u.a)(n,"BorderMenuController",null,[561]);var w=a(263),B=a(85),A=a(239),y=a(14),x=a(107),F=a(24),I=a(47),L=a(46),X=a(208),P=a(11),G=a(21),C=a(34),H=a(42);class J{constructor(S,W){this.rIb=this.ribbonCommandInfo=this.cellFormat=this.fs=this.qb=this.ha=null;this.fuc=!1;this.aOf=this.OMa=this.dId=this.$ae=
this.hAa=this.kna=null;this.A2b=this.Mua=this.gOf=0;this.borderStyle=this.f0a=this.borderColor=null;this.CB=!1;this.currentSelectedRange=this.ybb=null;this.F0=()=>{if(!this.CB||G.h(this.$).Hz)this.CB=!1,G.h(this.$).Hz=!1,this.Mua=0,G.h(this.$).Gf.gm(f.a.TQ),1===this.$.Ka.NH()&&(G.h(this.$).U4(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?H.d(this.dId):w.a.clone(this.dId),this.gOf,this.$.na?this.$.na.sheetName:null,null,this.aOf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",
!0),G.h(this.$).ATa(!0)),this.Wv(),this.w0d(),this.$j(),this.fuc=!1,this.hAa=this.kna=null,this.fs&&(this.fs.cancel(),this.fs.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=O=>{try{if(O=this.Vd(O),G.h(this.$).Hz=!0,this.kna={},this.hAa={},this.ybb=null,this.pqb(this.A2b),2===O.tb){const T=G.h(this.$).ha.ko(O.clientPoint,O.Gb,5,void 0,void 0,!1);T&&(this.currentSelectedRange=this.OMa=T,this.jfj())}}catch(T){G.h(this.$).Hz=
!1}return!0};this.Fh=O=>{try{O=this.Vd(O);const T=G.h(this.$).ha.ko(O.clientPoint,O.Gb,5,void 0,void 0,!1),Y=G.h(this.$).Ea.us(T);if(!this.rIb||Y&&(Y.$Q!==this.rIb.$Q||Y.ZQ!==this.rIb.ZQ))if(this.CB=!0,this.rIb=Y,T){let va=new F.Range(this.OMa.top,this.OMa.left,this.OMa.top,this.OMa.left,!0,!1);va.union(T);va=G.h(this.$).ha.G1h(va);this.F2b(T);this.YYf(this.ybb,va);if(this.bottomRightCorner(va.bottom,va.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const ca=new F.Range(va.top,va.left,va.bottom+1,va.right+1,!0,!1),V=G.h(this.$).laa("DrawBorderBehavior.OnPointerMove",[ca]);if(this.kna&&this.hAa)for(;V.$$mn();){const ra=V.$$cu(),N=ra.cell.getRange().toString();N in this.kna&&1!==this.Mua||(this.kna[N]=ra,this.hAa[N]=ra.cell.iN())}this.ybb=ca;this.currentSelectedRange=va;G.h(this.$).U4([va],0,this.$.na.sheetName,null,va.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.zg.vea(G.h(this.$),-1690267012,this.cellFormat,!0,null,[va])}return!0}catch(T){return G.h(this.$).Hz=
!1}};this.Of=O=>{O=this.Vd(O);(O=G.h(this.$).ha.ko(O.clientPoint,O.Gb,5,void 0,void 0,!1))?this.CB&&(this.F2b(O),this.OMa.union(O),3===this.Mua?this.pqb(0):this.pqb(this.A2b),G.h(this.$).U4([this.OMa],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.zg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Mua?this.pqb(0):this.pqb(this.A2b),G.h(this.$).U4([this.currentSelectedRange],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",
!0),this.zg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.CB=!1;this.w0d();this.hAa=this.kna=null;return!0};this.onKeyDown=O=>{O=this.Vd(O);if(this.CB||[17,16,18,20].includes(O.Ca.keyCode))return!0;this.F0();return!1};this.onKeyUp=O=>{O=this.Vd(O);if(O.Ca.keyCode===B.a.kJ&&this.CB)return this.CB=!1,this.YYf(this.ybb,this.currentSelectedRange,!0),this.w0d(),!0;if(this.CB||O.Ca.keyCode===B.a.G8||O.Ca.keyCode===B.a.Y4d||O.Ca.keyCode===B.a.X4d||[17,16,18,20,37,39,38,40,33,34,9,
13].includes(O.Ca.keyCode)||O.Ca.keyCode===B.a.Zrg||O.Ca.keyCode===B.a.Vrg||O.Ca.keyCode===B.a.Rrg)return!0;this.F0();return!1};this.ZN=(O,T)=>{G.h(this.$).Hz&&!this.yei.includes(T.Wd.command)&&(O=JSON.stringify(T.Wd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${O} `),this.F0())};this.$=S;this.zg=W}get yei(){return this.$ae||(this.$ae=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,
-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}kHg(S){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=G.h(this.$).ha;this.qb=G.h(this.$).qb;this.ribbonCommandInfo=S;this.dId=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?H.d(this.ha.ra.selectedRanges):w.a.clone(this.ha.ra.selectedRanges);this.gOf=this.ha.ra.Cs;this.aOf=this.ha.ra.activeCell.clone();this.qb&&this.qb.emd();
this.Ps();this.Kj()}dispose(){this.F0();this.rIb=this.ribbonCommandInfo=this.cellFormat=null}pqb(S){var {BorderFormatManager:W}=a(810);this.cellFormat={};const O={};this.borderColor=this.borderColor||W.V7c;var T=m.a.JH(this.borderColor,!1);O.Color=[T,T,T,T];v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.f0a&&(O.ThemeBorderColor=[this.f0a,this.f0a,this.f0a,this.f0a],O.ColorTypeOption=1);T=a(810).BorderFormatManager.e0a;this.borderStyle=this.borderStyle||W.borderStyleSolidLine;
W=T[this.borderStyle].tye;O.LineStyle=[W,W,W,W];this.cellFormat.BorderFormat=O;this.cellFormat.ValidMembers=128;this.cellFormat.Border=S}Ps(){for(const S of G.h(this.$).Nn)A.a.instance.ta(y.a.pointerDown,S.domElement,this.onPointerDown);x.KeyInputManager.instance.ta(y.a.Ob,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.ta(y.a.Dd,document.documentElement,this.onKeyUp)}jfj(){for(const S of G.h(this.$).Nn)A.a.instance.ta(y.a.Ij,S.domElement,this.Fh),A.a.instance.ta(y.a.Pf,S.domElement,
this.Of);A.a.instance.ta(y.a.Pf,document.documentElement,this.Of);A.a.instance.ta(y.a.Jy,document.documentElement,this.Of);this.fuc=!0}Wv(){try{for(const S of G.h(this.$).Nn)A.a.instance.Ba(y.a.pointerDown,S.domElement,this.onPointerDown);x.KeyInputManager.instance.Ba(y.a.Ob,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.Ba(y.a.Dd,document.documentElement,this.onKeyUp)}catch(S){G.h(this.$).Hz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${S}`)}}w0d(){if(this.fuc)try{this.fuc=
!1;for(const S of G.h(this.$).Nn)A.a.instance.Ba(y.a.Ij,S.domElement,this.Fh),A.a.instance.Ba(y.a.Pf,S.domElement,this.Of);A.a.instance.Ba(y.a.Pf,document.documentElement,this.Of);A.a.instance.Ba(y.a.Jy,document.documentElement,this.Of)}catch(S){G.h(this.$).Hz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${S}`)}}Kj(){this.$.xa.Uf(this.F0);G.h(this.$).Vb.Xk(this.F0);G.h(this.$).IC(this.F0);this.$.Ka.Asa(this.ZN)}$j(){this.$.xa.Bg(this.F0);
G.h(this.$).Vb.Fk(this.F0);G.h(this.$).cE(this.F0);this.$.Ka.HAa(this.ZN)}YYf(S,W,O=!1){if(S&&this.kna&&this.hAa)for(S=G.h(this.$).laa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[S]);S.$$mn();){var T=S.$$cu().cell.getRange();if(O||!W.contains(T)||1===this.Mua){T=T.toString();const Y=l.a.Dc(this.kna,T);if(Y){const va=l.a.Dc(this.hAa,T);this.setBorders(Y,va);delete this.kna[T];delete this.hAa[T]}}}}setBorders(S,W){var O=S.cell;const T=O.getRange();O.ucb();T.right!==this.ybb.right&&(O=new F.Range(T.top,
T.left-1,T.bottom,T.left-1,!0,!1),G.h(this.$).Ea.us(O).rRa(3));T.bottom!==this.ybb.bottom&&(O=new F.Range(T.top-1,T.left,T.top-1,T.right,!0,!1),G.h(this.$).Ea.us(O).rRa(1));if(null===W||void 0===W?0:W.Borders.length){O={};let ca=0;const V=Array(4),ra=Array(4);for(var Y=0;4>Y;Y++)V[Y]=1,ra[Y]=0;for(var va of W.Borders)W=va.BorderPosition,V[W]=va.BorderLineStyle,Y=new X.a(va.Color.Red,va.Color.Green,va.Color.Blue),ra[W]=Y.DS(),ca|=P.HelperMethods.K4a(va.BorderPosition);O.LineStyle=V;O.Color=ra;va={};
va.BorderFormat=O;va.Border=ca;this.zg.zAj(S,va,T)}}F2b(S){const W=new F.Range(Math.max(1,S.top-1),Math.max(1,S.left-1),S.bottom+1,S.right+1,!1,!1);G.h(this.$).MK(W)||this.fs&&this.fs.Gp||(this.fs=I.a.instance.create(()=>{G.h(this.$).Ht(W,60,"DrawBorderBehavior.BringRangeIntoView")},40,L.a.Vph))}bottomRightCorner(S,W){return 1048576<=S||16384<=W?!0:!1}Vd(S){return C.a(this.$).Vd(S)}}Object(u.a)(J,"DrawBorderBehavior",null,[2]);a.d(D,"BorderFormatManager",function(){return M});class M{constructor(S,
W,O){this.ESb=null;this.jG={};this.tTb=this.Dx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=S;this.n8d=M.V7c;this.o8d=M.borderStyleSolidLine;this.zg=W;this.Va=O;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.MU=new J(this.$,this.zg);this.ED=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get VIa(){return this.o8d}get T3(){return this.n8d}get bua(){return this.tTb}get themesManager(){this.Dx||
(this.Dx=this.$.da.za(422));return this.Dx}R9e(S,W){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${W.command.toString()}`);const O={},T={};var Y=m.a.JH(this.T3,!1);T.Color=[Y,Y,Y,Y];this.ED&&this.bua&&(T.ThemeBorderColor=[this.bua,this.bua,this.bua,this.bua],T.ColorTypeOption=1);S=-600086683===W.command?"OutsideBorders":S[d.a.Ic];T.LineStyle=l.a.Dc(M.lNf,S);T.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${S}`):
(Y=M.e0a[this.VIa].tye,T.LineStyle=[Y,Y,Y,Y],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.VIa}`));Y=l.a.xq(M.FWg,S,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${S}, the border color selected is ${this.T3}`);O.BorderFormat=T;4!==Y&&8!==Y||!this.$.na.displayRtl||(Y=4===Y?8:4);O.ValidMembers=128;O.Border=Y;this.zg.formatCells(-1690267012,
O,W);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${W.command.toString()}`);return!0}Bkd(S,W,O){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${S.toString()} is being executed, the previous border color is ${this.T3}`);if(this.ED){if((W.SqmControlId||"").includes("ThemeColorPicker")){let T,Y;({themeIndex:T,hCa:Y}=this.themesManager.getThemeColor(W.Color)).returnValue?(this.tTb={},this.bua.ThemeColorIndex=T,this.bua.ThemeColorRow=Y):this.tTb=null}else this.tTb=
null;this.MU.f0a=this.bua}this.n8d=-1803452024===S?M.V7c:W.Color;this.MU.borderColor=this.T3;this.HPe(O);this.$.af();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${S.toString()} is being executed, the updated border color is ${this.T3}`);return!0}P$h(S){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const W=this.Va.cq();var O=this.Va.Ec();W.tc.push(O);const T=this.Va.gB("StyleDashGallery",1,"Size120by20");O.buttons.push(T);O=M.e0a;for(let Y in O){const va=
Y,ca=O[Y],V=t.a.instance.ga(ca.y2b);T.ku(va,-2118943501,"QueryBorderStyle",ca.y2b,va,va,void 0,void 0,V)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");S.MenuItems=W.QC();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}l9h(S,W){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.VIa}`);S=S[d.a.Ic];if(M.gwi(S))this.o8d=S,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.VIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${S}`),!0;this.MU.borderStyle=this.VIa;this.HPe(W);this.$.af();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.VIa}`);return!0}Fkd(S){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${S.command.toString()}`);this.NVc(S,64,this.T3,110,1);return!0}Gkd(S){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${S.command.toString()}`);this.NVc(S,112,this.T3,111,2);return!0}e$e(S){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${S.command.toString()}`);this.NVc(S,112,"white",112,3);return!0}U$h(S){this.dzj(this.HWg,S,S.MenuItemId?S.MenuItemId:M.borderStyleSolidLine)}dzj(S,W,O){O in S?(S=S[O],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${O}`),
this.fzj(W,S)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${O}' in BorderLineStyleButtons dictionary`)}fai(S,W){const O=S[d.a.Ic];return"DrawBorder"===O?this.Fkd(W):"DrawBorderGrid"===O?this.Gkd(W):"EraseBorder"===O?this.e$e(W):this.R9e(S,W)}wTf(){this.ESb||this.KXg()}qQh(){return new n(this)}get HWg(){this.wTf();return this.ESb}KXg(){this.ESb={};let S=0;const W=M.e0a;for(let O in W){const T=W[O],Y=T.uye;t.a.instance.ga(T.y2b);this.ESb[Y]=Y;this.ncb(Y,()=>
appChrome.buildBorderStyleIconNew(T.COj,T.width,T.BMi,T.lineHeight,T.aAi));S++}}ncb(S,W){if(!(S in this.jG)){const O={};W=W();O[S]=W;appChrome.api.registerIconProvider(()=>O);this.jG[S]=!0}return S}fzj(S,W){S.MenuItemId&&(S[b.a.On]=S.MenuItemId===this.VIa,S[e.a.Icon]=W)}NVc(S,W,O,T,Y){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.x3g(S,Y)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.MU.F0()):(G.h(this.$).Hz&&this.MU.F0(),h.a.current&&(T=String.format(f.a.hua,h.a.current.io(T)),G.h(this.$).Gf.gm(T)),this.MU.A2b=W,this.MU.borderColor=O,G.h(this.$).Hz=!0,this.MU.kHg(S),this.MU.Mua=Y)}HPe(S){if(S)switch(this.MU.Mua){case 2:this.Gkd(S);break;default:this.Fkd(S)}}x3g(S,W){return this.MU.Mua===W&&-236759591!==S.command&&-2118943501!==S.command?!0:!1}static get e0a(){return M.y6d||(M.y6d={["BorderStyleSolidLine"]:z.IXg(),["BorderStyleDashedLine"]:z.EXg(),["BorderStyleDottedLine"]:z.FXg(),
["BorderStyleMediumLine"]:z.HXg(),["BorderStyleThickLine"]:z.JXg(),["BorderStyleDoubleLine"]:z.GXg()})}static get FWg(){return M.x6d||(M.x6d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get lNf(){return M.Yhe||
(M.Yhe={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:M.tkh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static gwi(S){return S?S in M.lNf||S in M.e0a:!1}}M.x6d=null;M.y6d=null;M.Yhe=null;M.V7c="black";M.borderStyleSolidLine="BorderStyleSolidLine";M.tkh=[1,1,1,1];Object(u.a)(M,"BorderFormatManager",null,[544])},836:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.edit="Edit";c.clipboard=
"Clipboard";c.copy="Copy";c.color="Color";c.MUg="AutoFill";c.drj="RowOperations";c.O6g="ColumnOperations";c.a4j="ViewModeRowOperations";c.$3j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.iDj="ShapeStyle";c.lJh="FloatingObjectClipboard";c.jMf="PivotTableCopyDelete";c.lMf="PivotTableFieldListActions";c.HBe="CellFloatie";c.eDj="ShapeFloatie";c.contextMenu="ContextMenu";c.D8h="GridContextMenu";c.y5i="PivotTableContextMenu";c.mJh="FloatingObjectContextMenu";c.E2g=
"CellRTEFloatie";c.m6f="ShapeRTEFloatie";Object(u.a)(c,"FloatieGroupIdentifiers",null,[])},837:function(u,D,a){a.d(D,"a",function(){return l});u=a(0);var c=a(87),b=a(224),e=a(14),f=a(239);D=a(238);var d=a(12),h=a(71),m=a(21);class l extends D.a{constructor(v,t,z){super(t);this.Qlc=this.rR=!1;this.Ln=this._selectedRowListBox=this.DOa=null;this.$Df=r=>this.onItemClick(r);this.MDd=r=>{h.g(r.Ca);this.raiseEvent(l.M5a);this.raiseEvent(l.xRd);return!0};this.onScroll=r=>{h.g(r);this.nJd();this.raiseEvent(l.M5a)};
this.onBlur=r=>{h.g(r);this.nJd()};this.onPointerDown=()=>{this.nJd();this.raiseEvent(l.M5a);this.raiseEvent(l.xQa);return!1};this.lGb=r=>{const n=r.Ca;if(n.button===Sys.UI.MouseButton.leftButton||n.button===Sys.UI.MouseButton.rightButton||n.type.includes("touch"))this.Nj=this.gcc(n),this.onPointerDown(r);this.raiseEvent(l.vud);return!1};this.jb=v;this.oDb=z;this.VBa(!0)}i$(v){this.get_events().addHandler(l.M5a,v)}Qda(v){this.get_events().removeHandler(l.M5a,v)}g0b(v){this.get_events().addHandler(l.Zmd,
v)}Wuc(v){this.get_events().removeHandler(l.Zmd,v)}Dob(v){this.get_events().addHandler(l.xRd,v)}nKb(v){this.get_events().removeHandler(l.xRd,v)}Bob(v){this.get_events().addHandler(l.xQa,v)}jKb(v){this.get_events().removeHandler(l.xQa,v)}wXc(v){this.get_events().addHandler(l.vud,v)}sMd(v){this.get_events().removeHandler(l.vud,v)}get Nj(){return this._selectedRowListBox}set Nj(v){this.mCa(this._selectedRowListBox);v?(this._selectedRowListBox=v,this.mCa(this._selectedRowListBox),this.cxc(v)):this._selectedRowListBox=
null}get UV(){return this.oDb.ListCellClass}get m6(){return this.oDb.ListTableClass}get sI(){return 8}get oEb(){return 5}get Plc(){return 24}get Olc(){return 35}get If(){return this.domElement}get $(){return this.jb}dispose(){this.l8(!1);this.VBa(!1);c.a.qc([this.DOa]);this.DOa=null;super.dispose()}gcc(v){return d.DOMElementExtensions.Cgd(v.target,"tr",!0)}IB(v){if(v){if(!this.Nj){var t=this.Ln;if(!t||!t.rows.length)return;this.Nj=t.rows[0];0<v?v--:v++}t=this.Nj;for(let z=0,r=Math.abs(v);z<r;z++)if(0>
v){if(!t.previousSibling)break;t=t.previousSibling}else{if(!t.nextSibling)break;t=t.nextSibling}t&&(this.Nj=t)}}kob(v,t){d.DOMElementExtensions.toggleCssClass(v,this.oDb.ListTableClassInTouch,t)}l8(v){const t=this.Ln;t&&(v&&!this.Qlc?(b.a.instance.ta(e.a.click,t,this.$Df),b.a.instance.ta(e.a.Bk,t,this.MDd),f.a.instance.ta(e.a.pointerDown,t,this.lGb),this.Qlc=!0):this.Qlc&&(b.a.instance.Ba(e.a.click,t,this.$Df),b.a.instance.Ba(e.a.Bk,t,this.MDd),f.a.instance.Ba(e.a.pointerDown,t,this.lGb),this.Qlc=
!1))}mCa(v){let t=null;v&&(t=d.DOMElementExtensions.ik(v,this.oDb.ListCellClass))&&t.classList.toggle(this.oDb.ListCellSelectedClass);return t}VBa(v){this.If&&(v&&!this.rR?(this.DOa=this.Be.Zd(this.If),this.DOa.ka("scroll",this.onScroll),this.DOa.ka("blur",this.onBlur),f.a.instance.ta(e.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!0):this.rR&&(c.a.Ia(this.DOa),this.DOa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!1))}onItemClick(v){return this.MDd(v)}cxc(v){if(v){var t=
v.offsetTop,z=this.If.scrollTop;t<z?this.R0f(!0):t+v.offsetHeight>z+this.If.clientHeight&&this.R0f(!1)}}R0f(v){this.If.scrollTop=v?this.Nj.offsetTop:this.Nj.offsetTop+this.Nj.offsetHeight-this.If.clientHeight}nJd(){m.h(this.$).eb&&this.raiseEvent(l.Zmd)}}l.M5a="GotFocus";l.Zmd="IgnoreBlur";l.xRd="SetCell";l.xQa="PointerDown";l.vud="ItemPointerDown";Object(u.a)(l,"ListBox",D.a,[321,2])},906:function(u,D,a){a.d(D,"a",function(){return b});u=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,
f,!0)}}Object(u.a)(b,"IgnoreCaseComparer",null,[293])},907:function(u,D,a){a.d(D,"a",function(){return f});u=a(0);var c=a(24),b=a(11),e=a(173);class f{constructor(d,h){this.Ea=d;this.N3a=h}rMb(d,h,m){const l=h.Border;h=h.BorderFormat;let v=0,t=!1;if(0===l)d.cell.ucb(),this.FJb(d.cell.getRange());else{for(let z=0;3>=z;z++)f.rEj(d,m,z,l)&&(v|=b.HelperMethods.K4a(z),this.R0d(d.cell.getRange(),z,h),t=!0);b.HelperMethods.gR(l,16)&&!e.c(d,0,m)&&(v|=2,this.R0d(d.cell.getRange(),0,h),t=!0);b.HelperMethods.gR(l,
32)&&!e.c(d,2,m)&&(v|=4,this.R0d(d.cell.getRange(),2,h),t=!0);t&&(m=d.cell.py.pf,b.HelperMethods.gR(v,2)&&this.z7f(d,m,0)&&(v&=-3),b.HelperMethods.gR(v,1)&&this.y7f(d,m,1)&&(v&=-2),b.HelperMethods.gR(v,4)&&this.z7f(d,m,2)&&(v&=-5),b.HelperMethods.gR(v,8)&&this.y7f(d,m,3)&&(v&=-9),d.cell.setBorders(h,v,!1))}}NQ(d,h){d=f.Y_e(d,h);return d.Nz?(d=this.Ea.Rja(d))&&d.length?d:null:null}FJb(d){for(let m=0;3>=m;m++){var h=f.Y_e(d,m);if(!h.Nz)continue;h=this.Ea.Rja(h);if(!h||!h.length)continue;const l=f.t5e(m);
for(let v=0;v<h.length;v++)h[v].rRa(l)}}R0d(d,h,m){if(d=this.NQ(d,h)){var l=f.t5e(h),v=b.HelperMethods.K4a(l);for(let t=0;t<d.length;t++){const z=d[t];this.ymi(z,l)&&f.setBorders(z,m,v,h,l)}}}ymi(d,h){const m=d.py.pf;var l=d.getRange();l=this.NQ(l,h);let v=!1,t=!1,z=!1,r=!1;l&&(v=f.L7a(l,!0),t=f.L7a(l,!1),r=f.Erd(l),z=1===l.length?!0:!1);switch(h){case 0:return f.Oli(d,m,r,t,z);case 1:return f.Lli(d,m,r,v,z);case 2:return f.Mli(d,m,r,v,z);case 3:return f.Nli(d,m,r,t,z)}return!1}z7f(d,h,m){if(!d.cell.TF)return!1;
const l=d.range,v=this.NQ(l,m),t=e.c(d,m,h);let z=!1;h=0===m?l.top<h.top:l.left<h.left;!f.bBb(d.cell)&&v&&1!==v.length&&(z=(0===m?f.L7a(v,!0):f.L7a(v,!1))?!1:!0);return!t&&z||h?!0:!1}y7f(d,h,m){const l=d.cell,v=this.NQ(l.getRange(),m);d=e.c(d,m,h);h=!1;if(v){const z=f.L7a(v,!0);var t=f.L7a(v,!1);const r=z&&!t;t=t&&!z;1!==m||f.dCb(l)?3!==m||f.SAb(l)||f.yEj(l,v,t,r)&&(h=!0):f.xEj(l,v,z,t)&&(h=!0)}return!d&&h||f.bBb(l)?!0:!1}static DXg(d,h,m){const l={};l.LineStyle=Array(4);l.LineStyle[m]=d.LineStyle[h];
l.Color=Array(4);l.Color[m]=d.Color[h];return l}static Ogf(d,h,m,l,v){return b.HelperMethods.gR(d,v)&&e.c(h,m,l)}static rEj(d,h,m,l){return f.Ogf(l,d,m,h,b.HelperMethods.K4a(m))||f.Ogf(l,d,m,h,64)||112===l}static setBorders(d,h,m,l,v){h=f.DXg(h,l,v);d.setBorders(h,m,!1)}static Y_e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,
d.right+1,d.bottom,d.right+1,!1,!1)}return d}static t5e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static L7a(d,h){for(let m=0;m<d.length;m++){const l=d[m];if(l.TF)return h?f.SAb(l):f.dCb(l)}return!1}static bBb(d){const h=d.py.pf,m=d.getRange();return d.TF&&(m.top<h.top||m.bottom>h.bottom||m.left<h.left||m.right>h.right)?!0:!1}static Erd(d){for(let h=0;h<d.length;h++)if(f.bBb(d[h]))return!0;return!1}static xEj(d,h,m,l){if(!d.TF){if(!m||f.Erd(h))return!0}else if(f.SAb(d)&&
(1===h.length&&f.SSg(d,h[0])||!m))return!0;return l}static yEj(d,h,m,l){if(!d.TF){if(!m||f.Erd(h))return!0}else if(f.dCb(d)&&(1===h.length&&f.TSg(d,h[0])||!m))return!0;return d.Ela||l}static Oli(d,h,m,l,v){const t=d.getRange();return f.SAb(d)?f.bBb(d)||v:h.top===t.top||!l||m}static Lli(d,h,m,l,v){const t=d.getRange();return f.SAb(d)?h.bottom===t.bottom&&v:l&&!m||h.bottom===t.bottom}static Mli(d,h,m,l,v){const t=d.getRange();return f.dCb(d)?f.bBb(d)||v:h.left===t.left||!l||m}static Nli(d,h,m,l,v){const t=
d.getRange();return d.Ela?!1:f.dCb(d)?h.right===t.right&&v:l&&!m||h.right===t.right}static SAb(d){return 0<d.getRange().right-d.getRange().left}static dCb(d){return 0<d.getRange().bottom-d.getRange().top}static TSg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static SSg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(u.a)(f,"BorderModelAccessorHelper",null,[])},909:function(u,D,a){a.d(D,"a",function(){return d});u=a(0);var c=a(87);
D=a(94);var b=a(47),e=a(46),f=a(71);class d extends D.a{constructor(h,m){super(m.textBox.domElement);this.SZc=null;this.ZNi=()=>{this.kCd()};this.SBf=(l,v)=>{this.Nf(l,v)};this.WBf=(l,v)=>{this.rh(l,v)};this.jb=h;this.rJ=m;m.g3&&(m.g3.add(this),m.Xk(this.WBf),m.sm(this.SBf))}get $(){return this.jb}get Za(){return this.rJ}dispose(){const h=this.rJ;if(null===h||void 0===h?0:h.g3)h.g3.remove(this),h.Fk(this.WBf),h.Il(this.SBf);c.a.Ia(this.SZc);this.rJ=null;super.dispose()}Xh(h,m){switch(m){case -1470715894:case -1231471547:this.ZY(!1);
break;default:if(this.QId(h,m))return f.g(h),!0;d.Fri(m)||this.ZY(!1)}return!1}ZY(){c.a.Ia(this.SZc);this.SZc=b.a.instance.create(this.ZNi,10,e.a.hAi)}rh(){this.ZY(!1)}static Fri(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(u.a)(d,"ListAutoCompleteBehavior",D.a,[322,2])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/255c62c531d38bb0e18eec66c47cb012/EwaDSEsNext.kpae.js.map