'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1161:function(u,D,a){u=a(0);var c=a(15),b=a(222),e=a(8),f=a(111);a(200);var d=a(187),h=a(82),m=a(176),l=a(184),v=a(64);class t{}t.local="Local";t.qRj="Thread";Object(u.a)(t,"RecalcServiceCreateMode",null,[]);var z=a(162);class r{constructor(Z){this.E7d=null;this.init(Z)}get Y$(){return this.E7d}init(Z){this.E7d=new m.a;if(void 0!==Z&&null!==Z&&void 0!==Z.HeadersList&&null!==Z.HeadersList&&0<Z.HeadersList.length)for(const la of Z.HeadersList)this.Y$.ia(la.Index,
la.Name)}}Object(u.a)(r,"ColHeadersListData",null,[]);var n=a(1),w=a(33),B=a(99),A=a(22),y=a(21),x=a(173);class F{constructor(Z,la){this.Rze=Z;this.sheetName=la;this.Fxc=!1}}Object(u.a)(F,"CalcBlockInformation",null,[]);class I{constructor(Z,la,Xa,Za,xa){this.type=Z;this.fullName=la;this.range=Xa;this.sheetId=Za;this.attributes=xa;this.eF=null}}Object(u.a)(I,"CalcNamedObject",null,[]);class L{constructor(Z){this.ekg=Z;this.Rke=[];this.whg=[];this.B0a={};this.ITd=new Map}get Pj(){return this.Rke}n5f(Z,
la){this.Rke[Z]=la;this.ekg&&la.Y7&&this.ITd.set(la.Y7.sheetName,Z)}getSheetIndex(Z){if(this.ekg){if(this.ITd.has(Z))return this.ITd.get(Z)}else for(let la=1;la<this.Pj.length;la++)if(A.a.equals(this.Pj[la].Y7.sheetName,Z,!1))return la;return-1}}Object(u.a)(L,"GridCache",null,[]);var X=a(682),P=a(553);class G{constructor(Z){this.Y7=Z;this.A6=new X.a(P.a.cl());this.Inc=!1}}Object(u.a)(G,"SheetInformation",null,[]);var C=a(936),H;(function(Z){Z[Z.initialization=0]="initialization";Z[Z.contentReady=
1]="contentReady";Z[Z.cellEdit=2]="cellEdit"})(H||(H={}));Object(u.b)("UpdateDataTrigger",H);class J{constructor(Z){this.kKd=null;this.vwd=this.jKd=this.tEd=!1;this.$Hd=0;this.SHd=this.UHd=this.VHd=this.THd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.jr=this.errorTypeNames=null;this.Qt=this.currentStateId=-1;this.aua="";this.qaa=null;this.getNameLoc=(la,Xa)=>this.Zic()?this.Xe.oa(this.currentStateId).Pj[0].A6.lb(Xa)?(la=excelOnlineCalc.location.nameLoc(la,
Xa),excelOnlineCalc.util.success(la)):excelOnlineCalc.util.success(null):(la=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(la));this.getContainingTable=la=>{if(!this.Zic())return la=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(la);const Xa=la.range.col,Za=la.range.row;var xa=this.Xe.oa(this.currentStateId).Pj[0].A6,fa=null;for(let ua of xa)if(xa=ua.value,2===xa.type&&A.a.equals(la.sheet.index.toString(),xa.sheetId,!0)){const sa=xa.range;Xa>=sa.left-1&&Xa<=
sa.right-1&&Za<=sa.bottom-1&&Za>=sa.top-1&&(fa=excelOnlineCalc.location.nameScope(this.documentLoc,xa.sheetId),fa=excelOnlineCalc.location.nameLoc(fa,xa.fullName))}return fa?excelOnlineCalc.util.success(fa):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(la,Xa)=>{if(!this.Zic()){var Za=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Za)}Za=la.name;var xa=this.Xe.oa(this.currentStateId).Pj[0].A6;if(xa.lb(Za)){xa=xa.oa(Za);const ua=xa.range;if(2!==xa.type)return excelOnlineCalc.util.failure(this.f6c(5));
const sa=xa.eF?xa.eF.Y$:null;if(!sa)return excelOnlineCalc.util.success(null);for(var fa of sa)if(A.a.equals(fa.value,Xa,!0))return la=excelOnlineCalc.location.documentLoc(la.scope.document.path,la.scope.document.name),la=excelOnlineCalc.location.sheetIndex(la,xa.sheetId),fa=excelOnlineCalc.location.gridRange(ua.top-1,fa.key,ua.bottom-ua.top+1,1),fa=excelOnlineCalc.location.sheetGridRange(la,fa),Za=excelOnlineCalc.location.structRefColumnLoc(Za,fa,!!(xa.attributes&16),!!(xa.attributes&8)),excelOnlineCalc.util.success(Za);
return ua.right-ua.left+1!==sa.count?(Za=excelOnlineCalc.util.unavailable([17,la,Xa]),excelOnlineCalc.util.failure(Za)):excelOnlineCalc.util.failure(this.f6c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(la,Xa)=>{if(!this.Zic())return Xa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Xa);var Za=this.Xe.oa(this.currentStateId).Pj[0].A6;if(Za.lb(la.name)){var xa=Za.oa(la.name);if(2!==xa.type)return excelOnlineCalc.util.failure(this.f6c(5));Za=!!(xa.attributes&
16);const fa=!!(xa.attributes&8),ua=Za?1:0,sa=fa?1:0;la=excelOnlineCalc.location.documentLoc(la.scope.document.path,la.scope.document.name);la=excelOnlineCalc.location.sheetIndex(la,xa.sheetId);xa=xa.range;let sb={};if(1===Xa)sb=excelOnlineCalc.location.gridRange(xa.top-ua-1,xa.left-1,xa.bottom+sa-xa.top+ua+1,xa.right-xa.left+1);else if(2===Xa)sb=excelOnlineCalc.location.gridRange(xa.top-1,xa.left-1,xa.bottom-xa.top+1,xa.right-xa.left+1);else if(3===Xa)if(Za)sb=excelOnlineCalc.location.gridRange(xa.top-
2,xa.left-1,1,xa.right-xa.left+1);else return excelOnlineCalc.util.success(null);else if(4===Xa)if(fa)sb=excelOnlineCalc.location.gridRange(xa.bottom,xa.left-1,1,xa.right-xa.left+1);else return excelOnlineCalc.util.success(null);Xa=excelOnlineCalc.location.sheetGridRange(la,sb);return excelOnlineCalc.util.success(Xa)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(la,Xa)=>{if((A.a.equals(la,this.documentLoc.path,!0)||!la)&&A.a.equals(Xa,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
la=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(la,Xa)]);return excelOnlineCalc.util.failure(la)};this.getSheetIndex=(la,Xa)=>{if(!this.Xe.lb(this.currentStateId)||!this.Xe.oa(this.currentStateId).Pj)return Xa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Xa);la=this.Xe.oa(this.currentStateId).Pj;for(let Za=1;Za<la.length;Za++)if(A.a.equals(la[Za].Y7.sheetName,Xa,!0))return excelOnlineCalc.util.success(la[Za].Y7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(la,Xa)=>{if(!this.Xe.lb(this.currentStateId)||!this.Xe.oa(this.currentStateId).Pj)return Xa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Xa);la=this.Xe.oa(this.currentStateId).Pj;for(let Za=1;Za<la.length;Za++)if(A.a.equals(la[Za].Y7.sheetId,Xa,!0))return excelOnlineCalc.util.success(la[Za].Y7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.BFf=()=>{this.setNumberFormats()};this.ed=()=>{c.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Xe=new m.a;this.currentStateId=this.Qt=-1;this.aua="";this.ctb=null;this.jKd=!1;this.jr&&this.clearCache()};this.y$f=(this.Lc=Z)?Z.va.CalcWebWorkerSmokeTestPingIntervalMS:this.y$f;this.Xe=new m.a;this.ctb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.Lc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.ipa();this.Xqd=w.a.Xqd()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.wMd(this.BFf);this.Lc&&this.Lc.Kl(this.ed);this.close()}lQb(Z){if(!this.jr)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Lc.da.za(268),!this.instantaneousSupportInformationManager))return c.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==Z&&(this.currentStateId=this.Lc.ea.o9a,this.currentStateId===e.a.pe&&(this.currentStateId=this.Lc.ea.ye));if(1===Z&&this.currentStateId<this.Qt)return c.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Qt} - ignoring update`),!1;this.Sxj();0!==Z&&this.jKd||(this.kCj(),this.rzj(),this.cAj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Wre(this.BFf),this.Lc.nl(this.ed),this.jKd=!0);this.zdj();
let la=!1;0===Z&&(la=this.Fhi());if(0!==Z||la)this.wBj()?(this.ZBj(Z),this.YBj(),this.Qt=this.currentStateId,this.x4g()):c.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==Z&&this.resumeRecalc();return!0}evalFormula(Z,la,Xa,Za){if(!this.jr)return c.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});la=excelOnlineCalc.calc.sheetCellLocation(null!==Xa&&void 0!==
Xa?Xa:v.d(this.Lc.xa.na),la.top-1,la.left-1);Z=this.jr.evalFormula(this.Lc.ea.ye,Z,la,Za);this.resumeRecalc();return Z}j0g(Z,la,Xa,Za=null){const xa=v.d(this.Lc.xa.na);let fa=Z.cell.$Q-1,ua=Z.cell.ZQ-1;var sa=fa,sb=ua;let hb=null;Za&&(hb=excelOnlineCalc.calc.cellLocation(fa,ua),fa=Za.top-1,ua=Za.left-1,sa=Za.bottom-1,sb=Za.right-1);Xa=this.r2d(Z,Xa,"SetCell");if(0>Xa)return!1;sb=J.maa("CalculateFormula.cell",xa,fa,ua,sa,sb);sa=[];Za=this.Wjd(xa);la=excelOnlineCalc.calc.inferredRangeFormulaEdit(sb,
la,hb,Za);sa.push(la);Z=(la=this.Q8e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",xa,fa,ua,A.a.$te(Z.cell.text),Xa,la.top-1,la.left-1,la.bottom-1,la.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",xa,fa,ua,A.a.$te(Z.cell.text),Xa,"","","","");c.ULS.sendTraceTag(537170180,0,50,Z);this.jr.editRangeFormulas(Xa,sa);this.resumeRecalc();
return!0}Kub(Z,la,Xa,Za){if(!this.jr)return c.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!Xa||!la)return c.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!Xa}, outputColumnRange null: ${!la}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");c.ULS.shipAssertTag(537170178,0,Xa.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const xa=v.d(this.Lc.xa.na),fa=this.Wjd(xa);var ua=null;if(Z){ua=[];for(const sb of Z)if(sb.column!==Xa.left){Z=sb.row-1;var sa=sb.column-1;Z=J.maa("EvalFormulaRangeOnClone.cell",xa,Z,sa,Z,sa);sa=sb.text;ua.push(excelOnlineCalc.calc.rangeWrite(Z,excelOnlineCalc.calc.valueCellData(sa,sa,sb.Ek,null)))}}Xa=excelOnlineCalc.calc.cellLocation(Xa.top-1,Xa.left-1);la=J.maa("EvalFormulaRangeOnClone.outputColumnRange",xa,la.top-1,la.left-1,la.bottom-1,la.right-1);Za=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(la,
Za,Xa,fa)];ua=this.jr.evalOnClonedModel(ua,Za);this.resumeRecalc();return ua}UJe(Z){let la=null;try{if(Z)if(this.aua=y.h(this.Lc).Ea.Qva(Z),this.currentStateId=Z.iUa,this.currentStateId<this.Qt||this.currentStateId===e.a.pe)c.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.aua} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Qt}`);else{if(this.Lhi(),!this.nWg())if(la=this.Lc.Jb.Ac("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.aua} StateId:${this.currentStateId}`),
this.ctb=this.Lxb(Z.na.sheetName),!this.ctb){const fa=!!(this.Lc.rd&32),ua=this.Xe.lb(this.currentStateId)&&this.Xe.oa(this.currentStateId).Pj?this.Xe.oa(this.currentStateId).Pj.length:0;c.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ua}, scratchPad:${fa}, sheetNameLength:${Z.na.sheetName?Z.na.sheetName.length:-1} Hash:${Z.na.hash}`)}else if(y.h(this.Lc).Ea.Fm.L2a(Z.Cd)){var Xa=Z.rf;if(Xa){var Za=Xa.getCalcBlockModel();
if(!Za)c.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.fWg(Za)){this.Xe.oa(this.currentStateId).B0a[this.aua]=new F(Za,Z.na.sheetName);var xa=Z.je;xa?this.FJg(xa.NamedObjects):c.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else c.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.aua}`)}}else c.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{la&&la.stop()}}E5a(Z){if(!this.Xe.oa(this.currentStateId).Pj||!this.Xe.oa(this.currentStateId).Pj[0])return null;var la=this.Xe.oa(this.currentStateId).Pj[0].A6;if(!la||!la.lb(Z.name))return null;Z=la.oa(Z.name);if(!Z||!Z.eF)return null;la=new d.a;for(let Xa of Z.eF.Y$)la.add(Xa.value);return la}k0g(Z,la,Xa){var Za=y.h(this.Lc),xa=Za.Sb(la);xa=this.r2d(xa,null,"CopyPaste");Xa=this.r2d(Za.Sb(Z),Xa,"CopyPaste");
if(0>xa||0>Xa||xa!==Xa)c.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${Xa}, targetRevision:${xa}.`);else{Xa=[];Za=v.d(this.Lc.xa.na);var fa=this.Wjd(Za);Z=J.maa("CalculateFormulaForCopyPaste.srcRange",Za,Z.top-1,Z.left-1,Z.bottom-1,Z.right-1);la=J.maa("CalculateFormulaForCopyPaste.targetRange",Za,la.top-1,la.left-1,la.bottom-1,la.right-1);la=excelOnlineCalc.calc.copyPasteRangePasteEdit(la,Z,fa);Xa.push(la);la=fa?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
Za,xa,fa.row,fa.column,fa.lastRow,fa.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Za,xa,"","","","");c.ULS.sendTraceTag(537170142,0,50,la);this.jr.editRangePaste(xa,Xa);this.resumeRecalc()}}Wjd(Z){const la=this.Q8e();let Xa=null;la?Xa=J.maa("GetViewport.viewport",Z,la.top-1,la.left-1,la.bottom-1,la.right-1):c.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");
return Xa}Q8e(){const Z=y.h(this.Lc);let la=Z.ui;if(y.h(this.Lc).ib.tj){la=Z.Af(1).ui;if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!la)return c.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;la.lea(1,1);la.lea(3,1)}return la}r2d(Z,la,Xa){let Za;if(!this.jr||!Z)return c.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.jr}, modifiedCell is null:${!Z}, operation:${Xa}`),
-1;const xa=Z.cell.$Q-1,fa=Z.cell.ZQ-1;if(Z.cell.py){if(Za=Z.cell.py.bye,Za===e.a.pe)return c.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${Z.cell.py.Cd}, operation:${Xa}`),-1}else return c.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${Z.cell.$Q},${Z.cell.ZQ}), operation:${Xa}`),-1;if(Za<this.Qt)return c.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${xa},${fa}) - blockRevision:${Za} < lastUpdatedStateId:${this.Qt}, operation:${Xa}`),
-1;if(Za<this.currentStateId)return c.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${xa},${fa}) - blockRevision:${Za} < currentStateId:${this.currentStateId}, operation:${Xa}`),-1;la&&!this.tEd&&(this.jr.setOnRecalcResults(la),this.tEd=!0);return this.iYj()&&!this.lQb(2)?(c.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${Xa}`),-1):Za}getFormulaBarText(Z,la,Xa){return la&&la.startsWith("'")?
la:Z.cell.formulaBarText||Xa.toString()}Zfh(Z,la,Xa){let Za=null;if(this.DAe()&&this.Xe.oa(this.Qt).B0a){const xa=this.Xe.oa(this.Qt).B0a[Z];if(null===xa||void 0===xa?0:xa.Fxc)Za=xa.Rze}Xa=this.tmi(Za,la,Xa);la=this.V7g(Za,la,Xa);c.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${Z} StateId:${this.currentStateId} number of formulas ${la}`)}tmi(Z,la,Xa){let Za=!1;const xa=J.M0e(la);if(Z){const fa=J.M0e(Z);A.a.equals(fa,xa,!1)&&(Za=!0)}Za?this.jKg(Z,
this.Qt,Xa):this.lKg(la,Xa);return Za}DAe(){let Z=!1;this.jr&&-1!==this.Qt&&(Z=this.jr.stateIdAvailable(this.Qt));return Z&&this.Xe.lb(this.Qt)&&this.Qt<this.currentStateId}V7g(Z,la,Xa){let Za;Za=0;let xa,fa;for(la.reset();xa=la.getNextCell();)x.f(xa.formula)&&Za++,(fa=Xa?Z.getCell(xa.row,xa.col):null)?this.R7g(la,xa,fa):this.kKg(la,xa);if(Xa)for(Z.reset();fa=Z.getNextCell();)(xa=la.getCell(fa.row,fa.col))||this.kqe(Z,fa);return Za}cAj(){this.jr.setOnUpdateRequest(()=>{})}bAj(){this.jr.setOnUnresponsive((Z,
la,Xa,Za)=>{this.G0i(Z,la,Xa,Za)})}G0i(Z,la,Xa,Za){c.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${Z}, waitTime:${la}, timeoutCount:${Xa}, hasBeenClosed:${Za}.`);Za&&(this.Soj(),this.ipa())}Soj(){this.ed(null,null);this.vwd=this.tEd=!1;this.$Hd=0;this.SHd=this.UHd=this.VHd=this.THd=-1}close(){this.jr.close()}clearCache(){this.jr.clearCache()}resumeRecalc(){this.jr.resumeRecalc()}rzj(){this.jr.setA1ReferenceStyle(!0)}zdj(){if(this.instantaneousSupportInformationManager){var Z=
this.instantaneousSupportInformationManager.Lji;const Xa=this.instantaneousSupportInformationManager.Oji,Za=this.instantaneousSupportInformationManager.Nji,xa=this.instantaneousSupportInformationManager.Mji;var la=!1;Z!==this.THd&&(la=!0,this.THd=Z);Xa!==this.VHd&&(la=!0,this.VHd=Xa);Za!==this.UHd&&(la=!0,this.UHd=Za);xa!==this.SHd&&(la=!0,this.SHd=xa);const fa=[];n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(la=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),fa.push(la),la=!0);n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(la=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),fa.push(la),la=!0);n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(la=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),fa.push(la),la=!0);la&&(Z=excelOnlineCalc.calc.recalcServiceConfig(null,Z,null,Xa,null,null,null,Za,fa,xa),this.jr.reconfigure(Z))}}ZBj(Z){let la=
null;if(this.Xe.lb(this.currentStateId))try{this.qaa=[],la=this.Lc.Jb.Ac("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${H[Z]}`),f.a.forEach(this.Xe.oa(this.currentStateId).B0a,(Xa,Za)=>{Za.Fxc||(this.Zfh(Xa,Za.Rze,Za.sheetName),Za.Fxc=!0)},null),this.jr.updateRanges(this.currentStateId,this.qaa)}finally{la&&la.stop()}else c.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}YBj(){const Z=
[],la=this.DAe();var Xa=la&&this.Xe.oa(this.Qt).Pj&&this.Xe.oa(this.Qt).Pj[0]&&this.Xe.oa(this.Qt).Pj[0].Inc?this.Xe.oa(this.Qt).Pj[0].A6:null;this.BFe(Xa,this.Xe.oa(this.currentStateId).Pj[0].A6,null,this.Qt,Z);this.Xe.oa(this.currentStateId).Pj[0].Inc=!0;for(let Za=1;Za<this.Xe.oa(this.currentStateId).Pj.length;Za++)Xa=-1,la&&this.Xe.oa(this.Qt).Pj&&(Xa=this.ajd(this.Xe.oa(this.currentStateId).Pj[Za].Y7.sheetName,this.Qt)),Xa=-1!==Xa&&this.Xe.oa(this.Qt).Pj[Xa].Inc?this.Xe.oa(this.Qt).Pj[Xa].A6:
null,this.BFe(Xa,this.Xe.oa(this.currentStateId).Pj[Za].A6,this.Xe.oa(this.currentStateId).Pj[Za].Y7.sheetId,this.Qt,Z),this.Xe.oa(this.currentStateId).Pj[Za].Inc=!0;this.jr.updateNamedObjects(this.currentStateId,Z)}BFe(Z,la,Xa,Za,xa){if(void 0!==Xa&&null!==Xa){var fa=excelOnlineCalc.calc.undefinedNamesWrite(Xa);xa.push(fa)}if(Z){var ua=!1;fa=[];var sa=[];if(la)for(let hb of la){const bb=hb.value;if(Z.lb(hb.key)){var sb=Z.oa(hb.key);J.cLi(sb,bb)?ua=!0:(sb=excelOnlineCalc.calc.namedObject(hb.key,null),
fa.push(sb),J.LWc(hb.key,bb,sa))}else J.LWc(hb.key,bb,sa)}for(let hb of Z)la&&la.lb(hb.key)||(Z=excelOnlineCalc.calc.namedObject(hb.key,null),fa.push(Z));ua&&(la=excelOnlineCalc.calc.namedObjectsPromote(Xa,Za),xa.push(la));0<fa.length&&(la=excelOnlineCalc.calc.namedObjectsWrite(Xa,fa),xa.push(la));0<sa.length&&(Xa=excelOnlineCalc.calc.namedObjectsWrite(Xa,sa),xa.push(Xa))}else if(la){Za=[];for(sa of la)J.LWc(sa.key,sa.value,Za);0<Za.length&&(Xa=excelOnlineCalc.calc.namedObjectsWrite(Xa,Za),xa.push(Xa))}}nWg(){return this.Xe.oa(this.currentStateId).B0a[this.aua]?
(c.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.aua} StateId:${this.currentStateId} previously handled`),!0):!1}fWg(Z){return 1===Z.getColumnNumbers().length&&Z.getColumnNumbers()[0]===J.Xyd+1?!1:!0}Fhi(){let Z=!1;y.h(this.Lc).Ea.Nvb(la=>{la.state&1&&this.Lc.ea.ye===la.oe.Revision&&(this.UJe(la),Z=!0)});return Z}NHe(Z,la){var Xa=Z.getRowNumbers(),Za=Z.getColumnNumbers();Z=Xa[0]-1;Xa=Xa[Xa.length-1]-1;const xa=Za[0]-1;Za=Za[Za.length-1]-1;la=this.Lxb(la);
if(!la){const fa=this.Xe.lb(this.currentStateId)&&this.Xe.oa(this.currentStateId).Pj?this.Xe.oa(this.currentStateId).Pj.length:0;c.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${fa}`)}return J.maa("CreateBlockRangeLocation",la,Z,xa,Xa,Za)}jKg(Z,la,Xa){if(Xa=this.NHe(Z,Xa)){var Za=J.n6b(Z.getRowNumbers());Z=J.n6b(Z.getColumnNumbers());la=excelOnlineCalc.calc.rangePromote(Xa,la,Za,Z);this.qaa[this.qaa.length]=la}}lKg(Z,la){if(la=
this.NHe(Z,la)){var Xa=J.n6b(Z.getRowNumbers());Z=J.n6b(Z.getColumnNumbers());Z=excelOnlineCalc.calc.rangeWrite(la,null,Xa,Z);this.qaa[this.qaa.length]=Z}}R7g(Z,la,Xa){let Za=null,xa=0,fa=0;switch(la.valueType){case 2:Za=this.Tjd(la);var ua=this.Tjd(Xa);ua=A.a.equals(ua,Za,!1);break;case 1:null===la.value&&null===Xa.value?ua=!0:(xa=parseFloat(la.value),ua=parseFloat(Xa.value)===xa);break;default:null===la.value&&null===Xa.value?ua=!0:(fa=parseFloat(la.value),ua=fa===parseFloat(Xa.value))}ua&&la.valueType===
Xa.valueType&&la.ifmt===Xa.ifmt&&la.formulaType===Xa.formulaType&&A.a.equals(Xa.formula,la.formula,!1)||(void 0!==la.formula&&null!==la.formula||void 0!==la.value&&null!==la.value||void 0!==la.text&&null!==la.text?this.M_b(Z,la,Za,xa,fa):this.kqe(Z,la))}FJg(Z){if(this.Lc.Cb&&this.Lc.Cb.items)for(let fa=0;fa<this.Lc.Cb.count;fa++){var la=this.Lc.Cb.items[fa];if(2!==la.type&&3!==la.type)continue;var Xa=0,Za=la.name,xa=Za.lastIndexOf("!");if(0<xa){Xa=Za.substr(0,xa);"'"===Xa.charAt(0)&&(Xa=Xa.substr(1,
Xa.length-2));Xa=this.ajd(Xa,this.currentStateId);if(-1===Xa){la=this.Xe.lb(this.currentStateId)&&this.Xe.oa(this.currentStateId).Pj?this.Xe.oa(this.currentStateId).Pj.length:0;c.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${la}`);continue}Za=Za.substr(xa+1)}Xa=this.Xe.oa(this.currentStateId).Pj[Xa].A6;let ua=la.usedRange;2===la.type&&(ua=z.a(la));if(Xa.lb(Za)){if(xa=Xa.oa(Za),xa.range=ua,xa.attributes=la.attributes,2===xa.type&&
(Za=J.QXe(la.name,Z),la=(Xa=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?la.WO:null===Za||void 0===Za?void 0:Za.ColHeadersList,Za||Xa))if(!xa.eF)xa.eF=new r(la);else if(la)for(const sa of la.HeadersList)xa.eF.Y$.ia(sa.Index,sa.Name)}else if(xa=this.Lxb(la.sheetName)){xa=new I(la.type,la.name,ua,xa,la.attributes);if(2===xa.type)if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&la.WO)xa.eF=new r(la.WO);else if(la=J.QXe(la.name,
Z))xa.eF=new r(la.ColHeadersList);Xa.ia(Za,xa)}else la=this.Xe.lb(this.currentStateId)&&this.Xe.oa(this.currentStateId).Pj?this.Xe.oa(this.currentStateId).Pj.length:0,c.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${la}`)}}M_b(Z,la,Xa,Za,xa){var fa=Z.getRowNumbers()[la.row]-1;Z=Z.getColumnNumbers()[la.col]-1;fa=J.maa("AddRangeUpdateCommand",this.ctb,fa,Z,fa,Z);Z=null;let ua=la.formula||la.text;const sa=excelOnlineCalc.calc.blankValue;
let sb=null;void 0!==la.text&&null!==la.text||void 0!==la.value&&null!==la.value||(Xa="",sb="This cell contains blanks only",0===la.formulaType&&(ua=""));switch(la.valueType){case 2:null!==Xa&&(0===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData(ua,Xa,la.ifmt,sb)),1===la.formulaType&&(Z=excelOnlineCalc.calc.cellFormulaCellData(ua,Xa,la.ifmt,sb)),2===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData("",sa,0,"This cell is a part of an array")));break;case 1:isNaN(Za)?c.ULS.sendTraceTag(537170116,
0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${la.row},${la.col}) invalid numeric value`):(0===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData(ua,Za,la.ifmt,null)),1===la.formulaType&&(Z=excelOnlineCalc.calc.cellFormulaCellData(ua,Za,la.ifmt,null)),2===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData("",sa,0,"This cell is a part of an array")));break;case 3:isNaN(xa)?c.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${la.row},${la.col}) invalid boolean value`):
(Xa=1===xa?!0:!1,0===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData(ua,Xa,la.ifmt,null)),1===la.formulaType&&(Z=excelOnlineCalc.calc.cellFormulaCellData(ua,Xa,la.ifmt,null)),2===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData("",sa,0,"This cell is a part of an array")));break;case 4:isNaN(xa)?c.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${la.row},${la.col}) invalid error value`):(Xa=excelOnlineCalc.calc.errorValue(xa),0===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData(ua,
Xa,la.ifmt,null)),1===la.formulaType&&(Z=excelOnlineCalc.calc.cellFormulaCellData(ua,Xa,la.ifmt,null)),2===la.formulaType&&(Z=excelOnlineCalc.calc.valueCellData("",sa,0,"This cell is a part of an array")));break;default:Z=excelOnlineCalc.calc.valueCellData("",sa,la.ifmt,null)}Z&&(la=excelOnlineCalc.calc.rangeWrite(fa,Z,null,null),this.qaa[this.qaa.length]=la)}kKg(Z,la){switch(la.valueType){case 2:this.M_b(Z,la,this.Tjd(la),null,0);break;case 1:this.M_b(Z,la,null,parseFloat(la.value),0);break;default:this.M_b(Z,
la,null,null,parseFloat(la.value))}}kqe(Z,la){var Xa=Z.getRowNumbers()[la.row]-1;Z=Z.getColumnNumbers()[la.col]-1;Xa=J.maa("AddRangeUpdateCommandEmptyCell",this.ctb,Xa,Z,Xa,Z);la=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,la.ifmt,null);la=excelOnlineCalc.calc.rangeWrite(Xa,la,null,null);this.qaa[this.qaa.length]=la}Lxb(Z){Z=this.ajd(Z,this.currentStateId);return 0<Z?this.Xe.oa(this.currentStateId).Pj[Z].Y7.sheetId:null}ajd(Z,la){if(!this.Xe.lb(la))return c.ULS.sendTraceTag(537170113,
0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${la} does not exist in GridCache`),-1;const Xa=this.Xe.oa(la);return Xa.Pj?Xa.getSheetIndex(Z):(c.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${la}`),-1)}wBj(){if(!this.Xe.lb(this.currentStateId)||!this.Xe.oa(this.currentStateId).Pj.length)return c.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const Z=[];for(let la=1;la<this.Xe.oa(this.currentStateId).Pj.length;la++){const Xa=this.Xe.oa(this.currentStateId).Pj[la];Xa&&Z.push(Xa.Y7)}this.jr.updateSheetNames(this.currentStateId,Z);this.jr.updateUnusedCells(this.currentStateId,this.Xe.oa(this.currentStateId).whg);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var Z=[];for(const la of this.instantaneousSupportInformationManager.hza){const Xa=excelOnlineCalc.calc.numberFormat(la.IfmtIndex,la.FormatString,la.Builtin);
Z.push(Xa)}this.jr.setNumberFormats(Z,!0)}}Sxj(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Je){var Z=this.Jhi();if(!this.vwd||Z)this.m6b(),this.instantaneousSupportInformationManager.Je.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Je.TrueValueString),this.instantaneousSupportInformationManager.Je.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Je.FalseValueString),Z=C.CalcHelper.JIe(this.instantaneousSupportInformationManager,
Z),this.jr.setLocale(Z),this.vwd=!0}}kCj(){var Z=null;if(void 0!==this.Lc.workbookContext.TimeZoneInformation&&null!==this.Lc.workbookContext.TimeZoneInformation){Z=null;this.Lc.workbookContext.TimeZoneInformation.StandardDate.Month&&(Z=excelOnlineCalc.date.dateTime(this.Lc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.Lc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Lc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Lc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let la=null;this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(la=excelOnlineCalc.date.dateTime(this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Lc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));Z=excelOnlineCalc.date.tzData(this.Lc.workbookContext.TimeZoneInformation.Bias,Z,this.Lc.workbookContext.TimeZoneInformation.StandardBias,
la,this.Lc.workbookContext.TimeZoneInformation.DaylightBias)}else c.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");Z=excelOnlineCalc.calc.workbookProps(this.Lc.workbookContext.F1904,this.Lc.workbookContext.FDateCompatibility,Z);this.jr.setWorkbookProps(Z)}ipa(){n.EwaSettings.ma(301)&&l.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.y$f,!0)).continueWith(Za=>{Za.exception?c.ULS.sendTraceTag(537170079,0,15,`CalcAsyncEngine.TryInitialize: calc smoke test failed: ${Za.exception.toString()}`):
c.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});const Z=n.EwaSettings.ma(646)?t.local:t.qRj,[la,Xa]=w.a.EV(this.Lc)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.kKd=l.c(excelOnlineCalc.calc.createRecalcService(Z,la,Xa));this.kKd.continueWith(Za=>{Za.exception?c.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Za.exception.toString()}`):
(c.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.jr=this.kKd.result)?this.lQb(0)?this.bAj():c.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):c.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Jhi(){const Z=this.instantaneousSupportInformationManager.Pja;if(!Z||this.$Hd===Z.length)return null;this.$Hd=Z.length;return C.CalcHelper.vIe(Z)}m6b(){this.errorTypeNames=
C.CalcHelper.m6b()}Lhi(){if(!(this.Xe.lb(this.currentStateId)&&0<this.Xe.oa(this.currentStateId).Pj.length)){this.Xe.ia(this.currentStateId,new L(this.Xqd));this.Xe.oa(this.currentStateId).n5f(0,new G(null));var Z=this.Lc.xa;for(let Za=0;Za<Z.count;Za++){var la=Object(h.a)(B.a,Z.getItem(Za));if(la){void 0!==la.sheetId&&null!==la.sheetId&&void 0!==la.name&&null!==la.name&&la.sheetId.length&&la.sheetName.length||c.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Za} Id:${la.sheetId} Hash:${la.hash} NameLength:${la.name?
la.name.length:-1}`);var Xa=void 0;Xa=excelOnlineCalc.calc.sheetName(la.sheetId,la.name);this.Xe.oa(this.currentStateId).n5f(Za+1,new G(Xa));Xa=la.usedRange.ES();Xa=excelOnlineCalc.calc.rangeLocation(0,0,Xa.LastRow,Xa.LastColumn);la=excelOnlineCalc.calc.unusedCellsUpdate(la.sheetId,Xa);this.Xe.oa(this.currentStateId).whg.push(la)}else c.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Za}`)}}}x4g(){for(let Z of this.Xe)Z.key<
this.Qt&&this.Xe.remove(Z.key)}Tjd(Z){Z=Z.value||Z.text;if(void 0===Z||null===Z)Z="";return Z}iYj(){if(!this.Xe.lb(this.currentStateId))return!1;let Z=!1;f.a.forEach(this.Xe.oa(this.currentStateId).B0a,(la,Xa)=>{Xa.Fxc||(Z=!0)},null);return Z}f6c(Z){const la={};la.reason=Z;la.kind=1;return la}Zic(){return this.Xe.lb(this.currentStateId)&&this.Xe.oa(this.currentStateId).Pj&&this.Xe.oa(this.currentStateId).Pj[0]&&this.Xe.oa(this.currentStateId).Pj[0].A6?!0:!1}static Ybh(Z){const la=[];if(null===Z||
void 0===Z?0:Z.Y$)for(let Xa of Z.Y$)Z=excelOnlineCalc.calc.columnData(Xa.key,Xa.value),la.push(Z);return la}static cLi(Z,la){if(Z.type!==la.type||Z.attributes!==la.attributes||!A.a.equals(Z.fullName,la.fullName,!1)||!Z.range.equals(la.range))return!1;if(!Z.eF&&!la.eF)return!0;if(!Z.eF||!la.eF||Z.eF.Y$.count!==la.eF.Y$.count)return!1;for(let Xa of Z.eF.Y$){let Za;if(!(Xa.value&&({value:Za}=la.eF.Y$.Dc(Xa.key)).returnValue&&Za&&A.a.equals(Xa.value,Za,!1)))return!1}return!0}static LWc(Z,la,Xa){var Za=
J.maa("NamedObject",la.sheetId,la.range.top-1,la.range.left-1,la.range.bottom-1,la.range.right-1);if(2===la.type){const xa=!!(la.attributes&16),fa=!!(la.attributes&8);la=J.Ybh(la.eF);Za=excelOnlineCalc.calc.namedTableData(Za,xa,fa,la);Z=excelOnlineCalc.calc.namedObject(Z,Za)}else Za=excelOnlineCalc.calc.namedRangeData(Za),Z=excelOnlineCalc.calc.namedObject(Z,Za);Xa.push(Z)}static M0e(Z){const la=Sys.Serialization.JavaScriptSerializer.serialize(Z.getRowNumbers());Z=Sys.Serialization.JavaScriptSerializer.serialize(Z.getColumnNumbers());
return la+Z}static n6b(Z){let la=null;if(1<Z.length)for(let Xa=1;Xa<Z.length;Xa++){let Za=0;for(;Z[Xa-1]+1+Za<Z[Xa];)la=la||[],la.push(Z[Xa-1]+Za),Za++}return la}static QXe(Z,la){if(!la)return null;for(let Xa=0,Za=la.length;Xa<Za;++Xa)if(A.a.equals(Z,la[Xa].Name,!1))return la[Xa];return null}static maa(Z,la,Xa,Za,xa,fa){const ua=(sa,sb,hb,bb)=>{(0>hb||hb>=bb)&&c.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${sa} invalid ${sb}:${hb}`)};void 0!==la&&null!==la||
c.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Z} sheetId is null`);ua(Z,"top",Xa,J.Vuf);ua(Z,"left",Za,J.Xyd);ua(Z,"bottom",xa,J.Vuf);ua(Z,"right",fa,J.Xyd);return excelOnlineCalc.calc.sheetRangeLocation(la,Xa,Za,xa,fa)}}J.Vuf=1048576;J.Xyd=16384;Object(u.a)(J,"CalcAsyncEngine",null,[2]);class M{constructor(){this.FK=this.GK=this.QF=this.RF=this.A_=!1}}Object(u.a)(M,"AbsoluteRelativeReferenceInfo",null,[]);var S=a(979),W=a(24);class O{}O.fNf="#";Object(u.a)(O,
"Operators",null,[]);var T=a(980);class Y{}Y.sheet="Sheet";Y.sheetRange="SheetRange";Y.document="Document";Y.vei="Ident";Object(u.a)(Y,"TraverseFormulaQualifierTypes",null,[]);var va=a(981),ca=a(870),V=a(789),ra=a(42),N=a(55),ea=a(66),Ba=a(288),ka=a(38);class Ka extends Sys.EventArgs{constructor(Z){super();this.Ok=Z}}Object(u.a)(Ka,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);class Oa extends ka.a{constructor(Z){super();this.pu=null;this.Rlg=!1;this.zOd=this.instantaneousSupportInformationManager=
this.DHb=null;this.JBd=new Map;this.ige=null;this.Npc=la=>{c.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");la.wMd(this.Npc);la.Pja.length?this.tpc(la,Sys.EventArgs.Empty):(c.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),la.zre(this.tpc))};this.tpc=la=>{c.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");la.oMd(this.tpc);this.TVj(la)};this.onContentReady=()=>{this.pu&&
(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.God||N.Task.delay(0).continueWith(()=>{this.pu.lQb(1)},0,null,ea.a.current))};this.Lzf=(la,Xa)=>{this.pu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.God||this.pu.UJe(Xa.jd.block))};c.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Bhc=!1;this.jb=Z;this.Aq=y.h(Z);this.gIc=null;this.gridView.mv(this.onContentReady);this.gridView.Ea.jXc(this.Lzf);this.$.da.$a(268,
la=>{la.Je?(c.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.Npc(la,Sys.EventArgs.Empty)):(c.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),la.Wre(this.Npc))})}zMg(Z){this.addHandler(Oa.Z9c,Z)}vjj(Z){this.removeHandler(Oa.Z9c,Z)}Cxf(Z){this.raiseEvent(Oa.Z9c,new Ka(Z))}get gs(){return this.gIc}get gridView(){return this.Aq}get $(){return this.jb}get MB(){return this.ige}get localeInfo(){return this.gs?this.gs.config.localeInfo:
null}get config(){return this.gs.config}dispose(){c.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.$a(268,Z=>{Z.wMd(this.Npc);Z.oMd(this.tpc)});this.gridView&&(this.gridView.Oy(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.dVf(this.Lzf),this.Aq=null);this.gIc=null;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.Bhc=!1)}l0g(Z,la,Xa,Za=null){return this.pu?this.pu.j0g(Z,la,Xa,Za):!1}evalFormula(Z,la,Xa,Za){return this.pu?
this.pu.evalFormula(Z,la,Xa,Za):Promise.reject("calc engine not initialized")}Kub(Z,la,Xa,Za){return this.pu?this.pu.Kub(Z,la,Xa,Za):Promise.reject("CalcEngine is null")}E5a(Z){return this.pu?(c.ULS.shipAssertTag(537170059,0,2===Z.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.pu.E5a(Z)):null}LQg(Z,la){if(!la||2!==Z.type)return!1;Z=z.a(Z);return Z.right-Z.left+1===la.count}DWe(Z,la){if(!this.DHb)return this.Rlg||c.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var Xa=this.Ota(W.Range.Qc(1,1));Xa=this.DHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Xa.range),Z);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Xa))return c.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let Za;if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const xa=null!==la&&void 0!==la?la:this.gridView.ha.ra.activeCell,fa=excelOnlineCalc.location.gridCell(xa.top-
1,xa.left-1),ua=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),sa=excelOnlineCalc.location.sheetIndex(ua,this.$.xa.na.sheetId),sb=this.ugh(fa,sa);this.zOd||(this.zOd=excelOnlineCalc.util.createResolver(this.tgh()));Za=excelOnlineCalc.parse.parseResultHelper.extractReferences(Xa,this.gs.config.localeInfo,n.EwaSettings.ma(583),sb,this.zOd)}else Za=excelOnlineCalc.parse.parseResultHelper.extractReferences(Xa,this.gs.config.localeInfo,n.EwaSettings.ma(583));
n.EwaSettings.ma(102)&&this.A0j(Za,Z);return Za}catch(Za){return c.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Za.message}`),null}}extractLetVariables(Z,la){if(!this.DHb)return this.Rlg||c.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const Xa=this.Ota(W.Range.Qc(1,1));Z=this.DHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,Xa.range),Z);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Z))return c.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(Z,la,this.gs.config.localeInfo)}catch(Za){return c.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Za.message}`),null}}extractReferences(Z,la,Xa,Za,xa){if(!la)return c.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!Xa)return c.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;xa=this.DWe(Z,xa);if(!xa)return c.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.rfh(xa,la,Xa,Z,Za)}catch(fa){return c.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${fa.message}`),null}}Q4h(Z,la,Xa,Za){if(!Z)return c.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!la||0>=la.length)return c.ULS.sendTraceTag(537170018,
0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;Z=this.Ota(Z);if(!this.gs||!Z)return null;const xa=this.vwb(Z).returnValue;if(!xa||xa.p7a)return null;Xa=excelOnline.utils.getCharIndexInTextFromPoint(Xa,Za,n.EwaSettings.ma(583));return 0>Xa?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.gs.config,Xa,la,Z)}$_g(Z,la,Xa,Za){if(!Z)return c.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),
null;let xa=null;return this.evalFormula(la,Z,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(fa=>{let ua;const sa=({kind:ua}=this.gs.fuh(fa,Xa)).returnValue;8!==ua||sa.length&&sa!==C.CalcHelper.unknownError?fa=0:(c.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),fa=excelOnlineCalc.calc.getEvalFailureReason(fa),void 0!==fa&&null!==fa||c.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),
fa=1);return xa=Za?new S.a(sa,Za.start,Za.end,fa):new S.a(sa,-1,-1,fa)},fa=>{c.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${fa}`);return Promise.resolve(xa)})}getSubExpressionSpan(Z){return this.gs&&Z?excelOnlineCalc.runtime.getSubExpressionSpan(Z):null}getFormulaSubExpressionObject(Z,la,Xa){return this.gs&&Z&&la&&Xa?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.gs.config,la,Xa,this.Ota(Z)):null}T4h(Z,la,Xa){return this.gs&&Z&&la?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.gs.config,
la,Xa,this.Ota(Z)):null}R4h(Z,la,Xa){return this.gs&&Z&&la?excelOnlineCalc.runtime.getSubExpressionSubspans(this.gs.config.localeInfo,la,Xa):null}YYh(){return this.gs?this.gs.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(Z){return this.gs?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.gs.config.localeInfo,Z):!1}Ota(Z,la=!0){return Z&&this.gs?this.gs.Rgh(this.gs.Fih(),Z.top-1,Z.left-1,la):null}Mif(Z,la){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7173486_IsFormulaCellRefactor")){Z=
this.oxb(Z);if(!Object(Ba.c)(Z))return null;la=this.MB.parseEdit(la,Z.value);return excelOnlineCalc.util.isSuccess(la)?la.value.kind===ca.a.formula:null}Z=this.rdc(Z);if(void 0===Z||null===Z)return null;Z=this.MB.createFormat(Z.FormatString,Z.Builtin);if(!excelOnlineCalc.util.isSuccess(Z))return null;la=this.MB.parseEdit(la,Z.value);return excelOnlineCalc.util.isSuccess(la)?la.value.kind===ca.a.formula:null}oxb(Z){if(null==this.MB)return Object(Ba.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(Ba.a)("Instantaneous manager is null");
if(this.JBd.has(Z))return Object(Ba.d)(this.JBd.get(Z));if("number"===typeof Z){var la=this.rdc(Z);if(null==la)return Object(Ba.a)(`Invalid ifmt=${Z}`);var Xa=la.FormatString;la=la.Builtin}else Xa=Z,la=!1;Xa=this.MB.createFormat(Xa,la);return excelOnlineCalc.util.isSuccess(Xa)?(this.JBd.set(Z,Xa.value),Object(Ba.d)(Xa.value)):Object(Ba.a)("Could not create number format")}getWorksheetFuncId(Z){return this.localeInfo.getWorksheetFuncId(Z)}rfh(Z,la,Xa,Za,xa){const fa={Items:[]};for(let hb=0;hb<Z.length;hb++){var ua=
Z[hb];const bb={};bb.Start=ua.span.start;bb.End=ua.span.end;if(xa||ua.kind!==T.a.func)if(xa||ua.kind!==T.a.nAi){if(!this.uph(ua,la,Xa))continue;var sa=new M;const lb=this.O1h(ua,la,sa,Za);if(n.EwaSettings.ma(583)){var sb=this.PYh(ua);const Fa=this.OYh(ua);if(lb||Fa&&0<=sb){let Na={};Na.Span=bb;Na.LetNumber=sb;Na.LetName=Fa;Na.Range=lb;Na.IsRangeRef=sa.A_;Na.IsAbsoluteFirstRow=sa.RF;Na.IsAbsoluteFirstColumn=sa.QF;Na.IsAbsoluteSecondRow=sa.GK;Na.IsAbsoluteSecondColumn=sa.FK;Na.IsStructRef=ua.kind===
T.a.OXd;fa.Items.push(Na)}}else lb&&(sb={},sb.Span=bb,sb.Range=lb,sb.IsRangeRef=sa.A_,sb.IsAbsoluteFirstRow=sa.RF,sb.IsAbsoluteFirstColumn=sa.QF,sb.IsAbsoluteSecondRow=sa.GK,sb.IsAbsoluteSecondColumn=sa.FK,sb.IsStructRef=ua.kind===T.a.OXd,fa.Items.push(sb))}else ua=ua.ref.value.oper.kind,sa={},sa.Span=bb,sa.IsString=2===ua,sa.IsBoolean=4===ua,sa.IsNumber=1===ua,fa.Items.push(sa);else bb.End=ua.span.start+ua.ref.name.length,ua={},ua.Span=bb,ua.IsFunction=!0,ua.FunctionId=this.getWorksheetFuncId(Za.substring(bb.Start,
bb.End)),fa.Items.push(ua)}fa.Items.sort((hb,bb)=>hb.Span.Start-bb.Span.Start);return fa}PYh(Z){return Z.kind===T.a.Mpf?Z.ref.number:-1}OYh(Z){return Z.kind===T.a.Mpf?Z.ref.name:null}O1h(Z,la,Xa,Za){if(Z.kind===T.a.range)return Xa.A_=!0,this.JGe(Z,la,Xa,Za);if(Z.kind===T.a.namedRange){Xa=Z.ref;(Z=this.$.Cb.getItemByName(Xa.name))||(Z=this.$.Cb.getItemByName(la+"!"+Xa.name));if(!(Z&&Z.sheetName&&Z.usedRange&&A.a.equals(Z.sheetName,la,!0)))return null;la=2===Z.type?z.a(Z):Z.usedRange;return ra.m(la,
Z)}if(Z.kind===T.a.OXd){let xa=Z.ref,fa;xa.name?(fa=this.$.Cb.getItemByName(xa.name))||(fa=this.$.Cb.getItemByName(la+"!"+xa.name)):fa=this.gridView.Bb.Bj(this.gridView.ha.ra.activeCell);if(!(fa&&fa.sheetName&&fa.usedRange&&A.a.equals(fa.sheetName,la,!0)))return null;Xa.A_=!1;return this.JGe(Z,la,Xa,Za)}return null}JGe(Z,la,Xa,Za){Z=Z.ref;if(Z.type){if(Z.type===va.a.column){var xa=Z.startIndex;Z=Z.endIndex;Xa.QF=xa.kind===V.a.abs;Xa.FK=Z.kind===V.a.abs;return this.createRange(0,xa.index,e.a.eh,Z.index,
la)}if(Z.type===va.a.row)return xa=Z.endIndex,Xa.RF=Z.startIndex.kind===V.a.abs,Xa.GK=xa.kind===V.a.abs,this.createRange(Z.startIndex.index,0,Z.endIndex.index,e.a.qh,la);if(Z.type===va.a.cell){xa=Z.row;var fa=Z.col;Xa.RF=Xa.GK=xa.kind===V.a.abs;Xa.QF=Xa.FK=fa.kind===V.a.abs;return this.J3b(Z.span.end,Za)&&(Xa=W.Range.Qc(xa.index+1,fa.index+1),Xa=this.gridView.Bb.F7e(Xa))?ra.n(Xa,la):this.createRange(xa.index,fa.index,xa.index,fa.index,la)}if(Z.type===va.a.range){xa=Z.top;fa=Z.left;Za=Z.bottom;Z=Z.right;
const ua=Math.min(xa.index,Za.index),sa=Math.min(fa.index,Z.index),sb=Math.max(xa.index,Za.index),hb=Math.max(fa.index,Z.index);Xa.RF=xa.kind===V.a.abs;Xa.GK=Za.kind===V.a.abs;Xa.QF=fa.kind===V.a.abs;Xa.FK=Z.kind===V.a.abs;return this.createRange(ua,sa,sb,hb,la)}c.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${Z.type}'`);return null}c.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}J3b(Z,
la){return la.length>=Z&&0<Z&&la.charAt(Z-1)===O.fNf}g0g(Z,la,Xa){this.pu&&this.pu.k0g(Z,la,Xa)}rdc(Z){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.hza&&this.instantaneousSupportInformationManager.hza[Z]&&this.MB?this.instantaneousSupportInformationManager.hza[Z]:null}toXLNumber(Z){if(!this.MB)return null;Z=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.MB,Z);return excelOnlineCalc.util.isSuccess(Z)?Z.value:null}A0j(Z,la){if(Z)for(const Xa of Z)Xa.ref.type&&
Xa.ref.type===va.a.cell&&(Z=Xa.ref,Oa.q7i(Z,la)&&(Z.span.end+=1,Xa.span.end+=1))}createRange(Z,la,Xa,Za,xa){const fa={};fa.FirstRow=Z;fa.FirstColumn=la;fa.LastRow=Xa;fa.LastColumn=Za;fa.SheetName=xa;return fa}uph(Z,la,Xa){var Za=Z.ref.qualifier;if(!Za)return!0;switch(Z.ref.qualifier.type){case Y.sheet:return Z=Za.document,A.a.equals(Za.sheet,la,!0)&&(!Z||A.a.equals(Z.document,Xa,!0));case Y.sheetRange:return la=this.$.xa.getItemByName(la),Xa=this.$.xa.getItemByName(Za.sheet1),Za=this.$.xa.getItemByName(Za.sheet2),
!!la&&!!Xa&&!!Za&&(Xa.index<=la.index&&la.index<=Za.index||Za.index<=la.index&&la.index<=Xa.index);case Y.document:return A.a.equals(Za.document,Xa,!0);case Y.vei:return Za=Za.name,A.a.equals(Za,la,!0)||A.a.equals(Za,Xa,!0);default:return c.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Za.type}'`),!1}}TVj(Z){this.instantaneousSupportInformationManager=Z;Z.hza.length&&Z.Pja.length?(this.gIc=new C.CalcHelper(this.gridView.$),this.DHb=this.gs.createParser(),
this.ige=this.gs.createNumberFormatter(),this.Bhc=!0,c.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.pu||(c.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.pu=new J(this.$))):c.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${Z.hza.length}, functions info count = ${Z.Pja.length}`)}vwb(Z){if(!Z)return{returnValue:null,
emptyCell:!1};var la=this.getSheetName(Z.sheet.index);if(!la)return c.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${Z.sheet.index}`),{returnValue:null,emptyCell:!1};const Xa=Oa.convertToRange(Z);la=this.gridView.vwb(la,Xa.top,Xa.left);return la?la.pph?{returnValue:la,emptyCell:!1}:(c.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${Z.range.row} ${Z.range.col} is empty`),{returnValue:null,emptyCell:!0}):(c.ULS.sendTraceTag(537169997,
0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${Z.range.row} ${Z.range.col}`),{returnValue:null,emptyCell:!1})}getSheetName(Z){const la=this.gridView.$.xa.getItem(Z);return la?la.sheetName:(c.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${Z}`),null)}ugh(Z,la){const Xa={allowUnqualifiedCell:!0,wrapCellReferences:!0};Xa.config=this.gs.config;Xa.originGridCell=excelOnlineCalc.util.success(Z);Xa.originSheet=excelOnlineCalc.util.success(la);return Xa}tgh(){const Z=
{};Z.config=this.gs.config;Z.getNameLoc=this.pu.getNameLoc;Z.getContainingTable=this.pu.getContainingTable;Z.getStructRefColumn=this.pu.getStructRefColumn;Z.getStructRefSpecialRef=this.pu.getStructRefSpecialRef;Z.getDocumentLoc=this.pu.getDocumentLoc;Z.getSheetIndex=this.pu.getSheetIndex;Z.getSheetName=this.pu.getSheetName;Z.getUserDefinedFuncLoc=this.pu.getUserDefinedFuncLoc;Z.getSheetRangeIndexes=this.pu.getSheetRangeIndexes;return Z}static q7i(Z,la){return la.length>Z.span.end&&la.charAt(Z.span.end)===
O.fNf}static convertToRange(Z){return W.Range.Qc(Z.range.row+1,Z.range.col+1)}}Oa.Z9c="ECRC";Object(u.a)(Oa,"CalcManager",ka.a,[358,2]);var wa=a(37),qa=a(53);class aa extends b.a{constructor(Z){super();this.$=Z;this.Fb()}create(){if(this.$){c.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var Z=76;var la="Current"}else Z=79,la="Stable";c.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${la} JS was loaded`);
wa.TaskExtensions.Aa(qa.a.loadScript(Z,4,this.Ya,void 0,void 0,265),()=>{c.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let Xa=this.$.da.za(266,!1);Xa||(c.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),Xa=new Oa(this.$),this.$.da.Ga(266,Xa));this.ob(Xa)},this.la,3)}else c.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(Z){Z&&
Z.da&&Z.da.Ga(265,new aa(Z))}}Object(u.a)(aa,"CalcManagerFactory",b.a,[]);var ia=a(9);a.d(D,"a",function(){return Ha});const Ha=()=>{ia.a.Fa(aa.ka)}},1206:function(u,D,a){var c=a(9);u=a(0);var b=a(15),e=a(222),f=a(87),d=a(4),h=a(187),m=a(8),l=a(38),v=a(869),t=a(226),z=a(60),r=a(868);class n extends Sys.EventArgs{constructor(){super()}}Object(u.a)(n,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var w=a(47),B=a(46);a(35);var A=a(29),y=a(1),x=a(612);a(22);var F=a(281),I=a(21);a(173);class L{constructor(J){this.data=
J}}Object(u.a)(L,"NumberFormatDataHolder",null,[]);var X=a(176);class P extends l.a{constructor(J,M){super();this.olc=m.a.pe;this.L0c=null;this.hhb=this.$kc=!1;this.Pyf=(S,W)=>{var O;(S=I.h(this.$))&&(W=null!==(O=null===W||void 0===W?void 0:W.cell)&&void 0!==O?O:S.Sb(null))&&this.yCa(W.cell.Ek,!0)};this.LSi=S=>{this.isActive()&&(A.a.Oq(S.Errors)||!S.Result?(S=S.Errors?S.Errors.map(W=>JSON.stringify(W)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${S}`)):
(S=S.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${S.Index}, category = ${S.Category}`),this.Yzj(S.Index,S.Category),this.raiseEvent(P.K1c,new v.a(S.Index,S.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.u3b();this.isActive()&&this.ea.dc.allowEdits&&(this.hhb||this.Kn&&!(this.ea.o9a>this.olc)?this.pFc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),
this.nhd=r.a(this.$.pa.ya,this.Kn?this.Kn.Digest:"",this.sTi,this.rTi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.i3e())};this.bDf=S=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${S.data.status}, HTTP status = ${S.data.httpStatus}.`);this.oLa=null};this.j0=()=>{this.hhb=!1;this.ea.dE(this.j0);this.nSa(this.$kc?P.STd:P.eBd)};this.Tc=(S,W)=>{b.ULS.sendTraceTag(537155715,
0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");t.a(W)&&this.nSa(P.STd)};this.yf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.rBd(0===this.$.workbookContext.CalcMode)};this.ed=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.nSa(P.STd);y.EwaSettings.ma(297)&&3!==this.$.workbookContext.CalcMode&&this.rBd(0===
this.$.workbookContext.CalcMode)};this.kTi=(S,W,O)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.oLa=null;this.isActive()?S.StateId===m.a.pe?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.pFc()):!S.Result||this.bY&&this.bY.length?this.nSa(P.eBd):this.HGf(S,W,O):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};
this.HGf=S=>{this.bY=S.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.bY?this.bY.length:-1} functions.`);S=!1;if(this.bY){for(const W of this.bY)W&&(this.SZe[W.NameUI.toLocaleUpperCase()]=W.FunctionIndex.toString(),W.NameUI!==W.NameDataStrings&&(this.SZe[W.NameDataStrings.toLocaleUpperCase()]=W.FunctionIndex.toString(),S=!0),this.NLh.ia(W.FunctionIndex,W.NameUI));this.raiseEvent(P.ped,Sys.EventArgs.Empty,
this)}S&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.sTi=S=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.$kc=!1,this.olc=S.StateId,this.olc===m.a.pe)this.$kc=!0,this.pFc();else{if(S.Result){var W=this.Kn;this.Kn=S.Result;b.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Kn.Digest}.`);S=[];if(W)S=P.IZh(W.NumberFormats,
this.Kn.NumberFormats);else for(W=0;W<this.Kn.NumberFormats.length;W++)this.ioc.ia(W,this.Kn.NumberFormats[W].NumberFormatCategory);for(const O of S)this.ioc.ia(O,this.Kn.NumberFormats[O].NumberFormatCategory);this.raiseEvent(P.OBd,new n(S),this);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&this.raiseEvent(P.Kqf)}this.nSa(P.eBd)}};this.rTi=S=>{this.isActive()&&(10===S.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):
(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${S.data.status}, HTTP status = ${S.data.httpStatus}.`),this.$kc=!0,this.pFc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=J;this.$=M;this.Kn=this.oLa=this.nhd=this.oJb=null;this.ioc=new X.a;this.uwb=new X.a;this.bY=[];this.NLh=new X.a;this.SZe={};this.ea.Tj(this.Tc);this.$.nl(this.ed);I.h(this.$).ha.lha(this.Pyf);y.EwaSettings.ma(297)&&this.ea.mu(this.yf);
this.nSa(P.Idf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Wre(J){this.addHandler(P.OBd,J)}wMd(J){this.removeHandler(P.OBd,J)}XLg(J){this.addHandler(P.K1c,J)}Uij(J){this.removeHandler(P.K1c,J)}zre(J){this.addHandler(P.ped,J)}oMd(J){this.removeHandler(P.ped,J)}zNg(J){this.addHandler(P.Kqf,J)}get Je(){return this.Kn?this.Kn.LocaleInformation:null}get hza(){return this.Kn?this.Kn.NumberFormats:[]}get Pja(){this.bY&&this.bY.length||this.i3e();return this.bY}get Lji(){return this.Kn&&
void 0!==this.Kn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Kn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Kn.InstantaneousCalcWebWorkerPrecisionSamplingRate:P.okh}get Oji(){return this.Kn&&void 0!==this.Kn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Kn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Kn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:P.skh}get Nji(){return this.Kn&&void 0!==this.Kn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&
null!==this.Kn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Kn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:P.rkh}get Mji(){return this.Kn&&void 0!==this.Kn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Kn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Kn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:P.qkh}get zff(){return this.Kn?this.Kn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:P.pkh}get God(){return null!==this.L0c?
this.L0c:this.Kn?this.Kn.InstantaneousCalcManualMode:!1}KVj(J){let M;if(!J)return{returnValue:!0,category:"General"};M="";if(!({category:J}=this.yCa(J,!1)).returnValue)return{returnValue:!1,category:M};M=this.H$g(J);return{returnValue:!0,category:M}}H$g(J){let M="";switch(J){case 0:M="General";break;case 1:M="Number";break;case 2:M="Currency";break;case 3:M="Accounting";break;case 4:M="Date";break;case 5:M="Time";break;case 6:M="Percentage";break;case 7:M="Fraction";break;case 8:M="Scientific";break;
case 9:M="Text";break;case 10:M="Special";break;case 11:M="Custom"}return M}yCa(J,M){let S,W=({value:S}=this.ioc.Dc(J,0)).returnValue;!W&&0<J&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${J}`),this.kRh(J),M&&(S=this.jRh(J),W=!0),x.a(J,this.$.JG)&&(S=6));return{returnValue:W,category:S}}ypi(J){let M=0;if(({category:M}=this.yCa(J,!0)).returnValue)return 6===M;b.ULS.sendTraceTag(537155733,
0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${J}`);return!1}mKh(J){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.oLa=z.o(this.$.pa.ya,{FilterType:0},F.b(this.HGf,J),this.bDf,null,null,null)}lZe(){this.nSa(P.Idf)}rBd(J){this.L0c=J}kRh(J){if(this.uwb&&this.$){var M;if(!({value:M}=this.uwb.Dc(J)).returnValue||M.isCompleted)b.ULS.sendTraceTag(537155728,
0,50,`Getting number format category for format index: ${J}`),(M=r.b(this.$.pa.ya,J,this.LSi,null,null,null))&&this.uwb.ia(J,M)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}jRh(J){return 1<=J&&8>=J?1:9<=J&&12>=J?2:13===J||14===J?6:15===J?8:17===J|18===J?7:19===J?4:16===J||20<=J&&29>=J||31===J?11:30===J?9:32<=J&&35>=J?3:0}isActive(){const J=void 0===this.ea||null===this.ea,M=!J&&this.ea.Zb;b.ULS.sendTraceTag(537155727,
0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${M} - sessionStateManager IsNullOrUndefined: ${J}`);return M}Yzj(J,M){this.ioc.ia(J,M)}dispose(){f.a.Ia(this.oJb);this.oJb=null;this.u3b();for(let J of this.uwb){const M=J.value;M&&!M.isCompleted&&d.AFrameworkApplication.Bd.Tu(M.nu)}this.uwb=null;this.ea&&(this.ea.qk(this.Tc),this.hhb&&this.ea.dE(this.j0),this.hhb=!1,this.ea.Ov(this.yf));this.ea=null;this.$&&I.h(this.$)&&I.h(this.$).ha&&(I.h(this.$).ha.Ana(this.Pyf),
this.$.Kl(this.ed));this.$=null;super.dispose()}isFeatureEnabled(J){try{switch(J){case "LocaleLongDateFormat":return y.EwaSettings.ma(194);case "GetLocaleDayNames":return y.EwaSettings.ma(195);case "CalculateTextWidthIgnoreLetterSpacing":return y.EwaSettings.ma(281);case "OfficeVSO:3657744_CalcFixForDateFormat":return y.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return y.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");
case "CalcAutocompleteExperiment":return y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcNewFunctions":return y.EwaSettings.ma(244);case "CalcContractChecks":return y.EwaSettings.ma(245);case "CalcSupportDynamicArrays":return y.EwaSettings.ma(246);case "CalcFormatCalculations":return y.EwaSettings.ma(247);case "CalcFormulaCacheAPIChanges":return y.EwaSettings.ma(248);case "CalcStrictFormulaChecking":return y.EwaSettings.ma(249);case "CalcSupportRowReference":return y.EwaSettings.ma(260);
case "CalcParserUsesPledges":return y.EwaSettings.ma(302);case "CalcWebWorker":return!0;case "CalcWebWorkerTest":return y.EwaSettings.ma(301);case "CalcLookupFunctions":return y.EwaSettings.ma(303);case "CalcLogStopWatch":return y.EwaSettings.ma(366);case "CalcPreventSpillingHack":return y.EwaSettings.ma(250);case "CalcDynamicArrayOperators":return y.EwaSettings.ma(102);case "CalcDotOperator":return y.EwaSettings.ma(572);case "CalcLetFunction":return y.EwaSettings.ma(688);default:return J.startsWith("OfficeVSO:")?
y.EwaSettings.isChangeGateEnabled(J):!1}}catch(M){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${J}): feature parsing failed, returning false. Exception: ${M.toString()}.`),!1}}nSa(J){this.isActive()&&this.ea.dc.allowEdits?(f.a.Ia(this.oJb),this.oJb=null,this.oJb=w.a.instance.create(this.refresh,J,B.a.Pji)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.dc&&null!==this.ea.dc?this.ea.dc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}i3e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.oLa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.bY&&this.bY.length||(this.oLa=z.o(this.$.pa.ya,{FilterType:0},this.kTi,
this.bDf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}pFc(){this.hhb||(this.hhb=!0,this.ea.PE(this.j0))}u3b(){this.Tu(this.nhd);this.Tu(this.oLa);this.oLa=this.nhd=null}Tu(J){J&&!J.isCompleted&&this.$.pa.ya.jgb(J.nu)}static IZh(J,M){if(!J||!J.length)return[];if(!M||!M.length){M=Array(J.length);for(var S=0;S<J.length;++S)M[S]=J[S].IfmtIndex;return M}S=new X.a;for(const W of J)S.ia(W.IfmtIndex,
new L(W));J=new h.a;for(const W of M){let O;({value:O}=S.Dc(W.IfmtIndex)).returnValue&&O.data.FormatString===W.FormatString||J.add(W.IfmtIndex)}return J.toArray()}}P.OBd="isim0";P.K1c="isim1";P.ped="isim2";P.Kqf="isim3";P.Idf=100;P.STd=1E3;P.eBd=3E5;P.okh=.001;P.skh=.1;P.rkh=.2;P.qkh=.001;P.pkh=50;Object(u.a)(P,"InstantaneousSupportInformationManager",l.a,[355,2]);var G=a(695);class C extends e.a{constructor(J){super();this.$=J;this.Fb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");
var J=Object(G.a)(this.$.da,268,()=>new P(this.$.ea,this.$));this.ob(J)}}static ka(J){if(!J)throw Error.argumentNull("ewaControl");J.da.Ga(246,new C(J))}}Object(u.a)(C,"InstantaneousSupportInformationManagerFactory",e.a,[]);a.d(D,"a",function(){return H});const H=()=>{c.a.Fa(C.ka)}},1223:function(u,D,a){function c(M){if(M){var S=new v(M.IsRangeRef);S.RF=M.IsAbsoluteFirstRow;S.QF=M.IsAbsoluteFirstColumn;S.GK=M.IsAbsoluteSecondRow;S.FK=M.IsAbsoluteSecondColumn;return S}}function b(M){var S;if(M){var W=
new v(0===M.kind);M=null===(S=null===M||void 0===M?void 0:M.rangeInfo)||void 0===S?void 0:S.positionKindInfo;if(!M)return W;W.RF=0===M.firstRow;W.QF=0===M.firstColumn;W.GK=0===M.secondRow;W.FK=0===M.secondColumn;return W}}u=a(0);var e=a(222),f=a(7),d=a(15),h=a(82),m=a(5),l=a(322);class v{constructor(M){this.FK=this.GK=this.QF=this.RF=!1;this.A_=M}}Object(u.a)(v,"MarqueeRangeData",null,[]);class t{constructor(M,S,W,O=!1){this.dZd=M;this.gPb=S;this.c8a=O;W?(this.A_=W.A_,this.RF=W.RF,this.QF=W.QF,this.GK=
W.GK,this.FK=W.FK):d.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(u.a)(t,"MarqueeMetadata",null,[]);var z=a(42),r=a(139),n=a(35),w=a(1),B=a(22),A=a(579),y=a(21),x=a(173),F=a(343),I=a(33),L=a(725),X=a(871);const P="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");class G{constructor(M,S){this.EK=this.vfb=this.ssf=!1;this.k9=null;this.oza=
()=>{this.EK=!1};this.Lc=M;this.gridView=y.h(M);this.calcManager=S;this.rgf=w.EwaSettings.ma(677);this.hR=I.a.hR(M);this.ela=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.uvi=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7144291_logRefactorInPreviewRanges");this.gridView.Vb.sm(this.oza)}get formulaAssistanceManager(){this.k9||(this.k9=this.Lc.da.za(464));return this.k9}get formulaAssistanceTelemetryManager(){this.uEa||(this.uEa=this.Lc.da.za(491));return this.uEa}fC(M,
S){M.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.vfb||M.SF)return!1;const W=void 0===S||null===S?M.text:S;if(this.calcManager&&1<W.length&&x.f(W)){var O=this.kka(),T=this.A5e(),Y=this.Lc.workbookContext.WorkbookFileName;let va=!1;const ca=.01>Math.random()?Object(h.a)(r.a,this.Lc.Jb.Ac("LoadingUIShown","ColoredReferencesManager")):null;try{const V=this.calcManager.extractReferences(W,T,Y,!this.rgf);if(!V)return d.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),
!1;T=[];Y=[];const ra=[],N=[];let ea=0,Ba=0;const ka=new n.a(!1);let Ka="";for(const wa of V.Items)if(va=wa.IsStructRef||va,wa.IsBoolean||wa.IsNumber||wa.IsString){const qa=wa.IsBoolean?"rgba(0, 0, 255, 1)":wa.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.ME(Y,W,ea,wa.Span.Start,null);this.ME(Y,W,wa.Span.Start,wa.Span.End,qa);ea=wa.Span.End}else if(w.EwaSettings.ma(583)){if(wa.Range||wa.LetName&&0<=wa.LetNumber){let qa=null;if(wa.Range){let ia=z.D(wa.Range);qa=this.QZ(ia,ka,1);T.push(new F.a(ia,
O))}else wa.LetName&&0<=wa.LetNumber&&(qa=Ka=this.WRh(wa.LetName,wa.LetNumber,ka,Ka),Ba!==ka.count&&M.colors.add(wa.Span.Start+"-"+wa.Span.End,P[(ka.count-1)%P.length]));this.ME(Y,W,ea,wa.Span.Start,null);this.ME(Y,W,wa.Span.Start,wa.Span.End,qa);ea=wa.Span.End;ra.push(wa.Span);let aa=Y.length-1;N.push(new t(aa,Y[aa].text,c(wa)));Ba=ka.count}}else if(wa.Range){let qa=z.D(wa.Range),aa=this.QZ(qa,ka,1);this.ME(Y,W,ea,wa.Span.Start,null);this.ME(Y,W,wa.Span.Start,wa.Span.End,aa);T.push(new F.a(qa,O));
ea=wa.Span.End;ra.push(wa.Span);let ia=Y.length-1;N.push(new t(ia,Y[ia].text,c(wa)))}this.formulaAssistanceTelemetryManager?0<V.Items.length&&this.formulaAssistanceTelemetryManager.pbc.formulaHighlightsCounter++:this.kmc("ColoredReferencesManager.tryUpdateColoredReferences: FormulaAssistanceTelemetryManager unavailable");this.ME(Y,W,ea,W.length,null);this.Myc(M,Y,!!S);const Oa=M.textBox.text;if(!B.a.equals(Oa,W,!1)){d.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Oa.length}], originalTextLength [${W.length}]`);
let wa=M.textBox.caretPosition;M.textBox.text=W;M.textBox.caretPosition=wa;return!0}this.Fz(T,ka,N);w.EwaSettings.ma(583)&&0<T.length&&d.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");w.EwaSettings.ma(583)&&0<M.colors.count&&d.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.EK=!0}finally{ca&&ca.TBa(()=>{va&&d.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${ca.zc} ms`)})}}else return this.Fz(null,
null),this.EK&&(this.EK=!1,O=M.textBox.caretPosition,M.textBox.setPlainText(W),M.textBox.caretPosition=Math.min(O,W.length),S)?!0:!1}mgb(M,S,W){if(this.vfb||M.SF)return!1;const O=isNullOrUndefined(S)?M.text:S;var T=[];const Y=new n.a(!1);if(1<O.length&&Object(L.b)(W)){const ca=[],V=[],ra=[];var va=0;const N=this.kka();for(const ea of W.formulaHighlights){this.ME(ca,O,va,ea.span.start,null);switch(ea.kind){case 0:case 1:case 2:W=z.B(ea.rangeInfo.sharedRange);if(isNullOrUndefined(W)){d.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${ea.kind.toString()},`);this.ME(ca,O,ea.span.start,ea.span.end,null);break}va=this.QZ(W,Y,1);this.ME(ca,O,ea.span.start,ea.span.end,va);T.push(new F.a(W,N));V.push({Start:ea.span.start,End:ea.span.end});W=ca.length-1;ra.push(new t(W,ca[W].text,b(ea)));break;case 3:this.ME(ca,O,ea.span.start,ea.span.end,null,"rgba(229, 229, 229, 1)")}va=ea.span.end}this.ME(ca,O,va,O.length);this.Myc(M,
ca,!!S);S=M.textBox.text;if(!B.a.equals(S,O,!1))return d.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${S.length}], originalTextLength [${O.length}]`),S=M.textBox.caretPosition,M.textBox.text=O,M.textBox.caretPosition=S,!0;this.Fz(T,Y,ra);return this.EK=!0}this.Fz(null,null);return this.EK&&(this.EK=!1,T=M.textBox.caretPosition,M.textBox.setPlainText(O),
M.textBox.caretPosition=Math.min(T,O.length),S)?!0:!1}KEb(M,S,W){if(!M||!S||!W)return d.ULS.shipAssertTag(524039685,0,!!M,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),d.ULS.shipAssertTag(524039684,0,!!S,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),d.ULS.shipAssertTag(524039683,0,!!W,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const O=Object(h.a)(t,S.metadata);if(!O)return d.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var T=O.dZd,Y=O.gPb,va=this.gridView.Bb.sqd(W)?W.Nwb(O.QF,O.RF):W.BLa(O.QF,O.RF,O.FK,O.GK);if(!va)return d.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const ca=Y.indexOf("!");-1!==ca&&(va=Y.substring(0,ca+1)+va);if(!M.textBox.changeTextInExistingTextPart(T,Y,va))return d.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;O.gPb=va;T=!0;for(Y=1;4>=Y;Y++)(va=y.h(this.Lc).qb.Dv(3,Y,S.mU))?
(va.range=W,va.metadata=O):(d.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),T=!1);this.gridView.qb.update(!1,!1);this.gridView.Vl&&(this.gridView.fc.textBox.text=M.text);this.gridView.fc.PQa(new l.a({xAb:!0}));return T}cri(M){if(3!==M.Uq)return d.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;M=Object(h.a)(t,M.metadata);return M?M.A_&&!M.c8a:(d.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}YBa(M,S){d.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(S?"suspending":"resuming")+" colored references");S&&this.EK&&(this.EK=!1,this.Fz(null,null),M.textBox.gDe());this.vfb=S}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.Il(this.oza)}$yb(M){const S=this.formulaAssistanceTelemetryManager;S||this.kmc("ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable");
null===S||void 0===S?void 0:S.mA(["highlightPreviewRanges"]);this.hR?this.udi(M):this.tdi(M);null===S||void 0===S?void 0:S.Bw(["highlightPreviewRanges"],!0)}udi(M){var S=this.formulaAssistanceManager.e5a(M,X.a);if(isNullOrUndefined(S))this.ela&&this.Fz(null,null);else{var W=this.kka(),O=[],T=new n.a(!1),Y=[];S=S.formulaHighlights;for(const va of S)if(S=va.kind,0===S||2===S||1===S)S=z.B(va.rangeInfo.sharedRange),Object(L.b)(S)&&(O.push(new F.a(S,W)),this.QZ(S,T,1),Y.push(new t(va.span.start,M.substring(va.span.start,
va.span.end),b(va),!0)));this.Fz(O,T,Y)}}tdi(M){const S=this.kka();var W=this.A5e();const O=this.Lc.workbookContext.WorkbookFileName,T=[],Y=new n.a(!1),va=[];if(W=this.calcManager.extractReferences(M,W,O,!this.rgf)){for(const ca of W.Items)ca.Range&&(W=z.D(ca.Range),T.push(new F.a(W,S)),this.QZ(W,Y,1),va.push(new t(ca.Span.Start,M.substring(ca.Span.Start,ca.Span.End),c(ca),!0)));this.Fz(T,Y,va)}else this.ela&&this.Fz(null,null)}QZ(M,S,W){let O=S.getItem(M.toString());O||(O=P[S.count%P.length],S.add(M.toString(),
O));return String.format(O,W)}WRh(M,S,W,O){M="["+M+", "+S+"]";S=W.getItem(M);S||(S=W.count%P.length,S=P[S],O===String.format(S,1)&&(W.add("skip-"+M,S),S=W.count%P.length,S=P[S]),W.add(M,S));return String.format(S,1)}ME(M,S,W,O,T=null,Y=null){d.ULS.shipAssertTag(524039648,0,W<=O,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");W<O&&(S=S.substring(W,O),M.push(Object(f.a)(new A.a,{text:S,color:T,backgroundColor:Y})))}Fz(M,S,W=null){M&&M.length?(d.ULS.sendTraceTag(524039647,
0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+M.length),M.reverse(),W.reverse(),this.gridView.qb.nx(M,[3],!0,(O,T)=>{if(O&&O.range&&T){d.ULS.shipAssertTag(524039643,0,S.lb(O.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${O.range.toString()}' doesn't exist in the range to color dictionary`);var Y=this.QZ(O.range,S,.1),va=this.QZ(O.range,S,1);this.Lc.frame&&this.Lc.frame.yD&&this.Lc.frame.yD.CN||(T.style.background=Y);T.style.borderColor=
va;W&&(T.setAttribute(m.a.H6a,O.mU.toString()),O.metadata=W[O.mU])}else d.ULS.shipAssertTag(524039646,0,!!O,"ColoredReferencesManager.HighlightRanges: state is null"),d.ULS.shipAssertTag(524039645,0,!!O.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),d.ULS.shipAssertTag(524039644,0,!!T,"ColoredReferencesManager.HighlightRanges: div is null")})):(M=this.Lc.Jb.Ac("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Wg([3]),this.gridView.qb.SSa(new F.a(null,this.kka()),
[3]),M.stop())}Myc(M,S,W){const O=M.textBox;O.LF=!0;var T=O.selection;const Y=T.index;T=Y+T.length;O.setTextFromTextParts(S);S=O.text.length;O.selectRange(Math.min(Y,S),Math.min(T,S));W&&M.PQa(new l.a);O.LF=!1}kmc(M){this.uvi&&!this.ssf&&(d.ULS.sendTraceTag(521211935,0,50,M),this.ssf=!0)}kka(){return this.wdc().sheetId}A5e(){return this.wdc().sheetName}wdc(){return this.gridView.fr&&this.gridView.fr.gG?this.gridView.fr.gG:this.Lc.na}}Object(u.a)(G,"ColoredReferencesManager",null,[525,2]);class C extends e.a{constructor(M){super();
this.$=M;this.Fb()}create(){this.$.da.$a(266,M=>{M=w.EwaSettings.ol()||w.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(281)||this.$.da.Ga(281,new G(this.$,M)):new G(this.$,M);this.ob(M)})}static ka(M){M.da.Ga(282,new C(M))}}Object(u.a)(C,"ColoredReferencesManagerFactory",e.a,[]);var H=a(9);a.d(D,"a",function(){return J});const J=()=>{H.a.Fa(C.ka)}},1271:function(u,D,a){u=a(0);var c=a(222),b=a(808);class e extends c.a{constructor(h){super();this.$=
h;this.Fb()}create(){this.$.da.$a(266,h=>{h=this.$.da.za(294)||this.$.da.Ga(294,new b.RelativeAndAbsoluteReferencesManager(h));this.ob(h)})}static ka(h){h.da.Ga(295,new e(h))}}Object(u.a)(e,"RelativeAndAbsoluteReferencesManagerFactory",c.a,[]);var f=a(9);a.d(D,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1396:function(u,D,a){a.r(D);u=a(1206);D=a(1161);var c=a(1223);a=a(1271);Type.registerNamespace("_Ewa");Object(u.a)();Object(D.a)();Object(c.a)();Object(a.a)()},789:function(u,D,a){a.d(D,
"a",function(){return c});u=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(u.a)(c,"PositionBaseType",null,[])},808:function(u,D,a){a.r(D);u=a(0);var c=a(7),b=a(15);class e{}Object(u.a)(e,"Reference",null,[]);class f extends e{constructor(){super();this.column=this.row=null}}Object(u.a)(f,"CellReference",e,[]);class d{constructor(){this.end=this.start=0;this.Nv=null}pSg(F,I){for(let L=0;L<this.Nv.length;L++){const X=this.t1b(F,this.Nv[L]);I+=X;L<this.Nv.length-1&&(I+=":")}return I}}Object(u.a)(d,"IReferenceSequence",
null,[]);var h=a(24),m=a(789);class l extends d{constructor(){super();this.wjc=!1}odc(){const {RelativeAndAbsoluteReferencesManager:F}=a(808),I=this.Nv[0];return F.hxf(I.row.kind===m.a.abs,I.column.kind===m.a.abs)}t1b(F,I){I=h.Range.Qc(I.row.index+1,I.column.index+1);return this.wjc?I.Nwb(1===F||3===F,1===F||2===F):I.BLa(1===F||3===F,1===F||2===F,!0,!0)}}Object(u.a)(l,"CellReferenceSequence",d,[]);class v extends e{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(u.a)(v,"ColumnReference",
e,[]);class t extends d{constructor(){super()}odc(){const F=this.Nv[0];return a(808).RelativeAndAbsoluteReferencesManager.Evf(F.firstColumn,F.secondColumn).kind===m.a.abs?2:3}t1b(F,I){return h.Range.Xvb(I.firstColumn.index+1,I.secondColumn.index+1).BLa(1===F||3===F,!0,1===F||3===F,!0)}}Object(u.a)(t,"ColumnReferenceSequence",d,[]);class z extends e{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(u.a)(z,"RangeReference",e,[]);class r extends d{constructor(){super()}odc(){const {RelativeAndAbsoluteReferencesManager:F}=
a(808),I=this.Nv[0];return F.hxf(I.top.kind===m.a.abs,I.left.kind===m.a.abs)}t1b(F,I){I=new h.Range(I.top.index+1,I.left.index+1,I.bottom.index+1,I.right.index+1,!1,!1);const L=1===F||3===F;F=1===F||2===F;return I.BLa(L,F,L,F)}}Object(u.a)(r,"RangeReferenceSequence",d,[]);class n extends e{constructor(){super();this.secondRow=this.firstRow=null}}Object(u.a)(n,"RowReference",e,[]);class w extends d{constructor(){super()}odc(){const F=this.Nv[0];return a(808).RelativeAndAbsoluteReferencesManager.Evf(F.firstRow,
F.secondRow).kind===m.a.abs?0:1}t1b(F,I){return h.Range.tbc(I.firstRow.index+1,I.secondRow.index+1).BLa(!0,1===F||2===F,!0,1===F||2===F)}}Object(u.a)(w,"RowReferenceSequence",d,[]);var B=a(980),A=a(981),y=a(173);a.d(D,"RelativeAndAbsoluteReferencesManager",function(){return x});class x{constructor(F){this.calcManager=F}m2a(F,I,L){let X,P;X=I;P=L;if(!F||!y.f(F))return{returnValue:F,QAd:X,PAd:P};var G=this.calcManager.DWe(F);if(!G)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),
{returnValue:null,QAd:X,PAd:P};G=this.E3h(G,F,I,L);let C=0,H="",J=0,M=0;for(;M<G.length;M++)if(this.QNe(G[M],I,L)){C=G[M].odc();X=G[M].start;break}for(;M<G.length&&this.QNe(G[M],I,L);M++)H+=F.substring(J,G[M].start),H=G[M].pSg(C,H),J=G[M].end;J&&(P=H.length);H+=F.substring(J,F.length);return{returnValue:H,QAd:X,PAd:P}}E3h(F,I,L,X){const P=[];for(let J=0;J<F.length;J++){var G=F[J];if(G.kind===B.a.range)if(G=G.ref,G.type===A.a.cell){var C=G;G=Object(c.a)(new l,{start:G.span.start,end:G.span.end,Nv:[Object(c.a)(new f,
{column:C.col,row:C.row})],wjc:this.calcManager.J3b(G.span.end,I)});P.push(G)}else if(G.type===A.a.range)this.RNe(G.topLeftSpan,L,X)&&this.RNe(G.bottomRightSpan,L,X)?(C=new z,G.top.index<=G.bottom.index?(C.top=G.top,C.bottom=G.bottom):(C.bottom=G.top,C.top=G.bottom),G.left.index<=G.right.index?(C.left=G.left,C.right=G.right):(C.right=G.left,C.left=G.right),G=Object(c.a)(new r,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,Nv:[C]}),P.push(G)):(C=Object(c.a)(new l,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,
Nv:[Object(c.a)(new f,{column:G.left,row:G.top})],wjc:this.calcManager.J3b(G.topLeftSpan.end,I)}),G=Object(c.a)(new l,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,Nv:[Object(c.a)(new f,{column:G.right,row:G.bottom})],wjc:this.calcManager.J3b(G.topLeftSpan.end,I)}),P.push(C),P.push(G));else if(G.type===A.a.column){C=G;for(G=Object(c.a)(new t,{start:G.span.start,end:G.span.end,Nv:[Object(c.a)(new v,{firstColumn:C.startIndex,secondColumn:C.endIndex})]});G.end<I.length-1&&":"===I.charAt(G.end)&&
J<F.length-1;)if(C=F[J+1].ref,C.type===A.a.column&&C.span.start===G.end+1){var H=C;G.Nv.push(Object(c.a)(new v,{firstColumn:H.startIndex,secondColumn:H.endIndex}));G.end=C.span.end;J++}else break;P.push(G)}else if(G.type===A.a.row){C=G;for(G=Object(c.a)(new w,{start:G.span.start,end:G.span.end,Nv:[Object(c.a)(new n,{firstRow:C.startIndex,secondRow:C.endIndex})]});G.end<I.length-1&&":"===I.charAt(G.end)&&J<F.length-1;)if(C=F[J+1].ref,C.type===A.a.row&&C.span.start===G.end+1)H=C,G.Nv.push(Object(c.a)(new n,
{firstRow:H.startIndex,secondRow:H.endIndex})),G.end=C.span.end,J++;else break;P.push(G)}}return P}QNe(F,I,L){return!(F.start>L||I>F.end)}RNe(F,I,L){return!(F.start>L||I>F.end)}static Evf(F,I){return F.index<=I.index?F:I}static hxf(F,I){return I||F?I&&F?2:!I&&F?3:0:1}}Object(u.a)(x,"RelativeAndAbsoluteReferencesManager",null,[526])},936:function(u,D,a){a.r(D);u=a(0);var c=a(15),b=a(263),e;(function(w){w[w.paren=0]="paren";w[w.lead=1]="lead";w[w.intern=2]="intern";w[w.trail=3]="trail";w[w.undefined=
4]="undefined"})(e||(e={}));Object(u.b)("CurrencyFormatOption",e);var f;(function(w){w[w.none=-1]="none";w[w.mdy=0]="mdy";w[w.dmy=1]="dmy";w[w.ymd=2]="ymd";w[w.myd=3]="myd";w[w.dym=4]="dym";w[w.ydm=5]="ydm"})(f||(f={}));Object(u.b)("DateOrderOption",f);var d=a(8);class h{constructor(w,B){({CalcHelper:w}=a(936));B&&(B.Je||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.cAg=w.JIe(B,w.vIe(B.Pja));this.dAg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.dAg}get localeData(){return this.cAg}formatNumber(w){return this.localeInfo.formatNumber(w)}}
Object(u.a)(h,"LocaleHolder",null,[]);var m=a(978),l=a(53),v=a(1),t=a(22),z=a(13),r=a(200);a.d(D,"CalcHelper",function(){return n});class n{constructor(w){this.$=w;(this.sy=this.$.da.za(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let B;B=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.io(76):l.a.current.io(79);this.logger=new m.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.vca=new h(w,this.sy);excelOnlineCalc.config.initCalc(this.logger,this.sy?A=>this.sy.isFeatureEnabled(A):()=>!1,B);this.Qug=excelOnlineCalc.config.calcConfig(this.vca.localeInfo)}get config(){return this.Qug}Fih(){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const w=this.$.xa.na;
return w?w.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.na.index}createParser(){const w={};w.config=this.config;return excelOnlineCalc.parse.createParser(w)}createNumberFormatter(){const w=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(B,A)=>excelOnlineCalc.calc.getTime(this.config,B,A,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(w)}Rgh(w,B,A,y){if(!y)return{range:{row:B,col:A},sheet:{document:this.documentLoc,
index:w}};B=excelOnlineCalc.location.gridCell(B,A);w=excelOnlineCalc.location.sheetIndex(this.documentLoc,w);return excelOnlineCalc.location.sheetGridCell(w,B)}fuh(w,B){let A;A=excelOnlineCalc.calc.getEvalResultKind(w);switch(A){case 4:return{returnValue:w?this.vca.localeInfo.trueName:this.vca.localeInfo.falseName,kind:A};case 1:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.JCc(this.vca.formatNumber(w),B):this.vca.formatNumber(w),
kind:A};case 2:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.JCc(w.toString(),B):w.toString(),kind:A};case 128:return{returnValue:"",kind:A};case 8:switch(w.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.vca.localeInfo.errorNames[w.type],kind:A};default:return{returnValue:n.unknownError,kind:A}}case 32:return{returnValue:v.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.JCc(this.hhh(w,B),B):"##UNSUPPORTED: ARRAY",kind:A};default:return{returnValue:z.a.instance.ga(2210),kind:A}}}JCc(w,B){return w.length<=B?w:w.substring(0,B-3)+"..."}hhh(w,B){let A=this.vca.localeInfo.leftBrace;for(let y=0;y<w.rows;++y){for(let x=0;x<w.cols;++x)A+=w.opers[y][x],x<w.cols-1&&(A+=this.vca.localeInfo.columnSeparator);y<w.rows-1&&(A+=this.vca.localeInfo.rowSeparator)}return this.JCc(A,B-1)+this.vca.localeInfo.rightBrace}static JIe(w,B=null){const A=n.m6b(),y=w.Je.TrueValueString,x=
w.Je.FalseValueString,F=w.Je.DecimalSeparator.toString(),I=w.Je.ListSeparator.toString(),L=w.Je.ColumnSeparator.toString(),X=w.Je.RowSeparator.toString(),P=w.Je.ThousandsDataArray,G=w.Je.ThousandSeparator.toString(),C=w.Je.Lcid,H=w.Je.Country,J=w.Je.DigitsNumber,M=w.Je.ExpSeparatedBySpace,S=w.Je.FractionSeparator.toString(),W=w.Je.PercentSeparatedBySpace,O=t.a.R1g(Enum.toString(e,w.Je.CurrencyFormat)),T=w.Je.CurrencySymbolLead,Y=w.Je.CurrencySeparatedBySpace,va=w.Je.CurrencySymbolString,ca=w.Je.DigitsCurrency,
V=-1===w.Je.DateOrder?"MDY":r.e(Enum.toString(f,w.Je.DateOrder)),ra=w.Je.DateSeparator.toString(),N=w.Je.DateAlternativeSeparator.toString(),ea=w.Je.Year4Digits,Ba=w.Je.Month2Digits,ka=w.Je.Day2Digits,Ka=w.Je.LongDateFormat,Oa=w.Je.TimeSeparator.toString(),wa=w.Je.TimeAltSeparator,qa=w.Je.Hour2Digits,aa=w.Je.Use24HourClock,ia=w.Je.AmPmSeparatedBySpace,Ha=[w.Je.AmString,w.Je.PmString],Z=w.Je.DayNameShortArray,la=w.Je.DayNameLongArray,Xa=w.Je.MonthNameShortArray,Za=w.Je.MonthNameLongArray,xa=w.Je.PictureSpecialArray,
fa=b.a.map(("\x00"+w.Je.PictureSingleString).split(""),dc=>"\x00"===dc?null:dc),ua=w.Je.PictureColorArray,sa=w.Je.PictureDbnumArray,sb=w.Je.RowLetter.toString(),hb=w.Je.ColumnLetter.toString(),bb=w.Je.LeftBrace.toString(),lb=w.Je.RightBrace.toString(),Fa=w.Je.LeftBracket.toString(),Na=w.Je.RightBracket.toString(),Mb=n.v4h(w.Je);return excelOnlineCalc.calc.localeData(B,A,y,x,sb,hb,bb,lb,Fa,Na,F,I,L,X,P,G,C,H,J,M,S,W,O,T,Y,va,ca,V,ra,N,ea,Ba,ka,Ka,Oa,wa,qa,aa,ia,Ha,Z,la,Xa,Za,xa,fa,ua,sa,Mb,w.Je.SysDateFormatString,
w.Je.SysTimeFormatString)}static vIe(w){const B=[];if(!w)return B;for(const A of w)w=null,A.IsDynamicUdf||(w=excelOnlineCalc.calc.worksheetFunctionName(A.FunctionIndexInServer,A.NameUI)),w&&B.push(w);return B}static m6b(){const w=[],B=Object.keys(d.a.errorNames);for(let A=0;A<B.length;A++){const y=excelOnlineCalc.calc.errorTypeName(A+1,B[A]);y&&w.push(y)}return w}static v4h(w){const B=Array(6);B[1]="#"+w.AllStructRefString;B[3]="#"+w.HeadersStructRefString;B[2]="#"+w.DataStructRefString;B[4]="#"+
w.TotalsStructRefString;B[5]="#"+w.ThisRowStructRefString;return B}}n.unknownError="##ERR##";Object(u.a)(n,"CalcHelper",null,[])},980:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.nAi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.Mpf="letName";c.all="*";c.OXd="structRefRange";Object(u.a)(c,"TraverseFormulaInterestTypes",null,[])},981:function(u,D,a){a.d(D,"a",function(){return c});u=a(0);class c{}c.cell="cell";c.range="range";c.row=
"row";c.column="col";Object(u.a)(c,"TraverseFormulaRefTypes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/ba63c2dc269b8b0888098a065e3ba756/EwaDSEsNext.calc.js.map